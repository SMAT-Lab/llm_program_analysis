{
    "type": "module",
    "label": "import atexit\nimport logging\nimport multiprocessing\nimport os\nimport signal\nimport sys\nimport threading\nfrom concurrent.futures import Future, ProcessPoolExecutor\nfrom contextlib import contextmanager\nfrom multiprocessing.pool import AsyncResult, Pool\nfrom typing import TYPE_CHECKING, Any, Generator, TypeVar, cast\n\nfrom pydantic import BaseModel\nfrom redis.lock import Lock as RedisLock\n\nif TYPE_CHECKING:\n    from backend.executor import DatabaseManager\n\nfrom autogpt_libs.utils.cache import thread_cached\n\nfrom backend.blocks.agent import AgentExecutorBlock\nfrom backend.data import redis\nfrom backend.data.block import Block, BlockData, BlockInput, BlockType, get_block\nfrom backend.data.execution import (\n    ExecutionQueue,\n    ExecutionResult,\n    ExecutionStatus,\n    GraphExecutionEntry,\n    NodeExecutionEntry,\n    merge_execution_input,\n    parse_execution_output,\n)\nfrom backend.data.graph import GraphModel, Link, Node\nfrom backend.data.model import CREDENTIALS_FIELD_NAME, CredentialsMetaInput\nfrom backend.integrations.creds_manager import IntegrationCredentialsManager\nfrom backend.util import json\nfrom backend.util.decorator import error_logged, time_measured\nfrom backend.util.logging import configure_logging\nfrom backend.util.process import set_service_name\nfrom backend.util.service import (\n    AppService,\n    close_service_client,\n    expose,\n    get_service_client,\n)\nfrom backend.util.settings import Settings\nfrom backend.util.type import convert\n\nlogger = logging.getLogger(__name__)\nsettings = Settings()\n\n\nclass LogMetadata:\n    def __init__(\n        self,\n        user_id: str,\n        graph_eid: str,\n        graph_id: str,\n        node_eid: str,\n        node_id: str,\n        block_name: str,\n    ):\n        self.metadata = {\n            \"component\": \"ExecutionManager\",\n            \"user_id\": user_id,\n            \"graph_eid\": graph_eid,\n            \"graph_id\": graph_id,\n            \"node_eid\": node_eid,\n            \"node_id\": node_id,\n            \"block_name\": block_name,\n        }\n        self.prefix = f\"[ExecutionManager|uid:{user_id}|gid:{graph_id}|nid:{node_id}]|geid:{graph_eid}|nid:{node_eid}|{block_name}]\"\n\n    def info(self, msg: str, **extra):\n        msg = self._wrap(msg, **extra)\n        logger.info(msg, extra={\"json_fields\": {**self.metadata, **extra}})\n\n    def warning(self, msg: str, **extra):\n        msg = self._wrap(msg, **extra)\n        logger.warning(msg, extra={\"json_fields\": {**self.metadata, **extra}})\n\n    def error(self, msg: str, **extra):\n        msg = self._wrap(msg, **extra)\n        logger.error(msg, extra={\"json_fields\": {**self.metadata, **extra}})\n\n    def debug(self, msg: str, **extra):\n        msg = self._wrap(msg, **extra)\n        logger.debug(msg, extra={\"json_fields\": {**self.metadata, **extra}})\n\n    def exception(self, msg: str, **extra):\n        msg = self._wrap(msg, **extra)\n        logger.exception(msg, extra={\"json_fields\": {**self.metadata, **extra}})\n\n    def _wrap(self, msg: str, **extra):\n        return f\"{self.prefix} {msg} {extra}\"\n\n\nT = TypeVar(\"T\")\nExecutionStream = Generator[NodeExecutionEntry, None, None]\n\n\ndef execute_node(\n    db_client: \"DatabaseManager\",\n    creds_manager: IntegrationCredentialsManager,\n    data: NodeExecutionEntry,\n    execution_stats: dict[str, Any] | None = None,\n) -> ExecutionStream:\n    \"\"\"\n    Execute a node in the graph. This will trigger a block execution on a node,\n    persist the execution result, and return the subsequent node to be executed.\n\n    Args:\n        db_client: The client to send execution updates to the server.\n        creds_manager: The manager to acquire and release credentials.\n        data: The execution data for executing the current node.\n        execution_stats: The execution statistics to be updated.\n\n    Returns:\n        The subsequent node to be enqueued, or None if there is no subsequent node.\n    \"\"\"\n    user_id = data.user_id\n    graph_exec_id = data.graph_exec_id\n    graph_id = data.graph_id\n    node_exec_id = data.node_exec_id\n    node_id = data.node_id\n\n    def update_execution(status: ExecutionStatus) -> ExecutionResult:\n        exec_update = db_client.update_execution_status(node_exec_id, status)\n        db_client.send_execution_update(exec_update)\n        return exec_update\n\n    node = db_client.get_node(node_id)\n\n    node_block = get_block(node.block_id)\n    if not node_block:\n        logger.error(f\"Block {node.block_id} not found.\")\n        return\n\n    log_metadata = LogMetadata(\n        user_id=user_id,\n        graph_eid=graph_exec_id,\n        graph_id=graph_id,\n        node_eid=node_exec_id,\n        node_id=node_id,\n        block_name=node_block.name,\n    )\n\n    # Sanity check: validate the execution input.\n    input_data, error = validate_exec(node, data.data, resolve_input=False)\n    if input_data is None:\n        log_metadata.error(f\"Skip execution, input validation error: {error}\")\n        db_client.upsert_execution_output(node_exec_id, \"error\", error)\n        update_execution(ExecutionStatus.FAILED)\n        return\n\n    # Re-shape the input data for agent block.\n    # AgentExecutorBlock specially separate the node input_data & its input_default.\n    if isinstance(node_block, AgentExecutorBlock):\n        input_data = {**node.input_default, \"data\": input_data}\n\n    # Execute the node\n    input_data_str = json.dumps(input_data)\n    input_size = len(input_data_str)\n    log_metadata.info(\"Executed node with input\", input=input_data_str)\n    update_execution(ExecutionStatus.RUNNING)\n\n    extra_exec_kwargs = {}\n    # Last-minute fetch credentials + acquire a system-wide read-write lock to prevent\n    # changes during execution. ⚠️ This means a set of credentials can only be used by\n    # one (running) block at a time; simultaneous execution of blocks using same\n    # credentials is not supported.\n    creds_lock = None\n    if CREDENTIALS_FIELD_NAME in input_data:\n        credentials_meta = CredentialsMetaInput(**input_data[CREDENTIALS_FIELD_NAME])\n        credentials, creds_lock = creds_manager.acquire(user_id, credentials_meta.id)\n        extra_exec_kwargs[\"credentials\"] = credentials\n\n    output_size = 0\n    end_status = ExecutionStatus.COMPLETED\n    credit = db_client.get_or_refill_credit(user_id)\n    if credit < 0:\n        raise ValueError(f\"Insufficient credit: {credit}\")\n\n    try:\n        for output_name, output_data in node_block.execute(\n            input_data, **extra_exec_kwargs\n        ):\n            output_size += len(json.dumps(output_data))\n            log_metadata.info(\"Node produced output\", **{output_name: output_data})\n            db_client.upsert_execution_output(node_exec_id, output_name, output_data)\n\n            for execution in _enqueue_next_nodes(\n                db_client=db_client,\n                node=node,\n                output=(output_name, output_data),\n                user_id=user_id,\n                graph_exec_id=graph_exec_id,\n                graph_id=graph_id,\n                log_metadata=log_metadata,\n            ):\n                yield execution\n\n    except Exception as e:\n        end_status = ExecutionStatus.FAILED\n        error_msg = str(e)\n        log_metadata.exception(f\"Node execution failed with error {error_msg}\")\n        db_client.upsert_execution_output(node_exec_id, \"error\", error_msg)\n\n        for execution in _enqueue_next_nodes(\n            db_client=db_client,\n            node=node,\n            output=(\"error\", error_msg),\n            user_id=user_id,\n            graph_exec_id=graph_exec_id,\n            graph_id=graph_id,\n            log_metadata=log_metadata,\n        ):\n            yield execution\n\n        raise e\n    finally:\n        # Ensure credentials are released even if execution fails\n        if creds_lock:\n            try:\n                creds_lock.release()\n            except Exception as e:\n                log_metadata.error(f\"Failed to release credentials lock: {e}\")\n\n        # Update execution status and spend credits\n        res = update_execution(end_status)\n        if end_status == ExecutionStatus.COMPLETED:\n            s = input_size + output_size\n            t = (\n                (res.end_time - res.start_time).total_seconds()\n                if res.end_time and res.start_time\n                else 0\n            )\n            db_client.spend_credits(user_id, credit, node_block.id, input_data, s, t)\n\n        # Update execution stats\n        if execution_stats is not None:\n            execution_stats.update(node_block.execution_stats)\n            execution_stats[\"input_size\"] = input_size\n            execution_stats[\"output_size\"] = output_size\n\n\ndef _enqueue_next_nodes(\n    db_client: \"DatabaseManager\",\n    node: Node,\n    output: BlockData,\n    user_id: str,\n    graph_exec_id: str,\n    graph_id: str,\n    log_metadata: LogMetadata,\n) -> list[NodeExecutionEntry]:\n    def add_enqueued_execution(\n        node_exec_id: str, node_id: str, data: BlockInput\n    ) -> NodeExecutionEntry:\n        exec_update = db_client.update_execution_status(\n            node_exec_id, ExecutionStatus.QUEUED, data\n        )\n        db_client.send_execution_update(exec_update)\n        return NodeExecutionEntry(\n            user_id=user_id,\n            graph_exec_id=graph_exec_id,\n            graph_id=graph_id,\n            node_exec_id=node_exec_id,\n            node_id=node_id,\n            data=data,\n        )\n\n    def register_next_executions(node_link: Link) -> list[NodeExecutionEntry]:\n        enqueued_executions = []\n        next_output_name = node_link.source_name\n        next_input_name = node_link.sink_name\n        next_node_id = node_link.sink_id\n\n        next_data = parse_execution_output(output, next_output_name)\n        if next_data is None:\n            return enqueued_executions\n\n        next_node = db_client.get_node(next_node_id)\n\n        # Multiple node can register the same next node, we need this to be atomic\n        # To avoid same execution to be enqueued multiple times,\n        # Or the same input to be consumed multiple times.\n        with synchronized(f\"upsert_input-{next_node_id}-{graph_exec_id}\"):\n            # Add output data to the earliest incomplete execution, or create a new one.\n            next_node_exec_id, next_node_input = db_client.upsert_execution_input(\n                node_id=next_node_id,\n                graph_exec_id=graph_exec_id,\n                input_name=next_input_name,\n                input_data=next_data,\n            )\n\n            # Complete missing static input pins data using the last execution input.\n            static_link_names = {\n                link.sink_name\n                for link in next_node.input_links\n                if link.is_static and link.sink_name not in next_node_input\n            }\n            if static_link_names and (\n                latest_execution := db_client.get_latest_execution(\n                    next_node_id, graph_exec_id\n                )\n            ):\n                for name in static_link_names:\n                    next_node_input[name] = latest_execution.input_data.get(name)\n\n            # Validate the input data for the next node.\n            next_node_input, validation_msg = validate_exec(next_node, next_node_input)\n            suffix = f\"{next_output_name}>{next_input_name}~{next_node_exec_id}:{validation_msg}\"\n\n            # Incomplete input data, skip queueing the execution.\n            if not next_node_input:\n                log_metadata.warning(f\"Skipped queueing {suffix}\")\n                return enqueued_executions\n\n            # Input is complete, enqueue the execution.\n            log_metadata.info(f\"Enqueued {suffix}\")\n            enqueued_executions.append(\n                add_enqueued_execution(next_node_exec_id, next_node_id, next_node_input)\n            )\n\n            # Next execution stops here if the link is not static.\n            if not node_link.is_static:\n                return enqueued_executions\n\n            # If link is static, there could be some incomplete executions waiting for it.\n            # Load and complete the input missing input data, and try to re-enqueue them.\n            for iexec in db_client.get_incomplete_executions(\n                next_node_id, graph_exec_id\n            ):\n                idata = iexec.input_data\n                ineid = iexec.node_exec_id\n\n                static_link_names = {\n                    link.sink_name\n                    for link in next_node.input_links\n                    if link.is_static and link.sink_name not in idata\n                }\n                for input_name in static_link_names:\n                    idata[input_name] = next_node_input[input_name]\n\n                idata, msg = validate_exec(next_node, idata)\n                suffix = f\"{next_output_name}>{next_input_name}~{ineid}:{msg}\"\n                if not idata:\n                    log_metadata.info(f\"Enqueueing static-link skipped: {suffix}\")\n                    continue\n                log_metadata.info(f\"Enqueueing static-link execution {suffix}\")\n                enqueued_executions.append(\n                    add_enqueued_execution(iexec.node_exec_id, next_node_id, idata)\n                )\n            return enqueued_executions\n\n    return [\n        execution\n        for link in node.output_links\n        for execution in register_next_executions(link)\n    ]\n\n\ndef validate_exec(\n    node: Node,\n    data: BlockInput,\n    resolve_input: bool = True,\n) -> tuple[BlockInput | None, str]:\n    \"\"\"\n    Validate the input data for a node execution.\n\n    Args:\n        node: The node to execute.\n        data: The input data for the node execution.\n        resolve_input: Whether to resolve dynamic pins into dict/list/object.\n\n    Returns:\n        A tuple of the validated data and the block name.\n        If the data is invalid, the first element will be None, and the second element\n        will be an error message.\n        If the data is valid, the first element will be the resolved input data, and\n        the second element will be the block name.\n    \"\"\"\n    node_block: Block | None = get_block(node.block_id)\n    if not node_block:\n        return None, f\"Block for {node.block_id} not found.\"\n\n    if isinstance(node_block, AgentExecutorBlock):\n        # Validate the execution metadata for the agent executor block.\n        try:\n            exec_data = AgentExecutorBlock.Input(**node.input_default)\n        except Exception as e:\n            return None, f\"Input data doesn't match {node_block.name}: {str(e)}\"\n\n        # Validation input\n        input_schema = exec_data.input_schema\n        required_fields = set(input_schema[\"required\"])\n        input_default = exec_data.data\n    else:\n        # Convert non-matching data types to the expected input schema.\n        for name, data_type in node_block.input_schema.__annotations__.items():\n            if (value := data.get(name)) and (type(value) is not data_type):\n                data[name] = convert(value, data_type)\n\n        # Validation input\n        input_schema = node_block.input_schema.jsonschema()\n        required_fields = node_block.input_schema.get_required_fields()\n        input_default = node.input_default\n\n    # Input data (without default values) should contain all required fields.\n    error_prefix = f\"Input data missing or mismatch for `{node_block.name}`:\"\n    input_fields_from_nodes = {link.sink_name for link in node.input_links}\n    if not input_fields_from_nodes.issubset(data):\n        return None, f\"{error_prefix} {input_fields_from_nodes - set(data)}\"\n\n    # Merge input data with default values and resolve dynamic dict/list/object pins.\n    data = {**input_default, **data}\n    if resolve_input:\n        data = merge_execution_input(data)\n\n    # Input data post-merge should contain all required fields from the schema.\n    if not required_fields.issubset(data):\n        return None, f\"{error_prefix} {required_fields - set(data)}\"\n\n    # Last validation: Validate the input values against the schema.\n    if error := json.validate_with_jsonschema(schema=input_schema, data=data):\n        error_message = f\"{error_prefix} {error}\"\n        logger.error(error_message)\n        return None, error_message\n\n    return data, node_block.name\n\n\nclass Executor:\n    \"\"\"\n    This class contains event handlers for the process pool executor events.\n\n    The main events are:\n        on_node_executor_start: Initialize the process that executes the node.\n        on_node_execution: Execution logic for a node.\n\n        on_graph_executor_start: Initialize the process that executes the graph.\n        on_graph_execution: Execution logic for a graph.\n\n    The execution flow:\n        1. Graph execution request is added to the queue.\n        2. Graph executor loop picks the request from the queue.\n        3. Graph executor loop submits the graph execution request to the executor pool.\n      [on_graph_execution]\n        4. Graph executor initialize the node execution queue.\n        5. Graph executor adds the starting nodes to the node execution queue.\n        6. Graph executor waits for all nodes to be executed.\n      [on_node_execution]\n        7. Node executor picks the node execution request from the queue.\n        8. Node executor executes the node.\n        9. Node executor enqueues the next executed nodes to the node execution queue.\n    \"\"\"\n\n    @classmethod\n    def on_node_executor_start(cls):\n        configure_logging()\n        set_service_name(\"NodeExecutor\")\n        redis.connect()\n        cls.pid = os.getpid()\n        cls.db_client = get_db_client()\n        cls.creds_manager = IntegrationCredentialsManager()\n\n        # Set up shutdown handlers\n        cls.shutdown_lock = threading.Lock()\n        atexit.register(cls.on_node_executor_stop)  # handle regular shutdown\n        signal.signal(  # handle termination\n            signal.SIGTERM, lambda _, __: cls.on_node_executor_sigterm()\n        )\n\n    @classmethod\n    def on_node_executor_stop(cls):\n        if not cls.shutdown_lock.acquire(blocking=False):\n            return  # already shutting down\n\n        logger.info(f\"[on_node_executor_stop {cls.pid}] ⏳ Releasing locks...\")\n        cls.creds_manager.release_all_locks()\n        logger.info(f\"[on_node_executor_stop {cls.pid}] ⏳ Disconnecting Redis...\")\n        redis.disconnect()\n        logger.info(f\"[on_node_executor_stop {cls.pid}] ⏳ Disconnecting DB manager...\")\n        close_service_client(cls.db_client)\n        logger.info(f\"[on_node_executor_stop {cls.pid}] ✅ Finished cleanup\")\n\n    @classmethod\n    def on_node_executor_sigterm(cls):\n        llprint(f\"[on_node_executor_sigterm {cls.pid}] ⚠️ SIGTERM received\")\n        if not cls.shutdown_lock.acquire(blocking=False):\n            return  # already shutting down\n\n        llprint(f\"[on_node_executor_stop {cls.pid}] ⏳ Releasing locks...\")\n        cls.creds_manager.release_all_locks()\n        llprint(f\"[on_node_executor_stop {cls.pid}] ⏳ Disconnecting Redis...\")\n        redis.disconnect()\n        llprint(f\"[on_node_executor_stop {cls.pid}] ✅ Finished cleanup\")\n        sys.exit(0)\n\n    @classmethod\n    @error_logged\n    def on_node_execution(\n        cls,\n        q: ExecutionQueue[NodeExecutionEntry],\n        node_exec: NodeExecutionEntry,\n    ) -> dict[str, Any]:\n        log_metadata = LogMetadata(\n            user_id=node_exec.user_id,\n            graph_eid=node_exec.graph_exec_id,\n            graph_id=node_exec.graph_id,\n            node_eid=node_exec.node_exec_id,\n            node_id=node_exec.node_id,\n            block_name=\"-\",\n        )\n\n        execution_stats = {}\n        timing_info, _ = cls._on_node_execution(\n            q, node_exec, log_metadata, execution_stats\n        )\n        execution_stats[\"walltime\"] = timing_info.wall_time\n        execution_stats[\"cputime\"] = timing_info.cpu_time\n\n        cls.db_client.update_node_execution_stats(\n            node_exec.node_exec_id, execution_stats\n        )\n        return execution_stats\n\n    @classmethod\n    @time_measured\n    def _on_node_execution(\n        cls,\n        q: ExecutionQueue[NodeExecutionEntry],\n        node_exec: NodeExecutionEntry,\n        log_metadata: LogMetadata,\n        stats: dict[str, Any] | None = None,\n    ):\n        try:\n            log_metadata.info(f\"Start node execution {node_exec.node_exec_id}\")\n            for execution in execute_node(\n                cls.db_client, cls.creds_manager, node_exec, stats\n            ):\n                q.add(execution)\n            log_metadata.info(f\"Finished node execution {node_exec.node_exec_id}\")\n        except Exception as e:\n            log_metadata.exception(\n                f\"Failed node execution {node_exec.node_exec_id}: {e}\"\n            )\n\n    @classmethod\n    def on_graph_executor_start(cls):\n        configure_logging()\n        set_service_name(\"GraphExecutor\")\n\n        cls.db_client = get_db_client()\n        cls.pool_size = settings.config.num_node_workers\n        cls.pid = os.getpid()\n        cls._init_node_executor_pool()\n        logger.info(\n            f\"Graph executor {cls.pid} started with {cls.pool_size} node workers\"\n        )\n\n        # Set up shutdown handler\n        atexit.register(cls.on_graph_executor_stop)\n\n    @classmethod\n    def on_graph_executor_stop(cls):\n        prefix = f\"[on_graph_executor_stop {cls.pid}]\"\n        logger.info(f\"{prefix} ⏳ Terminating node executor pool...\")\n        cls.executor.terminate()\n        logger.info(f\"{prefix} ⏳ Disconnecting DB manager...\")\n        close_service_client(cls.db_client)\n        logger.info(f\"{prefix} ✅ Finished cleanup\")\n\n    @classmethod\n    def _init_node_executor_pool(cls):\n        cls.executor = Pool(\n            processes=cls.pool_size,\n            initializer=cls.on_node_executor_start,\n        )\n\n    @classmethod\n    @error_logged\n    def on_graph_execution(\n        cls, graph_exec: GraphExecutionEntry, cancel: threading.Event\n    ):\n        log_metadata = LogMetadata(\n            user_id=graph_exec.user_id,\n            graph_eid=graph_exec.graph_exec_id,\n            graph_id=graph_exec.graph_id,\n            node_id=\"*\",\n            node_eid=\"*\",\n            block_name=\"-\",\n        )\n        timing_info, (exec_stats, error) = cls._on_graph_execution(\n            graph_exec, cancel, log_metadata\n        )\n        exec_stats[\"walltime\"] = timing_info.wall_time\n        exec_stats[\"cputime\"] = timing_info.cpu_time\n        exec_stats[\"error\"] = str(error) if error else None\n        result = cls.db_client.update_graph_execution_stats(\n            graph_exec_id=graph_exec.graph_exec_id,\n            stats=exec_stats,\n        )\n        cls.db_client.send_execution_update(result)\n\n    @classmethod\n    @time_measured\n    def _on_graph_execution(\n        cls,\n        graph_exec: GraphExecutionEntry,\n        cancel: threading.Event,\n        log_metadata: LogMetadata,\n    ) -> tuple[dict[str, Any], Exception | None]:\n        \"\"\"\n        Returns:\n            The execution statistics of the graph execution.\n            The error that occurred during the execution.\n        \"\"\"\n        log_metadata.info(f\"Start graph execution {graph_exec.graph_exec_id}\")\n        exec_stats = {\n            \"nodes_walltime\": 0,\n            \"nodes_cputime\": 0,\n            \"node_count\": 0,\n        }\n        error = None\n        finished = False\n\n        def cancel_handler():\n            while not cancel.is_set():\n                cancel.wait(1)\n            if finished:\n                return\n            cls.executor.terminate()\n            log_metadata.info(f\"Terminated graph execution {graph_exec.graph_exec_id}\")\n            cls._init_node_executor_pool()\n\n        cancel_thread = threading.Thread(target=cancel_handler)\n        cancel_thread.start()\n\n        try:\n            queue = ExecutionQueue[NodeExecutionEntry]()\n            for node_exec in graph_exec.start_node_execs:\n                queue.add(node_exec)\n\n            running_executions: dict[str, AsyncResult] = {}\n\n            def make_exec_callback(exec_data: NodeExecutionEntry):\n                node_id = exec_data.node_id\n\n                def callback(result: object):\n                    running_executions.pop(node_id)\n                    nonlocal exec_stats\n                    if isinstance(result, dict):\n                        exec_stats[\"node_count\"] += 1\n                        exec_stats[\"nodes_cputime\"] += result.get(\"cputime\", 0)\n                        exec_stats[\"nodes_walltime\"] += result.get(\"walltime\", 0)\n\n                return callback\n\n            while not queue.empty():\n                if cancel.is_set():\n                    error = RuntimeError(\"Execution is cancelled\")\n                    return exec_stats, error\n\n                exec_data = queue.get()\n\n                # Avoid parallel execution of the same node.\n                execution = running_executions.get(exec_data.node_id)\n                if execution and not execution.ready():\n                    # TODO (performance improvement):\n                    #   Wait for the completion of the same node execution is blocking.\n                    #   To improve this we need a separate queue for each node.\n                    #   Re-enqueueing the data back to the queue will disrupt the order.\n                    execution.wait()\n\n                log_metadata.debug(\n                    f\"Dispatching node execution {exec_data.node_exec_id} \"\n                    f\"for node {exec_data.node_id}\",\n                )\n                running_executions[exec_data.node_id] = cls.executor.apply_async(\n                    cls.on_node_execution,\n                    (queue, exec_data),\n                    callback=make_exec_callback(exec_data),\n                )\n\n                # Avoid terminating graph execution when some nodes are still running.\n                while queue.empty() and running_executions:\n                    log_metadata.debug(\n                        f\"Queue empty; running nodes: {list(running_executions.keys())}\"\n                    )\n                    for node_id, execution in list(running_executions.items()):\n                        if cancel.is_set():\n                            error = RuntimeError(\"Execution is cancelled\")\n                            return exec_stats, error\n\n                        if not queue.empty():\n                            break  # yield to parent loop to execute new queue items\n\n                        log_metadata.debug(f\"Waiting on execution of node {node_id}\")\n                        execution.wait(3)\n\n            log_metadata.info(f\"Finished graph execution {graph_exec.graph_exec_id}\")\n        except Exception as e:\n            log_metadata.exception(\n                f\"Failed graph execution {graph_exec.graph_exec_id}: {e}\"\n            )\n            error = e\n        finally:\n            if not cancel.is_set():\n                finished = True\n                cancel.set()\n            cancel_thread.join()\n            return exec_stats, error\n\n\nclass ExecutionManager(AppService):\n    def __init__(self):\n        super().__init__()\n        self.use_redis = True\n        self.use_supabase = True\n        self.pool_size = settings.config.num_graph_workers\n        self.queue = ExecutionQueue[GraphExecutionEntry]()\n        self.active_graph_runs: dict[str, tuple[Future, threading.Event]] = {}\n\n    @classmethod\n    def get_port(cls) -> int:\n        return settings.config.execution_manager_port\n\n    def run_service(self):\n        from backend.integrations.credentials_store import IntegrationCredentialsStore\n\n        self.credentials_store = IntegrationCredentialsStore()\n        self.executor = ProcessPoolExecutor(\n            max_workers=self.pool_size,\n            initializer=Executor.on_graph_executor_start,\n        )\n        sync_manager = multiprocessing.Manager()\n        logger.info(\n            f\"[{self.service_name}] Started with max-{self.pool_size} graph workers\"\n        )\n        while True:\n            graph_exec_data = self.queue.get()\n            graph_exec_id = graph_exec_data.graph_exec_id\n            logger.debug(\n                f\"[ExecutionManager] Dispatching graph execution {graph_exec_id}\"\n            )\n            cancel_event = sync_manager.Event()\n            future = self.executor.submit(\n                Executor.on_graph_execution, graph_exec_data, cancel_event\n            )\n            self.active_graph_runs[graph_exec_id] = (future, cancel_event)\n            future.add_done_callback(\n                lambda _: self.active_graph_runs.pop(graph_exec_id, None)\n            )\n\n    def cleanup(self):\n        logger.info(f\"[{__class__.__name__}] ⏳ Shutting down graph executor pool...\")\n        self.executor.shutdown(cancel_futures=True)\n\n        super().cleanup()\n\n    @property\n    def db_client(self) -> \"DatabaseManager\":\n        return get_db_client()\n\n    @expose\n    def add_execution(\n        self,\n        graph_id: str,\n        data: BlockInput,\n        user_id: str,\n        graph_version: int | None = None,\n    ) -> GraphExecutionEntry:\n        graph: GraphModel | None = self.db_client.get_graph(\n            graph_id=graph_id, user_id=user_id, version=graph_version\n        )\n        if not graph:\n            raise ValueError(f\"Graph #{graph_id} not found.\")\n\n        graph.validate_graph(for_run=True)\n        self._validate_node_input_credentials(graph, user_id)\n\n        nodes_input = []\n        for node in graph.starting_nodes:\n            input_data = {}\n            block = get_block(node.block_id)\n\n            # Invalid block & Note block should never be executed.\n            if not block or block.block_type == BlockType.NOTE:\n                continue\n\n            # Extract request input data, and assign it to the input pin.\n            if block.block_type == BlockType.INPUT:\n                name = node.input_default.get(\"name\")\n                if name and name in data:\n                    input_data = {\"value\": data[name]}\n\n            # Extract webhook payload, and assign it to the input pin\n            webhook_payload_key = f\"webhook_{node.webhook_id}_payload\"\n            if (\n                block.block_type in (BlockType.WEBHOOK, BlockType.WEBHOOK_MANUAL)\n                and node.webhook_id\n            ):\n                if webhook_payload_key not in data:\n                    raise ValueError(\n                        f\"Node {block.name} #{node.id} webhook payload is missing\"\n                    )\n                input_data = {\"payload\": data[webhook_payload_key]}\n\n            input_data, error = validate_exec(node, input_data)\n            if input_data is None:\n                raise ValueError(error)\n            else:\n                nodes_input.append((node.id, input_data))\n\n        graph_exec_id, node_execs = self.db_client.create_graph_execution(\n            graph_id=graph_id,\n            graph_version=graph.version,\n            nodes_input=nodes_input,\n            user_id=user_id,\n        )\n\n        starting_node_execs = []\n        for node_exec in node_execs:\n            starting_node_execs.append(\n                NodeExecutionEntry(\n                    user_id=user_id,\n                    graph_exec_id=node_exec.graph_exec_id,\n                    graph_id=node_exec.graph_id,\n                    node_exec_id=node_exec.node_exec_id,\n                    node_id=node_exec.node_id,\n                    data=node_exec.input_data,\n                )\n            )\n            exec_update = self.db_client.update_execution_status(\n                node_exec.node_exec_id, ExecutionStatus.QUEUED, node_exec.input_data\n            )\n            self.db_client.send_execution_update(exec_update)\n\n        graph_exec = GraphExecutionEntry(\n            user_id=user_id,\n            graph_id=graph_id,\n            graph_exec_id=graph_exec_id,\n            start_node_execs=starting_node_execs,\n        )\n        self.queue.add(graph_exec)\n\n        return graph_exec\n\n    @expose\n    def cancel_execution(self, graph_exec_id: str) -> None:\n        \"\"\"\n        Mechanism:\n        1. Set the cancel event\n        2. Graph executor's cancel handler thread detects the event, terminates workers,\n           reinitializes worker pool, and returns.\n        3. Update execution statuses in DB and set `error` outputs to `\"TERMINATED\"`.\n        \"\"\"\n        if graph_exec_id not in self.active_graph_runs:\n            raise Exception(\n                f\"Graph execution #{graph_exec_id} not active/running: \"\n                \"possibly already completed/cancelled.\"\n            )\n\n        future, cancel_event = self.active_graph_runs[graph_exec_id]\n        if cancel_event.is_set():\n            return\n\n        cancel_event.set()\n        future.result()\n\n        # Update the status of the unfinished node executions\n        node_execs = self.db_client.get_execution_results(graph_exec_id)\n        for node_exec in node_execs:\n            if node_exec.status not in (\n                ExecutionStatus.COMPLETED,\n                ExecutionStatus.FAILED,\n            ):\n                self.db_client.upsert_execution_output(\n                    node_exec.node_exec_id, \"error\", \"TERMINATED\"\n                )\n                exec_update = self.db_client.update_execution_status(\n                    node_exec.node_exec_id, ExecutionStatus.FAILED\n                )\n                self.db_client.send_execution_update(exec_update)\n\n    def _validate_node_input_credentials(self, graph: GraphModel, user_id: str):\n        \"\"\"Checks all credentials for all nodes of the graph\"\"\"\n\n        for node in graph.nodes:\n            block = get_block(node.block_id)\n            if not block:\n                raise ValueError(f\"Unknown block {node.block_id} for node #{node.id}\")\n\n            # Find any fields of type CredentialsMetaInput\n            model_fields = cast(type[BaseModel], block.input_schema).model_fields\n            if CREDENTIALS_FIELD_NAME not in model_fields:\n                continue\n\n            field = model_fields[CREDENTIALS_FIELD_NAME]\n\n            # The BlockSchema class enforces that a `credentials` field is always a\n            # `CredentialsMetaInput`, so we can safely assume this here.\n            credentials_meta_type = cast(CredentialsMetaInput, field.annotation)\n            credentials_meta = credentials_meta_type.model_validate(\n                node.input_default[CREDENTIALS_FIELD_NAME]\n            )\n            # Fetch the corresponding Credentials and perform sanity checks\n            credentials = self.credentials_store.get_creds_by_id(\n                user_id, credentials_meta.id\n            )\n            if not credentials:\n                raise ValueError(\n                    f\"Unknown credentials #{credentials_meta.id} \"\n                    f\"for node #{node.id}\"\n                )\n            if (\n                credentials.provider != credentials_meta.provider\n                or credentials.type != credentials_meta.type\n            ):\n                logger.warning(\n                    f\"Invalid credentials #{credentials.id} for node #{node.id}: \"\n                    \"type/provider mismatch: \"\n                    f\"{credentials_meta.type}<>{credentials.type};\"\n                    f\"{credentials_meta.provider}<>{credentials.provider}\"\n                )\n                raise ValueError(\n                    f\"Invalid credentials #{credentials.id} for node #{node.id}: \"\n                    \"type/provider mismatch\"\n                )\n\n\n# ------- UTILITIES ------- #\n\n\n@thread_cached\ndef get_db_client() -> \"DatabaseManager\":\n    from backend.executor import DatabaseManager\n\n    return get_service_client(DatabaseManager)\n\n\n@contextmanager\ndef synchronized(key: str, timeout: int = 60):\n    lock: RedisLock = redis.get_redis().lock(f\"lock:{key}\", timeout=timeout)\n    try:\n        lock.acquire()\n        yield\n    finally:\n        if lock.locked():\n            lock.release()\n\n\ndef llprint(message: str):\n    \"\"\"\n    Low-level print/log helper function for use in signal handlers.\n    Regular log/print statements are not allowed in signal handlers.\n    \"\"\"\n    if logger.getEffectiveLevel() == logging.DEBUG:\n        os.write(sys.stdout.fileno(), (message + \"\\n\").encode())\n",
    "start_token": 0,
    "end_token": -1,
    "children": [
        {
            "type": "import_statement",
            "label": "import atexit",
            "start_token": 0,
            "end_token": 1,
            "children": [
                {
                    "type": "dotted_name",
                    "label": "atexit",
                    "start_token": 1,
                    "end_token": 1,
                    "children": [
                        {
                            "type": "identifier",
                            "label": "atexit",
                            "start_token": 1,
                            "end_token": 1,
                            "children": []
                        }
                    ]
                }
            ]
        },
        {
            "type": "import_statement",
            "label": "import logging",
            "start_token": 3,
            "end_token": 4,
            "children": [
                {
                    "type": "dotted_name",
                    "label": "logging",
                    "start_token": 4,
                    "end_token": 4,
                    "children": [
                        {
                            "type": "identifier",
                            "label": "logging",
                            "start_token": 4,
                            "end_token": 4,
                            "children": []
                        }
                    ]
                }
            ]
        },
        {
            "type": "import_statement",
            "label": "import multiprocessing",
            "start_token": 6,
            "end_token": 7,
            "children": [
                {
                    "type": "dotted_name",
                    "label": "multiprocessing",
                    "start_token": 7,
                    "end_token": 7,
                    "children": [
                        {
                            "type": "identifier",
                            "label": "multiprocessing",
                            "start_token": 7,
                            "end_token": 7,
                            "children": []
                        }
                    ]
                }
            ]
        },
        {
            "type": "import_statement",
            "label": "import os",
            "start_token": 9,
            "end_token": 10,
            "children": [
                {
                    "type": "dotted_name",
                    "label": "os",
                    "start_token": 10,
                    "end_token": 10,
                    "children": [
                        {
                            "type": "identifier",
                            "label": "os",
                            "start_token": 10,
                            "end_token": 10,
                            "children": []
                        }
                    ]
                }
            ]
        },
        {
            "type": "import_statement",
            "label": "import signal",
            "start_token": 12,
            "end_token": 13,
            "children": [
                {
                    "type": "dotted_name",
                    "label": "signal",
                    "start_token": 13,
                    "end_token": 13,
                    "children": [
                        {
                            "type": "identifier",
                            "label": "signal",
                            "start_token": 13,
                            "end_token": 13,
                            "children": []
                        }
                    ]
                }
            ]
        },
        {
            "type": "import_statement",
            "label": "import sys",
            "start_token": 15,
            "end_token": 16,
            "children": [
                {
                    "type": "dotted_name",
                    "label": "sys",
                    "start_token": 16,
                    "end_token": 16,
                    "children": [
                        {
                            "type": "identifier",
                            "label": "sys",
                            "start_token": 16,
                            "end_token": 16,
                            "children": []
                        }
                    ]
                }
            ]
        },
        {
            "type": "import_statement",
            "label": "import threading",
            "start_token": 18,
            "end_token": 19,
            "children": [
                {
                    "type": "dotted_name",
                    "label": "threading",
                    "start_token": 19,
                    "end_token": 19,
                    "children": [
                        {
                            "type": "identifier",
                            "label": "threading",
                            "start_token": 19,
                            "end_token": 19,
                            "children": []
                        }
                    ]
                }
            ]
        },
        {
            "type": "import_from_statement",
            "label": "from concurrent.futures import Future, ProcessPoolExecutor",
            "start_token": 21,
            "end_token": 28,
            "children": [
                {
                    "type": "dotted_name",
                    "label": "concurrent.futures",
                    "start_token": 22,
                    "end_token": 24,
                    "children": [
                        {
                            "type": "identifier",
                            "label": "concurrent",
                            "start_token": 22,
                            "end_token": 22,
                            "children": []
                        },
                        {
                            "type": "identifier",
                            "label": "futures",
                            "start_token": 24,
                            "end_token": 24,
                            "children": []
                        }
                    ]
                },
                {
                    "type": "dotted_name",
                    "label": "Future",
                    "start_token": 26,
                    "end_token": 26,
                    "children": [
                        {
                            "type": "identifier",
                            "label": "Future",
                            "start_token": 26,
                            "end_token": 26,
                            "children": []
                        }
                    ]
                },
                {
                    "type": "dotted_name",
                    "label": "ProcessPoolExecutor",
                    "start_token": 28,
                    "end_token": 28,
                    "children": [
                        {
                            "type": "identifier",
                            "label": "ProcessPoolExecutor",
                            "start_token": 28,
                            "end_token": 28,
                            "children": []
                        }
                    ]
                }
            ]
        },
        {
            "type": "import_from_statement",
            "label": "from contextlib import contextmanager",
            "start_token": 30,
            "end_token": 33,
            "children": [
                {
                    "type": "dotted_name",
                    "label": "contextlib",
                    "start_token": 31,
                    "end_token": 31,
                    "children": [
                        {
                            "type": "identifier",
                            "label": "contextlib",
                            "start_token": 31,
                            "end_token": 31,
                            "children": []
                        }
                    ]
                },
                {
                    "type": "dotted_name",
                    "label": "contextmanager",
                    "start_token": 33,
                    "end_token": 33,
                    "children": [
                        {
                            "type": "identifier",
                            "label": "contextmanager",
                            "start_token": 33,
                            "end_token": 33,
                            "children": []
                        }
                    ]
                }
            ]
        },
        {
            "type": "import_from_statement",
            "label": "from multiprocessing.pool import AsyncResult, Pool",
            "start_token": 35,
            "end_token": 42,
            "children": [
                {
                    "type": "dotted_name",
                    "label": "multiprocessing.pool",
                    "start_token": 36,
                    "end_token": 38,
                    "children": [
                        {
                            "type": "identifier",
                            "label": "multiprocessing",
                            "start_token": 36,
                            "end_token": 36,
                            "children": []
                        },
                        {
                            "type": "identifier",
                            "label": "pool",
                            "start_token": 38,
                            "end_token": 38,
                            "children": []
                        }
                    ]
                },
                {
                    "type": "dotted_name",
                    "label": "AsyncResult",
                    "start_token": 40,
                    "end_token": 40,
                    "children": [
                        {
                            "type": "identifier",
                            "label": "AsyncResult",
                            "start_token": 40,
                            "end_token": 40,
                            "children": []
                        }
                    ]
                },
                {
                    "type": "dotted_name",
                    "label": "Pool",
                    "start_token": 42,
                    "end_token": 42,
                    "children": [
                        {
                            "type": "identifier",
                            "label": "Pool",
                            "start_token": 42,
                            "end_token": 42,
                            "children": []
                        }
                    ]
                }
            ]
        },
        {
            "type": "import_from_statement",
            "label": "from typing import TYPE_CHECKING, Any, Generator, TypeVar, cast",
            "start_token": 44,
            "end_token": 55,
            "children": [
                {
                    "type": "dotted_name",
                    "label": "typing",
                    "start_token": 45,
                    "end_token": 45,
                    "children": [
                        {
                            "type": "identifier",
                            "label": "typing",
                            "start_token": 45,
                            "end_token": 45,
                            "children": []
                        }
                    ]
                },
                {
                    "type": "dotted_name",
                    "label": "TYPE_CHECKING",
                    "start_token": 47,
                    "end_token": 47,
                    "children": [
                        {
                            "type": "identifier",
                            "label": "TYPE_CHECKING",
                            "start_token": 47,
                            "end_token": 47,
                            "children": []
                        }
                    ]
                },
                {
                    "type": "dotted_name",
                    "label": "Any",
                    "start_token": 49,
                    "end_token": 49,
                    "children": [
                        {
                            "type": "identifier",
                            "label": "Any",
                            "start_token": 49,
                            "end_token": 49,
                            "children": []
                        }
                    ]
                },
                {
                    "type": "dotted_name",
                    "label": "Generator",
                    "start_token": 51,
                    "end_token": 51,
                    "children": [
                        {
                            "type": "identifier",
                            "label": "Generator",
                            "start_token": 51,
                            "end_token": 51,
                            "children": []
                        }
                    ]
                },
                {
                    "type": "dotted_name",
                    "label": "TypeVar",
                    "start_token": 53,
                    "end_token": 53,
                    "children": [
                        {
                            "type": "identifier",
                            "label": "TypeVar",
                            "start_token": 53,
                            "end_token": 53,
                            "children": []
                        }
                    ]
                },
                {
                    "type": "dotted_name",
                    "label": "cast",
                    "start_token": 55,
                    "end_token": 55,
                    "children": [
                        {
                            "type": "identifier",
                            "label": "cast",
                            "start_token": 55,
                            "end_token": 55,
                            "children": []
                        }
                    ]
                }
            ]
        },
        {
            "type": "import_from_statement",
            "label": "from pydantic import BaseModel",
            "start_token": 58,
            "end_token": 61,
            "children": [
                {
                    "type": "dotted_name",
                    "label": "pydantic",
                    "start_token": 59,
                    "end_token": 59,
                    "children": [
                        {
                            "type": "identifier",
                            "label": "pydantic",
                            "start_token": 59,
                            "end_token": 59,
                            "children": []
                        }
                    ]
                },
                {
                    "type": "dotted_name",
                    "label": "BaseModel",
                    "start_token": 61,
                    "end_token": 61,
                    "children": [
                        {
                            "type": "identifier",
                            "label": "BaseModel",
                            "start_token": 61,
                            "end_token": 61,
                            "children": []
                        }
                    ]
                }
            ]
        },
        {
            "type": "import_from_statement",
            "label": "from redis.lock import Lock as RedisLock",
            "start_token": 63,
            "end_token": 70,
            "children": [
                {
                    "type": "dotted_name",
                    "label": "redis.lock",
                    "start_token": 64,
                    "end_token": 66,
                    "children": [
                        {
                            "type": "identifier",
                            "label": "redis",
                            "start_token": 64,
                            "end_token": 64,
                            "children": []
                        },
                        {
                            "type": "identifier",
                            "label": "lock",
                            "start_token": 66,
                            "end_token": 66,
                            "children": []
                        }
                    ]
                },
                {
                    "type": "aliased_import",
                    "label": "Lock as RedisLock",
                    "start_token": 68,
                    "end_token": 70,
                    "children": [
                        {
                            "type": "dotted_name",
                            "label": "Lock",
                            "start_token": 68,
                            "end_token": 68,
                            "children": [
                                {
                                    "type": "identifier",
                                    "label": "Lock",
                                    "start_token": 68,
                                    "end_token": 68,
                                    "children": []
                                }
                            ]
                        },
                        {
                            "type": "identifier",
                            "label": "RedisLock",
                            "start_token": 70,
                            "end_token": 70,
                            "children": []
                        }
                    ]
                }
            ]
        },
        {
            "type": "if_statement",
            "label": "if TYPE_CHECKING:\n    from backend.executor import DatabaseManager",
            "start_token": 73,
            "end_token": 82,
            "children": [
                {
                    "type": "identifier",
                    "label": "TYPE_CHECKING",
                    "start_token": 74,
                    "end_token": 74,
                    "children": []
                },
                {
                    "type": "block",
                    "label": "from backend.executor import DatabaseManager",
                    "start_token": 77,
                    "end_token": 82,
                    "children": [
                        {
                            "type": "import_from_statement",
                            "label": "from backend.executor import DatabaseManager",
                            "start_token": 77,
                            "end_token": 82,
                            "children": [
                                {
                                    "type": "dotted_name",
                                    "label": "backend.executor",
                                    "start_token": 78,
                                    "end_token": 80,
                                    "children": [
                                        {
                                            "type": "identifier",
                                            "label": "backend",
                                            "start_token": 78,
                                            "end_token": 78,
                                            "children": []
                                        },
                                        {
                                            "type": "identifier",
                                            "label": "executor",
                                            "start_token": 80,
                                            "end_token": 80,
                                            "children": []
                                        }
                                    ]
                                },
                                {
                                    "type": "dotted_name",
                                    "label": "DatabaseManager",
                                    "start_token": 82,
                                    "end_token": 82,
                                    "children": [
                                        {
                                            "type": "identifier",
                                            "label": "DatabaseManager",
                                            "start_token": 82,
                                            "end_token": 82,
                                            "children": []
                                        }
                                    ]
                                }
                            ]
                        }
                    ]
                }
            ]
        },
        {
            "type": "import_from_statement",
            "label": "from autogpt_libs.utils.cache import thread_cached",
            "start_token": 85,
            "end_token": 92,
            "children": [
                {
                    "type": "dotted_name",
                    "label": "autogpt_libs.utils.cache",
                    "start_token": 86,
                    "end_token": 90,
                    "children": [
                        {
                            "type": "identifier",
                            "label": "autogpt_libs",
                            "start_token": 86,
                            "end_token": 86,
                            "children": []
                        },
                        {
                            "type": "identifier",
                            "label": "utils",
                            "start_token": 88,
                            "end_token": 88,
                            "children": []
                        },
                        {
                            "type": "identifier",
                            "label": "cache",
                            "start_token": 90,
                            "end_token": 90,
                            "children": []
                        }
                    ]
                },
                {
                    "type": "dotted_name",
                    "label": "thread_cached",
                    "start_token": 92,
                    "end_token": 92,
                    "children": [
                        {
                            "type": "identifier",
                            "label": "thread_cached",
                            "start_token": 92,
                            "end_token": 92,
                            "children": []
                        }
                    ]
                }
            ]
        },
        {
            "type": "import_from_statement",
            "label": "from backend.blocks.agent import AgentExecutorBlock",
            "start_token": 95,
            "end_token": 102,
            "children": [
                {
                    "type": "dotted_name",
                    "label": "backend.blocks.agent",
                    "start_token": 96,
                    "end_token": 100,
                    "children": [
                        {
                            "type": "identifier",
                            "label": "backend",
                            "start_token": 96,
                            "end_token": 96,
                            "children": []
                        },
                        {
                            "type": "identifier",
                            "label": "blocks",
                            "start_token": 98,
                            "end_token": 98,
                            "children": []
                        },
                        {
                            "type": "identifier",
                            "label": "agent",
                            "start_token": 100,
                            "end_token": 100,
                            "children": []
                        }
                    ]
                },
                {
                    "type": "dotted_name",
                    "label": "AgentExecutorBlock",
                    "start_token": 102,
                    "end_token": 102,
                    "children": [
                        {
                            "type": "identifier",
                            "label": "AgentExecutorBlock",
                            "start_token": 102,
                            "end_token": 102,
                            "children": []
                        }
                    ]
                }
            ]
        },
        {
            "type": "import_from_statement",
            "label": "from backend.data import redis",
            "start_token": 104,
            "end_token": 109,
            "children": [
                {
                    "type": "dotted_name",
                    "label": "backend.data",
                    "start_token": 105,
                    "end_token": 107,
                    "children": [
                        {
                            "type": "identifier",
                            "label": "backend",
                            "start_token": 105,
                            "end_token": 105,
                            "children": []
                        },
                        {
                            "type": "identifier",
                            "label": "data",
                            "start_token": 107,
                            "end_token": 107,
                            "children": []
                        }
                    ]
                },
                {
                    "type": "dotted_name",
                    "label": "redis",
                    "start_token": 109,
                    "end_token": 109,
                    "children": [
                        {
                            "type": "identifier",
                            "label": "redis",
                            "start_token": 109,
                            "end_token": 109,
                            "children": []
                        }
                    ]
                }
            ]
        },
        {
            "type": "import_from_statement",
            "label": "from backend.data.block import Block, BlockData, BlockInput, BlockType, get_block",
            "start_token": 111,
            "end_token": 126,
            "children": [
                {
                    "type": "dotted_name",
                    "label": "backend.data.block",
                    "start_token": 112,
                    "end_token": 116,
                    "children": [
                        {
                            "type": "identifier",
                            "label": "backend",
                            "start_token": 112,
                            "end_token": 112,
                            "children": []
                        },
                        {
                            "type": "identifier",
                            "label": "data",
                            "start_token": 114,
                            "end_token": 114,
                            "children": []
                        },
                        {
                            "type": "identifier",
                            "label": "block",
                            "start_token": 116,
                            "end_token": 116,
                            "children": []
                        }
                    ]
                },
                {
                    "type": "dotted_name",
                    "label": "Block",
                    "start_token": 118,
                    "end_token": 118,
                    "children": [
                        {
                            "type": "identifier",
                            "label": "Block",
                            "start_token": 118,
                            "end_token": 118,
                            "children": []
                        }
                    ]
                },
                {
                    "type": "dotted_name",
                    "label": "BlockData",
                    "start_token": 120,
                    "end_token": 120,
                    "children": [
                        {
                            "type": "identifier",
                            "label": "BlockData",
                            "start_token": 120,
                            "end_token": 120,
                            "children": []
                        }
                    ]
                },
                {
                    "type": "dotted_name",
                    "label": "BlockInput",
                    "start_token": 122,
                    "end_token": 122,
                    "children": [
                        {
                            "type": "identifier",
                            "label": "BlockInput",
                            "start_token": 122,
                            "end_token": 122,
                            "children": []
                        }
                    ]
                },
                {
                    "type": "dotted_name",
                    "label": "BlockType",
                    "start_token": 124,
                    "end_token": 124,
                    "children": [
                        {
                            "type": "identifier",
                            "label": "BlockType",
                            "start_token": 124,
                            "end_token": 124,
                            "children": []
                        }
                    ]
                },
                {
                    "type": "dotted_name",
                    "label": "get_block",
                    "start_token": 126,
                    "end_token": 126,
                    "children": [
                        {
                            "type": "identifier",
                            "label": "get_block",
                            "start_token": 126,
                            "end_token": 126,
                            "children": []
                        }
                    ]
                }
            ]
        },
        {
            "type": "import_from_statement",
            "label": "from backend.data.execution import (\n    ExecutionQueue,\n    ExecutionResult,\n    ExecutionStatus,\n    GraphExecutionEntry,\n    NodeExecutionEntry,\n    merge_execution_input,\n    parse_execution_output,\n)",
            "start_token": 128,
            "end_token": 158,
            "children": [
                {
                    "type": "dotted_name",
                    "label": "backend.data.execution",
                    "start_token": 129,
                    "end_token": 133,
                    "children": [
                        {
                            "type": "identifier",
                            "label": "backend",
                            "start_token": 129,
                            "end_token": 129,
                            "children": []
                        },
                        {
                            "type": "identifier",
                            "label": "data",
                            "start_token": 131,
                            "end_token": 131,
                            "children": []
                        },
                        {
                            "type": "identifier",
                            "label": "execution",
                            "start_token": 133,
                            "end_token": 133,
                            "children": []
                        }
                    ]
                },
                {
                    "type": "dotted_name",
                    "label": "ExecutionQueue",
                    "start_token": 137,
                    "end_token": 137,
                    "children": [
                        {
                            "type": "identifier",
                            "label": "ExecutionQueue",
                            "start_token": 137,
                            "end_token": 137,
                            "children": []
                        }
                    ]
                },
                {
                    "type": "dotted_name",
                    "label": "ExecutionResult",
                    "start_token": 140,
                    "end_token": 140,
                    "children": [
                        {
                            "type": "identifier",
                            "label": "ExecutionResult",
                            "start_token": 140,
                            "end_token": 140,
                            "children": []
                        }
                    ]
                },
                {
                    "type": "dotted_name",
                    "label": "ExecutionStatus",
                    "start_token": 143,
                    "end_token": 143,
                    "children": [
                        {
                            "type": "identifier",
                            "label": "ExecutionStatus",
                            "start_token": 143,
                            "end_token": 143,
                            "children": []
                        }
                    ]
                },
                {
                    "type": "dotted_name",
                    "label": "GraphExecutionEntry",
                    "start_token": 146,
                    "end_token": 146,
                    "children": [
                        {
                            "type": "identifier",
                            "label": "GraphExecutionEntry",
                            "start_token": 146,
                            "end_token": 146,
                            "children": []
                        }
                    ]
                },
                {
                    "type": "dotted_name",
                    "label": "NodeExecutionEntry",
                    "start_token": 149,
                    "end_token": 149,
                    "children": [
                        {
                            "type": "identifier",
                            "label": "NodeExecutionEntry",
                            "start_token": 149,
                            "end_token": 149,
                            "children": []
                        }
                    ]
                },
                {
                    "type": "dotted_name",
                    "label": "merge_execution_input",
                    "start_token": 152,
                    "end_token": 152,
                    "children": [
                        {
                            "type": "identifier",
                            "label": "merge_execution_input",
                            "start_token": 152,
                            "end_token": 152,
                            "children": []
                        }
                    ]
                },
                {
                    "type": "dotted_name",
                    "label": "parse_execution_output",
                    "start_token": 155,
                    "end_token": 155,
                    "children": [
                        {
                            "type": "identifier",
                            "label": "parse_execution_output",
                            "start_token": 155,
                            "end_token": 155,
                            "children": []
                        }
                    ]
                }
            ]
        },
        {
            "type": "import_from_statement",
            "label": "from backend.data.graph import GraphModel, Link, Node",
            "start_token": 160,
            "end_token": 171,
            "children": [
                {
                    "type": "dotted_name",
                    "label": "backend.data.graph",
                    "start_token": 161,
                    "end_token": 165,
                    "children": [
                        {
                            "type": "identifier",
                            "label": "backend",
                            "start_token": 161,
                            "end_token": 161,
                            "children": []
                        },
                        {
                            "type": "identifier",
                            "label": "data",
                            "start_token": 163,
                            "end_token": 163,
                            "children": []
                        },
                        {
                            "type": "identifier",
                            "label": "graph",
                            "start_token": 165,
                            "end_token": 165,
                            "children": []
                        }
                    ]
                },
                {
                    "type": "dotted_name",
                    "label": "GraphModel",
                    "start_token": 167,
                    "end_token": 167,
                    "children": [
                        {
                            "type": "identifier",
                            "label": "GraphModel",
                            "start_token": 167,
                            "end_token": 167,
                            "children": []
                        }
                    ]
                },
                {
                    "type": "dotted_name",
                    "label": "Link",
                    "start_token": 169,
                    "end_token": 169,
                    "children": [
                        {
                            "type": "identifier",
                            "label": "Link",
                            "start_token": 169,
                            "end_token": 169,
                            "children": []
                        }
                    ]
                },
                {
                    "type": "dotted_name",
                    "label": "Node",
                    "start_token": 171,
                    "end_token": 171,
                    "children": [
                        {
                            "type": "identifier",
                            "label": "Node",
                            "start_token": 171,
                            "end_token": 171,
                            "children": []
                        }
                    ]
                }
            ]
        },
        {
            "type": "import_from_statement",
            "label": "from backend.data.model import CREDENTIALS_FIELD_NAME, CredentialsMetaInput",
            "start_token": 173,
            "end_token": 182,
            "children": [
                {
                    "type": "dotted_name",
                    "label": "backend.data.model",
                    "start_token": 174,
                    "end_token": 178,
                    "children": [
                        {
                            "type": "identifier",
                            "label": "backend",
                            "start_token": 174,
                            "end_token": 174,
                            "children": []
                        },
                        {
                            "type": "identifier",
                            "label": "data",
                            "start_token": 176,
                            "end_token": 176,
                            "children": []
                        },
                        {
                            "type": "identifier",
                            "label": "model",
                            "start_token": 178,
                            "end_token": 178,
                            "children": []
                        }
                    ]
                },
                {
                    "type": "dotted_name",
                    "label": "CREDENTIALS_FIELD_NAME",
                    "start_token": 180,
                    "end_token": 180,
                    "children": [
                        {
                            "type": "identifier",
                            "label": "CREDENTIALS_FIELD_NAME",
                            "start_token": 180,
                            "end_token": 180,
                            "children": []
                        }
                    ]
                },
                {
                    "type": "dotted_name",
                    "label": "CredentialsMetaInput",
                    "start_token": 182,
                    "end_token": 182,
                    "children": [
                        {
                            "type": "identifier",
                            "label": "CredentialsMetaInput",
                            "start_token": 182,
                            "end_token": 182,
                            "children": []
                        }
                    ]
                }
            ]
        },
        {
            "type": "import_from_statement",
            "label": "from backend.integrations.creds_manager import IntegrationCredentialsManager",
            "start_token": 184,
            "end_token": 191,
            "children": [
                {
                    "type": "dotted_name",
                    "label": "backend.integrations.creds_manager",
                    "start_token": 185,
                    "end_token": 189,
                    "children": [
                        {
                            "type": "identifier",
                            "label": "backend",
                            "start_token": 185,
                            "end_token": 185,
                            "children": []
                        },
                        {
                            "type": "identifier",
                            "label": "integrations",
                            "start_token": 187,
                            "end_token": 187,
                            "children": []
                        },
                        {
                            "type": "identifier",
                            "label": "creds_manager",
                            "start_token": 189,
                            "end_token": 189,
                            "children": []
                        }
                    ]
                },
                {
                    "type": "dotted_name",
                    "label": "IntegrationCredentialsManager",
                    "start_token": 191,
                    "end_token": 191,
                    "children": [
                        {
                            "type": "identifier",
                            "label": "IntegrationCredentialsManager",
                            "start_token": 191,
                            "end_token": 191,
                            "children": []
                        }
                    ]
                }
            ]
        },
        {
            "type": "import_from_statement",
            "label": "from backend.util import json",
            "start_token": 193,
            "end_token": 198,
            "children": [
                {
                    "type": "dotted_name",
                    "label": "backend.util",
                    "start_token": 194,
                    "end_token": 196,
                    "children": [
                        {
                            "type": "identifier",
                            "label": "backend",
                            "start_token": 194,
                            "end_token": 194,
                            "children": []
                        },
                        {
                            "type": "identifier",
                            "label": "util",
                            "start_token": 196,
                            "end_token": 196,
                            "children": []
                        }
                    ]
                },
                {
                    "type": "dotted_name",
                    "label": "json",
                    "start_token": 198,
                    "end_token": 198,
                    "children": [
                        {
                            "type": "identifier",
                            "label": "json",
                            "start_token": 198,
                            "end_token": 198,
                            "children": []
                        }
                    ]
                }
            ]
        },
        {
            "type": "import_from_statement",
            "label": "from backend.util.decorator import error_logged, time_measured",
            "start_token": 200,
            "end_token": 209,
            "children": [
                {
                    "type": "dotted_name",
                    "label": "backend.util.decorator",
                    "start_token": 201,
                    "end_token": 205,
                    "children": [
                        {
                            "type": "identifier",
                            "label": "backend",
                            "start_token": 201,
                            "end_token": 201,
                            "children": []
                        },
                        {
                            "type": "identifier",
                            "label": "util",
                            "start_token": 203,
                            "end_token": 203,
                            "children": []
                        },
                        {
                            "type": "identifier",
                            "label": "decorator",
                            "start_token": 205,
                            "end_token": 205,
                            "children": []
                        }
                    ]
                },
                {
                    "type": "dotted_name",
                    "label": "error_logged",
                    "start_token": 207,
                    "end_token": 207,
                    "children": [
                        {
                            "type": "identifier",
                            "label": "error_logged",
                            "start_token": 207,
                            "end_token": 207,
                            "children": []
                        }
                    ]
                },
                {
                    "type": "dotted_name",
                    "label": "time_measured",
                    "start_token": 209,
                    "end_token": 209,
                    "children": [
                        {
                            "type": "identifier",
                            "label": "time_measured",
                            "start_token": 209,
                            "end_token": 209,
                            "children": []
                        }
                    ]
                }
            ]
        },
        {
            "type": "import_from_statement",
            "label": "from backend.util.logging import configure_logging",
            "start_token": 211,
            "end_token": 218,
            "children": [
                {
                    "type": "dotted_name",
                    "label": "backend.util.logging",
                    "start_token": 212,
                    "end_token": 216,
                    "children": [
                        {
                            "type": "identifier",
                            "label": "backend",
                            "start_token": 212,
                            "end_token": 212,
                            "children": []
                        },
                        {
                            "type": "identifier",
                            "label": "util",
                            "start_token": 214,
                            "end_token": 214,
                            "children": []
                        },
                        {
                            "type": "identifier",
                            "label": "logging",
                            "start_token": 216,
                            "end_token": 216,
                            "children": []
                        }
                    ]
                },
                {
                    "type": "dotted_name",
                    "label": "configure_logging",
                    "start_token": 218,
                    "end_token": 218,
                    "children": [
                        {
                            "type": "identifier",
                            "label": "configure_logging",
                            "start_token": 218,
                            "end_token": 218,
                            "children": []
                        }
                    ]
                }
            ]
        },
        {
            "type": "import_from_statement",
            "label": "from backend.util.process import set_service_name",
            "start_token": 220,
            "end_token": 227,
            "children": [
                {
                    "type": "dotted_name",
                    "label": "backend.util.process",
                    "start_token": 221,
                    "end_token": 225,
                    "children": [
                        {
                            "type": "identifier",
                            "label": "backend",
                            "start_token": 221,
                            "end_token": 221,
                            "children": []
                        },
                        {
                            "type": "identifier",
                            "label": "util",
                            "start_token": 223,
                            "end_token": 223,
                            "children": []
                        },
                        {
                            "type": "identifier",
                            "label": "process",
                            "start_token": 225,
                            "end_token": 225,
                            "children": []
                        }
                    ]
                },
                {
                    "type": "dotted_name",
                    "label": "set_service_name",
                    "start_token": 227,
                    "end_token": 227,
                    "children": [
                        {
                            "type": "identifier",
                            "label": "set_service_name",
                            "start_token": 227,
                            "end_token": 227,
                            "children": []
                        }
                    ]
                }
            ]
        },
        {
            "type": "import_from_statement",
            "label": "from backend.util.service import (\n    AppService,\n    close_service_client,\n    expose,\n    get_service_client,\n)",
            "start_token": 229,
            "end_token": 250,
            "children": [
                {
                    "type": "dotted_name",
                    "label": "backend.util.service",
                    "start_token": 230,
                    "end_token": 234,
                    "children": [
                        {
                            "type": "identifier",
                            "label": "backend",
                            "start_token": 230,
                            "end_token": 230,
                            "children": []
                        },
                        {
                            "type": "identifier",
                            "label": "util",
                            "start_token": 232,
                            "end_token": 232,
                            "children": []
                        },
                        {
                            "type": "identifier",
                            "label": "service",
                            "start_token": 234,
                            "end_token": 234,
                            "children": []
                        }
                    ]
                },
                {
                    "type": "dotted_name",
                    "label": "AppService",
                    "start_token": 238,
                    "end_token": 238,
                    "children": [
                        {
                            "type": "identifier",
                            "label": "AppService",
                            "start_token": 238,
                            "end_token": 238,
                            "children": []
                        }
                    ]
                },
                {
                    "type": "dotted_name",
                    "label": "close_service_client",
                    "start_token": 241,
                    "end_token": 241,
                    "children": [
                        {
                            "type": "identifier",
                            "label": "close_service_client",
                            "start_token": 241,
                            "end_token": 241,
                            "children": []
                        }
                    ]
                },
                {
                    "type": "dotted_name",
                    "label": "expose",
                    "start_token": 244,
                    "end_token": 244,
                    "children": [
                        {
                            "type": "identifier",
                            "label": "expose",
                            "start_token": 244,
                            "end_token": 244,
                            "children": []
                        }
                    ]
                },
                {
                    "type": "dotted_name",
                    "label": "get_service_client",
                    "start_token": 247,
                    "end_token": 247,
                    "children": [
                        {
                            "type": "identifier",
                            "label": "get_service_client",
                            "start_token": 247,
                            "end_token": 247,
                            "children": []
                        }
                    ]
                }
            ]
        },
        {
            "type": "import_from_statement",
            "label": "from backend.util.settings import Settings",
            "start_token": 252,
            "end_token": 259,
            "children": [
                {
                    "type": "dotted_name",
                    "label": "backend.util.settings",
                    "start_token": 253,
                    "end_token": 257,
                    "children": [
                        {
                            "type": "identifier",
                            "label": "backend",
                            "start_token": 253,
                            "end_token": 253,
                            "children": []
                        },
                        {
                            "type": "identifier",
                            "label": "util",
                            "start_token": 255,
                            "end_token": 255,
                            "children": []
                        },
                        {
                            "type": "identifier",
                            "label": "settings",
                            "start_token": 257,
                            "end_token": 257,
                            "children": []
                        }
                    ]
                },
                {
                    "type": "dotted_name",
                    "label": "Settings",
                    "start_token": 259,
                    "end_token": 259,
                    "children": [
                        {
                            "type": "identifier",
                            "label": "Settings",
                            "start_token": 259,
                            "end_token": 259,
                            "children": []
                        }
                    ]
                }
            ]
        },
        {
            "type": "import_from_statement",
            "label": "from backend.util.type import convert",
            "start_token": 261,
            "end_token": 268,
            "children": [
                {
                    "type": "dotted_name",
                    "label": "backend.util.type",
                    "start_token": 262,
                    "end_token": 266,
                    "children": [
                        {
                            "type": "identifier",
                            "label": "backend",
                            "start_token": 262,
                            "end_token": 262,
                            "children": []
                        },
                        {
                            "type": "identifier",
                            "label": "util",
                            "start_token": 264,
                            "end_token": 264,
                            "children": []
                        },
                        {
                            "type": "identifier",
                            "label": "type",
                            "start_token": 266,
                            "end_token": 266,
                            "children": []
                        }
                    ]
                },
                {
                    "type": "dotted_name",
                    "label": "convert",
                    "start_token": 268,
                    "end_token": 268,
                    "children": [
                        {
                            "type": "identifier",
                            "label": "convert",
                            "start_token": 268,
                            "end_token": 268,
                            "children": []
                        }
                    ]
                }
            ]
        },
        {
            "type": "expression_statement",
            "label": "logger = logging.getLogger(__name__)",
            "start_token": 271,
            "end_token": 278,
            "children": [
                {
                    "type": "assignment",
                    "label": "logger = logging.getLogger(__name__)",
                    "start_token": 271,
                    "end_token": 278,
                    "children": [
                        {
                            "type": "identifier",
                            "label": "logger",
                            "start_token": 271,
                            "end_token": 271,
                            "children": []
                        },
                        {
                            "type": "call",
                            "label": "logging.getLogger(__name__)",
                            "start_token": 273,
                            "end_token": 278,
                            "children": [
                                {
                                    "type": "attribute",
                                    "label": "logging.getLogger",
                                    "start_token": 273,
                                    "end_token": 275,
                                    "children": [
                                        {
                                            "type": "identifier",
                                            "label": "logging",
                                            "start_token": 273,
                                            "end_token": 273,
                                            "children": []
                                        },
                                        {
                                            "type": "identifier",
                                            "label": "getLogger",
                                            "start_token": 275,
                                            "end_token": 275,
                                            "children": []
                                        }
                                    ]
                                },
                                {
                                    "type": "argument_list",
                                    "label": "(__name__)",
                                    "start_token": 276,
                                    "end_token": 278,
                                    "children": [
                                        {
                                            "type": "identifier",
                                            "label": "__name__",
                                            "start_token": 277,
                                            "end_token": 277,
                                            "children": []
                                        }
                                    ]
                                }
                            ]
                        }
                    ]
                }
            ]
        },
        {
            "type": "expression_statement",
            "label": "settings = Settings()",
            "start_token": 280,
            "end_token": 284,
            "children": [
                {
                    "type": "assignment",
                    "label": "settings = Settings()",
                    "start_token": 280,
                    "end_token": 284,
                    "children": [
                        {
                            "type": "identifier",
                            "label": "settings",
                            "start_token": 280,
                            "end_token": 280,
                            "children": []
                        },
                        {
                            "type": "call",
                            "label": "Settings()",
                            "start_token": 282,
                            "end_token": 284,
                            "children": [
                                {
                                    "type": "identifier",
                                    "label": "Settings",
                                    "start_token": 282,
                                    "end_token": 282,
                                    "children": []
                                },
                                {
                                    "type": "argument_list",
                                    "label": "()",
                                    "start_token": 283,
                                    "end_token": 284,
                                    "children": []
                                }
                            ]
                        }
                    ]
                }
            ]
        },
        {
            "type": "class_definition",
            "label": "class LogMetadata:\n    def __init__(\n        self,\n        user_id: str,\n        graph_eid: str,\n        graph_id: str,\n        node_eid: str,\n        node_id: str,\n        block_name: str,\n    ):\n        self.metadata = {\n            \"component\": \"ExecutionManager\",\n            \"user_id\": user_id,\n            \"graph_eid\": graph_eid,\n            \"graph_id\": graph_id,\n            \"node_eid\": node_eid,\n            \"node_id\": node_id,\n            \"block_name\": block_name,\n        }\n        self.prefix = f\"[ExecutionManager|uid:{user_id}|gid:{graph_id}|nid:{node_id}]|geid:{graph_eid}|nid:{node_eid}|{block_name}]\"\n\n    def info(self, msg: str, **extra):\n        msg = self._wrap(msg, **extra)\n        logger.info(msg, extra={\"json_fields\": {**self.metadata, **extra}})\n\n    def warning(self, msg: str, **extra):\n        msg = self._wrap(msg, **extra)\n        logger.warning(msg, extra={\"json_fields\": {**self.metadata, **extra}})\n\n    def error(self, msg: str, **extra):\n        msg = self._wrap(msg, **extra)\n        logger.error(msg, extra={\"json_fields\": {**self.metadata, **extra}})\n\n    def debug(self, msg: str, **extra):\n        msg = self._wrap(msg, **extra)\n        logger.debug(msg, extra={\"json_fields\": {**self.metadata, **extra}})\n\n    def exception(self, msg: str, **extra):\n        msg = self._wrap(msg, **extra)\n        logger.exception(msg, extra={\"json_fields\": {**self.metadata, **extra}})\n\n    def _wrap(self, msg: str, **extra):\n        return f\"{self.prefix} {msg} {extra}\"",
            "start_token": 288,
            "end_token": 670,
            "children": [
                {
                    "type": "identifier",
                    "label": "LogMetadata",
                    "start_token": 289,
                    "end_token": 289,
                    "children": []
                },
                {
                    "type": "block",
                    "label": "def __init__(\n        self,\n        user_id: str,\n        graph_eid: str,\n        graph_id: str,\n        node_eid: str,\n        node_id: str,\n        block_name: str,\n    ):\n        self.metadata = {\n            \"component\": \"ExecutionManager\",\n            \"user_id\": user_id,\n            \"graph_eid\": graph_eid,\n            \"graph_id\": graph_id,\n            \"node_eid\": node_eid,\n            \"node_id\": node_id,\n            \"block_name\": block_name,\n        }\n        self.prefix = f\"[ExecutionManager|uid:{user_id}|gid:{graph_id}|nid:{node_id}]|geid:{graph_eid}|nid:{node_eid}|{block_name}]\"\n\n    def info(self, msg: str, **extra):\n        msg = self._wrap(msg, **extra)\n        logger.info(msg, extra={\"json_fields\": {**self.metadata, **extra}})\n\n    def warning(self, msg: str, **extra):\n        msg = self._wrap(msg, **extra)\n        logger.warning(msg, extra={\"json_fields\": {**self.metadata, **extra}})\n\n    def error(self, msg: str, **extra):\n        msg = self._wrap(msg, **extra)\n        logger.error(msg, extra={\"json_fields\": {**self.metadata, **extra}})\n\n    def debug(self, msg: str, **extra):\n        msg = self._wrap(msg, **extra)\n        logger.debug(msg, extra={\"json_fields\": {**self.metadata, **extra}})\n\n    def exception(self, msg: str, **extra):\n        msg = self._wrap(msg, **extra)\n        logger.exception(msg, extra={\"json_fields\": {**self.metadata, **extra}})\n\n    def _wrap(self, msg: str, **extra):\n        return f\"{self.prefix} {msg} {extra}\"",
                    "start_token": 292,
                    "end_token": 670,
                    "children": [
                        {
                            "type": "function_definition",
                            "label": "def __init__(\n        self,\n        user_id: str,\n        graph_eid: str,\n        graph_id: str,\n        node_eid: str,\n        node_id: str,\n        block_name: str,\n    ):\n        self.metadata = {\n            \"component\": \"ExecutionManager\",\n            \"user_id\": user_id,\n            \"graph_eid\": graph_eid,\n            \"graph_id\": graph_id,\n            \"node_eid\": node_eid,\n            \"node_id\": node_id,\n            \"block_name\": block_name,\n        }\n        self.prefix = f\"[ExecutionManager|uid:{user_id}|gid:{graph_id}|nid:{node_id}]|geid:{graph_eid}|nid:{node_eid}|{block_name}]\"",
                            "start_token": 292,
                            "end_token": 380,
                            "children": [
                                {
                                    "type": "identifier",
                                    "label": "__init__",
                                    "start_token": 293,
                                    "end_token": 293,
                                    "children": []
                                },
                                {
                                    "type": "parameters",
                                    "label": "(\n        self,\n        user_id: str,\n        graph_eid: str,\n        graph_id: str,\n        node_eid: str,\n        node_id: str,\n        block_name: str,\n    )",
                                    "start_token": 294,
                                    "end_token": 329,
                                    "children": [
                                        {
                                            "type": "identifier",
                                            "label": "self",
                                            "start_token": 296,
                                            "end_token": 296,
                                            "children": []
                                        },
                                        {
                                            "type": "typed_parameter",
                                            "label": "user_id: str",
                                            "start_token": 299,
                                            "end_token": 301,
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "label": "user_id",
                                                    "start_token": 299,
                                                    "end_token": 299,
                                                    "children": []
                                                },
                                                {
                                                    "type": "type",
                                                    "label": "str",
                                                    "start_token": 301,
                                                    "end_token": 301,
                                                    "children": [
                                                        {
                                                            "type": "identifier",
                                                            "label": "str",
                                                            "start_token": 301,
                                                            "end_token": 301,
                                                            "children": []
                                                        }
                                                    ]
                                                }
                                            ]
                                        },
                                        {
                                            "type": "typed_parameter",
                                            "label": "graph_eid: str",
                                            "start_token": 304,
                                            "end_token": 306,
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "label": "graph_eid",
                                                    "start_token": 304,
                                                    "end_token": 304,
                                                    "children": []
                                                },
                                                {
                                                    "type": "type",
                                                    "label": "str",
                                                    "start_token": 306,
                                                    "end_token": 306,
                                                    "children": [
                                                        {
                                                            "type": "identifier",
                                                            "label": "str",
                                                            "start_token": 306,
                                                            "end_token": 306,
                                                            "children": []
                                                        }
                                                    ]
                                                }
                                            ]
                                        },
                                        {
                                            "type": "typed_parameter",
                                            "label": "graph_id: str",
                                            "start_token": 309,
                                            "end_token": 311,
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "label": "graph_id",
                                                    "start_token": 309,
                                                    "end_token": 309,
                                                    "children": []
                                                },
                                                {
                                                    "type": "type",
                                                    "label": "str",
                                                    "start_token": 311,
                                                    "end_token": 311,
                                                    "children": [
                                                        {
                                                            "type": "identifier",
                                                            "label": "str",
                                                            "start_token": 311,
                                                            "end_token": 311,
                                                            "children": []
                                                        }
                                                    ]
                                                }
                                            ]
                                        },
                                        {
                                            "type": "typed_parameter",
                                            "label": "node_eid: str",
                                            "start_token": 314,
                                            "end_token": 316,
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "label": "node_eid",
                                                    "start_token": 314,
                                                    "end_token": 314,
                                                    "children": []
                                                },
                                                {
                                                    "type": "type",
                                                    "label": "str",
                                                    "start_token": 316,
                                                    "end_token": 316,
                                                    "children": [
                                                        {
                                                            "type": "identifier",
                                                            "label": "str",
                                                            "start_token": 316,
                                                            "end_token": 316,
                                                            "children": []
                                                        }
                                                    ]
                                                }
                                            ]
                                        },
                                        {
                                            "type": "typed_parameter",
                                            "label": "node_id: str",
                                            "start_token": 319,
                                            "end_token": 321,
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "label": "node_id",
                                                    "start_token": 319,
                                                    "end_token": 319,
                                                    "children": []
                                                },
                                                {
                                                    "type": "type",
                                                    "label": "str",
                                                    "start_token": 321,
                                                    "end_token": 321,
                                                    "children": [
                                                        {
                                                            "type": "identifier",
                                                            "label": "str",
                                                            "start_token": 321,
                                                            "end_token": 321,
                                                            "children": []
                                                        }
                                                    ]
                                                }
                                            ]
                                        },
                                        {
                                            "type": "typed_parameter",
                                            "label": "block_name: str",
                                            "start_token": 324,
                                            "end_token": 326,
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "label": "block_name",
                                                    "start_token": 324,
                                                    "end_token": 324,
                                                    "children": []
                                                },
                                                {
                                                    "type": "type",
                                                    "label": "str",
                                                    "start_token": 326,
                                                    "end_token": 326,
                                                    "children": [
                                                        {
                                                            "type": "identifier",
                                                            "label": "str",
                                                            "start_token": 326,
                                                            "end_token": 326,
                                                            "children": []
                                                        }
                                                    ]
                                                }
                                            ]
                                        }
                                    ]
                                },
                                {
                                    "type": "block",
                                    "label": "self.metadata = {\n            \"component\": \"ExecutionManager\",\n            \"user_id\": user_id,\n            \"graph_eid\": graph_eid,\n            \"graph_id\": graph_id,\n            \"node_eid\": node_eid,\n            \"node_id\": node_id,\n            \"block_name\": block_name,\n        }\n        self.prefix = f\"[ExecutionManager|uid:{user_id}|gid:{graph_id}|nid:{node_id}]|geid:{graph_eid}|nid:{node_eid}|{block_name}]\"",
                                    "start_token": 332,
                                    "end_token": 380,
                                    "children": [
                                        {
                                            "type": "expression_statement",
                                            "label": "self.metadata = {\n            \"component\": \"ExecutionManager\",\n            \"user_id\": user_id,\n            \"graph_eid\": graph_eid,\n            \"graph_id\": graph_id,\n            \"node_eid\": node_eid,\n            \"node_id\": node_id,\n            \"block_name\": block_name,\n        }",
                                            "start_token": 332,
                                            "end_token": 373,
                                            "children": [
                                                {
                                                    "type": "assignment",
                                                    "label": "self.metadata = {\n            \"component\": \"ExecutionManager\",\n            \"user_id\": user_id,\n            \"graph_eid\": graph_eid,\n            \"graph_id\": graph_id,\n            \"node_eid\": node_eid,\n            \"node_id\": node_id,\n            \"block_name\": block_name,\n        }",
                                                    "start_token": 332,
                                                    "end_token": 373,
                                                    "children": [
                                                        {
                                                            "type": "attribute",
                                                            "label": "self.metadata",
                                                            "start_token": 332,
                                                            "end_token": 334,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "label": "self",
                                                                    "start_token": 332,
                                                                    "end_token": 332,
                                                                    "children": []
                                                                },
                                                                {
                                                                    "type": "identifier",
                                                                    "label": "metadata",
                                                                    "start_token": 334,
                                                                    "end_token": 334,
                                                                    "children": []
                                                                }
                                                            ]
                                                        },
                                                        {
                                                            "type": "dictionary",
                                                            "label": "{\n            \"component\": \"ExecutionManager\",\n            \"user_id\": user_id,\n            \"graph_eid\": graph_eid,\n            \"graph_id\": graph_id,\n            \"node_eid\": node_eid,\n            \"node_id\": node_id,\n            \"block_name\": block_name,\n        }",
                                                            "start_token": 336,
                                                            "end_token": 373,
                                                            "children": [
                                                                {
                                                                    "type": "pair",
                                                                    "label": "\"component\": \"ExecutionManager\"",
                                                                    "start_token": 338,
                                                                    "end_token": 340,
                                                                    "children": [
                                                                        {
                                                                            "type": "string",
                                                                            "label": "\"component\"",
                                                                            "start_token": 338,
                                                                            "end_token": 338,
                                                                            "children": [
                                                                                {
                                                                                    "type": "string_start",
                                                                                    "label": "\"",
                                                                                    "start_token": 338,
                                                                                    "end_token": 338,
                                                                                    "children": []
                                                                                },
                                                                                {
                                                                                    "type": "string_content",
                                                                                    "label": "component",
                                                                                    "start_token": 338,
                                                                                    "end_token": 338,
                                                                                    "children": []
                                                                                },
                                                                                {
                                                                                    "type": "string_end",
                                                                                    "label": "\"",
                                                                                    "start_token": 338,
                                                                                    "end_token": 338,
                                                                                    "children": []
                                                                                }
                                                                            ]
                                                                        },
                                                                        {
                                                                            "type": "string",
                                                                            "label": "\"ExecutionManager\"",
                                                                            "start_token": 340,
                                                                            "end_token": 340,
                                                                            "children": [
                                                                                {
                                                                                    "type": "string_start",
                                                                                    "label": "\"",
                                                                                    "start_token": 340,
                                                                                    "end_token": 340,
                                                                                    "children": []
                                                                                },
                                                                                {
                                                                                    "type": "string_content",
                                                                                    "label": "ExecutionManager",
                                                                                    "start_token": 340,
                                                                                    "end_token": 340,
                                                                                    "children": []
                                                                                },
                                                                                {
                                                                                    "type": "string_end",
                                                                                    "label": "\"",
                                                                                    "start_token": 340,
                                                                                    "end_token": 340,
                                                                                    "children": []
                                                                                }
                                                                            ]
                                                                        }
                                                                    ]
                                                                },
                                                                {
                                                                    "type": "pair",
                                                                    "label": "\"user_id\": user_id",
                                                                    "start_token": 343,
                                                                    "end_token": 345,
                                                                    "children": [
                                                                        {
                                                                            "type": "string",
                                                                            "label": "\"user_id\"",
                                                                            "start_token": 343,
                                                                            "end_token": 343,
                                                                            "children": [
                                                                                {
                                                                                    "type": "string_start",
                                                                                    "label": "\"",
                                                                                    "start_token": 343,
                                                                                    "end_token": 343,
                                                                                    "children": []
                                                                                },
                                                                                {
                                                                                    "type": "string_content",
                                                                                    "label": "user_id",
                                                                                    "start_token": 343,
                                                                                    "end_token": 343,
                                                                                    "children": []
                                                                                },
                                                                                {
                                                                                    "type": "string_end",
                                                                                    "label": "\"",
                                                                                    "start_token": 343,
                                                                                    "end_token": 343,
                                                                                    "children": []
                                                                                }
                                                                            ]
                                                                        },
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "user_id",
                                                                            "start_token": 345,
                                                                            "end_token": 345,
                                                                            "children": []
                                                                        }
                                                                    ]
                                                                },
                                                                {
                                                                    "type": "pair",
                                                                    "label": "\"graph_eid\": graph_eid",
                                                                    "start_token": 348,
                                                                    "end_token": 350,
                                                                    "children": [
                                                                        {
                                                                            "type": "string",
                                                                            "label": "\"graph_eid\"",
                                                                            "start_token": 348,
                                                                            "end_token": 348,
                                                                            "children": [
                                                                                {
                                                                                    "type": "string_start",
                                                                                    "label": "\"",
                                                                                    "start_token": 348,
                                                                                    "end_token": 348,
                                                                                    "children": []
                                                                                },
                                                                                {
                                                                                    "type": "string_content",
                                                                                    "label": "graph_eid",
                                                                                    "start_token": 348,
                                                                                    "end_token": 348,
                                                                                    "children": []
                                                                                },
                                                                                {
                                                                                    "type": "string_end",
                                                                                    "label": "\"",
                                                                                    "start_token": 348,
                                                                                    "end_token": 348,
                                                                                    "children": []
                                                                                }
                                                                            ]
                                                                        },
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "graph_eid",
                                                                            "start_token": 350,
                                                                            "end_token": 350,
                                                                            "children": []
                                                                        }
                                                                    ]
                                                                },
                                                                {
                                                                    "type": "pair",
                                                                    "label": "\"graph_id\": graph_id",
                                                                    "start_token": 353,
                                                                    "end_token": 355,
                                                                    "children": [
                                                                        {
                                                                            "type": "string",
                                                                            "label": "\"graph_id\"",
                                                                            "start_token": 353,
                                                                            "end_token": 353,
                                                                            "children": [
                                                                                {
                                                                                    "type": "string_start",
                                                                                    "label": "\"",
                                                                                    "start_token": 353,
                                                                                    "end_token": 353,
                                                                                    "children": []
                                                                                },
                                                                                {
                                                                                    "type": "string_content",
                                                                                    "label": "graph_id",
                                                                                    "start_token": 353,
                                                                                    "end_token": 353,
                                                                                    "children": []
                                                                                },
                                                                                {
                                                                                    "type": "string_end",
                                                                                    "label": "\"",
                                                                                    "start_token": 353,
                                                                                    "end_token": 353,
                                                                                    "children": []
                                                                                }
                                                                            ]
                                                                        },
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "graph_id",
                                                                            "start_token": 355,
                                                                            "end_token": 355,
                                                                            "children": []
                                                                        }
                                                                    ]
                                                                },
                                                                {
                                                                    "type": "pair",
                                                                    "label": "\"node_eid\": node_eid",
                                                                    "start_token": 358,
                                                                    "end_token": 360,
                                                                    "children": [
                                                                        {
                                                                            "type": "string",
                                                                            "label": "\"node_eid\"",
                                                                            "start_token": 358,
                                                                            "end_token": 358,
                                                                            "children": [
                                                                                {
                                                                                    "type": "string_start",
                                                                                    "label": "\"",
                                                                                    "start_token": 358,
                                                                                    "end_token": 358,
                                                                                    "children": []
                                                                                },
                                                                                {
                                                                                    "type": "string_content",
                                                                                    "label": "node_eid",
                                                                                    "start_token": 358,
                                                                                    "end_token": 358,
                                                                                    "children": []
                                                                                },
                                                                                {
                                                                                    "type": "string_end",
                                                                                    "label": "\"",
                                                                                    "start_token": 358,
                                                                                    "end_token": 358,
                                                                                    "children": []
                                                                                }
                                                                            ]
                                                                        },
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "node_eid",
                                                                            "start_token": 360,
                                                                            "end_token": 360,
                                                                            "children": []
                                                                        }
                                                                    ]
                                                                },
                                                                {
                                                                    "type": "pair",
                                                                    "label": "\"node_id\": node_id",
                                                                    "start_token": 363,
                                                                    "end_token": 365,
                                                                    "children": [
                                                                        {
                                                                            "type": "string",
                                                                            "label": "\"node_id\"",
                                                                            "start_token": 363,
                                                                            "end_token": 363,
                                                                            "children": [
                                                                                {
                                                                                    "type": "string_start",
                                                                                    "label": "\"",
                                                                                    "start_token": 363,
                                                                                    "end_token": 363,
                                                                                    "children": []
                                                                                },
                                                                                {
                                                                                    "type": "string_content",
                                                                                    "label": "node_id",
                                                                                    "start_token": 363,
                                                                                    "end_token": 363,
                                                                                    "children": []
                                                                                },
                                                                                {
                                                                                    "type": "string_end",
                                                                                    "label": "\"",
                                                                                    "start_token": 363,
                                                                                    "end_token": 363,
                                                                                    "children": []
                                                                                }
                                                                            ]
                                                                        },
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "node_id",
                                                                            "start_token": 365,
                                                                            "end_token": 365,
                                                                            "children": []
                                                                        }
                                                                    ]
                                                                },
                                                                {
                                                                    "type": "pair",
                                                                    "label": "\"block_name\": block_name",
                                                                    "start_token": 368,
                                                                    "end_token": 370,
                                                                    "children": [
                                                                        {
                                                                            "type": "string",
                                                                            "label": "\"block_name\"",
                                                                            "start_token": 368,
                                                                            "end_token": 368,
                                                                            "children": [
                                                                                {
                                                                                    "type": "string_start",
                                                                                    "label": "\"",
                                                                                    "start_token": 368,
                                                                                    "end_token": 368,
                                                                                    "children": []
                                                                                },
                                                                                {
                                                                                    "type": "string_content",
                                                                                    "label": "block_name",
                                                                                    "start_token": 368,
                                                                                    "end_token": 368,
                                                                                    "children": []
                                                                                },
                                                                                {
                                                                                    "type": "string_end",
                                                                                    "label": "\"",
                                                                                    "start_token": 368,
                                                                                    "end_token": 368,
                                                                                    "children": []
                                                                                }
                                                                            ]
                                                                        },
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "block_name",
                                                                            "start_token": 370,
                                                                            "end_token": 370,
                                                                            "children": []
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                }
                                            ]
                                        },
                                        {
                                            "type": "expression_statement",
                                            "label": "self.prefix = f\"[ExecutionManager|uid:{user_id}|gid:{graph_id}|nid:{node_id}]|geid:{graph_eid}|nid:{node_eid}|{block_name}]\"",
                                            "start_token": 375,
                                            "end_token": 380,
                                            "children": [
                                                {
                                                    "type": "assignment",
                                                    "label": "self.prefix = f\"[ExecutionManager|uid:{user_id}|gid:{graph_id}|nid:{node_id}]|geid:{graph_eid}|nid:{node_eid}|{block_name}]\"",
                                                    "start_token": 375,
                                                    "end_token": 380,
                                                    "children": [
                                                        {
                                                            "type": "attribute",
                                                            "label": "self.prefix",
                                                            "start_token": 375,
                                                            "end_token": 377,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "label": "self",
                                                                    "start_token": 375,
                                                                    "end_token": 375,
                                                                    "children": []
                                                                },
                                                                {
                                                                    "type": "identifier",
                                                                    "label": "prefix",
                                                                    "start_token": 377,
                                                                    "end_token": 377,
                                                                    "children": []
                                                                }
                                                            ]
                                                        },
                                                        {
                                                            "type": "string",
                                                            "label": "f\"[ExecutionManager|uid:{user_id}|gid:{graph_id}|nid:{node_id}]|geid:{graph_eid}|nid:{node_eid}|{block_name}]\"",
                                                            "start_token": 379,
                                                            "end_token": 380,
                                                            "children": [
                                                                {
                                                                    "type": "string_start",
                                                                    "label": "f\"",
                                                                    "start_token": 379,
                                                                    "end_token": 380,
                                                                    "children": []
                                                                },
                                                                {
                                                                    "type": "string_content",
                                                                    "label": "[ExecutionManager|uid:",
                                                                    "start_token": 380,
                                                                    "end_token": 380,
                                                                    "children": []
                                                                },
                                                                {
                                                                    "type": "interpolation",
                                                                    "label": "{user_id}",
                                                                    "start_token": 380,
                                                                    "end_token": 380,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "user_id",
                                                                            "start_token": 380,
                                                                            "end_token": 380,
                                                                            "children": []
                                                                        }
                                                                    ]
                                                                },
                                                                {
                                                                    "type": "string_content",
                                                                    "label": "|gid:",
                                                                    "start_token": 380,
                                                                    "end_token": 380,
                                                                    "children": []
                                                                },
                                                                {
                                                                    "type": "interpolation",
                                                                    "label": "{graph_id}",
                                                                    "start_token": 380,
                                                                    "end_token": 380,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "graph_id",
                                                                            "start_token": 380,
                                                                            "end_token": 380,
                                                                            "children": []
                                                                        }
                                                                    ]
                                                                },
                                                                {
                                                                    "type": "string_content",
                                                                    "label": "|nid:",
                                                                    "start_token": 380,
                                                                    "end_token": 380,
                                                                    "children": []
                                                                },
                                                                {
                                                                    "type": "interpolation",
                                                                    "label": "{node_id}",
                                                                    "start_token": 380,
                                                                    "end_token": 380,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "node_id",
                                                                            "start_token": 380,
                                                                            "end_token": 380,
                                                                            "children": []
                                                                        }
                                                                    ]
                                                                },
                                                                {
                                                                    "type": "string_content",
                                                                    "label": "]|geid:",
                                                                    "start_token": 380,
                                                                    "end_token": 380,
                                                                    "children": []
                                                                },
                                                                {
                                                                    "type": "interpolation",
                                                                    "label": "{graph_eid}",
                                                                    "start_token": 380,
                                                                    "end_token": 380,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "graph_eid",
                                                                            "start_token": 380,
                                                                            "end_token": 380,
                                                                            "children": []
                                                                        }
                                                                    ]
                                                                },
                                                                {
                                                                    "type": "string_content",
                                                                    "label": "|nid:",
                                                                    "start_token": 380,
                                                                    "end_token": 380,
                                                                    "children": []
                                                                },
                                                                {
                                                                    "type": "interpolation",
                                                                    "label": "{node_eid}",
                                                                    "start_token": 380,
                                                                    "end_token": 380,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "node_eid",
                                                                            "start_token": 380,
                                                                            "end_token": 380,
                                                                            "children": []
                                                                        }
                                                                    ]
                                                                },
                                                                {
                                                                    "type": "string_content",
                                                                    "label": "|",
                                                                    "start_token": 380,
                                                                    "end_token": 380,
                                                                    "children": []
                                                                },
                                                                {
                                                                    "type": "interpolation",
                                                                    "label": "{block_name}",
                                                                    "start_token": 380,
                                                                    "end_token": 380,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "block_name",
                                                                            "start_token": 380,
                                                                            "end_token": 380,
                                                                            "children": []
                                                                        }
                                                                    ]
                                                                },
                                                                {
                                                                    "type": "string_content",
                                                                    "label": "]",
                                                                    "start_token": 380,
                                                                    "end_token": 380,
                                                                    "children": []
                                                                },
                                                                {
                                                                    "type": "string_end",
                                                                    "label": "\"",
                                                                    "start_token": 380,
                                                                    "end_token": 380,
                                                                    "children": []
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                }
                                            ]
                                        }
                                    ]
                                }
                            ]
                        },
                        {
                            "type": "function_definition",
                            "label": "def info(self, msg: str, **extra):\n        msg = self._wrap(msg, **extra)\n        logger.info(msg, extra={\"json_fields\": {**self.metadata, **extra}})",
                            "start_token": 383,
                            "end_token": 434,
                            "children": [
                                {
                                    "type": "identifier",
                                    "label": "info",
                                    "start_token": 384,
                                    "end_token": 384,
                                    "children": []
                                },
                                {
                                    "type": "parameters",
                                    "label": "(self, msg: str, **extra)",
                                    "start_token": 385,
                                    "end_token": 395,
                                    "children": [
                                        {
                                            "type": "identifier",
                                            "label": "self",
                                            "start_token": 386,
                                            "end_token": 386,
                                            "children": []
                                        },
                                        {
                                            "type": "typed_parameter",
                                            "label": "msg: str",
                                            "start_token": 388,
                                            "end_token": 390,
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "label": "msg",
                                                    "start_token": 388,
                                                    "end_token": 388,
                                                    "children": []
                                                },
                                                {
                                                    "type": "type",
                                                    "label": "str",
                                                    "start_token": 390,
                                                    "end_token": 390,
                                                    "children": [
                                                        {
                                                            "type": "identifier",
                                                            "label": "str",
                                                            "start_token": 390,
                                                            "end_token": 390,
                                                            "children": []
                                                        }
                                                    ]
                                                }
                                            ]
                                        },
                                        {
                                            "type": "dictionary_splat_pattern",
                                            "label": "**extra",
                                            "start_token": 392,
                                            "end_token": 394,
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "label": "extra",
                                                    "start_token": 394,
                                                    "end_token": 394,
                                                    "children": []
                                                }
                                            ]
                                        }
                                    ]
                                },
                                {
                                    "type": "block",
                                    "label": "msg = self._wrap(msg, **extra)\n        logger.info(msg, extra={\"json_fields\": {**self.metadata, **extra}})",
                                    "start_token": 398,
                                    "end_token": 434,
                                    "children": [
                                        {
                                            "type": "expression_statement",
                                            "label": "msg = self._wrap(msg, **extra)",
                                            "start_token": 398,
                                            "end_token": 409,
                                            "children": [
                                                {
                                                    "type": "assignment",
                                                    "label": "msg = self._wrap(msg, **extra)",
                                                    "start_token": 398,
                                                    "end_token": 409,
                                                    "children": [
                                                        {
                                                            "type": "identifier",
                                                            "label": "msg",
                                                            "start_token": 398,
                                                            "end_token": 398,
                                                            "children": []
                                                        },
                                                        {
                                                            "type": "call",
                                                            "label": "self._wrap(msg, **extra)",
                                                            "start_token": 400,
                                                            "end_token": 409,
                                                            "children": [
                                                                {
                                                                    "type": "attribute",
                                                                    "label": "self._wrap",
                                                                    "start_token": 400,
                                                                    "end_token": 402,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "self",
                                                                            "start_token": 400,
                                                                            "end_token": 400,
                                                                            "children": []
                                                                        },
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "_wrap",
                                                                            "start_token": 402,
                                                                            "end_token": 402,
                                                                            "children": []
                                                                        }
                                                                    ]
                                                                },
                                                                {
                                                                    "type": "argument_list",
                                                                    "label": "(msg, **extra)",
                                                                    "start_token": 403,
                                                                    "end_token": 409,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "msg",
                                                                            "start_token": 404,
                                                                            "end_token": 404,
                                                                            "children": []
                                                                        },
                                                                        {
                                                                            "type": "dictionary_splat",
                                                                            "label": "**extra",
                                                                            "start_token": 406,
                                                                            "end_token": 408,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "extra",
                                                                                    "start_token": 408,
                                                                                    "end_token": 408,
                                                                                    "children": []
                                                                                }
                                                                            ]
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                }
                                            ]
                                        },
                                        {
                                            "type": "expression_statement",
                                            "label": "logger.info(msg, extra={\"json_fields\": {**self.metadata, **extra}})",
                                            "start_token": 411,
                                            "end_token": 434,
                                            "children": [
                                                {
                                                    "type": "call",
                                                    "label": "logger.info(msg, extra={\"json_fields\": {**self.metadata, **extra}})",
                                                    "start_token": 411,
                                                    "end_token": 434,
                                                    "children": [
                                                        {
                                                            "type": "attribute",
                                                            "label": "logger.info",
                                                            "start_token": 411,
                                                            "end_token": 413,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "label": "logger",
                                                                    "start_token": 411,
                                                                    "end_token": 411,
                                                                    "children": []
                                                                },
                                                                {
                                                                    "type": "identifier",
                                                                    "label": "info",
                                                                    "start_token": 413,
                                                                    "end_token": 413,
                                                                    "children": []
                                                                }
                                                            ]
                                                        },
                                                        {
                                                            "type": "argument_list",
                                                            "label": "(msg, extra={\"json_fields\": {**self.metadata, **extra}})",
                                                            "start_token": 414,
                                                            "end_token": 434,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "label": "msg",
                                                                    "start_token": 415,
                                                                    "end_token": 415,
                                                                    "children": []
                                                                },
                                                                {
                                                                    "type": "keyword_argument",
                                                                    "label": "extra={\"json_fields\": {**self.metadata, **extra}}",
                                                                    "start_token": 417,
                                                                    "end_token": 433,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "extra",
                                                                            "start_token": 417,
                                                                            "end_token": 417,
                                                                            "children": []
                                                                        },
                                                                        {
                                                                            "type": "dictionary",
                                                                            "label": "{\"json_fields\": {**self.metadata, **extra}}",
                                                                            "start_token": 419,
                                                                            "end_token": 433,
                                                                            "children": [
                                                                                {
                                                                                    "type": "pair",
                                                                                    "label": "\"json_fields\": {**self.metadata, **extra}",
                                                                                    "start_token": 420,
                                                                                    "end_token": 432,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "string",
                                                                                            "label": "\"json_fields\"",
                                                                                            "start_token": 420,
                                                                                            "end_token": 420,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "string_start",
                                                                                                    "label": "\"",
                                                                                                    "start_token": 420,
                                                                                                    "end_token": 420,
                                                                                                    "children": []
                                                                                                },
                                                                                                {
                                                                                                    "type": "string_content",
                                                                                                    "label": "json_fields",
                                                                                                    "start_token": 420,
                                                                                                    "end_token": 420,
                                                                                                    "children": []
                                                                                                },
                                                                                                {
                                                                                                    "type": "string_end",
                                                                                                    "label": "\"",
                                                                                                    "start_token": 420,
                                                                                                    "end_token": 420,
                                                                                                    "children": []
                                                                                                }
                                                                                            ]
                                                                                        },
                                                                                        {
                                                                                            "type": "dictionary",
                                                                                            "label": "{**self.metadata, **extra}",
                                                                                            "start_token": 422,
                                                                                            "end_token": 432,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "dictionary_splat",
                                                                                                    "label": "**self.metadata",
                                                                                                    "start_token": 423,
                                                                                                    "end_token": 427,
                                                                                                    "children": [
                                                                                                        {
                                                                                                            "type": "attribute",
                                                                                                            "label": "self.metadata",
                                                                                                            "start_token": 425,
                                                                                                            "end_token": 427,
                                                                                                            "children": [
                                                                                                                {
                                                                                                                    "type": "identifier",
                                                                                                                    "label": "self",
                                                                                                                    "start_token": 425,
                                                                                                                    "end_token": 425,
                                                                                                                    "children": []
                                                                                                                },
                                                                                                                {
                                                                                                                    "type": "identifier",
                                                                                                                    "label": "metadata",
                                                                                                                    "start_token": 427,
                                                                                                                    "end_token": 427,
                                                                                                                    "children": []
                                                                                                                }
                                                                                                            ]
                                                                                                        }
                                                                                                    ]
                                                                                                },
                                                                                                {
                                                                                                    "type": "dictionary_splat",
                                                                                                    "label": "**extra",
                                                                                                    "start_token": 429,
                                                                                                    "end_token": 431,
                                                                                                    "children": [
                                                                                                        {
                                                                                                            "type": "identifier",
                                                                                                            "label": "extra",
                                                                                                            "start_token": 431,
                                                                                                            "end_token": 431,
                                                                                                            "children": []
                                                                                                        }
                                                                                                    ]
                                                                                                }
                                                                                            ]
                                                                                        }
                                                                                    ]
                                                                                }
                                                                            ]
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                }
                                            ]
                                        }
                                    ]
                                }
                            ]
                        },
                        {
                            "type": "function_definition",
                            "label": "def warning(self, msg: str, **extra):\n        msg = self._wrap(msg, **extra)\n        logger.warning(msg, extra={\"json_fields\": {**self.metadata, **extra}})",
                            "start_token": 437,
                            "end_token": 488,
                            "children": [
                                {
                                    "type": "identifier",
                                    "label": "warning",
                                    "start_token": 438,
                                    "end_token": 438,
                                    "children": []
                                },
                                {
                                    "type": "parameters",
                                    "label": "(self, msg: str, **extra)",
                                    "start_token": 439,
                                    "end_token": 449,
                                    "children": [
                                        {
                                            "type": "identifier",
                                            "label": "self",
                                            "start_token": 440,
                                            "end_token": 440,
                                            "children": []
                                        },
                                        {
                                            "type": "typed_parameter",
                                            "label": "msg: str",
                                            "start_token": 442,
                                            "end_token": 444,
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "label": "msg",
                                                    "start_token": 442,
                                                    "end_token": 442,
                                                    "children": []
                                                },
                                                {
                                                    "type": "type",
                                                    "label": "str",
                                                    "start_token": 444,
                                                    "end_token": 444,
                                                    "children": [
                                                        {
                                                            "type": "identifier",
                                                            "label": "str",
                                                            "start_token": 444,
                                                            "end_token": 444,
                                                            "children": []
                                                        }
                                                    ]
                                                }
                                            ]
                                        },
                                        {
                                            "type": "dictionary_splat_pattern",
                                            "label": "**extra",
                                            "start_token": 446,
                                            "end_token": 448,
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "label": "extra",
                                                    "start_token": 448,
                                                    "end_token": 448,
                                                    "children": []
                                                }
                                            ]
                                        }
                                    ]
                                },
                                {
                                    "type": "block",
                                    "label": "msg = self._wrap(msg, **extra)\n        logger.warning(msg, extra={\"json_fields\": {**self.metadata, **extra}})",
                                    "start_token": 452,
                                    "end_token": 488,
                                    "children": [
                                        {
                                            "type": "expression_statement",
                                            "label": "msg = self._wrap(msg, **extra)",
                                            "start_token": 452,
                                            "end_token": 463,
                                            "children": [
                                                {
                                                    "type": "assignment",
                                                    "label": "msg = self._wrap(msg, **extra)",
                                                    "start_token": 452,
                                                    "end_token": 463,
                                                    "children": [
                                                        {
                                                            "type": "identifier",
                                                            "label": "msg",
                                                            "start_token": 452,
                                                            "end_token": 452,
                                                            "children": []
                                                        },
                                                        {
                                                            "type": "call",
                                                            "label": "self._wrap(msg, **extra)",
                                                            "start_token": 454,
                                                            "end_token": 463,
                                                            "children": [
                                                                {
                                                                    "type": "attribute",
                                                                    "label": "self._wrap",
                                                                    "start_token": 454,
                                                                    "end_token": 456,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "self",
                                                                            "start_token": 454,
                                                                            "end_token": 454,
                                                                            "children": []
                                                                        },
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "_wrap",
                                                                            "start_token": 456,
                                                                            "end_token": 456,
                                                                            "children": []
                                                                        }
                                                                    ]
                                                                },
                                                                {
                                                                    "type": "argument_list",
                                                                    "label": "(msg, **extra)",
                                                                    "start_token": 457,
                                                                    "end_token": 463,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "msg",
                                                                            "start_token": 458,
                                                                            "end_token": 458,
                                                                            "children": []
                                                                        },
                                                                        {
                                                                            "type": "dictionary_splat",
                                                                            "label": "**extra",
                                                                            "start_token": 460,
                                                                            "end_token": 462,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "extra",
                                                                                    "start_token": 462,
                                                                                    "end_token": 462,
                                                                                    "children": []
                                                                                }
                                                                            ]
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                }
                                            ]
                                        },
                                        {
                                            "type": "expression_statement",
                                            "label": "logger.warning(msg, extra={\"json_fields\": {**self.metadata, **extra}})",
                                            "start_token": 465,
                                            "end_token": 488,
                                            "children": [
                                                {
                                                    "type": "call",
                                                    "label": "logger.warning(msg, extra={\"json_fields\": {**self.metadata, **extra}})",
                                                    "start_token": 465,
                                                    "end_token": 488,
                                                    "children": [
                                                        {
                                                            "type": "attribute",
                                                            "label": "logger.warning",
                                                            "start_token": 465,
                                                            "end_token": 467,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "label": "logger",
                                                                    "start_token": 465,
                                                                    "end_token": 465,
                                                                    "children": []
                                                                },
                                                                {
                                                                    "type": "identifier",
                                                                    "label": "warning",
                                                                    "start_token": 467,
                                                                    "end_token": 467,
                                                                    "children": []
                                                                }
                                                            ]
                                                        },
                                                        {
                                                            "type": "argument_list",
                                                            "label": "(msg, extra={\"json_fields\": {**self.metadata, **extra}})",
                                                            "start_token": 468,
                                                            "end_token": 488,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "label": "msg",
                                                                    "start_token": 469,
                                                                    "end_token": 469,
                                                                    "children": []
                                                                },
                                                                {
                                                                    "type": "keyword_argument",
                                                                    "label": "extra={\"json_fields\": {**self.metadata, **extra}}",
                                                                    "start_token": 471,
                                                                    "end_token": 487,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "extra",
                                                                            "start_token": 471,
                                                                            "end_token": 471,
                                                                            "children": []
                                                                        },
                                                                        {
                                                                            "type": "dictionary",
                                                                            "label": "{\"json_fields\": {**self.metadata, **extra}}",
                                                                            "start_token": 473,
                                                                            "end_token": 487,
                                                                            "children": [
                                                                                {
                                                                                    "type": "pair",
                                                                                    "label": "\"json_fields\": {**self.metadata, **extra}",
                                                                                    "start_token": 474,
                                                                                    "end_token": 486,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "string",
                                                                                            "label": "\"json_fields\"",
                                                                                            "start_token": 474,
                                                                                            "end_token": 474,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "string_start",
                                                                                                    "label": "\"",
                                                                                                    "start_token": 474,
                                                                                                    "end_token": 474,
                                                                                                    "children": []
                                                                                                },
                                                                                                {
                                                                                                    "type": "string_content",
                                                                                                    "label": "json_fields",
                                                                                                    "start_token": 474,
                                                                                                    "end_token": 474,
                                                                                                    "children": []
                                                                                                },
                                                                                                {
                                                                                                    "type": "string_end",
                                                                                                    "label": "\"",
                                                                                                    "start_token": 474,
                                                                                                    "end_token": 474,
                                                                                                    "children": []
                                                                                                }
                                                                                            ]
                                                                                        },
                                                                                        {
                                                                                            "type": "dictionary",
                                                                                            "label": "{**self.metadata, **extra}",
                                                                                            "start_token": 476,
                                                                                            "end_token": 486,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "dictionary_splat",
                                                                                                    "label": "**self.metadata",
                                                                                                    "start_token": 477,
                                                                                                    "end_token": 481,
                                                                                                    "children": [
                                                                                                        {
                                                                                                            "type": "attribute",
                                                                                                            "label": "self.metadata",
                                                                                                            "start_token": 479,
                                                                                                            "end_token": 481,
                                                                                                            "children": [
                                                                                                                {
                                                                                                                    "type": "identifier",
                                                                                                                    "label": "self",
                                                                                                                    "start_token": 479,
                                                                                                                    "end_token": 479,
                                                                                                                    "children": []
                                                                                                                },
                                                                                                                {
                                                                                                                    "type": "identifier",
                                                                                                                    "label": "metadata",
                                                                                                                    "start_token": 481,
                                                                                                                    "end_token": 481,
                                                                                                                    "children": []
                                                                                                                }
                                                                                                            ]
                                                                                                        }
                                                                                                    ]
                                                                                                },
                                                                                                {
                                                                                                    "type": "dictionary_splat",
                                                                                                    "label": "**extra",
                                                                                                    "start_token": 483,
                                                                                                    "end_token": 485,
                                                                                                    "children": [
                                                                                                        {
                                                                                                            "type": "identifier",
                                                                                                            "label": "extra",
                                                                                                            "start_token": 485,
                                                                                                            "end_token": 485,
                                                                                                            "children": []
                                                                                                        }
                                                                                                    ]
                                                                                                }
                                                                                            ]
                                                                                        }
                                                                                    ]
                                                                                }
                                                                            ]
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                }
                                            ]
                                        }
                                    ]
                                }
                            ]
                        },
                        {
                            "type": "function_definition",
                            "label": "def error(self, msg: str, **extra):\n        msg = self._wrap(msg, **extra)\n        logger.error(msg, extra={\"json_fields\": {**self.metadata, **extra}})",
                            "start_token": 491,
                            "end_token": 542,
                            "children": [
                                {
                                    "type": "identifier",
                                    "label": "error",
                                    "start_token": 492,
                                    "end_token": 492,
                                    "children": []
                                },
                                {
                                    "type": "parameters",
                                    "label": "(self, msg: str, **extra)",
                                    "start_token": 493,
                                    "end_token": 503,
                                    "children": [
                                        {
                                            "type": "identifier",
                                            "label": "self",
                                            "start_token": 494,
                                            "end_token": 494,
                                            "children": []
                                        },
                                        {
                                            "type": "typed_parameter",
                                            "label": "msg: str",
                                            "start_token": 496,
                                            "end_token": 498,
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "label": "msg",
                                                    "start_token": 496,
                                                    "end_token": 496,
                                                    "children": []
                                                },
                                                {
                                                    "type": "type",
                                                    "label": "str",
                                                    "start_token": 498,
                                                    "end_token": 498,
                                                    "children": [
                                                        {
                                                            "type": "identifier",
                                                            "label": "str",
                                                            "start_token": 498,
                                                            "end_token": 498,
                                                            "children": []
                                                        }
                                                    ]
                                                }
                                            ]
                                        },
                                        {
                                            "type": "dictionary_splat_pattern",
                                            "label": "**extra",
                                            "start_token": 500,
                                            "end_token": 502,
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "label": "extra",
                                                    "start_token": 502,
                                                    "end_token": 502,
                                                    "children": []
                                                }
                                            ]
                                        }
                                    ]
                                },
                                {
                                    "type": "block",
                                    "label": "msg = self._wrap(msg, **extra)\n        logger.error(msg, extra={\"json_fields\": {**self.metadata, **extra}})",
                                    "start_token": 506,
                                    "end_token": 542,
                                    "children": [
                                        {
                                            "type": "expression_statement",
                                            "label": "msg = self._wrap(msg, **extra)",
                                            "start_token": 506,
                                            "end_token": 517,
                                            "children": [
                                                {
                                                    "type": "assignment",
                                                    "label": "msg = self._wrap(msg, **extra)",
                                                    "start_token": 506,
                                                    "end_token": 517,
                                                    "children": [
                                                        {
                                                            "type": "identifier",
                                                            "label": "msg",
                                                            "start_token": 506,
                                                            "end_token": 506,
                                                            "children": []
                                                        },
                                                        {
                                                            "type": "call",
                                                            "label": "self._wrap(msg, **extra)",
                                                            "start_token": 508,
                                                            "end_token": 517,
                                                            "children": [
                                                                {
                                                                    "type": "attribute",
                                                                    "label": "self._wrap",
                                                                    "start_token": 508,
                                                                    "end_token": 510,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "self",
                                                                            "start_token": 508,
                                                                            "end_token": 508,
                                                                            "children": []
                                                                        },
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "_wrap",
                                                                            "start_token": 510,
                                                                            "end_token": 510,
                                                                            "children": []
                                                                        }
                                                                    ]
                                                                },
                                                                {
                                                                    "type": "argument_list",
                                                                    "label": "(msg, **extra)",
                                                                    "start_token": 511,
                                                                    "end_token": 517,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "msg",
                                                                            "start_token": 512,
                                                                            "end_token": 512,
                                                                            "children": []
                                                                        },
                                                                        {
                                                                            "type": "dictionary_splat",
                                                                            "label": "**extra",
                                                                            "start_token": 514,
                                                                            "end_token": 516,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "extra",
                                                                                    "start_token": 516,
                                                                                    "end_token": 516,
                                                                                    "children": []
                                                                                }
                                                                            ]
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                }
                                            ]
                                        },
                                        {
                                            "type": "expression_statement",
                                            "label": "logger.error(msg, extra={\"json_fields\": {**self.metadata, **extra}})",
                                            "start_token": 519,
                                            "end_token": 542,
                                            "children": [
                                                {
                                                    "type": "call",
                                                    "label": "logger.error(msg, extra={\"json_fields\": {**self.metadata, **extra}})",
                                                    "start_token": 519,
                                                    "end_token": 542,
                                                    "children": [
                                                        {
                                                            "type": "attribute",
                                                            "label": "logger.error",
                                                            "start_token": 519,
                                                            "end_token": 521,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "label": "logger",
                                                                    "start_token": 519,
                                                                    "end_token": 519,
                                                                    "children": []
                                                                },
                                                                {
                                                                    "type": "identifier",
                                                                    "label": "error",
                                                                    "start_token": 521,
                                                                    "end_token": 521,
                                                                    "children": []
                                                                }
                                                            ]
                                                        },
                                                        {
                                                            "type": "argument_list",
                                                            "label": "(msg, extra={\"json_fields\": {**self.metadata, **extra}})",
                                                            "start_token": 522,
                                                            "end_token": 542,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "label": "msg",
                                                                    "start_token": 523,
                                                                    "end_token": 523,
                                                                    "children": []
                                                                },
                                                                {
                                                                    "type": "keyword_argument",
                                                                    "label": "extra={\"json_fields\": {**self.metadata, **extra}}",
                                                                    "start_token": 525,
                                                                    "end_token": 541,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "extra",
                                                                            "start_token": 525,
                                                                            "end_token": 525,
                                                                            "children": []
                                                                        },
                                                                        {
                                                                            "type": "dictionary",
                                                                            "label": "{\"json_fields\": {**self.metadata, **extra}}",
                                                                            "start_token": 527,
                                                                            "end_token": 541,
                                                                            "children": [
                                                                                {
                                                                                    "type": "pair",
                                                                                    "label": "\"json_fields\": {**self.metadata, **extra}",
                                                                                    "start_token": 528,
                                                                                    "end_token": 540,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "string",
                                                                                            "label": "\"json_fields\"",
                                                                                            "start_token": 528,
                                                                                            "end_token": 528,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "string_start",
                                                                                                    "label": "\"",
                                                                                                    "start_token": 528,
                                                                                                    "end_token": 528,
                                                                                                    "children": []
                                                                                                },
                                                                                                {
                                                                                                    "type": "string_content",
                                                                                                    "label": "json_fields",
                                                                                                    "start_token": 528,
                                                                                                    "end_token": 528,
                                                                                                    "children": []
                                                                                                },
                                                                                                {
                                                                                                    "type": "string_end",
                                                                                                    "label": "\"",
                                                                                                    "start_token": 528,
                                                                                                    "end_token": 528,
                                                                                                    "children": []
                                                                                                }
                                                                                            ]
                                                                                        },
                                                                                        {
                                                                                            "type": "dictionary",
                                                                                            "label": "{**self.metadata, **extra}",
                                                                                            "start_token": 530,
                                                                                            "end_token": 540,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "dictionary_splat",
                                                                                                    "label": "**self.metadata",
                                                                                                    "start_token": 531,
                                                                                                    "end_token": 535,
                                                                                                    "children": [
                                                                                                        {
                                                                                                            "type": "attribute",
                                                                                                            "label": "self.metadata",
                                                                                                            "start_token": 533,
                                                                                                            "end_token": 535,
                                                                                                            "children": [
                                                                                                                {
                                                                                                                    "type": "identifier",
                                                                                                                    "label": "self",
                                                                                                                    "start_token": 533,
                                                                                                                    "end_token": 533,
                                                                                                                    "children": []
                                                                                                                },
                                                                                                                {
                                                                                                                    "type": "identifier",
                                                                                                                    "label": "metadata",
                                                                                                                    "start_token": 535,
                                                                                                                    "end_token": 535,
                                                                                                                    "children": []
                                                                                                                }
                                                                                                            ]
                                                                                                        }
                                                                                                    ]
                                                                                                },
                                                                                                {
                                                                                                    "type": "dictionary_splat",
                                                                                                    "label": "**extra",
                                                                                                    "start_token": 537,
                                                                                                    "end_token": 539,
                                                                                                    "children": [
                                                                                                        {
                                                                                                            "type": "identifier",
                                                                                                            "label": "extra",
                                                                                                            "start_token": 539,
                                                                                                            "end_token": 539,
                                                                                                            "children": []
                                                                                                        }
                                                                                                    ]
                                                                                                }
                                                                                            ]
                                                                                        }
                                                                                    ]
                                                                                }
                                                                            ]
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                }
                                            ]
                                        }
                                    ]
                                }
                            ]
                        },
                        {
                            "type": "function_definition",
                            "label": "def debug(self, msg: str, **extra):\n        msg = self._wrap(msg, **extra)\n        logger.debug(msg, extra={\"json_fields\": {**self.metadata, **extra}})",
                            "start_token": 545,
                            "end_token": 596,
                            "children": [
                                {
                                    "type": "identifier",
                                    "label": "debug",
                                    "start_token": 546,
                                    "end_token": 546,
                                    "children": []
                                },
                                {
                                    "type": "parameters",
                                    "label": "(self, msg: str, **extra)",
                                    "start_token": 547,
                                    "end_token": 557,
                                    "children": [
                                        {
                                            "type": "identifier",
                                            "label": "self",
                                            "start_token": 548,
                                            "end_token": 548,
                                            "children": []
                                        },
                                        {
                                            "type": "typed_parameter",
                                            "label": "msg: str",
                                            "start_token": 550,
                                            "end_token": 552,
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "label": "msg",
                                                    "start_token": 550,
                                                    "end_token": 550,
                                                    "children": []
                                                },
                                                {
                                                    "type": "type",
                                                    "label": "str",
                                                    "start_token": 552,
                                                    "end_token": 552,
                                                    "children": [
                                                        {
                                                            "type": "identifier",
                                                            "label": "str",
                                                            "start_token": 552,
                                                            "end_token": 552,
                                                            "children": []
                                                        }
                                                    ]
                                                }
                                            ]
                                        },
                                        {
                                            "type": "dictionary_splat_pattern",
                                            "label": "**extra",
                                            "start_token": 554,
                                            "end_token": 556,
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "label": "extra",
                                                    "start_token": 556,
                                                    "end_token": 556,
                                                    "children": []
                                                }
                                            ]
                                        }
                                    ]
                                },
                                {
                                    "type": "block",
                                    "label": "msg = self._wrap(msg, **extra)\n        logger.debug(msg, extra={\"json_fields\": {**self.metadata, **extra}})",
                                    "start_token": 560,
                                    "end_token": 596,
                                    "children": [
                                        {
                                            "type": "expression_statement",
                                            "label": "msg = self._wrap(msg, **extra)",
                                            "start_token": 560,
                                            "end_token": 571,
                                            "children": [
                                                {
                                                    "type": "assignment",
                                                    "label": "msg = self._wrap(msg, **extra)",
                                                    "start_token": 560,
                                                    "end_token": 571,
                                                    "children": [
                                                        {
                                                            "type": "identifier",
                                                            "label": "msg",
                                                            "start_token": 560,
                                                            "end_token": 560,
                                                            "children": []
                                                        },
                                                        {
                                                            "type": "call",
                                                            "label": "self._wrap(msg, **extra)",
                                                            "start_token": 562,
                                                            "end_token": 571,
                                                            "children": [
                                                                {
                                                                    "type": "attribute",
                                                                    "label": "self._wrap",
                                                                    "start_token": 562,
                                                                    "end_token": 564,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "self",
                                                                            "start_token": 562,
                                                                            "end_token": 562,
                                                                            "children": []
                                                                        },
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "_wrap",
                                                                            "start_token": 564,
                                                                            "end_token": 564,
                                                                            "children": []
                                                                        }
                                                                    ]
                                                                },
                                                                {
                                                                    "type": "argument_list",
                                                                    "label": "(msg, **extra)",
                                                                    "start_token": 565,
                                                                    "end_token": 571,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "msg",
                                                                            "start_token": 566,
                                                                            "end_token": 566,
                                                                            "children": []
                                                                        },
                                                                        {
                                                                            "type": "dictionary_splat",
                                                                            "label": "**extra",
                                                                            "start_token": 568,
                                                                            "end_token": 570,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "extra",
                                                                                    "start_token": 570,
                                                                                    "end_token": 570,
                                                                                    "children": []
                                                                                }
                                                                            ]
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                }
                                            ]
                                        },
                                        {
                                            "type": "expression_statement",
                                            "label": "logger.debug(msg, extra={\"json_fields\": {**self.metadata, **extra}})",
                                            "start_token": 573,
                                            "end_token": 596,
                                            "children": [
                                                {
                                                    "type": "call",
                                                    "label": "logger.debug(msg, extra={\"json_fields\": {**self.metadata, **extra}})",
                                                    "start_token": 573,
                                                    "end_token": 596,
                                                    "children": [
                                                        {
                                                            "type": "attribute",
                                                            "label": "logger.debug",
                                                            "start_token": 573,
                                                            "end_token": 575,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "label": "logger",
                                                                    "start_token": 573,
                                                                    "end_token": 573,
                                                                    "children": []
                                                                },
                                                                {
                                                                    "type": "identifier",
                                                                    "label": "debug",
                                                                    "start_token": 575,
                                                                    "end_token": 575,
                                                                    "children": []
                                                                }
                                                            ]
                                                        },
                                                        {
                                                            "type": "argument_list",
                                                            "label": "(msg, extra={\"json_fields\": {**self.metadata, **extra}})",
                                                            "start_token": 576,
                                                            "end_token": 596,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "label": "msg",
                                                                    "start_token": 577,
                                                                    "end_token": 577,
                                                                    "children": []
                                                                },
                                                                {
                                                                    "type": "keyword_argument",
                                                                    "label": "extra={\"json_fields\": {**self.metadata, **extra}}",
                                                                    "start_token": 579,
                                                                    "end_token": 595,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "extra",
                                                                            "start_token": 579,
                                                                            "end_token": 579,
                                                                            "children": []
                                                                        },
                                                                        {
                                                                            "type": "dictionary",
                                                                            "label": "{\"json_fields\": {**self.metadata, **extra}}",
                                                                            "start_token": 581,
                                                                            "end_token": 595,
                                                                            "children": [
                                                                                {
                                                                                    "type": "pair",
                                                                                    "label": "\"json_fields\": {**self.metadata, **extra}",
                                                                                    "start_token": 582,
                                                                                    "end_token": 594,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "string",
                                                                                            "label": "\"json_fields\"",
                                                                                            "start_token": 582,
                                                                                            "end_token": 582,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "string_start",
                                                                                                    "label": "\"",
                                                                                                    "start_token": 582,
                                                                                                    "end_token": 582,
                                                                                                    "children": []
                                                                                                },
                                                                                                {
                                                                                                    "type": "string_content",
                                                                                                    "label": "json_fields",
                                                                                                    "start_token": 582,
                                                                                                    "end_token": 582,
                                                                                                    "children": []
                                                                                                },
                                                                                                {
                                                                                                    "type": "string_end",
                                                                                                    "label": "\"",
                                                                                                    "start_token": 582,
                                                                                                    "end_token": 582,
                                                                                                    "children": []
                                                                                                }
                                                                                            ]
                                                                                        },
                                                                                        {
                                                                                            "type": "dictionary",
                                                                                            "label": "{**self.metadata, **extra}",
                                                                                            "start_token": 584,
                                                                                            "end_token": 594,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "dictionary_splat",
                                                                                                    "label": "**self.metadata",
                                                                                                    "start_token": 585,
                                                                                                    "end_token": 589,
                                                                                                    "children": [
                                                                                                        {
                                                                                                            "type": "attribute",
                                                                                                            "label": "self.metadata",
                                                                                                            "start_token": 587,
                                                                                                            "end_token": 589,
                                                                                                            "children": [
                                                                                                                {
                                                                                                                    "type": "identifier",
                                                                                                                    "label": "self",
                                                                                                                    "start_token": 587,
                                                                                                                    "end_token": 587,
                                                                                                                    "children": []
                                                                                                                },
                                                                                                                {
                                                                                                                    "type": "identifier",
                                                                                                                    "label": "metadata",
                                                                                                                    "start_token": 589,
                                                                                                                    "end_token": 589,
                                                                                                                    "children": []
                                                                                                                }
                                                                                                            ]
                                                                                                        }
                                                                                                    ]
                                                                                                },
                                                                                                {
                                                                                                    "type": "dictionary_splat",
                                                                                                    "label": "**extra",
                                                                                                    "start_token": 591,
                                                                                                    "end_token": 593,
                                                                                                    "children": [
                                                                                                        {
                                                                                                            "type": "identifier",
                                                                                                            "label": "extra",
                                                                                                            "start_token": 593,
                                                                                                            "end_token": 593,
                                                                                                            "children": []
                                                                                                        }
                                                                                                    ]
                                                                                                }
                                                                                            ]
                                                                                        }
                                                                                    ]
                                                                                }
                                                                            ]
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                }
                                            ]
                                        }
                                    ]
                                }
                            ]
                        },
                        {
                            "type": "function_definition",
                            "label": "def exception(self, msg: str, **extra):\n        msg = self._wrap(msg, **extra)\n        logger.exception(msg, extra={\"json_fields\": {**self.metadata, **extra}})",
                            "start_token": 599,
                            "end_token": 650,
                            "children": [
                                {
                                    "type": "identifier",
                                    "label": "exception",
                                    "start_token": 600,
                                    "end_token": 600,
                                    "children": []
                                },
                                {
                                    "type": "parameters",
                                    "label": "(self, msg: str, **extra)",
                                    "start_token": 601,
                                    "end_token": 611,
                                    "children": [
                                        {
                                            "type": "identifier",
                                            "label": "self",
                                            "start_token": 602,
                                            "end_token": 602,
                                            "children": []
                                        },
                                        {
                                            "type": "typed_parameter",
                                            "label": "msg: str",
                                            "start_token": 604,
                                            "end_token": 606,
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "label": "msg",
                                                    "start_token": 604,
                                                    "end_token": 604,
                                                    "children": []
                                                },
                                                {
                                                    "type": "type",
                                                    "label": "str",
                                                    "start_token": 606,
                                                    "end_token": 606,
                                                    "children": [
                                                        {
                                                            "type": "identifier",
                                                            "label": "str",
                                                            "start_token": 606,
                                                            "end_token": 606,
                                                            "children": []
                                                        }
                                                    ]
                                                }
                                            ]
                                        },
                                        {
                                            "type": "dictionary_splat_pattern",
                                            "label": "**extra",
                                            "start_token": 608,
                                            "end_token": 610,
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "label": "extra",
                                                    "start_token": 610,
                                                    "end_token": 610,
                                                    "children": []
                                                }
                                            ]
                                        }
                                    ]
                                },
                                {
                                    "type": "block",
                                    "label": "msg = self._wrap(msg, **extra)\n        logger.exception(msg, extra={\"json_fields\": {**self.metadata, **extra}})",
                                    "start_token": 614,
                                    "end_token": 650,
                                    "children": [
                                        {
                                            "type": "expression_statement",
                                            "label": "msg = self._wrap(msg, **extra)",
                                            "start_token": 614,
                                            "end_token": 625,
                                            "children": [
                                                {
                                                    "type": "assignment",
                                                    "label": "msg = self._wrap(msg, **extra)",
                                                    "start_token": 614,
                                                    "end_token": 625,
                                                    "children": [
                                                        {
                                                            "type": "identifier",
                                                            "label": "msg",
                                                            "start_token": 614,
                                                            "end_token": 614,
                                                            "children": []
                                                        },
                                                        {
                                                            "type": "call",
                                                            "label": "self._wrap(msg, **extra)",
                                                            "start_token": 616,
                                                            "end_token": 625,
                                                            "children": [
                                                                {
                                                                    "type": "attribute",
                                                                    "label": "self._wrap",
                                                                    "start_token": 616,
                                                                    "end_token": 618,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "self",
                                                                            "start_token": 616,
                                                                            "end_token": 616,
                                                                            "children": []
                                                                        },
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "_wrap",
                                                                            "start_token": 618,
                                                                            "end_token": 618,
                                                                            "children": []
                                                                        }
                                                                    ]
                                                                },
                                                                {
                                                                    "type": "argument_list",
                                                                    "label": "(msg, **extra)",
                                                                    "start_token": 619,
                                                                    "end_token": 625,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "msg",
                                                                            "start_token": 620,
                                                                            "end_token": 620,
                                                                            "children": []
                                                                        },
                                                                        {
                                                                            "type": "dictionary_splat",
                                                                            "label": "**extra",
                                                                            "start_token": 622,
                                                                            "end_token": 624,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "extra",
                                                                                    "start_token": 624,
                                                                                    "end_token": 624,
                                                                                    "children": []
                                                                                }
                                                                            ]
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                }
                                            ]
                                        },
                                        {
                                            "type": "expression_statement",
                                            "label": "logger.exception(msg, extra={\"json_fields\": {**self.metadata, **extra}})",
                                            "start_token": 627,
                                            "end_token": 650,
                                            "children": [
                                                {
                                                    "type": "call",
                                                    "label": "logger.exception(msg, extra={\"json_fields\": {**self.metadata, **extra}})",
                                                    "start_token": 627,
                                                    "end_token": 650,
                                                    "children": [
                                                        {
                                                            "type": "attribute",
                                                            "label": "logger.exception",
                                                            "start_token": 627,
                                                            "end_token": 629,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "label": "logger",
                                                                    "start_token": 627,
                                                                    "end_token": 627,
                                                                    "children": []
                                                                },
                                                                {
                                                                    "type": "identifier",
                                                                    "label": "exception",
                                                                    "start_token": 629,
                                                                    "end_token": 629,
                                                                    "children": []
                                                                }
                                                            ]
                                                        },
                                                        {
                                                            "type": "argument_list",
                                                            "label": "(msg, extra={\"json_fields\": {**self.metadata, **extra}})",
                                                            "start_token": 630,
                                                            "end_token": 650,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "label": "msg",
                                                                    "start_token": 631,
                                                                    "end_token": 631,
                                                                    "children": []
                                                                },
                                                                {
                                                                    "type": "keyword_argument",
                                                                    "label": "extra={\"json_fields\": {**self.metadata, **extra}}",
                                                                    "start_token": 633,
                                                                    "end_token": 649,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "extra",
                                                                            "start_token": 633,
                                                                            "end_token": 633,
                                                                            "children": []
                                                                        },
                                                                        {
                                                                            "type": "dictionary",
                                                                            "label": "{\"json_fields\": {**self.metadata, **extra}}",
                                                                            "start_token": 635,
                                                                            "end_token": 649,
                                                                            "children": [
                                                                                {
                                                                                    "type": "pair",
                                                                                    "label": "\"json_fields\": {**self.metadata, **extra}",
                                                                                    "start_token": 636,
                                                                                    "end_token": 648,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "string",
                                                                                            "label": "\"json_fields\"",
                                                                                            "start_token": 636,
                                                                                            "end_token": 636,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "string_start",
                                                                                                    "label": "\"",
                                                                                                    "start_token": 636,
                                                                                                    "end_token": 636,
                                                                                                    "children": []
                                                                                                },
                                                                                                {
                                                                                                    "type": "string_content",
                                                                                                    "label": "json_fields",
                                                                                                    "start_token": 636,
                                                                                                    "end_token": 636,
                                                                                                    "children": []
                                                                                                },
                                                                                                {
                                                                                                    "type": "string_end",
                                                                                                    "label": "\"",
                                                                                                    "start_token": 636,
                                                                                                    "end_token": 636,
                                                                                                    "children": []
                                                                                                }
                                                                                            ]
                                                                                        },
                                                                                        {
                                                                                            "type": "dictionary",
                                                                                            "label": "{**self.metadata, **extra}",
                                                                                            "start_token": 638,
                                                                                            "end_token": 648,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "dictionary_splat",
                                                                                                    "label": "**self.metadata",
                                                                                                    "start_token": 639,
                                                                                                    "end_token": 643,
                                                                                                    "children": [
                                                                                                        {
                                                                                                            "type": "attribute",
                                                                                                            "label": "self.metadata",
                                                                                                            "start_token": 641,
                                                                                                            "end_token": 643,
                                                                                                            "children": [
                                                                                                                {
                                                                                                                    "type": "identifier",
                                                                                                                    "label": "self",
                                                                                                                    "start_token": 641,
                                                                                                                    "end_token": 641,
                                                                                                                    "children": []
                                                                                                                },
                                                                                                                {
                                                                                                                    "type": "identifier",
                                                                                                                    "label": "metadata",
                                                                                                                    "start_token": 643,
                                                                                                                    "end_token": 643,
                                                                                                                    "children": []
                                                                                                                }
                                                                                                            ]
                                                                                                        }
                                                                                                    ]
                                                                                                },
                                                                                                {
                                                                                                    "type": "dictionary_splat",
                                                                                                    "label": "**extra",
                                                                                                    "start_token": 645,
                                                                                                    "end_token": 647,
                                                                                                    "children": [
                                                                                                        {
                                                                                                            "type": "identifier",
                                                                                                            "label": "extra",
                                                                                                            "start_token": 647,
                                                                                                            "end_token": 647,
                                                                                                            "children": []
                                                                                                        }
                                                                                                    ]
                                                                                                }
                                                                                            ]
                                                                                        }
                                                                                    ]
                                                                                }
                                                                            ]
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                }
                                            ]
                                        }
                                    ]
                                }
                            ]
                        },
                        {
                            "type": "function_definition",
                            "label": "def _wrap(self, msg: str, **extra):\n        return f\"{self.prefix} {msg} {extra}\"",
                            "start_token": 653,
                            "end_token": 670,
                            "children": [
                                {
                                    "type": "identifier",
                                    "label": "_wrap",
                                    "start_token": 654,
                                    "end_token": 654,
                                    "children": []
                                },
                                {
                                    "type": "parameters",
                                    "label": "(self, msg: str, **extra)",
                                    "start_token": 655,
                                    "end_token": 665,
                                    "children": [
                                        {
                                            "type": "identifier",
                                            "label": "self",
                                            "start_token": 656,
                                            "end_token": 656,
                                            "children": []
                                        },
                                        {
                                            "type": "typed_parameter",
                                            "label": "msg: str",
                                            "start_token": 658,
                                            "end_token": 660,
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "label": "msg",
                                                    "start_token": 658,
                                                    "end_token": 658,
                                                    "children": []
                                                },
                                                {
                                                    "type": "type",
                                                    "label": "str",
                                                    "start_token": 660,
                                                    "end_token": 660,
                                                    "children": [
                                                        {
                                                            "type": "identifier",
                                                            "label": "str",
                                                            "start_token": 660,
                                                            "end_token": 660,
                                                            "children": []
                                                        }
                                                    ]
                                                }
                                            ]
                                        },
                                        {
                                            "type": "dictionary_splat_pattern",
                                            "label": "**extra",
                                            "start_token": 662,
                                            "end_token": 664,
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "label": "extra",
                                                    "start_token": 664,
                                                    "end_token": 664,
                                                    "children": []
                                                }
                                            ]
                                        }
                                    ]
                                },
                                {
                                    "type": "block",
                                    "label": "return f\"{self.prefix} {msg} {extra}\"",
                                    "start_token": 668,
                                    "end_token": 670,
                                    "children": [
                                        {
                                            "type": "return_statement",
                                            "label": "return f\"{self.prefix} {msg} {extra}\"",
                                            "start_token": 668,
                                            "end_token": 670,
                                            "children": [
                                                {
                                                    "type": "string",
                                                    "label": "f\"{self.prefix} {msg} {extra}\"",
                                                    "start_token": 669,
                                                    "end_token": 670,
                                                    "children": [
                                                        {
                                                            "type": "string_start",
                                                            "label": "f\"",
                                                            "start_token": 669,
                                                            "end_token": 670,
                                                            "children": []
                                                        },
                                                        {
                                                            "type": "interpolation",
                                                            "label": "{self.prefix}",
                                                            "start_token": 670,
                                                            "end_token": 670,
                                                            "children": [
                                                                {
                                                                    "type": "attribute",
                                                                    "label": "self.prefix",
                                                                    "start_token": 670,
                                                                    "end_token": 670,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "self",
                                                                            "start_token": 670,
                                                                            "end_token": 670,
                                                                            "children": []
                                                                        },
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "prefix",
                                                                            "start_token": 670,
                                                                            "end_token": 670,
                                                                            "children": []
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        },
                                                        {
                                                            "type": "string_content",
                                                            "label": " ",
                                                            "start_token": 670,
                                                            "end_token": 670,
                                                            "children": []
                                                        },
                                                        {
                                                            "type": "interpolation",
                                                            "label": "{msg}",
                                                            "start_token": 670,
                                                            "end_token": 670,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "label": "msg",
                                                                    "start_token": 670,
                                                                    "end_token": 670,
                                                                    "children": []
                                                                }
                                                            ]
                                                        },
                                                        {
                                                            "type": "string_content",
                                                            "label": " ",
                                                            "start_token": 670,
                                                            "end_token": 670,
                                                            "children": []
                                                        },
                                                        {
                                                            "type": "interpolation",
                                                            "label": "{extra}",
                                                            "start_token": 670,
                                                            "end_token": 670,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "label": "extra",
                                                                    "start_token": 670,
                                                                    "end_token": 670,
                                                                    "children": []
                                                                }
                                                            ]
                                                        },
                                                        {
                                                            "type": "string_end",
                                                            "label": "\"",
                                                            "start_token": 670,
                                                            "end_token": 670,
                                                            "children": []
                                                        }
                                                    ]
                                                }
                                            ]
                                        }
                                    ]
                                }
                            ]
                        }
                    ]
                }
            ]
        },
        {
            "type": "expression_statement",
            "label": "T = TypeVar(\"T\")",
            "start_token": 674,
            "end_token": 679,
            "children": [
                {
                    "type": "assignment",
                    "label": "T = TypeVar(\"T\")",
                    "start_token": 674,
                    "end_token": 679,
                    "children": [
                        {
                            "type": "identifier",
                            "label": "T",
                            "start_token": 674,
                            "end_token": 674,
                            "children": []
                        },
                        {
                            "type": "call",
                            "label": "TypeVar(\"T\")",
                            "start_token": 676,
                            "end_token": 679,
                            "children": [
                                {
                                    "type": "identifier",
                                    "label": "TypeVar",
                                    "start_token": 676,
                                    "end_token": 676,
                                    "children": []
                                },
                                {
                                    "type": "argument_list",
                                    "label": "(\"T\")",
                                    "start_token": 677,
                                    "end_token": 679,
                                    "children": [
                                        {
                                            "type": "string",
                                            "label": "\"T\"",
                                            "start_token": 678,
                                            "end_token": 678,
                                            "children": [
                                                {
                                                    "type": "string_start",
                                                    "label": "\"",
                                                    "start_token": 678,
                                                    "end_token": 678,
                                                    "children": []
                                                },
                                                {
                                                    "type": "string_content",
                                                    "label": "T",
                                                    "start_token": 678,
                                                    "end_token": 678,
                                                    "children": []
                                                },
                                                {
                                                    "type": "string_end",
                                                    "label": "\"",
                                                    "start_token": 678,
                                                    "end_token": 678,
                                                    "children": []
                                                }
                                            ]
                                        }
                                    ]
                                }
                            ]
                        }
                    ]
                }
            ]
        },
        {
            "type": "expression_statement",
            "label": "ExecutionStream = Generator[NodeExecutionEntry, None, None]",
            "start_token": 681,
            "end_token": 690,
            "children": [
                {
                    "type": "assignment",
                    "label": "ExecutionStream = Generator[NodeExecutionEntry, None, None]",
                    "start_token": 681,
                    "end_token": 690,
                    "children": [
                        {
                            "type": "identifier",
                            "label": "ExecutionStream",
                            "start_token": 681,
                            "end_token": 681,
                            "children": []
                        },
                        {
                            "type": "subscript",
                            "label": "Generator[NodeExecutionEntry, None, None]",
                            "start_token": 683,
                            "end_token": 690,
                            "children": [
                                {
                                    "type": "identifier",
                                    "label": "Generator",
                                    "start_token": 683,
                                    "end_token": 683,
                                    "children": []
                                },
                                {
                                    "type": "identifier",
                                    "label": "NodeExecutionEntry",
                                    "start_token": 685,
                                    "end_token": 685,
                                    "children": []
                                },
                                {
                                    "type": "none",
                                    "label": "None",
                                    "start_token": 687,
                                    "end_token": 687,
                                    "children": []
                                },
                                {
                                    "type": "none",
                                    "label": "None",
                                    "start_token": 689,
                                    "end_token": 689,
                                    "children": []
                                }
                            ]
                        }
                    ]
                }
            ]
        },
        {
            "type": "function_definition",
            "label": "def execute_node(\n    db_client: \"DatabaseManager\",\n    creds_manager: IntegrationCredentialsManager,\n    data: NodeExecutionEntry,\n    execution_stats: dict[str, Any] | None = None,\n) -> ExecutionStream:\n    \"\"\"\n    Execute a node in the graph. This will trigger a block execution on a node,\n    persist the execution result, and return the subsequent node to be executed.\n\n    Args:\n        db_client: The client to send execution updates to the server.\n        creds_manager: The manager to acquire and release credentials.\n        data: The execution data for executing the current node.\n        execution_stats: The execution statistics to be updated.\n\n    Returns:\n        The subsequent node to be enqueued, or None if there is no subsequent node.\n    \"\"\"\n    user_id = data.user_id\n    graph_exec_id = data.graph_exec_id\n    graph_id = data.graph_id\n    node_exec_id = data.node_exec_id\n    node_id = data.node_id\n\n    def update_execution(status: ExecutionStatus) -> ExecutionResult:\n        exec_update = db_client.update_execution_status(node_exec_id, status)\n        db_client.send_execution_update(exec_update)\n        return exec_update\n\n    node = db_client.get_node(node_id)\n\n    node_block = get_block(node.block_id)\n    if not node_block:\n        logger.error(f\"Block {node.block_id} not found.\")\n        return\n\n    log_metadata = LogMetadata(\n        user_id=user_id,\n        graph_eid=graph_exec_id,\n        graph_id=graph_id,\n        node_eid=node_exec_id,\n        node_id=node_id,\n        block_name=node_block.name,\n    )\n\n    # Sanity check: validate the execution input.\n    input_data, error = validate_exec(node, data.data, resolve_input=False)\n    if input_data is None:\n        log_metadata.error(f\"Skip execution, input validation error: {error}\")\n        db_client.upsert_execution_output(node_exec_id, \"error\", error)\n        update_execution(ExecutionStatus.FAILED)\n        return\n\n    # Re-shape the input data for agent block.\n    # AgentExecutorBlock specially separate the node input_data & its input_default.\n    if isinstance(node_block, AgentExecutorBlock):\n        input_data = {**node.input_default, \"data\": input_data}\n\n    # Execute the node\n    input_data_str = json.dumps(input_data)\n    input_size = len(input_data_str)\n    log_metadata.info(\"Executed node with input\", input=input_data_str)\n    update_execution(ExecutionStatus.RUNNING)\n\n    extra_exec_kwargs = {}\n    # Last-minute fetch credentials + acquire a system-wide read-write lock to prevent\n    # changes during execution. ⚠️ This means a set of credentials can only be used by\n    # one (running) block at a time; simultaneous execution of blocks using same\n    # credentials is not supported.\n    creds_lock = None\n    if CREDENTIALS_FIELD_NAME in input_data:\n        credentials_meta = CredentialsMetaInput(**input_data[CREDENTIALS_FIELD_NAME])\n        credentials, creds_lock = creds_manager.acquire(user_id, credentials_meta.id)\n        extra_exec_kwargs[\"credentials\"] = credentials\n\n    output_size = 0\n    end_status = ExecutionStatus.COMPLETED\n    credit = db_client.get_or_refill_credit(user_id)\n    if credit < 0:\n        raise ValueError(f\"Insufficient credit: {credit}\")\n\n    try:\n        for output_name, output_data in node_block.execute(\n            input_data, **extra_exec_kwargs\n        ):\n            output_size += len(json.dumps(output_data))\n            log_metadata.info(\"Node produced output\", **{output_name: output_data})\n            db_client.upsert_execution_output(node_exec_id, output_name, output_data)\n\n            for execution in _enqueue_next_nodes(\n                db_client=db_client,\n                node=node,\n                output=(output_name, output_data),\n                user_id=user_id,\n                graph_exec_id=graph_exec_id,\n                graph_id=graph_id,\n                log_metadata=log_metadata,\n            ):\n                yield execution\n\n    except Exception as e:\n        end_status = ExecutionStatus.FAILED\n        error_msg = str(e)\n        log_metadata.exception(f\"Node execution failed with error {error_msg}\")\n        db_client.upsert_execution_output(node_exec_id, \"error\", error_msg)\n\n        for execution in _enqueue_next_nodes(\n            db_client=db_client,\n            node=node,\n            output=(\"error\", error_msg),\n            user_id=user_id,\n            graph_exec_id=graph_exec_id,\n            graph_id=graph_id,\n            log_metadata=log_metadata,\n        ):\n            yield execution\n\n        raise e\n    finally:\n        # Ensure credentials are released even if execution fails\n        if creds_lock:\n            try:\n                creds_lock.release()\n            except Exception as e:\n                log_metadata.error(f\"Failed to release credentials lock: {e}\")\n\n        # Update execution status and spend credits\n        res = update_execution(end_status)\n        if end_status == ExecutionStatus.COMPLETED:\n            s = input_size + output_size\n            t = (\n                (res.end_time - res.start_time).total_seconds()\n                if res.end_time and res.start_time\n                else 0\n            )\n            db_client.spend_credits(user_id, credit, node_block.id, input_data, s, t)\n\n        # Update execution stats\n        if execution_stats is not None:\n            execution_stats.update(node_block.execution_stats)\n            execution_stats[\"input_size\"] = input_size\n            execution_stats[\"output_size\"] = output_size",
            "start_token": 694,
            "end_token": 1540,
            "children": [
                {
                    "type": "identifier",
                    "label": "execute_node",
                    "start_token": 695,
                    "end_token": 695,
                    "children": []
                },
                {
                    "type": "parameters",
                    "label": "(\n    db_client: \"DatabaseManager\",\n    creds_manager: IntegrationCredentialsManager,\n    data: NodeExecutionEntry,\n    execution_stats: dict[str, Any] | None = None,\n)",
                    "start_token": 696,
                    "end_token": 727,
                    "children": [
                        {
                            "type": "typed_parameter",
                            "label": "db_client: \"DatabaseManager\"",
                            "start_token": 698,
                            "end_token": 700,
                            "children": [
                                {
                                    "type": "identifier",
                                    "label": "db_client",
                                    "start_token": 698,
                                    "end_token": 698,
                                    "children": []
                                },
                                {
                                    "type": "type",
                                    "label": "\"DatabaseManager\"",
                                    "start_token": 700,
                                    "end_token": 700,
                                    "children": [
                                        {
                                            "type": "string",
                                            "label": "\"DatabaseManager\"",
                                            "start_token": 700,
                                            "end_token": 700,
                                            "children": [
                                                {
                                                    "type": "string_start",
                                                    "label": "\"",
                                                    "start_token": 700,
                                                    "end_token": 700,
                                                    "children": []
                                                },
                                                {
                                                    "type": "string_content",
                                                    "label": "DatabaseManager",
                                                    "start_token": 700,
                                                    "end_token": 700,
                                                    "children": []
                                                },
                                                {
                                                    "type": "string_end",
                                                    "label": "\"",
                                                    "start_token": 700,
                                                    "end_token": 700,
                                                    "children": []
                                                }
                                            ]
                                        }
                                    ]
                                }
                            ]
                        },
                        {
                            "type": "typed_parameter",
                            "label": "creds_manager: IntegrationCredentialsManager",
                            "start_token": 703,
                            "end_token": 705,
                            "children": [
                                {
                                    "type": "identifier",
                                    "label": "creds_manager",
                                    "start_token": 703,
                                    "end_token": 703,
                                    "children": []
                                },
                                {
                                    "type": "type",
                                    "label": "IntegrationCredentialsManager",
                                    "start_token": 705,
                                    "end_token": 705,
                                    "children": [
                                        {
                                            "type": "identifier",
                                            "label": "IntegrationCredentialsManager",
                                            "start_token": 705,
                                            "end_token": 705,
                                            "children": []
                                        }
                                    ]
                                }
                            ]
                        },
                        {
                            "type": "typed_parameter",
                            "label": "data: NodeExecutionEntry",
                            "start_token": 708,
                            "end_token": 710,
                            "children": [
                                {
                                    "type": "identifier",
                                    "label": "data",
                                    "start_token": 708,
                                    "end_token": 708,
                                    "children": []
                                },
                                {
                                    "type": "type",
                                    "label": "NodeExecutionEntry",
                                    "start_token": 710,
                                    "end_token": 710,
                                    "children": [
                                        {
                                            "type": "identifier",
                                            "label": "NodeExecutionEntry",
                                            "start_token": 710,
                                            "end_token": 710,
                                            "children": []
                                        }
                                    ]
                                }
                            ]
                        },
                        {
                            "type": "typed_default_parameter",
                            "label": "execution_stats: dict[str, Any] | None = None",
                            "start_token": 713,
                            "end_token": 724,
                            "children": [
                                {
                                    "type": "identifier",
                                    "label": "execution_stats",
                                    "start_token": 713,
                                    "end_token": 713,
                                    "children": []
                                },
                                {
                                    "type": "type",
                                    "label": "dict[str, Any] | None",
                                    "start_token": 715,
                                    "end_token": 722,
                                    "children": [
                                        {
                                            "type": "union_type",
                                            "label": "dict[str, Any] | None",
                                            "start_token": 715,
                                            "end_token": 722,
                                            "children": [
                                                {
                                                    "type": "type",
                                                    "label": "dict[str, Any]",
                                                    "start_token": 715,
                                                    "end_token": 720,
                                                    "children": [
                                                        {
                                                            "type": "generic_type",
                                                            "label": "dict[str, Any]",
                                                            "start_token": 715,
                                                            "end_token": 720,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "label": "dict",
                                                                    "start_token": 715,
                                                                    "end_token": 715,
                                                                    "children": []
                                                                },
                                                                {
                                                                    "type": "type_parameter",
                                                                    "label": "[str, Any]",
                                                                    "start_token": 716,
                                                                    "end_token": 720,
                                                                    "children": [
                                                                        {
                                                                            "type": "type",
                                                                            "label": "str",
                                                                            "start_token": 717,
                                                                            "end_token": 717,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "str",
                                                                                    "start_token": 717,
                                                                                    "end_token": 717,
                                                                                    "children": []
                                                                                }
                                                                            ]
                                                                        },
                                                                        {
                                                                            "type": "type",
                                                                            "label": "Any",
                                                                            "start_token": 719,
                                                                            "end_token": 719,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "Any",
                                                                                    "start_token": 719,
                                                                                    "end_token": 719,
                                                                                    "children": []
                                                                                }
                                                                            ]
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                },
                                                {
                                                    "type": "type",
                                                    "label": "None",
                                                    "start_token": 722,
                                                    "end_token": 722,
                                                    "children": [
                                                        {
                                                            "type": "none",
                                                            "label": "None",
                                                            "start_token": 722,
                                                            "end_token": 722,
                                                            "children": []
                                                        }
                                                    ]
                                                }
                                            ]
                                        }
                                    ]
                                },
                                {
                                    "type": "none",
                                    "label": "None",
                                    "start_token": 724,
                                    "end_token": 724,
                                    "children": []
                                }
                            ]
                        }
                    ]
                },
                {
                    "type": "type",
                    "label": "ExecutionStream",
                    "start_token": 730,
                    "end_token": 730,
                    "children": [
                        {
                            "type": "identifier",
                            "label": "ExecutionStream",
                            "start_token": 730,
                            "end_token": 730,
                            "children": []
                        }
                    ]
                },
                {
                    "type": "block",
                    "label": "\"\"\"\n    Execute a node in the graph. This will trigger a block execution on a node,\n    persist the execution result, and return the subsequent node to be executed.\n\n    Args:\n        db_client: The client to send execution updates to the server.\n        creds_manager: The manager to acquire and release credentials.\n        data: The execution data for executing the current node.\n        execution_stats: The execution statistics to be updated.\n\n    Returns:\n        The subsequent node to be enqueued, or None if there is no subsequent node.\n    \"\"\"\n    user_id = data.user_id\n    graph_exec_id = data.graph_exec_id\n    graph_id = data.graph_id\n    node_exec_id = data.node_exec_id\n    node_id = data.node_id\n\n    def update_execution(status: ExecutionStatus) -> ExecutionResult:\n        exec_update = db_client.update_execution_status(node_exec_id, status)\n        db_client.send_execution_update(exec_update)\n        return exec_update\n\n    node = db_client.get_node(node_id)\n\n    node_block = get_block(node.block_id)\n    if not node_block:\n        logger.error(f\"Block {node.block_id} not found.\")\n        return\n\n    log_metadata = LogMetadata(\n        user_id=user_id,\n        graph_eid=graph_exec_id,\n        graph_id=graph_id,\n        node_eid=node_exec_id,\n        node_id=node_id,\n        block_name=node_block.name,\n    )\n\n    # Sanity check: validate the execution input.\n    input_data, error = validate_exec(node, data.data, resolve_input=False)\n    if input_data is None:\n        log_metadata.error(f\"Skip execution, input validation error: {error}\")\n        db_client.upsert_execution_output(node_exec_id, \"error\", error)\n        update_execution(ExecutionStatus.FAILED)\n        return\n\n    # Re-shape the input data for agent block.\n    # AgentExecutorBlock specially separate the node input_data & its input_default.\n    if isinstance(node_block, AgentExecutorBlock):\n        input_data = {**node.input_default, \"data\": input_data}\n\n    # Execute the node\n    input_data_str = json.dumps(input_data)\n    input_size = len(input_data_str)\n    log_metadata.info(\"Executed node with input\", input=input_data_str)\n    update_execution(ExecutionStatus.RUNNING)\n\n    extra_exec_kwargs = {}\n    # Last-minute fetch credentials + acquire a system-wide read-write lock to prevent\n    # changes during execution. ⚠️ This means a set of credentials can only be used by\n    # one (running) block at a time; simultaneous execution of blocks using same\n    # credentials is not supported.\n    creds_lock = None\n    if CREDENTIALS_FIELD_NAME in input_data:\n        credentials_meta = CredentialsMetaInput(**input_data[CREDENTIALS_FIELD_NAME])\n        credentials, creds_lock = creds_manager.acquire(user_id, credentials_meta.id)\n        extra_exec_kwargs[\"credentials\"] = credentials\n\n    output_size = 0\n    end_status = ExecutionStatus.COMPLETED\n    credit = db_client.get_or_refill_credit(user_id)\n    if credit < 0:\n        raise ValueError(f\"Insufficient credit: {credit}\")\n\n    try:\n        for output_name, output_data in node_block.execute(\n            input_data, **extra_exec_kwargs\n        ):\n            output_size += len(json.dumps(output_data))\n            log_metadata.info(\"Node produced output\", **{output_name: output_data})\n            db_client.upsert_execution_output(node_exec_id, output_name, output_data)\n\n            for execution in _enqueue_next_nodes(\n                db_client=db_client,\n                node=node,\n                output=(output_name, output_data),\n                user_id=user_id,\n                graph_exec_id=graph_exec_id,\n                graph_id=graph_id,\n                log_metadata=log_metadata,\n            ):\n                yield execution\n\n    except Exception as e:\n        end_status = ExecutionStatus.FAILED\n        error_msg = str(e)\n        log_metadata.exception(f\"Node execution failed with error {error_msg}\")\n        db_client.upsert_execution_output(node_exec_id, \"error\", error_msg)\n\n        for execution in _enqueue_next_nodes(\n            db_client=db_client,\n            node=node,\n            output=(\"error\", error_msg),\n            user_id=user_id,\n            graph_exec_id=graph_exec_id,\n            graph_id=graph_id,\n            log_metadata=log_metadata,\n        ):\n            yield execution\n\n        raise e\n    finally:\n        # Ensure credentials are released even if execution fails\n        if creds_lock:\n            try:\n                creds_lock.release()\n            except Exception as e:\n                log_metadata.error(f\"Failed to release credentials lock: {e}\")\n\n        # Update execution status and spend credits\n        res = update_execution(end_status)\n        if end_status == ExecutionStatus.COMPLETED:\n            s = input_size + output_size\n            t = (\n                (res.end_time - res.start_time).total_seconds()\n                if res.end_time and res.start_time\n                else 0\n            )\n            db_client.spend_credits(user_id, credit, node_block.id, input_data, s, t)\n\n        # Update execution stats\n        if execution_stats is not None:\n            execution_stats.update(node_block.execution_stats)\n            execution_stats[\"input_size\"] = input_size\n            execution_stats[\"output_size\"] = output_size",
                    "start_token": 733,
                    "end_token": 1540,
                    "children": [
                        {
                            "type": "expression_statement",
                            "label": "\"\"\"\n    Execute a node in the graph. This will trigger a block execution on a node,\n    persist the execution result, and return the subsequent node to be executed.\n\n    Args:\n        db_client: The client to send execution updates to the server.\n        creds_manager: The manager to acquire and release credentials.\n        data: The execution data for executing the current node.\n        execution_stats: The execution statistics to be updated.\n\n    Returns:\n        The subsequent node to be enqueued, or None if there is no subsequent node.\n    \"\"\"",
                            "start_token": 733,
                            "end_token": 735,
                            "children": [
                                {
                                    "type": "string",
                                    "label": "\"\"\"\n    Execute a node in the graph. This will trigger a block execution on a node,\n    persist the execution result, and return the subsequent node to be executed.\n\n    Args:\n        db_client: The client to send execution updates to the server.\n        creds_manager: The manager to acquire and release credentials.\n        data: The execution data for executing the current node.\n        execution_stats: The execution statistics to be updated.\n\n    Returns:\n        The subsequent node to be enqueued, or None if there is no subsequent node.\n    \"\"\"",
                                    "start_token": 733,
                                    "end_token": 735,
                                    "children": [
                                        {
                                            "type": "string_start",
                                            "label": "\"\"\"",
                                            "start_token": 733,
                                            "end_token": 734,
                                            "children": []
                                        },
                                        {
                                            "type": "string_content",
                                            "label": "\n    Execute a node in the graph. This will trigger a block execution on a node,\n    persist the execution result, and return the subsequent node to be executed.\n\n    Args:\n        db_client: The client to send execution updates to the server.\n        creds_manager: The manager to acquire and release credentials.\n        data: The execution data for executing the current node.\n        execution_stats: The execution statistics to be updated.\n\n    Returns:\n        The subsequent node to be enqueued, or None if there is no subsequent node.\n    ",
                                            "start_token": 734,
                                            "end_token": 734,
                                            "children": []
                                        },
                                        {
                                            "type": "string_end",
                                            "label": "\"\"\"",
                                            "start_token": 734,
                                            "end_token": 735,
                                            "children": []
                                        }
                                    ]
                                }
                            ]
                        },
                        {
                            "type": "expression_statement",
                            "label": "user_id = data.user_id",
                            "start_token": 737,
                            "end_token": 741,
                            "children": [
                                {
                                    "type": "assignment",
                                    "label": "user_id = data.user_id",
                                    "start_token": 737,
                                    "end_token": 741,
                                    "children": [
                                        {
                                            "type": "identifier",
                                            "label": "user_id",
                                            "start_token": 737,
                                            "end_token": 737,
                                            "children": []
                                        },
                                        {
                                            "type": "attribute",
                                            "label": "data.user_id",
                                            "start_token": 739,
                                            "end_token": 741,
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "label": "data",
                                                    "start_token": 739,
                                                    "end_token": 739,
                                                    "children": []
                                                },
                                                {
                                                    "type": "identifier",
                                                    "label": "user_id",
                                                    "start_token": 741,
                                                    "end_token": 741,
                                                    "children": []
                                                }
                                            ]
                                        }
                                    ]
                                }
                            ]
                        },
                        {
                            "type": "expression_statement",
                            "label": "graph_exec_id = data.graph_exec_id",
                            "start_token": 743,
                            "end_token": 747,
                            "children": [
                                {
                                    "type": "assignment",
                                    "label": "graph_exec_id = data.graph_exec_id",
                                    "start_token": 743,
                                    "end_token": 747,
                                    "children": [
                                        {
                                            "type": "identifier",
                                            "label": "graph_exec_id",
                                            "start_token": 743,
                                            "end_token": 743,
                                            "children": []
                                        },
                                        {
                                            "type": "attribute",
                                            "label": "data.graph_exec_id",
                                            "start_token": 745,
                                            "end_token": 747,
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "label": "data",
                                                    "start_token": 745,
                                                    "end_token": 745,
                                                    "children": []
                                                },
                                                {
                                                    "type": "identifier",
                                                    "label": "graph_exec_id",
                                                    "start_token": 747,
                                                    "end_token": 747,
                                                    "children": []
                                                }
                                            ]
                                        }
                                    ]
                                }
                            ]
                        },
                        {
                            "type": "expression_statement",
                            "label": "graph_id = data.graph_id",
                            "start_token": 749,
                            "end_token": 753,
                            "children": [
                                {
                                    "type": "assignment",
                                    "label": "graph_id = data.graph_id",
                                    "start_token": 749,
                                    "end_token": 753,
                                    "children": [
                                        {
                                            "type": "identifier",
                                            "label": "graph_id",
                                            "start_token": 749,
                                            "end_token": 749,
                                            "children": []
                                        },
                                        {
                                            "type": "attribute",
                                            "label": "data.graph_id",
                                            "start_token": 751,
                                            "end_token": 753,
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "label": "data",
                                                    "start_token": 751,
                                                    "end_token": 751,
                                                    "children": []
                                                },
                                                {
                                                    "type": "identifier",
                                                    "label": "graph_id",
                                                    "start_token": 753,
                                                    "end_token": 753,
                                                    "children": []
                                                }
                                            ]
                                        }
                                    ]
                                }
                            ]
                        },
                        {
                            "type": "expression_statement",
                            "label": "node_exec_id = data.node_exec_id",
                            "start_token": 755,
                            "end_token": 759,
                            "children": [
                                {
                                    "type": "assignment",
                                    "label": "node_exec_id = data.node_exec_id",
                                    "start_token": 755,
                                    "end_token": 759,
                                    "children": [
                                        {
                                            "type": "identifier",
                                            "label": "node_exec_id",
                                            "start_token": 755,
                                            "end_token": 755,
                                            "children": []
                                        },
                                        {
                                            "type": "attribute",
                                            "label": "data.node_exec_id",
                                            "start_token": 757,
                                            "end_token": 759,
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "label": "data",
                                                    "start_token": 757,
                                                    "end_token": 757,
                                                    "children": []
                                                },
                                                {
                                                    "type": "identifier",
                                                    "label": "node_exec_id",
                                                    "start_token": 759,
                                                    "end_token": 759,
                                                    "children": []
                                                }
                                            ]
                                        }
                                    ]
                                }
                            ]
                        },
                        {
                            "type": "expression_statement",
                            "label": "node_id = data.node_id",
                            "start_token": 761,
                            "end_token": 765,
                            "children": [
                                {
                                    "type": "assignment",
                                    "label": "node_id = data.node_id",
                                    "start_token": 761,
                                    "end_token": 765,
                                    "children": [
                                        {
                                            "type": "identifier",
                                            "label": "node_id",
                                            "start_token": 761,
                                            "end_token": 761,
                                            "children": []
                                        },
                                        {
                                            "type": "attribute",
                                            "label": "data.node_id",
                                            "start_token": 763,
                                            "end_token": 765,
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "label": "data",
                                                    "start_token": 763,
                                                    "end_token": 763,
                                                    "children": []
                                                },
                                                {
                                                    "type": "identifier",
                                                    "label": "node_id",
                                                    "start_token": 765,
                                                    "end_token": 765,
                                                    "children": []
                                                }
                                            ]
                                        }
                                    ]
                                }
                            ]
                        },
                        {
                            "type": "function_definition",
                            "label": "def update_execution(status: ExecutionStatus) -> ExecutionResult:\n        exec_update = db_client.update_execution_status(node_exec_id, status)\n        db_client.send_execution_update(exec_update)\n        return exec_update",
                            "start_token": 768,
                            "end_token": 799,
                            "children": [
                                {
                                    "type": "identifier",
                                    "label": "update_execution",
                                    "start_token": 769,
                                    "end_token": 769,
                                    "children": []
                                },
                                {
                                    "type": "parameters",
                                    "label": "(status: ExecutionStatus)",
                                    "start_token": 770,
                                    "end_token": 774,
                                    "children": [
                                        {
                                            "type": "typed_parameter",
                                            "label": "status: ExecutionStatus",
                                            "start_token": 771,
                                            "end_token": 773,
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "label": "status",
                                                    "start_token": 771,
                                                    "end_token": 771,
                                                    "children": []
                                                },
                                                {
                                                    "type": "type",
                                                    "label": "ExecutionStatus",
                                                    "start_token": 773,
                                                    "end_token": 773,
                                                    "children": [
                                                        {
                                                            "type": "identifier",
                                                            "label": "ExecutionStatus",
                                                            "start_token": 773,
                                                            "end_token": 773,
                                                            "children": []
                                                        }
                                                    ]
                                                }
                                            ]
                                        }
                                    ]
                                },
                                {
                                    "type": "type",
                                    "label": "ExecutionResult",
                                    "start_token": 777,
                                    "end_token": 777,
                                    "children": [
                                        {
                                            "type": "identifier",
                                            "label": "ExecutionResult",
                                            "start_token": 777,
                                            "end_token": 777,
                                            "children": []
                                        }
                                    ]
                                },
                                {
                                    "type": "block",
                                    "label": "exec_update = db_client.update_execution_status(node_exec_id, status)\n        db_client.send_execution_update(exec_update)\n        return exec_update",
                                    "start_token": 780,
                                    "end_token": 799,
                                    "children": [
                                        {
                                            "type": "expression_statement",
                                            "label": "exec_update = db_client.update_execution_status(node_exec_id, status)",
                                            "start_token": 780,
                                            "end_token": 789,
                                            "children": [
                                                {
                                                    "type": "assignment",
                                                    "label": "exec_update = db_client.update_execution_status(node_exec_id, status)",
                                                    "start_token": 780,
                                                    "end_token": 789,
                                                    "children": [
                                                        {
                                                            "type": "identifier",
                                                            "label": "exec_update",
                                                            "start_token": 780,
                                                            "end_token": 780,
                                                            "children": []
                                                        },
                                                        {
                                                            "type": "call",
                                                            "label": "db_client.update_execution_status(node_exec_id, status)",
                                                            "start_token": 782,
                                                            "end_token": 789,
                                                            "children": [
                                                                {
                                                                    "type": "attribute",
                                                                    "label": "db_client.update_execution_status",
                                                                    "start_token": 782,
                                                                    "end_token": 784,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "db_client",
                                                                            "start_token": 782,
                                                                            "end_token": 782,
                                                                            "children": []
                                                                        },
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "update_execution_status",
                                                                            "start_token": 784,
                                                                            "end_token": 784,
                                                                            "children": []
                                                                        }
                                                                    ]
                                                                },
                                                                {
                                                                    "type": "argument_list",
                                                                    "label": "(node_exec_id, status)",
                                                                    "start_token": 785,
                                                                    "end_token": 789,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "node_exec_id",
                                                                            "start_token": 786,
                                                                            "end_token": 786,
                                                                            "children": []
                                                                        },
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "status",
                                                                            "start_token": 788,
                                                                            "end_token": 788,
                                                                            "children": []
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                }
                                            ]
                                        },
                                        {
                                            "type": "expression_statement",
                                            "label": "db_client.send_execution_update(exec_update)",
                                            "start_token": 791,
                                            "end_token": 796,
                                            "children": [
                                                {
                                                    "type": "call",
                                                    "label": "db_client.send_execution_update(exec_update)",
                                                    "start_token": 791,
                                                    "end_token": 796,
                                                    "children": [
                                                        {
                                                            "type": "attribute",
                                                            "label": "db_client.send_execution_update",
                                                            "start_token": 791,
                                                            "end_token": 793,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "label": "db_client",
                                                                    "start_token": 791,
                                                                    "end_token": 791,
                                                                    "children": []
                                                                },
                                                                {
                                                                    "type": "identifier",
                                                                    "label": "send_execution_update",
                                                                    "start_token": 793,
                                                                    "end_token": 793,
                                                                    "children": []
                                                                }
                                                            ]
                                                        },
                                                        {
                                                            "type": "argument_list",
                                                            "label": "(exec_update)",
                                                            "start_token": 794,
                                                            "end_token": 796,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "label": "exec_update",
                                                                    "start_token": 795,
                                                                    "end_token": 795,
                                                                    "children": []
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                }
                                            ]
                                        },
                                        {
                                            "type": "return_statement",
                                            "label": "return exec_update",
                                            "start_token": 798,
                                            "end_token": 799,
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "label": "exec_update",
                                                    "start_token": 799,
                                                    "end_token": 799,
                                                    "children": []
                                                }
                                            ]
                                        }
                                    ]
                                }
                            ]
                        },
                        {
                            "type": "expression_statement",
                            "label": "node = db_client.get_node(node_id)",
                            "start_token": 802,
                            "end_token": 809,
                            "children": [
                                {
                                    "type": "assignment",
                                    "label": "node = db_client.get_node(node_id)",
                                    "start_token": 802,
                                    "end_token": 809,
                                    "children": [
                                        {
                                            "type": "identifier",
                                            "label": "node",
                                            "start_token": 802,
                                            "end_token": 802,
                                            "children": []
                                        },
                                        {
                                            "type": "call",
                                            "label": "db_client.get_node(node_id)",
                                            "start_token": 804,
                                            "end_token": 809,
                                            "children": [
                                                {
                                                    "type": "attribute",
                                                    "label": "db_client.get_node",
                                                    "start_token": 804,
                                                    "end_token": 806,
                                                    "children": [
                                                        {
                                                            "type": "identifier",
                                                            "label": "db_client",
                                                            "start_token": 804,
                                                            "end_token": 804,
                                                            "children": []
                                                        },
                                                        {
                                                            "type": "identifier",
                                                            "label": "get_node",
                                                            "start_token": 806,
                                                            "end_token": 806,
                                                            "children": []
                                                        }
                                                    ]
                                                },
                                                {
                                                    "type": "argument_list",
                                                    "label": "(node_id)",
                                                    "start_token": 807,
                                                    "end_token": 809,
                                                    "children": [
                                                        {
                                                            "type": "identifier",
                                                            "label": "node_id",
                                                            "start_token": 808,
                                                            "end_token": 808,
                                                            "children": []
                                                        }
                                                    ]
                                                }
                                            ]
                                        }
                                    ]
                                }
                            ]
                        },
                        {
                            "type": "expression_statement",
                            "label": "node_block = get_block(node.block_id)",
                            "start_token": 812,
                            "end_token": 819,
                            "children": [
                                {
                                    "type": "assignment",
                                    "label": "node_block = get_block(node.block_id)",
                                    "start_token": 812,
                                    "end_token": 819,
                                    "children": [
                                        {
                                            "type": "identifier",
                                            "label": "node_block",
                                            "start_token": 812,
                                            "end_token": 812,
                                            "children": []
                                        },
                                        {
                                            "type": "call",
                                            "label": "get_block(node.block_id)",
                                            "start_token": 814,
                                            "end_token": 819,
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "label": "get_block",
                                                    "start_token": 814,
                                                    "end_token": 814,
                                                    "children": []
                                                },
                                                {
                                                    "type": "argument_list",
                                                    "label": "(node.block_id)",
                                                    "start_token": 815,
                                                    "end_token": 819,
                                                    "children": [
                                                        {
                                                            "type": "attribute",
                                                            "label": "node.block_id",
                                                            "start_token": 816,
                                                            "end_token": 818,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "label": "node",
                                                                    "start_token": 816,
                                                                    "end_token": 816,
                                                                    "children": []
                                                                },
                                                                {
                                                                    "type": "identifier",
                                                                    "label": "block_id",
                                                                    "start_token": 818,
                                                                    "end_token": 818,
                                                                    "children": []
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                }
                                            ]
                                        }
                                    ]
                                }
                            ]
                        },
                        {
                            "type": "if_statement",
                            "label": "if not node_block:\n        logger.error(f\"Block {node.block_id} not found.\")\n        return",
                            "start_token": 821,
                            "end_token": 834,
                            "children": [
                                {
                                    "type": "not_operator",
                                    "label": "not node_block",
                                    "start_token": 822,
                                    "end_token": 823,
                                    "children": [
                                        {
                                            "type": "identifier",
                                            "label": "node_block",
                                            "start_token": 823,
                                            "end_token": 823,
                                            "children": []
                                        }
                                    ]
                                },
                                {
                                    "type": "block",
                                    "label": "logger.error(f\"Block {node.block_id} not found.\")\n        return",
                                    "start_token": 826,
                                    "end_token": 834,
                                    "children": [
                                        {
                                            "type": "expression_statement",
                                            "label": "logger.error(f\"Block {node.block_id} not found.\")",
                                            "start_token": 826,
                                            "end_token": 832,
                                            "children": [
                                                {
                                                    "type": "call",
                                                    "label": "logger.error(f\"Block {node.block_id} not found.\")",
                                                    "start_token": 826,
                                                    "end_token": 832,
                                                    "children": [
                                                        {
                                                            "type": "attribute",
                                                            "label": "logger.error",
                                                            "start_token": 826,
                                                            "end_token": 828,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "label": "logger",
                                                                    "start_token": 826,
                                                                    "end_token": 826,
                                                                    "children": []
                                                                },
                                                                {
                                                                    "type": "identifier",
                                                                    "label": "error",
                                                                    "start_token": 828,
                                                                    "end_token": 828,
                                                                    "children": []
                                                                }
                                                            ]
                                                        },
                                                        {
                                                            "type": "argument_list",
                                                            "label": "(f\"Block {node.block_id} not found.\")",
                                                            "start_token": 829,
                                                            "end_token": 832,
                                                            "children": [
                                                                {
                                                                    "type": "string",
                                                                    "label": "f\"Block {node.block_id} not found.\"",
                                                                    "start_token": 830,
                                                                    "end_token": 831,
                                                                    "children": [
                                                                        {
                                                                            "type": "string_start",
                                                                            "label": "f\"",
                                                                            "start_token": 830,
                                                                            "end_token": 831,
                                                                            "children": []
                                                                        },
                                                                        {
                                                                            "type": "string_content",
                                                                            "label": "Block ",
                                                                            "start_token": 831,
                                                                            "end_token": 831,
                                                                            "children": []
                                                                        },
                                                                        {
                                                                            "type": "interpolation",
                                                                            "label": "{node.block_id}",
                                                                            "start_token": 831,
                                                                            "end_token": 831,
                                                                            "children": [
                                                                                {
                                                                                    "type": "attribute",
                                                                                    "label": "node.block_id",
                                                                                    "start_token": 831,
                                                                                    "end_token": 831,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "label": "node",
                                                                                            "start_token": 831,
                                                                                            "end_token": 831,
                                                                                            "children": []
                                                                                        },
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "label": "block_id",
                                                                                            "start_token": 831,
                                                                                            "end_token": 831,
                                                                                            "children": []
                                                                                        }
                                                                                    ]
                                                                                }
                                                                            ]
                                                                        },
                                                                        {
                                                                            "type": "string_content",
                                                                            "label": " not found.",
                                                                            "start_token": 831,
                                                                            "end_token": 831,
                                                                            "children": []
                                                                        },
                                                                        {
                                                                            "type": "string_end",
                                                                            "label": "\"",
                                                                            "start_token": 831,
                                                                            "end_token": 831,
                                                                            "children": []
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                }
                                            ]
                                        },
                                        {
                                            "type": "return_statement",
                                            "label": "return",
                                            "start_token": 834,
                                            "end_token": 834,
                                            "children": []
                                        }
                                    ]
                                }
                            ]
                        },
                        {
                            "type": "expression_statement",
                            "label": "log_metadata = LogMetadata(\n        user_id=user_id,\n        graph_eid=graph_exec_id,\n        graph_id=graph_id,\n        node_eid=node_exec_id,\n        node_id=node_id,\n        block_name=node_block.name,\n    )",
                            "start_token": 837,
                            "end_token": 874,
                            "children": [
                                {
                                    "type": "assignment",
                                    "label": "log_metadata = LogMetadata(\n        user_id=user_id,\n        graph_eid=graph_exec_id,\n        graph_id=graph_id,\n        node_eid=node_exec_id,\n        node_id=node_id,\n        block_name=node_block.name,\n    )",
                                    "start_token": 837,
                                    "end_token": 874,
                                    "children": [
                                        {
                                            "type": "identifier",
                                            "label": "log_metadata",
                                            "start_token": 837,
                                            "end_token": 837,
                                            "children": []
                                        },
                                        {
                                            "type": "call",
                                            "label": "LogMetadata(\n        user_id=user_id,\n        graph_eid=graph_exec_id,\n        graph_id=graph_id,\n        node_eid=node_exec_id,\n        node_id=node_id,\n        block_name=node_block.name,\n    )",
                                            "start_token": 839,
                                            "end_token": 874,
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "label": "LogMetadata",
                                                    "start_token": 839,
                                                    "end_token": 839,
                                                    "children": []
                                                },
                                                {
                                                    "type": "argument_list",
                                                    "label": "(\n        user_id=user_id,\n        graph_eid=graph_exec_id,\n        graph_id=graph_id,\n        node_eid=node_exec_id,\n        node_id=node_id,\n        block_name=node_block.name,\n    )",
                                                    "start_token": 840,
                                                    "end_token": 874,
                                                    "children": [
                                                        {
                                                            "type": "keyword_argument",
                                                            "label": "user_id=user_id",
                                                            "start_token": 842,
                                                            "end_token": 844,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "label": "user_id",
                                                                    "start_token": 842,
                                                                    "end_token": 842,
                                                                    "children": []
                                                                },
                                                                {
                                                                    "type": "identifier",
                                                                    "label": "user_id",
                                                                    "start_token": 844,
                                                                    "end_token": 844,
                                                                    "children": []
                                                                }
                                                            ]
                                                        },
                                                        {
                                                            "type": "keyword_argument",
                                                            "label": "graph_eid=graph_exec_id",
                                                            "start_token": 847,
                                                            "end_token": 849,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "label": "graph_eid",
                                                                    "start_token": 847,
                                                                    "end_token": 847,
                                                                    "children": []
                                                                },
                                                                {
                                                                    "type": "identifier",
                                                                    "label": "graph_exec_id",
                                                                    "start_token": 849,
                                                                    "end_token": 849,
                                                                    "children": []
                                                                }
                                                            ]
                                                        },
                                                        {
                                                            "type": "keyword_argument",
                                                            "label": "graph_id=graph_id",
                                                            "start_token": 852,
                                                            "end_token": 854,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "label": "graph_id",
                                                                    "start_token": 852,
                                                                    "end_token": 852,
                                                                    "children": []
                                                                },
                                                                {
                                                                    "type": "identifier",
                                                                    "label": "graph_id",
                                                                    "start_token": 854,
                                                                    "end_token": 854,
                                                                    "children": []
                                                                }
                                                            ]
                                                        },
                                                        {
                                                            "type": "keyword_argument",
                                                            "label": "node_eid=node_exec_id",
                                                            "start_token": 857,
                                                            "end_token": 859,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "label": "node_eid",
                                                                    "start_token": 857,
                                                                    "end_token": 857,
                                                                    "children": []
                                                                },
                                                                {
                                                                    "type": "identifier",
                                                                    "label": "node_exec_id",
                                                                    "start_token": 859,
                                                                    "end_token": 859,
                                                                    "children": []
                                                                }
                                                            ]
                                                        },
                                                        {
                                                            "type": "keyword_argument",
                                                            "label": "node_id=node_id",
                                                            "start_token": 862,
                                                            "end_token": 864,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "label": "node_id",
                                                                    "start_token": 862,
                                                                    "end_token": 862,
                                                                    "children": []
                                                                },
                                                                {
                                                                    "type": "identifier",
                                                                    "label": "node_id",
                                                                    "start_token": 864,
                                                                    "end_token": 864,
                                                                    "children": []
                                                                }
                                                            ]
                                                        },
                                                        {
                                                            "type": "keyword_argument",
                                                            "label": "block_name=node_block.name",
                                                            "start_token": 867,
                                                            "end_token": 871,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "label": "block_name",
                                                                    "start_token": 867,
                                                                    "end_token": 867,
                                                                    "children": []
                                                                },
                                                                {
                                                                    "type": "attribute",
                                                                    "label": "node_block.name",
                                                                    "start_token": 869,
                                                                    "end_token": 871,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "node_block",
                                                                            "start_token": 869,
                                                                            "end_token": 869,
                                                                            "children": []
                                                                        },
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "name",
                                                                            "start_token": 871,
                                                                            "end_token": 871,
                                                                            "children": []
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                }
                                            ]
                                        }
                                    ]
                                }
                            ]
                        },
                        {
                            "type": "comment",
                            "label": "# Sanity check: validate the execution input.",
                            "start_token": 877,
                            "end_token": 885,
                            "children": []
                        },
                        {
                            "type": "expression_statement",
                            "label": "input_data, error = validate_exec(node, data.data, resolve_input=False)",
                            "start_token": 887,
                            "end_token": 902,
                            "children": [
                                {
                                    "type": "assignment",
                                    "label": "input_data, error = validate_exec(node, data.data, resolve_input=False)",
                                    "start_token": 887,
                                    "end_token": 902,
                                    "children": [
                                        {
                                            "type": "pattern_list",
                                            "label": "input_data, error",
                                            "start_token": 887,
                                            "end_token": 889,
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "label": "input_data",
                                                    "start_token": 887,
                                                    "end_token": 887,
                                                    "children": []
                                                },
                                                {
                                                    "type": "identifier",
                                                    "label": "error",
                                                    "start_token": 889,
                                                    "end_token": 889,
                                                    "children": []
                                                }
                                            ]
                                        },
                                        {
                                            "type": "call",
                                            "label": "validate_exec(node, data.data, resolve_input=False)",
                                            "start_token": 891,
                                            "end_token": 902,
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "label": "validate_exec",
                                                    "start_token": 891,
                                                    "end_token": 891,
                                                    "children": []
                                                },
                                                {
                                                    "type": "argument_list",
                                                    "label": "(node, data.data, resolve_input=False)",
                                                    "start_token": 892,
                                                    "end_token": 902,
                                                    "children": [
                                                        {
                                                            "type": "identifier",
                                                            "label": "node",
                                                            "start_token": 893,
                                                            "end_token": 893,
                                                            "children": []
                                                        },
                                                        {
                                                            "type": "attribute",
                                                            "label": "data.data",
                                                            "start_token": 895,
                                                            "end_token": 897,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "label": "data",
                                                                    "start_token": 895,
                                                                    "end_token": 895,
                                                                    "children": []
                                                                },
                                                                {
                                                                    "type": "identifier",
                                                                    "label": "data",
                                                                    "start_token": 897,
                                                                    "end_token": 897,
                                                                    "children": []
                                                                }
                                                            ]
                                                        },
                                                        {
                                                            "type": "keyword_argument",
                                                            "label": "resolve_input=False",
                                                            "start_token": 899,
                                                            "end_token": 901,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "label": "resolve_input",
                                                                    "start_token": 899,
                                                                    "end_token": 899,
                                                                    "children": []
                                                                },
                                                                {
                                                                    "type": "false",
                                                                    "label": "False",
                                                                    "start_token": 901,
                                                                    "end_token": 901,
                                                                    "children": []
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                }
                                            ]
                                        }
                                    ]
                                }
                            ]
                        },
                        {
                            "type": "if_statement",
                            "label": "if input_data is None:\n        log_metadata.error(f\"Skip execution, input validation error: {error}\")\n        db_client.upsert_execution_output(node_exec_id, \"error\", error)\n        update_execution(ExecutionStatus.FAILED)\n        return",
                            "start_token": 904,
                            "end_token": 936,
                            "children": [
                                {
                                    "type": "comparison_operator",
                                    "label": "input_data is None",
                                    "start_token": 905,
                                    "end_token": 907,
                                    "children": [
                                        {
                                            "type": "identifier",
                                            "label": "input_data",
                                            "start_token": 905,
                                            "end_token": 905,
                                            "children": []
                                        },
                                        {
                                            "type": "none",
                                            "label": "None",
                                            "start_token": 907,
                                            "end_token": 907,
                                            "children": []
                                        }
                                    ]
                                },
                                {
                                    "type": "block",
                                    "label": "log_metadata.error(f\"Skip execution, input validation error: {error}\")\n        db_client.upsert_execution_output(node_exec_id, \"error\", error)\n        update_execution(ExecutionStatus.FAILED)\n        return",
                                    "start_token": 910,
                                    "end_token": 936,
                                    "children": [
                                        {
                                            "type": "expression_statement",
                                            "label": "log_metadata.error(f\"Skip execution, input validation error: {error}\")",
                                            "start_token": 910,
                                            "end_token": 916,
                                            "children": [
                                                {
                                                    "type": "call",
                                                    "label": "log_metadata.error(f\"Skip execution, input validation error: {error}\")",
                                                    "start_token": 910,
                                                    "end_token": 916,
                                                    "children": [
                                                        {
                                                            "type": "attribute",
                                                            "label": "log_metadata.error",
                                                            "start_token": 910,
                                                            "end_token": 912,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "label": "log_metadata",
                                                                    "start_token": 910,
                                                                    "end_token": 910,
                                                                    "children": []
                                                                },
                                                                {
                                                                    "type": "identifier",
                                                                    "label": "error",
                                                                    "start_token": 912,
                                                                    "end_token": 912,
                                                                    "children": []
                                                                }
                                                            ]
                                                        },
                                                        {
                                                            "type": "argument_list",
                                                            "label": "(f\"Skip execution, input validation error: {error}\")",
                                                            "start_token": 913,
                                                            "end_token": 916,
                                                            "children": [
                                                                {
                                                                    "type": "string",
                                                                    "label": "f\"Skip execution, input validation error: {error}\"",
                                                                    "start_token": 914,
                                                                    "end_token": 915,
                                                                    "children": [
                                                                        {
                                                                            "type": "string_start",
                                                                            "label": "f\"",
                                                                            "start_token": 914,
                                                                            "end_token": 915,
                                                                            "children": []
                                                                        },
                                                                        {
                                                                            "type": "string_content",
                                                                            "label": "Skip execution, input validation error: ",
                                                                            "start_token": 915,
                                                                            "end_token": 915,
                                                                            "children": []
                                                                        },
                                                                        {
                                                                            "type": "interpolation",
                                                                            "label": "{error}",
                                                                            "start_token": 915,
                                                                            "end_token": 915,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "error",
                                                                                    "start_token": 915,
                                                                                    "end_token": 915,
                                                                                    "children": []
                                                                                }
                                                                            ]
                                                                        },
                                                                        {
                                                                            "type": "string_end",
                                                                            "label": "\"",
                                                                            "start_token": 915,
                                                                            "end_token": 915,
                                                                            "children": []
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                }
                                            ]
                                        },
                                        {
                                            "type": "expression_statement",
                                            "label": "db_client.upsert_execution_output(node_exec_id, \"error\", error)",
                                            "start_token": 918,
                                            "end_token": 927,
                                            "children": [
                                                {
                                                    "type": "call",
                                                    "label": "db_client.upsert_execution_output(node_exec_id, \"error\", error)",
                                                    "start_token": 918,
                                                    "end_token": 927,
                                                    "children": [
                                                        {
                                                            "type": "attribute",
                                                            "label": "db_client.upsert_execution_output",
                                                            "start_token": 918,
                                                            "end_token": 920,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "label": "db_client",
                                                                    "start_token": 918,
                                                                    "end_token": 918,
                                                                    "children": []
                                                                },
                                                                {
                                                                    "type": "identifier",
                                                                    "label": "upsert_execution_output",
                                                                    "start_token": 920,
                                                                    "end_token": 920,
                                                                    "children": []
                                                                }
                                                            ]
                                                        },
                                                        {
                                                            "type": "argument_list",
                                                            "label": "(node_exec_id, \"error\", error)",
                                                            "start_token": 921,
                                                            "end_token": 927,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "label": "node_exec_id",
                                                                    "start_token": 922,
                                                                    "end_token": 922,
                                                                    "children": []
                                                                },
                                                                {
                                                                    "type": "string",
                                                                    "label": "\"error\"",
                                                                    "start_token": 924,
                                                                    "end_token": 924,
                                                                    "children": [
                                                                        {
                                                                            "type": "string_start",
                                                                            "label": "\"",
                                                                            "start_token": 924,
                                                                            "end_token": 924,
                                                                            "children": []
                                                                        },
                                                                        {
                                                                            "type": "string_content",
                                                                            "label": "error",
                                                                            "start_token": 924,
                                                                            "end_token": 924,
                                                                            "children": []
                                                                        },
                                                                        {
                                                                            "type": "string_end",
                                                                            "label": "\"",
                                                                            "start_token": 924,
                                                                            "end_token": 924,
                                                                            "children": []
                                                                        }
                                                                    ]
                                                                },
                                                                {
                                                                    "type": "identifier",
                                                                    "label": "error",
                                                                    "start_token": 926,
                                                                    "end_token": 926,
                                                                    "children": []
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                }
                                            ]
                                        },
                                        {
                                            "type": "expression_statement",
                                            "label": "update_execution(ExecutionStatus.FAILED)",
                                            "start_token": 929,
                                            "end_token": 934,
                                            "children": [
                                                {
                                                    "type": "call",
                                                    "label": "update_execution(ExecutionStatus.FAILED)",
                                                    "start_token": 929,
                                                    "end_token": 934,
                                                    "children": [
                                                        {
                                                            "type": "identifier",
                                                            "label": "update_execution",
                                                            "start_token": 929,
                                                            "end_token": 929,
                                                            "children": []
                                                        },
                                                        {
                                                            "type": "argument_list",
                                                            "label": "(ExecutionStatus.FAILED)",
                                                            "start_token": 930,
                                                            "end_token": 934,
                                                            "children": [
                                                                {
                                                                    "type": "attribute",
                                                                    "label": "ExecutionStatus.FAILED",
                                                                    "start_token": 931,
                                                                    "end_token": 933,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "ExecutionStatus",
                                                                            "start_token": 931,
                                                                            "end_token": 931,
                                                                            "children": []
                                                                        },
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "FAILED",
                                                                            "start_token": 933,
                                                                            "end_token": 933,
                                                                            "children": []
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                }
                                            ]
                                        },
                                        {
                                            "type": "return_statement",
                                            "label": "return",
                                            "start_token": 936,
                                            "end_token": 936,
                                            "children": []
                                        }
                                    ]
                                }
                            ]
                        },
                        {
                            "type": "comment",
                            "label": "# Re-shape the input data for agent block.",
                            "start_token": 939,
                            "end_token": 949,
                            "children": []
                        },
                        {
                            "type": "comment",
                            "label": "# AgentExecutorBlock specially separate the node input_data & its input_default.",
                            "start_token": 951,
                            "end_token": 961,
                            "children": []
                        },
                        {
                            "type": "if_statement",
                            "label": "if isinstance(node_block, AgentExecutorBlock):\n        input_data = {**node.input_default, \"data\": input_data}",
                            "start_token": 963,
                            "end_token": 984,
                            "children": [
                                {
                                    "type": "call",
                                    "label": "isinstance(node_block, AgentExecutorBlock)",
                                    "start_token": 964,
                                    "end_token": 969,
                                    "children": [
                                        {
                                            "type": "identifier",
                                            "label": "isinstance",
                                            "start_token": 964,
                                            "end_token": 964,
                                            "children": []
                                        },
                                        {
                                            "type": "argument_list",
                                            "label": "(node_block, AgentExecutorBlock)",
                                            "start_token": 965,
                                            "end_token": 969,
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "label": "node_block",
                                                    "start_token": 966,
                                                    "end_token": 966,
                                                    "children": []
                                                },
                                                {
                                                    "type": "identifier",
                                                    "label": "AgentExecutorBlock",
                                                    "start_token": 968,
                                                    "end_token": 968,
                                                    "children": []
                                                }
                                            ]
                                        }
                                    ]
                                },
                                {
                                    "type": "block",
                                    "label": "input_data = {**node.input_default, \"data\": input_data}",
                                    "start_token": 972,
                                    "end_token": 984,
                                    "children": [
                                        {
                                            "type": "expression_statement",
                                            "label": "input_data = {**node.input_default, \"data\": input_data}",
                                            "start_token": 972,
                                            "end_token": 984,
                                            "children": [
                                                {
                                                    "type": "assignment",
                                                    "label": "input_data = {**node.input_default, \"data\": input_data}",
                                                    "start_token": 972,
                                                    "end_token": 984,
                                                    "children": [
                                                        {
                                                            "type": "identifier",
                                                            "label": "input_data",
                                                            "start_token": 972,
                                                            "end_token": 972,
                                                            "children": []
                                                        },
                                                        {
                                                            "type": "dictionary",
                                                            "label": "{**node.input_default, \"data\": input_data}",
                                                            "start_token": 974,
                                                            "end_token": 984,
                                                            "children": [
                                                                {
                                                                    "type": "dictionary_splat",
                                                                    "label": "**node.input_default",
                                                                    "start_token": 975,
                                                                    "end_token": 979,
                                                                    "children": [
                                                                        {
                                                                            "type": "attribute",
                                                                            "label": "node.input_default",
                                                                            "start_token": 977,
                                                                            "end_token": 979,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "node",
                                                                                    "start_token": 977,
                                                                                    "end_token": 977,
                                                                                    "children": []
                                                                                },
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "input_default",
                                                                                    "start_token": 979,
                                                                                    "end_token": 979,
                                                                                    "children": []
                                                                                }
                                                                            ]
                                                                        }
                                                                    ]
                                                                },
                                                                {
                                                                    "type": "pair",
                                                                    "label": "\"data\": input_data",
                                                                    "start_token": 981,
                                                                    "end_token": 983,
                                                                    "children": [
                                                                        {
                                                                            "type": "string",
                                                                            "label": "\"data\"",
                                                                            "start_token": 981,
                                                                            "end_token": 981,
                                                                            "children": [
                                                                                {
                                                                                    "type": "string_start",
                                                                                    "label": "\"",
                                                                                    "start_token": 981,
                                                                                    "end_token": 981,
                                                                                    "children": []
                                                                                },
                                                                                {
                                                                                    "type": "string_content",
                                                                                    "label": "data",
                                                                                    "start_token": 981,
                                                                                    "end_token": 981,
                                                                                    "children": []
                                                                                },
                                                                                {
                                                                                    "type": "string_end",
                                                                                    "label": "\"",
                                                                                    "start_token": 981,
                                                                                    "end_token": 981,
                                                                                    "children": []
                                                                                }
                                                                            ]
                                                                        },
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "input_data",
                                                                            "start_token": 983,
                                                                            "end_token": 983,
                                                                            "children": []
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                }
                                            ]
                                        }
                                    ]
                                }
                            ]
                        },
                        {
                            "type": "comment",
                            "label": "# Execute the node",
                            "start_token": 987,
                            "end_token": 990,
                            "children": []
                        },
                        {
                            "type": "expression_statement",
                            "label": "input_data_str = json.dumps(input_data)",
                            "start_token": 992,
                            "end_token": 999,
                            "children": [
                                {
                                    "type": "assignment",
                                    "label": "input_data_str = json.dumps(input_data)",
                                    "start_token": 992,
                                    "end_token": 999,
                                    "children": [
                                        {
                                            "type": "identifier",
                                            "label": "input_data_str",
                                            "start_token": 992,
                                            "end_token": 992,
                                            "children": []
                                        },
                                        {
                                            "type": "call",
                                            "label": "json.dumps(input_data)",
                                            "start_token": 994,
                                            "end_token": 999,
                                            "children": [
                                                {
                                                    "type": "attribute",
                                                    "label": "json.dumps",
                                                    "start_token": 994,
                                                    "end_token": 996,
                                                    "children": [
                                                        {
                                                            "type": "identifier",
                                                            "label": "json",
                                                            "start_token": 994,
                                                            "end_token": 994,
                                                            "children": []
                                                        },
                                                        {
                                                            "type": "identifier",
                                                            "label": "dumps",
                                                            "start_token": 996,
                                                            "end_token": 996,
                                                            "children": []
                                                        }
                                                    ]
                                                },
                                                {
                                                    "type": "argument_list",
                                                    "label": "(input_data)",
                                                    "start_token": 997,
                                                    "end_token": 999,
                                                    "children": [
                                                        {
                                                            "type": "identifier",
                                                            "label": "input_data",
                                                            "start_token": 998,
                                                            "end_token": 998,
                                                            "children": []
                                                        }
                                                    ]
                                                }
                                            ]
                                        }
                                    ]
                                }
                            ]
                        },
                        {
                            "type": "expression_statement",
                            "label": "input_size = len(input_data_str)",
                            "start_token": 1001,
                            "end_token": 1006,
                            "children": [
                                {
                                    "type": "assignment",
                                    "label": "input_size = len(input_data_str)",
                                    "start_token": 1001,
                                    "end_token": 1006,
                                    "children": [
                                        {
                                            "type": "identifier",
                                            "label": "input_size",
                                            "start_token": 1001,
                                            "end_token": 1001,
                                            "children": []
                                        },
                                        {
                                            "type": "call",
                                            "label": "len(input_data_str)",
                                            "start_token": 1003,
                                            "end_token": 1006,
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "label": "len",
                                                    "start_token": 1003,
                                                    "end_token": 1003,
                                                    "children": []
                                                },
                                                {
                                                    "type": "argument_list",
                                                    "label": "(input_data_str)",
                                                    "start_token": 1004,
                                                    "end_token": 1006,
                                                    "children": [
                                                        {
                                                            "type": "identifier",
                                                            "label": "input_data_str",
                                                            "start_token": 1005,
                                                            "end_token": 1005,
                                                            "children": []
                                                        }
                                                    ]
                                                }
                                            ]
                                        }
                                    ]
                                }
                            ]
                        },
                        {
                            "type": "expression_statement",
                            "label": "log_metadata.info(\"Executed node with input\", input=input_data_str)",
                            "start_token": 1008,
                            "end_token": 1017,
                            "children": [
                                {
                                    "type": "call",
                                    "label": "log_metadata.info(\"Executed node with input\", input=input_data_str)",
                                    "start_token": 1008,
                                    "end_token": 1017,
                                    "children": [
                                        {
                                            "type": "attribute",
                                            "label": "log_metadata.info",
                                            "start_token": 1008,
                                            "end_token": 1010,
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "label": "log_metadata",
                                                    "start_token": 1008,
                                                    "end_token": 1008,
                                                    "children": []
                                                },
                                                {
                                                    "type": "identifier",
                                                    "label": "info",
                                                    "start_token": 1010,
                                                    "end_token": 1010,
                                                    "children": []
                                                }
                                            ]
                                        },
                                        {
                                            "type": "argument_list",
                                            "label": "(\"Executed node with input\", input=input_data_str)",
                                            "start_token": 1011,
                                            "end_token": 1017,
                                            "children": [
                                                {
                                                    "type": "string",
                                                    "label": "\"Executed node with input\"",
                                                    "start_token": 1012,
                                                    "end_token": 1012,
                                                    "children": [
                                                        {
                                                            "type": "string_start",
                                                            "label": "\"",
                                                            "start_token": 1012,
                                                            "end_token": 1012,
                                                            "children": []
                                                        },
                                                        {
                                                            "type": "string_content",
                                                            "label": "Executed node with input",
                                                            "start_token": 1012,
                                                            "end_token": 1012,
                                                            "children": []
                                                        },
                                                        {
                                                            "type": "string_end",
                                                            "label": "\"",
                                                            "start_token": 1012,
                                                            "end_token": 1012,
                                                            "children": []
                                                        }
                                                    ]
                                                },
                                                {
                                                    "type": "keyword_argument",
                                                    "label": "input=input_data_str",
                                                    "start_token": 1014,
                                                    "end_token": 1016,
                                                    "children": [
                                                        {
                                                            "type": "identifier",
                                                            "label": "input",
                                                            "start_token": 1014,
                                                            "end_token": 1014,
                                                            "children": []
                                                        },
                                                        {
                                                            "type": "identifier",
                                                            "label": "input_data_str",
                                                            "start_token": 1016,
                                                            "end_token": 1016,
                                                            "children": []
                                                        }
                                                    ]
                                                }
                                            ]
                                        }
                                    ]
                                }
                            ]
                        },
                        {
                            "type": "expression_statement",
                            "label": "update_execution(ExecutionStatus.RUNNING)",
                            "start_token": 1019,
                            "end_token": 1024,
                            "children": [
                                {
                                    "type": "call",
                                    "label": "update_execution(ExecutionStatus.RUNNING)",
                                    "start_token": 1019,
                                    "end_token": 1024,
                                    "children": [
                                        {
                                            "type": "identifier",
                                            "label": "update_execution",
                                            "start_token": 1019,
                                            "end_token": 1019,
                                            "children": []
                                        },
                                        {
                                            "type": "argument_list",
                                            "label": "(ExecutionStatus.RUNNING)",
                                            "start_token": 1020,
                                            "end_token": 1024,
                                            "children": [
                                                {
                                                    "type": "attribute",
                                                    "label": "ExecutionStatus.RUNNING",
                                                    "start_token": 1021,
                                                    "end_token": 1023,
                                                    "children": [
                                                        {
                                                            "type": "identifier",
                                                            "label": "ExecutionStatus",
                                                            "start_token": 1021,
                                                            "end_token": 1021,
                                                            "children": []
                                                        },
                                                        {
                                                            "type": "identifier",
                                                            "label": "RUNNING",
                                                            "start_token": 1023,
                                                            "end_token": 1023,
                                                            "children": []
                                                        }
                                                    ]
                                                }
                                            ]
                                        }
                                    ]
                                }
                            ]
                        },
                        {
                            "type": "expression_statement",
                            "label": "extra_exec_kwargs = {}",
                            "start_token": 1027,
                            "end_token": 1030,
                            "children": [
                                {
                                    "type": "assignment",
                                    "label": "extra_exec_kwargs = {}",
                                    "start_token": 1027,
                                    "end_token": 1030,
                                    "children": [
                                        {
                                            "type": "identifier",
                                            "label": "extra_exec_kwargs",
                                            "start_token": 1027,
                                            "end_token": 1027,
                                            "children": []
                                        },
                                        {
                                            "type": "dictionary",
                                            "label": "{}",
                                            "start_token": 1029,
                                            "end_token": 1030,
                                            "children": []
                                        }
                                    ]
                                }
                            ]
                        },
                        {
                            "type": "comment",
                            "label": "# Last-minute fetch credentials + acquire a system-wide read-write lock to prevent",
                            "start_token": 1032,
                            "end_token": 1049,
                            "children": []
                        },
                        {
                            "type": "comment",
                            "label": "# changes during execution. ⚠️ This means a set of credentials can only be used by",
                            "start_token": 1051,
                            "end_token": -1,
                            "children": []
                        },
                        {
                            "type": "comment",
                            "label": "# one (running) block at a time; simultaneous execution of blocks using same",
                            "start_token": 1071,
                            "end_token": -1,
                            "children": []
                        },
                        {
                            "type": "comment",
                            "label": "# credentials is not supported.",
                            "start_token": 1088,
                            "end_token": -1,
                            "children": []
                        },
                        {
                            "type": "expression_statement",
                            "label": "creds_lock = None",
                            "start_token": 1094,
                            "end_token": -1,
                            "children": [
                                {
                                    "type": "assignment",
                                    "label": "creds_lock = None",
                                    "start_token": 1094,
                                    "end_token": -1,
                                    "children": [
                                        {
                                            "type": "identifier",
                                            "label": "creds_lock",
                                            "start_token": 1094,
                                            "end_token": 1096,
                                            "children": []
                                        },
                                        {
                                            "type": "none",
                                            "label": "None",
                                            "start_token": 1097,
                                            "end_token": -1,
                                            "children": []
                                        }
                                    ]
                                }
                            ]
                        },
                        {
                            "type": "if_statement",
                            "label": "if CREDENTIALS_FIELD_NAME in input_data:\n        credentials_meta = CredentialsMetaInput(**input_data[CREDENTIALS_FIELD_NAME])\n        credentials, creds_lock = creds_manager.acquire(user_id, credentials_meta.id)\n        extra_exec_kwargs[\"credentials\"] = credentials",
                            "start_token": 1099,
                            "end_token": -1,
                            "children": [
                                {
                                    "type": "comparison_operator",
                                    "label": "CREDENTIALS_FIELD_NAME in input_data",
                                    "start_token": 1099,
                                    "end_token": -1,
                                    "children": [
                                        {
                                            "type": "identifier",
                                            "label": "CREDENTIALS_FIELD_NAME",
                                            "start_token": 1099,
                                            "end_token": -1,
                                            "children": []
                                        },
                                        {
                                            "type": "identifier",
                                            "label": "input_data",
                                            "start_token": 1101,
                                            "end_token": -1,
                                            "children": []
                                        }
                                    ]
                                },
                                {
                                    "type": "block",
                                    "label": "credentials_meta = CredentialsMetaInput(**input_data[CREDENTIALS_FIELD_NAME])\n        credentials, creds_lock = creds_manager.acquire(user_id, credentials_meta.id)\n        extra_exec_kwargs[\"credentials\"] = credentials",
                                    "start_token": 1104,
                                    "end_token": -1,
                                    "children": [
                                        {
                                            "type": "expression_statement",
                                            "label": "credentials_meta = CredentialsMetaInput(**input_data[CREDENTIALS_FIELD_NAME])",
                                            "start_token": 1104,
                                            "end_token": -1,
                                            "children": [
                                                {
                                                    "type": "assignment",
                                                    "label": "credentials_meta = CredentialsMetaInput(**input_data[CREDENTIALS_FIELD_NAME])",
                                                    "start_token": 1104,
                                                    "end_token": -1,
                                                    "children": [
                                                        {
                                                            "type": "identifier",
                                                            "label": "credentials_meta",
                                                            "start_token": 1104,
                                                            "end_token": 1106,
                                                            "children": []
                                                        },
                                                        {
                                                            "type": "call",
                                                            "label": "CredentialsMetaInput(**input_data[CREDENTIALS_FIELD_NAME])",
                                                            "start_token": 1106,
                                                            "end_token": -1,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "label": "CredentialsMetaInput",
                                                                    "start_token": 1106,
                                                                    "end_token": 1110,
                                                                    "children": []
                                                                },
                                                                {
                                                                    "type": "argument_list",
                                                                    "label": "(**input_data[CREDENTIALS_FIELD_NAME])",
                                                                    "start_token": 1110,
                                                                    "end_token": -1,
                                                                    "children": [
                                                                        {
                                                                            "type": "dictionary_splat",
                                                                            "label": "**input_data[CREDENTIALS_FIELD_NAME]",
                                                                            "start_token": 1110,
                                                                            "end_token": -1,
                                                                            "children": [
                                                                                {
                                                                                    "type": "subscript",
                                                                                    "label": "input_data[CREDENTIALS_FIELD_NAME]",
                                                                                    "start_token": 1110,
                                                                                    "end_token": -1,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "label": "input_data",
                                                                                            "start_token": 1110,
                                                                                            "end_token": 1112,
                                                                                            "children": []
                                                                                        },
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "label": "CREDENTIALS_FIELD_NAME",
                                                                                            "start_token": 1112,
                                                                                            "end_token": -1,
                                                                                            "children": []
                                                                                        }
                                                                                    ]
                                                                                }
                                                                            ]
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                }
                                            ]
                                        },
                                        {
                                            "type": "expression_statement",
                                            "label": "credentials, creds_lock = creds_manager.acquire(user_id, credentials_meta.id)",
                                            "start_token": 1116,
                                            "end_token": -1,
                                            "children": [
                                                {
                                                    "type": "assignment",
                                                    "label": "credentials, creds_lock = creds_manager.acquire(user_id, credentials_meta.id)",
                                                    "start_token": 1116,
                                                    "end_token": -1,
                                                    "children": [
                                                        {
                                                            "type": "pattern_list",
                                                            "label": "credentials, creds_lock",
                                                            "start_token": 1116,
                                                            "end_token": 1120,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "label": "credentials",
                                                                    "start_token": 1116,
                                                                    "end_token": 1118,
                                                                    "children": []
                                                                },
                                                                {
                                                                    "type": "identifier",
                                                                    "label": "creds_lock",
                                                                    "start_token": 1118,
                                                                    "end_token": 1120,
                                                                    "children": []
                                                                }
                                                            ]
                                                        },
                                                        {
                                                            "type": "call",
                                                            "label": "creds_manager.acquire(user_id, credentials_meta.id)",
                                                            "start_token": 1120,
                                                            "end_token": -1,
                                                            "children": [
                                                                {
                                                                    "type": "attribute",
                                                                    "label": "creds_manager.acquire",
                                                                    "start_token": 1120,
                                                                    "end_token": 1124,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "creds_manager",
                                                                            "start_token": 1120,
                                                                            "end_token": 1122,
                                                                            "children": []
                                                                        },
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "acquire",
                                                                            "start_token": 1122,
                                                                            "end_token": 1124,
                                                                            "children": []
                                                                        }
                                                                    ]
                                                                },
                                                                {
                                                                    "type": "argument_list",
                                                                    "label": "(user_id, credentials_meta.id)",
                                                                    "start_token": 1124,
                                                                    "end_token": -1,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "user_id",
                                                                            "start_token": 1124,
                                                                            "end_token": 1126,
                                                                            "children": []
                                                                        },
                                                                        {
                                                                            "type": "attribute",
                                                                            "label": "credentials_meta.id",
                                                                            "start_token": 1126,
                                                                            "end_token": -1,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "credentials_meta",
                                                                                    "start_token": 1126,
                                                                                    "end_token": 1129,
                                                                                    "children": []
                                                                                },
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "id",
                                                                                    "start_token": -1,
                                                                                    "end_token": -1,
                                                                                    "children": []
                                                                                }
                                                                            ]
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                }
                                            ]
                                        },
                                        {
                                            "type": "expression_statement",
                                            "label": "extra_exec_kwargs[\"credentials\"] = credentials",
                                            "start_token": 1131,
                                            "end_token": -1,
                                            "children": [
                                                {
                                                    "type": "assignment",
                                                    "label": "extra_exec_kwargs[\"credentials\"] = credentials",
                                                    "start_token": 1131,
                                                    "end_token": -1,
                                                    "children": [
                                                        {
                                                            "type": "subscript",
                                                            "label": "extra_exec_kwargs[\"credentials\"]",
                                                            "start_token": 1131,
                                                            "end_token": 1136,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "label": "extra_exec_kwargs",
                                                                    "start_token": 1131,
                                                                    "end_token": 1133,
                                                                    "children": []
                                                                },
                                                                {
                                                                    "type": "string",
                                                                    "label": "\"credentials\"",
                                                                    "start_token": 1133,
                                                                    "end_token": -1,
                                                                    "children": [
                                                                        {
                                                                            "type": "string_start",
                                                                            "label": "\"",
                                                                            "start_token": 1133,
                                                                            "end_token": 1133,
                                                                            "children": []
                                                                        },
                                                                        {
                                                                            "type": "string_content",
                                                                            "label": "credentials",
                                                                            "start_token": 1133,
                                                                            "end_token": 1135,
                                                                            "children": []
                                                                        },
                                                                        {
                                                                            "type": "string_end",
                                                                            "label": "\"",
                                                                            "start_token": -1,
                                                                            "end_token": -1,
                                                                            "children": []
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        },
                                                        {
                                                            "type": "identifier",
                                                            "label": "credentials",
                                                            "start_token": 1136,
                                                            "end_token": -1,
                                                            "children": []
                                                        }
                                                    ]
                                                }
                                            ]
                                        }
                                    ]
                                }
                            ]
                        },
                        {
                            "type": "expression_statement",
                            "label": "output_size = 0",
                            "start_token": 1139,
                            "end_token": -1,
                            "children": [
                                {
                                    "type": "assignment",
                                    "label": "output_size = 0",
                                    "start_token": 1139,
                                    "end_token": -1,
                                    "children": [
                                        {
                                            "type": "identifier",
                                            "label": "output_size",
                                            "start_token": 1139,
                                            "end_token": 1141,
                                            "children": []
                                        },
                                        {
                                            "type": "integer",
                                            "label": "0",
                                            "start_token": -1,
                                            "end_token": -1,
                                            "children": []
                                        }
                                    ]
                                }
                            ]
                        },
                        {
                            "type": "expression_statement",
                            "label": "end_status = ExecutionStatus.COMPLETED",
                            "start_token": 1143,
                            "end_token": -1,
                            "children": [
                                {
                                    "type": "assignment",
                                    "label": "end_status = ExecutionStatus.COMPLETED",
                                    "start_token": 1143,
                                    "end_token": -1,
                                    "children": [
                                        {
                                            "type": "identifier",
                                            "label": "end_status",
                                            "start_token": 1143,
                                            "end_token": 1145,
                                            "children": []
                                        },
                                        {
                                            "type": "attribute",
                                            "label": "ExecutionStatus.COMPLETED",
                                            "start_token": 1145,
                                            "end_token": -1,
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "label": "ExecutionStatus",
                                                    "start_token": 1145,
                                                    "end_token": 1147,
                                                    "children": []
                                                },
                                                {
                                                    "type": "identifier",
                                                    "label": "COMPLETED",
                                                    "start_token": 1147,
                                                    "end_token": -1,
                                                    "children": []
                                                }
                                            ]
                                        }
                                    ]
                                }
                            ]
                        },
                        {
                            "type": "expression_statement",
                            "label": "credit = db_client.get_or_refill_credit(user_id)",
                            "start_token": 1149,
                            "end_token": -1,
                            "children": [
                                {
                                    "type": "assignment",
                                    "label": "credit = db_client.get_or_refill_credit(user_id)",
                                    "start_token": 1149,
                                    "end_token": -1,
                                    "children": [
                                        {
                                            "type": "identifier",
                                            "label": "credit",
                                            "start_token": 1149,
                                            "end_token": 1151,
                                            "children": []
                                        },
                                        {
                                            "type": "call",
                                            "label": "db_client.get_or_refill_credit(user_id)",
                                            "start_token": 1151,
                                            "end_token": -1,
                                            "children": [
                                                {
                                                    "type": "attribute",
                                                    "label": "db_client.get_or_refill_credit",
                                                    "start_token": 1151,
                                                    "end_token": 1155,
                                                    "children": [
                                                        {
                                                            "type": "identifier",
                                                            "label": "db_client",
                                                            "start_token": 1151,
                                                            "end_token": 1153,
                                                            "children": []
                                                        },
                                                        {
                                                            "type": "identifier",
                                                            "label": "get_or_refill_credit",
                                                            "start_token": 1153,
                                                            "end_token": 1155,
                                                            "children": []
                                                        }
                                                    ]
                                                },
                                                {
                                                    "type": "argument_list",
                                                    "label": "(user_id)",
                                                    "start_token": 1155,
                                                    "end_token": -1,
                                                    "children": [
                                                        {
                                                            "type": "identifier",
                                                            "label": "user_id",
                                                            "start_token": 1155,
                                                            "end_token": -1,
                                                            "children": []
                                                        }
                                                    ]
                                                }
                                            ]
                                        }
                                    ]
                                }
                            ]
                        },
                        {
                            "type": "if_statement",
                            "label": "if credit < 0:\n        raise ValueError(f\"Insufficient credit: {credit}\")",
                            "start_token": 1159,
                            "end_token": -1,
                            "children": [
                                {
                                    "type": "comparison_operator",
                                    "label": "credit < 0",
                                    "start_token": 1159,
                                    "end_token": -1,
                                    "children": [
                                        {
                                            "type": "identifier",
                                            "label": "credit",
                                            "start_token": 1159,
                                            "end_token": 1161,
                                            "children": []
                                        },
                                        {
                                            "type": "integer",
                                            "label": "0",
                                            "start_token": -1,
                                            "end_token": -1,
                                            "children": []
                                        }
                                    ]
                                },
                                {
                                    "type": "block",
                                    "label": "raise ValueError(f\"Insufficient credit: {credit}\")",
                                    "start_token": 1164,
                                    "end_token": -1,
                                    "children": [
                                        {
                                            "type": "raise_statement",
                                            "label": "raise ValueError(f\"Insufficient credit: {credit}\")",
                                            "start_token": 1164,
                                            "end_token": -1,
                                            "children": [
                                                {
                                                    "type": "call",
                                                    "label": "ValueError(f\"Insufficient credit: {credit}\")",
                                                    "start_token": 1165,
                                                    "end_token": -1,
                                                    "children": [
                                                        {
                                                            "type": "identifier",
                                                            "label": "ValueError",
                                                            "start_token": 1165,
                                                            "end_token": 1168,
                                                            "children": []
                                                        },
                                                        {
                                                            "type": "argument_list",
                                                            "label": "(f\"Insufficient credit: {credit}\")",
                                                            "start_token": 1168,
                                                            "end_token": -1,
                                                            "children": [
                                                                {
                                                                    "type": "string",
                                                                    "label": "f\"Insufficient credit: {credit}\"",
                                                                    "start_token": 1168,
                                                                    "end_token": -1,
                                                                    "children": [
                                                                        {
                                                                            "type": "string_start",
                                                                            "label": "f\"",
                                                                            "start_token": 1168,
                                                                            "end_token": 1168,
                                                                            "children": []
                                                                        },
                                                                        {
                                                                            "type": "string_content",
                                                                            "label": "Insufficient credit: ",
                                                                            "start_token": 1168,
                                                                            "end_token": 1168,
                                                                            "children": []
                                                                        },
                                                                        {
                                                                            "type": "interpolation",
                                                                            "label": "{credit}",
                                                                            "start_token": 1168,
                                                                            "end_token": 1171,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "credit",
                                                                                    "start_token": 1168,
                                                                                    "end_token": 1170,
                                                                                    "children": []
                                                                                }
                                                                            ]
                                                                        },
                                                                        {
                                                                            "type": "string_end",
                                                                            "label": "\"",
                                                                            "start_token": -1,
                                                                            "end_token": -1,
                                                                            "children": []
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                }
                                            ]
                                        }
                                    ]
                                }
                            ]
                        },
                        {
                            "type": "try_statement",
                            "label": "try:\n        for output_name, output_data in node_block.execute(\n            input_data, **extra_exec_kwargs\n        ):\n            output_size += len(json.dumps(output_data))\n            log_metadata.info(\"Node produced output\", **{output_name: output_data})\n            db_client.upsert_execution_output(node_exec_id, output_name, output_data)\n\n            for execution in _enqueue_next_nodes(\n                db_client=db_client,\n                node=node,\n                output=(output_name, output_data),\n                user_id=user_id,\n                graph_exec_id=graph_exec_id,\n                graph_id=graph_id,\n                log_metadata=log_metadata,\n            ):\n                yield execution\n\n    except Exception as e:\n        end_status = ExecutionStatus.FAILED\n        error_msg = str(e)\n        log_metadata.exception(f\"Node execution failed with error {error_msg}\")\n        db_client.upsert_execution_output(node_exec_id, \"error\", error_msg)\n\n        for execution in _enqueue_next_nodes(\n            db_client=db_client,\n            node=node,\n            output=(\"error\", error_msg),\n            user_id=user_id,\n            graph_exec_id=graph_exec_id,\n            graph_id=graph_id,\n            log_metadata=log_metadata,\n        ):\n            yield execution\n\n        raise e\n    finally:\n        # Ensure credentials are released even if execution fails\n        if creds_lock:\n            try:\n                creds_lock.release()\n            except Exception as e:\n                log_metadata.error(f\"Failed to release credentials lock: {e}\")\n\n        # Update execution status and spend credits\n        res = update_execution(end_status)\n        if end_status == ExecutionStatus.COMPLETED:\n            s = input_size + output_size\n            t = (\n                (res.end_time - res.start_time).total_seconds()\n                if res.end_time and res.start_time\n                else 0\n            )\n            db_client.spend_credits(user_id, credit, node_block.id, input_data, s, t)\n\n        # Update execution stats\n        if execution_stats is not None:\n            execution_stats.update(node_block.execution_stats)\n            execution_stats[\"input_size\"] = input_size\n            execution_stats[\"output_size\"] = output_size",
                            "start_token": 1174,
                            "end_token": 1540,
                            "children": [
                                {
                                    "type": "block",
                                    "label": "for output_name, output_data in node_block.execute(\n            input_data, **extra_exec_kwargs\n        ):\n            output_size += len(json.dumps(output_data))\n            log_metadata.info(\"Node produced output\", **{output_name: output_data})\n            db_client.upsert_execution_output(node_exec_id, output_name, output_data)\n\n            for execution in _enqueue_next_nodes(\n                db_client=db_client,\n                node=node,\n                output=(output_name, output_data),\n                user_id=user_id,\n                graph_exec_id=graph_exec_id,\n                graph_id=graph_id,\n                log_metadata=log_metadata,\n            ):\n                yield execution",
                                    "start_token": 1176,
                                    "end_token": -1,
                                    "children": [
                                        {
                                            "type": "for_statement",
                                            "label": "for output_name, output_data in node_block.execute(\n            input_data, **extra_exec_kwargs\n        ):\n            output_size += len(json.dumps(output_data))\n            log_metadata.info(\"Node produced output\", **{output_name: output_data})\n            db_client.upsert_execution_output(node_exec_id, output_name, output_data)\n\n            for execution in _enqueue_next_nodes(\n                db_client=db_client,\n                node=node,\n                output=(output_name, output_data),\n                user_id=user_id,\n                graph_exec_id=graph_exec_id,\n                graph_id=graph_id,\n                log_metadata=log_metadata,\n            ):\n                yield execution",
                                            "start_token": 1176,
                                            "end_token": -1,
                                            "children": [
                                                {
                                                    "type": "pattern_list",
                                                    "label": "output_name, output_data",
                                                    "start_token": 1176,
                                                    "end_token": -1,
                                                    "children": [
                                                        {
                                                            "type": "identifier",
                                                            "label": "output_name",
                                                            "start_token": 1176,
                                                            "end_token": 1178,
                                                            "children": []
                                                        },
                                                        {
                                                            "type": "identifier",
                                                            "label": "output_data",
                                                            "start_token": 1178,
                                                            "end_token": -1,
                                                            "children": []
                                                        }
                                                    ]
                                                },
                                                {
                                                    "type": "call",
                                                    "label": "node_block.execute(\n            input_data, **extra_exec_kwargs\n        )",
                                                    "start_token": 1180,
                                                    "end_token": -1,
                                                    "children": [
                                                        {
                                                            "type": "attribute",
                                                            "label": "node_block.execute",
                                                            "start_token": 1180,
                                                            "end_token": -1,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "label": "node_block",
                                                                    "start_token": 1180,
                                                                    "end_token": 1182,
                                                                    "children": []
                                                                },
                                                                {
                                                                    "type": "identifier",
                                                                    "label": "execute",
                                                                    "start_token": 1182,
                                                                    "end_token": -1,
                                                                    "children": []
                                                                }
                                                            ]
                                                        },
                                                        {
                                                            "type": "argument_list",
                                                            "label": "(\n            input_data, **extra_exec_kwargs\n        )",
                                                            "start_token": -1,
                                                            "end_token": -1,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "label": "input_data",
                                                                    "start_token": 1185,
                                                                    "end_token": 1188,
                                                                    "children": []
                                                                },
                                                                {
                                                                    "type": "dictionary_splat",
                                                                    "label": "**extra_exec_kwargs",
                                                                    "start_token": 1189,
                                                                    "end_token": -1,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "extra_exec_kwargs",
                                                                            "start_token": 1189,
                                                                            "end_token": -1,
                                                                            "children": []
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                },
                                                {
                                                    "type": "block",
                                                    "label": "output_size += len(json.dumps(output_data))\n            log_metadata.info(\"Node produced output\", **{output_name: output_data})\n            db_client.upsert_execution_output(node_exec_id, output_name, output_data)\n\n            for execution in _enqueue_next_nodes(\n                db_client=db_client,\n                node=node,\n                output=(output_name, output_data),\n                user_id=user_id,\n                graph_exec_id=graph_exec_id,\n                graph_id=graph_id,\n                log_metadata=log_metadata,\n            ):\n                yield execution",
                                                    "start_token": 1194,
                                                    "end_token": -1,
                                                    "children": [
                                                        {
                                                            "type": "expression_statement",
                                                            "label": "output_size += len(json.dumps(output_data))",
                                                            "start_token": 1194,
                                                            "end_token": -1,
                                                            "children": [
                                                                {
                                                                    "type": "augmented_assignment",
                                                                    "label": "output_size += len(json.dumps(output_data))",
                                                                    "start_token": 1194,
                                                                    "end_token": -1,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "output_size",
                                                                            "start_token": 1194,
                                                                            "end_token": -1,
                                                                            "children": []
                                                                        },
                                                                        {
                                                                            "type": "call",
                                                                            "label": "len(json.dumps(output_data))",
                                                                            "start_token": 1199,
                                                                            "end_token": -1,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "len",
                                                                                    "start_token": 1199,
                                                                                    "end_token": 1199,
                                                                                    "children": []
                                                                                },
                                                                                {
                                                                                    "type": "argument_list",
                                                                                    "label": "(json.dumps(output_data))",
                                                                                    "start_token": 1199,
                                                                                    "end_token": -1,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "call",
                                                                                            "label": "json.dumps(output_data)",
                                                                                            "start_token": 1200,
                                                                                            "end_token": -1,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "attribute",
                                                                                                    "label": "json.dumps",
                                                                                                    "start_token": 1200,
                                                                                                    "end_token": 1203,
                                                                                                    "children": [
                                                                                                        {
                                                                                                            "type": "identifier",
                                                                                                            "label": "json",
                                                                                                            "start_token": 1200,
                                                                                                            "end_token": 1201,
                                                                                                            "children": []
                                                                                                        },
                                                                                                        {
                                                                                                            "type": "identifier",
                                                                                                            "label": "dumps",
                                                                                                            "start_token": 1201,
                                                                                                            "end_token": 1203,
                                                                                                            "children": []
                                                                                                        }
                                                                                                    ]
                                                                                                },
                                                                                                {
                                                                                                    "type": "argument_list",
                                                                                                    "label": "(output_data)",
                                                                                                    "start_token": 1203,
                                                                                                    "end_token": -1,
                                                                                                    "children": [
                                                                                                        {
                                                                                                            "type": "identifier",
                                                                                                            "label": "output_data",
                                                                                                            "start_token": 1203,
                                                                                                            "end_token": -1,
                                                                                                            "children": []
                                                                                                        }
                                                                                                    ]
                                                                                                }
                                                                                            ]
                                                                                        }
                                                                                    ]
                                                                                }
                                                                            ]
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        },
                                                        {
                                                            "type": "expression_statement",
                                                            "label": "log_metadata.info(\"Node produced output\", **{output_name: output_data})",
                                                            "start_token": 1207,
                                                            "end_token": -1,
                                                            "children": [
                                                                {
                                                                    "type": "call",
                                                                    "label": "log_metadata.info(\"Node produced output\", **{output_name: output_data})",
                                                                    "start_token": 1207,
                                                                    "end_token": -1,
                                                                    "children": [
                                                                        {
                                                                            "type": "attribute",
                                                                            "label": "log_metadata.info",
                                                                            "start_token": 1207,
                                                                            "end_token": 1211,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "log_metadata",
                                                                                    "start_token": 1207,
                                                                                    "end_token": 1209,
                                                                                    "children": []
                                                                                },
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "info",
                                                                                    "start_token": 1210,
                                                                                    "end_token": 1211,
                                                                                    "children": []
                                                                                }
                                                                            ]
                                                                        },
                                                                        {
                                                                            "type": "argument_list",
                                                                            "label": "(\"Node produced output\", **{output_name: output_data})",
                                                                            "start_token": 1211,
                                                                            "end_token": -1,
                                                                            "children": [
                                                                                {
                                                                                    "type": "string",
                                                                                    "label": "\"Node produced output\"",
                                                                                    "start_token": 1211,
                                                                                    "end_token": 1214,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "string_start",
                                                                                            "label": "\"",
                                                                                            "start_token": 1211,
                                                                                            "end_token": 1211,
                                                                                            "children": []
                                                                                        },
                                                                                        {
                                                                                            "type": "string_content",
                                                                                            "label": "Node produced output",
                                                                                            "start_token": 1211,
                                                                                            "end_token": 1213,
                                                                                            "children": []
                                                                                        },
                                                                                        {
                                                                                            "type": "string_end",
                                                                                            "label": "\"",
                                                                                            "start_token": 1214,
                                                                                            "end_token": 1214,
                                                                                            "children": []
                                                                                        }
                                                                                    ]
                                                                                },
                                                                                {
                                                                                    "type": "dictionary_splat",
                                                                                    "label": "**{output_name: output_data}",
                                                                                    "start_token": 1216,
                                                                                    "end_token": -1,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "dictionary",
                                                                                            "label": "{output_name: output_data}",
                                                                                            "start_token": 1216,
                                                                                            "end_token": -1,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "pair",
                                                                                                    "label": "output_name: output_data",
                                                                                                    "start_token": 1216,
                                                                                                    "end_token": -1,
                                                                                                    "children": [
                                                                                                        {
                                                                                                            "type": "identifier",
                                                                                                            "label": "output_name",
                                                                                                            "start_token": 1216,
                                                                                                            "end_token": 1218,
                                                                                                            "children": []
                                                                                                        },
                                                                                                        {
                                                                                                            "type": "identifier",
                                                                                                            "label": "output_data",
                                                                                                            "start_token": 1218,
                                                                                                            "end_token": -1,
                                                                                                            "children": []
                                                                                                        }
                                                                                                    ]
                                                                                                }
                                                                                            ]
                                                                                        }
                                                                                    ]
                                                                                }
                                                                            ]
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        },
                                                        {
                                                            "type": "expression_statement",
                                                            "label": "db_client.upsert_execution_output(node_exec_id, output_name, output_data)",
                                                            "start_token": 1222,
                                                            "end_token": -1,
                                                            "children": [
                                                                {
                                                                    "type": "call",
                                                                    "label": "db_client.upsert_execution_output(node_exec_id, output_name, output_data)",
                                                                    "start_token": 1222,
                                                                    "end_token": -1,
                                                                    "children": [
                                                                        {
                                                                            "type": "attribute",
                                                                            "label": "db_client.upsert_execution_output",
                                                                            "start_token": 1222,
                                                                            "end_token": 1226,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "db_client",
                                                                                    "start_token": 1222,
                                                                                    "end_token": 1224,
                                                                                    "children": []
                                                                                },
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "upsert_execution_output",
                                                                                    "start_token": 1224,
                                                                                    "end_token": 1226,
                                                                                    "children": []
                                                                                }
                                                                            ]
                                                                        },
                                                                        {
                                                                            "type": "argument_list",
                                                                            "label": "(node_exec_id, output_name, output_data)",
                                                                            "start_token": 1226,
                                                                            "end_token": -1,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "node_exec_id",
                                                                                    "start_token": 1226,
                                                                                    "end_token": 1228,
                                                                                    "children": []
                                                                                },
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "output_name",
                                                                                    "start_token": 1228,
                                                                                    "end_token": 1230,
                                                                                    "children": []
                                                                                },
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "output_data",
                                                                                    "start_token": 1230,
                                                                                    "end_token": -1,
                                                                                    "children": []
                                                                                }
                                                                            ]
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        },
                                                        {
                                                            "type": "for_statement",
                                                            "label": "for execution in _enqueue_next_nodes(\n                db_client=db_client,\n                node=node,\n                output=(output_name, output_data),\n                user_id=user_id,\n                graph_exec_id=graph_exec_id,\n                graph_id=graph_id,\n                log_metadata=log_metadata,\n            ):\n                yield execution",
                                                            "start_token": 1235,
                                                            "end_token": -1,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "label": "execution",
                                                                    "start_token": 1235,
                                                                    "end_token": -1,
                                                                    "children": []
                                                                },
                                                                {
                                                                    "type": "call",
                                                                    "label": "_enqueue_next_nodes(\n                db_client=db_client,\n                node=node,\n                output=(output_name, output_data),\n                user_id=user_id,\n                graph_exec_id=graph_exec_id,\n                graph_id=graph_id,\n                log_metadata=log_metadata,\n            )",
                                                                    "start_token": 1237,
                                                                    "end_token": -1,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "_enqueue_next_nodes",
                                                                            "start_token": 1237,
                                                                            "end_token": -1,
                                                                            "children": []
                                                                        },
                                                                        {
                                                                            "type": "argument_list",
                                                                            "label": "(\n                db_client=db_client,\n                node=node,\n                output=(output_name, output_data),\n                user_id=user_id,\n                graph_exec_id=graph_exec_id,\n                graph_id=graph_id,\n                log_metadata=log_metadata,\n            )",
                                                                            "start_token": -1,
                                                                            "end_token": -1,
                                                                            "children": [
                                                                                {
                                                                                    "type": "keyword_argument",
                                                                                    "label": "db_client=db_client",
                                                                                    "start_token": 1240,
                                                                                    "end_token": -1,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "label": "db_client",
                                                                                            "start_token": 1240,
                                                                                            "end_token": 1242,
                                                                                            "children": []
                                                                                        },
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "label": "db_client",
                                                                                            "start_token": 1242,
                                                                                            "end_token": -1,
                                                                                            "children": []
                                                                                        }
                                                                                    ]
                                                                                },
                                                                                {
                                                                                    "type": "keyword_argument",
                                                                                    "label": "node=node",
                                                                                    "start_token": 1246,
                                                                                    "end_token": -1,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "label": "node",
                                                                                            "start_token": 1246,
                                                                                            "end_token": 1247,
                                                                                            "children": []
                                                                                        },
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "label": "node",
                                                                                            "start_token": 1248,
                                                                                            "end_token": -1,
                                                                                            "children": []
                                                                                        }
                                                                                    ]
                                                                                },
                                                                                {
                                                                                    "type": "keyword_argument",
                                                                                    "label": "output=(output_name, output_data)",
                                                                                    "start_token": 1250,
                                                                                    "end_token": -1,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "label": "output",
                                                                                            "start_token": 1250,
                                                                                            "end_token": 1253,
                                                                                            "children": []
                                                                                        },
                                                                                        {
                                                                                            "type": "tuple",
                                                                                            "label": "(output_name, output_data)",
                                                                                            "start_token": 1253,
                                                                                            "end_token": -1,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "label": "output_name",
                                                                                                    "start_token": 1253,
                                                                                                    "end_token": 1255,
                                                                                                    "children": []
                                                                                                },
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "label": "output_data",
                                                                                                    "start_token": 1255,
                                                                                                    "end_token": -1,
                                                                                                    "children": []
                                                                                                }
                                                                                            ]
                                                                                        }
                                                                                    ]
                                                                                },
                                                                                {
                                                                                    "type": "keyword_argument",
                                                                                    "label": "user_id=user_id",
                                                                                    "start_token": 1259,
                                                                                    "end_token": -1,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "label": "user_id",
                                                                                            "start_token": 1259,
                                                                                            "end_token": 1261,
                                                                                            "children": []
                                                                                        },
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "label": "user_id",
                                                                                            "start_token": 1261,
                                                                                            "end_token": -1,
                                                                                            "children": []
                                                                                        }
                                                                                    ]
                                                                                },
                                                                                {
                                                                                    "type": "keyword_argument",
                                                                                    "label": "graph_exec_id=graph_exec_id",
                                                                                    "start_token": 1264,
                                                                                    "end_token": -1,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "label": "graph_exec_id",
                                                                                            "start_token": 1264,
                                                                                            "end_token": 1266,
                                                                                            "children": []
                                                                                        },
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "label": "graph_exec_id",
                                                                                            "start_token": 1266,
                                                                                            "end_token": -1,
                                                                                            "children": []
                                                                                        }
                                                                                    ]
                                                                                },
                                                                                {
                                                                                    "type": "keyword_argument",
                                                                                    "label": "graph_id=graph_id",
                                                                                    "start_token": 1269,
                                                                                    "end_token": -1,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "label": "graph_id",
                                                                                            "start_token": 1269,
                                                                                            "end_token": 1271,
                                                                                            "children": []
                                                                                        },
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "label": "graph_id",
                                                                                            "start_token": 1271,
                                                                                            "end_token": -1,
                                                                                            "children": []
                                                                                        }
                                                                                    ]
                                                                                },
                                                                                {
                                                                                    "type": "keyword_argument",
                                                                                    "label": "log_metadata=log_metadata",
                                                                                    "start_token": 1274,
                                                                                    "end_token": -1,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "label": "log_metadata",
                                                                                            "start_token": 1274,
                                                                                            "end_token": 1276,
                                                                                            "children": []
                                                                                        },
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "label": "log_metadata",
                                                                                            "start_token": 1276,
                                                                                            "end_token": -1,
                                                                                            "children": []
                                                                                        }
                                                                                    ]
                                                                                }
                                                                            ]
                                                                        }
                                                                    ]
                                                                },
                                                                {
                                                                    "type": "block",
                                                                    "label": "yield execution",
                                                                    "start_token": 1282,
                                                                    "end_token": -1,
                                                                    "children": [
                                                                        {
                                                                            "type": "expression_statement",
                                                                            "label": "yield execution",
                                                                            "start_token": 1282,
                                                                            "end_token": -1,
                                                                            "children": [
                                                                                {
                                                                                    "type": "yield",
                                                                                    "label": "yield execution",
                                                                                    "start_token": 1282,
                                                                                    "end_token": -1,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "label": "execution",
                                                                                            "start_token": 1283,
                                                                                            "end_token": -1,
                                                                                            "children": []
                                                                                        }
                                                                                    ]
                                                                                }
                                                                            ]
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                }
                                            ]
                                        }
                                    ]
                                },
                                {
                                    "type": "except_clause",
                                    "label": "except Exception as e:\n        end_status = ExecutionStatus.FAILED\n        error_msg = str(e)\n        log_metadata.exception(f\"Node execution failed with error {error_msg}\")\n        db_client.upsert_execution_output(node_exec_id, \"error\", error_msg)\n\n        for execution in _enqueue_next_nodes(\n            db_client=db_client,\n            node=node,\n            output=(\"error\", error_msg),\n            user_id=user_id,\n            graph_exec_id=graph_exec_id,\n            graph_id=graph_id,\n            log_metadata=log_metadata,\n        ):\n            yield execution\n\n        raise e",
                                    "start_token": 1286,
                                    "end_token": -1,
                                    "children": [
                                        {
                                            "type": "as_pattern",
                                            "label": "Exception as e",
                                            "start_token": 1287,
                                            "end_token": -1,
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "label": "Exception",
                                                    "start_token": 1287,
                                                    "end_token": -1,
                                                    "children": []
                                                },
                                                {
                                                    "type": "as_pattern_target",
                                                    "label": "e",
                                                    "start_token": -1,
                                                    "end_token": -1,
                                                    "children": [
                                                        {
                                                            "type": "identifier",
                                                            "label": "e",
                                                            "start_token": -1,
                                                            "end_token": -1,
                                                            "children": []
                                                        }
                                                    ]
                                                }
                                            ]
                                        },
                                        {
                                            "type": "block",
                                            "label": "end_status = ExecutionStatus.FAILED\n        error_msg = str(e)\n        log_metadata.exception(f\"Node execution failed with error {error_msg}\")\n        db_client.upsert_execution_output(node_exec_id, \"error\", error_msg)\n\n        for execution in _enqueue_next_nodes(\n            db_client=db_client,\n            node=node,\n            output=(\"error\", error_msg),\n            user_id=user_id,\n            graph_exec_id=graph_exec_id,\n            graph_id=graph_id,\n            log_metadata=log_metadata,\n        ):\n            yield execution\n\n        raise e",
                                            "start_token": 1292,
                                            "end_token": -1,
                                            "children": [
                                                {
                                                    "type": "expression_statement",
                                                    "label": "end_status = ExecutionStatus.FAILED",
                                                    "start_token": 1292,
                                                    "end_token": -1,
                                                    "children": [
                                                        {
                                                            "type": "assignment",
                                                            "label": "end_status = ExecutionStatus.FAILED",
                                                            "start_token": 1292,
                                                            "end_token": -1,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "label": "end_status",
                                                                    "start_token": 1292,
                                                                    "end_token": 1294,
                                                                    "children": []
                                                                },
                                                                {
                                                                    "type": "attribute",
                                                                    "label": "ExecutionStatus.FAILED",
                                                                    "start_token": 1294,
                                                                    "end_token": -1,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "ExecutionStatus",
                                                                            "start_token": 1294,
                                                                            "end_token": 1296,
                                                                            "children": []
                                                                        },
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "FAILED",
                                                                            "start_token": 1296,
                                                                            "end_token": -1,
                                                                            "children": []
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                },
                                                {
                                                    "type": "expression_statement",
                                                    "label": "error_msg = str(e)",
                                                    "start_token": 1298,
                                                    "end_token": -1,
                                                    "children": [
                                                        {
                                                            "type": "assignment",
                                                            "label": "error_msg = str(e)",
                                                            "start_token": 1298,
                                                            "end_token": -1,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "label": "error_msg",
                                                                    "start_token": 1298,
                                                                    "end_token": 1300,
                                                                    "children": []
                                                                },
                                                                {
                                                                    "type": "call",
                                                                    "label": "str(e)",
                                                                    "start_token": 1302,
                                                                    "end_token": -1,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "str",
                                                                            "start_token": 1302,
                                                                            "end_token": 1304,
                                                                            "children": []
                                                                        },
                                                                        {
                                                                            "type": "argument_list",
                                                                            "label": "(e)",
                                                                            "start_token": -1,
                                                                            "end_token": -1,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "e",
                                                                                    "start_token": -1,
                                                                                    "end_token": -1,
                                                                                    "children": []
                                                                                }
                                                                            ]
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                },
                                                {
                                                    "type": "expression_statement",
                                                    "label": "log_metadata.exception(f\"Node execution failed with error {error_msg}\")",
                                                    "start_token": 1305,
                                                    "end_token": -1,
                                                    "children": [
                                                        {
                                                            "type": "call",
                                                            "label": "log_metadata.exception(f\"Node execution failed with error {error_msg}\")",
                                                            "start_token": 1305,
                                                            "end_token": -1,
                                                            "children": [
                                                                {
                                                                    "type": "attribute",
                                                                    "label": "log_metadata.exception",
                                                                    "start_token": 1305,
                                                                    "end_token": 1310,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "log_metadata",
                                                                            "start_token": 1305,
                                                                            "end_token": 1307,
                                                                            "children": []
                                                                        },
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "exception",
                                                                            "start_token": 1307,
                                                                            "end_token": 1310,
                                                                            "children": []
                                                                        }
                                                                    ]
                                                                },
                                                                {
                                                                    "type": "argument_list",
                                                                    "label": "(f\"Node execution failed with error {error_msg}\")",
                                                                    "start_token": 1310,
                                                                    "end_token": -1,
                                                                    "children": [
                                                                        {
                                                                            "type": "string",
                                                                            "label": "f\"Node execution failed with error {error_msg}\"",
                                                                            "start_token": 1310,
                                                                            "end_token": -1,
                                                                            "children": [
                                                                                {
                                                                                    "type": "string_start",
                                                                                    "label": "f\"",
                                                                                    "start_token": 1310,
                                                                                    "end_token": 1310,
                                                                                    "children": []
                                                                                },
                                                                                {
                                                                                    "type": "string_content",
                                                                                    "label": "Node execution failed with error ",
                                                                                    "start_token": 1310,
                                                                                    "end_token": 1310,
                                                                                    "children": []
                                                                                },
                                                                                {
                                                                                    "type": "interpolation",
                                                                                    "label": "{error_msg}",
                                                                                    "start_token": 1310,
                                                                                    "end_token": -1,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "label": "error_msg",
                                                                                            "start_token": 1310,
                                                                                            "end_token": 1312,
                                                                                            "children": []
                                                                                        }
                                                                                    ]
                                                                                },
                                                                                {
                                                                                    "type": "string_end",
                                                                                    "label": "\"",
                                                                                    "start_token": -1,
                                                                                    "end_token": -1,
                                                                                    "children": []
                                                                                }
                                                                            ]
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                },
                                                {
                                                    "type": "expression_statement",
                                                    "label": "db_client.upsert_execution_output(node_exec_id, \"error\", error_msg)",
                                                    "start_token": 1313,
                                                    "end_token": -1,
                                                    "children": [
                                                        {
                                                            "type": "call",
                                                            "label": "db_client.upsert_execution_output(node_exec_id, \"error\", error_msg)",
                                                            "start_token": 1313,
                                                            "end_token": -1,
                                                            "children": [
                                                                {
                                                                    "type": "attribute",
                                                                    "label": "db_client.upsert_execution_output",
                                                                    "start_token": 1313,
                                                                    "end_token": 1317,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "db_client",
                                                                            "start_token": 1313,
                                                                            "end_token": 1315,
                                                                            "children": []
                                                                        },
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "upsert_execution_output",
                                                                            "start_token": 1315,
                                                                            "end_token": 1317,
                                                                            "children": []
                                                                        }
                                                                    ]
                                                                },
                                                                {
                                                                    "type": "argument_list",
                                                                    "label": "(node_exec_id, \"error\", error_msg)",
                                                                    "start_token": 1317,
                                                                    "end_token": -1,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "node_exec_id",
                                                                            "start_token": 1317,
                                                                            "end_token": 1319,
                                                                            "children": []
                                                                        },
                                                                        {
                                                                            "type": "string",
                                                                            "label": "\"error\"",
                                                                            "start_token": 1319,
                                                                            "end_token": 1321,
                                                                            "children": [
                                                                                {
                                                                                    "type": "string_start",
                                                                                    "label": "\"",
                                                                                    "start_token": 1319,
                                                                                    "end_token": 1319,
                                                                                    "children": []
                                                                                },
                                                                                {
                                                                                    "type": "string_content",
                                                                                    "label": "error",
                                                                                    "start_token": 1319,
                                                                                    "end_token": 1321,
                                                                                    "children": []
                                                                                },
                                                                                {
                                                                                    "type": "string_end",
                                                                                    "label": "\"",
                                                                                    "start_token": 1321,
                                                                                    "end_token": 1321,
                                                                                    "children": []
                                                                                }
                                                                            ]
                                                                        },
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "error_msg",
                                                                            "start_token": 1321,
                                                                            "end_token": -1,
                                                                            "children": []
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                },
                                                {
                                                    "type": "for_statement",
                                                    "label": "for execution in _enqueue_next_nodes(\n            db_client=db_client,\n            node=node,\n            output=(\"error\", error_msg),\n            user_id=user_id,\n            graph_exec_id=graph_exec_id,\n            graph_id=graph_id,\n            log_metadata=log_metadata,\n        ):\n            yield execution",
                                                    "start_token": 1326,
                                                    "end_token": -1,
                                                    "children": [
                                                        {
                                                            "type": "identifier",
                                                            "label": "execution",
                                                            "start_token": 1326,
                                                            "end_token": -1,
                                                            "children": []
                                                        },
                                                        {
                                                            "type": "call",
                                                            "label": "_enqueue_next_nodes(\n            db_client=db_client,\n            node=node,\n            output=(\"error\", error_msg),\n            user_id=user_id,\n            graph_exec_id=graph_exec_id,\n            graph_id=graph_id,\n            log_metadata=log_metadata,\n        )",
                                                            "start_token": 1328,
                                                            "end_token": -1,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "label": "_enqueue_next_nodes",
                                                                    "start_token": 1328,
                                                                    "end_token": -1,
                                                                    "children": []
                                                                },
                                                                {
                                                                    "type": "argument_list",
                                                                    "label": "(\n            db_client=db_client,\n            node=node,\n            output=(\"error\", error_msg),\n            user_id=user_id,\n            graph_exec_id=graph_exec_id,\n            graph_id=graph_id,\n            log_metadata=log_metadata,\n        )",
                                                                    "start_token": -1,
                                                                    "end_token": -1,
                                                                    "children": [
                                                                        {
                                                                            "type": "keyword_argument",
                                                                            "label": "db_client=db_client",
                                                                            "start_token": 1331,
                                                                            "end_token": -1,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "db_client",
                                                                                    "start_token": 1331,
                                                                                    "end_token": 1333,
                                                                                    "children": []
                                                                                },
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "db_client",
                                                                                    "start_token": 1333,
                                                                                    "end_token": -1,
                                                                                    "children": []
                                                                                }
                                                                            ]
                                                                        },
                                                                        {
                                                                            "type": "keyword_argument",
                                                                            "label": "node=node",
                                                                            "start_token": 1337,
                                                                            "end_token": -1,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "node",
                                                                                    "start_token": 1337,
                                                                                    "end_token": 1338,
                                                                                    "children": []
                                                                                },
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "node",
                                                                                    "start_token": 1339,
                                                                                    "end_token": -1,
                                                                                    "children": []
                                                                                }
                                                                            ]
                                                                        },
                                                                        {
                                                                            "type": "keyword_argument",
                                                                            "label": "output=(\"error\", error_msg)",
                                                                            "start_token": 1341,
                                                                            "end_token": -1,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "output",
                                                                                    "start_token": 1341,
                                                                                    "end_token": 1344,
                                                                                    "children": []
                                                                                },
                                                                                {
                                                                                    "type": "tuple",
                                                                                    "label": "(\"error\", error_msg)",
                                                                                    "start_token": 1344,
                                                                                    "end_token": -1,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "string",
                                                                                            "label": "\"error\"",
                                                                                            "start_token": 1344,
                                                                                            "end_token": 1346,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "string_start",
                                                                                                    "label": "\"",
                                                                                                    "start_token": 1344,
                                                                                                    "end_token": 1344,
                                                                                                    "children": []
                                                                                                },
                                                                                                {
                                                                                                    "type": "string_content",
                                                                                                    "label": "error",
                                                                                                    "start_token": 1344,
                                                                                                    "end_token": 1346,
                                                                                                    "children": []
                                                                                                },
                                                                                                {
                                                                                                    "type": "string_end",
                                                                                                    "label": "\"",
                                                                                                    "start_token": 1346,
                                                                                                    "end_token": 1346,
                                                                                                    "children": []
                                                                                                }
                                                                                            ]
                                                                                        },
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "label": "error_msg",
                                                                                            "start_token": 1346,
                                                                                            "end_token": -1,
                                                                                            "children": []
                                                                                        }
                                                                                    ]
                                                                                }
                                                                            ]
                                                                        },
                                                                        {
                                                                            "type": "keyword_argument",
                                                                            "label": "user_id=user_id",
                                                                            "start_token": 1350,
                                                                            "end_token": -1,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "user_id",
                                                                                    "start_token": 1350,
                                                                                    "end_token": 1352,
                                                                                    "children": []
                                                                                },
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "user_id",
                                                                                    "start_token": 1352,
                                                                                    "end_token": -1,
                                                                                    "children": []
                                                                                }
                                                                            ]
                                                                        },
                                                                        {
                                                                            "type": "keyword_argument",
                                                                            "label": "graph_exec_id=graph_exec_id",
                                                                            "start_token": 1355,
                                                                            "end_token": -1,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "graph_exec_id",
                                                                                    "start_token": 1355,
                                                                                    "end_token": 1357,
                                                                                    "children": []
                                                                                },
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "graph_exec_id",
                                                                                    "start_token": 1357,
                                                                                    "end_token": -1,
                                                                                    "children": []
                                                                                }
                                                                            ]
                                                                        },
                                                                        {
                                                                            "type": "keyword_argument",
                                                                            "label": "graph_id=graph_id",
                                                                            "start_token": 1360,
                                                                            "end_token": -1,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "graph_id",
                                                                                    "start_token": 1360,
                                                                                    "end_token": 1362,
                                                                                    "children": []
                                                                                },
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "graph_id",
                                                                                    "start_token": 1362,
                                                                                    "end_token": -1,
                                                                                    "children": []
                                                                                }
                                                                            ]
                                                                        },
                                                                        {
                                                                            "type": "keyword_argument",
                                                                            "label": "log_metadata=log_metadata",
                                                                            "start_token": 1365,
                                                                            "end_token": -1,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "log_metadata",
                                                                                    "start_token": 1365,
                                                                                    "end_token": 1367,
                                                                                    "children": []
                                                                                },
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "log_metadata",
                                                                                    "start_token": 1367,
                                                                                    "end_token": -1,
                                                                                    "children": []
                                                                                }
                                                                            ]
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        },
                                                        {
                                                            "type": "block",
                                                            "label": "yield execution",
                                                            "start_token": 1373,
                                                            "end_token": -1,
                                                            "children": [
                                                                {
                                                                    "type": "expression_statement",
                                                                    "label": "yield execution",
                                                                    "start_token": 1373,
                                                                    "end_token": -1,
                                                                    "children": [
                                                                        {
                                                                            "type": "yield",
                                                                            "label": "yield execution",
                                                                            "start_token": 1373,
                                                                            "end_token": -1,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "execution",
                                                                                    "start_token": 1374,
                                                                                    "end_token": -1,
                                                                                    "children": []
                                                                                }
                                                                            ]
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                },
                                                {
                                                    "type": "raise_statement",
                                                    "label": "raise e",
                                                    "start_token": 1377,
                                                    "end_token": -1,
                                                    "children": [
                                                        {
                                                            "type": "identifier",
                                                            "label": "e",
                                                            "start_token": -1,
                                                            "end_token": -1,
                                                            "children": []
                                                        }
                                                    ]
                                                }
                                            ]
                                        }
                                    ]
                                },
                                {
                                    "type": "finally_clause",
                                    "label": "finally:\n        # Ensure credentials are released even if execution fails\n        if creds_lock:\n            try:\n                creds_lock.release()\n            except Exception as e:\n                log_metadata.error(f\"Failed to release credentials lock: {e}\")\n\n        # Update execution status and spend credits\n        res = update_execution(end_status)\n        if end_status == ExecutionStatus.COMPLETED:\n            s = input_size + output_size\n            t = (\n                (res.end_time - res.start_time).total_seconds()\n                if res.end_time and res.start_time\n                else 0\n            )\n            db_client.spend_credits(user_id, credit, node_block.id, input_data, s, t)\n\n        # Update execution stats\n        if execution_stats is not None:\n            execution_stats.update(node_block.execution_stats)\n            execution_stats[\"input_size\"] = input_size\n            execution_stats[\"output_size\"] = output_size",
                                    "start_token": 1380,
                                    "end_token": 1540,
                                    "children": [
                                        {
                                            "type": "comment",
                                            "label": "# Ensure credentials are released even if execution fails",
                                            "start_token": 1384,
                                            "end_token": -1,
                                            "children": []
                                        },
                                        {
                                            "type": "block",
                                            "label": "if creds_lock:\n            try:\n                creds_lock.release()\n            except Exception as e:\n                log_metadata.error(f\"Failed to release credentials lock: {e}\")\n\n        # Update execution status and spend credits\n        res = update_execution(end_status)\n        if end_status == ExecutionStatus.COMPLETED:\n            s = input_size + output_size\n            t = (\n                (res.end_time - res.start_time).total_seconds()\n                if res.end_time and res.start_time\n                else 0\n            )\n            db_client.spend_credits(user_id, credit, node_block.id, input_data, s, t)\n\n        # Update execution stats\n        if execution_stats is not None:\n            execution_stats.update(node_block.execution_stats)\n            execution_stats[\"input_size\"] = input_size\n            execution_stats[\"output_size\"] = output_size",
                                            "start_token": 1394,
                                            "end_token": 1540,
                                            "children": [
                                                {
                                                    "type": "if_statement",
                                                    "label": "if creds_lock:\n            try:\n                creds_lock.release()\n            except Exception as e:\n                log_metadata.error(f\"Failed to release credentials lock: {e}\")",
                                                    "start_token": 1394,
                                                    "end_token": -1,
                                                    "children": [
                                                        {
                                                            "type": "identifier",
                                                            "label": "creds_lock",
                                                            "start_token": 1394,
                                                            "end_token": -1,
                                                            "children": []
                                                        },
                                                        {
                                                            "type": "block",
                                                            "label": "try:\n                creds_lock.release()\n            except Exception as e:\n                log_metadata.error(f\"Failed to release credentials lock: {e}\")",
                                                            "start_token": 1399,
                                                            "end_token": -1,
                                                            "children": [
                                                                {
                                                                    "type": "try_statement",
                                                                    "label": "try:\n                creds_lock.release()\n            except Exception as e:\n                log_metadata.error(f\"Failed to release credentials lock: {e}\")",
                                                                    "start_token": 1399,
                                                                    "end_token": -1,
                                                                    "children": [
                                                                        {
                                                                            "type": "block",
                                                                            "label": "creds_lock.release()",
                                                                            "start_token": 1400,
                                                                            "end_token": -1,
                                                                            "children": [
                                                                                {
                                                                                    "type": "expression_statement",
                                                                                    "label": "creds_lock.release()",
                                                                                    "start_token": 1400,
                                                                                    "end_token": -1,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "call",
                                                                                            "label": "creds_lock.release()",
                                                                                            "start_token": 1400,
                                                                                            "end_token": -1,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "attribute",
                                                                                                    "label": "creds_lock.release",
                                                                                                    "start_token": 1400,
                                                                                                    "end_token": -1,
                                                                                                    "children": [
                                                                                                        {
                                                                                                            "type": "identifier",
                                                                                                            "label": "creds_lock",
                                                                                                            "start_token": 1400,
                                                                                                            "end_token": 1402,
                                                                                                            "children": []
                                                                                                        },
                                                                                                        {
                                                                                                            "type": "identifier",
                                                                                                            "label": "release",
                                                                                                            "start_token": 1402,
                                                                                                            "end_token": -1,
                                                                                                            "children": []
                                                                                                        }
                                                                                                    ]
                                                                                                },
                                                                                                {
                                                                                                    "type": "argument_list",
                                                                                                    "label": "()",
                                                                                                    "start_token": -1,
                                                                                                    "end_token": -1,
                                                                                                    "children": []
                                                                                                }
                                                                                            ]
                                                                                        }
                                                                                    ]
                                                                                }
                                                                            ]
                                                                        },
                                                                        {
                                                                            "type": "except_clause",
                                                                            "label": "except Exception as e:\n                log_metadata.error(f\"Failed to release credentials lock: {e}\")",
                                                                            "start_token": 1406,
                                                                            "end_token": -1,
                                                                            "children": [
                                                                                {
                                                                                    "type": "as_pattern",
                                                                                    "label": "Exception as e",
                                                                                    "start_token": 1407,
                                                                                    "end_token": -1,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "label": "Exception",
                                                                                            "start_token": 1407,
                                                                                            "end_token": -1,
                                                                                            "children": []
                                                                                        },
                                                                                        {
                                                                                            "type": "as_pattern_target",
                                                                                            "label": "e",
                                                                                            "start_token": -1,
                                                                                            "end_token": -1,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "label": "e",
                                                                                                    "start_token": -1,
                                                                                                    "end_token": -1,
                                                                                                    "children": []
                                                                                                }
                                                                                            ]
                                                                                        }
                                                                                    ]
                                                                                },
                                                                                {
                                                                                    "type": "block",
                                                                                    "label": "log_metadata.error(f\"Failed to release credentials lock: {e}\")",
                                                                                    "start_token": 1412,
                                                                                    "end_token": -1,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "expression_statement",
                                                                                            "label": "log_metadata.error(f\"Failed to release credentials lock: {e}\")",
                                                                                            "start_token": 1412,
                                                                                            "end_token": -1,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "call",
                                                                                                    "label": "log_metadata.error(f\"Failed to release credentials lock: {e}\")",
                                                                                                    "start_token": 1412,
                                                                                                    "end_token": -1,
                                                                                                    "children": [
                                                                                                        {
                                                                                                            "type": "attribute",
                                                                                                            "label": "log_metadata.error",
                                                                                                            "start_token": 1412,
                                                                                                            "end_token": 1417,
                                                                                                            "children": [
                                                                                                                {
                                                                                                                    "type": "identifier",
                                                                                                                    "label": "log_metadata",
                                                                                                                    "start_token": 1412,
                                                                                                                    "end_token": 1414,
                                                                                                                    "children": []
                                                                                                                },
                                                                                                                {
                                                                                                                    "type": "identifier",
                                                                                                                    "label": "error",
                                                                                                                    "start_token": 1414,
                                                                                                                    "end_token": 1417,
                                                                                                                    "children": []
                                                                                                                }
                                                                                                            ]
                                                                                                        },
                                                                                                        {
                                                                                                            "type": "argument_list",
                                                                                                            "label": "(f\"Failed to release credentials lock: {e}\")",
                                                                                                            "start_token": 1417,
                                                                                                            "end_token": -1,
                                                                                                            "children": [
                                                                                                                {
                                                                                                                    "type": "string",
                                                                                                                    "label": "f\"Failed to release credentials lock: {e}\"",
                                                                                                                    "start_token": 1417,
                                                                                                                    "end_token": -1,
                                                                                                                    "children": [
                                                                                                                        {
                                                                                                                            "type": "string_start",
                                                                                                                            "label": "f\"",
                                                                                                                            "start_token": 1417,
                                                                                                                            "end_token": 1417,
                                                                                                                            "children": []
                                                                                                                        },
                                                                                                                        {
                                                                                                                            "type": "string_content",
                                                                                                                            "label": "Failed to release credentials lock: ",
                                                                                                                            "start_token": 1417,
                                                                                                                            "end_token": 1417,
                                                                                                                            "children": []
                                                                                                                        },
                                                                                                                        {
                                                                                                                            "type": "interpolation",
                                                                                                                            "label": "{e}",
                                                                                                                            "start_token": 1418,
                                                                                                                            "end_token": 1420,
                                                                                                                            "children": [
                                                                                                                                {
                                                                                                                                    "type": "identifier",
                                                                                                                                    "label": "e",
                                                                                                                                    "start_token": 1419,
                                                                                                                                    "end_token": 1419,
                                                                                                                                    "children": []
                                                                                                                                }
                                                                                                                            ]
                                                                                                                        },
                                                                                                                        {
                                                                                                                            "type": "string_end",
                                                                                                                            "label": "\"",
                                                                                                                            "start_token": -1,
                                                                                                                            "end_token": -1,
                                                                                                                            "children": []
                                                                                                                        }
                                                                                                                    ]
                                                                                                                }
                                                                                                            ]
                                                                                                        }
                                                                                                    ]
                                                                                                }
                                                                                            ]
                                                                                        }
                                                                                    ]
                                                                                }
                                                                            ]
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                },
                                                {
                                                    "type": "comment",
                                                    "label": "# Update execution status and spend credits",
                                                    "start_token": 1422,
                                                    "end_token": -1,
                                                    "children": []
                                                },
                                                {
                                                    "type": "expression_statement",
                                                    "label": "res = update_execution(end_status)",
                                                    "start_token": 1430,
                                                    "end_token": -1,
                                                    "children": [
                                                        {
                                                            "type": "assignment",
                                                            "label": "res = update_execution(end_status)",
                                                            "start_token": 1430,
                                                            "end_token": -1,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "label": "res",
                                                                    "start_token": 1430,
                                                                    "end_token": 1431,
                                                                    "children": []
                                                                },
                                                                {
                                                                    "type": "call",
                                                                    "label": "update_execution(end_status)",
                                                                    "start_token": 1431,
                                                                    "end_token": -1,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "update_execution",
                                                                            "start_token": 1431,
                                                                            "end_token": 1433,
                                                                            "children": []
                                                                        },
                                                                        {
                                                                            "type": "argument_list",
                                                                            "label": "(end_status)",
                                                                            "start_token": 1433,
                                                                            "end_token": -1,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "end_status",
                                                                                    "start_token": 1433,
                                                                                    "end_token": -1,
                                                                                    "children": []
                                                                                }
                                                                            ]
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                },
                                                {
                                                    "type": "if_statement",
                                                    "label": "if end_status == ExecutionStatus.COMPLETED:\n            s = input_size + output_size\n            t = (\n                (res.end_time - res.start_time).total_seconds()\n                if res.end_time and res.start_time\n                else 0\n            )\n            db_client.spend_credits(user_id, credit, node_block.id, input_data, s, t)",
                                                    "start_token": 1437,
                                                    "end_token": -1,
                                                    "children": [
                                                        {
                                                            "type": "comparison_operator",
                                                            "label": "end_status == ExecutionStatus.COMPLETED",
                                                            "start_token": 1437,
                                                            "end_token": -1,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "label": "end_status",
                                                                    "start_token": 1437,
                                                                    "end_token": -1,
                                                                    "children": []
                                                                },
                                                                {
                                                                    "type": "attribute",
                                                                    "label": "ExecutionStatus.COMPLETED",
                                                                    "start_token": 1440,
                                                                    "end_token": -1,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "ExecutionStatus",
                                                                            "start_token": 1440,
                                                                            "end_token": 1442,
                                                                            "children": []
                                                                        },
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "COMPLETED",
                                                                            "start_token": 1442,
                                                                            "end_token": -1,
                                                                            "children": []
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        },
                                                        {
                                                            "type": "block",
                                                            "label": "s = input_size + output_size\n            t = (\n                (res.end_time - res.start_time).total_seconds()\n                if res.end_time and res.start_time\n                else 0\n            )\n            db_client.spend_credits(user_id, credit, node_block.id, input_data, s, t)",
                                                            "start_token": 1447,
                                                            "end_token": -1,
                                                            "children": [
                                                                {
                                                                    "type": "expression_statement",
                                                                    "label": "s = input_size + output_size",
                                                                    "start_token": 1447,
                                                                    "end_token": -1,
                                                                    "children": [
                                                                        {
                                                                            "type": "assignment",
                                                                            "label": "s = input_size + output_size",
                                                                            "start_token": 1447,
                                                                            "end_token": -1,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "s",
                                                                                    "start_token": 1447,
                                                                                    "end_token": 1447,
                                                                                    "children": []
                                                                                },
                                                                                {
                                                                                    "type": "binary_operator",
                                                                                    "label": "input_size + output_size",
                                                                                    "start_token": 1447,
                                                                                    "end_token": -1,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "label": "input_size",
                                                                                            "start_token": 1447,
                                                                                            "end_token": 1449,
                                                                                            "children": []
                                                                                        },
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "label": "output_size",
                                                                                            "start_token": 1449,
                                                                                            "end_token": -1,
                                                                                            "children": []
                                                                                        }
                                                                                    ]
                                                                                }
                                                                            ]
                                                                        }
                                                                    ]
                                                                },
                                                                {
                                                                    "type": "expression_statement",
                                                                    "label": "t = (\n                (res.end_time - res.start_time).total_seconds()\n                if res.end_time and res.start_time\n                else 0\n            )",
                                                                    "start_token": 1453,
                                                                    "end_token": -1,
                                                                    "children": [
                                                                        {
                                                                            "type": "assignment",
                                                                            "label": "t = (\n                (res.end_time - res.start_time).total_seconds()\n                if res.end_time and res.start_time\n                else 0\n            )",
                                                                            "start_token": 1453,
                                                                            "end_token": -1,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "t",
                                                                                    "start_token": 1453,
                                                                                    "end_token": 1453,
                                                                                    "children": []
                                                                                },
                                                                                {
                                                                                    "type": "parenthesized_expression",
                                                                                    "label": "(\n                (res.end_time - res.start_time).total_seconds()\n                if res.end_time and res.start_time\n                else 0\n            )",
                                                                                    "start_token": -1,
                                                                                    "end_token": -1,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "conditional_expression",
                                                                                            "label": "(res.end_time - res.start_time).total_seconds()\n                if res.end_time and res.start_time\n                else 0",
                                                                                            "start_token": 1457,
                                                                                            "end_token": -1,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "call",
                                                                                                    "label": "(res.end_time - res.start_time).total_seconds()",
                                                                                                    "start_token": 1457,
                                                                                                    "end_token": -1,
                                                                                                    "children": [
                                                                                                        {
                                                                                                            "type": "attribute",
                                                                                                            "label": "(res.end_time - res.start_time).total_seconds",
                                                                                                            "start_token": 1457,
                                                                                                            "end_token": -1,
                                                                                                            "children": [
                                                                                                                {
                                                                                                                    "type": "parenthesized_expression",
                                                                                                                    "label": "(res.end_time - res.start_time)",
                                                                                                                    "start_token": 1457,
                                                                                                                    "end_token": 1465,
                                                                                                                    "children": [
                                                                                                                        {
                                                                                                                            "type": "binary_operator",
                                                                                                                            "label": "res.end_time - res.start_time",
                                                                                                                            "start_token": 1458,
                                                                                                                            "end_token": 1465,
                                                                                                                            "children": [
                                                                                                                                {
                                                                                                                                    "type": "attribute",
                                                                                                                                    "label": "res.end_time",
                                                                                                                                    "start_token": 1458,
                                                                                                                                    "end_token": 1460,
                                                                                                                                    "children": [
                                                                                                                                        {
                                                                                                                                            "type": "identifier",
                                                                                                                                            "label": "res",
                                                                                                                                            "start_token": 1458,
                                                                                                                                            "end_token": 1458,
                                                                                                                                            "children": []
                                                                                                                                        },
                                                                                                                                        {
                                                                                                                                            "type": "identifier",
                                                                                                                                            "label": "end_time",
                                                                                                                                            "start_token": 1458,
                                                                                                                                            "end_token": 1460,
                                                                                                                                            "children": []
                                                                                                                                        }
                                                                                                                                    ]
                                                                                                                                },
                                                                                                                                {
                                                                                                                                    "type": "attribute",
                                                                                                                                    "label": "res.start_time",
                                                                                                                                    "start_token": 1462,
                                                                                                                                    "end_token": 1465,
                                                                                                                                    "children": [
                                                                                                                                        {
                                                                                                                                            "type": "identifier",
                                                                                                                                            "label": "res",
                                                                                                                                            "start_token": 1462,
                                                                                                                                            "end_token": 1462,
                                                                                                                                            "children": []
                                                                                                                                        },
                                                                                                                                        {
                                                                                                                                            "type": "identifier",
                                                                                                                                            "label": "start_time",
                                                                                                                                            "start_token": 1462,
                                                                                                                                            "end_token": 1465,
                                                                                                                                            "children": []
                                                                                                                                        }
                                                                                                                                    ]
                                                                                                                                }
                                                                                                                            ]
                                                                                                                        }
                                                                                                                    ]
                                                                                                                },
                                                                                                                {
                                                                                                                    "type": "identifier",
                                                                                                                    "label": "total_seconds",
                                                                                                                    "start_token": 1465,
                                                                                                                    "end_token": -1,
                                                                                                                    "children": []
                                                                                                                }
                                                                                                            ]
                                                                                                        },
                                                                                                        {
                                                                                                            "type": "argument_list",
                                                                                                            "label": "()",
                                                                                                            "start_token": -1,
                                                                                                            "end_token": -1,
                                                                                                            "children": []
                                                                                                        }
                                                                                                    ]
                                                                                                },
                                                                                                {
                                                                                                    "type": "boolean_operator",
                                                                                                    "label": "res.end_time and res.start_time",
                                                                                                    "start_token": 1472,
                                                                                                    "end_token": -1,
                                                                                                    "children": [
                                                                                                        {
                                                                                                            "type": "attribute",
                                                                                                            "label": "res.end_time",
                                                                                                            "start_token": 1472,
                                                                                                            "end_token": 1473,
                                                                                                            "children": [
                                                                                                                {
                                                                                                                    "type": "identifier",
                                                                                                                    "label": "res",
                                                                                                                    "start_token": 1472,
                                                                                                                    "end_token": 1472,
                                                                                                                    "children": []
                                                                                                                },
                                                                                                                {
                                                                                                                    "type": "identifier",
                                                                                                                    "label": "end_time",
                                                                                                                    "start_token": 1472,
                                                                                                                    "end_token": 1473,
                                                                                                                    "children": []
                                                                                                                }
                                                                                                            ]
                                                                                                        },
                                                                                                        {
                                                                                                            "type": "attribute",
                                                                                                            "label": "res.start_time",
                                                                                                            "start_token": 1476,
                                                                                                            "end_token": -1,
                                                                                                            "children": [
                                                                                                                {
                                                                                                                    "type": "identifier",
                                                                                                                    "label": "res",
                                                                                                                    "start_token": 1476,
                                                                                                                    "end_token": 1476,
                                                                                                                    "children": []
                                                                                                                },
                                                                                                                {
                                                                                                                    "type": "identifier",
                                                                                                                    "label": "start_time",
                                                                                                                    "start_token": 1476,
                                                                                                                    "end_token": -1,
                                                                                                                    "children": []
                                                                                                                }
                                                                                                            ]
                                                                                                        }
                                                                                                    ]
                                                                                                },
                                                                                                {
                                                                                                    "type": "integer",
                                                                                                    "label": "0",
                                                                                                    "start_token": -1,
                                                                                                    "end_token": -1,
                                                                                                    "children": []
                                                                                                }
                                                                                            ]
                                                                                        }
                                                                                    ]
                                                                                }
                                                                            ]
                                                                        }
                                                                    ]
                                                                },
                                                                {
                                                                    "type": "expression_statement",
                                                                    "label": "db_client.spend_credits(user_id, credit, node_block.id, input_data, s, t)",
                                                                    "start_token": 1483,
                                                                    "end_token": -1,
                                                                    "children": [
                                                                        {
                                                                            "type": "call",
                                                                            "label": "db_client.spend_credits(user_id, credit, node_block.id, input_data, s, t)",
                                                                            "start_token": 1483,
                                                                            "end_token": -1,
                                                                            "children": [
                                                                                {
                                                                                    "type": "attribute",
                                                                                    "label": "db_client.spend_credits",
                                                                                    "start_token": 1483,
                                                                                    "end_token": 1487,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "label": "db_client",
                                                                                            "start_token": 1483,
                                                                                            "end_token": 1485,
                                                                                            "children": []
                                                                                        },
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "label": "spend_credits",
                                                                                            "start_token": 1485,
                                                                                            "end_token": 1487,
                                                                                            "children": []
                                                                                        }
                                                                                    ]
                                                                                },
                                                                                {
                                                                                    "type": "argument_list",
                                                                                    "label": "(user_id, credit, node_block.id, input_data, s, t)",
                                                                                    "start_token": 1487,
                                                                                    "end_token": -1,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "label": "user_id",
                                                                                            "start_token": 1487,
                                                                                            "end_token": 1489,
                                                                                            "children": []
                                                                                        },
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "label": "credit",
                                                                                            "start_token": 1489,
                                                                                            "end_token": 1491,
                                                                                            "children": []
                                                                                        },
                                                                                        {
                                                                                            "type": "attribute",
                                                                                            "label": "node_block.id",
                                                                                            "start_token": 1491,
                                                                                            "end_token": 1495,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "label": "node_block",
                                                                                                    "start_token": 1491,
                                                                                                    "end_token": 1494,
                                                                                                    "children": []
                                                                                                },
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "label": "id",
                                                                                                    "start_token": 1495,
                                                                                                    "end_token": 1495,
                                                                                                    "children": []
                                                                                                }
                                                                                            ]
                                                                                        },
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "label": "input_data",
                                                                                            "start_token": 1495,
                                                                                            "end_token": 1498,
                                                                                            "children": []
                                                                                        },
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "label": "s",
                                                                                            "start_token": 1500,
                                                                                            "end_token": 1500,
                                                                                            "children": []
                                                                                        },
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "label": "t",
                                                                                            "start_token": -1,
                                                                                            "end_token": -1,
                                                                                            "children": []
                                                                                        }
                                                                                    ]
                                                                                }
                                                                            ]
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                },
                                                {
                                                    "type": "comment",
                                                    "label": "# Update execution stats",
                                                    "start_token": 1504,
                                                    "end_token": -1,
                                                    "children": []
                                                },
                                                {
                                                    "type": "if_statement",
                                                    "label": "if execution_stats is not None:\n            execution_stats.update(node_block.execution_stats)\n            execution_stats[\"input_size\"] = input_size\n            execution_stats[\"output_size\"] = output_size",
                                                    "start_token": 1509,
                                                    "end_token": 1540,
                                                    "children": [
                                                        {
                                                            "type": "comparison_operator",
                                                            "label": "execution_stats is not None",
                                                            "start_token": 1509,
                                                            "end_token": -1,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "label": "execution_stats",
                                                                    "start_token": 1509,
                                                                    "end_token": -1,
                                                                    "children": []
                                                                },
                                                                {
                                                                    "type": "none",
                                                                    "label": "None",
                                                                    "start_token": 1513,
                                                                    "end_token": -1,
                                                                    "children": []
                                                                }
                                                            ]
                                                        },
                                                        {
                                                            "type": "block",
                                                            "label": "execution_stats.update(node_block.execution_stats)\n            execution_stats[\"input_size\"] = input_size\n            execution_stats[\"output_size\"] = output_size",
                                                            "start_token": 1515,
                                                            "end_token": 1540,
                                                            "children": [
                                                                {
                                                                    "type": "expression_statement",
                                                                    "label": "execution_stats.update(node_block.execution_stats)",
                                                                    "start_token": 1515,
                                                                    "end_token": -1,
                                                                    "children": [
                                                                        {
                                                                            "type": "call",
                                                                            "label": "execution_stats.update(node_block.execution_stats)",
                                                                            "start_token": 1515,
                                                                            "end_token": -1,
                                                                            "children": [
                                                                                {
                                                                                    "type": "attribute",
                                                                                    "label": "execution_stats.update",
                                                                                    "start_token": 1515,
                                                                                    "end_token": 1519,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "label": "execution_stats",
                                                                                            "start_token": 1515,
                                                                                            "end_token": 1517,
                                                                                            "children": []
                                                                                        },
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "label": "update",
                                                                                            "start_token": 1517,
                                                                                            "end_token": 1519,
                                                                                            "children": []
                                                                                        }
                                                                                    ]
                                                                                },
                                                                                {
                                                                                    "type": "argument_list",
                                                                                    "label": "(node_block.execution_stats)",
                                                                                    "start_token": 1519,
                                                                                    "end_token": -1,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "attribute",
                                                                                            "label": "node_block.execution_stats",
                                                                                            "start_token": 1519,
                                                                                            "end_token": -1,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "label": "node_block",
                                                                                                    "start_token": 1519,
                                                                                                    "end_token": 1521,
                                                                                                    "children": []
                                                                                                },
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "label": "execution_stats",
                                                                                                    "start_token": 1521,
                                                                                                    "end_token": -1,
                                                                                                    "children": []
                                                                                                }
                                                                                            ]
                                                                                        }
                                                                                    ]
                                                                                }
                                                                            ]
                                                                        }
                                                                    ]
                                                                },
                                                                {
                                                                    "type": "expression_statement",
                                                                    "label": "execution_stats[\"input_size\"] = input_size",
                                                                    "start_token": 1524,
                                                                    "end_token": -1,
                                                                    "children": [
                                                                        {
                                                                            "type": "assignment",
                                                                            "label": "execution_stats[\"input_size\"] = input_size",
                                                                            "start_token": 1524,
                                                                            "end_token": -1,
                                                                            "children": [
                                                                                {
                                                                                    "type": "subscript",
                                                                                    "label": "execution_stats[\"input_size\"]",
                                                                                    "start_token": 1524,
                                                                                    "end_token": 1529,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "label": "execution_stats",
                                                                                            "start_token": 1524,
                                                                                            "end_token": 1526,
                                                                                            "children": []
                                                                                        },
                                                                                        {
                                                                                            "type": "string",
                                                                                            "label": "\"input_size\"",
                                                                                            "start_token": 1526,
                                                                                            "end_token": -1,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "string_start",
                                                                                                    "label": "\"",
                                                                                                    "start_token": 1526,
                                                                                                    "end_token": 1526,
                                                                                                    "children": []
                                                                                                },
                                                                                                {
                                                                                                    "type": "string_content",
                                                                                                    "label": "input_size",
                                                                                                    "start_token": 1526,
                                                                                                    "end_token": 1528,
                                                                                                    "children": []
                                                                                                },
                                                                                                {
                                                                                                    "type": "string_end",
                                                                                                    "label": "\"",
                                                                                                    "start_token": -1,
                                                                                                    "end_token": -1,
                                                                                                    "children": []
                                                                                                }
                                                                                            ]
                                                                                        }
                                                                                    ]
                                                                                },
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "input_size",
                                                                                    "start_token": 1529,
                                                                                    "end_token": -1,
                                                                                    "children": []
                                                                                }
                                                                            ]
                                                                        }
                                                                    ]
                                                                },
                                                                {
                                                                    "type": "expression_statement",
                                                                    "label": "execution_stats[\"output_size\"] = output_size",
                                                                    "start_token": 1531,
                                                                    "end_token": 1540,
                                                                    "children": [
                                                                        {
                                                                            "type": "assignment",
                                                                            "label": "execution_stats[\"output_size\"] = output_size",
                                                                            "start_token": 1531,
                                                                            "end_token": 1540,
                                                                            "children": [
                                                                                {
                                                                                    "type": "subscript",
                                                                                    "label": "execution_stats[\"output_size\"]",
                                                                                    "start_token": 1531,
                                                                                    "end_token": 1536,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "label": "execution_stats",
                                                                                            "start_token": 1531,
                                                                                            "end_token": 1533,
                                                                                            "children": []
                                                                                        },
                                                                                        {
                                                                                            "type": "string",
                                                                                            "label": "\"output_size\"",
                                                                                            "start_token": 1533,
                                                                                            "end_token": -1,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "string_start",
                                                                                                    "label": "\"",
                                                                                                    "start_token": 1533,
                                                                                                    "end_token": 1533,
                                                                                                    "children": []
                                                                                                },
                                                                                                {
                                                                                                    "type": "string_content",
                                                                                                    "label": "output_size",
                                                                                                    "start_token": 1533,
                                                                                                    "end_token": 1535,
                                                                                                    "children": []
                                                                                                },
                                                                                                {
                                                                                                    "type": "string_end",
                                                                                                    "label": "\"",
                                                                                                    "start_token": -1,
                                                                                                    "end_token": -1,
                                                                                                    "children": []
                                                                                                }
                                                                                            ]
                                                                                        }
                                                                                    ]
                                                                                },
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "output_size",
                                                                                    "start_token": 1536,
                                                                                    "end_token": 1540,
                                                                                    "children": []
                                                                                }
                                                                            ]
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                }
                                            ]
                                        }
                                    ]
                                }
                            ]
                        }
                    ]
                }
            ]
        },
        {
            "type": "function_definition",
            "label": "def _enqueue_next_nodes(\n    db_client: \"DatabaseManager\",\n    node: Node,\n    output: BlockData,\n    user_id: str,\n    graph_exec_id: str,\n    graph_id: str,\n    log_metadata: LogMetadata,\n) -> list[NodeExecutionEntry]:\n    def add_enqueued_execution(\n        node_exec_id: str, node_id: str, data: BlockInput\n    ) -> NodeExecutionEntry:\n        exec_update = db_client.update_execution_status(\n            node_exec_id, ExecutionStatus.QUEUED, data\n        )\n        db_client.send_execution_update(exec_update)\n        return NodeExecutionEntry(\n            user_id=user_id,\n            graph_exec_id=graph_exec_id,\n            graph_id=graph_id,\n            node_exec_id=node_exec_id,\n            node_id=node_id,\n            data=data,\n        )\n\n    def register_next_executions(node_link: Link) -> list[NodeExecutionEntry]:\n        enqueued_executions = []\n        next_output_name = node_link.source_name\n        next_input_name = node_link.sink_name\n        next_node_id = node_link.sink_id\n\n        next_data = parse_execution_output(output, next_output_name)\n        if next_data is None:\n            return enqueued_executions\n\n        next_node = db_client.get_node(next_node_id)\n\n        # Multiple node can register the same next node, we need this to be atomic\n        # To avoid same execution to be enqueued multiple times,\n        # Or the same input to be consumed multiple times.\n        with synchronized(f\"upsert_input-{next_node_id}-{graph_exec_id}\"):\n            # Add output data to the earliest incomplete execution, or create a new one.\n            next_node_exec_id, next_node_input = db_client.upsert_execution_input(\n                node_id=next_node_id,\n                graph_exec_id=graph_exec_id,\n                input_name=next_input_name,\n                input_data=next_data,\n            )\n\n            # Complete missing static input pins data using the last execution input.\n            static_link_names = {\n                link.sink_name\n                for link in next_node.input_links\n                if link.is_static and link.sink_name not in next_node_input\n            }\n            if static_link_names and (\n                latest_execution := db_client.get_latest_execution(\n                    next_node_id, graph_exec_id\n                )\n            ):\n                for name in static_link_names:\n                    next_node_input[name] = latest_execution.input_data.get(name)\n\n            # Validate the input data for the next node.\n            next_node_input, validation_msg = validate_exec(next_node, next_node_input)\n            suffix = f\"{next_output_name}>{next_input_name}~{next_node_exec_id}:{validation_msg}\"\n\n            # Incomplete input data, skip queueing the execution.\n            if not next_node_input:\n                log_metadata.warning(f\"Skipped queueing {suffix}\")\n                return enqueued_executions\n\n            # Input is complete, enqueue the execution.\n            log_metadata.info(f\"Enqueued {suffix}\")\n            enqueued_executions.append(\n                add_enqueued_execution(next_node_exec_id, next_node_id, next_node_input)\n            )\n\n            # Next execution stops here if the link is not static.\n            if not node_link.is_static:\n                return enqueued_executions\n\n            # If link is static, there could be some incomplete executions waiting for it.\n            # Load and complete the input missing input data, and try to re-enqueue them.\n            for iexec in db_client.get_incomplete_executions(\n                next_node_id, graph_exec_id\n            ):\n                idata = iexec.input_data\n                ineid = iexec.node_exec_id\n\n                static_link_names = {\n                    link.sink_name\n                    for link in next_node.input_links\n                    if link.is_static and link.sink_name not in idata\n                }\n                for input_name in static_link_names:\n                    idata[input_name] = next_node_input[input_name]\n\n                idata, msg = validate_exec(next_node, idata)\n                suffix = f\"{next_output_name}>{next_input_name}~{ineid}:{msg}\"\n                if not idata:\n                    log_metadata.info(f\"Enqueueing static-link skipped: {suffix}\")\n                    continue\n                log_metadata.info(f\"Enqueueing static-link execution {suffix}\")\n                enqueued_executions.append(\n                    add_enqueued_execution(iexec.node_exec_id, next_node_id, idata)\n                )\n            return enqueued_executions\n\n    return [\n        execution\n        for link in node.output_links\n        for execution in register_next_executions(link)\n    ]",
            "start_token": 1541,
            "end_token": 2233,
            "children": [
                {
                    "type": "identifier",
                    "label": "_enqueue_next_nodes",
                    "start_token": 1541,
                    "end_token": -1,
                    "children": []
                },
                {
                    "type": "parameters",
                    "label": "(\n    db_client: \"DatabaseManager\",\n    node: Node,\n    output: BlockData,\n    user_id: str,\n    graph_exec_id: str,\n    graph_id: str,\n    log_metadata: LogMetadata,\n)",
                    "start_token": -1,
                    "end_token": -1,
                    "children": [
                        {
                            "type": "typed_parameter",
                            "label": "db_client: \"DatabaseManager\"",
                            "start_token": 1544,
                            "end_token": -1,
                            "children": [
                                {
                                    "type": "identifier",
                                    "label": "db_client",
                                    "start_token": 1544,
                                    "end_token": 1546,
                                    "children": []
                                },
                                {
                                    "type": "type",
                                    "label": "\"DatabaseManager\"",
                                    "start_token": 1546,
                                    "end_token": -1,
                                    "children": [
                                        {
                                            "type": "string",
                                            "label": "\"DatabaseManager\"",
                                            "start_token": 1546,
                                            "end_token": -1,
                                            "children": [
                                                {
                                                    "type": "string_start",
                                                    "label": "\"",
                                                    "start_token": 1546,
                                                    "end_token": 1546,
                                                    "children": []
                                                },
                                                {
                                                    "type": "string_content",
                                                    "label": "DatabaseManager",
                                                    "start_token": 1546,
                                                    "end_token": -1,
                                                    "children": []
                                                },
                                                {
                                                    "type": "string_end",
                                                    "label": "\"",
                                                    "start_token": -1,
                                                    "end_token": -1,
                                                    "children": []
                                                }
                                            ]
                                        }
                                    ]
                                }
                            ]
                        },
                        {
                            "type": "typed_parameter",
                            "label": "node: Node",
                            "start_token": 1550,
                            "end_token": -1,
                            "children": [
                                {
                                    "type": "identifier",
                                    "label": "node",
                                    "start_token": 1550,
                                    "end_token": 1551,
                                    "children": []
                                },
                                {
                                    "type": "type",
                                    "label": "Node",
                                    "start_token": 1552,
                                    "end_token": -1,
                                    "children": [
                                        {
                                            "type": "identifier",
                                            "label": "Node",
                                            "start_token": 1552,
                                            "end_token": -1,
                                            "children": []
                                        }
                                    ]
                                }
                            ]
                        },
                        {
                            "type": "typed_parameter",
                            "label": "output: BlockData",
                            "start_token": 1554,
                            "end_token": -1,
                            "children": [
                                {
                                    "type": "identifier",
                                    "label": "output",
                                    "start_token": 1554,
                                    "end_token": 1556,
                                    "children": []
                                },
                                {
                                    "type": "type",
                                    "label": "BlockData",
                                    "start_token": 1556,
                                    "end_token": -1,
                                    "children": [
                                        {
                                            "type": "identifier",
                                            "label": "BlockData",
                                            "start_token": 1556,
                                            "end_token": -1,
                                            "children": []
                                        }
                                    ]
                                }
                            ]
                        },
                        {
                            "type": "typed_parameter",
                            "label": "user_id: str",
                            "start_token": 1559,
                            "end_token": -1,
                            "children": [
                                {
                                    "type": "identifier",
                                    "label": "user_id",
                                    "start_token": 1559,
                                    "end_token": 1561,
                                    "children": []
                                },
                                {
                                    "type": "type",
                                    "label": "str",
                                    "start_token": 1563,
                                    "end_token": -1,
                                    "children": [
                                        {
                                            "type": "identifier",
                                            "label": "str",
                                            "start_token": 1563,
                                            "end_token": -1,
                                            "children": []
                                        }
                                    ]
                                }
                            ]
                        },
                        {
                            "type": "typed_parameter",
                            "label": "graph_exec_id: str",
                            "start_token": 1564,
                            "end_token": -1,
                            "children": [
                                {
                                    "type": "identifier",
                                    "label": "graph_exec_id",
                                    "start_token": 1564,
                                    "end_token": 1566,
                                    "children": []
                                },
                                {
                                    "type": "type",
                                    "label": "str",
                                    "start_token": 1568,
                                    "end_token": -1,
                                    "children": [
                                        {
                                            "type": "identifier",
                                            "label": "str",
                                            "start_token": 1568,
                                            "end_token": -1,
                                            "children": []
                                        }
                                    ]
                                }
                            ]
                        },
                        {
                            "type": "typed_parameter",
                            "label": "graph_id: str",
                            "start_token": 1569,
                            "end_token": -1,
                            "children": [
                                {
                                    "type": "identifier",
                                    "label": "graph_id",
                                    "start_token": 1569,
                                    "end_token": 1571,
                                    "children": []
                                },
                                {
                                    "type": "type",
                                    "label": "str",
                                    "start_token": 1573,
                                    "end_token": -1,
                                    "children": [
                                        {
                                            "type": "identifier",
                                            "label": "str",
                                            "start_token": 1573,
                                            "end_token": -1,
                                            "children": []
                                        }
                                    ]
                                }
                            ]
                        },
                        {
                            "type": "typed_parameter",
                            "label": "log_metadata: LogMetadata",
                            "start_token": 1574,
                            "end_token": -1,
                            "children": [
                                {
                                    "type": "identifier",
                                    "label": "log_metadata",
                                    "start_token": 1574,
                                    "end_token": 1576,
                                    "children": []
                                },
                                {
                                    "type": "type",
                                    "label": "LogMetadata",
                                    "start_token": 1576,
                                    "end_token": -1,
                                    "children": [
                                        {
                                            "type": "identifier",
                                            "label": "LogMetadata",
                                            "start_token": 1576,
                                            "end_token": -1,
                                            "children": []
                                        }
                                    ]
                                }
                            ]
                        }
                    ]
                },
                {
                    "type": "type",
                    "label": "list[NodeExecutionEntry]",
                    "start_token": 1583,
                    "end_token": -1,
                    "children": [
                        {
                            "type": "generic_type",
                            "label": "list[NodeExecutionEntry]",
                            "start_token": 1583,
                            "end_token": -1,
                            "children": [
                                {
                                    "type": "identifier",
                                    "label": "list",
                                    "start_token": 1583,
                                    "end_token": 1584,
                                    "children": []
                                },
                                {
                                    "type": "type_parameter",
                                    "label": "[NodeExecutionEntry]",
                                    "start_token": 1584,
                                    "end_token": -1,
                                    "children": [
                                        {
                                            "type": "type",
                                            "label": "NodeExecutionEntry",
                                            "start_token": 1584,
                                            "end_token": -1,
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "label": "NodeExecutionEntry",
                                                    "start_token": 1584,
                                                    "end_token": -1,
                                                    "children": []
                                                }
                                            ]
                                        }
                                    ]
                                }
                            ]
                        }
                    ]
                },
                {
                    "type": "block",
                    "label": "def add_enqueued_execution(\n        node_exec_id: str, node_id: str, data: BlockInput\n    ) -> NodeExecutionEntry:\n        exec_update = db_client.update_execution_status(\n            node_exec_id, ExecutionStatus.QUEUED, data\n        )\n        db_client.send_execution_update(exec_update)\n        return NodeExecutionEntry(\n            user_id=user_id,\n            graph_exec_id=graph_exec_id,\n            graph_id=graph_id,\n            node_exec_id=node_exec_id,\n            node_id=node_id,\n            data=data,\n        )\n\n    def register_next_executions(node_link: Link) -> list[NodeExecutionEntry]:\n        enqueued_executions = []\n        next_output_name = node_link.source_name\n        next_input_name = node_link.sink_name\n        next_node_id = node_link.sink_id\n\n        next_data = parse_execution_output(output, next_output_name)\n        if next_data is None:\n            return enqueued_executions\n\n        next_node = db_client.get_node(next_node_id)\n\n        # Multiple node can register the same next node, we need this to be atomic\n        # To avoid same execution to be enqueued multiple times,\n        # Or the same input to be consumed multiple times.\n        with synchronized(f\"upsert_input-{next_node_id}-{graph_exec_id}\"):\n            # Add output data to the earliest incomplete execution, or create a new one.\n            next_node_exec_id, next_node_input = db_client.upsert_execution_input(\n                node_id=next_node_id,\n                graph_exec_id=graph_exec_id,\n                input_name=next_input_name,\n                input_data=next_data,\n            )\n\n            # Complete missing static input pins data using the last execution input.\n            static_link_names = {\n                link.sink_name\n                for link in next_node.input_links\n                if link.is_static and link.sink_name not in next_node_input\n            }\n            if static_link_names and (\n                latest_execution := db_client.get_latest_execution(\n                    next_node_id, graph_exec_id\n                )\n            ):\n                for name in static_link_names:\n                    next_node_input[name] = latest_execution.input_data.get(name)\n\n            # Validate the input data for the next node.\n            next_node_input, validation_msg = validate_exec(next_node, next_node_input)\n            suffix = f\"{next_output_name}>{next_input_name}~{next_node_exec_id}:{validation_msg}\"\n\n            # Incomplete input data, skip queueing the execution.\n            if not next_node_input:\n                log_metadata.warning(f\"Skipped queueing {suffix}\")\n                return enqueued_executions\n\n            # Input is complete, enqueue the execution.\n            log_metadata.info(f\"Enqueued {suffix}\")\n            enqueued_executions.append(\n                add_enqueued_execution(next_node_exec_id, next_node_id, next_node_input)\n            )\n\n            # Next execution stops here if the link is not static.\n            if not node_link.is_static:\n                return enqueued_executions\n\n            # If link is static, there could be some incomplete executions waiting for it.\n            # Load and complete the input missing input data, and try to re-enqueue them.\n            for iexec in db_client.get_incomplete_executions(\n                next_node_id, graph_exec_id\n            ):\n                idata = iexec.input_data\n                ineid = iexec.node_exec_id\n\n                static_link_names = {\n                    link.sink_name\n                    for link in next_node.input_links\n                    if link.is_static and link.sink_name not in idata\n                }\n                for input_name in static_link_names:\n                    idata[input_name] = next_node_input[input_name]\n\n                idata, msg = validate_exec(next_node, idata)\n                suffix = f\"{next_output_name}>{next_input_name}~{ineid}:{msg}\"\n                if not idata:\n                    log_metadata.info(f\"Enqueueing static-link skipped: {suffix}\")\n                    continue\n                log_metadata.info(f\"Enqueueing static-link execution {suffix}\")\n                enqueued_executions.append(\n                    add_enqueued_execution(iexec.node_exec_id, next_node_id, idata)\n                )\n            return enqueued_executions\n\n    return [\n        execution\n        for link in node.output_links\n        for execution in register_next_executions(link)\n    ]",
                    "start_token": 1589,
                    "end_token": 2233,
                    "children": [
                        {
                            "type": "function_definition",
                            "label": "def add_enqueued_execution(\n        node_exec_id: str, node_id: str, data: BlockInput\n    ) -> NodeExecutionEntry:\n        exec_update = db_client.update_execution_status(\n            node_exec_id, ExecutionStatus.QUEUED, data\n        )\n        db_client.send_execution_update(exec_update)\n        return NodeExecutionEntry(\n            user_id=user_id,\n            graph_exec_id=graph_exec_id,\n            graph_id=graph_id,\n            node_exec_id=node_exec_id,\n            node_id=node_id,\n            data=data,\n        )",
                            "start_token": 1589,
                            "end_token": -1,
                            "children": [
                                {
                                    "type": "identifier",
                                    "label": "add_enqueued_execution",
                                    "start_token": 1589,
                                    "end_token": -1,
                                    "children": []
                                },
                                {
                                    "type": "parameters",
                                    "label": "(\n        node_exec_id: str, node_id: str, data: BlockInput\n    )",
                                    "start_token": -1,
                                    "end_token": -1,
                                    "children": [
                                        {
                                            "type": "typed_parameter",
                                            "label": "node_exec_id: str",
                                            "start_token": 1592,
                                            "end_token": 1596,
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "label": "node_exec_id",
                                                    "start_token": 1592,
                                                    "end_token": 1594,
                                                    "children": []
                                                },
                                                {
                                                    "type": "type",
                                                    "label": "str",
                                                    "start_token": -1,
                                                    "end_token": 1596,
                                                    "children": [
                                                        {
                                                            "type": "identifier",
                                                            "label": "str",
                                                            "start_token": -1,
                                                            "end_token": 1596,
                                                            "children": []
                                                        }
                                                    ]
                                                }
                                            ]
                                        },
                                        {
                                            "type": "typed_parameter",
                                            "label": "node_id: str",
                                            "start_token": 1596,
                                            "end_token": 1600,
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "label": "node_id",
                                                    "start_token": 1596,
                                                    "end_token": 1598,
                                                    "children": []
                                                },
                                                {
                                                    "type": "type",
                                                    "label": "str",
                                                    "start_token": -1,
                                                    "end_token": 1600,
                                                    "children": [
                                                        {
                                                            "type": "identifier",
                                                            "label": "str",
                                                            "start_token": -1,
                                                            "end_token": 1600,
                                                            "children": []
                                                        }
                                                    ]
                                                }
                                            ]
                                        },
                                        {
                                            "type": "typed_parameter",
                                            "label": "data: BlockInput",
                                            "start_token": 1601,
                                            "end_token": -1,
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "label": "data",
                                                    "start_token": 1601,
                                                    "end_token": 1602,
                                                    "children": []
                                                },
                                                {
                                                    "type": "type",
                                                    "label": "BlockInput",
                                                    "start_token": 1602,
                                                    "end_token": -1,
                                                    "children": [
                                                        {
                                                            "type": "identifier",
                                                            "label": "BlockInput",
                                                            "start_token": 1602,
                                                            "end_token": -1,
                                                            "children": []
                                                        }
                                                    ]
                                                }
                                            ]
                                        }
                                    ]
                                },
                                {
                                    "type": "type",
                                    "label": "NodeExecutionEntry",
                                    "start_token": 1607,
                                    "end_token": -1,
                                    "children": [
                                        {
                                            "type": "identifier",
                                            "label": "NodeExecutionEntry",
                                            "start_token": 1607,
                                            "end_token": -1,
                                            "children": []
                                        }
                                    ]
                                },
                                {
                                    "type": "block",
                                    "label": "exec_update = db_client.update_execution_status(\n            node_exec_id, ExecutionStatus.QUEUED, data\n        )\n        db_client.send_execution_update(exec_update)\n        return NodeExecutionEntry(\n            user_id=user_id,\n            graph_exec_id=graph_exec_id,\n            graph_id=graph_id,\n            node_exec_id=node_exec_id,\n            node_id=node_id,\n            data=data,\n        )",
                                    "start_token": 1610,
                                    "end_token": -1,
                                    "children": [
                                        {
                                            "type": "expression_statement",
                                            "label": "exec_update = db_client.update_execution_status(\n            node_exec_id, ExecutionStatus.QUEUED, data\n        )",
                                            "start_token": 1610,
                                            "end_token": -1,
                                            "children": [
                                                {
                                                    "type": "assignment",
                                                    "label": "exec_update = db_client.update_execution_status(\n            node_exec_id, ExecutionStatus.QUEUED, data\n        )",
                                                    "start_token": 1610,
                                                    "end_token": -1,
                                                    "children": [
                                                        {
                                                            "type": "identifier",
                                                            "label": "exec_update",
                                                            "start_token": 1610,
                                                            "end_token": 1612,
                                                            "children": []
                                                        },
                                                        {
                                                            "type": "call",
                                                            "label": "db_client.update_execution_status(\n            node_exec_id, ExecutionStatus.QUEUED, data\n        )",
                                                            "start_token": 1612,
                                                            "end_token": -1,
                                                            "children": [
                                                                {
                                                                    "type": "attribute",
                                                                    "label": "db_client.update_execution_status",
                                                                    "start_token": 1612,
                                                                    "end_token": -1,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "db_client",
                                                                            "start_token": 1612,
                                                                            "end_token": 1614,
                                                                            "children": []
                                                                        },
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "update_execution_status",
                                                                            "start_token": 1614,
                                                                            "end_token": -1,
                                                                            "children": []
                                                                        }
                                                                    ]
                                                                },
                                                                {
                                                                    "type": "argument_list",
                                                                    "label": "(\n            node_exec_id, ExecutionStatus.QUEUED, data\n        )",
                                                                    "start_token": -1,
                                                                    "end_token": -1,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "node_exec_id",
                                                                            "start_token": 1617,
                                                                            "end_token": 1619,
                                                                            "children": []
                                                                        },
                                                                        {
                                                                            "type": "attribute",
                                                                            "label": "ExecutionStatus.QUEUED",
                                                                            "start_token": 1619,
                                                                            "end_token": 1623,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "ExecutionStatus",
                                                                                    "start_token": 1619,
                                                                                    "end_token": 1621,
                                                                                    "children": []
                                                                                },
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "QUEUED",
                                                                                    "start_token": 1621,
                                                                                    "end_token": 1623,
                                                                                    "children": []
                                                                                }
                                                                            ]
                                                                        },
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "data",
                                                                            "start_token": 1624,
                                                                            "end_token": -1,
                                                                            "children": []
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                }
                                            ]
                                        },
                                        {
                                            "type": "expression_statement",
                                            "label": "db_client.send_execution_update(exec_update)",
                                            "start_token": 1627,
                                            "end_token": -1,
                                            "children": [
                                                {
                                                    "type": "call",
                                                    "label": "db_client.send_execution_update(exec_update)",
                                                    "start_token": 1627,
                                                    "end_token": -1,
                                                    "children": [
                                                        {
                                                            "type": "attribute",
                                                            "label": "db_client.send_execution_update",
                                                            "start_token": 1627,
                                                            "end_token": 1631,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "label": "db_client",
                                                                    "start_token": 1627,
                                                                    "end_token": 1629,
                                                                    "children": []
                                                                },
                                                                {
                                                                    "type": "identifier",
                                                                    "label": "send_execution_update",
                                                                    "start_token": 1629,
                                                                    "end_token": 1631,
                                                                    "children": []
                                                                }
                                                            ]
                                                        },
                                                        {
                                                            "type": "argument_list",
                                                            "label": "(exec_update)",
                                                            "start_token": 1631,
                                                            "end_token": -1,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "label": "exec_update",
                                                                    "start_token": 1631,
                                                                    "end_token": -1,
                                                                    "children": []
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                }
                                            ]
                                        },
                                        {
                                            "type": "return_statement",
                                            "label": "return NodeExecutionEntry(\n            user_id=user_id,\n            graph_exec_id=graph_exec_id,\n            graph_id=graph_id,\n            node_exec_id=node_exec_id,\n            node_id=node_id,\n            data=data,\n        )",
                                            "start_token": 1634,
                                            "end_token": -1,
                                            "children": [
                                                {
                                                    "type": "call",
                                                    "label": "NodeExecutionEntry(\n            user_id=user_id,\n            graph_exec_id=graph_exec_id,\n            graph_id=graph_id,\n            node_exec_id=node_exec_id,\n            node_id=node_id,\n            data=data,\n        )",
                                                    "start_token": 1635,
                                                    "end_token": -1,
                                                    "children": [
                                                        {
                                                            "type": "identifier",
                                                            "label": "NodeExecutionEntry",
                                                            "start_token": 1635,
                                                            "end_token": -1,
                                                            "children": []
                                                        },
                                                        {
                                                            "type": "argument_list",
                                                            "label": "(\n            user_id=user_id,\n            graph_exec_id=graph_exec_id,\n            graph_id=graph_id,\n            node_exec_id=node_exec_id,\n            node_id=node_id,\n            data=data,\n        )",
                                                            "start_token": -1,
                                                            "end_token": -1,
                                                            "children": [
                                                                {
                                                                    "type": "keyword_argument",
                                                                    "label": "user_id=user_id",
                                                                    "start_token": 1638,
                                                                    "end_token": -1,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "user_id",
                                                                            "start_token": 1638,
                                                                            "end_token": 1640,
                                                                            "children": []
                                                                        },
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "user_id",
                                                                            "start_token": 1640,
                                                                            "end_token": -1,
                                                                            "children": []
                                                                        }
                                                                    ]
                                                                },
                                                                {
                                                                    "type": "keyword_argument",
                                                                    "label": "graph_exec_id=graph_exec_id",
                                                                    "start_token": 1643,
                                                                    "end_token": -1,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "graph_exec_id",
                                                                            "start_token": 1643,
                                                                            "end_token": 1645,
                                                                            "children": []
                                                                        },
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "graph_exec_id",
                                                                            "start_token": 1645,
                                                                            "end_token": -1,
                                                                            "children": []
                                                                        }
                                                                    ]
                                                                },
                                                                {
                                                                    "type": "keyword_argument",
                                                                    "label": "graph_id=graph_id",
                                                                    "start_token": 1648,
                                                                    "end_token": -1,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "graph_id",
                                                                            "start_token": 1648,
                                                                            "end_token": 1650,
                                                                            "children": []
                                                                        },
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "graph_id",
                                                                            "start_token": 1650,
                                                                            "end_token": -1,
                                                                            "children": []
                                                                        }
                                                                    ]
                                                                },
                                                                {
                                                                    "type": "keyword_argument",
                                                                    "label": "node_exec_id=node_exec_id",
                                                                    "start_token": 1653,
                                                                    "end_token": -1,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "node_exec_id",
                                                                            "start_token": 1653,
                                                                            "end_token": 1655,
                                                                            "children": []
                                                                        },
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "node_exec_id",
                                                                            "start_token": 1655,
                                                                            "end_token": -1,
                                                                            "children": []
                                                                        }
                                                                    ]
                                                                },
                                                                {
                                                                    "type": "keyword_argument",
                                                                    "label": "node_id=node_id",
                                                                    "start_token": 1658,
                                                                    "end_token": -1,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "node_id",
                                                                            "start_token": 1658,
                                                                            "end_token": 1660,
                                                                            "children": []
                                                                        },
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "node_id",
                                                                            "start_token": 1660,
                                                                            "end_token": -1,
                                                                            "children": []
                                                                        }
                                                                    ]
                                                                },
                                                                {
                                                                    "type": "keyword_argument",
                                                                    "label": "data=data",
                                                                    "start_token": 1664,
                                                                    "end_token": -1,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "data",
                                                                            "start_token": 1664,
                                                                            "end_token": 1665,
                                                                            "children": []
                                                                        },
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "data",
                                                                            "start_token": 1666,
                                                                            "end_token": -1,
                                                                            "children": []
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                }
                                            ]
                                        }
                                    ]
                                }
                            ]
                        },
                        {
                            "type": "function_definition",
                            "label": "def register_next_executions(node_link: Link) -> list[NodeExecutionEntry]:\n        enqueued_executions = []\n        next_output_name = node_link.source_name\n        next_input_name = node_link.sink_name\n        next_node_id = node_link.sink_id\n\n        next_data = parse_execution_output(output, next_output_name)\n        if next_data is None:\n            return enqueued_executions\n\n        next_node = db_client.get_node(next_node_id)\n\n        # Multiple node can register the same next node, we need this to be atomic\n        # To avoid same execution to be enqueued multiple times,\n        # Or the same input to be consumed multiple times.\n        with synchronized(f\"upsert_input-{next_node_id}-{graph_exec_id}\"):\n            # Add output data to the earliest incomplete execution, or create a new one.\n            next_node_exec_id, next_node_input = db_client.upsert_execution_input(\n                node_id=next_node_id,\n                graph_exec_id=graph_exec_id,\n                input_name=next_input_name,\n                input_data=next_data,\n            )\n\n            # Complete missing static input pins data using the last execution input.\n            static_link_names = {\n                link.sink_name\n                for link in next_node.input_links\n                if link.is_static and link.sink_name not in next_node_input\n            }\n            if static_link_names and (\n                latest_execution := db_client.get_latest_execution(\n                    next_node_id, graph_exec_id\n                )\n            ):\n                for name in static_link_names:\n                    next_node_input[name] = latest_execution.input_data.get(name)\n\n            # Validate the input data for the next node.\n            next_node_input, validation_msg = validate_exec(next_node, next_node_input)\n            suffix = f\"{next_output_name}>{next_input_name}~{next_node_exec_id}:{validation_msg}\"\n\n            # Incomplete input data, skip queueing the execution.\n            if not next_node_input:\n                log_metadata.warning(f\"Skipped queueing {suffix}\")\n                return enqueued_executions\n\n            # Input is complete, enqueue the execution.\n            log_metadata.info(f\"Enqueued {suffix}\")\n            enqueued_executions.append(\n                add_enqueued_execution(next_node_exec_id, next_node_id, next_node_input)\n            )\n\n            # Next execution stops here if the link is not static.\n            if not node_link.is_static:\n                return enqueued_executions\n\n            # If link is static, there could be some incomplete executions waiting for it.\n            # Load and complete the input missing input data, and try to re-enqueue them.\n            for iexec in db_client.get_incomplete_executions(\n                next_node_id, graph_exec_id\n            ):\n                idata = iexec.input_data\n                ineid = iexec.node_exec_id\n\n                static_link_names = {\n                    link.sink_name\n                    for link in next_node.input_links\n                    if link.is_static and link.sink_name not in idata\n                }\n                for input_name in static_link_names:\n                    idata[input_name] = next_node_input[input_name]\n\n                idata, msg = validate_exec(next_node, idata)\n                suffix = f\"{next_output_name}>{next_input_name}~{ineid}:{msg}\"\n                if not idata:\n                    log_metadata.info(f\"Enqueueing static-link skipped: {suffix}\")\n                    continue\n                log_metadata.info(f\"Enqueueing static-link execution {suffix}\")\n                enqueued_executions.append(\n                    add_enqueued_execution(iexec.node_exec_id, next_node_id, idata)\n                )\n            return enqueued_executions",
                            "start_token": 1672,
                            "end_token": -1,
                            "children": [
                                {
                                    "type": "identifier",
                                    "label": "register_next_executions",
                                    "start_token": 1672,
                                    "end_token": 1674,
                                    "children": []
                                },
                                {
                                    "type": "parameters",
                                    "label": "(node_link: Link)",
                                    "start_token": 1674,
                                    "end_token": -1,
                                    "children": [
                                        {
                                            "type": "typed_parameter",
                                            "label": "node_link: Link",
                                            "start_token": 1674,
                                            "end_token": 1679,
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "label": "node_link",
                                                    "start_token": 1674,
                                                    "end_token": 1676,
                                                    "children": []
                                                },
                                                {
                                                    "type": "type",
                                                    "label": "Link",
                                                    "start_token": 1677,
                                                    "end_token": 1679,
                                                    "children": [
                                                        {
                                                            "type": "identifier",
                                                            "label": "Link",
                                                            "start_token": 1677,
                                                            "end_token": 1679,
                                                            "children": []
                                                        }
                                                    ]
                                                }
                                            ]
                                        }
                                    ]
                                },
                                {
                                    "type": "type",
                                    "label": "list[NodeExecutionEntry]",
                                    "start_token": 1681,
                                    "end_token": -1,
                                    "children": [
                                        {
                                            "type": "generic_type",
                                            "label": "list[NodeExecutionEntry]",
                                            "start_token": 1681,
                                            "end_token": -1,
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "label": "list",
                                                    "start_token": 1681,
                                                    "end_token": 1682,
                                                    "children": []
                                                },
                                                {
                                                    "type": "type_parameter",
                                                    "label": "[NodeExecutionEntry]",
                                                    "start_token": 1682,
                                                    "end_token": -1,
                                                    "children": [
                                                        {
                                                            "type": "type",
                                                            "label": "NodeExecutionEntry",
                                                            "start_token": 1682,
                                                            "end_token": -1,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "label": "NodeExecutionEntry",
                                                                    "start_token": 1682,
                                                                    "end_token": -1,
                                                                    "children": []
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                }
                                            ]
                                        }
                                    ]
                                },
                                {
                                    "type": "block",
                                    "label": "enqueued_executions = []\n        next_output_name = node_link.source_name\n        next_input_name = node_link.sink_name\n        next_node_id = node_link.sink_id\n\n        next_data = parse_execution_output(output, next_output_name)\n        if next_data is None:\n            return enqueued_executions\n\n        next_node = db_client.get_node(next_node_id)\n\n        # Multiple node can register the same next node, we need this to be atomic\n        # To avoid same execution to be enqueued multiple times,\n        # Or the same input to be consumed multiple times.\n        with synchronized(f\"upsert_input-{next_node_id}-{graph_exec_id}\"):\n            # Add output data to the earliest incomplete execution, or create a new one.\n            next_node_exec_id, next_node_input = db_client.upsert_execution_input(\n                node_id=next_node_id,\n                graph_exec_id=graph_exec_id,\n                input_name=next_input_name,\n                input_data=next_data,\n            )\n\n            # Complete missing static input pins data using the last execution input.\n            static_link_names = {\n                link.sink_name\n                for link in next_node.input_links\n                if link.is_static and link.sink_name not in next_node_input\n            }\n            if static_link_names and (\n                latest_execution := db_client.get_latest_execution(\n                    next_node_id, graph_exec_id\n                )\n            ):\n                for name in static_link_names:\n                    next_node_input[name] = latest_execution.input_data.get(name)\n\n            # Validate the input data for the next node.\n            next_node_input, validation_msg = validate_exec(next_node, next_node_input)\n            suffix = f\"{next_output_name}>{next_input_name}~{next_node_exec_id}:{validation_msg}\"\n\n            # Incomplete input data, skip queueing the execution.\n            if not next_node_input:\n                log_metadata.warning(f\"Skipped queueing {suffix}\")\n                return enqueued_executions\n\n            # Input is complete, enqueue the execution.\n            log_metadata.info(f\"Enqueued {suffix}\")\n            enqueued_executions.append(\n                add_enqueued_execution(next_node_exec_id, next_node_id, next_node_input)\n            )\n\n            # Next execution stops here if the link is not static.\n            if not node_link.is_static:\n                return enqueued_executions\n\n            # If link is static, there could be some incomplete executions waiting for it.\n            # Load and complete the input missing input data, and try to re-enqueue them.\n            for iexec in db_client.get_incomplete_executions(\n                next_node_id, graph_exec_id\n            ):\n                idata = iexec.input_data\n                ineid = iexec.node_exec_id\n\n                static_link_names = {\n                    link.sink_name\n                    for link in next_node.input_links\n                    if link.is_static and link.sink_name not in idata\n                }\n                for input_name in static_link_names:\n                    idata[input_name] = next_node_input[input_name]\n\n                idata, msg = validate_exec(next_node, idata)\n                suffix = f\"{next_output_name}>{next_input_name}~{ineid}:{msg}\"\n                if not idata:\n                    log_metadata.info(f\"Enqueueing static-link skipped: {suffix}\")\n                    continue\n                log_metadata.info(f\"Enqueueing static-link execution {suffix}\")\n                enqueued_executions.append(\n                    add_enqueued_execution(iexec.node_exec_id, next_node_id, idata)\n                )\n            return enqueued_executions",
                                    "start_token": 1686,
                                    "end_token": -1,
                                    "children": [
                                        {
                                            "type": "expression_statement",
                                            "label": "enqueued_executions = []",
                                            "start_token": 1686,
                                            "end_token": -1,
                                            "children": [
                                                {
                                                    "type": "assignment",
                                                    "label": "enqueued_executions = []",
                                                    "start_token": 1686,
                                                    "end_token": -1,
                                                    "children": [
                                                        {
                                                            "type": "identifier",
                                                            "label": "enqueued_executions",
                                                            "start_token": 1686,
                                                            "end_token": 1688,
                                                            "children": []
                                                        },
                                                        {
                                                            "type": "list",
                                                            "label": "[]",
                                                            "start_token": -1,
                                                            "end_token": -1,
                                                            "children": []
                                                        }
                                                    ]
                                                }
                                            ]
                                        },
                                        {
                                            "type": "expression_statement",
                                            "label": "next_output_name = node_link.source_name",
                                            "start_token": 1691,
                                            "end_token": -1,
                                            "children": [
                                                {
                                                    "type": "assignment",
                                                    "label": "next_output_name = node_link.source_name",
                                                    "start_token": 1691,
                                                    "end_token": -1,
                                                    "children": [
                                                        {
                                                            "type": "identifier",
                                                            "label": "next_output_name",
                                                            "start_token": 1691,
                                                            "end_token": 1693,
                                                            "children": []
                                                        },
                                                        {
                                                            "type": "attribute",
                                                            "label": "node_link.source_name",
                                                            "start_token": 1693,
                                                            "end_token": -1,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "label": "node_link",
                                                                    "start_token": 1693,
                                                                    "end_token": 1695,
                                                                    "children": []
                                                                },
                                                                {
                                                                    "type": "identifier",
                                                                    "label": "source_name",
                                                                    "start_token": 1695,
                                                                    "end_token": -1,
                                                                    "children": []
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                }
                                            ]
                                        },
                                        {
                                            "type": "expression_statement",
                                            "label": "next_input_name = node_link.sink_name",
                                            "start_token": 1697,
                                            "end_token": -1,
                                            "children": [
                                                {
                                                    "type": "assignment",
                                                    "label": "next_input_name = node_link.sink_name",
                                                    "start_token": 1697,
                                                    "end_token": -1,
                                                    "children": [
                                                        {
                                                            "type": "identifier",
                                                            "label": "next_input_name",
                                                            "start_token": 1697,
                                                            "end_token": 1699,
                                                            "children": []
                                                        },
                                                        {
                                                            "type": "attribute",
                                                            "label": "node_link.sink_name",
                                                            "start_token": 1699,
                                                            "end_token": -1,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "label": "node_link",
                                                                    "start_token": 1699,
                                                                    "end_token": 1701,
                                                                    "children": []
                                                                },
                                                                {
                                                                    "type": "identifier",
                                                                    "label": "sink_name",
                                                                    "start_token": 1701,
                                                                    "end_token": -1,
                                                                    "children": []
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                }
                                            ]
                                        },
                                        {
                                            "type": "expression_statement",
                                            "label": "next_node_id = node_link.sink_id",
                                            "start_token": 1703,
                                            "end_token": -1,
                                            "children": [
                                                {
                                                    "type": "assignment",
                                                    "label": "next_node_id = node_link.sink_id",
                                                    "start_token": 1703,
                                                    "end_token": -1,
                                                    "children": [
                                                        {
                                                            "type": "identifier",
                                                            "label": "next_node_id",
                                                            "start_token": 1703,
                                                            "end_token": 1705,
                                                            "children": []
                                                        },
                                                        {
                                                            "type": "attribute",
                                                            "label": "node_link.sink_id",
                                                            "start_token": 1705,
                                                            "end_token": -1,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "label": "node_link",
                                                                    "start_token": 1705,
                                                                    "end_token": 1707,
                                                                    "children": []
                                                                },
                                                                {
                                                                    "type": "identifier",
                                                                    "label": "sink_id",
                                                                    "start_token": 1707,
                                                                    "end_token": -1,
                                                                    "children": []
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                }
                                            ]
                                        },
                                        {
                                            "type": "expression_statement",
                                            "label": "next_data = parse_execution_output(output, next_output_name)",
                                            "start_token": 1710,
                                            "end_token": -1,
                                            "children": [
                                                {
                                                    "type": "assignment",
                                                    "label": "next_data = parse_execution_output(output, next_output_name)",
                                                    "start_token": 1710,
                                                    "end_token": -1,
                                                    "children": [
                                                        {
                                                            "type": "identifier",
                                                            "label": "next_data",
                                                            "start_token": 1710,
                                                            "end_token": 1712,
                                                            "children": []
                                                        },
                                                        {
                                                            "type": "call",
                                                            "label": "parse_execution_output(output, next_output_name)",
                                                            "start_token": 1712,
                                                            "end_token": -1,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "label": "parse_execution_output",
                                                                    "start_token": 1712,
                                                                    "end_token": 1714,
                                                                    "children": []
                                                                },
                                                                {
                                                                    "type": "argument_list",
                                                                    "label": "(output, next_output_name)",
                                                                    "start_token": 1714,
                                                                    "end_token": -1,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "output",
                                                                            "start_token": 1714,
                                                                            "end_token": 1716,
                                                                            "children": []
                                                                        },
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "next_output_name",
                                                                            "start_token": 1716,
                                                                            "end_token": -1,
                                                                            "children": []
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                }
                                            ]
                                        },
                                        {
                                            "type": "if_statement",
                                            "label": "if next_data is None:\n            return enqueued_executions",
                                            "start_token": 1720,
                                            "end_token": -1,
                                            "children": [
                                                {
                                                    "type": "comparison_operator",
                                                    "label": "next_data is None",
                                                    "start_token": 1720,
                                                    "end_token": -1,
                                                    "children": [
                                                        {
                                                            "type": "identifier",
                                                            "label": "next_data",
                                                            "start_token": 1720,
                                                            "end_token": -1,
                                                            "children": []
                                                        },
                                                        {
                                                            "type": "none",
                                                            "label": "None",
                                                            "start_token": 1723,
                                                            "end_token": -1,
                                                            "children": []
                                                        }
                                                    ]
                                                },
                                                {
                                                    "type": "block",
                                                    "label": "return enqueued_executions",
                                                    "start_token": 1725,
                                                    "end_token": -1,
                                                    "children": [
                                                        {
                                                            "type": "return_statement",
                                                            "label": "return enqueued_executions",
                                                            "start_token": 1725,
                                                            "end_token": -1,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "label": "enqueued_executions",
                                                                    "start_token": 1726,
                                                                    "end_token": -1,
                                                                    "children": []
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                }
                                            ]
                                        },
                                        {
                                            "type": "expression_statement",
                                            "label": "next_node = db_client.get_node(next_node_id)",
                                            "start_token": 1729,
                                            "end_token": -1,
                                            "children": [
                                                {
                                                    "type": "assignment",
                                                    "label": "next_node = db_client.get_node(next_node_id)",
                                                    "start_token": 1729,
                                                    "end_token": -1,
                                                    "children": [
                                                        {
                                                            "type": "identifier",
                                                            "label": "next_node",
                                                            "start_token": 1729,
                                                            "end_token": 1731,
                                                            "children": []
                                                        },
                                                        {
                                                            "type": "call",
                                                            "label": "db_client.get_node(next_node_id)",
                                                            "start_token": 1731,
                                                            "end_token": -1,
                                                            "children": [
                                                                {
                                                                    "type": "attribute",
                                                                    "label": "db_client.get_node",
                                                                    "start_token": 1731,
                                                                    "end_token": 1735,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "db_client",
                                                                            "start_token": 1731,
                                                                            "end_token": 1733,
                                                                            "children": []
                                                                        },
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "get_node",
                                                                            "start_token": 1733,
                                                                            "end_token": 1735,
                                                                            "children": []
                                                                        }
                                                                    ]
                                                                },
                                                                {
                                                                    "type": "argument_list",
                                                                    "label": "(next_node_id)",
                                                                    "start_token": 1735,
                                                                    "end_token": -1,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "next_node_id",
                                                                            "start_token": 1735,
                                                                            "end_token": -1,
                                                                            "children": []
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                }
                                            ]
                                        },
                                        {
                                            "type": "comment",
                                            "label": "# Multiple node can register the same next node, we need this to be atomic",
                                            "start_token": 1740,
                                            "end_token": -1,
                                            "children": []
                                        },
                                        {
                                            "type": "comment",
                                            "label": "# To avoid same execution to be enqueued multiple times,",
                                            "start_token": -1,
                                            "end_token": -1,
                                            "children": []
                                        },
                                        {
                                            "type": "comment",
                                            "label": "# Or the same input to be consumed multiple times.",
                                            "start_token": -1,
                                            "end_token": -1,
                                            "children": []
                                        },
                                        {
                                            "type": "with_statement",
                                            "label": "with synchronized(f\"upsert_input-{next_node_id}-{graph_exec_id}\"):\n            # Add output data to the earliest incomplete execution, or create a new one.\n            next_node_exec_id, next_node_input = db_client.upsert_execution_input(\n                node_id=next_node_id,\n                graph_exec_id=graph_exec_id,\n                input_name=next_input_name,\n                input_data=next_data,\n            )\n\n            # Complete missing static input pins data using the last execution input.\n            static_link_names = {\n                link.sink_name\n                for link in next_node.input_links\n                if link.is_static and link.sink_name not in next_node_input\n            }\n            if static_link_names and (\n                latest_execution := db_client.get_latest_execution(\n                    next_node_id, graph_exec_id\n                )\n            ):\n                for name in static_link_names:\n                    next_node_input[name] = latest_execution.input_data.get(name)\n\n            # Validate the input data for the next node.\n            next_node_input, validation_msg = validate_exec(next_node, next_node_input)\n            suffix = f\"{next_output_name}>{next_input_name}~{next_node_exec_id}:{validation_msg}\"\n\n            # Incomplete input data, skip queueing the execution.\n            if not next_node_input:\n                log_metadata.warning(f\"Skipped queueing {suffix}\")\n                return enqueued_executions\n\n            # Input is complete, enqueue the execution.\n            log_metadata.info(f\"Enqueued {suffix}\")\n            enqueued_executions.append(\n                add_enqueued_execution(next_node_exec_id, next_node_id, next_node_input)\n            )\n\n            # Next execution stops here if the link is not static.\n            if not node_link.is_static:\n                return enqueued_executions\n\n            # If link is static, there could be some incomplete executions waiting for it.\n            # Load and complete the input missing input data, and try to re-enqueue them.\n            for iexec in db_client.get_incomplete_executions(\n                next_node_id, graph_exec_id\n            ):\n                idata = iexec.input_data\n                ineid = iexec.node_exec_id\n\n                static_link_names = {\n                    link.sink_name\n                    for link in next_node.input_links\n                    if link.is_static and link.sink_name not in idata\n                }\n                for input_name in static_link_names:\n                    idata[input_name] = next_node_input[input_name]\n\n                idata, msg = validate_exec(next_node, idata)\n                suffix = f\"{next_output_name}>{next_input_name}~{ineid}:{msg}\"\n                if not idata:\n                    log_metadata.info(f\"Enqueueing static-link skipped: {suffix}\")\n                    continue\n                log_metadata.info(f\"Enqueueing static-link execution {suffix}\")\n                enqueued_executions.append(\n                    add_enqueued_execution(iexec.node_exec_id, next_node_id, idata)\n                )\n            return enqueued_executions",
                                            "start_token": -1,
                                            "end_token": -1,
                                            "children": [
                                                {
                                                    "type": "with_clause",
                                                    "label": "synchronized(f\"upsert_input-{next_node_id}-{graph_exec_id}\")",
                                                    "start_token": 1781,
                                                    "end_token": -1,
                                                    "children": [
                                                        {
                                                            "type": "with_item",
                                                            "label": "synchronized(f\"upsert_input-{next_node_id}-{graph_exec_id}\")",
                                                            "start_token": 1781,
                                                            "end_token": -1,
                                                            "children": [
                                                                {
                                                                    "type": "call",
                                                                    "label": "synchronized(f\"upsert_input-{next_node_id}-{graph_exec_id}\")",
                                                                    "start_token": 1781,
                                                                    "end_token": -1,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "synchronized",
                                                                            "start_token": 1781,
                                                                            "end_token": 1784,
                                                                            "children": []
                                                                        },
                                                                        {
                                                                            "type": "argument_list",
                                                                            "label": "(f\"upsert_input-{next_node_id}-{graph_exec_id}\")",
                                                                            "start_token": 1784,
                                                                            "end_token": -1,
                                                                            "children": [
                                                                                {
                                                                                    "type": "string",
                                                                                    "label": "f\"upsert_input-{next_node_id}-{graph_exec_id}\"",
                                                                                    "start_token": 1784,
                                                                                    "end_token": -1,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "string_start",
                                                                                            "label": "f\"",
                                                                                            "start_token": 1784,
                                                                                            "end_token": 1784,
                                                                                            "children": []
                                                                                        },
                                                                                        {
                                                                                            "type": "string_content",
                                                                                            "label": "upsert_input-",
                                                                                            "start_token": 1784,
                                                                                            "end_token": 1784,
                                                                                            "children": []
                                                                                        },
                                                                                        {
                                                                                            "type": "interpolation",
                                                                                            "label": "{next_node_id}",
                                                                                            "start_token": 1784,
                                                                                            "end_token": 1784,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "label": "next_node_id",
                                                                                                    "start_token": 1784,
                                                                                                    "end_token": 1784,
                                                                                                    "children": []
                                                                                                }
                                                                                            ]
                                                                                        },
                                                                                        {
                                                                                            "type": "string_content",
                                                                                            "label": "-",
                                                                                            "start_token": 1784,
                                                                                            "end_token": 1784,
                                                                                            "children": []
                                                                                        },
                                                                                        {
                                                                                            "type": "interpolation",
                                                                                            "label": "{graph_exec_id}",
                                                                                            "start_token": 1784,
                                                                                            "end_token": 1787,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "label": "graph_exec_id",
                                                                                                    "start_token": 1784,
                                                                                                    "end_token": 1786,
                                                                                                    "children": []
                                                                                                }
                                                                                            ]
                                                                                        },
                                                                                        {
                                                                                            "type": "string_end",
                                                                                            "label": "\"",
                                                                                            "start_token": -1,
                                                                                            "end_token": -1,
                                                                                            "children": []
                                                                                        }
                                                                                    ]
                                                                                }
                                                                            ]
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                },
                                                {
                                                    "type": "comment",
                                                    "label": "# Add output data to the earliest incomplete execution, or create a new one.",
                                                    "start_token": 1789,
                                                    "end_token": -1,
                                                    "children": []
                                                },
                                                {
                                                    "type": "block",
                                                    "label": "next_node_exec_id, next_node_input = db_client.upsert_execution_input(\n                node_id=next_node_id,\n                graph_exec_id=graph_exec_id,\n                input_name=next_input_name,\n                input_data=next_data,\n            )\n\n            # Complete missing static input pins data using the last execution input.\n            static_link_names = {\n                link.sink_name\n                for link in next_node.input_links\n                if link.is_static and link.sink_name not in next_node_input\n            }\n            if static_link_names and (\n                latest_execution := db_client.get_latest_execution(\n                    next_node_id, graph_exec_id\n                )\n            ):\n                for name in static_link_names:\n                    next_node_input[name] = latest_execution.input_data.get(name)\n\n            # Validate the input data for the next node.\n            next_node_input, validation_msg = validate_exec(next_node, next_node_input)\n            suffix = f\"{next_output_name}>{next_input_name}~{next_node_exec_id}:{validation_msg}\"\n\n            # Incomplete input data, skip queueing the execution.\n            if not next_node_input:\n                log_metadata.warning(f\"Skipped queueing {suffix}\")\n                return enqueued_executions\n\n            # Input is complete, enqueue the execution.\n            log_metadata.info(f\"Enqueued {suffix}\")\n            enqueued_executions.append(\n                add_enqueued_execution(next_node_exec_id, next_node_id, next_node_input)\n            )\n\n            # Next execution stops here if the link is not static.\n            if not node_link.is_static:\n                return enqueued_executions\n\n            # If link is static, there could be some incomplete executions waiting for it.\n            # Load and complete the input missing input data, and try to re-enqueue them.\n            for iexec in db_client.get_incomplete_executions(\n                next_node_id, graph_exec_id\n            ):\n                idata = iexec.input_data\n                ineid = iexec.node_exec_id\n\n                static_link_names = {\n                    link.sink_name\n                    for link in next_node.input_links\n                    if link.is_static and link.sink_name not in idata\n                }\n                for input_name in static_link_names:\n                    idata[input_name] = next_node_input[input_name]\n\n                idata, msg = validate_exec(next_node, idata)\n                suffix = f\"{next_output_name}>{next_input_name}~{ineid}:{msg}\"\n                if not idata:\n                    log_metadata.info(f\"Enqueueing static-link skipped: {suffix}\")\n                    continue\n                log_metadata.info(f\"Enqueueing static-link execution {suffix}\")\n                enqueued_executions.append(\n                    add_enqueued_execution(iexec.node_exec_id, next_node_id, idata)\n                )\n            return enqueued_executions",
                                                    "start_token": 1805,
                                                    "end_token": -1,
                                                    "children": [
                                                        {
                                                            "type": "expression_statement",
                                                            "label": "next_node_exec_id, next_node_input = db_client.upsert_execution_input(\n                node_id=next_node_id,\n                graph_exec_id=graph_exec_id,\n                input_name=next_input_name,\n                input_data=next_data,\n            )",
                                                            "start_token": 1805,
                                                            "end_token": -1,
                                                            "children": [
                                                                {
                                                                    "type": "assignment",
                                                                    "label": "next_node_exec_id, next_node_input = db_client.upsert_execution_input(\n                node_id=next_node_id,\n                graph_exec_id=graph_exec_id,\n                input_name=next_input_name,\n                input_data=next_data,\n            )",
                                                                    "start_token": 1805,
                                                                    "end_token": -1,
                                                                    "children": [
                                                                        {
                                                                            "type": "pattern_list",
                                                                            "label": "next_node_exec_id, next_node_input",
                                                                            "start_token": 1805,
                                                                            "end_token": 1809,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "next_node_exec_id",
                                                                                    "start_token": 1805,
                                                                                    "end_token": 1807,
                                                                                    "children": []
                                                                                },
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "next_node_input",
                                                                                    "start_token": 1807,
                                                                                    "end_token": 1809,
                                                                                    "children": []
                                                                                }
                                                                            ]
                                                                        },
                                                                        {
                                                                            "type": "call",
                                                                            "label": "db_client.upsert_execution_input(\n                node_id=next_node_id,\n                graph_exec_id=graph_exec_id,\n                input_name=next_input_name,\n                input_data=next_data,\n            )",
                                                                            "start_token": 1809,
                                                                            "end_token": -1,
                                                                            "children": [
                                                                                {
                                                                                    "type": "attribute",
                                                                                    "label": "db_client.upsert_execution_input",
                                                                                    "start_token": 1809,
                                                                                    "end_token": -1,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "label": "db_client",
                                                                                            "start_token": 1809,
                                                                                            "end_token": 1811,
                                                                                            "children": []
                                                                                        },
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "label": "upsert_execution_input",
                                                                                            "start_token": 1811,
                                                                                            "end_token": -1,
                                                                                            "children": []
                                                                                        }
                                                                                    ]
                                                                                },
                                                                                {
                                                                                    "type": "argument_list",
                                                                                    "label": "(\n                node_id=next_node_id,\n                graph_exec_id=graph_exec_id,\n                input_name=next_input_name,\n                input_data=next_data,\n            )",
                                                                                    "start_token": -1,
                                                                                    "end_token": -1,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "keyword_argument",
                                                                                            "label": "node_id=next_node_id",
                                                                                            "start_token": 1814,
                                                                                            "end_token": -1,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "label": "node_id",
                                                                                                    "start_token": 1814,
                                                                                                    "end_token": 1816,
                                                                                                    "children": []
                                                                                                },
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "label": "next_node_id",
                                                                                                    "start_token": 1816,
                                                                                                    "end_token": -1,
                                                                                                    "children": []
                                                                                                }
                                                                                            ]
                                                                                        },
                                                                                        {
                                                                                            "type": "keyword_argument",
                                                                                            "label": "graph_exec_id=graph_exec_id",
                                                                                            "start_token": 1819,
                                                                                            "end_token": -1,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "label": "graph_exec_id",
                                                                                                    "start_token": 1819,
                                                                                                    "end_token": 1821,
                                                                                                    "children": []
                                                                                                },
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "label": "graph_exec_id",
                                                                                                    "start_token": 1821,
                                                                                                    "end_token": -1,
                                                                                                    "children": []
                                                                                                }
                                                                                            ]
                                                                                        },
                                                                                        {
                                                                                            "type": "keyword_argument",
                                                                                            "label": "input_name=next_input_name",
                                                                                            "start_token": 1824,
                                                                                            "end_token": -1,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "label": "input_name",
                                                                                                    "start_token": 1824,
                                                                                                    "end_token": 1826,
                                                                                                    "children": []
                                                                                                },
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "label": "next_input_name",
                                                                                                    "start_token": 1826,
                                                                                                    "end_token": -1,
                                                                                                    "children": []
                                                                                                }
                                                                                            ]
                                                                                        },
                                                                                        {
                                                                                            "type": "keyword_argument",
                                                                                            "label": "input_data=next_data",
                                                                                            "start_token": 1829,
                                                                                            "end_token": -1,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "label": "input_data",
                                                                                                    "start_token": 1829,
                                                                                                    "end_token": 1831,
                                                                                                    "children": []
                                                                                                },
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "label": "next_data",
                                                                                                    "start_token": 1831,
                                                                                                    "end_token": -1,
                                                                                                    "children": []
                                                                                                }
                                                                                            ]
                                                                                        }
                                                                                    ]
                                                                                }
                                                                            ]
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        },
                                                        {
                                                            "type": "comment",
                                                            "label": "# Complete missing static input pins data using the last execution input.",
                                                            "start_token": 1838,
                                                            "end_token": -1,
                                                            "children": []
                                                        },
                                                        {
                                                            "type": "expression_statement",
                                                            "label": "static_link_names = {\n                link.sink_name\n                for link in next_node.input_links\n                if link.is_static and link.sink_name not in next_node_input\n            }",
                                                            "start_token": 1851,
                                                            "end_token": -1,
                                                            "children": [
                                                                {
                                                                    "type": "assignment",
                                                                    "label": "static_link_names = {\n                link.sink_name\n                for link in next_node.input_links\n                if link.is_static and link.sink_name not in next_node_input\n            }",
                                                                    "start_token": 1851,
                                                                    "end_token": -1,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "static_link_names",
                                                                            "start_token": 1851,
                                                                            "end_token": 1853,
                                                                            "children": []
                                                                        },
                                                                        {
                                                                            "type": "set_comprehension",
                                                                            "label": "{\n                link.sink_name\n                for link in next_node.input_links\n                if link.is_static and link.sink_name not in next_node_input\n            }",
                                                                            "start_token": -1,
                                                                            "end_token": -1,
                                                                            "children": [
                                                                                {
                                                                                    "type": "attribute",
                                                                                    "label": "link.sink_name",
                                                                                    "start_token": 1856,
                                                                                    "end_token": -1,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "label": "link",
                                                                                            "start_token": 1856,
                                                                                            "end_token": 1857,
                                                                                            "children": []
                                                                                        },
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "label": "sink_name",
                                                                                            "start_token": 1857,
                                                                                            "end_token": -1,
                                                                                            "children": []
                                                                                        }
                                                                                    ]
                                                                                },
                                                                                {
                                                                                    "type": "for_in_clause",
                                                                                    "label": "for link in next_node.input_links",
                                                                                    "start_token": 1860,
                                                                                    "end_token": -1,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "label": "link",
                                                                                            "start_token": -1,
                                                                                            "end_token": -1,
                                                                                            "children": []
                                                                                        },
                                                                                        {
                                                                                            "type": "attribute",
                                                                                            "label": "next_node.input_links",
                                                                                            "start_token": 1862,
                                                                                            "end_token": -1,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "label": "next_node",
                                                                                                    "start_token": 1862,
                                                                                                    "end_token": 1864,
                                                                                                    "children": []
                                                                                                },
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "label": "input_links",
                                                                                                    "start_token": 1864,
                                                                                                    "end_token": -1,
                                                                                                    "children": []
                                                                                                }
                                                                                            ]
                                                                                        }
                                                                                    ]
                                                                                },
                                                                                {
                                                                                    "type": "if_clause",
                                                                                    "label": "if link.is_static and link.sink_name not in next_node_input",
                                                                                    "start_token": 1867,
                                                                                    "end_token": -1,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "boolean_operator",
                                                                                            "label": "link.is_static and link.sink_name not in next_node_input",
                                                                                            "start_token": 1868,
                                                                                            "end_token": -1,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "attribute",
                                                                                                    "label": "link.is_static",
                                                                                                    "start_token": 1868,
                                                                                                    "end_token": 1870,
                                                                                                    "children": [
                                                                                                        {
                                                                                                            "type": "identifier",
                                                                                                            "label": "link",
                                                                                                            "start_token": 1868,
                                                                                                            "end_token": 1869,
                                                                                                            "children": []
                                                                                                        },
                                                                                                        {
                                                                                                            "type": "identifier",
                                                                                                            "label": "is_static",
                                                                                                            "start_token": 1869,
                                                                                                            "end_token": 1870,
                                                                                                            "children": []
                                                                                                        }
                                                                                                    ]
                                                                                                },
                                                                                                {
                                                                                                    "type": "comparison_operator",
                                                                                                    "label": "link.sink_name not in next_node_input",
                                                                                                    "start_token": 1872,
                                                                                                    "end_token": -1,
                                                                                                    "children": [
                                                                                                        {
                                                                                                            "type": "attribute",
                                                                                                            "label": "link.sink_name",
                                                                                                            "start_token": 1872,
                                                                                                            "end_token": 1874,
                                                                                                            "children": [
                                                                                                                {
                                                                                                                    "type": "identifier",
                                                                                                                    "label": "link",
                                                                                                                    "start_token": 1872,
                                                                                                                    "end_token": 1873,
                                                                                                                    "children": []
                                                                                                                },
                                                                                                                {
                                                                                                                    "type": "identifier",
                                                                                                                    "label": "sink_name",
                                                                                                                    "start_token": 1873,
                                                                                                                    "end_token": 1874,
                                                                                                                    "children": []
                                                                                                                }
                                                                                                            ]
                                                                                                        },
                                                                                                        {
                                                                                                            "type": "identifier",
                                                                                                            "label": "next_node_input",
                                                                                                            "start_token": 1876,
                                                                                                            "end_token": -1,
                                                                                                            "children": []
                                                                                                        }
                                                                                                    ]
                                                                                                }
                                                                                            ]
                                                                                        }
                                                                                    ]
                                                                                }
                                                                            ]
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        },
                                                        {
                                                            "type": "if_statement",
                                                            "label": "if static_link_names and (\n                latest_execution := db_client.get_latest_execution(\n                    next_node_id, graph_exec_id\n                )\n            ):\n                for name in static_link_names:\n                    next_node_input[name] = latest_execution.input_data.get(name)",
                                                            "start_token": 1881,
                                                            "end_token": -1,
                                                            "children": [
                                                                {
                                                                    "type": "boolean_operator",
                                                                    "label": "static_link_names and (\n                latest_execution := db_client.get_latest_execution(\n                    next_node_id, graph_exec_id\n                )\n            )",
                                                                    "start_token": 1881,
                                                                    "end_token": -1,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "static_link_names",
                                                                            "start_token": 1881,
                                                                            "end_token": 1882,
                                                                            "children": []
                                                                        },
                                                                        {
                                                                            "type": "parenthesized_expression",
                                                                            "label": "(\n                latest_execution := db_client.get_latest_execution(\n                    next_node_id, graph_exec_id\n                )\n            )",
                                                                            "start_token": -1,
                                                                            "end_token": -1,
                                                                            "children": [
                                                                                {
                                                                                    "type": "named_expression",
                                                                                    "label": "latest_execution := db_client.get_latest_execution(\n                    next_node_id, graph_exec_id\n                )",
                                                                                    "start_token": 1885,
                                                                                    "end_token": -1,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "label": "latest_execution",
                                                                                            "start_token": 1885,
                                                                                            "end_token": -1,
                                                                                            "children": []
                                                                                        },
                                                                                        {
                                                                                            "type": "call",
                                                                                            "label": "db_client.get_latest_execution(\n                    next_node_id, graph_exec_id\n                )",
                                                                                            "start_token": 1888,
                                                                                            "end_token": -1,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "attribute",
                                                                                                    "label": "db_client.get_latest_execution",
                                                                                                    "start_token": 1888,
                                                                                                    "end_token": -1,
                                                                                                    "children": [
                                                                                                        {
                                                                                                            "type": "identifier",
                                                                                                            "label": "db_client",
                                                                                                            "start_token": 1888,
                                                                                                            "end_token": 1890,
                                                                                                            "children": []
                                                                                                        },
                                                                                                        {
                                                                                                            "type": "identifier",
                                                                                                            "label": "get_latest_execution",
                                                                                                            "start_token": 1890,
                                                                                                            "end_token": -1,
                                                                                                            "children": []
                                                                                                        }
                                                                                                    ]
                                                                                                },
                                                                                                {
                                                                                                    "type": "argument_list",
                                                                                                    "label": "(\n                    next_node_id, graph_exec_id\n                )",
                                                                                                    "start_token": -1,
                                                                                                    "end_token": -1,
                                                                                                    "children": [
                                                                                                        {
                                                                                                            "type": "identifier",
                                                                                                            "label": "next_node_id",
                                                                                                            "start_token": 1893,
                                                                                                            "end_token": 1895,
                                                                                                            "children": []
                                                                                                        },
                                                                                                        {
                                                                                                            "type": "identifier",
                                                                                                            "label": "graph_exec_id",
                                                                                                            "start_token": 1895,
                                                                                                            "end_token": -1,
                                                                                                            "children": []
                                                                                                        }
                                                                                                    ]
                                                                                                }
                                                                                            ]
                                                                                        }
                                                                                    ]
                                                                                }
                                                                            ]
                                                                        }
                                                                    ]
                                                                },
                                                                {
                                                                    "type": "block",
                                                                    "label": "for name in static_link_names:\n                    next_node_input[name] = latest_execution.input_data.get(name)",
                                                                    "start_token": 1903,
                                                                    "end_token": -1,
                                                                    "children": [
                                                                        {
                                                                            "type": "for_statement",
                                                                            "label": "for name in static_link_names:\n                    next_node_input[name] = latest_execution.input_data.get(name)",
                                                                            "start_token": 1903,
                                                                            "end_token": -1,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "name",
                                                                                    "start_token": -1,
                                                                                    "end_token": -1,
                                                                                    "children": []
                                                                                },
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "static_link_names",
                                                                                    "start_token": 1905,
                                                                                    "end_token": -1,
                                                                                    "children": []
                                                                                },
                                                                                {
                                                                                    "type": "block",
                                                                                    "label": "next_node_input[name] = latest_execution.input_data.get(name)",
                                                                                    "start_token": 1908,
                                                                                    "end_token": -1,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "expression_statement",
                                                                                            "label": "next_node_input[name] = latest_execution.input_data.get(name)",
                                                                                            "start_token": 1908,
                                                                                            "end_token": -1,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "assignment",
                                                                                                    "label": "next_node_input[name] = latest_execution.input_data.get(name)",
                                                                                                    "start_token": 1908,
                                                                                                    "end_token": -1,
                                                                                                    "children": [
                                                                                                        {
                                                                                                            "type": "subscript",
                                                                                                            "label": "next_node_input[name]",
                                                                                                            "start_token": 1908,
                                                                                                            "end_token": 1913,
                                                                                                            "children": [
                                                                                                                {
                                                                                                                    "type": "identifier",
                                                                                                                    "label": "next_node_input",
                                                                                                                    "start_token": 1908,
                                                                                                                    "end_token": 1910,
                                                                                                                    "children": []
                                                                                                                },
                                                                                                                {
                                                                                                                    "type": "identifier",
                                                                                                                    "label": "name",
                                                                                                                    "start_token": 1911,
                                                                                                                    "end_token": -1,
                                                                                                                    "children": []
                                                                                                                }
                                                                                                            ]
                                                                                                        },
                                                                                                        {
                                                                                                            "type": "call",
                                                                                                            "label": "latest_execution.input_data.get(name)",
                                                                                                            "start_token": 1913,
                                                                                                            "end_token": -1,
                                                                                                            "children": [
                                                                                                                {
                                                                                                                    "type": "attribute",
                                                                                                                    "label": "latest_execution.input_data.get",
                                                                                                                    "start_token": 1913,
                                                                                                                    "end_token": 1919,
                                                                                                                    "children": [
                                                                                                                        {
                                                                                                                            "type": "attribute",
                                                                                                                            "label": "latest_execution.input_data",
                                                                                                                            "start_token": 1913,
                                                                                                                            "end_token": 1917,
                                                                                                                            "children": [
                                                                                                                                {
                                                                                                                                    "type": "identifier",
                                                                                                                                    "label": "latest_execution",
                                                                                                                                    "start_token": 1913,
                                                                                                                                    "end_token": 1915,
                                                                                                                                    "children": []
                                                                                                                                },
                                                                                                                                {
                                                                                                                                    "type": "identifier",
                                                                                                                                    "label": "input_data",
                                                                                                                                    "start_token": 1915,
                                                                                                                                    "end_token": 1917,
                                                                                                                                    "children": []
                                                                                                                                }
                                                                                                                            ]
                                                                                                                        },
                                                                                                                        {
                                                                                                                            "type": "identifier",
                                                                                                                            "label": "get",
                                                                                                                            "start_token": 1919,
                                                                                                                            "end_token": 1919,
                                                                                                                            "children": []
                                                                                                                        }
                                                                                                                    ]
                                                                                                                },
                                                                                                                {
                                                                                                                    "type": "argument_list",
                                                                                                                    "label": "(name)",
                                                                                                                    "start_token": 1919,
                                                                                                                    "end_token": -1,
                                                                                                                    "children": [
                                                                                                                        {
                                                                                                                            "type": "identifier",
                                                                                                                            "label": "name",
                                                                                                                            "start_token": 1920,
                                                                                                                            "end_token": -1,
                                                                                                                            "children": []
                                                                                                                        }
                                                                                                                    ]
                                                                                                                }
                                                                                                            ]
                                                                                                        }
                                                                                                    ]
                                                                                                }
                                                                                            ]
                                                                                        }
                                                                                    ]
                                                                                }
                                                                            ]
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        },
                                                        {
                                                            "type": "comment",
                                                            "label": "# Validate the input data for the next node.",
                                                            "start_token": 1924,
                                                            "end_token": -1,
                                                            "children": []
                                                        },
                                                        {
                                                            "type": "expression_statement",
                                                            "label": "next_node_input, validation_msg = validate_exec(next_node, next_node_input)",
                                                            "start_token": 1934,
                                                            "end_token": -1,
                                                            "children": [
                                                                {
                                                                    "type": "assignment",
                                                                    "label": "next_node_input, validation_msg = validate_exec(next_node, next_node_input)",
                                                                    "start_token": 1934,
                                                                    "end_token": -1,
                                                                    "children": [
                                                                        {
                                                                            "type": "pattern_list",
                                                                            "label": "next_node_input, validation_msg",
                                                                            "start_token": 1934,
                                                                            "end_token": 1938,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "next_node_input",
                                                                                    "start_token": 1934,
                                                                                    "end_token": 1936,
                                                                                    "children": []
                                                                                },
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "validation_msg",
                                                                                    "start_token": 1936,
                                                                                    "end_token": 1938,
                                                                                    "children": []
                                                                                }
                                                                            ]
                                                                        },
                                                                        {
                                                                            "type": "call",
                                                                            "label": "validate_exec(next_node, next_node_input)",
                                                                            "start_token": 1938,
                                                                            "end_token": -1,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "validate_exec",
                                                                                    "start_token": 1938,
                                                                                    "end_token": 1940,
                                                                                    "children": []
                                                                                },
                                                                                {
                                                                                    "type": "argument_list",
                                                                                    "label": "(next_node, next_node_input)",
                                                                                    "start_token": 1940,
                                                                                    "end_token": -1,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "label": "next_node",
                                                                                            "start_token": 1940,
                                                                                            "end_token": 1942,
                                                                                            "children": []
                                                                                        },
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "label": "next_node_input",
                                                                                            "start_token": 1942,
                                                                                            "end_token": -1,
                                                                                            "children": []
                                                                                        }
                                                                                    ]
                                                                                }
                                                                            ]
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        },
                                                        {
                                                            "type": "expression_statement",
                                                            "label": "suffix = f\"{next_output_name}>{next_input_name}~{next_node_exec_id}:{validation_msg}\"",
                                                            "start_token": 1945,
                                                            "end_token": -1,
                                                            "children": [
                                                                {
                                                                    "type": "assignment",
                                                                    "label": "suffix = f\"{next_output_name}>{next_input_name}~{next_node_exec_id}:{validation_msg}\"",
                                                                    "start_token": 1945,
                                                                    "end_token": -1,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "suffix",
                                                                            "start_token": 1945,
                                                                            "end_token": 1947,
                                                                            "children": []
                                                                        },
                                                                        {
                                                                            "type": "string",
                                                                            "label": "f\"{next_output_name}>{next_input_name}~{next_node_exec_id}:{validation_msg}\"",
                                                                            "start_token": 1948,
                                                                            "end_token": -1,
                                                                            "children": [
                                                                                {
                                                                                    "type": "string_start",
                                                                                    "label": "f\"",
                                                                                    "start_token": 1948,
                                                                                    "end_token": 1948,
                                                                                    "children": []
                                                                                },
                                                                                {
                                                                                    "type": "interpolation",
                                                                                    "label": "{next_output_name}",
                                                                                    "start_token": 1948,
                                                                                    "end_token": 1948,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "label": "next_output_name",
                                                                                            "start_token": 1948,
                                                                                            "end_token": 1948,
                                                                                            "children": []
                                                                                        }
                                                                                    ]
                                                                                },
                                                                                {
                                                                                    "type": "string_content",
                                                                                    "label": ">",
                                                                                    "start_token": 1948,
                                                                                    "end_token": 1948,
                                                                                    "children": []
                                                                                },
                                                                                {
                                                                                    "type": "interpolation",
                                                                                    "label": "{next_input_name}",
                                                                                    "start_token": 1948,
                                                                                    "end_token": 1948,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "label": "next_input_name",
                                                                                            "start_token": 1948,
                                                                                            "end_token": 1948,
                                                                                            "children": []
                                                                                        }
                                                                                    ]
                                                                                },
                                                                                {
                                                                                    "type": "string_content",
                                                                                    "label": "~",
                                                                                    "start_token": 1948,
                                                                                    "end_token": 1948,
                                                                                    "children": []
                                                                                },
                                                                                {
                                                                                    "type": "interpolation",
                                                                                    "label": "{next_node_exec_id}",
                                                                                    "start_token": 1948,
                                                                                    "end_token": 1948,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "label": "next_node_exec_id",
                                                                                            "start_token": 1948,
                                                                                            "end_token": 1948,
                                                                                            "children": []
                                                                                        }
                                                                                    ]
                                                                                },
                                                                                {
                                                                                    "type": "string_content",
                                                                                    "label": ":",
                                                                                    "start_token": 1948,
                                                                                    "end_token": 1948,
                                                                                    "children": []
                                                                                },
                                                                                {
                                                                                    "type": "interpolation",
                                                                                    "label": "{validation_msg}",
                                                                                    "start_token": 1948,
                                                                                    "end_token": -1,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "label": "validation_msg",
                                                                                            "start_token": 1948,
                                                                                            "end_token": 1950,
                                                                                            "children": []
                                                                                        }
                                                                                    ]
                                                                                },
                                                                                {
                                                                                    "type": "string_end",
                                                                                    "label": "\"",
                                                                                    "start_token": -1,
                                                                                    "end_token": -1,
                                                                                    "children": []
                                                                                }
                                                                            ]
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        },
                                                        {
                                                            "type": "comment",
                                                            "label": "# Incomplete input data, skip queueing the execution.",
                                                            "start_token": 1952,
                                                            "end_token": -1,
                                                            "children": []
                                                        },
                                                        {
                                                            "type": "if_statement",
                                                            "label": "if not next_node_input:\n                log_metadata.warning(f\"Skipped queueing {suffix}\")\n                return enqueued_executions",
                                                            "start_token": 1963,
                                                            "end_token": -1,
                                                            "children": [
                                                                {
                                                                    "type": "not_operator",
                                                                    "label": "not next_node_input",
                                                                    "start_token": 1964,
                                                                    "end_token": -1,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "next_node_input",
                                                                            "start_token": 1964,
                                                                            "end_token": -1,
                                                                            "children": []
                                                                        }
                                                                    ]
                                                                },
                                                                {
                                                                    "type": "block",
                                                                    "label": "log_metadata.warning(f\"Skipped queueing {suffix}\")\n                return enqueued_executions",
                                                                    "start_token": 1967,
                                                                    "end_token": -1,
                                                                    "children": [
                                                                        {
                                                                            "type": "expression_statement",
                                                                            "label": "log_metadata.warning(f\"Skipped queueing {suffix}\")",
                                                                            "start_token": 1967,
                                                                            "end_token": -1,
                                                                            "children": [
                                                                                {
                                                                                    "type": "call",
                                                                                    "label": "log_metadata.warning(f\"Skipped queueing {suffix}\")",
                                                                                    "start_token": 1967,
                                                                                    "end_token": -1,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "attribute",
                                                                                            "label": "log_metadata.warning",
                                                                                            "start_token": 1967,
                                                                                            "end_token": 1972,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "label": "log_metadata",
                                                                                                    "start_token": 1967,
                                                                                                    "end_token": 1969,
                                                                                                    "children": []
                                                                                                },
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "label": "warning",
                                                                                                    "start_token": 1969,
                                                                                                    "end_token": 1972,
                                                                                                    "children": []
                                                                                                }
                                                                                            ]
                                                                                        },
                                                                                        {
                                                                                            "type": "argument_list",
                                                                                            "label": "(f\"Skipped queueing {suffix}\")",
                                                                                            "start_token": 1972,
                                                                                            "end_token": -1,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "string",
                                                                                                    "label": "f\"Skipped queueing {suffix}\"",
                                                                                                    "start_token": 1972,
                                                                                                    "end_token": -1,
                                                                                                    "children": [
                                                                                                        {
                                                                                                            "type": "string_start",
                                                                                                            "label": "f\"",
                                                                                                            "start_token": 1972,
                                                                                                            "end_token": 1972,
                                                                                                            "children": []
                                                                                                        },
                                                                                                        {
                                                                                                            "type": "string_content",
                                                                                                            "label": "Skipped queueing ",
                                                                                                            "start_token": 1972,
                                                                                                            "end_token": 1972,
                                                                                                            "children": []
                                                                                                        },
                                                                                                        {
                                                                                                            "type": "interpolation",
                                                                                                            "label": "{suffix}",
                                                                                                            "start_token": 1972,
                                                                                                            "end_token": -1,
                                                                                                            "children": [
                                                                                                                {
                                                                                                                    "type": "identifier",
                                                                                                                    "label": "suffix",
                                                                                                                    "start_token": 1972,
                                                                                                                    "end_token": 1974,
                                                                                                                    "children": []
                                                                                                                }
                                                                                                            ]
                                                                                                        },
                                                                                                        {
                                                                                                            "type": "string_end",
                                                                                                            "label": "\"",
                                                                                                            "start_token": -1,
                                                                                                            "end_token": -1,
                                                                                                            "children": []
                                                                                                        }
                                                                                                    ]
                                                                                                }
                                                                                            ]
                                                                                        }
                                                                                    ]
                                                                                }
                                                                            ]
                                                                        },
                                                                        {
                                                                            "type": "return_statement",
                                                                            "label": "return enqueued_executions",
                                                                            "start_token": 1975,
                                                                            "end_token": -1,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "enqueued_executions",
                                                                                    "start_token": 1976,
                                                                                    "end_token": -1,
                                                                                    "children": []
                                                                                }
                                                                            ]
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        },
                                                        {
                                                            "type": "comment",
                                                            "label": "# Input is complete, enqueue the execution.",
                                                            "start_token": 1980,
                                                            "end_token": -1,
                                                            "children": []
                                                        },
                                                        {
                                                            "type": "expression_statement",
                                                            "label": "log_metadata.info(f\"Enqueued {suffix}\")",
                                                            "start_token": 1989,
                                                            "end_token": -1,
                                                            "children": [
                                                                {
                                                                    "type": "call",
                                                                    "label": "log_metadata.info(f\"Enqueued {suffix}\")",
                                                                    "start_token": 1989,
                                                                    "end_token": -1,
                                                                    "children": [
                                                                        {
                                                                            "type": "attribute",
                                                                            "label": "log_metadata.info",
                                                                            "start_token": 1989,
                                                                            "end_token": 1994,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "log_metadata",
                                                                                    "start_token": 1989,
                                                                                    "end_token": 1991,
                                                                                    "children": []
                                                                                },
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "info",
                                                                                    "start_token": 1992,
                                                                                    "end_token": 1994,
                                                                                    "children": []
                                                                                }
                                                                            ]
                                                                        },
                                                                        {
                                                                            "type": "argument_list",
                                                                            "label": "(f\"Enqueued {suffix}\")",
                                                                            "start_token": 1994,
                                                                            "end_token": -1,
                                                                            "children": [
                                                                                {
                                                                                    "type": "string",
                                                                                    "label": "f\"Enqueued {suffix}\"",
                                                                                    "start_token": 1994,
                                                                                    "end_token": -1,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "string_start",
                                                                                            "label": "f\"",
                                                                                            "start_token": 1994,
                                                                                            "end_token": 1994,
                                                                                            "children": []
                                                                                        },
                                                                                        {
                                                                                            "type": "string_content",
                                                                                            "label": "Enqueued ",
                                                                                            "start_token": 1994,
                                                                                            "end_token": 1994,
                                                                                            "children": []
                                                                                        },
                                                                                        {
                                                                                            "type": "interpolation",
                                                                                            "label": "{suffix}",
                                                                                            "start_token": 1994,
                                                                                            "end_token": -1,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "label": "suffix",
                                                                                                    "start_token": 1994,
                                                                                                    "end_token": 1996,
                                                                                                    "children": []
                                                                                                }
                                                                                            ]
                                                                                        },
                                                                                        {
                                                                                            "type": "string_end",
                                                                                            "label": "\"",
                                                                                            "start_token": -1,
                                                                                            "end_token": -1,
                                                                                            "children": []
                                                                                        }
                                                                                    ]
                                                                                }
                                                                            ]
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        },
                                                        {
                                                            "type": "expression_statement",
                                                            "label": "enqueued_executions.append(\n                add_enqueued_execution(next_node_exec_id, next_node_id, next_node_input)\n            )",
                                                            "start_token": 1997,
                                                            "end_token": -1,
                                                            "children": [
                                                                {
                                                                    "type": "call",
                                                                    "label": "enqueued_executions.append(\n                add_enqueued_execution(next_node_exec_id, next_node_id, next_node_input)\n            )",
                                                                    "start_token": 1997,
                                                                    "end_token": -1,
                                                                    "children": [
                                                                        {
                                                                            "type": "attribute",
                                                                            "label": "enqueued_executions.append",
                                                                            "start_token": 1997,
                                                                            "end_token": -1,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "enqueued_executions",
                                                                                    "start_token": 1997,
                                                                                    "end_token": 1999,
                                                                                    "children": []
                                                                                },
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "append",
                                                                                    "start_token": 1999,
                                                                                    "end_token": -1,
                                                                                    "children": []
                                                                                }
                                                                            ]
                                                                        },
                                                                        {
                                                                            "type": "argument_list",
                                                                            "label": "(\n                add_enqueued_execution(next_node_exec_id, next_node_id, next_node_input)\n            )",
                                                                            "start_token": -1,
                                                                            "end_token": -1,
                                                                            "children": [
                                                                                {
                                                                                    "type": "call",
                                                                                    "label": "add_enqueued_execution(next_node_exec_id, next_node_id, next_node_input)",
                                                                                    "start_token": 2002,
                                                                                    "end_token": -1,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "label": "add_enqueued_execution",
                                                                                            "start_token": 2002,
                                                                                            "end_token": 2004,
                                                                                            "children": []
                                                                                        },
                                                                                        {
                                                                                            "type": "argument_list",
                                                                                            "label": "(next_node_exec_id, next_node_id, next_node_input)",
                                                                                            "start_token": 2004,
                                                                                            "end_token": -1,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "label": "next_node_exec_id",
                                                                                                    "start_token": 2004,
                                                                                                    "end_token": 2006,
                                                                                                    "children": []
                                                                                                },
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "label": "next_node_id",
                                                                                                    "start_token": 2006,
                                                                                                    "end_token": 2008,
                                                                                                    "children": []
                                                                                                },
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "label": "next_node_input",
                                                                                                    "start_token": 2008,
                                                                                                    "end_token": -1,
                                                                                                    "children": []
                                                                                                }
                                                                                            ]
                                                                                        }
                                                                                    ]
                                                                                }
                                                                            ]
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        },
                                                        {
                                                            "type": "comment",
                                                            "label": "# Next execution stops here if the link is not static.",
                                                            "start_token": 2015,
                                                            "end_token": -1,
                                                            "children": []
                                                        },
                                                        {
                                                            "type": "if_statement",
                                                            "label": "if not node_link.is_static:\n                return enqueued_executions",
                                                            "start_token": 2028,
                                                            "end_token": -1,
                                                            "children": [
                                                                {
                                                                    "type": "not_operator",
                                                                    "label": "not node_link.is_static",
                                                                    "start_token": 2029,
                                                                    "end_token": -1,
                                                                    "children": [
                                                                        {
                                                                            "type": "attribute",
                                                                            "label": "node_link.is_static",
                                                                            "start_token": 2029,
                                                                            "end_token": -1,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "node_link",
                                                                                    "start_token": 2029,
                                                                                    "end_token": 2031,
                                                                                    "children": []
                                                                                },
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "is_static",
                                                                                    "start_token": 2031,
                                                                                    "end_token": -1,
                                                                                    "children": []
                                                                                }
                                                                            ]
                                                                        }
                                                                    ]
                                                                },
                                                                {
                                                                    "type": "block",
                                                                    "label": "return enqueued_executions",
                                                                    "start_token": 2034,
                                                                    "end_token": -1,
                                                                    "children": [
                                                                        {
                                                                            "type": "return_statement",
                                                                            "label": "return enqueued_executions",
                                                                            "start_token": 2034,
                                                                            "end_token": -1,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "enqueued_executions",
                                                                                    "start_token": 2035,
                                                                                    "end_token": -1,
                                                                                    "children": []
                                                                                }
                                                                            ]
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        },
                                                        {
                                                            "type": "comment",
                                                            "label": "# If link is static, there could be some incomplete executions waiting for it.",
                                                            "start_token": -1,
                                                            "end_token": -1,
                                                            "children": []
                                                        },
                                                        {
                                                            "type": "comment",
                                                            "label": "# Load and complete the input missing input data, and try to re-enqueue them.",
                                                            "start_token": 2056,
                                                            "end_token": -1,
                                                            "children": []
                                                        },
                                                        {
                                                            "type": "for_statement",
                                                            "label": "for iexec in db_client.get_incomplete_executions(\n                next_node_id, graph_exec_id\n            ):\n                idata = iexec.input_data\n                ineid = iexec.node_exec_id\n\n                static_link_names = {\n                    link.sink_name\n                    for link in next_node.input_links\n                    if link.is_static and link.sink_name not in idata\n                }\n                for input_name in static_link_names:\n                    idata[input_name] = next_node_input[input_name]\n\n                idata, msg = validate_exec(next_node, idata)\n                suffix = f\"{next_output_name}>{next_input_name}~{ineid}:{msg}\"\n                if not idata:\n                    log_metadata.info(f\"Enqueueing static-link skipped: {suffix}\")\n                    continue\n                log_metadata.info(f\"Enqueueing static-link execution {suffix}\")\n                enqueued_executions.append(\n                    add_enqueued_execution(iexec.node_exec_id, next_node_id, idata)\n                )",
                                                            "start_token": 2075,
                                                            "end_token": -1,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "label": "iexec",
                                                                    "start_token": 2075,
                                                                    "end_token": -1,
                                                                    "children": []
                                                                },
                                                                {
                                                                    "type": "call",
                                                                    "label": "db_client.get_incomplete_executions(\n                next_node_id, graph_exec_id\n            )",
                                                                    "start_token": 2077,
                                                                    "end_token": -1,
                                                                    "children": [
                                                                        {
                                                                            "type": "attribute",
                                                                            "label": "db_client.get_incomplete_executions",
                                                                            "start_token": 2077,
                                                                            "end_token": -1,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "db_client",
                                                                                    "start_token": 2077,
                                                                                    "end_token": 2079,
                                                                                    "children": []
                                                                                },
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "get_incomplete_executions",
                                                                                    "start_token": 2079,
                                                                                    "end_token": -1,
                                                                                    "children": []
                                                                                }
                                                                            ]
                                                                        },
                                                                        {
                                                                            "type": "argument_list",
                                                                            "label": "(\n                next_node_id, graph_exec_id\n            )",
                                                                            "start_token": -1,
                                                                            "end_token": -1,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "next_node_id",
                                                                                    "start_token": 2082,
                                                                                    "end_token": 2084,
                                                                                    "children": []
                                                                                },
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "graph_exec_id",
                                                                                    "start_token": 2084,
                                                                                    "end_token": -1,
                                                                                    "children": []
                                                                                }
                                                                            ]
                                                                        }
                                                                    ]
                                                                },
                                                                {
                                                                    "type": "block",
                                                                    "label": "idata = iexec.input_data\n                ineid = iexec.node_exec_id\n\n                static_link_names = {\n                    link.sink_name\n                    for link in next_node.input_links\n                    if link.is_static and link.sink_name not in idata\n                }\n                for input_name in static_link_names:\n                    idata[input_name] = next_node_input[input_name]\n\n                idata, msg = validate_exec(next_node, idata)\n                suffix = f\"{next_output_name}>{next_input_name}~{ineid}:{msg}\"\n                if not idata:\n                    log_metadata.info(f\"Enqueueing static-link skipped: {suffix}\")\n                    continue\n                log_metadata.info(f\"Enqueueing static-link execution {suffix}\")\n                enqueued_executions.append(\n                    add_enqueued_execution(iexec.node_exec_id, next_node_id, idata)\n                )",
                                                                    "start_token": 2089,
                                                                    "end_token": -1,
                                                                    "children": [
                                                                        {
                                                                            "type": "expression_statement",
                                                                            "label": "idata = iexec.input_data",
                                                                            "start_token": 2089,
                                                                            "end_token": -1,
                                                                            "children": [
                                                                                {
                                                                                    "type": "assignment",
                                                                                    "label": "idata = iexec.input_data",
                                                                                    "start_token": 2089,
                                                                                    "end_token": -1,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "label": "idata",
                                                                                            "start_token": 2089,
                                                                                            "end_token": 2091,
                                                                                            "children": []
                                                                                        },
                                                                                        {
                                                                                            "type": "attribute",
                                                                                            "label": "iexec.input_data",
                                                                                            "start_token": 2091,
                                                                                            "end_token": -1,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "label": "iexec",
                                                                                                    "start_token": 2091,
                                                                                                    "end_token": 2093,
                                                                                                    "children": []
                                                                                                },
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "label": "input_data",
                                                                                                    "start_token": 2093,
                                                                                                    "end_token": -1,
                                                                                                    "children": []
                                                                                                }
                                                                                            ]
                                                                                        }
                                                                                    ]
                                                                                }
                                                                            ]
                                                                        },
                                                                        {
                                                                            "type": "expression_statement",
                                                                            "label": "ineid = iexec.node_exec_id",
                                                                            "start_token": 2095,
                                                                            "end_token": -1,
                                                                            "children": [
                                                                                {
                                                                                    "type": "assignment",
                                                                                    "label": "ineid = iexec.node_exec_id",
                                                                                    "start_token": 2095,
                                                                                    "end_token": -1,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "label": "ineid",
                                                                                            "start_token": 2095,
                                                                                            "end_token": 2097,
                                                                                            "children": []
                                                                                        },
                                                                                        {
                                                                                            "type": "attribute",
                                                                                            "label": "iexec.node_exec_id",
                                                                                            "start_token": 2097,
                                                                                            "end_token": -1,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "label": "iexec",
                                                                                                    "start_token": 2097,
                                                                                                    "end_token": 2099,
                                                                                                    "children": []
                                                                                                },
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "label": "node_exec_id",
                                                                                                    "start_token": 2099,
                                                                                                    "end_token": -1,
                                                                                                    "children": []
                                                                                                }
                                                                                            ]
                                                                                        }
                                                                                    ]
                                                                                }
                                                                            ]
                                                                        },
                                                                        {
                                                                            "type": "expression_statement",
                                                                            "label": "static_link_names = {\n                    link.sink_name\n                    for link in next_node.input_links\n                    if link.is_static and link.sink_name not in idata\n                }",
                                                                            "start_token": 2102,
                                                                            "end_token": -1,
                                                                            "children": [
                                                                                {
                                                                                    "type": "assignment",
                                                                                    "label": "static_link_names = {\n                    link.sink_name\n                    for link in next_node.input_links\n                    if link.is_static and link.sink_name not in idata\n                }",
                                                                                    "start_token": 2102,
                                                                                    "end_token": -1,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "label": "static_link_names",
                                                                                            "start_token": 2102,
                                                                                            "end_token": 2104,
                                                                                            "children": []
                                                                                        },
                                                                                        {
                                                                                            "type": "set_comprehension",
                                                                                            "label": "{\n                    link.sink_name\n                    for link in next_node.input_links\n                    if link.is_static and link.sink_name not in idata\n                }",
                                                                                            "start_token": -1,
                                                                                            "end_token": -1,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "attribute",
                                                                                                    "label": "link.sink_name",
                                                                                                    "start_token": 2107,
                                                                                                    "end_token": -1,
                                                                                                    "children": [
                                                                                                        {
                                                                                                            "type": "identifier",
                                                                                                            "label": "link",
                                                                                                            "start_token": 2107,
                                                                                                            "end_token": 2108,
                                                                                                            "children": []
                                                                                                        },
                                                                                                        {
                                                                                                            "type": "identifier",
                                                                                                            "label": "sink_name",
                                                                                                            "start_token": 2108,
                                                                                                            "end_token": -1,
                                                                                                            "children": []
                                                                                                        }
                                                                                                    ]
                                                                                                },
                                                                                                {
                                                                                                    "type": "for_in_clause",
                                                                                                    "label": "for link in next_node.input_links",
                                                                                                    "start_token": 2111,
                                                                                                    "end_token": -1,
                                                                                                    "children": [
                                                                                                        {
                                                                                                            "type": "identifier",
                                                                                                            "label": "link",
                                                                                                            "start_token": -1,
                                                                                                            "end_token": -1,
                                                                                                            "children": []
                                                                                                        },
                                                                                                        {
                                                                                                            "type": "attribute",
                                                                                                            "label": "next_node.input_links",
                                                                                                            "start_token": 2113,
                                                                                                            "end_token": -1,
                                                                                                            "children": [
                                                                                                                {
                                                                                                                    "type": "identifier",
                                                                                                                    "label": "next_node",
                                                                                                                    "start_token": 2113,
                                                                                                                    "end_token": 2115,
                                                                                                                    "children": []
                                                                                                                },
                                                                                                                {
                                                                                                                    "type": "identifier",
                                                                                                                    "label": "input_links",
                                                                                                                    "start_token": 2115,
                                                                                                                    "end_token": -1,
                                                                                                                    "children": []
                                                                                                                }
                                                                                                            ]
                                                                                                        }
                                                                                                    ]
                                                                                                },
                                                                                                {
                                                                                                    "type": "if_clause",
                                                                                                    "label": "if link.is_static and link.sink_name not in idata",
                                                                                                    "start_token": 2118,
                                                                                                    "end_token": -1,
                                                                                                    "children": [
                                                                                                        {
                                                                                                            "type": "boolean_operator",
                                                                                                            "label": "link.is_static and link.sink_name not in idata",
                                                                                                            "start_token": 2119,
                                                                                                            "end_token": -1,
                                                                                                            "children": [
                                                                                                                {
                                                                                                                    "type": "attribute",
                                                                                                                    "label": "link.is_static",
                                                                                                                    "start_token": 2119,
                                                                                                                    "end_token": 2121,
                                                                                                                    "children": [
                                                                                                                        {
                                                                                                                            "type": "identifier",
                                                                                                                            "label": "link",
                                                                                                                            "start_token": 2119,
                                                                                                                            "end_token": 2120,
                                                                                                                            "children": []
                                                                                                                        },
                                                                                                                        {
                                                                                                                            "type": "identifier",
                                                                                                                            "label": "is_static",
                                                                                                                            "start_token": 2120,
                                                                                                                            "end_token": 2121,
                                                                                                                            "children": []
                                                                                                                        }
                                                                                                                    ]
                                                                                                                },
                                                                                                                {
                                                                                                                    "type": "comparison_operator",
                                                                                                                    "label": "link.sink_name not in idata",
                                                                                                                    "start_token": 2123,
                                                                                                                    "end_token": -1,
                                                                                                                    "children": [
                                                                                                                        {
                                                                                                                            "type": "attribute",
                                                                                                                            "label": "link.sink_name",
                                                                                                                            "start_token": 2123,
                                                                                                                            "end_token": 2125,
                                                                                                                            "children": [
                                                                                                                                {
                                                                                                                                    "type": "identifier",
                                                                                                                                    "label": "link",
                                                                                                                                    "start_token": 2123,
                                                                                                                                    "end_token": 2124,
                                                                                                                                    "children": []
                                                                                                                                },
                                                                                                                                {
                                                                                                                                    "type": "identifier",
                                                                                                                                    "label": "sink_name",
                                                                                                                                    "start_token": 2124,
                                                                                                                                    "end_token": 2125,
                                                                                                                                    "children": []
                                                                                                                                }
                                                                                                                            ]
                                                                                                                        },
                                                                                                                        {
                                                                                                                            "type": "identifier",
                                                                                                                            "label": "idata",
                                                                                                                            "start_token": 2127,
                                                                                                                            "end_token": -1,
                                                                                                                            "children": []
                                                                                                                        }
                                                                                                                    ]
                                                                                                                }
                                                                                                            ]
                                                                                                        }
                                                                                                    ]
                                                                                                }
                                                                                            ]
                                                                                        }
                                                                                    ]
                                                                                }
                                                                            ]
                                                                        },
                                                                        {
                                                                            "type": "for_statement",
                                                                            "label": "for input_name in static_link_names:\n                    idata[input_name] = next_node_input[input_name]",
                                                                            "start_token": 2132,
                                                                            "end_token": -1,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "input_name",
                                                                                    "start_token": 2132,
                                                                                    "end_token": -1,
                                                                                    "children": []
                                                                                },
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "static_link_names",
                                                                                    "start_token": 2134,
                                                                                    "end_token": -1,
                                                                                    "children": []
                                                                                },
                                                                                {
                                                                                    "type": "block",
                                                                                    "label": "idata[input_name] = next_node_input[input_name]",
                                                                                    "start_token": 2137,
                                                                                    "end_token": -1,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "expression_statement",
                                                                                            "label": "idata[input_name] = next_node_input[input_name]",
                                                                                            "start_token": 2137,
                                                                                            "end_token": -1,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "assignment",
                                                                                                    "label": "idata[input_name] = next_node_input[input_name]",
                                                                                                    "start_token": 2137,
                                                                                                    "end_token": -1,
                                                                                                    "children": [
                                                                                                        {
                                                                                                            "type": "subscript",
                                                                                                            "label": "idata[input_name]",
                                                                                                            "start_token": 2137,
                                                                                                            "end_token": 2142,
                                                                                                            "children": [
                                                                                                                {
                                                                                                                    "type": "identifier",
                                                                                                                    "label": "idata",
                                                                                                                    "start_token": 2137,
                                                                                                                    "end_token": 2139,
                                                                                                                    "children": []
                                                                                                                },
                                                                                                                {
                                                                                                                    "type": "identifier",
                                                                                                                    "label": "input_name",
                                                                                                                    "start_token": 2139,
                                                                                                                    "end_token": -1,
                                                                                                                    "children": []
                                                                                                                }
                                                                                                            ]
                                                                                                        },
                                                                                                        {
                                                                                                            "type": "subscript",
                                                                                                            "label": "next_node_input[input_name]",
                                                                                                            "start_token": 2142,
                                                                                                            "end_token": -1,
                                                                                                            "children": [
                                                                                                                {
                                                                                                                    "type": "identifier",
                                                                                                                    "label": "next_node_input",
                                                                                                                    "start_token": 2142,
                                                                                                                    "end_token": 2144,
                                                                                                                    "children": []
                                                                                                                },
                                                                                                                {
                                                                                                                    "type": "identifier",
                                                                                                                    "label": "input_name",
                                                                                                                    "start_token": 2144,
                                                                                                                    "end_token": -1,
                                                                                                                    "children": []
                                                                                                                }
                                                                                                            ]
                                                                                                        }
                                                                                                    ]
                                                                                                }
                                                                                            ]
                                                                                        }
                                                                                    ]
                                                                                }
                                                                            ]
                                                                        },
                                                                        {
                                                                            "type": "expression_statement",
                                                                            "label": "idata, msg = validate_exec(next_node, idata)",
                                                                            "start_token": 2148,
                                                                            "end_token": -1,
                                                                            "children": [
                                                                                {
                                                                                    "type": "assignment",
                                                                                    "label": "idata, msg = validate_exec(next_node, idata)",
                                                                                    "start_token": 2148,
                                                                                    "end_token": -1,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "pattern_list",
                                                                                            "label": "idata, msg",
                                                                                            "start_token": 2148,
                                                                                            "end_token": 2152,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "label": "idata",
                                                                                                    "start_token": 2148,
                                                                                                    "end_token": 2150,
                                                                                                    "children": []
                                                                                                },
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "label": "msg",
                                                                                                    "start_token": 2151,
                                                                                                    "end_token": 2152,
                                                                                                    "children": []
                                                                                                }
                                                                                            ]
                                                                                        },
                                                                                        {
                                                                                            "type": "call",
                                                                                            "label": "validate_exec(next_node, idata)",
                                                                                            "start_token": 2152,
                                                                                            "end_token": -1,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "label": "validate_exec",
                                                                                                    "start_token": 2152,
                                                                                                    "end_token": 2154,
                                                                                                    "children": []
                                                                                                },
                                                                                                {
                                                                                                    "type": "argument_list",
                                                                                                    "label": "(next_node, idata)",
                                                                                                    "start_token": 2154,
                                                                                                    "end_token": -1,
                                                                                                    "children": [
                                                                                                        {
                                                                                                            "type": "identifier",
                                                                                                            "label": "next_node",
                                                                                                            "start_token": 2154,
                                                                                                            "end_token": 2156,
                                                                                                            "children": []
                                                                                                        },
                                                                                                        {
                                                                                                            "type": "identifier",
                                                                                                            "label": "idata",
                                                                                                            "start_token": 2156,
                                                                                                            "end_token": -1,
                                                                                                            "children": []
                                                                                                        }
                                                                                                    ]
                                                                                                }
                                                                                            ]
                                                                                        }
                                                                                    ]
                                                                                }
                                                                            ]
                                                                        },
                                                                        {
                                                                            "type": "expression_statement",
                                                                            "label": "suffix = f\"{next_output_name}>{next_input_name}~{ineid}:{msg}\"",
                                                                            "start_token": 2159,
                                                                            "end_token": -1,
                                                                            "children": [
                                                                                {
                                                                                    "type": "assignment",
                                                                                    "label": "suffix = f\"{next_output_name}>{next_input_name}~{ineid}:{msg}\"",
                                                                                    "start_token": 2159,
                                                                                    "end_token": -1,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "label": "suffix",
                                                                                            "start_token": 2159,
                                                                                            "end_token": 2161,
                                                                                            "children": []
                                                                                        },
                                                                                        {
                                                                                            "type": "string",
                                                                                            "label": "f\"{next_output_name}>{next_input_name}~{ineid}:{msg}\"",
                                                                                            "start_token": 2162,
                                                                                            "end_token": -1,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "string_start",
                                                                                                    "label": "f\"",
                                                                                                    "start_token": 2162,
                                                                                                    "end_token": 2162,
                                                                                                    "children": []
                                                                                                },
                                                                                                {
                                                                                                    "type": "interpolation",
                                                                                                    "label": "{next_output_name}",
                                                                                                    "start_token": 2162,
                                                                                                    "end_token": 2162,
                                                                                                    "children": [
                                                                                                        {
                                                                                                            "type": "identifier",
                                                                                                            "label": "next_output_name",
                                                                                                            "start_token": 2162,
                                                                                                            "end_token": 2162,
                                                                                                            "children": []
                                                                                                        }
                                                                                                    ]
                                                                                                },
                                                                                                {
                                                                                                    "type": "string_content",
                                                                                                    "label": ">",
                                                                                                    "start_token": 2162,
                                                                                                    "end_token": 2162,
                                                                                                    "children": []
                                                                                                },
                                                                                                {
                                                                                                    "type": "interpolation",
                                                                                                    "label": "{next_input_name}",
                                                                                                    "start_token": 2162,
                                                                                                    "end_token": 2162,
                                                                                                    "children": [
                                                                                                        {
                                                                                                            "type": "identifier",
                                                                                                            "label": "next_input_name",
                                                                                                            "start_token": 2162,
                                                                                                            "end_token": 2162,
                                                                                                            "children": []
                                                                                                        }
                                                                                                    ]
                                                                                                },
                                                                                                {
                                                                                                    "type": "string_content",
                                                                                                    "label": "~",
                                                                                                    "start_token": 2162,
                                                                                                    "end_token": 2162,
                                                                                                    "children": []
                                                                                                },
                                                                                                {
                                                                                                    "type": "interpolation",
                                                                                                    "label": "{ineid}",
                                                                                                    "start_token": 2162,
                                                                                                    "end_token": 2162,
                                                                                                    "children": [
                                                                                                        {
                                                                                                            "type": "identifier",
                                                                                                            "label": "ineid",
                                                                                                            "start_token": 2162,
                                                                                                            "end_token": 2162,
                                                                                                            "children": []
                                                                                                        }
                                                                                                    ]
                                                                                                },
                                                                                                {
                                                                                                    "type": "string_content",
                                                                                                    "label": ":",
                                                                                                    "start_token": 2162,
                                                                                                    "end_token": 2162,
                                                                                                    "children": []
                                                                                                },
                                                                                                {
                                                                                                    "type": "interpolation",
                                                                                                    "label": "{msg}",
                                                                                                    "start_token": 2162,
                                                                                                    "end_token": -1,
                                                                                                    "children": [
                                                                                                        {
                                                                                                            "type": "identifier",
                                                                                                            "label": "msg",
                                                                                                            "start_token": 2162,
                                                                                                            "end_token": -1,
                                                                                                            "children": []
                                                                                                        }
                                                                                                    ]
                                                                                                },
                                                                                                {
                                                                                                    "type": "string_end",
                                                                                                    "label": "\"",
                                                                                                    "start_token": -1,
                                                                                                    "end_token": -1,
                                                                                                    "children": []
                                                                                                }
                                                                                            ]
                                                                                        }
                                                                                    ]
                                                                                }
                                                                            ]
                                                                        },
                                                                        {
                                                                            "type": "if_statement",
                                                                            "label": "if not idata:\n                    log_metadata.info(f\"Enqueueing static-link skipped: {suffix}\")\n                    continue",
                                                                            "start_token": 2165,
                                                                            "end_token": -1,
                                                                            "children": [
                                                                                {
                                                                                    "type": "not_operator",
                                                                                    "label": "not idata",
                                                                                    "start_token": 2166,
                                                                                    "end_token": -1,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "label": "idata",
                                                                                            "start_token": 2166,
                                                                                            "end_token": -1,
                                                                                            "children": []
                                                                                        }
                                                                                    ]
                                                                                },
                                                                                {
                                                                                    "type": "block",
                                                                                    "label": "log_metadata.info(f\"Enqueueing static-link skipped: {suffix}\")\n                    continue",
                                                                                    "start_token": 2169,
                                                                                    "end_token": -1,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "expression_statement",
                                                                                            "label": "log_metadata.info(f\"Enqueueing static-link skipped: {suffix}\")",
                                                                                            "start_token": 2169,
                                                                                            "end_token": -1,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "call",
                                                                                                    "label": "log_metadata.info(f\"Enqueueing static-link skipped: {suffix}\")",
                                                                                                    "start_token": 2169,
                                                                                                    "end_token": -1,
                                                                                                    "children": [
                                                                                                        {
                                                                                                            "type": "attribute",
                                                                                                            "label": "log_metadata.info",
                                                                                                            "start_token": 2169,
                                                                                                            "end_token": 2174,
                                                                                                            "children": [
                                                                                                                {
                                                                                                                    "type": "identifier",
                                                                                                                    "label": "log_metadata",
                                                                                                                    "start_token": 2169,
                                                                                                                    "end_token": 2171,
                                                                                                                    "children": []
                                                                                                                },
                                                                                                                {
                                                                                                                    "type": "identifier",
                                                                                                                    "label": "info",
                                                                                                                    "start_token": 2172,
                                                                                                                    "end_token": 2174,
                                                                                                                    "children": []
                                                                                                                }
                                                                                                            ]
                                                                                                        },
                                                                                                        {
                                                                                                            "type": "argument_list",
                                                                                                            "label": "(f\"Enqueueing static-link skipped: {suffix}\")",
                                                                                                            "start_token": 2174,
                                                                                                            "end_token": -1,
                                                                                                            "children": [
                                                                                                                {
                                                                                                                    "type": "string",
                                                                                                                    "label": "f\"Enqueueing static-link skipped: {suffix}\"",
                                                                                                                    "start_token": 2174,
                                                                                                                    "end_token": -1,
                                                                                                                    "children": [
                                                                                                                        {
                                                                                                                            "type": "string_start",
                                                                                                                            "label": "f\"",
                                                                                                                            "start_token": 2174,
                                                                                                                            "end_token": 2174,
                                                                                                                            "children": []
                                                                                                                        },
                                                                                                                        {
                                                                                                                            "type": "string_content",
                                                                                                                            "label": "Enqueueing static-link skipped: ",
                                                                                                                            "start_token": 2174,
                                                                                                                            "end_token": 2174,
                                                                                                                            "children": []
                                                                                                                        },
                                                                                                                        {
                                                                                                                            "type": "interpolation",
                                                                                                                            "label": "{suffix}",
                                                                                                                            "start_token": 2174,
                                                                                                                            "end_token": -1,
                                                                                                                            "children": [
                                                                                                                                {
                                                                                                                                    "type": "identifier",
                                                                                                                                    "label": "suffix",
                                                                                                                                    "start_token": 2174,
                                                                                                                                    "end_token": 2176,
                                                                                                                                    "children": []
                                                                                                                                }
                                                                                                                            ]
                                                                                                                        },
                                                                                                                        {
                                                                                                                            "type": "string_end",
                                                                                                                            "label": "\"",
                                                                                                                            "start_token": -1,
                                                                                                                            "end_token": -1,
                                                                                                                            "children": []
                                                                                                                        }
                                                                                                                    ]
                                                                                                                }
                                                                                                            ]
                                                                                                        }
                                                                                                    ]
                                                                                                }
                                                                                            ]
                                                                                        },
                                                                                        {
                                                                                            "type": "continue_statement",
                                                                                            "label": "continue",
                                                                                            "start_token": 2177,
                                                                                            "end_token": -1,
                                                                                            "children": []
                                                                                        }
                                                                                    ]
                                                                                }
                                                                            ]
                                                                        },
                                                                        {
                                                                            "type": "expression_statement",
                                                                            "label": "log_metadata.info(f\"Enqueueing static-link execution {suffix}\")",
                                                                            "start_token": 2179,
                                                                            "end_token": -1,
                                                                            "children": [
                                                                                {
                                                                                    "type": "call",
                                                                                    "label": "log_metadata.info(f\"Enqueueing static-link execution {suffix}\")",
                                                                                    "start_token": 2179,
                                                                                    "end_token": -1,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "attribute",
                                                                                            "label": "log_metadata.info",
                                                                                            "start_token": 2179,
                                                                                            "end_token": 2184,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "label": "log_metadata",
                                                                                                    "start_token": 2179,
                                                                                                    "end_token": 2181,
                                                                                                    "children": []
                                                                                                },
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "label": "info",
                                                                                                    "start_token": 2182,
                                                                                                    "end_token": 2184,
                                                                                                    "children": []
                                                                                                }
                                                                                            ]
                                                                                        },
                                                                                        {
                                                                                            "type": "argument_list",
                                                                                            "label": "(f\"Enqueueing static-link execution {suffix}\")",
                                                                                            "start_token": 2184,
                                                                                            "end_token": -1,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "string",
                                                                                                    "label": "f\"Enqueueing static-link execution {suffix}\"",
                                                                                                    "start_token": 2184,
                                                                                                    "end_token": -1,
                                                                                                    "children": [
                                                                                                        {
                                                                                                            "type": "string_start",
                                                                                                            "label": "f\"",
                                                                                                            "start_token": 2184,
                                                                                                            "end_token": 2184,
                                                                                                            "children": []
                                                                                                        },
                                                                                                        {
                                                                                                            "type": "string_content",
                                                                                                            "label": "Enqueueing static-link execution ",
                                                                                                            "start_token": 2184,
                                                                                                            "end_token": 2184,
                                                                                                            "children": []
                                                                                                        },
                                                                                                        {
                                                                                                            "type": "interpolation",
                                                                                                            "label": "{suffix}",
                                                                                                            "start_token": 2184,
                                                                                                            "end_token": -1,
                                                                                                            "children": [
                                                                                                                {
                                                                                                                    "type": "identifier",
                                                                                                                    "label": "suffix",
                                                                                                                    "start_token": 2184,
                                                                                                                    "end_token": 2186,
                                                                                                                    "children": []
                                                                                                                }
                                                                                                            ]
                                                                                                        },
                                                                                                        {
                                                                                                            "type": "string_end",
                                                                                                            "label": "\"",
                                                                                                            "start_token": -1,
                                                                                                            "end_token": -1,
                                                                                                            "children": []
                                                                                                        }
                                                                                                    ]
                                                                                                }
                                                                                            ]
                                                                                        }
                                                                                    ]
                                                                                }
                                                                            ]
                                                                        },
                                                                        {
                                                                            "type": "expression_statement",
                                                                            "label": "enqueued_executions.append(\n                    add_enqueued_execution(iexec.node_exec_id, next_node_id, idata)\n                )",
                                                                            "start_token": 2187,
                                                                            "end_token": -1,
                                                                            "children": [
                                                                                {
                                                                                    "type": "call",
                                                                                    "label": "enqueued_executions.append(\n                    add_enqueued_execution(iexec.node_exec_id, next_node_id, idata)\n                )",
                                                                                    "start_token": 2187,
                                                                                    "end_token": -1,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "attribute",
                                                                                            "label": "enqueued_executions.append",
                                                                                            "start_token": 2187,
                                                                                            "end_token": -1,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "label": "enqueued_executions",
                                                                                                    "start_token": 2187,
                                                                                                    "end_token": 2189,
                                                                                                    "children": []
                                                                                                },
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "label": "append",
                                                                                                    "start_token": 2189,
                                                                                                    "end_token": -1,
                                                                                                    "children": []
                                                                                                }
                                                                                            ]
                                                                                        },
                                                                                        {
                                                                                            "type": "argument_list",
                                                                                            "label": "(\n                    add_enqueued_execution(iexec.node_exec_id, next_node_id, idata)\n                )",
                                                                                            "start_token": -1,
                                                                                            "end_token": -1,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "call",
                                                                                                    "label": "add_enqueued_execution(iexec.node_exec_id, next_node_id, idata)",
                                                                                                    "start_token": 2192,
                                                                                                    "end_token": -1,
                                                                                                    "children": [
                                                                                                        {
                                                                                                            "type": "identifier",
                                                                                                            "label": "add_enqueued_execution",
                                                                                                            "start_token": 2192,
                                                                                                            "end_token": 2194,
                                                                                                            "children": []
                                                                                                        },
                                                                                                        {
                                                                                                            "type": "argument_list",
                                                                                                            "label": "(iexec.node_exec_id, next_node_id, idata)",
                                                                                                            "start_token": 2194,
                                                                                                            "end_token": -1,
                                                                                                            "children": [
                                                                                                                {
                                                                                                                    "type": "attribute",
                                                                                                                    "label": "iexec.node_exec_id",
                                                                                                                    "start_token": 2194,
                                                                                                                    "end_token": 2198,
                                                                                                                    "children": [
                                                                                                                        {
                                                                                                                            "type": "identifier",
                                                                                                                            "label": "iexec",
                                                                                                                            "start_token": 2194,
                                                                                                                            "end_token": 2196,
                                                                                                                            "children": []
                                                                                                                        },
                                                                                                                        {
                                                                                                                            "type": "identifier",
                                                                                                                            "label": "node_exec_id",
                                                                                                                            "start_token": 2196,
                                                                                                                            "end_token": 2198,
                                                                                                                            "children": []
                                                                                                                        }
                                                                                                                    ]
                                                                                                                },
                                                                                                                {
                                                                                                                    "type": "identifier",
                                                                                                                    "label": "next_node_id",
                                                                                                                    "start_token": 2198,
                                                                                                                    "end_token": 2200,
                                                                                                                    "children": []
                                                                                                                },
                                                                                                                {
                                                                                                                    "type": "identifier",
                                                                                                                    "label": "idata",
                                                                                                                    "start_token": 2200,
                                                                                                                    "end_token": -1,
                                                                                                                    "children": []
                                                                                                                }
                                                                                                            ]
                                                                                                        }
                                                                                                    ]
                                                                                                }
                                                                                            ]
                                                                                        }
                                                                                    ]
                                                                                }
                                                                            ]
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        },
                                                        {
                                                            "type": "return_statement",
                                                            "label": "return enqueued_executions",
                                                            "start_token": 2205,
                                                            "end_token": -1,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "label": "enqueued_executions",
                                                                    "start_token": 2206,
                                                                    "end_token": -1,
                                                                    "children": []
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                }
                                            ]
                                        }
                                    ]
                                }
                            ]
                        },
                        {
                            "type": "return_statement",
                            "label": "return [\n        execution\n        for link in node.output_links\n        for execution in register_next_executions(link)\n    ]",
                            "start_token": 2209,
                            "end_token": 2233,
                            "children": [
                                {
                                    "type": "list_comprehension",
                                    "label": "[\n        execution\n        for link in node.output_links\n        for execution in register_next_executions(link)\n    ]",
                                    "start_token": -1,
                                    "end_token": 2233,
                                    "children": [
                                        {
                                            "type": "identifier",
                                            "label": "execution",
                                            "start_token": 2212,
                                            "end_token": -1,
                                            "children": []
                                        },
                                        {
                                            "type": "for_in_clause",
                                            "label": "for link in node.output_links",
                                            "start_token": 2215,
                                            "end_token": -1,
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "label": "link",
                                                    "start_token": -1,
                                                    "end_token": -1,
                                                    "children": []
                                                },
                                                {
                                                    "type": "attribute",
                                                    "label": "node.output_links",
                                                    "start_token": 2218,
                                                    "end_token": -1,
                                                    "children": [
                                                        {
                                                            "type": "identifier",
                                                            "label": "node",
                                                            "start_token": 2218,
                                                            "end_token": 2219,
                                                            "children": []
                                                        },
                                                        {
                                                            "type": "identifier",
                                                            "label": "output_links",
                                                            "start_token": 2219,
                                                            "end_token": -1,
                                                            "children": []
                                                        }
                                                    ]
                                                }
                                            ]
                                        },
                                        {
                                            "type": "for_in_clause",
                                            "label": "for execution in register_next_executions(link)",
                                            "start_token": 2222,
                                            "end_token": -1,
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "label": "execution",
                                                    "start_token": 2222,
                                                    "end_token": -1,
                                                    "children": []
                                                },
                                                {
                                                    "type": "call",
                                                    "label": "register_next_executions(link)",
                                                    "start_token": 2224,
                                                    "end_token": -1,
                                                    "children": [
                                                        {
                                                            "type": "identifier",
                                                            "label": "register_next_executions",
                                                            "start_token": 2224,
                                                            "end_token": 2226,
                                                            "children": []
                                                        },
                                                        {
                                                            "type": "argument_list",
                                                            "label": "(link)",
                                                            "start_token": 2226,
                                                            "end_token": -1,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "label": "link",
                                                                    "start_token": 2227,
                                                                    "end_token": -1,
                                                                    "children": []
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                }
                                            ]
                                        }
                                    ]
                                }
                            ]
                        }
                    ]
                }
            ]
        },
        {
            "type": "function_definition",
            "label": "def validate_exec(\n    node: Node,\n    data: BlockInput,\n    resolve_input: bool = True,\n) -> tuple[BlockInput | None, str]:\n    \"\"\"\n    Validate the input data for a node execution.\n\n    Args:\n        node: The node to execute.\n        data: The input data for the node execution.\n        resolve_input: Whether to resolve dynamic pins into dict/list/object.\n\n    Returns:\n        A tuple of the validated data and the block name.\n        If the data is invalid, the first element will be None, and the second element\n        will be an error message.\n        If the data is valid, the first element will be the resolved input data, and\n        the second element will be the block name.\n    \"\"\"\n    node_block: Block | None = get_block(node.block_id)\n    if not node_block:\n        return None, f\"Block for {node.block_id} not found.\"\n\n    if isinstance(node_block, AgentExecutorBlock):\n        # Validate the execution metadata for the agent executor block.\n        try:\n            exec_data = AgentExecutorBlock.Input(**node.input_default)\n        except Exception as e:\n            return None, f\"Input data doesn't match {node_block.name}: {str(e)}\"\n\n        # Validation input\n        input_schema = exec_data.input_schema\n        required_fields = set(input_schema[\"required\"])\n        input_default = exec_data.data\n    else:\n        # Convert non-matching data types to the expected input schema.\n        for name, data_type in node_block.input_schema.__annotations__.items():\n            if (value := data.get(name)) and (type(value) is not data_type):\n                data[name] = convert(value, data_type)\n\n        # Validation input\n        input_schema = node_block.input_schema.jsonschema()\n        required_fields = node_block.input_schema.get_required_fields()\n        input_default = node.input_default\n\n    # Input data (without default values) should contain all required fields.\n    error_prefix = f\"Input data missing or mismatch for `{node_block.name}`:\"\n    input_fields_from_nodes = {link.sink_name for link in node.input_links}\n    if not input_fields_from_nodes.issubset(data):\n        return None, f\"{error_prefix} {input_fields_from_nodes - set(data)}\"\n\n    # Merge input data with default values and resolve dynamic dict/list/object pins.\n    data = {**input_default, **data}\n    if resolve_input:\n        data = merge_execution_input(data)\n\n    # Input data post-merge should contain all required fields from the schema.\n    if not required_fields.issubset(data):\n        return None, f\"{error_prefix} {required_fields - set(data)}\"\n\n    # Last validation: Validate the input values against the schema.\n    if error := json.validate_with_jsonschema(schema=input_schema, data=data):\n        error_message = f\"{error_prefix} {error}\"\n        logger.error(error_message)\n        return None, error_message\n\n    return data, node_block.name",
            "start_token": 2234,
            "end_token": 2657,
            "children": [
                {
                    "type": "identifier",
                    "label": "validate_exec",
                    "start_token": 2234,
                    "end_token": -1,
                    "children": []
                },
                {
                    "type": "parameters",
                    "label": "(\n    node: Node,\n    data: BlockInput,\n    resolve_input: bool = True,\n)",
                    "start_token": -1,
                    "end_token": -1,
                    "children": [
                        {
                            "type": "typed_parameter",
                            "label": "node: Node",
                            "start_token": 2238,
                            "end_token": -1,
                            "children": [
                                {
                                    "type": "identifier",
                                    "label": "node",
                                    "start_token": 2238,
                                    "end_token": 2239,
                                    "children": []
                                },
                                {
                                    "type": "type",
                                    "label": "Node",
                                    "start_token": 2240,
                                    "end_token": -1,
                                    "children": [
                                        {
                                            "type": "identifier",
                                            "label": "Node",
                                            "start_token": 2240,
                                            "end_token": -1,
                                            "children": []
                                        }
                                    ]
                                }
                            ]
                        },
                        {
                            "type": "typed_parameter",
                            "label": "data: BlockInput",
                            "start_token": 2243,
                            "end_token": -1,
                            "children": [
                                {
                                    "type": "identifier",
                                    "label": "data",
                                    "start_token": 2243,
                                    "end_token": 2244,
                                    "children": []
                                },
                                {
                                    "type": "type",
                                    "label": "BlockInput",
                                    "start_token": 2244,
                                    "end_token": -1,
                                    "children": [
                                        {
                                            "type": "identifier",
                                            "label": "BlockInput",
                                            "start_token": 2244,
                                            "end_token": -1,
                                            "children": []
                                        }
                                    ]
                                }
                            ]
                        },
                        {
                            "type": "typed_default_parameter",
                            "label": "resolve_input: bool = True",
                            "start_token": 2247,
                            "end_token": -1,
                            "children": [
                                {
                                    "type": "identifier",
                                    "label": "resolve_input",
                                    "start_token": 2247,
                                    "end_token": 2249,
                                    "children": []
                                },
                                {
                                    "type": "type",
                                    "label": "bool",
                                    "start_token": -1,
                                    "end_token": 2251,
                                    "children": [
                                        {
                                            "type": "identifier",
                                            "label": "bool",
                                            "start_token": -1,
                                            "end_token": 2251,
                                            "children": []
                                        }
                                    ]
                                },
                                {
                                    "type": "true",
                                    "label": "True",
                                    "start_token": 2252,
                                    "end_token": -1,
                                    "children": []
                                }
                            ]
                        }
                    ]
                },
                {
                    "type": "type",
                    "label": "tuple[BlockInput | None, str]",
                    "start_token": 2257,
                    "end_token": -1,
                    "children": [
                        {
                            "type": "generic_type",
                            "label": "tuple[BlockInput | None, str]",
                            "start_token": 2257,
                            "end_token": -1,
                            "children": [
                                {
                                    "type": "identifier",
                                    "label": "tuple",
                                    "start_token": 2257,
                                    "end_token": 2259,
                                    "children": []
                                },
                                {
                                    "type": "type_parameter",
                                    "label": "[BlockInput | None, str]",
                                    "start_token": 2259,
                                    "end_token": -1,
                                    "children": [
                                        {
                                            "type": "type",
                                            "label": "BlockInput | None",
                                            "start_token": 2259,
                                            "end_token": 2263,
                                            "children": [
                                                {
                                                    "type": "binary_operator",
                                                    "label": "BlockInput | None",
                                                    "start_token": 2259,
                                                    "end_token": 2263,
                                                    "children": [
                                                        {
                                                            "type": "identifier",
                                                            "label": "BlockInput",
                                                            "start_token": 2259,
                                                            "end_token": 2261,
                                                            "children": []
                                                        },
                                                        {
                                                            "type": "none",
                                                            "label": "None",
                                                            "start_token": 2262,
                                                            "end_token": 2263,
                                                            "children": []
                                                        }
                                                    ]
                                                }
                                            ]
                                        },
                                        {
                                            "type": "type",
                                            "label": "str",
                                            "start_token": 2265,
                                            "end_token": -1,
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "label": "str",
                                                    "start_token": 2265,
                                                    "end_token": -1,
                                                    "children": []
                                                }
                                            ]
                                        }
                                    ]
                                }
                            ]
                        }
                    ]
                },
                {
                    "type": "block",
                    "label": "\"\"\"\n    Validate the input data for a node execution.\n\n    Args:\n        node: The node to execute.\n        data: The input data for the node execution.\n        resolve_input: Whether to resolve dynamic pins into dict/list/object.\n\n    Returns:\n        A tuple of the validated data and the block name.\n        If the data is invalid, the first element will be None, and the second element\n        will be an error message.\n        If the data is valid, the first element will be the resolved input data, and\n        the second element will be the block name.\n    \"\"\"\n    node_block: Block | None = get_block(node.block_id)\n    if not node_block:\n        return None, f\"Block for {node.block_id} not found.\"\n\n    if isinstance(node_block, AgentExecutorBlock):\n        # Validate the execution metadata for the agent executor block.\n        try:\n            exec_data = AgentExecutorBlock.Input(**node.input_default)\n        except Exception as e:\n            return None, f\"Input data doesn't match {node_block.name}: {str(e)}\"\n\n        # Validation input\n        input_schema = exec_data.input_schema\n        required_fields = set(input_schema[\"required\"])\n        input_default = exec_data.data\n    else:\n        # Convert non-matching data types to the expected input schema.\n        for name, data_type in node_block.input_schema.__annotations__.items():\n            if (value := data.get(name)) and (type(value) is not data_type):\n                data[name] = convert(value, data_type)\n\n        # Validation input\n        input_schema = node_block.input_schema.jsonschema()\n        required_fields = node_block.input_schema.get_required_fields()\n        input_default = node.input_default\n\n    # Input data (without default values) should contain all required fields.\n    error_prefix = f\"Input data missing or mismatch for `{node_block.name}`:\"\n    input_fields_from_nodes = {link.sink_name for link in node.input_links}\n    if not input_fields_from_nodes.issubset(data):\n        return None, f\"{error_prefix} {input_fields_from_nodes - set(data)}\"\n\n    # Merge input data with default values and resolve dynamic dict/list/object pins.\n    data = {**input_default, **data}\n    if resolve_input:\n        data = merge_execution_input(data)\n\n    # Input data post-merge should contain all required fields from the schema.\n    if not required_fields.issubset(data):\n        return None, f\"{error_prefix} {required_fields - set(data)}\"\n\n    # Last validation: Validate the input values against the schema.\n    if error := json.validate_with_jsonschema(schema=input_schema, data=data):\n        error_message = f\"{error_prefix} {error}\"\n        logger.error(error_message)\n        return None, error_message\n\n    return data, node_block.name",
                    "start_token": 2268,
                    "end_token": 2657,
                    "children": [
                        {
                            "type": "expression_statement",
                            "label": "\"\"\"\n    Validate the input data for a node execution.\n\n    Args:\n        node: The node to execute.\n        data: The input data for the node execution.\n        resolve_input: Whether to resolve dynamic pins into dict/list/object.\n\n    Returns:\n        A tuple of the validated data and the block name.\n        If the data is invalid, the first element will be None, and the second element\n        will be an error message.\n        If the data is valid, the first element will be the resolved input data, and\n        the second element will be the block name.\n    \"\"\"",
                            "start_token": 2268,
                            "end_token": -1,
                            "children": [
                                {
                                    "type": "string",
                                    "label": "\"\"\"\n    Validate the input data for a node execution.\n\n    Args:\n        node: The node to execute.\n        data: The input data for the node execution.\n        resolve_input: Whether to resolve dynamic pins into dict/list/object.\n\n    Returns:\n        A tuple of the validated data and the block name.\n        If the data is invalid, the first element will be None, and the second element\n        will be an error message.\n        If the data is valid, the first element will be the resolved input data, and\n        the second element will be the block name.\n    \"\"\"",
                                    "start_token": 2268,
                                    "end_token": -1,
                                    "children": [
                                        {
                                            "type": "string_start",
                                            "label": "\"\"\"",
                                            "start_token": 2268,
                                            "end_token": 2268,
                                            "children": []
                                        },
                                        {
                                            "type": "string_content",
                                            "label": "\n    Validate the input data for a node execution.\n\n    Args:\n        node: The node to execute.\n        data: The input data for the node execution.\n        resolve_input: Whether to resolve dynamic pins into dict/list/object.\n\n    Returns:\n        A tuple of the validated data and the block name.\n        If the data is invalid, the first element will be None, and the second element\n        will be an error message.\n        If the data is valid, the first element will be the resolved input data, and\n        the second element will be the block name.\n    ",
                                            "start_token": 2268,
                                            "end_token": 2270,
                                            "children": []
                                        },
                                        {
                                            "type": "string_end",
                                            "label": "\"\"\"",
                                            "start_token": -1,
                                            "end_token": -1,
                                            "children": []
                                        }
                                    ]
                                }
                            ]
                        },
                        {
                            "type": "expression_statement",
                            "label": "node_block: Block | None = get_block(node.block_id)",
                            "start_token": 2271,
                            "end_token": -1,
                            "children": [
                                {
                                    "type": "assignment",
                                    "label": "node_block: Block | None = get_block(node.block_id)",
                                    "start_token": 2271,
                                    "end_token": -1,
                                    "children": [
                                        {
                                            "type": "identifier",
                                            "label": "node_block",
                                            "start_token": 2271,
                                            "end_token": 2273,
                                            "children": []
                                        },
                                        {
                                            "type": "type",
                                            "label": "Block | None",
                                            "start_token": 2273,
                                            "end_token": 2277,
                                            "children": [
                                                {
                                                    "type": "binary_operator",
                                                    "label": "Block | None",
                                                    "start_token": 2273,
                                                    "end_token": 2277,
                                                    "children": [
                                                        {
                                                            "type": "identifier",
                                                            "label": "Block",
                                                            "start_token": 2273,
                                                            "end_token": 2275,
                                                            "children": []
                                                        },
                                                        {
                                                            "type": "none",
                                                            "label": "None",
                                                            "start_token": -1,
                                                            "end_token": 2277,
                                                            "children": []
                                                        }
                                                    ]
                                                }
                                            ]
                                        },
                                        {
                                            "type": "call",
                                            "label": "get_block(node.block_id)",
                                            "start_token": 2277,
                                            "end_token": -1,
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "label": "get_block",
                                                    "start_token": 2277,
                                                    "end_token": 2279,
                                                    "children": []
                                                },
                                                {
                                                    "type": "argument_list",
                                                    "label": "(node.block_id)",
                                                    "start_token": 2279,
                                                    "end_token": -1,
                                                    "children": [
                                                        {
                                                            "type": "attribute",
                                                            "label": "node.block_id",
                                                            "start_token": 2280,
                                                            "end_token": -1,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "label": "node",
                                                                    "start_token": 2280,
                                                                    "end_token": 2281,
                                                                    "children": []
                                                                },
                                                                {
                                                                    "type": "identifier",
                                                                    "label": "block_id",
                                                                    "start_token": 2281,
                                                                    "end_token": -1,
                                                                    "children": []
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                }
                                            ]
                                        }
                                    ]
                                }
                            ]
                        },
                        {
                            "type": "if_statement",
                            "label": "if not node_block:\n        return None, f\"Block for {node.block_id} not found.\"",
                            "start_token": 2285,
                            "end_token": -1,
                            "children": [
                                {
                                    "type": "not_operator",
                                    "label": "not node_block",
                                    "start_token": 2286,
                                    "end_token": -1,
                                    "children": [
                                        {
                                            "type": "identifier",
                                            "label": "node_block",
                                            "start_token": 2286,
                                            "end_token": -1,
                                            "children": []
                                        }
                                    ]
                                },
                                {
                                    "type": "block",
                                    "label": "return None, f\"Block for {node.block_id} not found.\"",
                                    "start_token": 2289,
                                    "end_token": -1,
                                    "children": [
                                        {
                                            "type": "return_statement",
                                            "label": "return None, f\"Block for {node.block_id} not found.\"",
                                            "start_token": 2289,
                                            "end_token": -1,
                                            "children": [
                                                {
                                                    "type": "expression_list",
                                                    "label": "None, f\"Block for {node.block_id} not found.\"",
                                                    "start_token": 2291,
                                                    "end_token": -1,
                                                    "children": [
                                                        {
                                                            "type": "none",
                                                            "label": "None",
                                                            "start_token": 2291,
                                                            "end_token": 2293,
                                                            "children": []
                                                        },
                                                        {
                                                            "type": "string",
                                                            "label": "f\"Block for {node.block_id} not found.\"",
                                                            "start_token": 2293,
                                                            "end_token": -1,
                                                            "children": [
                                                                {
                                                                    "type": "string_start",
                                                                    "label": "f\"",
                                                                    "start_token": 2293,
                                                                    "end_token": 2293,
                                                                    "children": []
                                                                },
                                                                {
                                                                    "type": "string_content",
                                                                    "label": "Block for ",
                                                                    "start_token": 2293,
                                                                    "end_token": 2293,
                                                                    "children": []
                                                                },
                                                                {
                                                                    "type": "interpolation",
                                                                    "label": "{node.block_id}",
                                                                    "start_token": 2293,
                                                                    "end_token": 2293,
                                                                    "children": [
                                                                        {
                                                                            "type": "attribute",
                                                                            "label": "node.block_id",
                                                                            "start_token": 2293,
                                                                            "end_token": 2293,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "node",
                                                                                    "start_token": 2293,
                                                                                    "end_token": 2293,
                                                                                    "children": []
                                                                                },
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "block_id",
                                                                                    "start_token": 2293,
                                                                                    "end_token": 2293,
                                                                                    "children": []
                                                                                }
                                                                            ]
                                                                        }
                                                                    ]
                                                                },
                                                                {
                                                                    "type": "string_content",
                                                                    "label": " not found.",
                                                                    "start_token": 2293,
                                                                    "end_token": -1,
                                                                    "children": []
                                                                },
                                                                {
                                                                    "type": "string_end",
                                                                    "label": "\"",
                                                                    "start_token": -1,
                                                                    "end_token": -1,
                                                                    "children": []
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                }
                                            ]
                                        }
                                    ]
                                }
                            ]
                        },
                        {
                            "type": "if_statement",
                            "label": "if isinstance(node_block, AgentExecutorBlock):\n        # Validate the execution metadata for the agent executor block.\n        try:\n            exec_data = AgentExecutorBlock.Input(**node.input_default)\n        except Exception as e:\n            return None, f\"Input data doesn't match {node_block.name}: {str(e)}\"\n\n        # Validation input\n        input_schema = exec_data.input_schema\n        required_fields = set(input_schema[\"required\"])\n        input_default = exec_data.data\n    else:\n        # Convert non-matching data types to the expected input schema.\n        for name, data_type in node_block.input_schema.__annotations__.items():\n            if (value := data.get(name)) and (type(value) is not data_type):\n                data[name] = convert(value, data_type)\n\n        # Validation input\n        input_schema = node_block.input_schema.jsonschema()\n        required_fields = node_block.input_schema.get_required_fields()\n        input_default = node.input_default",
                            "start_token": 2297,
                            "end_token": -1,
                            "children": [
                                {
                                    "type": "call",
                                    "label": "isinstance(node_block, AgentExecutorBlock)",
                                    "start_token": 2297,
                                    "end_token": -1,
                                    "children": [
                                        {
                                            "type": "identifier",
                                            "label": "isinstance",
                                            "start_token": 2297,
                                            "end_token": 2299,
                                            "children": []
                                        },
                                        {
                                            "type": "argument_list",
                                            "label": "(node_block, AgentExecutorBlock)",
                                            "start_token": 2299,
                                            "end_token": -1,
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "label": "node_block",
                                                    "start_token": 2299,
                                                    "end_token": 2301,
                                                    "children": []
                                                },
                                                {
                                                    "type": "identifier",
                                                    "label": "AgentExecutorBlock",
                                                    "start_token": 2301,
                                                    "end_token": -1,
                                                    "children": []
                                                }
                                            ]
                                        }
                                    ]
                                },
                                {
                                    "type": "comment",
                                    "label": "# Validate the execution metadata for the agent executor block.",
                                    "start_token": 2306,
                                    "end_token": -1,
                                    "children": []
                                },
                                {
                                    "type": "block",
                                    "label": "try:\n            exec_data = AgentExecutorBlock.Input(**node.input_default)\n        except Exception as e:\n            return None, f\"Input data doesn't match {node_block.name}: {str(e)}\"\n\n        # Validation input\n        input_schema = exec_data.input_schema\n        required_fields = set(input_schema[\"required\"])\n        input_default = exec_data.data",
                                    "start_token": 2319,
                                    "end_token": -1,
                                    "children": [
                                        {
                                            "type": "try_statement",
                                            "label": "try:\n            exec_data = AgentExecutorBlock.Input(**node.input_default)\n        except Exception as e:\n            return None, f\"Input data doesn't match {node_block.name}: {str(e)}\"",
                                            "start_token": 2319,
                                            "end_token": -1,
                                            "children": [
                                                {
                                                    "type": "block",
                                                    "label": "exec_data = AgentExecutorBlock.Input(**node.input_default)",
                                                    "start_token": 2320,
                                                    "end_token": -1,
                                                    "children": [
                                                        {
                                                            "type": "expression_statement",
                                                            "label": "exec_data = AgentExecutorBlock.Input(**node.input_default)",
                                                            "start_token": 2320,
                                                            "end_token": -1,
                                                            "children": [
                                                                {
                                                                    "type": "assignment",
                                                                    "label": "exec_data = AgentExecutorBlock.Input(**node.input_default)",
                                                                    "start_token": 2320,
                                                                    "end_token": -1,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "exec_data",
                                                                            "start_token": 2320,
                                                                            "end_token": 2322,
                                                                            "children": []
                                                                        },
                                                                        {
                                                                            "type": "call",
                                                                            "label": "AgentExecutorBlock.Input(**node.input_default)",
                                                                            "start_token": 2322,
                                                                            "end_token": -1,
                                                                            "children": [
                                                                                {
                                                                                    "type": "attribute",
                                                                                    "label": "AgentExecutorBlock.Input",
                                                                                    "start_token": 2322,
                                                                                    "end_token": 2328,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "label": "AgentExecutorBlock",
                                                                                            "start_token": 2322,
                                                                                            "end_token": 2324,
                                                                                            "children": []
                                                                                        },
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "label": "Input",
                                                                                            "start_token": 2324,
                                                                                            "end_token": 2328,
                                                                                            "children": []
                                                                                        }
                                                                                    ]
                                                                                },
                                                                                {
                                                                                    "type": "argument_list",
                                                                                    "label": "(**node.input_default)",
                                                                                    "start_token": 2328,
                                                                                    "end_token": -1,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "dictionary_splat",
                                                                                            "label": "**node.input_default",
                                                                                            "start_token": 2328,
                                                                                            "end_token": -1,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "attribute",
                                                                                                    "label": "node.input_default",
                                                                                                    "start_token": 2329,
                                                                                                    "end_token": -1,
                                                                                                    "children": [
                                                                                                        {
                                                                                                            "type": "identifier",
                                                                                                            "label": "node",
                                                                                                            "start_token": 2329,
                                                                                                            "end_token": 2330,
                                                                                                            "children": []
                                                                                                        },
                                                                                                        {
                                                                                                            "type": "identifier",
                                                                                                            "label": "input_default",
                                                                                                            "start_token": 2330,
                                                                                                            "end_token": -1,
                                                                                                            "children": []
                                                                                                        }
                                                                                                    ]
                                                                                                }
                                                                                            ]
                                                                                        }
                                                                                    ]
                                                                                }
                                                                            ]
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                },
                                                {
                                                    "type": "except_clause",
                                                    "label": "except Exception as e:\n            return None, f\"Input data doesn't match {node_block.name}: {str(e)}\"",
                                                    "start_token": 2333,
                                                    "end_token": -1,
                                                    "children": [
                                                        {
                                                            "type": "as_pattern",
                                                            "label": "Exception as e",
                                                            "start_token": 2334,
                                                            "end_token": -1,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "label": "Exception",
                                                                    "start_token": 2334,
                                                                    "end_token": -1,
                                                                    "children": []
                                                                },
                                                                {
                                                                    "type": "as_pattern_target",
                                                                    "label": "e",
                                                                    "start_token": -1,
                                                                    "end_token": -1,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "e",
                                                                            "start_token": -1,
                                                                            "end_token": -1,
                                                                            "children": []
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        },
                                                        {
                                                            "type": "block",
                                                            "label": "return None, f\"Input data doesn't match {node_block.name}: {str(e)}\"",
                                                            "start_token": 2339,
                                                            "end_token": -1,
                                                            "children": [
                                                                {
                                                                    "type": "return_statement",
                                                                    "label": "return None, f\"Input data doesn't match {node_block.name}: {str(e)}\"",
                                                                    "start_token": 2339,
                                                                    "end_token": -1,
                                                                    "children": [
                                                                        {
                                                                            "type": "expression_list",
                                                                            "label": "None, f\"Input data doesn't match {node_block.name}: {str(e)}\"",
                                                                            "start_token": 2341,
                                                                            "end_token": -1,
                                                                            "children": [
                                                                                {
                                                                                    "type": "none",
                                                                                    "label": "None",
                                                                                    "start_token": 2341,
                                                                                    "end_token": 2343,
                                                                                    "children": []
                                                                                },
                                                                                {
                                                                                    "type": "string",
                                                                                    "label": "f\"Input data doesn't match {node_block.name}: {str(e)}\"",
                                                                                    "start_token": 2343,
                                                                                    "end_token": -1,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "string_start",
                                                                                            "label": "f\"",
                                                                                            "start_token": 2343,
                                                                                            "end_token": 2343,
                                                                                            "children": []
                                                                                        },
                                                                                        {
                                                                                            "type": "string_content",
                                                                                            "label": "Input data doesn't match ",
                                                                                            "start_token": 2343,
                                                                                            "end_token": 2343,
                                                                                            "children": []
                                                                                        },
                                                                                        {
                                                                                            "type": "interpolation",
                                                                                            "label": "{node_block.name}",
                                                                                            "start_token": 2343,
                                                                                            "end_token": 2343,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "attribute",
                                                                                                    "label": "node_block.name",
                                                                                                    "start_token": 2343,
                                                                                                    "end_token": 2343,
                                                                                                    "children": [
                                                                                                        {
                                                                                                            "type": "identifier",
                                                                                                            "label": "node_block",
                                                                                                            "start_token": 2343,
                                                                                                            "end_token": 2343,
                                                                                                            "children": []
                                                                                                        },
                                                                                                        {
                                                                                                            "type": "identifier",
                                                                                                            "label": "name",
                                                                                                            "start_token": 2343,
                                                                                                            "end_token": 2343,
                                                                                                            "children": []
                                                                                                        }
                                                                                                    ]
                                                                                                }
                                                                                            ]
                                                                                        },
                                                                                        {
                                                                                            "type": "string_content",
                                                                                            "label": ": ",
                                                                                            "start_token": 2343,
                                                                                            "end_token": 2343,
                                                                                            "children": []
                                                                                        },
                                                                                        {
                                                                                            "type": "interpolation",
                                                                                            "label": "{str(e)}",
                                                                                            "start_token": 2343,
                                                                                            "end_token": -1,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "call",
                                                                                                    "label": "str(e)",
                                                                                                    "start_token": 2343,
                                                                                                    "end_token": 2345,
                                                                                                    "children": [
                                                                                                        {
                                                                                                            "type": "identifier",
                                                                                                            "label": "str",
                                                                                                            "start_token": 2343,
                                                                                                            "end_token": 2343,
                                                                                                            "children": []
                                                                                                        },
                                                                                                        {
                                                                                                            "type": "argument_list",
                                                                                                            "label": "(e)",
                                                                                                            "start_token": 2343,
                                                                                                            "end_token": 2345,
                                                                                                            "children": [
                                                                                                                {
                                                                                                                    "type": "identifier",
                                                                                                                    "label": "e",
                                                                                                                    "start_token": 2344,
                                                                                                                    "end_token": 2344,
                                                                                                                    "children": []
                                                                                                                }
                                                                                                            ]
                                                                                                        }
                                                                                                    ]
                                                                                                }
                                                                                            ]
                                                                                        },
                                                                                        {
                                                                                            "type": "string_end",
                                                                                            "label": "\"",
                                                                                            "start_token": -1,
                                                                                            "end_token": -1,
                                                                                            "children": []
                                                                                        }
                                                                                    ]
                                                                                }
                                                                            ]
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                }
                                            ]
                                        },
                                        {
                                            "type": "comment",
                                            "label": "# Validation input",
                                            "start_token": 2347,
                                            "end_token": -1,
                                            "children": []
                                        },
                                        {
                                            "type": "expression_statement",
                                            "label": "input_schema = exec_data.input_schema",
                                            "start_token": 2350,
                                            "end_token": -1,
                                            "children": [
                                                {
                                                    "type": "assignment",
                                                    "label": "input_schema = exec_data.input_schema",
                                                    "start_token": 2350,
                                                    "end_token": -1,
                                                    "children": [
                                                        {
                                                            "type": "identifier",
                                                            "label": "input_schema",
                                                            "start_token": 2350,
                                                            "end_token": 2352,
                                                            "children": []
                                                        },
                                                        {
                                                            "type": "attribute",
                                                            "label": "exec_data.input_schema",
                                                            "start_token": 2352,
                                                            "end_token": -1,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "label": "exec_data",
                                                                    "start_token": 2352,
                                                                    "end_token": 2354,
                                                                    "children": []
                                                                },
                                                                {
                                                                    "type": "identifier",
                                                                    "label": "input_schema",
                                                                    "start_token": 2354,
                                                                    "end_token": -1,
                                                                    "children": []
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                }
                                            ]
                                        },
                                        {
                                            "type": "expression_statement",
                                            "label": "required_fields = set(input_schema[\"required\"])",
                                            "start_token": 2356,
                                            "end_token": -1,
                                            "children": [
                                                {
                                                    "type": "assignment",
                                                    "label": "required_fields = set(input_schema[\"required\"])",
                                                    "start_token": 2356,
                                                    "end_token": -1,
                                                    "children": [
                                                        {
                                                            "type": "identifier",
                                                            "label": "required_fields",
                                                            "start_token": 2356,
                                                            "end_token": 2358,
                                                            "children": []
                                                        },
                                                        {
                                                            "type": "call",
                                                            "label": "set(input_schema[\"required\"])",
                                                            "start_token": 2360,
                                                            "end_token": -1,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "label": "set",
                                                                    "start_token": 2360,
                                                                    "end_token": 2360,
                                                                    "children": []
                                                                },
                                                                {
                                                                    "type": "argument_list",
                                                                    "label": "(input_schema[\"required\"])",
                                                                    "start_token": 2360,
                                                                    "end_token": -1,
                                                                    "children": [
                                                                        {
                                                                            "type": "subscript",
                                                                            "label": "input_schema[\"required\"]",
                                                                            "start_token": 2360,
                                                                            "end_token": -1,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "input_schema",
                                                                                    "start_token": 2360,
                                                                                    "end_token": 2362,
                                                                                    "children": []
                                                                                },
                                                                                {
                                                                                    "type": "string",
                                                                                    "label": "\"required\"",
                                                                                    "start_token": 2362,
                                                                                    "end_token": -1,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "string_start",
                                                                                            "label": "\"",
                                                                                            "start_token": 2362,
                                                                                            "end_token": 2362,
                                                                                            "children": []
                                                                                        },
                                                                                        {
                                                                                            "type": "string_content",
                                                                                            "label": "required",
                                                                                            "start_token": 2362,
                                                                                            "end_token": 2365,
                                                                                            "children": []
                                                                                        },
                                                                                        {
                                                                                            "type": "string_end",
                                                                                            "label": "\"",
                                                                                            "start_token": -1,
                                                                                            "end_token": -1,
                                                                                            "children": []
                                                                                        }
                                                                                    ]
                                                                                }
                                                                            ]
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                }
                                            ]
                                        },
                                        {
                                            "type": "expression_statement",
                                            "label": "input_default = exec_data.data",
                                            "start_token": 2366,
                                            "end_token": -1,
                                            "children": [
                                                {
                                                    "type": "assignment",
                                                    "label": "input_default = exec_data.data",
                                                    "start_token": 2366,
                                                    "end_token": -1,
                                                    "children": [
                                                        {
                                                            "type": "identifier",
                                                            "label": "input_default",
                                                            "start_token": 2366,
                                                            "end_token": 2368,
                                                            "children": []
                                                        },
                                                        {
                                                            "type": "attribute",
                                                            "label": "exec_data.data",
                                                            "start_token": 2368,
                                                            "end_token": -1,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "label": "exec_data",
                                                                    "start_token": 2368,
                                                                    "end_token": 2370,
                                                                    "children": []
                                                                },
                                                                {
                                                                    "type": "identifier",
                                                                    "label": "data",
                                                                    "start_token": 2371,
                                                                    "end_token": -1,
                                                                    "children": []
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                }
                                            ]
                                        }
                                    ]
                                },
                                {
                                    "type": "else_clause",
                                    "label": "else:\n        # Convert non-matching data types to the expected input schema.\n        for name, data_type in node_block.input_schema.__annotations__.items():\n            if (value := data.get(name)) and (type(value) is not data_type):\n                data[name] = convert(value, data_type)\n\n        # Validation input\n        input_schema = node_block.input_schema.jsonschema()\n        required_fields = node_block.input_schema.get_required_fields()\n        input_default = node.input_default",
                                    "start_token": 2373,
                                    "end_token": -1,
                                    "children": [
                                        {
                                            "type": "comment",
                                            "label": "# Convert non-matching data types to the expected input schema.",
                                            "start_token": 2376,
                                            "end_token": -1,
                                            "children": []
                                        },
                                        {
                                            "type": "block",
                                            "label": "for name, data_type in node_block.input_schema.__annotations__.items():\n            if (value := data.get(name)) and (type(value) is not data_type):\n                data[name] = convert(value, data_type)\n\n        # Validation input\n        input_schema = node_block.input_schema.jsonschema()\n        required_fields = node_block.input_schema.get_required_fields()\n        input_default = node.input_default",
                                            "start_token": 2390,
                                            "end_token": -1,
                                            "children": [
                                                {
                                                    "type": "for_statement",
                                                    "label": "for name, data_type in node_block.input_schema.__annotations__.items():\n            if (value := data.get(name)) and (type(value) is not data_type):\n                data[name] = convert(value, data_type)",
                                                    "start_token": 2390,
                                                    "end_token": -1,
                                                    "children": [
                                                        {
                                                            "type": "pattern_list",
                                                            "label": "name, data_type",
                                                            "start_token": 2391,
                                                            "end_token": -1,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "label": "name",
                                                                    "start_token": 2391,
                                                                    "end_token": 2392,
                                                                    "children": []
                                                                },
                                                                {
                                                                    "type": "identifier",
                                                                    "label": "data_type",
                                                                    "start_token": 2392,
                                                                    "end_token": -1,
                                                                    "children": []
                                                                }
                                                            ]
                                                        },
                                                        {
                                                            "type": "call",
                                                            "label": "node_block.input_schema.__annotations__.items()",
                                                            "start_token": 2394,
                                                            "end_token": -1,
                                                            "children": [
                                                                {
                                                                    "type": "attribute",
                                                                    "label": "node_block.input_schema.__annotations__.items",
                                                                    "start_token": 2394,
                                                                    "end_token": 2404,
                                                                    "children": [
                                                                        {
                                                                            "type": "attribute",
                                                                            "label": "node_block.input_schema.__annotations__",
                                                                            "start_token": 2394,
                                                                            "end_token": 2400,
                                                                            "children": [
                                                                                {
                                                                                    "type": "attribute",
                                                                                    "label": "node_block.input_schema",
                                                                                    "start_token": 2394,
                                                                                    "end_token": 2398,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "label": "node_block",
                                                                                            "start_token": 2394,
                                                                                            "end_token": 2396,
                                                                                            "children": []
                                                                                        },
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "label": "input_schema",
                                                                                            "start_token": 2396,
                                                                                            "end_token": 2398,
                                                                                            "children": []
                                                                                        }
                                                                                    ]
                                                                                },
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "__annotations__",
                                                                                    "start_token": 2398,
                                                                                    "end_token": 2400,
                                                                                    "children": []
                                                                                }
                                                                            ]
                                                                        },
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "items",
                                                                            "start_token": 2400,
                                                                            "end_token": 2404,
                                                                            "children": []
                                                                        }
                                                                    ]
                                                                },
                                                                {
                                                                    "type": "argument_list",
                                                                    "label": "()",
                                                                    "start_token": -1,
                                                                    "end_token": -1,
                                                                    "children": []
                                                                }
                                                            ]
                                                        },
                                                        {
                                                            "type": "block",
                                                            "label": "if (value := data.get(name)) and (type(value) is not data_type):\n                data[name] = convert(value, data_type)",
                                                            "start_token": 2407,
                                                            "end_token": -1,
                                                            "children": [
                                                                {
                                                                    "type": "if_statement",
                                                                    "label": "if (value := data.get(name)) and (type(value) is not data_type):\n                data[name] = convert(value, data_type)",
                                                                    "start_token": 2407,
                                                                    "end_token": -1,
                                                                    "children": [
                                                                        {
                                                                            "type": "boolean_operator",
                                                                            "label": "(value := data.get(name)) and (type(value) is not data_type)",
                                                                            "start_token": 2407,
                                                                            "end_token": -1,
                                                                            "children": [
                                                                                {
                                                                                    "type": "parenthesized_expression",
                                                                                    "label": "(value := data.get(name))",
                                                                                    "start_token": 2407,
                                                                                    "end_token": 2417,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "named_expression",
                                                                                            "label": "value := data.get(name)",
                                                                                            "start_token": 2407,
                                                                                            "end_token": 2417,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "label": "value",
                                                                                                    "start_token": 2407,
                                                                                                    "end_token": -1,
                                                                                                    "children": []
                                                                                                },
                                                                                                {
                                                                                                    "type": "call",
                                                                                                    "label": "data.get(name)",
                                                                                                    "start_token": 2411,
                                                                                                    "end_token": 2417,
                                                                                                    "children": [
                                                                                                        {
                                                                                                            "type": "attribute",
                                                                                                            "label": "data.get",
                                                                                                            "start_token": 2411,
                                                                                                            "end_token": 2414,
                                                                                                            "children": [
                                                                                                                {
                                                                                                                    "type": "identifier",
                                                                                                                    "label": "data",
                                                                                                                    "start_token": 2411,
                                                                                                                    "end_token": 2412,
                                                                                                                    "children": []
                                                                                                                },
                                                                                                                {
                                                                                                                    "type": "identifier",
                                                                                                                    "label": "get",
                                                                                                                    "start_token": 2414,
                                                                                                                    "end_token": 2414,
                                                                                                                    "children": []
                                                                                                                }
                                                                                                            ]
                                                                                                        },
                                                                                                        {
                                                                                                            "type": "argument_list",
                                                                                                            "label": "(name)",
                                                                                                            "start_token": 2414,
                                                                                                            "end_token": 2417,
                                                                                                            "children": [
                                                                                                                {
                                                                                                                    "type": "identifier",
                                                                                                                    "label": "name",
                                                                                                                    "start_token": 2415,
                                                                                                                    "end_token": 2417,
                                                                                                                    "children": []
                                                                                                                }
                                                                                                            ]
                                                                                                        }
                                                                                                    ]
                                                                                                }
                                                                                            ]
                                                                                        }
                                                                                    ]
                                                                                },
                                                                                {
                                                                                    "type": "parenthesized_expression",
                                                                                    "label": "(type(value) is not data_type)",
                                                                                    "start_token": 2419,
                                                                                    "end_token": -1,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "comparison_operator",
                                                                                            "label": "type(value) is not data_type",
                                                                                            "start_token": 2420,
                                                                                            "end_token": -1,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "call",
                                                                                                    "label": "type(value)",
                                                                                                    "start_token": 2420,
                                                                                                    "end_token": -1,
                                                                                                    "children": [
                                                                                                        {
                                                                                                            "type": "identifier",
                                                                                                            "label": "type",
                                                                                                            "start_token": 2420,
                                                                                                            "end_token": 2421,
                                                                                                            "children": []
                                                                                                        },
                                                                                                        {
                                                                                                            "type": "argument_list",
                                                                                                            "label": "(value)",
                                                                                                            "start_token": 2421,
                                                                                                            "end_token": -1,
                                                                                                            "children": [
                                                                                                                {
                                                                                                                    "type": "identifier",
                                                                                                                    "label": "value",
                                                                                                                    "start_token": 2421,
                                                                                                                    "end_token": 2423,
                                                                                                                    "children": []
                                                                                                                }
                                                                                                            ]
                                                                                                        }
                                                                                                    ]
                                                                                                },
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "label": "data_type",
                                                                                                    "start_token": 2425,
                                                                                                    "end_token": -1,
                                                                                                    "children": []
                                                                                                }
                                                                                            ]
                                                                                        }
                                                                                    ]
                                                                                }
                                                                            ]
                                                                        },
                                                                        {
                                                                            "type": "block",
                                                                            "label": "data[name] = convert(value, data_type)",
                                                                            "start_token": 2430,
                                                                            "end_token": -1,
                                                                            "children": [
                                                                                {
                                                                                    "type": "expression_statement",
                                                                                    "label": "data[name] = convert(value, data_type)",
                                                                                    "start_token": 2430,
                                                                                    "end_token": -1,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "assignment",
                                                                                            "label": "data[name] = convert(value, data_type)",
                                                                                            "start_token": 2430,
                                                                                            "end_token": -1,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "subscript",
                                                                                                    "label": "data[name]",
                                                                                                    "start_token": 2430,
                                                                                                    "end_token": 2434,
                                                                                                    "children": [
                                                                                                        {
                                                                                                            "type": "identifier",
                                                                                                            "label": "data",
                                                                                                            "start_token": 2430,
                                                                                                            "end_token": 2431,
                                                                                                            "children": []
                                                                                                        },
                                                                                                        {
                                                                                                            "type": "identifier",
                                                                                                            "label": "name",
                                                                                                            "start_token": 2432,
                                                                                                            "end_token": -1,
                                                                                                            "children": []
                                                                                                        }
                                                                                                    ]
                                                                                                },
                                                                                                {
                                                                                                    "type": "call",
                                                                                                    "label": "convert(value, data_type)",
                                                                                                    "start_token": 2434,
                                                                                                    "end_token": -1,
                                                                                                    "children": [
                                                                                                        {
                                                                                                            "type": "identifier",
                                                                                                            "label": "convert",
                                                                                                            "start_token": 2434,
                                                                                                            "end_token": 2436,
                                                                                                            "children": []
                                                                                                        },
                                                                                                        {
                                                                                                            "type": "argument_list",
                                                                                                            "label": "(value, data_type)",
                                                                                                            "start_token": 2436,
                                                                                                            "end_token": -1,
                                                                                                            "children": [
                                                                                                                {
                                                                                                                    "type": "identifier",
                                                                                                                    "label": "value",
                                                                                                                    "start_token": 2436,
                                                                                                                    "end_token": 2438,
                                                                                                                    "children": []
                                                                                                                },
                                                                                                                {
                                                                                                                    "type": "identifier",
                                                                                                                    "label": "data_type",
                                                                                                                    "start_token": 2438,
                                                                                                                    "end_token": -1,
                                                                                                                    "children": []
                                                                                                                }
                                                                                                            ]
                                                                                                        }
                                                                                                    ]
                                                                                                }
                                                                                            ]
                                                                                        }
                                                                                    ]
                                                                                }
                                                                            ]
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                },
                                                {
                                                    "type": "comment",
                                                    "label": "# Validation input",
                                                    "start_token": 2443,
                                                    "end_token": -1,
                                                    "children": []
                                                },
                                                {
                                                    "type": "expression_statement",
                                                    "label": "input_schema = node_block.input_schema.jsonschema()",
                                                    "start_token": 2446,
                                                    "end_token": -1,
                                                    "children": [
                                                        {
                                                            "type": "assignment",
                                                            "label": "input_schema = node_block.input_schema.jsonschema()",
                                                            "start_token": 2446,
                                                            "end_token": -1,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "label": "input_schema",
                                                                    "start_token": 2446,
                                                                    "end_token": 2448,
                                                                    "children": []
                                                                },
                                                                {
                                                                    "type": "call",
                                                                    "label": "node_block.input_schema.jsonschema()",
                                                                    "start_token": 2448,
                                                                    "end_token": -1,
                                                                    "children": [
                                                                        {
                                                                            "type": "attribute",
                                                                            "label": "node_block.input_schema.jsonschema",
                                                                            "start_token": 2448,
                                                                            "end_token": -1,
                                                                            "children": [
                                                                                {
                                                                                    "type": "attribute",
                                                                                    "label": "node_block.input_schema",
                                                                                    "start_token": 2448,
                                                                                    "end_token": 2452,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "label": "node_block",
                                                                                            "start_token": 2448,
                                                                                            "end_token": 2450,
                                                                                            "children": []
                                                                                        },
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "label": "input_schema",
                                                                                            "start_token": 2450,
                                                                                            "end_token": 2452,
                                                                                            "children": []
                                                                                        }
                                                                                    ]
                                                                                },
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "jsonschema",
                                                                                    "start_token": 2452,
                                                                                    "end_token": -1,
                                                                                    "children": []
                                                                                }
                                                                            ]
                                                                        },
                                                                        {
                                                                            "type": "argument_list",
                                                                            "label": "()",
                                                                            "start_token": -1,
                                                                            "end_token": -1,
                                                                            "children": []
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                },
                                                {
                                                    "type": "expression_statement",
                                                    "label": "required_fields = node_block.input_schema.get_required_fields()",
                                                    "start_token": 2456,
                                                    "end_token": -1,
                                                    "children": [
                                                        {
                                                            "type": "assignment",
                                                            "label": "required_fields = node_block.input_schema.get_required_fields()",
                                                            "start_token": 2456,
                                                            "end_token": -1,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "label": "required_fields",
                                                                    "start_token": 2456,
                                                                    "end_token": 2458,
                                                                    "children": []
                                                                },
                                                                {
                                                                    "type": "call",
                                                                    "label": "node_block.input_schema.get_required_fields()",
                                                                    "start_token": 2458,
                                                                    "end_token": -1,
                                                                    "children": [
                                                                        {
                                                                            "type": "attribute",
                                                                            "label": "node_block.input_schema.get_required_fields",
                                                                            "start_token": 2458,
                                                                            "end_token": -1,
                                                                            "children": [
                                                                                {
                                                                                    "type": "attribute",
                                                                                    "label": "node_block.input_schema",
                                                                                    "start_token": 2458,
                                                                                    "end_token": 2462,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "label": "node_block",
                                                                                            "start_token": 2458,
                                                                                            "end_token": 2460,
                                                                                            "children": []
                                                                                        },
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "label": "input_schema",
                                                                                            "start_token": 2460,
                                                                                            "end_token": 2462,
                                                                                            "children": []
                                                                                        }
                                                                                    ]
                                                                                },
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "get_required_fields",
                                                                                    "start_token": 2462,
                                                                                    "end_token": -1,
                                                                                    "children": []
                                                                                }
                                                                            ]
                                                                        },
                                                                        {
                                                                            "type": "argument_list",
                                                                            "label": "()",
                                                                            "start_token": -1,
                                                                            "end_token": -1,
                                                                            "children": []
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                },
                                                {
                                                    "type": "expression_statement",
                                                    "label": "input_default = node.input_default",
                                                    "start_token": 2466,
                                                    "end_token": -1,
                                                    "children": [
                                                        {
                                                            "type": "assignment",
                                                            "label": "input_default = node.input_default",
                                                            "start_token": 2466,
                                                            "end_token": -1,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "label": "input_default",
                                                                    "start_token": 2466,
                                                                    "end_token": 2468,
                                                                    "children": []
                                                                },
                                                                {
                                                                    "type": "attribute",
                                                                    "label": "node.input_default",
                                                                    "start_token": 2469,
                                                                    "end_token": -1,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "node",
                                                                            "start_token": 2469,
                                                                            "end_token": 2470,
                                                                            "children": []
                                                                        },
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "input_default",
                                                                            "start_token": 2470,
                                                                            "end_token": -1,
                                                                            "children": []
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                }
                                            ]
                                        }
                                    ]
                                }
                            ]
                        },
                        {
                            "type": "comment",
                            "label": "# Input data (without default values) should contain all required fields.",
                            "start_token": 2474,
                            "end_token": -1,
                            "children": []
                        },
                        {
                            "type": "expression_statement",
                            "label": "error_prefix = f\"Input data missing or mismatch for `{node_block.name}`:\"",
                            "start_token": 2488,
                            "end_token": -1,
                            "children": [
                                {
                                    "type": "assignment",
                                    "label": "error_prefix = f\"Input data missing or mismatch for `{node_block.name}`:\"",
                                    "start_token": 2488,
                                    "end_token": -1,
                                    "children": [
                                        {
                                            "type": "identifier",
                                            "label": "error_prefix",
                                            "start_token": 2488,
                                            "end_token": 2490,
                                            "children": []
                                        },
                                        {
                                            "type": "string",
                                            "label": "f\"Input data missing or mismatch for `{node_block.name}`:\"",
                                            "start_token": 2491,
                                            "end_token": -1,
                                            "children": [
                                                {
                                                    "type": "string_start",
                                                    "label": "f\"",
                                                    "start_token": 2491,
                                                    "end_token": 2491,
                                                    "children": []
                                                },
                                                {
                                                    "type": "string_content",
                                                    "label": "Input data missing or mismatch for `",
                                                    "start_token": 2491,
                                                    "end_token": 2491,
                                                    "children": []
                                                },
                                                {
                                                    "type": "interpolation",
                                                    "label": "{node_block.name}",
                                                    "start_token": 2491,
                                                    "end_token": 2492,
                                                    "children": [
                                                        {
                                                            "type": "attribute",
                                                            "label": "node_block.name",
                                                            "start_token": 2491,
                                                            "end_token": 2491,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "label": "node_block",
                                                                    "start_token": 2491,
                                                                    "end_token": 2491,
                                                                    "children": []
                                                                },
                                                                {
                                                                    "type": "identifier",
                                                                    "label": "name",
                                                                    "start_token": 2491,
                                                                    "end_token": 2491,
                                                                    "children": []
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                },
                                                {
                                                    "type": "string_content",
                                                    "label": "`:",
                                                    "start_token": -1,
                                                    "end_token": -1,
                                                    "children": []
                                                },
                                                {
                                                    "type": "string_end",
                                                    "label": "\"",
                                                    "start_token": -1,
                                                    "end_token": -1,
                                                    "children": []
                                                }
                                            ]
                                        }
                                    ]
                                }
                            ]
                        },
                        {
                            "type": "expression_statement",
                            "label": "input_fields_from_nodes = {link.sink_name for link in node.input_links}",
                            "start_token": 2493,
                            "end_token": -1,
                            "children": [
                                {
                                    "type": "assignment",
                                    "label": "input_fields_from_nodes = {link.sink_name for link in node.input_links}",
                                    "start_token": 2493,
                                    "end_token": -1,
                                    "children": [
                                        {
                                            "type": "identifier",
                                            "label": "input_fields_from_nodes",
                                            "start_token": 2493,
                                            "end_token": 2495,
                                            "children": []
                                        },
                                        {
                                            "type": "set_comprehension",
                                            "label": "{link.sink_name for link in node.input_links}",
                                            "start_token": 2496,
                                            "end_token": -1,
                                            "children": [
                                                {
                                                    "type": "attribute",
                                                    "label": "link.sink_name",
                                                    "start_token": 2497,
                                                    "end_token": 2499,
                                                    "children": [
                                                        {
                                                            "type": "identifier",
                                                            "label": "link",
                                                            "start_token": 2497,
                                                            "end_token": 2498,
                                                            "children": []
                                                        },
                                                        {
                                                            "type": "identifier",
                                                            "label": "sink_name",
                                                            "start_token": 2498,
                                                            "end_token": 2499,
                                                            "children": []
                                                        }
                                                    ]
                                                },
                                                {
                                                    "type": "for_in_clause",
                                                    "label": "for link in node.input_links",
                                                    "start_token": 2500,
                                                    "end_token": -1,
                                                    "children": [
                                                        {
                                                            "type": "identifier",
                                                            "label": "link",
                                                            "start_token": -1,
                                                            "end_token": -1,
                                                            "children": []
                                                        },
                                                        {
                                                            "type": "attribute",
                                                            "label": "node.input_links",
                                                            "start_token": 2503,
                                                            "end_token": -1,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "label": "node",
                                                                    "start_token": 2503,
                                                                    "end_token": 2504,
                                                                    "children": []
                                                                },
                                                                {
                                                                    "type": "identifier",
                                                                    "label": "input_links",
                                                                    "start_token": 2504,
                                                                    "end_token": -1,
                                                                    "children": []
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                }
                                            ]
                                        }
                                    ]
                                }
                            ]
                        },
                        {
                            "type": "if_statement",
                            "label": "if not input_fields_from_nodes.issubset(data):\n        return None, f\"{error_prefix} {input_fields_from_nodes - set(data)}\"",
                            "start_token": 2508,
                            "end_token": -1,
                            "children": [
                                {
                                    "type": "not_operator",
                                    "label": "not input_fields_from_nodes.issubset(data)",
                                    "start_token": 2509,
                                    "end_token": -1,
                                    "children": [
                                        {
                                            "type": "call",
                                            "label": "input_fields_from_nodes.issubset(data)",
                                            "start_token": 2509,
                                            "end_token": -1,
                                            "children": [
                                                {
                                                    "type": "attribute",
                                                    "label": "input_fields_from_nodes.issubset",
                                                    "start_token": 2509,
                                                    "end_token": 2513,
                                                    "children": [
                                                        {
                                                            "type": "identifier",
                                                            "label": "input_fields_from_nodes",
                                                            "start_token": 2509,
                                                            "end_token": 2511,
                                                            "children": []
                                                        },
                                                        {
                                                            "type": "identifier",
                                                            "label": "issubset",
                                                            "start_token": 2511,
                                                            "end_token": 2513,
                                                            "children": []
                                                        }
                                                    ]
                                                },
                                                {
                                                    "type": "argument_list",
                                                    "label": "(data)",
                                                    "start_token": 2513,
                                                    "end_token": -1,
                                                    "children": [
                                                        {
                                                            "type": "identifier",
                                                            "label": "data",
                                                            "start_token": 2514,
                                                            "end_token": -1,
                                                            "children": []
                                                        }
                                                    ]
                                                }
                                            ]
                                        }
                                    ]
                                },
                                {
                                    "type": "block",
                                    "label": "return None, f\"{error_prefix} {input_fields_from_nodes - set(data)}\"",
                                    "start_token": 2517,
                                    "end_token": -1,
                                    "children": [
                                        {
                                            "type": "return_statement",
                                            "label": "return None, f\"{error_prefix} {input_fields_from_nodes - set(data)}\"",
                                            "start_token": 2517,
                                            "end_token": -1,
                                            "children": [
                                                {
                                                    "type": "expression_list",
                                                    "label": "None, f\"{error_prefix} {input_fields_from_nodes - set(data)}\"",
                                                    "start_token": 2519,
                                                    "end_token": -1,
                                                    "children": [
                                                        {
                                                            "type": "none",
                                                            "label": "None",
                                                            "start_token": 2519,
                                                            "end_token": 2521,
                                                            "children": []
                                                        },
                                                        {
                                                            "type": "string",
                                                            "label": "f\"{error_prefix} {input_fields_from_nodes - set(data)}\"",
                                                            "start_token": 2521,
                                                            "end_token": -1,
                                                            "children": [
                                                                {
                                                                    "type": "string_start",
                                                                    "label": "f\"",
                                                                    "start_token": 2521,
                                                                    "end_token": 2521,
                                                                    "children": []
                                                                },
                                                                {
                                                                    "type": "interpolation",
                                                                    "label": "{error_prefix}",
                                                                    "start_token": 2521,
                                                                    "end_token": 2521,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "error_prefix",
                                                                            "start_token": 2521,
                                                                            "end_token": 2521,
                                                                            "children": []
                                                                        }
                                                                    ]
                                                                },
                                                                {
                                                                    "type": "string_content",
                                                                    "label": " ",
                                                                    "start_token": 2521,
                                                                    "end_token": 2521,
                                                                    "children": []
                                                                },
                                                                {
                                                                    "type": "interpolation",
                                                                    "label": "{input_fields_from_nodes - set(data)}",
                                                                    "start_token": 2521,
                                                                    "end_token": -1,
                                                                    "children": [
                                                                        {
                                                                            "type": "binary_operator",
                                                                            "label": "input_fields_from_nodes - set(data)",
                                                                            "start_token": 2521,
                                                                            "end_token": 2523,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "input_fields_from_nodes",
                                                                                    "start_token": 2521,
                                                                                    "end_token": 2521,
                                                                                    "children": []
                                                                                },
                                                                                {
                                                                                    "type": "call",
                                                                                    "label": "set(data)",
                                                                                    "start_token": 2521,
                                                                                    "end_token": 2523,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "label": "set",
                                                                                            "start_token": 2521,
                                                                                            "end_token": 2521,
                                                                                            "children": []
                                                                                        },
                                                                                        {
                                                                                            "type": "argument_list",
                                                                                            "label": "(data)",
                                                                                            "start_token": 2521,
                                                                                            "end_token": 2523,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "label": "data",
                                                                                                    "start_token": 2521,
                                                                                                    "end_token": 2522,
                                                                                                    "children": []
                                                                                                }
                                                                                            ]
                                                                                        }
                                                                                    ]
                                                                                }
                                                                            ]
                                                                        }
                                                                    ]
                                                                },
                                                                {
                                                                    "type": "string_end",
                                                                    "label": "\"",
                                                                    "start_token": -1,
                                                                    "end_token": -1,
                                                                    "children": []
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                }
                                            ]
                                        }
                                    ]
                                }
                            ]
                        },
                        {
                            "type": "comment",
                            "label": "# Merge input data with default values and resolve dynamic dict/list/object pins.",
                            "start_token": 2525,
                            "end_token": -1,
                            "children": []
                        },
                        {
                            "type": "expression_statement",
                            "label": "data = {**input_default, **data}",
                            "start_token": -1,
                            "end_token": -1,
                            "children": [
                                {
                                    "type": "assignment",
                                    "label": "data = {**input_default, **data}",
                                    "start_token": -1,
                                    "end_token": -1,
                                    "children": [
                                        {
                                            "type": "identifier",
                                            "label": "data",
                                            "start_token": -1,
                                            "end_token": 2544,
                                            "children": []
                                        },
                                        {
                                            "type": "dictionary",
                                            "label": "{**input_default, **data}",
                                            "start_token": 2547,
                                            "end_token": -1,
                                            "children": [
                                                {
                                                    "type": "dictionary_splat",
                                                    "label": "**input_default",
                                                    "start_token": 2547,
                                                    "end_token": 2550,
                                                    "children": [
                                                        {
                                                            "type": "identifier",
                                                            "label": "input_default",
                                                            "start_token": 2547,
                                                            "end_token": 2550,
                                                            "children": []
                                                        }
                                                    ]
                                                },
                                                {
                                                    "type": "dictionary_splat",
                                                    "label": "**data",
                                                    "start_token": 2551,
                                                    "end_token": -1,
                                                    "children": [
                                                        {
                                                            "type": "identifier",
                                                            "label": "data",
                                                            "start_token": 2552,
                                                            "end_token": -1,
                                                            "children": []
                                                        }
                                                    ]
                                                }
                                            ]
                                        }
                                    ]
                                }
                            ]
                        },
                        {
                            "type": "if_statement",
                            "label": "if resolve_input:\n        data = merge_execution_input(data)",
                            "start_token": 2555,
                            "end_token": -1,
                            "children": [
                                {
                                    "type": "identifier",
                                    "label": "resolve_input",
                                    "start_token": 2555,
                                    "end_token": -1,
                                    "children": []
                                },
                                {
                                    "type": "block",
                                    "label": "data = merge_execution_input(data)",
                                    "start_token": -1,
                                    "end_token": -1,
                                    "children": [
                                        {
                                            "type": "expression_statement",
                                            "label": "data = merge_execution_input(data)",
                                            "start_token": -1,
                                            "end_token": -1,
                                            "children": [
                                                {
                                                    "type": "assignment",
                                                    "label": "data = merge_execution_input(data)",
                                                    "start_token": -1,
                                                    "end_token": -1,
                                                    "children": [
                                                        {
                                                            "type": "identifier",
                                                            "label": "data",
                                                            "start_token": -1,
                                                            "end_token": 2560,
                                                            "children": []
                                                        },
                                                        {
                                                            "type": "call",
                                                            "label": "merge_execution_input(data)",
                                                            "start_token": 2560,
                                                            "end_token": -1,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "label": "merge_execution_input",
                                                                    "start_token": 2560,
                                                                    "end_token": 2562,
                                                                    "children": []
                                                                },
                                                                {
                                                                    "type": "argument_list",
                                                                    "label": "(data)",
                                                                    "start_token": 2562,
                                                                    "end_token": -1,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "data",
                                                                            "start_token": 2563,
                                                                            "end_token": -1,
                                                                            "children": []
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                }
                                            ]
                                        }
                                    ]
                                }
                            ]
                        },
                        {
                            "type": "comment",
                            "label": "# Input data post-merge should contain all required fields from the schema.",
                            "start_token": 2567,
                            "end_token": -1,
                            "children": []
                        },
                        {
                            "type": "if_statement",
                            "label": "if not required_fields.issubset(data):\n        return None, f\"{error_prefix} {required_fields - set(data)}\"",
                            "start_token": 2583,
                            "end_token": -1,
                            "children": [
                                {
                                    "type": "not_operator",
                                    "label": "not required_fields.issubset(data)",
                                    "start_token": 2584,
                                    "end_token": -1,
                                    "children": [
                                        {
                                            "type": "call",
                                            "label": "required_fields.issubset(data)",
                                            "start_token": 2584,
                                            "end_token": -1,
                                            "children": [
                                                {
                                                    "type": "attribute",
                                                    "label": "required_fields.issubset",
                                                    "start_token": 2584,
                                                    "end_token": 2588,
                                                    "children": [
                                                        {
                                                            "type": "identifier",
                                                            "label": "required_fields",
                                                            "start_token": 2584,
                                                            "end_token": 2586,
                                                            "children": []
                                                        },
                                                        {
                                                            "type": "identifier",
                                                            "label": "issubset",
                                                            "start_token": 2586,
                                                            "end_token": 2588,
                                                            "children": []
                                                        }
                                                    ]
                                                },
                                                {
                                                    "type": "argument_list",
                                                    "label": "(data)",
                                                    "start_token": 2588,
                                                    "end_token": -1,
                                                    "children": [
                                                        {
                                                            "type": "identifier",
                                                            "label": "data",
                                                            "start_token": 2589,
                                                            "end_token": -1,
                                                            "children": []
                                                        }
                                                    ]
                                                }
                                            ]
                                        }
                                    ]
                                },
                                {
                                    "type": "block",
                                    "label": "return None, f\"{error_prefix} {required_fields - set(data)}\"",
                                    "start_token": 2592,
                                    "end_token": -1,
                                    "children": [
                                        {
                                            "type": "return_statement",
                                            "label": "return None, f\"{error_prefix} {required_fields - set(data)}\"",
                                            "start_token": 2592,
                                            "end_token": -1,
                                            "children": [
                                                {
                                                    "type": "expression_list",
                                                    "label": "None, f\"{error_prefix} {required_fields - set(data)}\"",
                                                    "start_token": 2594,
                                                    "end_token": -1,
                                                    "children": [
                                                        {
                                                            "type": "none",
                                                            "label": "None",
                                                            "start_token": 2594,
                                                            "end_token": 2596,
                                                            "children": []
                                                        },
                                                        {
                                                            "type": "string",
                                                            "label": "f\"{error_prefix} {required_fields - set(data)}\"",
                                                            "start_token": 2596,
                                                            "end_token": -1,
                                                            "children": [
                                                                {
                                                                    "type": "string_start",
                                                                    "label": "f\"",
                                                                    "start_token": 2596,
                                                                    "end_token": 2596,
                                                                    "children": []
                                                                },
                                                                {
                                                                    "type": "interpolation",
                                                                    "label": "{error_prefix}",
                                                                    "start_token": 2596,
                                                                    "end_token": 2596,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "error_prefix",
                                                                            "start_token": 2596,
                                                                            "end_token": 2596,
                                                                            "children": []
                                                                        }
                                                                    ]
                                                                },
                                                                {
                                                                    "type": "string_content",
                                                                    "label": " ",
                                                                    "start_token": 2596,
                                                                    "end_token": 2596,
                                                                    "children": []
                                                                },
                                                                {
                                                                    "type": "interpolation",
                                                                    "label": "{required_fields - set(data)}",
                                                                    "start_token": 2596,
                                                                    "end_token": -1,
                                                                    "children": [
                                                                        {
                                                                            "type": "binary_operator",
                                                                            "label": "required_fields - set(data)",
                                                                            "start_token": 2596,
                                                                            "end_token": 2598,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "required_fields",
                                                                                    "start_token": 2596,
                                                                                    "end_token": 2596,
                                                                                    "children": []
                                                                                },
                                                                                {
                                                                                    "type": "call",
                                                                                    "label": "set(data)",
                                                                                    "start_token": 2596,
                                                                                    "end_token": 2598,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "label": "set",
                                                                                            "start_token": 2596,
                                                                                            "end_token": 2596,
                                                                                            "children": []
                                                                                        },
                                                                                        {
                                                                                            "type": "argument_list",
                                                                                            "label": "(data)",
                                                                                            "start_token": 2596,
                                                                                            "end_token": 2598,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "label": "data",
                                                                                                    "start_token": 2596,
                                                                                                    "end_token": 2597,
                                                                                                    "children": []
                                                                                                }
                                                                                            ]
                                                                                        }
                                                                                    ]
                                                                                }
                                                                            ]
                                                                        }
                                                                    ]
                                                                },
                                                                {
                                                                    "type": "string_end",
                                                                    "label": "\"",
                                                                    "start_token": -1,
                                                                    "end_token": -1,
                                                                    "children": []
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                }
                                            ]
                                        }
                                    ]
                                }
                            ]
                        },
                        {
                            "type": "comment",
                            "label": "# Last validation: Validate the input values against the schema.",
                            "start_token": 2600,
                            "end_token": -1,
                            "children": []
                        },
                        {
                            "type": "if_statement",
                            "label": "if error := json.validate_with_jsonschema(schema=input_schema, data=data):\n        error_message = f\"{error_prefix} {error}\"\n        logger.error(error_message)\n        return None, error_message",
                            "start_token": 2613,
                            "end_token": -1,
                            "children": [
                                {
                                    "type": "named_expression",
                                    "label": "error := json.validate_with_jsonschema(schema=input_schema, data=data)",
                                    "start_token": 2613,
                                    "end_token": -1,
                                    "children": [
                                        {
                                            "type": "identifier",
                                            "label": "error",
                                            "start_token": 2613,
                                            "end_token": -1,
                                            "children": []
                                        },
                                        {
                                            "type": "call",
                                            "label": "json.validate_with_jsonschema(schema=input_schema, data=data)",
                                            "start_token": 2617,
                                            "end_token": -1,
                                            "children": [
                                                {
                                                    "type": "attribute",
                                                    "label": "json.validate_with_jsonschema",
                                                    "start_token": 2617,
                                                    "end_token": 2620,
                                                    "children": [
                                                        {
                                                            "type": "identifier",
                                                            "label": "json",
                                                            "start_token": 2617,
                                                            "end_token": 2618,
                                                            "children": []
                                                        },
                                                        {
                                                            "type": "identifier",
                                                            "label": "validate_with_jsonschema",
                                                            "start_token": 2618,
                                                            "end_token": 2620,
                                                            "children": []
                                                        }
                                                    ]
                                                },
                                                {
                                                    "type": "argument_list",
                                                    "label": "(schema=input_schema, data=data)",
                                                    "start_token": 2620,
                                                    "end_token": -1,
                                                    "children": [
                                                        {
                                                            "type": "keyword_argument",
                                                            "label": "schema=input_schema",
                                                            "start_token": 2620,
                                                            "end_token": 2624,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "label": "schema",
                                                                    "start_token": 2620,
                                                                    "end_token": 2622,
                                                                    "children": []
                                                                },
                                                                {
                                                                    "type": "identifier",
                                                                    "label": "input_schema",
                                                                    "start_token": 2622,
                                                                    "end_token": 2624,
                                                                    "children": []
                                                                }
                                                            ]
                                                        },
                                                        {
                                                            "type": "keyword_argument",
                                                            "label": "data=data",
                                                            "start_token": 2625,
                                                            "end_token": -1,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "label": "data",
                                                                    "start_token": 2625,
                                                                    "end_token": 2626,
                                                                    "children": []
                                                                },
                                                                {
                                                                    "type": "identifier",
                                                                    "label": "data",
                                                                    "start_token": 2627,
                                                                    "end_token": -1,
                                                                    "children": []
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                }
                                            ]
                                        }
                                    ]
                                },
                                {
                                    "type": "block",
                                    "label": "error_message = f\"{error_prefix} {error}\"\n        logger.error(error_message)\n        return None, error_message",
                                    "start_token": 2630,
                                    "end_token": -1,
                                    "children": [
                                        {
                                            "type": "expression_statement",
                                            "label": "error_message = f\"{error_prefix} {error}\"",
                                            "start_token": 2630,
                                            "end_token": -1,
                                            "children": [
                                                {
                                                    "type": "assignment",
                                                    "label": "error_message = f\"{error_prefix} {error}\"",
                                                    "start_token": 2630,
                                                    "end_token": -1,
                                                    "children": [
                                                        {
                                                            "type": "identifier",
                                                            "label": "error_message",
                                                            "start_token": 2630,
                                                            "end_token": 2632,
                                                            "children": []
                                                        },
                                                        {
                                                            "type": "string",
                                                            "label": "f\"{error_prefix} {error}\"",
                                                            "start_token": 2633,
                                                            "end_token": -1,
                                                            "children": [
                                                                {
                                                                    "type": "string_start",
                                                                    "label": "f\"",
                                                                    "start_token": 2633,
                                                                    "end_token": 2633,
                                                                    "children": []
                                                                },
                                                                {
                                                                    "type": "interpolation",
                                                                    "label": "{error_prefix}",
                                                                    "start_token": 2633,
                                                                    "end_token": 2633,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "error_prefix",
                                                                            "start_token": 2633,
                                                                            "end_token": 2633,
                                                                            "children": []
                                                                        }
                                                                    ]
                                                                },
                                                                {
                                                                    "type": "string_content",
                                                                    "label": " ",
                                                                    "start_token": 2633,
                                                                    "end_token": 2633,
                                                                    "children": []
                                                                },
                                                                {
                                                                    "type": "interpolation",
                                                                    "label": "{error}",
                                                                    "start_token": 2633,
                                                                    "end_token": -1,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "error",
                                                                            "start_token": 2633,
                                                                            "end_token": -1,
                                                                            "children": []
                                                                        }
                                                                    ]
                                                                },
                                                                {
                                                                    "type": "string_end",
                                                                    "label": "\"",
                                                                    "start_token": -1,
                                                                    "end_token": -1,
                                                                    "children": []
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                }
                                            ]
                                        },
                                        {
                                            "type": "expression_statement",
                                            "label": "logger.error(error_message)",
                                            "start_token": 2635,
                                            "end_token": -1,
                                            "children": [
                                                {
                                                    "type": "call",
                                                    "label": "logger.error(error_message)",
                                                    "start_token": 2635,
                                                    "end_token": -1,
                                                    "children": [
                                                        {
                                                            "type": "attribute",
                                                            "label": "logger.error",
                                                            "start_token": 2635,
                                                            "end_token": 2639,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "label": "logger",
                                                                    "start_token": 2635,
                                                                    "end_token": 2637,
                                                                    "children": []
                                                                },
                                                                {
                                                                    "type": "identifier",
                                                                    "label": "error",
                                                                    "start_token": 2637,
                                                                    "end_token": 2639,
                                                                    "children": []
                                                                }
                                                            ]
                                                        },
                                                        {
                                                            "type": "argument_list",
                                                            "label": "(error_message)",
                                                            "start_token": 2639,
                                                            "end_token": -1,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "label": "error_message",
                                                                    "start_token": 2639,
                                                                    "end_token": -1,
                                                                    "children": []
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                }
                                            ]
                                        },
                                        {
                                            "type": "return_statement",
                                            "label": "return None, error_message",
                                            "start_token": 2642,
                                            "end_token": -1,
                                            "children": [
                                                {
                                                    "type": "expression_list",
                                                    "label": "None, error_message",
                                                    "start_token": 2644,
                                                    "end_token": -1,
                                                    "children": [
                                                        {
                                                            "type": "none",
                                                            "label": "None",
                                                            "start_token": 2644,
                                                            "end_token": 2645,
                                                            "children": []
                                                        },
                                                        {
                                                            "type": "identifier",
                                                            "label": "error_message",
                                                            "start_token": 2645,
                                                            "end_token": -1,
                                                            "children": []
                                                        }
                                                    ]
                                                }
                                            ]
                                        }
                                    ]
                                }
                            ]
                        },
                        {
                            "type": "return_statement",
                            "label": "return data, node_block.name",
                            "start_token": 2648,
                            "end_token": 2657,
                            "children": [
                                {
                                    "type": "expression_list",
                                    "label": "data, node_block.name",
                                    "start_token": 2650,
                                    "end_token": 2657,
                                    "children": [
                                        {
                                            "type": "identifier",
                                            "label": "data",
                                            "start_token": 2650,
                                            "end_token": 2651,
                                            "children": []
                                        },
                                        {
                                            "type": "attribute",
                                            "label": "node_block.name",
                                            "start_token": 2651,
                                            "end_token": 2657,
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "label": "node_block",
                                                    "start_token": 2651,
                                                    "end_token": 2653,
                                                    "children": []
                                                },
                                                {
                                                    "type": "identifier",
                                                    "label": "name",
                                                    "start_token": 2654,
                                                    "end_token": 2657,
                                                    "children": []
                                                }
                                            ]
                                        }
                                    ]
                                }
                            ]
                        }
                    ]
                }
            ]
        },
        {
            "type": "class_definition",
            "label": "class Executor:\n    \"\"\"\n    This class contains event handlers for the process pool executor events.\n\n    The main events are:\n        on_node_executor_start: Initialize the process that executes the node.\n        on_node_execution: Execution logic for a node.\n\n        on_graph_executor_start: Initialize the process that executes the graph.\n        on_graph_execution: Execution logic for a graph.\n\n    The execution flow:\n        1. Graph execution request is added to the queue.\n        2. Graph executor loop picks the request from the queue.\n        3. Graph executor loop submits the graph execution request to the executor pool.\n      [on_graph_execution]\n        4. Graph executor initialize the node execution queue.\n        5. Graph executor adds the starting nodes to the node execution queue.\n        6. Graph executor waits for all nodes to be executed.\n      [on_node_execution]\n        7. Node executor picks the node execution request from the queue.\n        8. Node executor executes the node.\n        9. Node executor enqueues the next executed nodes to the node execution queue.\n    \"\"\"\n\n    @classmethod\n    def on_node_executor_start(cls):\n        configure_logging()\n        set_service_name(\"NodeExecutor\")\n        redis.connect()\n        cls.pid = os.getpid()\n        cls.db_client = get_db_client()\n        cls.creds_manager = IntegrationCredentialsManager()\n\n        # Set up shutdown handlers\n        cls.shutdown_lock = threading.Lock()\n        atexit.register(cls.on_node_executor_stop)  # handle regular shutdown\n        signal.signal(  # handle termination\n            signal.SIGTERM, lambda _, __: cls.on_node_executor_sigterm()\n        )\n\n    @classmethod\n    def on_node_executor_stop(cls):\n        if not cls.shutdown_lock.acquire(blocking=False):\n            return  # already shutting down\n\n        logger.info(f\"[on_node_executor_stop {cls.pid}] ⏳ Releasing locks...\")\n        cls.creds_manager.release_all_locks()\n        logger.info(f\"[on_node_executor_stop {cls.pid}] ⏳ Disconnecting Redis...\")\n        redis.disconnect()\n        logger.info(f\"[on_node_executor_stop {cls.pid}] ⏳ Disconnecting DB manager...\")\n        close_service_client(cls.db_client)\n        logger.info(f\"[on_node_executor_stop {cls.pid}] ✅ Finished cleanup\")\n\n    @classmethod\n    def on_node_executor_sigterm(cls):\n        llprint(f\"[on_node_executor_sigterm {cls.pid}] ⚠️ SIGTERM received\")\n        if not cls.shutdown_lock.acquire(blocking=False):\n            return  # already shutting down\n\n        llprint(f\"[on_node_executor_stop {cls.pid}] ⏳ Releasing locks...\")\n        cls.creds_manager.release_all_locks()\n        llprint(f\"[on_node_executor_stop {cls.pid}] ⏳ Disconnecting Redis...\")\n        redis.disconnect()\n        llprint(f\"[on_node_executor_stop {cls.pid}] ✅ Finished cleanup\")\n        sys.exit(0)\n\n    @classmethod\n    @error_logged\n    def on_node_execution(\n        cls,\n        q: ExecutionQueue[NodeExecutionEntry],\n        node_exec: NodeExecutionEntry,\n    ) -> dict[str, Any]:\n        log_metadata = LogMetadata(\n            user_id=node_exec.user_id,\n            graph_eid=node_exec.graph_exec_id,\n            graph_id=node_exec.graph_id,\n            node_eid=node_exec.node_exec_id,\n            node_id=node_exec.node_id,\n            block_name=\"-\",\n        )\n\n        execution_stats = {}\n        timing_info, _ = cls._on_node_execution(\n            q, node_exec, log_metadata, execution_stats\n        )\n        execution_stats[\"walltime\"] = timing_info.wall_time\n        execution_stats[\"cputime\"] = timing_info.cpu_time\n\n        cls.db_client.update_node_execution_stats(\n            node_exec.node_exec_id, execution_stats\n        )\n        return execution_stats\n\n    @classmethod\n    @time_measured\n    def _on_node_execution(\n        cls,\n        q: ExecutionQueue[NodeExecutionEntry],\n        node_exec: NodeExecutionEntry,\n        log_metadata: LogMetadata,\n        stats: dict[str, Any] | None = None,\n    ):\n        try:\n            log_metadata.info(f\"Start node execution {node_exec.node_exec_id}\")\n            for execution in execute_node(\n                cls.db_client, cls.creds_manager, node_exec, stats\n            ):\n                q.add(execution)\n            log_metadata.info(f\"Finished node execution {node_exec.node_exec_id}\")\n        except Exception as e:\n            log_metadata.exception(\n                f\"Failed node execution {node_exec.node_exec_id}: {e}\"\n            )\n\n    @classmethod\n    def on_graph_executor_start(cls):\n        configure_logging()\n        set_service_name(\"GraphExecutor\")\n\n        cls.db_client = get_db_client()\n        cls.pool_size = settings.config.num_node_workers\n        cls.pid = os.getpid()\n        cls._init_node_executor_pool()\n        logger.info(\n            f\"Graph executor {cls.pid} started with {cls.pool_size} node workers\"\n        )\n\n        # Set up shutdown handler\n        atexit.register(cls.on_graph_executor_stop)\n\n    @classmethod\n    def on_graph_executor_stop(cls):\n        prefix = f\"[on_graph_executor_stop {cls.pid}]\"\n        logger.info(f\"{prefix} ⏳ Terminating node executor pool...\")\n        cls.executor.terminate()\n        logger.info(f\"{prefix} ⏳ Disconnecting DB manager...\")\n        close_service_client(cls.db_client)\n        logger.info(f\"{prefix} ✅ Finished cleanup\")\n\n    @classmethod\n    def _init_node_executor_pool(cls):\n        cls.executor = Pool(\n            processes=cls.pool_size,\n            initializer=cls.on_node_executor_start,\n        )\n\n    @classmethod\n    @error_logged\n    def on_graph_execution(\n        cls, graph_exec: GraphExecutionEntry, cancel: threading.Event\n    ):\n        log_metadata = LogMetadata(\n            user_id=graph_exec.user_id,\n            graph_eid=graph_exec.graph_exec_id,\n            graph_id=graph_exec.graph_id,\n            node_id=\"*\",\n            node_eid=\"*\",\n            block_name=\"-\",\n        )\n        timing_info, (exec_stats, error) = cls._on_graph_execution(\n            graph_exec, cancel, log_metadata\n        )\n        exec_stats[\"walltime\"] = timing_info.wall_time\n        exec_stats[\"cputime\"] = timing_info.cpu_time\n        exec_stats[\"error\"] = str(error) if error else None\n        result = cls.db_client.update_graph_execution_stats(\n            graph_exec_id=graph_exec.graph_exec_id,\n            stats=exec_stats,\n        )\n        cls.db_client.send_execution_update(result)\n\n    @classmethod\n    @time_measured\n    def _on_graph_execution(\n        cls,\n        graph_exec: GraphExecutionEntry,\n        cancel: threading.Event,\n        log_metadata: LogMetadata,\n    ) -> tuple[dict[str, Any], Exception | None]:\n        \"\"\"\n        Returns:\n            The execution statistics of the graph execution.\n            The error that occurred during the execution.\n        \"\"\"\n        log_metadata.info(f\"Start graph execution {graph_exec.graph_exec_id}\")\n        exec_stats = {\n            \"nodes_walltime\": 0,\n            \"nodes_cputime\": 0,\n            \"node_count\": 0,\n        }\n        error = None\n        finished = False\n\n        def cancel_handler():\n            while not cancel.is_set():\n                cancel.wait(1)\n            if finished:\n                return\n            cls.executor.terminate()\n            log_metadata.info(f\"Terminated graph execution {graph_exec.graph_exec_id}\")\n            cls._init_node_executor_pool()\n\n        cancel_thread = threading.Thread(target=cancel_handler)\n        cancel_thread.start()\n\n        try:\n            queue = ExecutionQueue[NodeExecutionEntry]()\n            for node_exec in graph_exec.start_node_execs:\n                queue.add(node_exec)\n\n            running_executions: dict[str, AsyncResult] = {}\n\n            def make_exec_callback(exec_data: NodeExecutionEntry):\n                node_id = exec_data.node_id\n\n                def callback(result: object):\n                    running_executions.pop(node_id)\n                    nonlocal exec_stats\n                    if isinstance(result, dict):\n                        exec_stats[\"node_count\"] += 1\n                        exec_stats[\"nodes_cputime\"] += result.get(\"cputime\", 0)\n                        exec_stats[\"nodes_walltime\"] += result.get(\"walltime\", 0)\n\n                return callback\n\n            while not queue.empty():\n                if cancel.is_set():\n                    error = RuntimeError(\"Execution is cancelled\")\n                    return exec_stats, error\n\n                exec_data = queue.get()\n\n                # Avoid parallel execution of the same node.\n                execution = running_executions.get(exec_data.node_id)\n                if execution and not execution.ready():\n                    # TODO (performance improvement):\n                    #   Wait for the completion of the same node execution is blocking.\n                    #   To improve this we need a separate queue for each node.\n                    #   Re-enqueueing the data back to the queue will disrupt the order.\n                    execution.wait()\n\n                log_metadata.debug(\n                    f\"Dispatching node execution {exec_data.node_exec_id} \"\n                    f\"for node {exec_data.node_id}\",\n                )\n                running_executions[exec_data.node_id] = cls.executor.apply_async(\n                    cls.on_node_execution,\n                    (queue, exec_data),\n                    callback=make_exec_callback(exec_data),\n                )\n\n                # Avoid terminating graph execution when some nodes are still running.\n                while queue.empty() and running_executions:\n                    log_metadata.debug(\n                        f\"Queue empty; running nodes: {list(running_executions.keys())}\"\n                    )\n                    for node_id, execution in list(running_executions.items()):\n                        if cancel.is_set():\n                            error = RuntimeError(\"Execution is cancelled\")\n                            return exec_stats, error\n\n                        if not queue.empty():\n                            break  # yield to parent loop to execute new queue items\n\n                        log_metadata.debug(f\"Waiting on execution of node {node_id}\")\n                        execution.wait(3)\n\n            log_metadata.info(f\"Finished graph execution {graph_exec.graph_exec_id}\")\n        except Exception as e:\n            log_metadata.exception(\n                f\"Failed graph execution {graph_exec.graph_exec_id}: {e}\"\n            )\n            error = e\n        finally:\n            if not cancel.is_set():\n                finished = True\n                cancel.set()\n            cancel_thread.join()\n            return exec_stats, error",
            "start_token": 2657,
            "end_token": 4159,
            "children": [
                {
                    "type": "identifier",
                    "label": "Executor",
                    "start_token": 2658,
                    "end_token": -1,
                    "children": []
                },
                {
                    "type": "block",
                    "label": "\"\"\"\n    This class contains event handlers for the process pool executor events.\n\n    The main events are:\n        on_node_executor_start: Initialize the process that executes the node.\n        on_node_execution: Execution logic for a node.\n\n        on_graph_executor_start: Initialize the process that executes the graph.\n        on_graph_execution: Execution logic for a graph.\n\n    The execution flow:\n        1. Graph execution request is added to the queue.\n        2. Graph executor loop picks the request from the queue.\n        3. Graph executor loop submits the graph execution request to the executor pool.\n      [on_graph_execution]\n        4. Graph executor initialize the node execution queue.\n        5. Graph executor adds the starting nodes to the node execution queue.\n        6. Graph executor waits for all nodes to be executed.\n      [on_node_execution]\n        7. Node executor picks the node execution request from the queue.\n        8. Node executor executes the node.\n        9. Node executor enqueues the next executed nodes to the node execution queue.\n    \"\"\"\n\n    @classmethod\n    def on_node_executor_start(cls):\n        configure_logging()\n        set_service_name(\"NodeExecutor\")\n        redis.connect()\n        cls.pid = os.getpid()\n        cls.db_client = get_db_client()\n        cls.creds_manager = IntegrationCredentialsManager()\n\n        # Set up shutdown handlers\n        cls.shutdown_lock = threading.Lock()\n        atexit.register(cls.on_node_executor_stop)  # handle regular shutdown\n        signal.signal(  # handle termination\n            signal.SIGTERM, lambda _, __: cls.on_node_executor_sigterm()\n        )\n\n    @classmethod\n    def on_node_executor_stop(cls):\n        if not cls.shutdown_lock.acquire(blocking=False):\n            return  # already shutting down\n\n        logger.info(f\"[on_node_executor_stop {cls.pid}] ⏳ Releasing locks...\")\n        cls.creds_manager.release_all_locks()\n        logger.info(f\"[on_node_executor_stop {cls.pid}] ⏳ Disconnecting Redis...\")\n        redis.disconnect()\n        logger.info(f\"[on_node_executor_stop {cls.pid}] ⏳ Disconnecting DB manager...\")\n        close_service_client(cls.db_client)\n        logger.info(f\"[on_node_executor_stop {cls.pid}] ✅ Finished cleanup\")\n\n    @classmethod\n    def on_node_executor_sigterm(cls):\n        llprint(f\"[on_node_executor_sigterm {cls.pid}] ⚠️ SIGTERM received\")\n        if not cls.shutdown_lock.acquire(blocking=False):\n            return  # already shutting down\n\n        llprint(f\"[on_node_executor_stop {cls.pid}] ⏳ Releasing locks...\")\n        cls.creds_manager.release_all_locks()\n        llprint(f\"[on_node_executor_stop {cls.pid}] ⏳ Disconnecting Redis...\")\n        redis.disconnect()\n        llprint(f\"[on_node_executor_stop {cls.pid}] ✅ Finished cleanup\")\n        sys.exit(0)\n\n    @classmethod\n    @error_logged\n    def on_node_execution(\n        cls,\n        q: ExecutionQueue[NodeExecutionEntry],\n        node_exec: NodeExecutionEntry,\n    ) -> dict[str, Any]:\n        log_metadata = LogMetadata(\n            user_id=node_exec.user_id,\n            graph_eid=node_exec.graph_exec_id,\n            graph_id=node_exec.graph_id,\n            node_eid=node_exec.node_exec_id,\n            node_id=node_exec.node_id,\n            block_name=\"-\",\n        )\n\n        execution_stats = {}\n        timing_info, _ = cls._on_node_execution(\n            q, node_exec, log_metadata, execution_stats\n        )\n        execution_stats[\"walltime\"] = timing_info.wall_time\n        execution_stats[\"cputime\"] = timing_info.cpu_time\n\n        cls.db_client.update_node_execution_stats(\n            node_exec.node_exec_id, execution_stats\n        )\n        return execution_stats\n\n    @classmethod\n    @time_measured\n    def _on_node_execution(\n        cls,\n        q: ExecutionQueue[NodeExecutionEntry],\n        node_exec: NodeExecutionEntry,\n        log_metadata: LogMetadata,\n        stats: dict[str, Any] | None = None,\n    ):\n        try:\n            log_metadata.info(f\"Start node execution {node_exec.node_exec_id}\")\n            for execution in execute_node(\n                cls.db_client, cls.creds_manager, node_exec, stats\n            ):\n                q.add(execution)\n            log_metadata.info(f\"Finished node execution {node_exec.node_exec_id}\")\n        except Exception as e:\n            log_metadata.exception(\n                f\"Failed node execution {node_exec.node_exec_id}: {e}\"\n            )\n\n    @classmethod\n    def on_graph_executor_start(cls):\n        configure_logging()\n        set_service_name(\"GraphExecutor\")\n\n        cls.db_client = get_db_client()\n        cls.pool_size = settings.config.num_node_workers\n        cls.pid = os.getpid()\n        cls._init_node_executor_pool()\n        logger.info(\n            f\"Graph executor {cls.pid} started with {cls.pool_size} node workers\"\n        )\n\n        # Set up shutdown handler\n        atexit.register(cls.on_graph_executor_stop)\n\n    @classmethod\n    def on_graph_executor_stop(cls):\n        prefix = f\"[on_graph_executor_stop {cls.pid}]\"\n        logger.info(f\"{prefix} ⏳ Terminating node executor pool...\")\n        cls.executor.terminate()\n        logger.info(f\"{prefix} ⏳ Disconnecting DB manager...\")\n        close_service_client(cls.db_client)\n        logger.info(f\"{prefix} ✅ Finished cleanup\")\n\n    @classmethod\n    def _init_node_executor_pool(cls):\n        cls.executor = Pool(\n            processes=cls.pool_size,\n            initializer=cls.on_node_executor_start,\n        )\n\n    @classmethod\n    @error_logged\n    def on_graph_execution(\n        cls, graph_exec: GraphExecutionEntry, cancel: threading.Event\n    ):\n        log_metadata = LogMetadata(\n            user_id=graph_exec.user_id,\n            graph_eid=graph_exec.graph_exec_id,\n            graph_id=graph_exec.graph_id,\n            node_id=\"*\",\n            node_eid=\"*\",\n            block_name=\"-\",\n        )\n        timing_info, (exec_stats, error) = cls._on_graph_execution(\n            graph_exec, cancel, log_metadata\n        )\n        exec_stats[\"walltime\"] = timing_info.wall_time\n        exec_stats[\"cputime\"] = timing_info.cpu_time\n        exec_stats[\"error\"] = str(error) if error else None\n        result = cls.db_client.update_graph_execution_stats(\n            graph_exec_id=graph_exec.graph_exec_id,\n            stats=exec_stats,\n        )\n        cls.db_client.send_execution_update(result)\n\n    @classmethod\n    @time_measured\n    def _on_graph_execution(\n        cls,\n        graph_exec: GraphExecutionEntry,\n        cancel: threading.Event,\n        log_metadata: LogMetadata,\n    ) -> tuple[dict[str, Any], Exception | None]:\n        \"\"\"\n        Returns:\n            The execution statistics of the graph execution.\n            The error that occurred during the execution.\n        \"\"\"\n        log_metadata.info(f\"Start graph execution {graph_exec.graph_exec_id}\")\n        exec_stats = {\n            \"nodes_walltime\": 0,\n            \"nodes_cputime\": 0,\n            \"node_count\": 0,\n        }\n        error = None\n        finished = False\n\n        def cancel_handler():\n            while not cancel.is_set():\n                cancel.wait(1)\n            if finished:\n                return\n            cls.executor.terminate()\n            log_metadata.info(f\"Terminated graph execution {graph_exec.graph_exec_id}\")\n            cls._init_node_executor_pool()\n\n        cancel_thread = threading.Thread(target=cancel_handler)\n        cancel_thread.start()\n\n        try:\n            queue = ExecutionQueue[NodeExecutionEntry]()\n            for node_exec in graph_exec.start_node_execs:\n                queue.add(node_exec)\n\n            running_executions: dict[str, AsyncResult] = {}\n\n            def make_exec_callback(exec_data: NodeExecutionEntry):\n                node_id = exec_data.node_id\n\n                def callback(result: object):\n                    running_executions.pop(node_id)\n                    nonlocal exec_stats\n                    if isinstance(result, dict):\n                        exec_stats[\"node_count\"] += 1\n                        exec_stats[\"nodes_cputime\"] += result.get(\"cputime\", 0)\n                        exec_stats[\"nodes_walltime\"] += result.get(\"walltime\", 0)\n\n                return callback\n\n            while not queue.empty():\n                if cancel.is_set():\n                    error = RuntimeError(\"Execution is cancelled\")\n                    return exec_stats, error\n\n                exec_data = queue.get()\n\n                # Avoid parallel execution of the same node.\n                execution = running_executions.get(exec_data.node_id)\n                if execution and not execution.ready():\n                    # TODO (performance improvement):\n                    #   Wait for the completion of the same node execution is blocking.\n                    #   To improve this we need a separate queue for each node.\n                    #   Re-enqueueing the data back to the queue will disrupt the order.\n                    execution.wait()\n\n                log_metadata.debug(\n                    f\"Dispatching node execution {exec_data.node_exec_id} \"\n                    f\"for node {exec_data.node_id}\",\n                )\n                running_executions[exec_data.node_id] = cls.executor.apply_async(\n                    cls.on_node_execution,\n                    (queue, exec_data),\n                    callback=make_exec_callback(exec_data),\n                )\n\n                # Avoid terminating graph execution when some nodes are still running.\n                while queue.empty() and running_executions:\n                    log_metadata.debug(\n                        f\"Queue empty; running nodes: {list(running_executions.keys())}\"\n                    )\n                    for node_id, execution in list(running_executions.items()):\n                        if cancel.is_set():\n                            error = RuntimeError(\"Execution is cancelled\")\n                            return exec_stats, error\n\n                        if not queue.empty():\n                            break  # yield to parent loop to execute new queue items\n\n                        log_metadata.debug(f\"Waiting on execution of node {node_id}\")\n                        execution.wait(3)\n\n            log_metadata.info(f\"Finished graph execution {graph_exec.graph_exec_id}\")\n        except Exception as e:\n            log_metadata.exception(\n                f\"Failed graph execution {graph_exec.graph_exec_id}: {e}\"\n            )\n            error = e\n        finally:\n            if not cancel.is_set():\n                finished = True\n                cancel.set()\n            cancel_thread.join()\n            return exec_stats, error",
                    "start_token": 2662,
                    "end_token": 4159,
                    "children": [
                        {
                            "type": "expression_statement",
                            "label": "\"\"\"\n    This class contains event handlers for the process pool executor events.\n\n    The main events are:\n        on_node_executor_start: Initialize the process that executes the node.\n        on_node_execution: Execution logic for a node.\n\n        on_graph_executor_start: Initialize the process that executes the graph.\n        on_graph_execution: Execution logic for a graph.\n\n    The execution flow:\n        1. Graph execution request is added to the queue.\n        2. Graph executor loop picks the request from the queue.\n        3. Graph executor loop submits the graph execution request to the executor pool.\n      [on_graph_execution]\n        4. Graph executor initialize the node execution queue.\n        5. Graph executor adds the starting nodes to the node execution queue.\n        6. Graph executor waits for all nodes to be executed.\n      [on_node_execution]\n        7. Node executor picks the node execution request from the queue.\n        8. Node executor executes the node.\n        9. Node executor enqueues the next executed nodes to the node execution queue.\n    \"\"\"",
                            "start_token": 2662,
                            "end_token": -1,
                            "children": [
                                {
                                    "type": "string",
                                    "label": "\"\"\"\n    This class contains event handlers for the process pool executor events.\n\n    The main events are:\n        on_node_executor_start: Initialize the process that executes the node.\n        on_node_execution: Execution logic for a node.\n\n        on_graph_executor_start: Initialize the process that executes the graph.\n        on_graph_execution: Execution logic for a graph.\n\n    The execution flow:\n        1. Graph execution request is added to the queue.\n        2. Graph executor loop picks the request from the queue.\n        3. Graph executor loop submits the graph execution request to the executor pool.\n      [on_graph_execution]\n        4. Graph executor initialize the node execution queue.\n        5. Graph executor adds the starting nodes to the node execution queue.\n        6. Graph executor waits for all nodes to be executed.\n      [on_node_execution]\n        7. Node executor picks the node execution request from the queue.\n        8. Node executor executes the node.\n        9. Node executor enqueues the next executed nodes to the node execution queue.\n    \"\"\"",
                                    "start_token": 2662,
                                    "end_token": -1,
                                    "children": [
                                        {
                                            "type": "string_start",
                                            "label": "\"\"\"",
                                            "start_token": 2662,
                                            "end_token": 2662,
                                            "children": []
                                        },
                                        {
                                            "type": "string_content",
                                            "label": "\n    This class contains event handlers for the process pool executor events.\n\n    The main events are:\n        on_node_executor_start: Initialize the process that executes the node.\n        on_node_execution: Execution logic for a node.\n\n        on_graph_executor_start: Initialize the process that executes the graph.\n        on_graph_execution: Execution logic for a graph.\n\n    The execution flow:\n        1. Graph execution request is added to the queue.\n        2. Graph executor loop picks the request from the queue.\n        3. Graph executor loop submits the graph execution request to the executor pool.\n      [on_graph_execution]\n        4. Graph executor initialize the node execution queue.\n        5. Graph executor adds the starting nodes to the node execution queue.\n        6. Graph executor waits for all nodes to be executed.\n      [on_node_execution]\n        7. Node executor picks the node execution request from the queue.\n        8. Node executor executes the node.\n        9. Node executor enqueues the next executed nodes to the node execution queue.\n    ",
                                            "start_token": 2662,
                                            "end_token": 2664,
                                            "children": []
                                        },
                                        {
                                            "type": "string_end",
                                            "label": "\"\"\"",
                                            "start_token": 2665,
                                            "end_token": -1,
                                            "children": []
                                        }
                                    ]
                                }
                            ]
                        },
                        {
                            "type": "decorated_definition",
                            "label": "@classmethod\n    def on_node_executor_start(cls):\n        configure_logging()\n        set_service_name(\"NodeExecutor\")\n        redis.connect()\n        cls.pid = os.getpid()\n        cls.db_client = get_db_client()\n        cls.creds_manager = IntegrationCredentialsManager()\n\n        # Set up shutdown handlers\n        cls.shutdown_lock = threading.Lock()\n        atexit.register(cls.on_node_executor_stop)  # handle regular shutdown\n        signal.signal(  # handle termination\n            signal.SIGTERM, lambda _, __: cls.on_node_executor_sigterm()\n        )",
                            "start_token": 2667,
                            "end_token": -1,
                            "children": [
                                {
                                    "type": "decorator",
                                    "label": "@classmethod",
                                    "start_token": 2667,
                                    "end_token": -1,
                                    "children": [
                                        {
                                            "type": "identifier",
                                            "label": "classmethod",
                                            "start_token": 2667,
                                            "end_token": -1,
                                            "children": []
                                        }
                                    ]
                                },
                                {
                                    "type": "function_definition",
                                    "label": "def on_node_executor_start(cls):\n        configure_logging()\n        set_service_name(\"NodeExecutor\")\n        redis.connect()\n        cls.pid = os.getpid()\n        cls.db_client = get_db_client()\n        cls.creds_manager = IntegrationCredentialsManager()\n\n        # Set up shutdown handlers\n        cls.shutdown_lock = threading.Lock()\n        atexit.register(cls.on_node_executor_stop)  # handle regular shutdown\n        signal.signal(  # handle termination\n            signal.SIGTERM, lambda _, __: cls.on_node_executor_sigterm()\n        )",
                                    "start_token": 2670,
                                    "end_token": -1,
                                    "children": [
                                        {
                                            "type": "identifier",
                                            "label": "on_node_executor_start",
                                            "start_token": 2670,
                                            "end_token": 2672,
                                            "children": []
                                        },
                                        {
                                            "type": "parameters",
                                            "label": "(cls)",
                                            "start_token": 2673,
                                            "end_token": -1,
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "label": "cls",
                                                    "start_token": 2674,
                                                    "end_token": -1,
                                                    "children": []
                                                }
                                            ]
                                        },
                                        {
                                            "type": "block",
                                            "label": "configure_logging()\n        set_service_name(\"NodeExecutor\")\n        redis.connect()\n        cls.pid = os.getpid()\n        cls.db_client = get_db_client()\n        cls.creds_manager = IntegrationCredentialsManager()\n\n        # Set up shutdown handlers\n        cls.shutdown_lock = threading.Lock()\n        atexit.register(cls.on_node_executor_stop)  # handle regular shutdown\n        signal.signal(  # handle termination\n            signal.SIGTERM, lambda _, __: cls.on_node_executor_sigterm()\n        )",
                                            "start_token": 2676,
                                            "end_token": -1,
                                            "children": [
                                                {
                                                    "type": "expression_statement",
                                                    "label": "configure_logging()",
                                                    "start_token": 2676,
                                                    "end_token": -1,
                                                    "children": [
                                                        {
                                                            "type": "call",
                                                            "label": "configure_logging()",
                                                            "start_token": 2676,
                                                            "end_token": -1,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "label": "configure_logging",
                                                                    "start_token": 2676,
                                                                    "end_token": -1,
                                                                    "children": []
                                                                },
                                                                {
                                                                    "type": "argument_list",
                                                                    "label": "()",
                                                                    "start_token": -1,
                                                                    "end_token": -1,
                                                                    "children": []
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                },
                                                {
                                                    "type": "expression_statement",
                                                    "label": "set_service_name(\"NodeExecutor\")",
                                                    "start_token": 2680,
                                                    "end_token": -1,
                                                    "children": [
                                                        {
                                                            "type": "call",
                                                            "label": "set_service_name(\"NodeExecutor\")",
                                                            "start_token": 2680,
                                                            "end_token": -1,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "label": "set_service_name",
                                                                    "start_token": 2680,
                                                                    "end_token": 2682,
                                                                    "children": []
                                                                },
                                                                {
                                                                    "type": "argument_list",
                                                                    "label": "(\"NodeExecutor\")",
                                                                    "start_token": 2682,
                                                                    "end_token": -1,
                                                                    "children": [
                                                                        {
                                                                            "type": "string",
                                                                            "label": "\"NodeExecutor\"",
                                                                            "start_token": 2682,
                                                                            "end_token": -1,
                                                                            "children": [
                                                                                {
                                                                                    "type": "string_start",
                                                                                    "label": "\"",
                                                                                    "start_token": 2682,
                                                                                    "end_token": 2682,
                                                                                    "children": []
                                                                                },
                                                                                {
                                                                                    "type": "string_content",
                                                                                    "label": "NodeExecutor",
                                                                                    "start_token": 2682,
                                                                                    "end_token": -1,
                                                                                    "children": []
                                                                                },
                                                                                {
                                                                                    "type": "string_end",
                                                                                    "label": "\"",
                                                                                    "start_token": -1,
                                                                                    "end_token": -1,
                                                                                    "children": []
                                                                                }
                                                                            ]
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                },
                                                {
                                                    "type": "expression_statement",
                                                    "label": "redis.connect()",
                                                    "start_token": 2685,
                                                    "end_token": -1,
                                                    "children": [
                                                        {
                                                            "type": "call",
                                                            "label": "redis.connect()",
                                                            "start_token": 2685,
                                                            "end_token": -1,
                                                            "children": [
                                                                {
                                                                    "type": "attribute",
                                                                    "label": "redis.connect",
                                                                    "start_token": 2685,
                                                                    "end_token": -1,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "redis",
                                                                            "start_token": 2685,
                                                                            "end_token": 2687,
                                                                            "children": []
                                                                        },
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "connect",
                                                                            "start_token": 2687,
                                                                            "end_token": -1,
                                                                            "children": []
                                                                        }
                                                                    ]
                                                                },
                                                                {
                                                                    "type": "argument_list",
                                                                    "label": "()",
                                                                    "start_token": -1,
                                                                    "end_token": -1,
                                                                    "children": []
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                },
                                                {
                                                    "type": "expression_statement",
                                                    "label": "cls.pid = os.getpid()",
                                                    "start_token": 2693,
                                                    "end_token": -1,
                                                    "children": [
                                                        {
                                                            "type": "assignment",
                                                            "label": "cls.pid = os.getpid()",
                                                            "start_token": 2693,
                                                            "end_token": -1,
                                                            "children": [
                                                                {
                                                                    "type": "attribute",
                                                                    "label": "cls.pid",
                                                                    "start_token": 2693,
                                                                    "end_token": 2695,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "cls",
                                                                            "start_token": 2693,
                                                                            "end_token": 2693,
                                                                            "children": []
                                                                        },
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "pid",
                                                                            "start_token": 2694,
                                                                            "end_token": 2695,
                                                                            "children": []
                                                                        }
                                                                    ]
                                                                },
                                                                {
                                                                    "type": "call",
                                                                    "label": "os.getpid()",
                                                                    "start_token": 2697,
                                                                    "end_token": -1,
                                                                    "children": [
                                                                        {
                                                                            "type": "attribute",
                                                                            "label": "os.getpid",
                                                                            "start_token": 2697,
                                                                            "end_token": -1,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "os",
                                                                                    "start_token": 2697,
                                                                                    "end_token": 2697,
                                                                                    "children": []
                                                                                },
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "getpid",
                                                                                    "start_token": 2697,
                                                                                    "end_token": -1,
                                                                                    "children": []
                                                                                }
                                                                            ]
                                                                        },
                                                                        {
                                                                            "type": "argument_list",
                                                                            "label": "()",
                                                                            "start_token": -1,
                                                                            "end_token": -1,
                                                                            "children": []
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                },
                                                {
                                                    "type": "expression_statement",
                                                    "label": "cls.db_client = get_db_client()",
                                                    "start_token": 2703,
                                                    "end_token": -1,
                                                    "children": [
                                                        {
                                                            "type": "assignment",
                                                            "label": "cls.db_client = get_db_client()",
                                                            "start_token": 2703,
                                                            "end_token": -1,
                                                            "children": [
                                                                {
                                                                    "type": "attribute",
                                                                    "label": "cls.db_client",
                                                                    "start_token": 2703,
                                                                    "end_token": 2705,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "cls",
                                                                            "start_token": 2703,
                                                                            "end_token": 2703,
                                                                            "children": []
                                                                        },
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "db_client",
                                                                            "start_token": 2703,
                                                                            "end_token": 2705,
                                                                            "children": []
                                                                        }
                                                                    ]
                                                                },
                                                                {
                                                                    "type": "call",
                                                                    "label": "get_db_client()",
                                                                    "start_token": 2705,
                                                                    "end_token": -1,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "get_db_client",
                                                                            "start_token": 2705,
                                                                            "end_token": -1,
                                                                            "children": []
                                                                        },
                                                                        {
                                                                            "type": "argument_list",
                                                                            "label": "()",
                                                                            "start_token": -1,
                                                                            "end_token": -1,
                                                                            "children": []
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                },
                                                {
                                                    "type": "expression_statement",
                                                    "label": "cls.creds_manager = IntegrationCredentialsManager()",
                                                    "start_token": 2711,
                                                    "end_token": -1,
                                                    "children": [
                                                        {
                                                            "type": "assignment",
                                                            "label": "cls.creds_manager = IntegrationCredentialsManager()",
                                                            "start_token": 2711,
                                                            "end_token": -1,
                                                            "children": [
                                                                {
                                                                    "type": "attribute",
                                                                    "label": "cls.creds_manager",
                                                                    "start_token": 2711,
                                                                    "end_token": 2713,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "cls",
                                                                            "start_token": 2711,
                                                                            "end_token": 2711,
                                                                            "children": []
                                                                        },
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "creds_manager",
                                                                            "start_token": 2711,
                                                                            "end_token": 2713,
                                                                            "children": []
                                                                        }
                                                                    ]
                                                                },
                                                                {
                                                                    "type": "call",
                                                                    "label": "IntegrationCredentialsManager()",
                                                                    "start_token": 2713,
                                                                    "end_token": -1,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "IntegrationCredentialsManager",
                                                                            "start_token": 2713,
                                                                            "end_token": 2717,
                                                                            "children": []
                                                                        },
                                                                        {
                                                                            "type": "argument_list",
                                                                            "label": "()",
                                                                            "start_token": -1,
                                                                            "end_token": -1,
                                                                            "children": []
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                },
                                                {
                                                    "type": "comment",
                                                    "label": "# Set up shutdown handlers",
                                                    "start_token": 2719,
                                                    "end_token": -1,
                                                    "children": []
                                                },
                                                {
                                                    "type": "expression_statement",
                                                    "label": "cls.shutdown_lock = threading.Lock()",
                                                    "start_token": 2726,
                                                    "end_token": -1,
                                                    "children": [
                                                        {
                                                            "type": "assignment",
                                                            "label": "cls.shutdown_lock = threading.Lock()",
                                                            "start_token": 2726,
                                                            "end_token": -1,
                                                            "children": [
                                                                {
                                                                    "type": "attribute",
                                                                    "label": "cls.shutdown_lock",
                                                                    "start_token": 2726,
                                                                    "end_token": 2728,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "cls",
                                                                            "start_token": 2726,
                                                                            "end_token": 2726,
                                                                            "children": []
                                                                        },
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "shutdown_lock",
                                                                            "start_token": 2726,
                                                                            "end_token": 2728,
                                                                            "children": []
                                                                        }
                                                                    ]
                                                                },
                                                                {
                                                                    "type": "call",
                                                                    "label": "threading.Lock()",
                                                                    "start_token": 2728,
                                                                    "end_token": -1,
                                                                    "children": [
                                                                        {
                                                                            "type": "attribute",
                                                                            "label": "threading.Lock",
                                                                            "start_token": 2728,
                                                                            "end_token": -1,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "threading",
                                                                                    "start_token": 2728,
                                                                                    "end_token": 2730,
                                                                                    "children": []
                                                                                },
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "Lock",
                                                                                    "start_token": 2731,
                                                                                    "end_token": -1,
                                                                                    "children": []
                                                                                }
                                                                            ]
                                                                        },
                                                                        {
                                                                            "type": "argument_list",
                                                                            "label": "()",
                                                                            "start_token": -1,
                                                                            "end_token": -1,
                                                                            "children": []
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                },
                                                {
                                                    "type": "expression_statement",
                                                    "label": "atexit.register(cls.on_node_executor_stop)",
                                                    "start_token": 2734,
                                                    "end_token": -1,
                                                    "children": [
                                                        {
                                                            "type": "call",
                                                            "label": "atexit.register(cls.on_node_executor_stop)",
                                                            "start_token": 2734,
                                                            "end_token": -1,
                                                            "children": [
                                                                {
                                                                    "type": "attribute",
                                                                    "label": "atexit.register",
                                                                    "start_token": 2734,
                                                                    "end_token": 2738,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "atexit",
                                                                            "start_token": 2734,
                                                                            "end_token": 2736,
                                                                            "children": []
                                                                        },
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "register",
                                                                            "start_token": 2736,
                                                                            "end_token": 2738,
                                                                            "children": []
                                                                        }
                                                                    ]
                                                                },
                                                                {
                                                                    "type": "argument_list",
                                                                    "label": "(cls.on_node_executor_stop)",
                                                                    "start_token": 2739,
                                                                    "end_token": -1,
                                                                    "children": [
                                                                        {
                                                                            "type": "attribute",
                                                                            "label": "cls.on_node_executor_stop",
                                                                            "start_token": 2740,
                                                                            "end_token": 2742,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "cls",
                                                                                    "start_token": 2740,
                                                                                    "end_token": 2740,
                                                                                    "children": []
                                                                                },
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "on_node_executor_stop",
                                                                                    "start_token": 2740,
                                                                                    "end_token": 2742,
                                                                                    "children": []
                                                                                }
                                                                            ]
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                },
                                                {
                                                    "type": "comment",
                                                    "label": "# handle regular shutdown",
                                                    "start_token": 2743,
                                                    "end_token": -1,
                                                    "children": []
                                                },
                                                {
                                                    "type": "expression_statement",
                                                    "label": "signal.signal(  # handle termination\n            signal.SIGTERM, lambda _, __: cls.on_node_executor_sigterm()\n        )",
                                                    "start_token": 2747,
                                                    "end_token": -1,
                                                    "children": [
                                                        {
                                                            "type": "call",
                                                            "label": "signal.signal(  # handle termination\n            signal.SIGTERM, lambda _, __: cls.on_node_executor_sigterm()\n        )",
                                                            "start_token": 2747,
                                                            "end_token": -1,
                                                            "children": [
                                                                {
                                                                    "type": "attribute",
                                                                    "label": "signal.signal",
                                                                    "start_token": 2747,
                                                                    "end_token": 2751,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "signal",
                                                                            "start_token": 2747,
                                                                            "end_token": 2749,
                                                                            "children": []
                                                                        },
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "signal",
                                                                            "start_token": 2749,
                                                                            "end_token": 2751,
                                                                            "children": []
                                                                        }
                                                                    ]
                                                                },
                                                                {
                                                                    "type": "argument_list",
                                                                    "label": "(  # handle termination\n            signal.SIGTERM, lambda _, __: cls.on_node_executor_sigterm()\n        )",
                                                                    "start_token": -1,
                                                                    "end_token": -1,
                                                                    "children": [
                                                                        {
                                                                            "type": "comment",
                                                                            "label": "# handle termination",
                                                                            "start_token": 2752,
                                                                            "end_token": -1,
                                                                            "children": []
                                                                        },
                                                                        {
                                                                            "type": "attribute",
                                                                            "label": "signal.SIGTERM",
                                                                            "start_token": 2755,
                                                                            "end_token": 2759,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "signal",
                                                                                    "start_token": 2755,
                                                                                    "end_token": 2757,
                                                                                    "children": []
                                                                                },
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "SIGTERM",
                                                                                    "start_token": 2757,
                                                                                    "end_token": 2759,
                                                                                    "children": []
                                                                                }
                                                                            ]
                                                                        },
                                                                        {
                                                                            "type": "lambda",
                                                                            "label": "lambda _, __: cls.on_node_executor_sigterm()",
                                                                            "start_token": 2759,
                                                                            "end_token": -1,
                                                                            "children": [
                                                                                {
                                                                                    "type": "lambda_parameters",
                                                                                    "label": "_, __",
                                                                                    "start_token": 2762,
                                                                                    "end_token": 2764,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "label": "_",
                                                                                            "start_token": 2762,
                                                                                            "end_token": 2762,
                                                                                            "children": []
                                                                                        },
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "label": "__",
                                                                                            "start_token": 2764,
                                                                                            "end_token": 2764,
                                                                                            "children": []
                                                                                        }
                                                                                    ]
                                                                                },
                                                                                {
                                                                                    "type": "call",
                                                                                    "label": "cls.on_node_executor_sigterm()",
                                                                                    "start_token": 2766,
                                                                                    "end_token": -1,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "attribute",
                                                                                            "label": "cls.on_node_executor_sigterm",
                                                                                            "start_token": 2766,
                                                                                            "end_token": -1,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "label": "cls",
                                                                                                    "start_token": 2766,
                                                                                                    "end_token": 2766,
                                                                                                    "children": []
                                                                                                },
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "label": "on_node_executor_sigterm",
                                                                                                    "start_token": 2766,
                                                                                                    "end_token": -1,
                                                                                                    "children": []
                                                                                                }
                                                                                            ]
                                                                                        },
                                                                                        {
                                                                                            "type": "argument_list",
                                                                                            "label": "()",
                                                                                            "start_token": -1,
                                                                                            "end_token": -1,
                                                                                            "children": []
                                                                                        }
                                                                                    ]
                                                                                }
                                                                            ]
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                }
                                            ]
                                        }
                                    ]
                                }
                            ]
                        },
                        {
                            "type": "decorated_definition",
                            "label": "@classmethod\n    def on_node_executor_stop(cls):\n        if not cls.shutdown_lock.acquire(blocking=False):\n            return  # already shutting down\n\n        logger.info(f\"[on_node_executor_stop {cls.pid}] ⏳ Releasing locks...\")\n        cls.creds_manager.release_all_locks()\n        logger.info(f\"[on_node_executor_stop {cls.pid}] ⏳ Disconnecting Redis...\")\n        redis.disconnect()\n        logger.info(f\"[on_node_executor_stop {cls.pid}] ⏳ Disconnecting DB manager...\")\n        close_service_client(cls.db_client)\n        logger.info(f\"[on_node_executor_stop {cls.pid}] ✅ Finished cleanup\")",
                            "start_token": 2774,
                            "end_token": 2859,
                            "children": [
                                {
                                    "type": "decorator",
                                    "label": "@classmethod",
                                    "start_token": 2774,
                                    "end_token": -1,
                                    "children": [
                                        {
                                            "type": "identifier",
                                            "label": "classmethod",
                                            "start_token": 2774,
                                            "end_token": -1,
                                            "children": []
                                        }
                                    ]
                                },
                                {
                                    "type": "function_definition",
                                    "label": "def on_node_executor_stop(cls):\n        if not cls.shutdown_lock.acquire(blocking=False):\n            return  # already shutting down\n\n        logger.info(f\"[on_node_executor_stop {cls.pid}] ⏳ Releasing locks...\")\n        cls.creds_manager.release_all_locks()\n        logger.info(f\"[on_node_executor_stop {cls.pid}] ⏳ Disconnecting Redis...\")\n        redis.disconnect()\n        logger.info(f\"[on_node_executor_stop {cls.pid}] ⏳ Disconnecting DB manager...\")\n        close_service_client(cls.db_client)\n        logger.info(f\"[on_node_executor_stop {cls.pid}] ✅ Finished cleanup\")",
                                    "start_token": 2777,
                                    "end_token": 2859,
                                    "children": [
                                        {
                                            "type": "identifier",
                                            "label": "on_node_executor_stop",
                                            "start_token": 2777,
                                            "end_token": 2779,
                                            "children": []
                                        },
                                        {
                                            "type": "parameters",
                                            "label": "(cls)",
                                            "start_token": 2780,
                                            "end_token": -1,
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "label": "cls",
                                                    "start_token": 2781,
                                                    "end_token": -1,
                                                    "children": []
                                                }
                                            ]
                                        },
                                        {
                                            "type": "block",
                                            "label": "if not cls.shutdown_lock.acquire(blocking=False):\n            return  # already shutting down\n\n        logger.info(f\"[on_node_executor_stop {cls.pid}] ⏳ Releasing locks...\")\n        cls.creds_manager.release_all_locks()\n        logger.info(f\"[on_node_executor_stop {cls.pid}] ⏳ Disconnecting Redis...\")\n        redis.disconnect()\n        logger.info(f\"[on_node_executor_stop {cls.pid}] ⏳ Disconnecting DB manager...\")\n        close_service_client(cls.db_client)\n        logger.info(f\"[on_node_executor_stop {cls.pid}] ✅ Finished cleanup\")",
                                            "start_token": 2784,
                                            "end_token": 2859,
                                            "children": [
                                                {
                                                    "type": "if_statement",
                                                    "label": "if not cls.shutdown_lock.acquire(blocking=False):\n            return  # already shutting down",
                                                    "start_token": 2784,
                                                    "end_token": -1,
                                                    "children": [
                                                        {
                                                            "type": "not_operator",
                                                            "label": "not cls.shutdown_lock.acquire(blocking=False)",
                                                            "start_token": 2785,
                                                            "end_token": -1,
                                                            "children": [
                                                                {
                                                                    "type": "call",
                                                                    "label": "cls.shutdown_lock.acquire(blocking=False)",
                                                                    "start_token": 2787,
                                                                    "end_token": -1,
                                                                    "children": [
                                                                        {
                                                                            "type": "attribute",
                                                                            "label": "cls.shutdown_lock.acquire",
                                                                            "start_token": 2787,
                                                                            "end_token": 2791,
                                                                            "children": [
                                                                                {
                                                                                    "type": "attribute",
                                                                                    "label": "cls.shutdown_lock",
                                                                                    "start_token": 2787,
                                                                                    "end_token": 2789,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "label": "cls",
                                                                                            "start_token": 2787,
                                                                                            "end_token": 2787,
                                                                                            "children": []
                                                                                        },
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "label": "shutdown_lock",
                                                                                            "start_token": 2787,
                                                                                            "end_token": 2789,
                                                                                            "children": []
                                                                                        }
                                                                                    ]
                                                                                },
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "acquire",
                                                                                    "start_token": 2789,
                                                                                    "end_token": 2791,
                                                                                    "children": []
                                                                                }
                                                                            ]
                                                                        },
                                                                        {
                                                                            "type": "argument_list",
                                                                            "label": "(blocking=False)",
                                                                            "start_token": 2791,
                                                                            "end_token": -1,
                                                                            "children": [
                                                                                {
                                                                                    "type": "keyword_argument",
                                                                                    "label": "blocking=False",
                                                                                    "start_token": 2791,
                                                                                    "end_token": -1,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "label": "blocking",
                                                                                            "start_token": 2791,
                                                                                            "end_token": 2793,
                                                                                            "children": []
                                                                                        },
                                                                                        {
                                                                                            "type": "false",
                                                                                            "label": "False",
                                                                                            "start_token": 2793,
                                                                                            "end_token": -1,
                                                                                            "children": []
                                                                                        }
                                                                                    ]
                                                                                }
                                                                            ]
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        },
                                                        {
                                                            "type": "block",
                                                            "label": "return  # already shutting down",
                                                            "start_token": 2797,
                                                            "end_token": -1,
                                                            "children": [
                                                                {
                                                                    "type": "return_statement",
                                                                    "label": "return",
                                                                    "start_token": 2797,
                                                                    "end_token": -1,
                                                                    "children": []
                                                                },
                                                                {
                                                                    "type": "comment",
                                                                    "label": "# already shutting down",
                                                                    "start_token": 2799,
                                                                    "end_token": -1,
                                                                    "children": []
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                },
                                                {
                                                    "type": "expression_statement",
                                                    "label": "logger.info(f\"[on_node_executor_stop {cls.pid}] ⏳ Releasing locks...\")",
                                                    "start_token": 2804,
                                                    "end_token": -1,
                                                    "children": [
                                                        {
                                                            "type": "call",
                                                            "label": "logger.info(f\"[on_node_executor_stop {cls.pid}] ⏳ Releasing locks...\")",
                                                            "start_token": 2804,
                                                            "end_token": -1,
                                                            "children": [
                                                                {
                                                                    "type": "attribute",
                                                                    "label": "logger.info",
                                                                    "start_token": 2804,
                                                                    "end_token": 2809,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "logger",
                                                                            "start_token": 2804,
                                                                            "end_token": 2806,
                                                                            "children": []
                                                                        },
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "info",
                                                                            "start_token": 2807,
                                                                            "end_token": 2809,
                                                                            "children": []
                                                                        }
                                                                    ]
                                                                },
                                                                {
                                                                    "type": "argument_list",
                                                                    "label": "(f\"[on_node_executor_stop {cls.pid}] ⏳ Releasing locks...\")",
                                                                    "start_token": 2809,
                                                                    "end_token": -1,
                                                                    "children": [
                                                                        {
                                                                            "type": "string",
                                                                            "label": "f\"[on_node_executor_stop {cls.pid}] ⏳ Releasing locks...\"",
                                                                            "start_token": 2809,
                                                                            "end_token": -1,
                                                                            "children": [
                                                                                {
                                                                                    "type": "string_start",
                                                                                    "label": "f\"",
                                                                                    "start_token": 2809,
                                                                                    "end_token": 2809,
                                                                                    "children": []
                                                                                },
                                                                                {
                                                                                    "type": "string_content",
                                                                                    "label": "[on_node_executor_stop ",
                                                                                    "start_token": 2809,
                                                                                    "end_token": 2809,
                                                                                    "children": []
                                                                                },
                                                                                {
                                                                                    "type": "interpolation",
                                                                                    "label": "{cls.pid}",
                                                                                    "start_token": 2809,
                                                                                    "end_token": 2809,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "attribute",
                                                                                            "label": "cls.pid",
                                                                                            "start_token": 2809,
                                                                                            "end_token": 2809,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "label": "cls",
                                                                                                    "start_token": 2809,
                                                                                                    "end_token": 2809,
                                                                                                    "children": []
                                                                                                },
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "label": "pid",
                                                                                                    "start_token": 2809,
                                                                                                    "end_token": 2809,
                                                                                                    "children": []
                                                                                                }
                                                                                            ]
                                                                                        }
                                                                                    ]
                                                                                },
                                                                                {
                                                                                    "type": "string_content",
                                                                                    "label": "] ⏳ Releasing locks...",
                                                                                    "start_token": 2809,
                                                                                    "end_token": -1,
                                                                                    "children": []
                                                                                },
                                                                                {
                                                                                    "type": "string_end",
                                                                                    "label": "\"",
                                                                                    "start_token": -1,
                                                                                    "end_token": -1,
                                                                                    "children": []
                                                                                }
                                                                            ]
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                },
                                                {
                                                    "type": "expression_statement",
                                                    "label": "cls.creds_manager.release_all_locks()",
                                                    "start_token": 2814,
                                                    "end_token": -1,
                                                    "children": [
                                                        {
                                                            "type": "call",
                                                            "label": "cls.creds_manager.release_all_locks()",
                                                            "start_token": 2814,
                                                            "end_token": -1,
                                                            "children": [
                                                                {
                                                                    "type": "attribute",
                                                                    "label": "cls.creds_manager.release_all_locks",
                                                                    "start_token": 2814,
                                                                    "end_token": -1,
                                                                    "children": [
                                                                        {
                                                                            "type": "attribute",
                                                                            "label": "cls.creds_manager",
                                                                            "start_token": 2814,
                                                                            "end_token": 2816,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "cls",
                                                                                    "start_token": 2814,
                                                                                    "end_token": 2814,
                                                                                    "children": []
                                                                                },
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "creds_manager",
                                                                                    "start_token": 2814,
                                                                                    "end_token": 2816,
                                                                                    "children": []
                                                                                }
                                                                            ]
                                                                        },
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "release_all_locks",
                                                                            "start_token": 2816,
                                                                            "end_token": -1,
                                                                            "children": []
                                                                        }
                                                                    ]
                                                                },
                                                                {
                                                                    "type": "argument_list",
                                                                    "label": "()",
                                                                    "start_token": -1,
                                                                    "end_token": -1,
                                                                    "children": []
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                },
                                                {
                                                    "type": "expression_statement",
                                                    "label": "logger.info(f\"[on_node_executor_stop {cls.pid}] ⏳ Disconnecting Redis...\")",
                                                    "start_token": 2821,
                                                    "end_token": -1,
                                                    "children": [
                                                        {
                                                            "type": "call",
                                                            "label": "logger.info(f\"[on_node_executor_stop {cls.pid}] ⏳ Disconnecting Redis...\")",
                                                            "start_token": 2821,
                                                            "end_token": -1,
                                                            "children": [
                                                                {
                                                                    "type": "attribute",
                                                                    "label": "logger.info",
                                                                    "start_token": 2821,
                                                                    "end_token": 2825,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "logger",
                                                                            "start_token": 2821,
                                                                            "end_token": 2823,
                                                                            "children": []
                                                                        },
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "info",
                                                                            "start_token": 2825,
                                                                            "end_token": 2825,
                                                                            "children": []
                                                                        }
                                                                    ]
                                                                },
                                                                {
                                                                    "type": "argument_list",
                                                                    "label": "(f\"[on_node_executor_stop {cls.pid}] ⏳ Disconnecting Redis...\")",
                                                                    "start_token": 2825,
                                                                    "end_token": -1,
                                                                    "children": [
                                                                        {
                                                                            "type": "string",
                                                                            "label": "f\"[on_node_executor_stop {cls.pid}] ⏳ Disconnecting Redis...\"",
                                                                            "start_token": 2825,
                                                                            "end_token": -1,
                                                                            "children": [
                                                                                {
                                                                                    "type": "string_start",
                                                                                    "label": "f\"",
                                                                                    "start_token": 2825,
                                                                                    "end_token": 2825,
                                                                                    "children": []
                                                                                },
                                                                                {
                                                                                    "type": "string_content",
                                                                                    "label": "[on_node_executor_stop ",
                                                                                    "start_token": 2825,
                                                                                    "end_token": 2825,
                                                                                    "children": []
                                                                                },
                                                                                {
                                                                                    "type": "interpolation",
                                                                                    "label": "{cls.pid}",
                                                                                    "start_token": 2825,
                                                                                    "end_token": 2825,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "attribute",
                                                                                            "label": "cls.pid",
                                                                                            "start_token": 2825,
                                                                                            "end_token": 2825,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "label": "cls",
                                                                                                    "start_token": 2825,
                                                                                                    "end_token": 2825,
                                                                                                    "children": []
                                                                                                },
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "label": "pid",
                                                                                                    "start_token": 2825,
                                                                                                    "end_token": 2825,
                                                                                                    "children": []
                                                                                                }
                                                                                            ]
                                                                                        }
                                                                                    ]
                                                                                },
                                                                                {
                                                                                    "type": "string_content",
                                                                                    "label": "] ⏳ Disconnecting Redis...",
                                                                                    "start_token": 2825,
                                                                                    "end_token": -1,
                                                                                    "children": []
                                                                                },
                                                                                {
                                                                                    "type": "string_end",
                                                                                    "label": "\"",
                                                                                    "start_token": -1,
                                                                                    "end_token": -1,
                                                                                    "children": []
                                                                                }
                                                                            ]
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                },
                                                {
                                                    "type": "expression_statement",
                                                    "label": "redis.disconnect()",
                                                    "start_token": 2830,
                                                    "end_token": -1,
                                                    "children": [
                                                        {
                                                            "type": "call",
                                                            "label": "redis.disconnect()",
                                                            "start_token": 2830,
                                                            "end_token": -1,
                                                            "children": [
                                                                {
                                                                    "type": "attribute",
                                                                    "label": "redis.disconnect",
                                                                    "start_token": 2830,
                                                                    "end_token": -1,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "redis",
                                                                            "start_token": 2830,
                                                                            "end_token": 2830,
                                                                            "children": []
                                                                        },
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "disconnect",
                                                                            "start_token": 2830,
                                                                            "end_token": -1,
                                                                            "children": []
                                                                        }
                                                                    ]
                                                                },
                                                                {
                                                                    "type": "argument_list",
                                                                    "label": "()",
                                                                    "start_token": -1,
                                                                    "end_token": -1,
                                                                    "children": []
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                },
                                                {
                                                    "type": "expression_statement",
                                                    "label": "logger.info(f\"[on_node_executor_stop {cls.pid}] ⏳ Disconnecting DB manager...\")",
                                                    "start_token": 2836,
                                                    "end_token": 2842,
                                                    "children": [
                                                        {
                                                            "type": "call",
                                                            "label": "logger.info(f\"[on_node_executor_stop {cls.pid}] ⏳ Disconnecting DB manager...\")",
                                                            "start_token": 2836,
                                                            "end_token": 2842,
                                                            "children": [
                                                                {
                                                                    "type": "attribute",
                                                                    "label": "logger.info",
                                                                    "start_token": 2836,
                                                                    "end_token": 2839,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "logger",
                                                                            "start_token": 2836,
                                                                            "end_token": 2839,
                                                                            "children": []
                                                                        },
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "info",
                                                                            "start_token": 2839,
                                                                            "end_token": 2839,
                                                                            "children": []
                                                                        }
                                                                    ]
                                                                },
                                                                {
                                                                    "type": "argument_list",
                                                                    "label": "(f\"[on_node_executor_stop {cls.pid}] ⏳ Disconnecting DB manager...\")",
                                                                    "start_token": 2839,
                                                                    "end_token": 2842,
                                                                    "children": [
                                                                        {
                                                                            "type": "string",
                                                                            "label": "f\"[on_node_executor_stop {cls.pid}] ⏳ Disconnecting DB manager...\"",
                                                                            "start_token": 2839,
                                                                            "end_token": -1,
                                                                            "children": [
                                                                                {
                                                                                    "type": "string_start",
                                                                                    "label": "f\"",
                                                                                    "start_token": 2839,
                                                                                    "end_token": 2839,
                                                                                    "children": []
                                                                                },
                                                                                {
                                                                                    "type": "string_content",
                                                                                    "label": "[on_node_executor_stop ",
                                                                                    "start_token": 2839,
                                                                                    "end_token": 2839,
                                                                                    "children": []
                                                                                },
                                                                                {
                                                                                    "type": "interpolation",
                                                                                    "label": "{cls.pid}",
                                                                                    "start_token": 2839,
                                                                                    "end_token": 2839,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "attribute",
                                                                                            "label": "cls.pid",
                                                                                            "start_token": 2839,
                                                                                            "end_token": 2839,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "label": "cls",
                                                                                                    "start_token": 2839,
                                                                                                    "end_token": 2839,
                                                                                                    "children": []
                                                                                                },
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "label": "pid",
                                                                                                    "start_token": 2839,
                                                                                                    "end_token": 2839,
                                                                                                    "children": []
                                                                                                }
                                                                                            ]
                                                                                        }
                                                                                    ]
                                                                                },
                                                                                {
                                                                                    "type": "string_content",
                                                                                    "label": "] ⏳ Disconnecting DB manager...",
                                                                                    "start_token": 2839,
                                                                                    "end_token": -1,
                                                                                    "children": []
                                                                                },
                                                                                {
                                                                                    "type": "string_end",
                                                                                    "label": "\"",
                                                                                    "start_token": -1,
                                                                                    "end_token": -1,
                                                                                    "children": []
                                                                                }
                                                                            ]
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                },
                                                {
                                                    "type": "expression_statement",
                                                    "label": "close_service_client(cls.db_client)",
                                                    "start_token": 2842,
                                                    "end_token": 2849,
                                                    "children": [
                                                        {
                                                            "type": "call",
                                                            "label": "close_service_client(cls.db_client)",
                                                            "start_token": 2842,
                                                            "end_token": 2849,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "label": "close_service_client",
                                                                    "start_token": 2842,
                                                                    "end_token": 2846,
                                                                    "children": []
                                                                },
                                                                {
                                                                    "type": "argument_list",
                                                                    "label": "(cls.db_client)",
                                                                    "start_token": 2846,
                                                                    "end_token": 2849,
                                                                    "children": [
                                                                        {
                                                                            "type": "attribute",
                                                                            "label": "cls.db_client",
                                                                            "start_token": 2846,
                                                                            "end_token": -1,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "cls",
                                                                                    "start_token": 2846,
                                                                                    "end_token": 2846,
                                                                                    "children": []
                                                                                },
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "db_client",
                                                                                    "start_token": 2848,
                                                                                    "end_token": -1,
                                                                                    "children": []
                                                                                }
                                                                            ]
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                },
                                                {
                                                    "type": "expression_statement",
                                                    "label": "logger.info(f\"[on_node_executor_stop {cls.pid}] ✅ Finished cleanup\")",
                                                    "start_token": 2851,
                                                    "end_token": 2859,
                                                    "children": [
                                                        {
                                                            "type": "call",
                                                            "label": "logger.info(f\"[on_node_executor_stop {cls.pid}] ✅ Finished cleanup\")",
                                                            "start_token": 2851,
                                                            "end_token": 2859,
                                                            "children": [
                                                                {
                                                                    "type": "attribute",
                                                                    "label": "logger.info",
                                                                    "start_token": 2851,
                                                                    "end_token": 2854,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "logger",
                                                                            "start_token": 2851,
                                                                            "end_token": 2854,
                                                                            "children": []
                                                                        },
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "info",
                                                                            "start_token": 2854,
                                                                            "end_token": 2854,
                                                                            "children": []
                                                                        }
                                                                    ]
                                                                },
                                                                {
                                                                    "type": "argument_list",
                                                                    "label": "(f\"[on_node_executor_stop {cls.pid}] ✅ Finished cleanup\")",
                                                                    "start_token": 2854,
                                                                    "end_token": 2859,
                                                                    "children": [
                                                                        {
                                                                            "type": "string",
                                                                            "label": "f\"[on_node_executor_stop {cls.pid}] ✅ Finished cleanup\"",
                                                                            "start_token": 2854,
                                                                            "end_token": 2859,
                                                                            "children": [
                                                                                {
                                                                                    "type": "string_start",
                                                                                    "label": "f\"",
                                                                                    "start_token": 2854,
                                                                                    "end_token": 2854,
                                                                                    "children": []
                                                                                },
                                                                                {
                                                                                    "type": "string_content",
                                                                                    "label": "[on_node_executor_stop ",
                                                                                    "start_token": 2854,
                                                                                    "end_token": 2854,
                                                                                    "children": []
                                                                                },
                                                                                {
                                                                                    "type": "interpolation",
                                                                                    "label": "{cls.pid}",
                                                                                    "start_token": 2854,
                                                                                    "end_token": 2854,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "attribute",
                                                                                            "label": "cls.pid",
                                                                                            "start_token": 2854,
                                                                                            "end_token": 2854,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "label": "cls",
                                                                                                    "start_token": 2854,
                                                                                                    "end_token": 2854,
                                                                                                    "children": []
                                                                                                },
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "label": "pid",
                                                                                                    "start_token": 2854,
                                                                                                    "end_token": 2854,
                                                                                                    "children": []
                                                                                                }
                                                                                            ]
                                                                                        }
                                                                                    ]
                                                                                },
                                                                                {
                                                                                    "type": "string_content",
                                                                                    "label": "] ✅ Finished cleanup",
                                                                                    "start_token": 2854,
                                                                                    "end_token": 2859,
                                                                                    "children": []
                                                                                },
                                                                                {
                                                                                    "type": "string_end",
                                                                                    "label": "\"",
                                                                                    "start_token": 2859,
                                                                                    "end_token": 2859,
                                                                                    "children": []
                                                                                }
                                                                            ]
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                }
                                            ]
                                        }
                                    ]
                                }
                            ]
                        },
                        {
                            "type": "decorated_definition",
                            "label": "@classmethod\n    def on_node_executor_sigterm(cls):\n        llprint(f\"[on_node_executor_sigterm {cls.pid}] ⚠️ SIGTERM received\")\n        if not cls.shutdown_lock.acquire(blocking=False):\n            return  # already shutting down\n\n        llprint(f\"[on_node_executor_stop {cls.pid}] ⏳ Releasing locks...\")\n        cls.creds_manager.release_all_locks()\n        llprint(f\"[on_node_executor_stop {cls.pid}] ⏳ Disconnecting Redis...\")\n        redis.disconnect()\n        llprint(f\"[on_node_executor_stop {cls.pid}] ✅ Finished cleanup\")\n        sys.exit(0)",
                            "start_token": 2860,
                            "end_token": -1,
                            "children": [
                                {
                                    "type": "decorator",
                                    "label": "@classmethod",
                                    "start_token": 2860,
                                    "end_token": 2862,
                                    "children": [
                                        {
                                            "type": "identifier",
                                            "label": "classmethod",
                                            "start_token": -1,
                                            "end_token": 2862,
                                            "children": []
                                        }
                                    ]
                                },
                                {
                                    "type": "function_definition",
                                    "label": "def on_node_executor_sigterm(cls):\n        llprint(f\"[on_node_executor_sigterm {cls.pid}] ⚠️ SIGTERM received\")\n        if not cls.shutdown_lock.acquire(blocking=False):\n            return  # already shutting down\n\n        llprint(f\"[on_node_executor_stop {cls.pid}] ⏳ Releasing locks...\")\n        cls.creds_manager.release_all_locks()\n        llprint(f\"[on_node_executor_stop {cls.pid}] ⏳ Disconnecting Redis...\")\n        redis.disconnect()\n        llprint(f\"[on_node_executor_stop {cls.pid}] ✅ Finished cleanup\")\n        sys.exit(0)",
                                    "start_token": 2862,
                                    "end_token": -1,
                                    "children": [
                                        {
                                            "type": "identifier",
                                            "label": "on_node_executor_sigterm",
                                            "start_token": 2862,
                                            "end_token": -1,
                                            "children": []
                                        },
                                        {
                                            "type": "parameters",
                                            "label": "(cls)",
                                            "start_token": -1,
                                            "end_token": 2868,
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "label": "cls",
                                                    "start_token": -1,
                                                    "end_token": 2868,
                                                    "children": []
                                                }
                                            ]
                                        },
                                        {
                                            "type": "block",
                                            "label": "llprint(f\"[on_node_executor_sigterm {cls.pid}] ⚠️ SIGTERM received\")\n        if not cls.shutdown_lock.acquire(blocking=False):\n            return  # already shutting down\n\n        llprint(f\"[on_node_executor_stop {cls.pid}] ⏳ Releasing locks...\")\n        cls.creds_manager.release_all_locks()\n        llprint(f\"[on_node_executor_stop {cls.pid}] ⏳ Disconnecting Redis...\")\n        redis.disconnect()\n        llprint(f\"[on_node_executor_stop {cls.pid}] ✅ Finished cleanup\")\n        sys.exit(0)",
                                            "start_token": 2871,
                                            "end_token": -1,
                                            "children": [
                                                {
                                                    "type": "expression_statement",
                                                    "label": "llprint(f\"[on_node_executor_sigterm {cls.pid}] ⚠️ SIGTERM received\")",
                                                    "start_token": 2871,
                                                    "end_token": -1,
                                                    "children": [
                                                        {
                                                            "type": "call",
                                                            "label": "llprint(f\"[on_node_executor_sigterm {cls.pid}] ⚠️ SIGTERM received\")",
                                                            "start_token": 2871,
                                                            "end_token": -1,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "label": "llprint",
                                                                    "start_token": 2871,
                                                                    "end_token": 2871,
                                                                    "children": []
                                                                },
                                                                {
                                                                    "type": "argument_list",
                                                                    "label": "(f\"[on_node_executor_sigterm {cls.pid}] ⚠️ SIGTERM received\")",
                                                                    "start_token": 2871,
                                                                    "end_token": -1,
                                                                    "children": [
                                                                        {
                                                                            "type": "string",
                                                                            "label": "f\"[on_node_executor_sigterm {cls.pid}] ⚠️ SIGTERM received\"",
                                                                            "start_token": 2871,
                                                                            "end_token": 2875,
                                                                            "children": [
                                                                                {
                                                                                    "type": "string_start",
                                                                                    "label": "f\"",
                                                                                    "start_token": 2871,
                                                                                    "end_token": 2871,
                                                                                    "children": []
                                                                                },
                                                                                {
                                                                                    "type": "string_content",
                                                                                    "label": "[on_node_executor_sigterm ",
                                                                                    "start_token": 2871,
                                                                                    "end_token": 2871,
                                                                                    "children": []
                                                                                },
                                                                                {
                                                                                    "type": "interpolation",
                                                                                    "label": "{cls.pid}",
                                                                                    "start_token": 2871,
                                                                                    "end_token": 2871,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "attribute",
                                                                                            "label": "cls.pid",
                                                                                            "start_token": 2871,
                                                                                            "end_token": 2871,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "label": "cls",
                                                                                                    "start_token": 2871,
                                                                                                    "end_token": 2871,
                                                                                                    "children": []
                                                                                                },
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "label": "pid",
                                                                                                    "start_token": 2871,
                                                                                                    "end_token": 2871,
                                                                                                    "children": []
                                                                                                }
                                                                                            ]
                                                                                        }
                                                                                    ]
                                                                                },
                                                                                {
                                                                                    "type": "string_content",
                                                                                    "label": "] ⚠️ SIGTERM received",
                                                                                    "start_token": 2871,
                                                                                    "end_token": 2875,
                                                                                    "children": []
                                                                                },
                                                                                {
                                                                                    "type": "string_end",
                                                                                    "label": "\"",
                                                                                    "start_token": 2875,
                                                                                    "end_token": 2875,
                                                                                    "children": []
                                                                                }
                                                                            ]
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                },
                                                {
                                                    "type": "if_statement",
                                                    "label": "if not cls.shutdown_lock.acquire(blocking=False):\n            return  # already shutting down",
                                                    "start_token": 2878,
                                                    "end_token": 2895,
                                                    "children": [
                                                        {
                                                            "type": "not_operator",
                                                            "label": "not cls.shutdown_lock.acquire(blocking=False)",
                                                            "start_token": 2878,
                                                            "end_token": 2888,
                                                            "children": [
                                                                {
                                                                    "type": "call",
                                                                    "label": "cls.shutdown_lock.acquire(blocking=False)",
                                                                    "start_token": 2878,
                                                                    "end_token": 2888,
                                                                    "children": [
                                                                        {
                                                                            "type": "attribute",
                                                                            "label": "cls.shutdown_lock.acquire",
                                                                            "start_token": 2878,
                                                                            "end_token": 2885,
                                                                            "children": [
                                                                                {
                                                                                    "type": "attribute",
                                                                                    "label": "cls.shutdown_lock",
                                                                                    "start_token": 2878,
                                                                                    "end_token": 2882,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "label": "cls",
                                                                                            "start_token": 2878,
                                                                                            "end_token": 2880,
                                                                                            "children": []
                                                                                        },
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "label": "shutdown_lock",
                                                                                            "start_token": 2880,
                                                                                            "end_token": 2882,
                                                                                            "children": []
                                                                                        }
                                                                                    ]
                                                                                },
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "acquire",
                                                                                    "start_token": 2883,
                                                                                    "end_token": 2885,
                                                                                    "children": []
                                                                                }
                                                                            ]
                                                                        },
                                                                        {
                                                                            "type": "argument_list",
                                                                            "label": "(blocking=False)",
                                                                            "start_token": 2886,
                                                                            "end_token": 2888,
                                                                            "children": [
                                                                                {
                                                                                    "type": "keyword_argument",
                                                                                    "label": "blocking=False",
                                                                                    "start_token": 2887,
                                                                                    "end_token": 2888,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "label": "blocking",
                                                                                            "start_token": 2887,
                                                                                            "end_token": -1,
                                                                                            "children": []
                                                                                        },
                                                                                        {
                                                                                            "type": "false",
                                                                                            "label": "False",
                                                                                            "start_token": -1,
                                                                                            "end_token": 2888,
                                                                                            "children": []
                                                                                        }
                                                                                    ]
                                                                                }
                                                                            ]
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        },
                                                        {
                                                            "type": "block",
                                                            "label": "return  # already shutting down",
                                                            "start_token": 2890,
                                                            "end_token": 2895,
                                                            "children": [
                                                                {
                                                                    "type": "return_statement",
                                                                    "label": "return",
                                                                    "start_token": 2890,
                                                                    "end_token": 2891,
                                                                    "children": []
                                                                },
                                                                {
                                                                    "type": "comment",
                                                                    "label": "# already shutting down",
                                                                    "start_token": 2891,
                                                                    "end_token": 2895,
                                                                    "children": []
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                },
                                                {
                                                    "type": "expression_statement",
                                                    "label": "llprint(f\"[on_node_executor_stop {cls.pid}] ⏳ Releasing locks...\")",
                                                    "start_token": 2898,
                                                    "end_token": 2903,
                                                    "children": [
                                                        {
                                                            "type": "call",
                                                            "label": "llprint(f\"[on_node_executor_stop {cls.pid}] ⏳ Releasing locks...\")",
                                                            "start_token": 2898,
                                                            "end_token": 2903,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "label": "llprint",
                                                                    "start_token": 2898,
                                                                    "end_token": 2898,
                                                                    "children": []
                                                                },
                                                                {
                                                                    "type": "argument_list",
                                                                    "label": "(f\"[on_node_executor_stop {cls.pid}] ⏳ Releasing locks...\")",
                                                                    "start_token": 2898,
                                                                    "end_token": 2903,
                                                                    "children": [
                                                                        {
                                                                            "type": "string",
                                                                            "label": "f\"[on_node_executor_stop {cls.pid}] ⏳ Releasing locks...\"",
                                                                            "start_token": 2898,
                                                                            "end_token": 2903,
                                                                            "children": [
                                                                                {
                                                                                    "type": "string_start",
                                                                                    "label": "f\"",
                                                                                    "start_token": 2898,
                                                                                    "end_token": 2898,
                                                                                    "children": []
                                                                                },
                                                                                {
                                                                                    "type": "string_content",
                                                                                    "label": "[on_node_executor_stop ",
                                                                                    "start_token": 2898,
                                                                                    "end_token": 2898,
                                                                                    "children": []
                                                                                },
                                                                                {
                                                                                    "type": "interpolation",
                                                                                    "label": "{cls.pid}",
                                                                                    "start_token": 2898,
                                                                                    "end_token": 2898,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "attribute",
                                                                                            "label": "cls.pid",
                                                                                            "start_token": 2898,
                                                                                            "end_token": 2898,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "label": "cls",
                                                                                                    "start_token": 2898,
                                                                                                    "end_token": 2898,
                                                                                                    "children": []
                                                                                                },
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "label": "pid",
                                                                                                    "start_token": 2898,
                                                                                                    "end_token": 2898,
                                                                                                    "children": []
                                                                                                }
                                                                                            ]
                                                                                        }
                                                                                    ]
                                                                                },
                                                                                {
                                                                                    "type": "string_content",
                                                                                    "label": "] ⏳ Releasing locks...",
                                                                                    "start_token": 2898,
                                                                                    "end_token": 2903,
                                                                                    "children": []
                                                                                },
                                                                                {
                                                                                    "type": "string_end",
                                                                                    "label": "\"",
                                                                                    "start_token": 2903,
                                                                                    "end_token": 2903,
                                                                                    "children": []
                                                                                }
                                                                            ]
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                },
                                                {
                                                    "type": "expression_statement",
                                                    "label": "cls.creds_manager.release_all_locks()",
                                                    "start_token": 2905,
                                                    "end_token": 2911,
                                                    "children": [
                                                        {
                                                            "type": "call",
                                                            "label": "cls.creds_manager.release_all_locks()",
                                                            "start_token": 2905,
                                                            "end_token": 2911,
                                                            "children": [
                                                                {
                                                                    "type": "attribute",
                                                                    "label": "cls.creds_manager.release_all_locks",
                                                                    "start_token": 2905,
                                                                    "end_token": 2909,
                                                                    "children": [
                                                                        {
                                                                            "type": "attribute",
                                                                            "label": "cls.creds_manager",
                                                                            "start_token": 2905,
                                                                            "end_token": 2905,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "cls",
                                                                                    "start_token": 2905,
                                                                                    "end_token": 2905,
                                                                                    "children": []
                                                                                },
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "creds_manager",
                                                                                    "start_token": 2905,
                                                                                    "end_token": 2905,
                                                                                    "children": []
                                                                                }
                                                                            ]
                                                                        },
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "release_all_locks",
                                                                            "start_token": 2907,
                                                                            "end_token": 2909,
                                                                            "children": []
                                                                        }
                                                                    ]
                                                                },
                                                                {
                                                                    "type": "argument_list",
                                                                    "label": "()",
                                                                    "start_token": 2910,
                                                                    "end_token": 2911,
                                                                    "children": []
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                },
                                                {
                                                    "type": "expression_statement",
                                                    "label": "llprint(f\"[on_node_executor_stop {cls.pid}] ⏳ Disconnecting Redis...\")",
                                                    "start_token": 2912,
                                                    "end_token": 2917,
                                                    "children": [
                                                        {
                                                            "type": "call",
                                                            "label": "llprint(f\"[on_node_executor_stop {cls.pid}] ⏳ Disconnecting Redis...\")",
                                                            "start_token": 2912,
                                                            "end_token": 2917,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "label": "llprint",
                                                                    "start_token": 2912,
                                                                    "end_token": 2912,
                                                                    "children": []
                                                                },
                                                                {
                                                                    "type": "argument_list",
                                                                    "label": "(f\"[on_node_executor_stop {cls.pid}] ⏳ Disconnecting Redis...\")",
                                                                    "start_token": 2912,
                                                                    "end_token": 2917,
                                                                    "children": [
                                                                        {
                                                                            "type": "string",
                                                                            "label": "f\"[on_node_executor_stop {cls.pid}] ⏳ Disconnecting Redis...\"",
                                                                            "start_token": 2912,
                                                                            "end_token": 2917,
                                                                            "children": [
                                                                                {
                                                                                    "type": "string_start",
                                                                                    "label": "f\"",
                                                                                    "start_token": 2912,
                                                                                    "end_token": 2912,
                                                                                    "children": []
                                                                                },
                                                                                {
                                                                                    "type": "string_content",
                                                                                    "label": "[on_node_executor_stop ",
                                                                                    "start_token": 2912,
                                                                                    "end_token": 2912,
                                                                                    "children": []
                                                                                },
                                                                                {
                                                                                    "type": "interpolation",
                                                                                    "label": "{cls.pid}",
                                                                                    "start_token": 2912,
                                                                                    "end_token": 2912,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "attribute",
                                                                                            "label": "cls.pid",
                                                                                            "start_token": 2912,
                                                                                            "end_token": 2912,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "label": "cls",
                                                                                                    "start_token": 2912,
                                                                                                    "end_token": 2912,
                                                                                                    "children": []
                                                                                                },
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "label": "pid",
                                                                                                    "start_token": 2912,
                                                                                                    "end_token": 2912,
                                                                                                    "children": []
                                                                                                }
                                                                                            ]
                                                                                        }
                                                                                    ]
                                                                                },
                                                                                {
                                                                                    "type": "string_content",
                                                                                    "label": "] ⏳ Disconnecting Redis...",
                                                                                    "start_token": 2912,
                                                                                    "end_token": 2917,
                                                                                    "children": []
                                                                                },
                                                                                {
                                                                                    "type": "string_end",
                                                                                    "label": "\"",
                                                                                    "start_token": 2917,
                                                                                    "end_token": 2917,
                                                                                    "children": []
                                                                                }
                                                                            ]
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                },
                                                {
                                                    "type": "expression_statement",
                                                    "label": "redis.disconnect()",
                                                    "start_token": -1,
                                                    "end_token": 2924,
                                                    "children": [
                                                        {
                                                            "type": "call",
                                                            "label": "redis.disconnect()",
                                                            "start_token": -1,
                                                            "end_token": 2924,
                                                            "children": [
                                                                {
                                                                    "type": "attribute",
                                                                    "label": "redis.disconnect",
                                                                    "start_token": -1,
                                                                    "end_token": 2923,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "redis",
                                                                            "start_token": -1,
                                                                            "end_token": -1,
                                                                            "children": []
                                                                        },
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "disconnect",
                                                                            "start_token": -1,
                                                                            "end_token": 2923,
                                                                            "children": []
                                                                        }
                                                                    ]
                                                                },
                                                                {
                                                                    "type": "argument_list",
                                                                    "label": "()",
                                                                    "start_token": 2924,
                                                                    "end_token": 2924,
                                                                    "children": []
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                },
                                                {
                                                    "type": "expression_statement",
                                                    "label": "llprint(f\"[on_node_executor_stop {cls.pid}] ✅ Finished cleanup\")",
                                                    "start_token": 2924,
                                                    "end_token": 2934,
                                                    "children": [
                                                        {
                                                            "type": "call",
                                                            "label": "llprint(f\"[on_node_executor_stop {cls.pid}] ✅ Finished cleanup\")",
                                                            "start_token": 2924,
                                                            "end_token": 2934,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "label": "llprint",
                                                                    "start_token": 2924,
                                                                    "end_token": 2924,
                                                                    "children": []
                                                                },
                                                                {
                                                                    "type": "argument_list",
                                                                    "label": "(f\"[on_node_executor_stop {cls.pid}] ✅ Finished cleanup\")",
                                                                    "start_token": 2924,
                                                                    "end_token": 2934,
                                                                    "children": [
                                                                        {
                                                                            "type": "string",
                                                                            "label": "f\"[on_node_executor_stop {cls.pid}] ✅ Finished cleanup\"",
                                                                            "start_token": 2924,
                                                                            "end_token": 2933,
                                                                            "children": [
                                                                                {
                                                                                    "type": "string_start",
                                                                                    "label": "f\"",
                                                                                    "start_token": 2924,
                                                                                    "end_token": 2924,
                                                                                    "children": []
                                                                                },
                                                                                {
                                                                                    "type": "string_content",
                                                                                    "label": "[on_node_executor_stop ",
                                                                                    "start_token": 2924,
                                                                                    "end_token": 2924,
                                                                                    "children": []
                                                                                },
                                                                                {
                                                                                    "type": "interpolation",
                                                                                    "label": "{cls.pid}",
                                                                                    "start_token": 2924,
                                                                                    "end_token": 2924,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "attribute",
                                                                                            "label": "cls.pid",
                                                                                            "start_token": 2924,
                                                                                            "end_token": 2924,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "label": "cls",
                                                                                                    "start_token": 2924,
                                                                                                    "end_token": 2924,
                                                                                                    "children": []
                                                                                                },
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "label": "pid",
                                                                                                    "start_token": 2924,
                                                                                                    "end_token": 2924,
                                                                                                    "children": []
                                                                                                }
                                                                                            ]
                                                                                        }
                                                                                    ]
                                                                                },
                                                                                {
                                                                                    "type": "string_content",
                                                                                    "label": "] ✅ Finished cleanup",
                                                                                    "start_token": 2924,
                                                                                    "end_token": 2932,
                                                                                    "children": []
                                                                                },
                                                                                {
                                                                                    "type": "string_end",
                                                                                    "label": "\"",
                                                                                    "start_token": 2933,
                                                                                    "end_token": 2933,
                                                                                    "children": []
                                                                                }
                                                                            ]
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                },
                                                {
                                                    "type": "expression_statement",
                                                    "label": "sys.exit(0)",
                                                    "start_token": 2936,
                                                    "end_token": -1,
                                                    "children": [
                                                        {
                                                            "type": "call",
                                                            "label": "sys.exit(0)",
                                                            "start_token": 2936,
                                                            "end_token": -1,
                                                            "children": [
                                                                {
                                                                    "type": "attribute",
                                                                    "label": "sys.exit",
                                                                    "start_token": 2936,
                                                                    "end_token": 2937,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "sys",
                                                                            "start_token": 2936,
                                                                            "end_token": 2936,
                                                                            "children": []
                                                                        },
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "exit",
                                                                            "start_token": 2936,
                                                                            "end_token": 2937,
                                                                            "children": []
                                                                        }
                                                                    ]
                                                                },
                                                                {
                                                                    "type": "argument_list",
                                                                    "label": "(0)",
                                                                    "start_token": -1,
                                                                    "end_token": -1,
                                                                    "children": [
                                                                        {
                                                                            "type": "integer",
                                                                            "label": "0",
                                                                            "start_token": -1,
                                                                            "end_token": -1,
                                                                            "children": []
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                }
                                            ]
                                        }
                                    ]
                                }
                            ]
                        },
                        {
                            "type": "decorated_definition",
                            "label": "@classmethod\n    @error_logged\n    def on_node_execution(\n        cls,\n        q: ExecutionQueue[NodeExecutionEntry],\n        node_exec: NodeExecutionEntry,\n    ) -> dict[str, Any]:\n        log_metadata = LogMetadata(\n            user_id=node_exec.user_id,\n            graph_eid=node_exec.graph_exec_id,\n            graph_id=node_exec.graph_id,\n            node_eid=node_exec.node_exec_id,\n            node_id=node_exec.node_id,\n            block_name=\"-\",\n        )\n\n        execution_stats = {}\n        timing_info, _ = cls._on_node_execution(\n            q, node_exec, log_metadata, execution_stats\n        )\n        execution_stats[\"walltime\"] = timing_info.wall_time\n        execution_stats[\"cputime\"] = timing_info.cpu_time\n\n        cls.db_client.update_node_execution_stats(\n            node_exec.node_exec_id, execution_stats\n        )\n        return execution_stats",
                            "start_token": 2939,
                            "end_token": -1,
                            "children": [
                                {
                                    "type": "decorator",
                                    "label": "@classmethod",
                                    "start_token": 2939,
                                    "end_token": -1,
                                    "children": [
                                        {
                                            "type": "identifier",
                                            "label": "classmethod",
                                            "start_token": 2939,
                                            "end_token": -1,
                                            "children": []
                                        }
                                    ]
                                },
                                {
                                    "type": "decorator",
                                    "label": "@error_logged",
                                    "start_token": 2942,
                                    "end_token": 2942,
                                    "children": [
                                        {
                                            "type": "identifier",
                                            "label": "error_logged",
                                            "start_token": 2942,
                                            "end_token": 2942,
                                            "children": []
                                        }
                                    ]
                                },
                                {
                                    "type": "function_definition",
                                    "label": "def on_node_execution(\n        cls,\n        q: ExecutionQueue[NodeExecutionEntry],\n        node_exec: NodeExecutionEntry,\n    ) -> dict[str, Any]:\n        log_metadata = LogMetadata(\n            user_id=node_exec.user_id,\n            graph_eid=node_exec.graph_exec_id,\n            graph_id=node_exec.graph_id,\n            node_eid=node_exec.node_exec_id,\n            node_id=node_exec.node_id,\n            block_name=\"-\",\n        )\n\n        execution_stats = {}\n        timing_info, _ = cls._on_node_execution(\n            q, node_exec, log_metadata, execution_stats\n        )\n        execution_stats[\"walltime\"] = timing_info.wall_time\n        execution_stats[\"cputime\"] = timing_info.cpu_time\n\n        cls.db_client.update_node_execution_stats(\n            node_exec.node_exec_id, execution_stats\n        )\n        return execution_stats",
                                    "start_token": 2944,
                                    "end_token": -1,
                                    "children": [
                                        {
                                            "type": "identifier",
                                            "label": "on_node_execution",
                                            "start_token": -1,
                                            "end_token": -1,
                                            "children": []
                                        },
                                        {
                                            "type": "parameters",
                                            "label": "(\n        cls,\n        q: ExecutionQueue[NodeExecutionEntry],\n        node_exec: NodeExecutionEntry,\n    )",
                                            "start_token": -1,
                                            "end_token": -1,
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "label": "cls",
                                                    "start_token": 2950,
                                                    "end_token": 2950,
                                                    "children": []
                                                },
                                                {
                                                    "type": "typed_parameter",
                                                    "label": "q: ExecutionQueue[NodeExecutionEntry]",
                                                    "start_token": 2952,
                                                    "end_token": 2958,
                                                    "children": [
                                                        {
                                                            "type": "identifier",
                                                            "label": "q",
                                                            "start_token": 2952,
                                                            "end_token": 2952,
                                                            "children": []
                                                        },
                                                        {
                                                            "type": "type",
                                                            "label": "ExecutionQueue[NodeExecutionEntry]",
                                                            "start_token": 2952,
                                                            "end_token": 2958,
                                                            "children": [
                                                                {
                                                                    "type": "generic_type",
                                                                    "label": "ExecutionQueue[NodeExecutionEntry]",
                                                                    "start_token": 2952,
                                                                    "end_token": 2958,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "ExecutionQueue",
                                                                            "start_token": 2952,
                                                                            "end_token": 2955,
                                                                            "children": []
                                                                        },
                                                                        {
                                                                            "type": "type_parameter",
                                                                            "label": "[NodeExecutionEntry]",
                                                                            "start_token": -1,
                                                                            "end_token": 2958,
                                                                            "children": [
                                                                                {
                                                                                    "type": "type",
                                                                                    "label": "NodeExecutionEntry",
                                                                                    "start_token": -1,
                                                                                    "end_token": -1,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "label": "NodeExecutionEntry",
                                                                                            "start_token": -1,
                                                                                            "end_token": -1,
                                                                                            "children": []
                                                                                        }
                                                                                    ]
                                                                                }
                                                                            ]
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                },
                                                {
                                                    "type": "typed_parameter",
                                                    "label": "node_exec: NodeExecutionEntry",
                                                    "start_token": 2958,
                                                    "end_token": 2968,
                                                    "children": [
                                                        {
                                                            "type": "identifier",
                                                            "label": "node_exec",
                                                            "start_token": 2958,
                                                            "end_token": 2960,
                                                            "children": []
                                                        },
                                                        {
                                                            "type": "type",
                                                            "label": "NodeExecutionEntry",
                                                            "start_token": -1,
                                                            "end_token": 2968,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "label": "NodeExecutionEntry",
                                                                    "start_token": -1,
                                                                    "end_token": 2968,
                                                                    "children": []
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                }
                                            ]
                                        },
                                        {
                                            "type": "type",
                                            "label": "dict[str, Any]",
                                            "start_token": -1,
                                            "end_token": 2972,
                                            "children": [
                                                {
                                                    "type": "generic_type",
                                                    "label": "dict[str, Any]",
                                                    "start_token": -1,
                                                    "end_token": 2972,
                                                    "children": [
                                                        {
                                                            "type": "identifier",
                                                            "label": "dict",
                                                            "start_token": -1,
                                                            "end_token": 2972,
                                                            "children": []
                                                        },
                                                        {
                                                            "type": "type_parameter",
                                                            "label": "[str, Any]",
                                                            "start_token": 2972,
                                                            "end_token": 2972,
                                                            "children": [
                                                                {
                                                                    "type": "type",
                                                                    "label": "str",
                                                                    "start_token": 2972,
                                                                    "end_token": 2972,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "str",
                                                                            "start_token": 2972,
                                                                            "end_token": 2972,
                                                                            "children": []
                                                                        }
                                                                    ]
                                                                },
                                                                {
                                                                    "type": "type",
                                                                    "label": "Any",
                                                                    "start_token": 2972,
                                                                    "end_token": 2972,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "Any",
                                                                            "start_token": 2972,
                                                                            "end_token": 2972,
                                                                            "children": []
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                }
                                            ]
                                        },
                                        {
                                            "type": "block",
                                            "label": "log_metadata = LogMetadata(\n            user_id=node_exec.user_id,\n            graph_eid=node_exec.graph_exec_id,\n            graph_id=node_exec.graph_id,\n            node_eid=node_exec.node_exec_id,\n            node_id=node_exec.node_id,\n            block_name=\"-\",\n        )\n\n        execution_stats = {}\n        timing_info, _ = cls._on_node_execution(\n            q, node_exec, log_metadata, execution_stats\n        )\n        execution_stats[\"walltime\"] = timing_info.wall_time\n        execution_stats[\"cputime\"] = timing_info.cpu_time\n\n        cls.db_client.update_node_execution_stats(\n            node_exec.node_exec_id, execution_stats\n        )\n        return execution_stats",
                                            "start_token": 2974,
                                            "end_token": -1,
                                            "children": [
                                                {
                                                    "type": "expression_statement",
                                                    "label": "log_metadata = LogMetadata(\n            user_id=node_exec.user_id,\n            graph_eid=node_exec.graph_exec_id,\n            graph_id=node_exec.graph_id,\n            node_eid=node_exec.node_exec_id,\n            node_id=node_exec.node_id,\n            block_name=\"-\",\n        )",
                                                    "start_token": 2974,
                                                    "end_token": 3020,
                                                    "children": [
                                                        {
                                                            "type": "assignment",
                                                            "label": "log_metadata = LogMetadata(\n            user_id=node_exec.user_id,\n            graph_eid=node_exec.graph_exec_id,\n            graph_id=node_exec.graph_id,\n            node_eid=node_exec.node_exec_id,\n            node_id=node_exec.node_id,\n            block_name=\"-\",\n        )",
                                                            "start_token": 2974,
                                                            "end_token": 3020,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "label": "log_metadata",
                                                                    "start_token": 2974,
                                                                    "end_token": -1,
                                                                    "children": []
                                                                },
                                                                {
                                                                    "type": "call",
                                                                    "label": "LogMetadata(\n            user_id=node_exec.user_id,\n            graph_eid=node_exec.graph_exec_id,\n            graph_id=node_exec.graph_id,\n            node_eid=node_exec.node_exec_id,\n            node_id=node_exec.node_id,\n            block_name=\"-\",\n        )",
                                                                    "start_token": -1,
                                                                    "end_token": 3020,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "LogMetadata",
                                                                            "start_token": -1,
                                                                            "end_token": 2978,
                                                                            "children": []
                                                                        },
                                                                        {
                                                                            "type": "argument_list",
                                                                            "label": "(\n            user_id=node_exec.user_id,\n            graph_eid=node_exec.graph_exec_id,\n            graph_id=node_exec.graph_id,\n            node_eid=node_exec.node_exec_id,\n            node_id=node_exec.node_id,\n            block_name=\"-\",\n        )",
                                                                            "start_token": 2979,
                                                                            "end_token": 3020,
                                                                            "children": [
                                                                                {
                                                                                    "type": "keyword_argument",
                                                                                    "label": "user_id=node_exec.user_id",
                                                                                    "start_token": 2981,
                                                                                    "end_token": 2984,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "label": "user_id",
                                                                                            "start_token": 2981,
                                                                                            "end_token": -1,
                                                                                            "children": []
                                                                                        },
                                                                                        {
                                                                                            "type": "attribute",
                                                                                            "label": "node_exec.user_id",
                                                                                            "start_token": -1,
                                                                                            "end_token": 2984,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "label": "node_exec",
                                                                                                    "start_token": -1,
                                                                                                    "end_token": -1,
                                                                                                    "children": []
                                                                                                },
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "label": "user_id",
                                                                                                    "start_token": 2984,
                                                                                                    "end_token": 2984,
                                                                                                    "children": []
                                                                                                }
                                                                                            ]
                                                                                        }
                                                                                    ]
                                                                                },
                                                                                {
                                                                                    "type": "keyword_argument",
                                                                                    "label": "graph_eid=node_exec.graph_exec_id",
                                                                                    "start_token": 2988,
                                                                                    "end_token": 2991,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "label": "graph_eid",
                                                                                            "start_token": 2988,
                                                                                            "end_token": 2988,
                                                                                            "children": []
                                                                                        },
                                                                                        {
                                                                                            "type": "attribute",
                                                                                            "label": "node_exec.graph_exec_id",
                                                                                            "start_token": 2988,
                                                                                            "end_token": 2991,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "label": "node_exec",
                                                                                                    "start_token": 2988,
                                                                                                    "end_token": -1,
                                                                                                    "children": []
                                                                                                },
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "label": "graph_exec_id",
                                                                                                    "start_token": -1,
                                                                                                    "end_token": 2991,
                                                                                                    "children": []
                                                                                                }
                                                                                            ]
                                                                                        }
                                                                                    ]
                                                                                },
                                                                                {
                                                                                    "type": "keyword_argument",
                                                                                    "label": "graph_id=node_exec.graph_id",
                                                                                    "start_token": 2995,
                                                                                    "end_token": 2998,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "label": "graph_id",
                                                                                            "start_token": 2995,
                                                                                            "end_token": -1,
                                                                                            "children": []
                                                                                        },
                                                                                        {
                                                                                            "type": "attribute",
                                                                                            "label": "node_exec.graph_id",
                                                                                            "start_token": -1,
                                                                                            "end_token": 2998,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "label": "node_exec",
                                                                                                    "start_token": -1,
                                                                                                    "end_token": -1,
                                                                                                    "children": []
                                                                                                },
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "label": "graph_id",
                                                                                                    "start_token": 2998,
                                                                                                    "end_token": 2998,
                                                                                                    "children": []
                                                                                                }
                                                                                            ]
                                                                                        }
                                                                                    ]
                                                                                },
                                                                                {
                                                                                    "type": "keyword_argument",
                                                                                    "label": "node_eid=node_exec.node_exec_id",
                                                                                    "start_token": 3002,
                                                                                    "end_token": 3006,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "label": "node_eid",
                                                                                            "start_token": 3002,
                                                                                            "end_token": 3002,
                                                                                            "children": []
                                                                                        },
                                                                                        {
                                                                                            "type": "attribute",
                                                                                            "label": "node_exec.node_exec_id",
                                                                                            "start_token": 3003,
                                                                                            "end_token": 3006,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "label": "node_exec",
                                                                                                    "start_token": 3003,
                                                                                                    "end_token": -1,
                                                                                                    "children": []
                                                                                                },
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "label": "node_exec_id",
                                                                                                    "start_token": -1,
                                                                                                    "end_token": 3006,
                                                                                                    "children": []
                                                                                                }
                                                                                            ]
                                                                                        }
                                                                                    ]
                                                                                },
                                                                                {
                                                                                    "type": "keyword_argument",
                                                                                    "label": "node_id=node_exec.node_id",
                                                                                    "start_token": 3009,
                                                                                    "end_token": 3012,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "label": "node_id",
                                                                                            "start_token": 3009,
                                                                                            "end_token": -1,
                                                                                            "children": []
                                                                                        },
                                                                                        {
                                                                                            "type": "attribute",
                                                                                            "label": "node_exec.node_id",
                                                                                            "start_token": -1,
                                                                                            "end_token": 3012,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "label": "node_exec",
                                                                                                    "start_token": -1,
                                                                                                    "end_token": -1,
                                                                                                    "children": []
                                                                                                },
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "label": "node_id",
                                                                                                    "start_token": 3012,
                                                                                                    "end_token": 3012,
                                                                                                    "children": []
                                                                                                }
                                                                                            ]
                                                                                        }
                                                                                    ]
                                                                                },
                                                                                {
                                                                                    "type": "keyword_argument",
                                                                                    "label": "block_name=\"-\"",
                                                                                    "start_token": -1,
                                                                                    "end_token": 3020,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "label": "block_name",
                                                                                            "start_token": -1,
                                                                                            "end_token": -1,
                                                                                            "children": []
                                                                                        },
                                                                                        {
                                                                                            "type": "string",
                                                                                            "label": "\"-\"",
                                                                                            "start_token": -1,
                                                                                            "end_token": 3020,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "string_start",
                                                                                                    "label": "\"",
                                                                                                    "start_token": -1,
                                                                                                    "end_token": -1,
                                                                                                    "children": []
                                                                                                },
                                                                                                {
                                                                                                    "type": "string_content",
                                                                                                    "label": "-",
                                                                                                    "start_token": -1,
                                                                                                    "end_token": -1,
                                                                                                    "children": []
                                                                                                },
                                                                                                {
                                                                                                    "type": "string_end",
                                                                                                    "label": "\"",
                                                                                                    "start_token": 3020,
                                                                                                    "end_token": 3020,
                                                                                                    "children": []
                                                                                                }
                                                                                            ]
                                                                                        }
                                                                                    ]
                                                                                }
                                                                            ]
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                },
                                                {
                                                    "type": "expression_statement",
                                                    "label": "execution_stats = {}",
                                                    "start_token": -1,
                                                    "end_token": -1,
                                                    "children": [
                                                        {
                                                            "type": "assignment",
                                                            "label": "execution_stats = {}",
                                                            "start_token": -1,
                                                            "end_token": -1,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "label": "execution_stats",
                                                                    "start_token": -1,
                                                                    "end_token": 3025,
                                                                    "children": []
                                                                },
                                                                {
                                                                    "type": "dictionary",
                                                                    "label": "{}",
                                                                    "start_token": 3026,
                                                                    "end_token": -1,
                                                                    "children": []
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                },
                                                {
                                                    "type": "expression_statement",
                                                    "label": "timing_info, _ = cls._on_node_execution(\n            q, node_exec, log_metadata, execution_stats\n        )",
                                                    "start_token": 3031,
                                                    "end_token": 3044,
                                                    "children": [
                                                        {
                                                            "type": "assignment",
                                                            "label": "timing_info, _ = cls._on_node_execution(\n            q, node_exec, log_metadata, execution_stats\n        )",
                                                            "start_token": 3031,
                                                            "end_token": 3044,
                                                            "children": [
                                                                {
                                                                    "type": "pattern_list",
                                                                    "label": "timing_info, _",
                                                                    "start_token": 3031,
                                                                    "end_token": 3031,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "timing_info",
                                                                            "start_token": 3031,
                                                                            "end_token": 3031,
                                                                            "children": []
                                                                        },
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "_",
                                                                            "start_token": 3031,
                                                                            "end_token": 3031,
                                                                            "children": []
                                                                        }
                                                                    ]
                                                                },
                                                                {
                                                                    "type": "call",
                                                                    "label": "cls._on_node_execution(\n            q, node_exec, log_metadata, execution_stats\n        )",
                                                                    "start_token": 3032,
                                                                    "end_token": 3044,
                                                                    "children": [
                                                                        {
                                                                            "type": "attribute",
                                                                            "label": "cls._on_node_execution",
                                                                            "start_token": 3032,
                                                                            "end_token": 3036,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "cls",
                                                                                    "start_token": 3032,
                                                                                    "end_token": -1,
                                                                                    "children": []
                                                                                },
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "_on_node_execution",
                                                                                    "start_token": -1,
                                                                                    "end_token": 3036,
                                                                                    "children": []
                                                                                }
                                                                            ]
                                                                        },
                                                                        {
                                                                            "type": "argument_list",
                                                                            "label": "(\n            q, node_exec, log_metadata, execution_stats\n        )",
                                                                            "start_token": 3036,
                                                                            "end_token": 3044,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "q",
                                                                                    "start_token": 3038,
                                                                                    "end_token": 3038,
                                                                                    "children": []
                                                                                },
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "node_exec",
                                                                                    "start_token": 3038,
                                                                                    "end_token": 3040,
                                                                                    "children": []
                                                                                },
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "log_metadata",
                                                                                    "start_token": 3040,
                                                                                    "end_token": -1,
                                                                                    "children": []
                                                                                },
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "execution_stats",
                                                                                    "start_token": -1,
                                                                                    "end_token": 3044,
                                                                                    "children": []
                                                                                }
                                                                            ]
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                },
                                                {
                                                    "type": "expression_statement",
                                                    "label": "execution_stats[\"walltime\"] = timing_info.wall_time",
                                                    "start_token": 3046,
                                                    "end_token": 3053,
                                                    "children": [
                                                        {
                                                            "type": "assignment",
                                                            "label": "execution_stats[\"walltime\"] = timing_info.wall_time",
                                                            "start_token": 3046,
                                                            "end_token": 3053,
                                                            "children": [
                                                                {
                                                                    "type": "subscript",
                                                                    "label": "execution_stats[\"walltime\"]",
                                                                    "start_token": 3046,
                                                                    "end_token": 3051,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "execution_stats",
                                                                            "start_token": 3046,
                                                                            "end_token": 3049,
                                                                            "children": []
                                                                        },
                                                                        {
                                                                            "type": "string",
                                                                            "label": "\"walltime\"",
                                                                            "start_token": 3049,
                                                                            "end_token": 3051,
                                                                            "children": [
                                                                                {
                                                                                    "type": "string_start",
                                                                                    "label": "\"",
                                                                                    "start_token": 3049,
                                                                                    "end_token": 3049,
                                                                                    "children": []
                                                                                },
                                                                                {
                                                                                    "type": "string_content",
                                                                                    "label": "walltime",
                                                                                    "start_token": 3049,
                                                                                    "end_token": 3051,
                                                                                    "children": []
                                                                                },
                                                                                {
                                                                                    "type": "string_end",
                                                                                    "label": "\"",
                                                                                    "start_token": 3051,
                                                                                    "end_token": 3051,
                                                                                    "children": []
                                                                                }
                                                                            ]
                                                                        }
                                                                    ]
                                                                },
                                                                {
                                                                    "type": "attribute",
                                                                    "label": "timing_info.wall_time",
                                                                    "start_token": -1,
                                                                    "end_token": 3053,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "timing_info",
                                                                            "start_token": -1,
                                                                            "end_token": 3053,
                                                                            "children": []
                                                                        },
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "wall_time",
                                                                            "start_token": 3053,
                                                                            "end_token": 3053,
                                                                            "children": []
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                },
                                                {
                                                    "type": "expression_statement",
                                                    "label": "execution_stats[\"cputime\"] = timing_info.cpu_time",
                                                    "start_token": 3055,
                                                    "end_token": 3065,
                                                    "children": [
                                                        {
                                                            "type": "assignment",
                                                            "label": "execution_stats[\"cputime\"] = timing_info.cpu_time",
                                                            "start_token": 3055,
                                                            "end_token": 3065,
                                                            "children": [
                                                                {
                                                                    "type": "subscript",
                                                                    "label": "execution_stats[\"cputime\"]",
                                                                    "start_token": 3055,
                                                                    "end_token": 3060,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "execution_stats",
                                                                            "start_token": 3055,
                                                                            "end_token": 3058,
                                                                            "children": []
                                                                        },
                                                                        {
                                                                            "type": "string",
                                                                            "label": "\"cputime\"",
                                                                            "start_token": 3058,
                                                                            "end_token": 3060,
                                                                            "children": [
                                                                                {
                                                                                    "type": "string_start",
                                                                                    "label": "\"",
                                                                                    "start_token": 3058,
                                                                                    "end_token": 3058,
                                                                                    "children": []
                                                                                },
                                                                                {
                                                                                    "type": "string_content",
                                                                                    "label": "cputime",
                                                                                    "start_token": 3058,
                                                                                    "end_token": 3060,
                                                                                    "children": []
                                                                                },
                                                                                {
                                                                                    "type": "string_end",
                                                                                    "label": "\"",
                                                                                    "start_token": 3060,
                                                                                    "end_token": 3060,
                                                                                    "children": []
                                                                                }
                                                                            ]
                                                                        }
                                                                    ]
                                                                },
                                                                {
                                                                    "type": "attribute",
                                                                    "label": "timing_info.cpu_time",
                                                                    "start_token": -1,
                                                                    "end_token": 3065,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "timing_info",
                                                                            "start_token": -1,
                                                                            "end_token": 3063,
                                                                            "children": []
                                                                        },
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "cpu_time",
                                                                            "start_token": 3065,
                                                                            "end_token": 3065,
                                                                            "children": []
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                },
                                                {
                                                    "type": "expression_statement",
                                                    "label": "cls.db_client.update_node_execution_stats(\n            node_exec.node_exec_id, execution_stats\n        )",
                                                    "start_token": 3067,
                                                    "end_token": 3079,
                                                    "children": [
                                                        {
                                                            "type": "call",
                                                            "label": "cls.db_client.update_node_execution_stats(\n            node_exec.node_exec_id, execution_stats\n        )",
                                                            "start_token": 3067,
                                                            "end_token": 3079,
                                                            "children": [
                                                                {
                                                                    "type": "attribute",
                                                                    "label": "cls.db_client.update_node_execution_stats",
                                                                    "start_token": 3067,
                                                                    "end_token": 3070,
                                                                    "children": [
                                                                        {
                                                                            "type": "attribute",
                                                                            "label": "cls.db_client",
                                                                            "start_token": 3067,
                                                                            "end_token": 3067,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "cls",
                                                                                    "start_token": 3067,
                                                                                    "end_token": 3067,
                                                                                    "children": []
                                                                                },
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "db_client",
                                                                                    "start_token": 3067,
                                                                                    "end_token": 3067,
                                                                                    "children": []
                                                                                }
                                                                            ]
                                                                        },
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "update_node_execution_stats",
                                                                            "start_token": 3067,
                                                                            "end_token": 3070,
                                                                            "children": []
                                                                        }
                                                                    ]
                                                                },
                                                                {
                                                                    "type": "argument_list",
                                                                    "label": "(\n            node_exec.node_exec_id, execution_stats\n        )",
                                                                    "start_token": 3070,
                                                                    "end_token": 3079,
                                                                    "children": [
                                                                        {
                                                                            "type": "attribute",
                                                                            "label": "node_exec.node_exec_id",
                                                                            "start_token": 3073,
                                                                            "end_token": -1,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "node_exec",
                                                                                    "start_token": 3073,
                                                                                    "end_token": 3074,
                                                                                    "children": []
                                                                                },
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "node_exec_id",
                                                                                    "start_token": 3074,
                                                                                    "end_token": -1,
                                                                                    "children": []
                                                                                }
                                                                            ]
                                                                        },
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "execution_stats",
                                                                            "start_token": -1,
                                                                            "end_token": 3078,
                                                                            "children": []
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                },
                                                {
                                                    "type": "return_statement",
                                                    "label": "return execution_stats",
                                                    "start_token": 3080,
                                                    "end_token": -1,
                                                    "children": [
                                                        {
                                                            "type": "identifier",
                                                            "label": "execution_stats",
                                                            "start_token": 3083,
                                                            "end_token": -1,
                                                            "children": []
                                                        }
                                                    ]
                                                }
                                            ]
                                        }
                                    ]
                                }
                            ]
                        },
                        {
                            "type": "decorated_definition",
                            "label": "@classmethod\n    @time_measured\n    def _on_node_execution(\n        cls,\n        q: ExecutionQueue[NodeExecutionEntry],\n        node_exec: NodeExecutionEntry,\n        log_metadata: LogMetadata,\n        stats: dict[str, Any] | None = None,\n    ):\n        try:\n            log_metadata.info(f\"Start node execution {node_exec.node_exec_id}\")\n            for execution in execute_node(\n                cls.db_client, cls.creds_manager, node_exec, stats\n            ):\n                q.add(execution)\n            log_metadata.info(f\"Finished node execution {node_exec.node_exec_id}\")\n        except Exception as e:\n            log_metadata.exception(\n                f\"Failed node execution {node_exec.node_exec_id}: {e}\"\n            )",
                            "start_token": 3086,
                            "end_token": -1,
                            "children": [
                                {
                                    "type": "decorator",
                                    "label": "@classmethod",
                                    "start_token": 3086,
                                    "end_token": -1,
                                    "children": [
                                        {
                                            "type": "identifier",
                                            "label": "classmethod",
                                            "start_token": 3086,
                                            "end_token": -1,
                                            "children": []
                                        }
                                    ]
                                },
                                {
                                    "type": "decorator",
                                    "label": "@time_measured",
                                    "start_token": -1,
                                    "end_token": 3089,
                                    "children": [
                                        {
                                            "type": "identifier",
                                            "label": "time_measured",
                                            "start_token": 3089,
                                            "end_token": 3089,
                                            "children": []
                                        }
                                    ]
                                },
                                {
                                    "type": "function_definition",
                                    "label": "def _on_node_execution(\n        cls,\n        q: ExecutionQueue[NodeExecutionEntry],\n        node_exec: NodeExecutionEntry,\n        log_metadata: LogMetadata,\n        stats: dict[str, Any] | None = None,\n    ):\n        try:\n            log_metadata.info(f\"Start node execution {node_exec.node_exec_id}\")\n            for execution in execute_node(\n                cls.db_client, cls.creds_manager, node_exec, stats\n            ):\n                q.add(execution)\n            log_metadata.info(f\"Finished node execution {node_exec.node_exec_id}\")\n        except Exception as e:\n            log_metadata.exception(\n                f\"Failed node execution {node_exec.node_exec_id}: {e}\"\n            )",
                                    "start_token": 3090,
                                    "end_token": -1,
                                    "children": [
                                        {
                                            "type": "identifier",
                                            "label": "_on_node_execution",
                                            "start_token": -1,
                                            "end_token": -1,
                                            "children": []
                                        },
                                        {
                                            "type": "parameters",
                                            "label": "(\n        cls,\n        q: ExecutionQueue[NodeExecutionEntry],\n        node_exec: NodeExecutionEntry,\n        log_metadata: LogMetadata,\n        stats: dict[str, Any] | None = None,\n    )",
                                            "start_token": -1,
                                            "end_token": -1,
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "label": "cls",
                                                    "start_token": 3097,
                                                    "end_token": 3097,
                                                    "children": []
                                                },
                                                {
                                                    "type": "typed_parameter",
                                                    "label": "q: ExecutionQueue[NodeExecutionEntry]",
                                                    "start_token": 3099,
                                                    "end_token": 3105,
                                                    "children": [
                                                        {
                                                            "type": "identifier",
                                                            "label": "q",
                                                            "start_token": 3099,
                                                            "end_token": 3099,
                                                            "children": []
                                                        },
                                                        {
                                                            "type": "type",
                                                            "label": "ExecutionQueue[NodeExecutionEntry]",
                                                            "start_token": 3099,
                                                            "end_token": 3105,
                                                            "children": [
                                                                {
                                                                    "type": "generic_type",
                                                                    "label": "ExecutionQueue[NodeExecutionEntry]",
                                                                    "start_token": 3099,
                                                                    "end_token": 3105,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "ExecutionQueue",
                                                                            "start_token": 3099,
                                                                            "end_token": 3102,
                                                                            "children": []
                                                                        },
                                                                        {
                                                                            "type": "type_parameter",
                                                                            "label": "[NodeExecutionEntry]",
                                                                            "start_token": -1,
                                                                            "end_token": 3105,
                                                                            "children": [
                                                                                {
                                                                                    "type": "type",
                                                                                    "label": "NodeExecutionEntry",
                                                                                    "start_token": -1,
                                                                                    "end_token": -1,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "label": "NodeExecutionEntry",
                                                                                            "start_token": -1,
                                                                                            "end_token": -1,
                                                                                            "children": []
                                                                                        }
                                                                                    ]
                                                                                }
                                                                            ]
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                },
                                                {
                                                    "type": "typed_parameter",
                                                    "label": "node_exec: NodeExecutionEntry",
                                                    "start_token": 3105,
                                                    "end_token": 3108,
                                                    "children": [
                                                        {
                                                            "type": "identifier",
                                                            "label": "node_exec",
                                                            "start_token": 3105,
                                                            "end_token": 3107,
                                                            "children": []
                                                        },
                                                        {
                                                            "type": "type",
                                                            "label": "NodeExecutionEntry",
                                                            "start_token": -1,
                                                            "end_token": 3108,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "label": "NodeExecutionEntry",
                                                                    "start_token": -1,
                                                                    "end_token": 3108,
                                                                    "children": []
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                },
                                                {
                                                    "type": "typed_parameter",
                                                    "label": "log_metadata: LogMetadata",
                                                    "start_token": 3110,
                                                    "end_token": 3116,
                                                    "children": [
                                                        {
                                                            "type": "identifier",
                                                            "label": "log_metadata",
                                                            "start_token": 3110,
                                                            "end_token": -1,
                                                            "children": []
                                                        },
                                                        {
                                                            "type": "type",
                                                            "label": "LogMetadata",
                                                            "start_token": 3113,
                                                            "end_token": 3116,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "label": "LogMetadata",
                                                                    "start_token": 3113,
                                                                    "end_token": 3116,
                                                                    "children": []
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                },
                                                {
                                                    "type": "typed_default_parameter",
                                                    "label": "stats: dict[str, Any] | None = None",
                                                    "start_token": 3121,
                                                    "end_token": 3132,
                                                    "children": [
                                                        {
                                                            "type": "identifier",
                                                            "label": "stats",
                                                            "start_token": 3121,
                                                            "end_token": 3122,
                                                            "children": []
                                                        },
                                                        {
                                                            "type": "type",
                                                            "label": "dict[str, Any] | None",
                                                            "start_token": 3123,
                                                            "end_token": -1,
                                                            "children": [
                                                                {
                                                                    "type": "union_type",
                                                                    "label": "dict[str, Any] | None",
                                                                    "start_token": 3123,
                                                                    "end_token": -1,
                                                                    "children": [
                                                                        {
                                                                            "type": "type",
                                                                            "label": "dict[str, Any]",
                                                                            "start_token": 3123,
                                                                            "end_token": 3128,
                                                                            "children": [
                                                                                {
                                                                                    "type": "generic_type",
                                                                                    "label": "dict[str, Any]",
                                                                                    "start_token": 3123,
                                                                                    "end_token": 3128,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "label": "dict",
                                                                                            "start_token": 3123,
                                                                                            "end_token": 3124,
                                                                                            "children": []
                                                                                        },
                                                                                        {
                                                                                            "type": "type_parameter",
                                                                                            "label": "[str, Any]",
                                                                                            "start_token": 3124,
                                                                                            "end_token": 3128,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "type",
                                                                                                    "label": "str",
                                                                                                    "start_token": 3124,
                                                                                                    "end_token": 3126,
                                                                                                    "children": [
                                                                                                        {
                                                                                                            "type": "identifier",
                                                                                                            "label": "str",
                                                                                                            "start_token": 3124,
                                                                                                            "end_token": 3126,
                                                                                                            "children": []
                                                                                                        }
                                                                                                    ]
                                                                                                },
                                                                                                {
                                                                                                    "type": "type",
                                                                                                    "label": "Any",
                                                                                                    "start_token": -1,
                                                                                                    "end_token": 3127,
                                                                                                    "children": [
                                                                                                        {
                                                                                                            "type": "identifier",
                                                                                                            "label": "Any",
                                                                                                            "start_token": -1,
                                                                                                            "end_token": 3127,
                                                                                                            "children": []
                                                                                                        }
                                                                                                    ]
                                                                                                }
                                                                                            ]
                                                                                        }
                                                                                    ]
                                                                                }
                                                                            ]
                                                                        },
                                                                        {
                                                                            "type": "type",
                                                                            "label": "None",
                                                                            "start_token": -1,
                                                                            "end_token": -1,
                                                                            "children": [
                                                                                {
                                                                                    "type": "none",
                                                                                    "label": "None",
                                                                                    "start_token": -1,
                                                                                    "end_token": -1,
                                                                                    "children": []
                                                                                }
                                                                            ]
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        },
                                                        {
                                                            "type": "none",
                                                            "label": "None",
                                                            "start_token": 3130,
                                                            "end_token": 3132,
                                                            "children": []
                                                        }
                                                    ]
                                                }
                                            ]
                                        },
                                        {
                                            "type": "block",
                                            "label": "try:\n            log_metadata.info(f\"Start node execution {node_exec.node_exec_id}\")\n            for execution in execute_node(\n                cls.db_client, cls.creds_manager, node_exec, stats\n            ):\n                q.add(execution)\n            log_metadata.info(f\"Finished node execution {node_exec.node_exec_id}\")\n        except Exception as e:\n            log_metadata.exception(\n                f\"Failed node execution {node_exec.node_exec_id}: {e}\"\n            )",
                                            "start_token": 3133,
                                            "end_token": -1,
                                            "children": [
                                                {
                                                    "type": "try_statement",
                                                    "label": "try:\n            log_metadata.info(f\"Start node execution {node_exec.node_exec_id}\")\n            for execution in execute_node(\n                cls.db_client, cls.creds_manager, node_exec, stats\n            ):\n                q.add(execution)\n            log_metadata.info(f\"Finished node execution {node_exec.node_exec_id}\")\n        except Exception as e:\n            log_metadata.exception(\n                f\"Failed node execution {node_exec.node_exec_id}: {e}\"\n            )",
                                                    "start_token": 3133,
                                                    "end_token": -1,
                                                    "children": [
                                                        {
                                                            "type": "block",
                                                            "label": "log_metadata.info(f\"Start node execution {node_exec.node_exec_id}\")\n            for execution in execute_node(\n                cls.db_client, cls.creds_manager, node_exec, stats\n            ):\n                q.add(execution)\n            log_metadata.info(f\"Finished node execution {node_exec.node_exec_id}\")",
                                                            "start_token": 3138,
                                                            "end_token": 3178,
                                                            "children": [
                                                                {
                                                                    "type": "expression_statement",
                                                                    "label": "log_metadata.info(f\"Start node execution {node_exec.node_exec_id}\")",
                                                                    "start_token": 3138,
                                                                    "end_token": 3142,
                                                                    "children": [
                                                                        {
                                                                            "type": "call",
                                                                            "label": "log_metadata.info(f\"Start node execution {node_exec.node_exec_id}\")",
                                                                            "start_token": 3138,
                                                                            "end_token": 3142,
                                                                            "children": [
                                                                                {
                                                                                    "type": "attribute",
                                                                                    "label": "log_metadata.info",
                                                                                    "start_token": 3138,
                                                                                    "end_token": 3138,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "label": "log_metadata",
                                                                                            "start_token": 3138,
                                                                                            "end_token": 3138,
                                                                                            "children": []
                                                                                        },
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "label": "info",
                                                                                            "start_token": 3138,
                                                                                            "end_token": 3138,
                                                                                            "children": []
                                                                                        }
                                                                                    ]
                                                                                },
                                                                                {
                                                                                    "type": "argument_list",
                                                                                    "label": "(f\"Start node execution {node_exec.node_exec_id}\")",
                                                                                    "start_token": 3138,
                                                                                    "end_token": 3142,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "string",
                                                                                            "label": "f\"Start node execution {node_exec.node_exec_id}\"",
                                                                                            "start_token": 3138,
                                                                                            "end_token": 3142,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "string_start",
                                                                                                    "label": "f\"",
                                                                                                    "start_token": 3138,
                                                                                                    "end_token": 3138,
                                                                                                    "children": []
                                                                                                },
                                                                                                {
                                                                                                    "type": "string_content",
                                                                                                    "label": "Start node execution ",
                                                                                                    "start_token": 3138,
                                                                                                    "end_token": 3138,
                                                                                                    "children": []
                                                                                                },
                                                                                                {
                                                                                                    "type": "interpolation",
                                                                                                    "label": "{node_exec.node_exec_id}",
                                                                                                    "start_token": 3138,
                                                                                                    "end_token": 3142,
                                                                                                    "children": [
                                                                                                        {
                                                                                                            "type": "attribute",
                                                                                                            "label": "node_exec.node_exec_id",
                                                                                                            "start_token": 3138,
                                                                                                            "end_token": 3142,
                                                                                                            "children": [
                                                                                                                {
                                                                                                                    "type": "identifier",
                                                                                                                    "label": "node_exec",
                                                                                                                    "start_token": 3138,
                                                                                                                    "end_token": -1,
                                                                                                                    "children": []
                                                                                                                },
                                                                                                                {
                                                                                                                    "type": "identifier",
                                                                                                                    "label": "node_exec_id",
                                                                                                                    "start_token": -1,
                                                                                                                    "end_token": 3142,
                                                                                                                    "children": []
                                                                                                                }
                                                                                                            ]
                                                                                                        }
                                                                                                    ]
                                                                                                },
                                                                                                {
                                                                                                    "type": "string_end",
                                                                                                    "label": "\"",
                                                                                                    "start_token": 3142,
                                                                                                    "end_token": 3142,
                                                                                                    "children": []
                                                                                                }
                                                                                            ]
                                                                                        }
                                                                                    ]
                                                                                }
                                                                            ]
                                                                        }
                                                                    ]
                                                                },
                                                                {
                                                                    "type": "for_statement",
                                                                    "label": "for execution in execute_node(\n                cls.db_client, cls.creds_manager, node_exec, stats\n            ):\n                q.add(execution)",
                                                                    "start_token": 3144,
                                                                    "end_token": 3169,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "execution",
                                                                            "start_token": 3144,
                                                                            "end_token": -1,
                                                                            "children": []
                                                                        },
                                                                        {
                                                                            "type": "call",
                                                                            "label": "execute_node(\n                cls.db_client, cls.creds_manager, node_exec, stats\n            )",
                                                                            "start_token": -1,
                                                                            "end_token": 3164,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "execute_node",
                                                                                    "start_token": -1,
                                                                                    "end_token": 3148,
                                                                                    "children": []
                                                                                },
                                                                                {
                                                                                    "type": "argument_list",
                                                                                    "label": "(\n                cls.db_client, cls.creds_manager, node_exec, stats\n            )",
                                                                                    "start_token": 3149,
                                                                                    "end_token": 3164,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "attribute",
                                                                                            "label": "cls.db_client",
                                                                                            "start_token": 3153,
                                                                                            "end_token": 3155,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "label": "cls",
                                                                                                    "start_token": 3153,
                                                                                                    "end_token": 3153,
                                                                                                    "children": []
                                                                                                },
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "label": "db_client",
                                                                                                    "start_token": 3153,
                                                                                                    "end_token": 3155,
                                                                                                    "children": []
                                                                                                }
                                                                                            ]
                                                                                        },
                                                                                        {
                                                                                            "type": "attribute",
                                                                                            "label": "cls.creds_manager",
                                                                                            "start_token": 3155,
                                                                                            "end_token": -1,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "label": "cls",
                                                                                                    "start_token": 3155,
                                                                                                    "end_token": 3155,
                                                                                                    "children": []
                                                                                                },
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "label": "creds_manager",
                                                                                                    "start_token": 3155,
                                                                                                    "end_token": -1,
                                                                                                    "children": []
                                                                                                }
                                                                                            ]
                                                                                        },
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "label": "node_exec",
                                                                                            "start_token": -1,
                                                                                            "end_token": 3160,
                                                                                            "children": []
                                                                                        },
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "label": "stats",
                                                                                            "start_token": -1,
                                                                                            "end_token": -1,
                                                                                            "children": []
                                                                                        }
                                                                                    ]
                                                                                }
                                                                            ]
                                                                        },
                                                                        {
                                                                            "type": "block",
                                                                            "label": "q.add(execution)",
                                                                            "start_token": -1,
                                                                            "end_token": 3169,
                                                                            "children": [
                                                                                {
                                                                                    "type": "expression_statement",
                                                                                    "label": "q.add(execution)",
                                                                                    "start_token": -1,
                                                                                    "end_token": 3169,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "call",
                                                                                            "label": "q.add(execution)",
                                                                                            "start_token": -1,
                                                                                            "end_token": 3169,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "attribute",
                                                                                                    "label": "q.add",
                                                                                                    "start_token": -1,
                                                                                                    "end_token": -1,
                                                                                                    "children": [
                                                                                                        {
                                                                                                            "type": "identifier",
                                                                                                            "label": "q",
                                                                                                            "start_token": -1,
                                                                                                            "end_token": -1,
                                                                                                            "children": []
                                                                                                        },
                                                                                                        {
                                                                                                            "type": "identifier",
                                                                                                            "label": "add",
                                                                                                            "start_token": -1,
                                                                                                            "end_token": -1,
                                                                                                            "children": []
                                                                                                        }
                                                                                                    ]
                                                                                                },
                                                                                                {
                                                                                                    "type": "argument_list",
                                                                                                    "label": "(execution)",
                                                                                                    "start_token": -1,
                                                                                                    "end_token": 3169,
                                                                                                    "children": [
                                                                                                        {
                                                                                                            "type": "identifier",
                                                                                                            "label": "execution",
                                                                                                            "start_token": -1,
                                                                                                            "end_token": 3169,
                                                                                                            "children": []
                                                                                                        }
                                                                                                    ]
                                                                                                }
                                                                                            ]
                                                                                        }
                                                                                    ]
                                                                                }
                                                                            ]
                                                                        }
                                                                    ]
                                                                },
                                                                {
                                                                    "type": "expression_statement",
                                                                    "label": "log_metadata.info(f\"Finished node execution {node_exec.node_exec_id}\")",
                                                                    "start_token": 3174,
                                                                    "end_token": 3178,
                                                                    "children": [
                                                                        {
                                                                            "type": "call",
                                                                            "label": "log_metadata.info(f\"Finished node execution {node_exec.node_exec_id}\")",
                                                                            "start_token": 3174,
                                                                            "end_token": 3178,
                                                                            "children": [
                                                                                {
                                                                                    "type": "attribute",
                                                                                    "label": "log_metadata.info",
                                                                                    "start_token": 3174,
                                                                                    "end_token": 3174,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "label": "log_metadata",
                                                                                            "start_token": 3174,
                                                                                            "end_token": 3174,
                                                                                            "children": []
                                                                                        },
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "label": "info",
                                                                                            "start_token": 3174,
                                                                                            "end_token": 3174,
                                                                                            "children": []
                                                                                        }
                                                                                    ]
                                                                                },
                                                                                {
                                                                                    "type": "argument_list",
                                                                                    "label": "(f\"Finished node execution {node_exec.node_exec_id}\")",
                                                                                    "start_token": 3174,
                                                                                    "end_token": 3178,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "string",
                                                                                            "label": "f\"Finished node execution {node_exec.node_exec_id}\"",
                                                                                            "start_token": 3174,
                                                                                            "end_token": 3178,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "string_start",
                                                                                                    "label": "f\"",
                                                                                                    "start_token": 3174,
                                                                                                    "end_token": 3174,
                                                                                                    "children": []
                                                                                                },
                                                                                                {
                                                                                                    "type": "string_content",
                                                                                                    "label": "Finished node execution ",
                                                                                                    "start_token": 3174,
                                                                                                    "end_token": 3174,
                                                                                                    "children": []
                                                                                                },
                                                                                                {
                                                                                                    "type": "interpolation",
                                                                                                    "label": "{node_exec.node_exec_id}",
                                                                                                    "start_token": 3174,
                                                                                                    "end_token": 3178,
                                                                                                    "children": [
                                                                                                        {
                                                                                                            "type": "attribute",
                                                                                                            "label": "node_exec.node_exec_id",
                                                                                                            "start_token": 3174,
                                                                                                            "end_token": 3178,
                                                                                                            "children": [
                                                                                                                {
                                                                                                                    "type": "identifier",
                                                                                                                    "label": "node_exec",
                                                                                                                    "start_token": 3174,
                                                                                                                    "end_token": -1,
                                                                                                                    "children": []
                                                                                                                },
                                                                                                                {
                                                                                                                    "type": "identifier",
                                                                                                                    "label": "node_exec_id",
                                                                                                                    "start_token": -1,
                                                                                                                    "end_token": 3178,
                                                                                                                    "children": []
                                                                                                                }
                                                                                                            ]
                                                                                                        }
                                                                                                    ]
                                                                                                },
                                                                                                {
                                                                                                    "type": "string_end",
                                                                                                    "label": "\"",
                                                                                                    "start_token": 3178,
                                                                                                    "end_token": 3178,
                                                                                                    "children": []
                                                                                                }
                                                                                            ]
                                                                                        }
                                                                                    ]
                                                                                }
                                                                            ]
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        },
                                                        {
                                                            "type": "except_clause",
                                                            "label": "except Exception as e:\n            log_metadata.exception(\n                f\"Failed node execution {node_exec.node_exec_id}: {e}\"\n            )",
                                                            "start_token": 3182,
                                                            "end_token": -1,
                                                            "children": [
                                                                {
                                                                    "type": "as_pattern",
                                                                    "label": "Exception as e",
                                                                    "start_token": -1,
                                                                    "end_token": 3183,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "Exception",
                                                                            "start_token": -1,
                                                                            "end_token": 3183,
                                                                            "children": []
                                                                        },
                                                                        {
                                                                            "type": "as_pattern_target",
                                                                            "label": "e",
                                                                            "start_token": 3183,
                                                                            "end_token": 3183,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "e",
                                                                                    "start_token": 3183,
                                                                                    "end_token": 3183,
                                                                                    "children": []
                                                                                }
                                                                            ]
                                                                        }
                                                                    ]
                                                                },
                                                                {
                                                                    "type": "block",
                                                                    "label": "log_metadata.exception(\n                f\"Failed node execution {node_exec.node_exec_id}: {e}\"\n            )",
                                                                    "start_token": 3186,
                                                                    "end_token": -1,
                                                                    "children": [
                                                                        {
                                                                            "type": "expression_statement",
                                                                            "label": "log_metadata.exception(\n                f\"Failed node execution {node_exec.node_exec_id}: {e}\"\n            )",
                                                                            "start_token": 3186,
                                                                            "end_token": -1,
                                                                            "children": [
                                                                                {
                                                                                    "type": "call",
                                                                                    "label": "log_metadata.exception(\n                f\"Failed node execution {node_exec.node_exec_id}: {e}\"\n            )",
                                                                                    "start_token": 3186,
                                                                                    "end_token": -1,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "attribute",
                                                                                            "label": "log_metadata.exception",
                                                                                            "start_token": 3186,
                                                                                            "end_token": 3189,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "label": "log_metadata",
                                                                                                    "start_token": 3186,
                                                                                                    "end_token": -1,
                                                                                                    "children": []
                                                                                                },
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "label": "exception",
                                                                                                    "start_token": -1,
                                                                                                    "end_token": 3189,
                                                                                                    "children": []
                                                                                                }
                                                                                            ]
                                                                                        },
                                                                                        {
                                                                                            "type": "argument_list",
                                                                                            "label": "(\n                f\"Failed node execution {node_exec.node_exec_id}: {e}\"\n            )",
                                                                                            "start_token": 3189,
                                                                                            "end_token": -1,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "string",
                                                                                                    "label": "f\"Failed node execution {node_exec.node_exec_id}: {e}\"",
                                                                                                    "start_token": 3189,
                                                                                                    "end_token": 3195,
                                                                                                    "children": [
                                                                                                        {
                                                                                                            "type": "string_start",
                                                                                                            "label": "f\"",
                                                                                                            "start_token": 3189,
                                                                                                            "end_token": 3189,
                                                                                                            "children": []
                                                                                                        },
                                                                                                        {
                                                                                                            "type": "string_content",
                                                                                                            "label": "Failed node execution ",
                                                                                                            "start_token": 3189,
                                                                                                            "end_token": 3189,
                                                                                                            "children": []
                                                                                                        },
                                                                                                        {
                                                                                                            "type": "interpolation",
                                                                                                            "label": "{node_exec.node_exec_id}",
                                                                                                            "start_token": 3189,
                                                                                                            "end_token": 3193,
                                                                                                            "children": [
                                                                                                                {
                                                                                                                    "type": "attribute",
                                                                                                                    "label": "node_exec.node_exec_id",
                                                                                                                    "start_token": 3189,
                                                                                                                    "end_token": 3192,
                                                                                                                    "children": [
                                                                                                                        {
                                                                                                                            "type": "identifier",
                                                                                                                            "label": "node_exec",
                                                                                                                            "start_token": 3189,
                                                                                                                            "end_token": -1,
                                                                                                                            "children": []
                                                                                                                        },
                                                                                                                        {
                                                                                                                            "type": "identifier",
                                                                                                                            "label": "node_exec_id",
                                                                                                                            "start_token": -1,
                                                                                                                            "end_token": 3192,
                                                                                                                            "children": []
                                                                                                                        }
                                                                                                                    ]
                                                                                                                }
                                                                                                            ]
                                                                                                        },
                                                                                                        {
                                                                                                            "type": "string_content",
                                                                                                            "label": ": ",
                                                                                                            "start_token": -1,
                                                                                                            "end_token": -1,
                                                                                                            "children": []
                                                                                                        },
                                                                                                        {
                                                                                                            "type": "interpolation",
                                                                                                            "label": "{e}",
                                                                                                            "start_token": -1,
                                                                                                            "end_token": 3194,
                                                                                                            "children": [
                                                                                                                {
                                                                                                                    "type": "identifier",
                                                                                                                    "label": "e",
                                                                                                                    "start_token": -1,
                                                                                                                    "end_token": -1,
                                                                                                                    "children": []
                                                                                                                }
                                                                                                            ]
                                                                                                        },
                                                                                                        {
                                                                                                            "type": "string_end",
                                                                                                            "label": "\"",
                                                                                                            "start_token": 3195,
                                                                                                            "end_token": 3195,
                                                                                                            "children": []
                                                                                                        }
                                                                                                    ]
                                                                                                }
                                                                                            ]
                                                                                        }
                                                                                    ]
                                                                                }
                                                                            ]
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                }
                                            ]
                                        }
                                    ]
                                }
                            ]
                        },
                        {
                            "type": "decorated_definition",
                            "label": "@classmethod\n    def on_graph_executor_start(cls):\n        configure_logging()\n        set_service_name(\"GraphExecutor\")\n\n        cls.db_client = get_db_client()\n        cls.pool_size = settings.config.num_node_workers\n        cls.pid = os.getpid()\n        cls._init_node_executor_pool()\n        logger.info(\n            f\"Graph executor {cls.pid} started with {cls.pool_size} node workers\"\n        )\n\n        # Set up shutdown handler\n        atexit.register(cls.on_graph_executor_stop)",
                            "start_token": 3198,
                            "end_token": -1,
                            "children": [
                                {
                                    "type": "decorator",
                                    "label": "@classmethod",
                                    "start_token": 3198,
                                    "end_token": 3198,
                                    "children": [
                                        {
                                            "type": "identifier",
                                            "label": "classmethod",
                                            "start_token": 3198,
                                            "end_token": 3198,
                                            "children": []
                                        }
                                    ]
                                },
                                {
                                    "type": "function_definition",
                                    "label": "def on_graph_executor_start(cls):\n        configure_logging()\n        set_service_name(\"GraphExecutor\")\n\n        cls.db_client = get_db_client()\n        cls.pool_size = settings.config.num_node_workers\n        cls.pid = os.getpid()\n        cls._init_node_executor_pool()\n        logger.info(\n            f\"Graph executor {cls.pid} started with {cls.pool_size} node workers\"\n        )\n\n        # Set up shutdown handler\n        atexit.register(cls.on_graph_executor_stop)",
                                    "start_token": 3198,
                                    "end_token": -1,
                                    "children": [
                                        {
                                            "type": "identifier",
                                            "label": "on_graph_executor_start",
                                            "start_token": 3198,
                                            "end_token": 3204,
                                            "children": []
                                        },
                                        {
                                            "type": "parameters",
                                            "label": "(cls)",
                                            "start_token": 3204,
                                            "end_token": 3204,
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "label": "cls",
                                                    "start_token": 3204,
                                                    "end_token": 3204,
                                                    "children": []
                                                }
                                            ]
                                        },
                                        {
                                            "type": "block",
                                            "label": "configure_logging()\n        set_service_name(\"GraphExecutor\")\n\n        cls.db_client = get_db_client()\n        cls.pool_size = settings.config.num_node_workers\n        cls.pid = os.getpid()\n        cls._init_node_executor_pool()\n        logger.info(\n            f\"Graph executor {cls.pid} started with {cls.pool_size} node workers\"\n        )\n\n        # Set up shutdown handler\n        atexit.register(cls.on_graph_executor_stop)",
                                            "start_token": -1,
                                            "end_token": -1,
                                            "children": [
                                                {
                                                    "type": "expression_statement",
                                                    "label": "configure_logging()",
                                                    "start_token": -1,
                                                    "end_token": 3208,
                                                    "children": [
                                                        {
                                                            "type": "call",
                                                            "label": "configure_logging()",
                                                            "start_token": -1,
                                                            "end_token": 3208,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "label": "configure_logging",
                                                                    "start_token": -1,
                                                                    "end_token": 3208,
                                                                    "children": []
                                                                },
                                                                {
                                                                    "type": "argument_list",
                                                                    "label": "()",
                                                                    "start_token": 3208,
                                                                    "end_token": 3208,
                                                                    "children": []
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                },
                                                {
                                                    "type": "expression_statement",
                                                    "label": "set_service_name(\"GraphExecutor\")",
                                                    "start_token": 3210,
                                                    "end_token": 3216,
                                                    "children": [
                                                        {
                                                            "type": "call",
                                                            "label": "set_service_name(\"GraphExecutor\")",
                                                            "start_token": 3210,
                                                            "end_token": 3216,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "label": "set_service_name",
                                                                    "start_token": 3210,
                                                                    "end_token": -1,
                                                                    "children": []
                                                                },
                                                                {
                                                                    "type": "argument_list",
                                                                    "label": "(\"GraphExecutor\")",
                                                                    "start_token": -1,
                                                                    "end_token": 3216,
                                                                    "children": [
                                                                        {
                                                                            "type": "string",
                                                                            "label": "\"GraphExecutor\"",
                                                                            "start_token": -1,
                                                                            "end_token": 3216,
                                                                            "children": [
                                                                                {
                                                                                    "type": "string_start",
                                                                                    "label": "\"",
                                                                                    "start_token": -1,
                                                                                    "end_token": -1,
                                                                                    "children": []
                                                                                },
                                                                                {
                                                                                    "type": "string_content",
                                                                                    "label": "GraphExecutor",
                                                                                    "start_token": -1,
                                                                                    "end_token": 3216,
                                                                                    "children": []
                                                                                },
                                                                                {
                                                                                    "type": "string_end",
                                                                                    "label": "\"",
                                                                                    "start_token": 3216,
                                                                                    "end_token": 3216,
                                                                                    "children": []
                                                                                }
                                                                            ]
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                },
                                                {
                                                    "type": "expression_statement",
                                                    "label": "cls.db_client = get_db_client()",
                                                    "start_token": 3218,
                                                    "end_token": 3224,
                                                    "children": [
                                                        {
                                                            "type": "assignment",
                                                            "label": "cls.db_client = get_db_client()",
                                                            "start_token": 3218,
                                                            "end_token": 3224,
                                                            "children": [
                                                                {
                                                                    "type": "attribute",
                                                                    "label": "cls.db_client",
                                                                    "start_token": 3218,
                                                                    "end_token": -1,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "cls",
                                                                            "start_token": 3218,
                                                                            "end_token": 3218,
                                                                            "children": []
                                                                        },
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "db_client",
                                                                            "start_token": 3218,
                                                                            "end_token": -1,
                                                                            "children": []
                                                                        }
                                                                    ]
                                                                },
                                                                {
                                                                    "type": "call",
                                                                    "label": "get_db_client()",
                                                                    "start_token": -1,
                                                                    "end_token": 3224,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "get_db_client",
                                                                            "start_token": -1,
                                                                            "end_token": 3224,
                                                                            "children": []
                                                                        },
                                                                        {
                                                                            "type": "argument_list",
                                                                            "label": "()",
                                                                            "start_token": 3224,
                                                                            "end_token": 3224,
                                                                            "children": []
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                },
                                                {
                                                    "type": "expression_statement",
                                                    "label": "cls.pool_size = settings.config.num_node_workers",
                                                    "start_token": 3226,
                                                    "end_token": 3237,
                                                    "children": [
                                                        {
                                                            "type": "assignment",
                                                            "label": "cls.pool_size = settings.config.num_node_workers",
                                                            "start_token": 3226,
                                                            "end_token": 3237,
                                                            "children": [
                                                                {
                                                                    "type": "attribute",
                                                                    "label": "cls.pool_size",
                                                                    "start_token": 3226,
                                                                    "end_token": 3230,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "cls",
                                                                            "start_token": 3226,
                                                                            "end_token": 3227,
                                                                            "children": []
                                                                        },
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "pool_size",
                                                                            "start_token": 3228,
                                                                            "end_token": 3230,
                                                                            "children": []
                                                                        }
                                                                    ]
                                                                },
                                                                {
                                                                    "type": "attribute",
                                                                    "label": "settings.config.num_node_workers",
                                                                    "start_token": 3230,
                                                                    "end_token": 3237,
                                                                    "children": [
                                                                        {
                                                                            "type": "attribute",
                                                                            "label": "settings.config",
                                                                            "start_token": 3230,
                                                                            "end_token": -1,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "settings",
                                                                                    "start_token": 3230,
                                                                                    "end_token": 3230,
                                                                                    "children": []
                                                                                },
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "config",
                                                                                    "start_token": 3230,
                                                                                    "end_token": -1,
                                                                                    "children": []
                                                                                }
                                                                            ]
                                                                        },
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "num_node_workers",
                                                                            "start_token": -1,
                                                                            "end_token": 3237,
                                                                            "children": []
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                },
                                                {
                                                    "type": "expression_statement",
                                                    "label": "cls.pid = os.getpid()",
                                                    "start_token": -1,
                                                    "end_token": 3244,
                                                    "children": [
                                                        {
                                                            "type": "assignment",
                                                            "label": "cls.pid = os.getpid()",
                                                            "start_token": -1,
                                                            "end_token": 3244,
                                                            "children": [
                                                                {
                                                                    "type": "attribute",
                                                                    "label": "cls.pid",
                                                                    "start_token": -1,
                                                                    "end_token": -1,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "cls",
                                                                            "start_token": -1,
                                                                            "end_token": -1,
                                                                            "children": []
                                                                        },
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "pid",
                                                                            "start_token": -1,
                                                                            "end_token": -1,
                                                                            "children": []
                                                                        }
                                                                    ]
                                                                },
                                                                {
                                                                    "type": "call",
                                                                    "label": "os.getpid()",
                                                                    "start_token": 3242,
                                                                    "end_token": 3244,
                                                                    "children": [
                                                                        {
                                                                            "type": "attribute",
                                                                            "label": "os.getpid",
                                                                            "start_token": 3242,
                                                                            "end_token": 3244,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "os",
                                                                                    "start_token": 3242,
                                                                                    "end_token": 3243,
                                                                                    "children": []
                                                                                },
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "getpid",
                                                                                    "start_token": 3244,
                                                                                    "end_token": 3244,
                                                                                    "children": []
                                                                                }
                                                                            ]
                                                                        },
                                                                        {
                                                                            "type": "argument_list",
                                                                            "label": "()",
                                                                            "start_token": 3244,
                                                                            "end_token": 3244,
                                                                            "children": []
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                },
                                                {
                                                    "type": "expression_statement",
                                                    "label": "cls._init_node_executor_pool()",
                                                    "start_token": 3244,
                                                    "end_token": 3252,
                                                    "children": [
                                                        {
                                                            "type": "call",
                                                            "label": "cls._init_node_executor_pool()",
                                                            "start_token": 3244,
                                                            "end_token": 3252,
                                                            "children": [
                                                                {
                                                                    "type": "attribute",
                                                                    "label": "cls._init_node_executor_pool",
                                                                    "start_token": 3244,
                                                                    "end_token": 3250,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "cls",
                                                                            "start_token": 3244,
                                                                            "end_token": 3244,
                                                                            "children": []
                                                                        },
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "_init_node_executor_pool",
                                                                            "start_token": 3244,
                                                                            "end_token": 3250,
                                                                            "children": []
                                                                        }
                                                                    ]
                                                                },
                                                                {
                                                                    "type": "argument_list",
                                                                    "label": "()",
                                                                    "start_token": 3251,
                                                                    "end_token": 3252,
                                                                    "children": []
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                },
                                                {
                                                    "type": "expression_statement",
                                                    "label": "logger.info(\n            f\"Graph executor {cls.pid} started with {cls.pool_size} node workers\"\n        )",
                                                    "start_token": -1,
                                                    "end_token": 3262,
                                                    "children": [
                                                        {
                                                            "type": "call",
                                                            "label": "logger.info(\n            f\"Graph executor {cls.pid} started with {cls.pool_size} node workers\"\n        )",
                                                            "start_token": -1,
                                                            "end_token": 3262,
                                                            "children": [
                                                                {
                                                                    "type": "attribute",
                                                                    "label": "logger.info",
                                                                    "start_token": -1,
                                                                    "end_token": 3254,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "logger",
                                                                            "start_token": -1,
                                                                            "end_token": 3254,
                                                                            "children": []
                                                                        },
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "info",
                                                                            "start_token": 3254,
                                                                            "end_token": 3254,
                                                                            "children": []
                                                                        }
                                                                    ]
                                                                },
                                                                {
                                                                    "type": "argument_list",
                                                                    "label": "(\n            f\"Graph executor {cls.pid} started with {cls.pool_size} node workers\"\n        )",
                                                                    "start_token": 3254,
                                                                    "end_token": 3262,
                                                                    "children": [
                                                                        {
                                                                            "type": "string",
                                                                            "label": "f\"Graph executor {cls.pid} started with {cls.pool_size} node workers\"",
                                                                            "start_token": 3254,
                                                                            "end_token": -1,
                                                                            "children": [
                                                                                {
                                                                                    "type": "string_start",
                                                                                    "label": "f\"",
                                                                                    "start_token": 3254,
                                                                                    "end_token": 3254,
                                                                                    "children": []
                                                                                },
                                                                                {
                                                                                    "type": "string_content",
                                                                                    "label": "Graph executor ",
                                                                                    "start_token": 3254,
                                                                                    "end_token": 3254,
                                                                                    "children": []
                                                                                },
                                                                                {
                                                                                    "type": "interpolation",
                                                                                    "label": "{cls.pid}",
                                                                                    "start_token": 3254,
                                                                                    "end_token": 3254,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "attribute",
                                                                                            "label": "cls.pid",
                                                                                            "start_token": 3254,
                                                                                            "end_token": 3254,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "label": "cls",
                                                                                                    "start_token": 3254,
                                                                                                    "end_token": 3254,
                                                                                                    "children": []
                                                                                                },
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "label": "pid",
                                                                                                    "start_token": 3254,
                                                                                                    "end_token": 3254,
                                                                                                    "children": []
                                                                                                }
                                                                                            ]
                                                                                        }
                                                                                    ]
                                                                                },
                                                                                {
                                                                                    "type": "string_content",
                                                                                    "label": " started with ",
                                                                                    "start_token": 3254,
                                                                                    "end_token": 3254,
                                                                                    "children": []
                                                                                },
                                                                                {
                                                                                    "type": "interpolation",
                                                                                    "label": "{cls.pool_size}",
                                                                                    "start_token": 3254,
                                                                                    "end_token": -1,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "attribute",
                                                                                            "label": "cls.pool_size",
                                                                                            "start_token": 3254,
                                                                                            "end_token": -1,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "label": "cls",
                                                                                                    "start_token": 3254,
                                                                                                    "end_token": 3254,
                                                                                                    "children": []
                                                                                                },
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "label": "pool_size",
                                                                                                    "start_token": 3254,
                                                                                                    "end_token": -1,
                                                                                                    "children": []
                                                                                                }
                                                                                            ]
                                                                                        }
                                                                                    ]
                                                                                },
                                                                                {
                                                                                    "type": "string_content",
                                                                                    "label": " node workers",
                                                                                    "start_token": -1,
                                                                                    "end_token": 3259,
                                                                                    "children": []
                                                                                },
                                                                                {
                                                                                    "type": "string_end",
                                                                                    "label": "\"",
                                                                                    "start_token": -1,
                                                                                    "end_token": -1,
                                                                                    "children": []
                                                                                }
                                                                            ]
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                },
                                                {
                                                    "type": "comment",
                                                    "label": "# Set up shutdown handler",
                                                    "start_token": 3263,
                                                    "end_token": 3267,
                                                    "children": []
                                                },
                                                {
                                                    "type": "expression_statement",
                                                    "label": "atexit.register(cls.on_graph_executor_stop)",
                                                    "start_token": 3271,
                                                    "end_token": -1,
                                                    "children": [
                                                        {
                                                            "type": "call",
                                                            "label": "atexit.register(cls.on_graph_executor_stop)",
                                                            "start_token": 3271,
                                                            "end_token": -1,
                                                            "children": [
                                                                {
                                                                    "type": "attribute",
                                                                    "label": "atexit.register",
                                                                    "start_token": 3271,
                                                                    "end_token": 3271,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "atexit",
                                                                            "start_token": 3271,
                                                                            "end_token": 3271,
                                                                            "children": []
                                                                        },
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "register",
                                                                            "start_token": 3271,
                                                                            "end_token": 3271,
                                                                            "children": []
                                                                        }
                                                                    ]
                                                                },
                                                                {
                                                                    "type": "argument_list",
                                                                    "label": "(cls.on_graph_executor_stop)",
                                                                    "start_token": 3271,
                                                                    "end_token": -1,
                                                                    "children": [
                                                                        {
                                                                            "type": "attribute",
                                                                            "label": "cls.on_graph_executor_stop",
                                                                            "start_token": 3271,
                                                                            "end_token": -1,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "cls",
                                                                                    "start_token": 3271,
                                                                                    "end_token": 3271,
                                                                                    "children": []
                                                                                },
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "on_graph_executor_stop",
                                                                                    "start_token": 3272,
                                                                                    "end_token": -1,
                                                                                    "children": []
                                                                                }
                                                                            ]
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                }
                                            ]
                                        }
                                    ]
                                }
                            ]
                        },
                        {
                            "type": "decorated_definition",
                            "label": "@classmethod\n    def on_graph_executor_stop(cls):\n        prefix = f\"[on_graph_executor_stop {cls.pid}]\"\n        logger.info(f\"{prefix} ⏳ Terminating node executor pool...\")\n        cls.executor.terminate()\n        logger.info(f\"{prefix} ⏳ Disconnecting DB manager...\")\n        close_service_client(cls.db_client)\n        logger.info(f\"{prefix} ✅ Finished cleanup\")",
                            "start_token": 3279,
                            "end_token": 3334,
                            "children": [
                                {
                                    "type": "decorator",
                                    "label": "@classmethod",
                                    "start_token": 3279,
                                    "end_token": 3279,
                                    "children": [
                                        {
                                            "type": "identifier",
                                            "label": "classmethod",
                                            "start_token": 3279,
                                            "end_token": 3279,
                                            "children": []
                                        }
                                    ]
                                },
                                {
                                    "type": "function_definition",
                                    "label": "def on_graph_executor_stop(cls):\n        prefix = f\"[on_graph_executor_stop {cls.pid}]\"\n        logger.info(f\"{prefix} ⏳ Terminating node executor pool...\")\n        cls.executor.terminate()\n        logger.info(f\"{prefix} ⏳ Disconnecting DB manager...\")\n        close_service_client(cls.db_client)\n        logger.info(f\"{prefix} ✅ Finished cleanup\")",
                                    "start_token": 3279,
                                    "end_token": 3334,
                                    "children": [
                                        {
                                            "type": "identifier",
                                            "label": "on_graph_executor_stop",
                                            "start_token": 3280,
                                            "end_token": -1,
                                            "children": []
                                        },
                                        {
                                            "type": "parameters",
                                            "label": "(cls)",
                                            "start_token": 3286,
                                            "end_token": 3288,
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "label": "cls",
                                                    "start_token": -1,
                                                    "end_token": 3288,
                                                    "children": []
                                                }
                                            ]
                                        },
                                        {
                                            "type": "block",
                                            "label": "prefix = f\"[on_graph_executor_stop {cls.pid}]\"\n        logger.info(f\"{prefix} ⏳ Terminating node executor pool...\")\n        cls.executor.terminate()\n        logger.info(f\"{prefix} ⏳ Disconnecting DB manager...\")\n        close_service_client(cls.db_client)\n        logger.info(f\"{prefix} ✅ Finished cleanup\")",
                                            "start_token": 3288,
                                            "end_token": 3334,
                                            "children": [
                                                {
                                                    "type": "expression_statement",
                                                    "label": "prefix = f\"[on_graph_executor_stop {cls.pid}]\"",
                                                    "start_token": 3288,
                                                    "end_token": 3294,
                                                    "children": [
                                                        {
                                                            "type": "assignment",
                                                            "label": "prefix = f\"[on_graph_executor_stop {cls.pid}]\"",
                                                            "start_token": 3288,
                                                            "end_token": 3294,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "label": "prefix",
                                                                    "start_token": 3288,
                                                                    "end_token": 3288,
                                                                    "children": []
                                                                },
                                                                {
                                                                    "type": "string",
                                                                    "label": "f\"[on_graph_executor_stop {cls.pid}]\"",
                                                                    "start_token": 3288,
                                                                    "end_token": 3294,
                                                                    "children": [
                                                                        {
                                                                            "type": "string_start",
                                                                            "label": "f\"",
                                                                            "start_token": 3288,
                                                                            "end_token": 3288,
                                                                            "children": []
                                                                        },
                                                                        {
                                                                            "type": "string_content",
                                                                            "label": "[on_graph_executor_stop ",
                                                                            "start_token": 3288,
                                                                            "end_token": 3290,
                                                                            "children": []
                                                                        },
                                                                        {
                                                                            "type": "interpolation",
                                                                            "label": "{cls.pid}",
                                                                            "start_token": 3290,
                                                                            "end_token": 3292,
                                                                            "children": [
                                                                                {
                                                                                    "type": "attribute",
                                                                                    "label": "cls.pid",
                                                                                    "start_token": 3290,
                                                                                    "end_token": 3292,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "label": "cls",
                                                                                            "start_token": 3290,
                                                                                            "end_token": 3290,
                                                                                            "children": []
                                                                                        },
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "label": "pid",
                                                                                            "start_token": 3292,
                                                                                            "end_token": 3292,
                                                                                            "children": []
                                                                                        }
                                                                                    ]
                                                                                }
                                                                            ]
                                                                        },
                                                                        {
                                                                            "type": "string_content",
                                                                            "label": "]",
                                                                            "start_token": 3293,
                                                                            "end_token": 3293,
                                                                            "children": []
                                                                        },
                                                                        {
                                                                            "type": "string_end",
                                                                            "label": "\"",
                                                                            "start_token": 3294,
                                                                            "end_token": 3294,
                                                                            "children": []
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                },
                                                {
                                                    "type": "expression_statement",
                                                    "label": "logger.info(f\"{prefix} ⏳ Terminating node executor pool...\")",
                                                    "start_token": 3295,
                                                    "end_token": 3302,
                                                    "children": [
                                                        {
                                                            "type": "call",
                                                            "label": "logger.info(f\"{prefix} ⏳ Terminating node executor pool...\")",
                                                            "start_token": 3295,
                                                            "end_token": 3302,
                                                            "children": [
                                                                {
                                                                    "type": "attribute",
                                                                    "label": "logger.info",
                                                                    "start_token": 3295,
                                                                    "end_token": 3295,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "logger",
                                                                            "start_token": 3295,
                                                                            "end_token": 3295,
                                                                            "children": []
                                                                        },
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "info",
                                                                            "start_token": 3295,
                                                                            "end_token": 3295,
                                                                            "children": []
                                                                        }
                                                                    ]
                                                                },
                                                                {
                                                                    "type": "argument_list",
                                                                    "label": "(f\"{prefix} ⏳ Terminating node executor pool...\")",
                                                                    "start_token": 3295,
                                                                    "end_token": 3302,
                                                                    "children": [
                                                                        {
                                                                            "type": "string",
                                                                            "label": "f\"{prefix} ⏳ Terminating node executor pool...\"",
                                                                            "start_token": 3295,
                                                                            "end_token": 3302,
                                                                            "children": [
                                                                                {
                                                                                    "type": "string_start",
                                                                                    "label": "f\"",
                                                                                    "start_token": 3295,
                                                                                    "end_token": 3295,
                                                                                    "children": []
                                                                                },
                                                                                {
                                                                                    "type": "interpolation",
                                                                                    "label": "{prefix}",
                                                                                    "start_token": 3295,
                                                                                    "end_token": 3295,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "label": "prefix",
                                                                                            "start_token": 3295,
                                                                                            "end_token": 3295,
                                                                                            "children": []
                                                                                        }
                                                                                    ]
                                                                                },
                                                                                {
                                                                                    "type": "string_content",
                                                                                    "label": " ⏳ Terminating node executor pool...",
                                                                                    "start_token": 3295,
                                                                                    "end_token": 3301,
                                                                                    "children": []
                                                                                },
                                                                                {
                                                                                    "type": "string_end",
                                                                                    "label": "\"",
                                                                                    "start_token": 3302,
                                                                                    "end_token": 3302,
                                                                                    "children": []
                                                                                }
                                                                            ]
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                },
                                                {
                                                    "type": "expression_statement",
                                                    "label": "cls.executor.terminate()",
                                                    "start_token": 3305,
                                                    "end_token": 3311,
                                                    "children": [
                                                        {
                                                            "type": "call",
                                                            "label": "cls.executor.terminate()",
                                                            "start_token": 3305,
                                                            "end_token": 3311,
                                                            "children": [
                                                                {
                                                                    "type": "attribute",
                                                                    "label": "cls.executor.terminate",
                                                                    "start_token": 3305,
                                                                    "end_token": 3310,
                                                                    "children": [
                                                                        {
                                                                            "type": "attribute",
                                                                            "label": "cls.executor",
                                                                            "start_token": 3305,
                                                                            "end_token": 3306,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "cls",
                                                                                    "start_token": 3305,
                                                                                    "end_token": -1,
                                                                                    "children": []
                                                                                },
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "executor",
                                                                                    "start_token": -1,
                                                                                    "end_token": 3306,
                                                                                    "children": []
                                                                                }
                                                                            ]
                                                                        },
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "terminate",
                                                                            "start_token": 3306,
                                                                            "end_token": 3310,
                                                                            "children": []
                                                                        }
                                                                    ]
                                                                },
                                                                {
                                                                    "type": "argument_list",
                                                                    "label": "()",
                                                                    "start_token": 3311,
                                                                    "end_token": 3311,
                                                                    "children": []
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                },
                                                {
                                                    "type": "expression_statement",
                                                    "label": "logger.info(f\"{prefix} ⏳ Disconnecting DB manager...\")",
                                                    "start_token": 3311,
                                                    "end_token": 3314,
                                                    "children": [
                                                        {
                                                            "type": "call",
                                                            "label": "logger.info(f\"{prefix} ⏳ Disconnecting DB manager...\")",
                                                            "start_token": 3311,
                                                            "end_token": 3314,
                                                            "children": [
                                                                {
                                                                    "type": "attribute",
                                                                    "label": "logger.info",
                                                                    "start_token": 3311,
                                                                    "end_token": 3311,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "logger",
                                                                            "start_token": 3311,
                                                                            "end_token": 3311,
                                                                            "children": []
                                                                        },
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "info",
                                                                            "start_token": 3311,
                                                                            "end_token": 3311,
                                                                            "children": []
                                                                        }
                                                                    ]
                                                                },
                                                                {
                                                                    "type": "argument_list",
                                                                    "label": "(f\"{prefix} ⏳ Disconnecting DB manager...\")",
                                                                    "start_token": 3311,
                                                                    "end_token": 3314,
                                                                    "children": [
                                                                        {
                                                                            "type": "string",
                                                                            "label": "f\"{prefix} ⏳ Disconnecting DB manager...\"",
                                                                            "start_token": 3311,
                                                                            "end_token": 3314,
                                                                            "children": [
                                                                                {
                                                                                    "type": "string_start",
                                                                                    "label": "f\"",
                                                                                    "start_token": 3311,
                                                                                    "end_token": 3311,
                                                                                    "children": []
                                                                                },
                                                                                {
                                                                                    "type": "interpolation",
                                                                                    "label": "{prefix}",
                                                                                    "start_token": 3311,
                                                                                    "end_token": 3311,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "label": "prefix",
                                                                                            "start_token": 3311,
                                                                                            "end_token": 3311,
                                                                                            "children": []
                                                                                        }
                                                                                    ]
                                                                                },
                                                                                {
                                                                                    "type": "string_content",
                                                                                    "label": " ⏳ Disconnecting DB manager...",
                                                                                    "start_token": 3311,
                                                                                    "end_token": 3314,
                                                                                    "children": []
                                                                                },
                                                                                {
                                                                                    "type": "string_end",
                                                                                    "label": "\"",
                                                                                    "start_token": 3314,
                                                                                    "end_token": 3314,
                                                                                    "children": []
                                                                                }
                                                                            ]
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                },
                                                {
                                                    "type": "expression_statement",
                                                    "label": "close_service_client(cls.db_client)",
                                                    "start_token": 3318,
                                                    "end_token": 3326,
                                                    "children": [
                                                        {
                                                            "type": "call",
                                                            "label": "close_service_client(cls.db_client)",
                                                            "start_token": 3318,
                                                            "end_token": 3326,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "label": "close_service_client",
                                                                    "start_token": 3318,
                                                                    "end_token": 3321,
                                                                    "children": []
                                                                },
                                                                {
                                                                    "type": "argument_list",
                                                                    "label": "(cls.db_client)",
                                                                    "start_token": 3321,
                                                                    "end_token": 3326,
                                                                    "children": [
                                                                        {
                                                                            "type": "attribute",
                                                                            "label": "cls.db_client",
                                                                            "start_token": 3321,
                                                                            "end_token": 3326,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "cls",
                                                                                    "start_token": 3321,
                                                                                    "end_token": 3321,
                                                                                    "children": []
                                                                                },
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "db_client",
                                                                                    "start_token": 3323,
                                                                                    "end_token": 3326,
                                                                                    "children": []
                                                                                }
                                                                            ]
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                },
                                                {
                                                    "type": "expression_statement",
                                                    "label": "logger.info(f\"{prefix} ✅ Finished cleanup\")",
                                                    "start_token": 3326,
                                                    "end_token": 3334,
                                                    "children": [
                                                        {
                                                            "type": "call",
                                                            "label": "logger.info(f\"{prefix} ✅ Finished cleanup\")",
                                                            "start_token": 3326,
                                                            "end_token": 3334,
                                                            "children": [
                                                                {
                                                                    "type": "attribute",
                                                                    "label": "logger.info",
                                                                    "start_token": 3326,
                                                                    "end_token": 3326,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "logger",
                                                                            "start_token": 3326,
                                                                            "end_token": 3326,
                                                                            "children": []
                                                                        },
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "info",
                                                                            "start_token": 3326,
                                                                            "end_token": 3326,
                                                                            "children": []
                                                                        }
                                                                    ]
                                                                },
                                                                {
                                                                    "type": "argument_list",
                                                                    "label": "(f\"{prefix} ✅ Finished cleanup\")",
                                                                    "start_token": 3326,
                                                                    "end_token": 3334,
                                                                    "children": [
                                                                        {
                                                                            "type": "string",
                                                                            "label": "f\"{prefix} ✅ Finished cleanup\"",
                                                                            "start_token": 3326,
                                                                            "end_token": -1,
                                                                            "children": [
                                                                                {
                                                                                    "type": "string_start",
                                                                                    "label": "f\"",
                                                                                    "start_token": 3326,
                                                                                    "end_token": 3326,
                                                                                    "children": []
                                                                                },
                                                                                {
                                                                                    "type": "interpolation",
                                                                                    "label": "{prefix}",
                                                                                    "start_token": 3326,
                                                                                    "end_token": -1,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "label": "prefix",
                                                                                            "start_token": 3326,
                                                                                            "end_token": -1,
                                                                                            "children": []
                                                                                        }
                                                                                    ]
                                                                                },
                                                                                {
                                                                                    "type": "string_content",
                                                                                    "label": " ✅ Finished cleanup",
                                                                                    "start_token": -1,
                                                                                    "end_token": 3333,
                                                                                    "children": []
                                                                                },
                                                                                {
                                                                                    "type": "string_end",
                                                                                    "label": "\"",
                                                                                    "start_token": -1,
                                                                                    "end_token": -1,
                                                                                    "children": []
                                                                                }
                                                                            ]
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                }
                                            ]
                                        }
                                    ]
                                }
                            ]
                        },
                        {
                            "type": "decorated_definition",
                            "label": "@classmethod\n    def _init_node_executor_pool(cls):\n        cls.executor = Pool(\n            processes=cls.pool_size,\n            initializer=cls.on_node_executor_start,\n        )",
                            "start_token": 3334,
                            "end_token": 3368,
                            "children": [
                                {
                                    "type": "decorator",
                                    "label": "@classmethod",
                                    "start_token": 3334,
                                    "end_token": 3334,
                                    "children": [
                                        {
                                            "type": "identifier",
                                            "label": "classmethod",
                                            "start_token": 3334,
                                            "end_token": 3334,
                                            "children": []
                                        }
                                    ]
                                },
                                {
                                    "type": "function_definition",
                                    "label": "def _init_node_executor_pool(cls):\n        cls.executor = Pool(\n            processes=cls.pool_size,\n            initializer=cls.on_node_executor_start,\n        )",
                                    "start_token": 3335,
                                    "end_token": 3368,
                                    "children": [
                                        {
                                            "type": "identifier",
                                            "label": "_init_node_executor_pool",
                                            "start_token": 3337,
                                            "end_token": -1,
                                            "children": []
                                        },
                                        {
                                            "type": "parameters",
                                            "label": "(cls)",
                                            "start_token": 3343,
                                            "end_token": 3344,
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "label": "cls",
                                                    "start_token": -1,
                                                    "end_token": 3344,
                                                    "children": []
                                                }
                                            ]
                                        },
                                        {
                                            "type": "block",
                                            "label": "cls.executor = Pool(\n            processes=cls.pool_size,\n            initializer=cls.on_node_executor_start,\n        )",
                                            "start_token": -1,
                                            "end_token": 3368,
                                            "children": [
                                                {
                                                    "type": "expression_statement",
                                                    "label": "cls.executor = Pool(\n            processes=cls.pool_size,\n            initializer=cls.on_node_executor_start,\n        )",
                                                    "start_token": -1,
                                                    "end_token": 3368,
                                                    "children": [
                                                        {
                                                            "type": "assignment",
                                                            "label": "cls.executor = Pool(\n            processes=cls.pool_size,\n            initializer=cls.on_node_executor_start,\n        )",
                                                            "start_token": -1,
                                                            "end_token": 3368,
                                                            "children": [
                                                                {
                                                                    "type": "attribute",
                                                                    "label": "cls.executor",
                                                                    "start_token": -1,
                                                                    "end_token": 3347,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "cls",
                                                                            "start_token": -1,
                                                                            "end_token": -1,
                                                                            "children": []
                                                                        },
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "executor",
                                                                            "start_token": -1,
                                                                            "end_token": 3347,
                                                                            "children": []
                                                                        }
                                                                    ]
                                                                },
                                                                {
                                                                    "type": "call",
                                                                    "label": "Pool(\n            processes=cls.pool_size,\n            initializer=cls.on_node_executor_start,\n        )",
                                                                    "start_token": 3349,
                                                                    "end_token": 3368,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "Pool",
                                                                            "start_token": 3349,
                                                                            "end_token": 3350,
                                                                            "children": []
                                                                        },
                                                                        {
                                                                            "type": "argument_list",
                                                                            "label": "(\n            processes=cls.pool_size,\n            initializer=cls.on_node_executor_start,\n        )",
                                                                            "start_token": 3351,
                                                                            "end_token": 3368,
                                                                            "children": [
                                                                                {
                                                                                    "type": "keyword_argument",
                                                                                    "label": "processes=cls.pool_size",
                                                                                    "start_token": -1,
                                                                                    "end_token": 3356,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "label": "processes",
                                                                                            "start_token": -1,
                                                                                            "end_token": -1,
                                                                                            "children": []
                                                                                        },
                                                                                        {
                                                                                            "type": "attribute",
                                                                                            "label": "cls.pool_size",
                                                                                            "start_token": 3354,
                                                                                            "end_token": 3356,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "label": "cls",
                                                                                                    "start_token": 3354,
                                                                                                    "end_token": 3354,
                                                                                                    "children": []
                                                                                                },
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "label": "pool_size",
                                                                                                    "start_token": 3354,
                                                                                                    "end_token": 3356,
                                                                                                    "children": []
                                                                                                }
                                                                                            ]
                                                                                        }
                                                                                    ]
                                                                                },
                                                                                {
                                                                                    "type": "keyword_argument",
                                                                                    "label": "initializer=cls.on_node_executor_start",
                                                                                    "start_token": 3358,
                                                                                    "end_token": 3365,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "label": "initializer",
                                                                                            "start_token": 3358,
                                                                                            "end_token": 3359,
                                                                                            "children": []
                                                                                        },
                                                                                        {
                                                                                            "type": "attribute",
                                                                                            "label": "cls.on_node_executor_start",
                                                                                            "start_token": -1,
                                                                                            "end_token": 3365,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "label": "cls",
                                                                                                    "start_token": -1,
                                                                                                    "end_token": -1,
                                                                                                    "children": []
                                                                                                },
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "label": "on_node_executor_start",
                                                                                                    "start_token": -1,
                                                                                                    "end_token": 3365,
                                                                                                    "children": []
                                                                                                }
                                                                                            ]
                                                                                        }
                                                                                    ]
                                                                                }
                                                                            ]
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                }
                                            ]
                                        }
                                    ]
                                }
                            ]
                        },
                        {
                            "type": "decorated_definition",
                            "label": "@classmethod\n    @error_logged\n    def on_graph_execution(\n        cls, graph_exec: GraphExecutionEntry, cancel: threading.Event\n    ):\n        log_metadata = LogMetadata(\n            user_id=graph_exec.user_id,\n            graph_eid=graph_exec.graph_exec_id,\n            graph_id=graph_exec.graph_id,\n            node_id=\"*\",\n            node_eid=\"*\",\n            block_name=\"-\",\n        )\n        timing_info, (exec_stats, error) = cls._on_graph_execution(\n            graph_exec, cancel, log_metadata\n        )\n        exec_stats[\"walltime\"] = timing_info.wall_time\n        exec_stats[\"cputime\"] = timing_info.cpu_time\n        exec_stats[\"error\"] = str(error) if error else None\n        result = cls.db_client.update_graph_execution_stats(\n            graph_exec_id=graph_exec.graph_exec_id,\n            stats=exec_stats,\n        )\n        cls.db_client.send_execution_update(result)",
                            "start_token": 3368,
                            "end_token": 3522,
                            "children": [
                                {
                                    "type": "decorator",
                                    "label": "@classmethod",
                                    "start_token": 3368,
                                    "end_token": 3371,
                                    "children": [
                                        {
                                            "type": "identifier",
                                            "label": "classmethod",
                                            "start_token": 3368,
                                            "end_token": 3371,
                                            "children": []
                                        }
                                    ]
                                },
                                {
                                    "type": "decorator",
                                    "label": "@error_logged",
                                    "start_token": 3371,
                                    "end_token": 3372,
                                    "children": [
                                        {
                                            "type": "identifier",
                                            "label": "error_logged",
                                            "start_token": 3371,
                                            "end_token": 3372,
                                            "children": []
                                        }
                                    ]
                                },
                                {
                                    "type": "function_definition",
                                    "label": "def on_graph_execution(\n        cls, graph_exec: GraphExecutionEntry, cancel: threading.Event\n    ):\n        log_metadata = LogMetadata(\n            user_id=graph_exec.user_id,\n            graph_eid=graph_exec.graph_exec_id,\n            graph_id=graph_exec.graph_id,\n            node_id=\"*\",\n            node_eid=\"*\",\n            block_name=\"-\",\n        )\n        timing_info, (exec_stats, error) = cls._on_graph_execution(\n            graph_exec, cancel, log_metadata\n        )\n        exec_stats[\"walltime\"] = timing_info.wall_time\n        exec_stats[\"cputime\"] = timing_info.cpu_time\n        exec_stats[\"error\"] = str(error) if error else None\n        result = cls.db_client.update_graph_execution_stats(\n            graph_exec_id=graph_exec.graph_exec_id,\n            stats=exec_stats,\n        )\n        cls.db_client.send_execution_update(result)",
                                    "start_token": -1,
                                    "end_token": 3522,
                                    "children": [
                                        {
                                            "type": "identifier",
                                            "label": "on_graph_execution",
                                            "start_token": 3374,
                                            "end_token": 3378,
                                            "children": []
                                        },
                                        {
                                            "type": "parameters",
                                            "label": "(\n        cls, graph_exec: GraphExecutionEntry, cancel: threading.Event\n    )",
                                            "start_token": 3378,
                                            "end_token": 3391,
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "label": "cls",
                                                    "start_token": 3378,
                                                    "end_token": 3378,
                                                    "children": []
                                                },
                                                {
                                                    "type": "typed_parameter",
                                                    "label": "graph_exec: GraphExecutionEntry",
                                                    "start_token": 3378,
                                                    "end_token": -1,
                                                    "children": [
                                                        {
                                                            "type": "identifier",
                                                            "label": "graph_exec",
                                                            "start_token": 3378,
                                                            "end_token": 3380,
                                                            "children": []
                                                        },
                                                        {
                                                            "type": "type",
                                                            "label": "GraphExecutionEntry",
                                                            "start_token": -1,
                                                            "end_token": -1,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "label": "GraphExecutionEntry",
                                                                    "start_token": -1,
                                                                    "end_token": -1,
                                                                    "children": []
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                },
                                                {
                                                    "type": "typed_parameter",
                                                    "label": "cancel: threading.Event",
                                                    "start_token": 3386,
                                                    "end_token": 3389,
                                                    "children": [
                                                        {
                                                            "type": "identifier",
                                                            "label": "cancel",
                                                            "start_token": 3386,
                                                            "end_token": -1,
                                                            "children": []
                                                        },
                                                        {
                                                            "type": "type",
                                                            "label": "threading.Event",
                                                            "start_token": -1,
                                                            "end_token": 3389,
                                                            "children": [
                                                                {
                                                                    "type": "attribute",
                                                                    "label": "threading.Event",
                                                                    "start_token": -1,
                                                                    "end_token": 3389,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "threading",
                                                                            "start_token": -1,
                                                                            "end_token": 3389,
                                                                            "children": []
                                                                        },
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "Event",
                                                                            "start_token": 3389,
                                                                            "end_token": 3389,
                                                                            "children": []
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                }
                                            ]
                                        },
                                        {
                                            "type": "block",
                                            "label": "log_metadata = LogMetadata(\n            user_id=graph_exec.user_id,\n            graph_eid=graph_exec.graph_exec_id,\n            graph_id=graph_exec.graph_id,\n            node_id=\"*\",\n            node_eid=\"*\",\n            block_name=\"-\",\n        )\n        timing_info, (exec_stats, error) = cls._on_graph_execution(\n            graph_exec, cancel, log_metadata\n        )\n        exec_stats[\"walltime\"] = timing_info.wall_time\n        exec_stats[\"cputime\"] = timing_info.cpu_time\n        exec_stats[\"error\"] = str(error) if error else None\n        result = cls.db_client.update_graph_execution_stats(\n            graph_exec_id=graph_exec.graph_exec_id,\n            stats=exec_stats,\n        )\n        cls.db_client.send_execution_update(result)",
                                            "start_token": -1,
                                            "end_token": 3522,
                                            "children": [
                                                {
                                                    "type": "expression_statement",
                                                    "label": "log_metadata = LogMetadata(\n            user_id=graph_exec.user_id,\n            graph_eid=graph_exec.graph_exec_id,\n            graph_id=graph_exec.graph_id,\n            node_id=\"*\",\n            node_eid=\"*\",\n            block_name=\"-\",\n        )",
                                                    "start_token": -1,
                                                    "end_token": 3435,
                                                    "children": [
                                                        {
                                                            "type": "assignment",
                                                            "label": "log_metadata = LogMetadata(\n            user_id=graph_exec.user_id,\n            graph_eid=graph_exec.graph_exec_id,\n            graph_id=graph_exec.graph_id,\n            node_id=\"*\",\n            node_eid=\"*\",\n            block_name=\"-\",\n        )",
                                                            "start_token": -1,
                                                            "end_token": 3435,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "label": "log_metadata",
                                                                    "start_token": -1,
                                                                    "end_token": -1,
                                                                    "children": []
                                                                },
                                                                {
                                                                    "type": "call",
                                                                    "label": "LogMetadata(\n            user_id=graph_exec.user_id,\n            graph_eid=graph_exec.graph_exec_id,\n            graph_id=graph_exec.graph_id,\n            node_id=\"*\",\n            node_eid=\"*\",\n            block_name=\"-\",\n        )",
                                                                    "start_token": 3394,
                                                                    "end_token": 3435,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "LogMetadata",
                                                                            "start_token": 3394,
                                                                            "end_token": 3396,
                                                                            "children": []
                                                                        },
                                                                        {
                                                                            "type": "argument_list",
                                                                            "label": "(\n            user_id=graph_exec.user_id,\n            graph_eid=graph_exec.graph_exec_id,\n            graph_id=graph_exec.graph_id,\n            node_id=\"*\",\n            node_eid=\"*\",\n            block_name=\"-\",\n        )",
                                                                            "start_token": 3396,
                                                                            "end_token": 3435,
                                                                            "children": [
                                                                                {
                                                                                    "type": "keyword_argument",
                                                                                    "label": "user_id=graph_exec.user_id",
                                                                                    "start_token": -1,
                                                                                    "end_token": 3403,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "label": "user_id",
                                                                                            "start_token": -1,
                                                                                            "end_token": -1,
                                                                                            "children": []
                                                                                        },
                                                                                        {
                                                                                            "type": "attribute",
                                                                                            "label": "graph_exec.user_id",
                                                                                            "start_token": -1,
                                                                                            "end_token": 3403,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "label": "graph_exec",
                                                                                                    "start_token": -1,
                                                                                                    "end_token": 3401,
                                                                                                    "children": []
                                                                                                },
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "label": "user_id",
                                                                                                    "start_token": 3401,
                                                                                                    "end_token": 3403,
                                                                                                    "children": []
                                                                                                }
                                                                                            ]
                                                                                        }
                                                                                    ]
                                                                                },
                                                                                {
                                                                                    "type": "keyword_argument",
                                                                                    "label": "graph_eid=graph_exec.graph_exec_id",
                                                                                    "start_token": 3405,
                                                                                    "end_token": 3410,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "label": "graph_eid",
                                                                                            "start_token": 3405,
                                                                                            "end_token": -1,
                                                                                            "children": []
                                                                                        },
                                                                                        {
                                                                                            "type": "attribute",
                                                                                            "label": "graph_exec.graph_exec_id",
                                                                                            "start_token": -1,
                                                                                            "end_token": 3410,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "label": "graph_exec",
                                                                                                    "start_token": -1,
                                                                                                    "end_token": -1,
                                                                                                    "children": []
                                                                                                },
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "label": "graph_exec_id",
                                                                                                    "start_token": 3408,
                                                                                                    "end_token": 3410,
                                                                                                    "children": []
                                                                                                }
                                                                                            ]
                                                                                        }
                                                                                    ]
                                                                                },
                                                                                {
                                                                                    "type": "keyword_argument",
                                                                                    "label": "graph_id=graph_exec.graph_id",
                                                                                    "start_token": 3413,
                                                                                    "end_token": -1,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "label": "graph_id",
                                                                                            "start_token": 3413,
                                                                                            "end_token": -1,
                                                                                            "children": []
                                                                                        },
                                                                                        {
                                                                                            "type": "attribute",
                                                                                            "label": "graph_exec.graph_id",
                                                                                            "start_token": -1,
                                                                                            "end_token": -1,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "label": "graph_exec",
                                                                                                    "start_token": -1,
                                                                                                    "end_token": 3415,
                                                                                                    "children": []
                                                                                                },
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "label": "graph_id",
                                                                                                    "start_token": 3415,
                                                                                                    "end_token": -1,
                                                                                                    "children": []
                                                                                                }
                                                                                            ]
                                                                                        }
                                                                                    ]
                                                                                },
                                                                                {
                                                                                    "type": "keyword_argument",
                                                                                    "label": "node_id=\"*\"",
                                                                                    "start_token": 3420,
                                                                                    "end_token": 3424,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "label": "node_id",
                                                                                            "start_token": 3420,
                                                                                            "end_token": 3422,
                                                                                            "children": []
                                                                                        },
                                                                                        {
                                                                                            "type": "string",
                                                                                            "label": "\"*\"",
                                                                                            "start_token": 3422,
                                                                                            "end_token": 3424,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "string_start",
                                                                                                    "label": "\"",
                                                                                                    "start_token": 3422,
                                                                                                    "end_token": 3422,
                                                                                                    "children": []
                                                                                                },
                                                                                                {
                                                                                                    "type": "string_content",
                                                                                                    "label": "*",
                                                                                                    "start_token": 3423,
                                                                                                    "end_token": 3423,
                                                                                                    "children": []
                                                                                                },
                                                                                                {
                                                                                                    "type": "string_end",
                                                                                                    "label": "\"",
                                                                                                    "start_token": 3424,
                                                                                                    "end_token": 3424,
                                                                                                    "children": []
                                                                                                }
                                                                                            ]
                                                                                        }
                                                                                    ]
                                                                                },
                                                                                {
                                                                                    "type": "keyword_argument",
                                                                                    "label": "node_eid=\"*\"",
                                                                                    "start_token": 3425,
                                                                                    "end_token": 3427,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "label": "node_eid",
                                                                                            "start_token": 3425,
                                                                                            "end_token": 3425,
                                                                                            "children": []
                                                                                        },
                                                                                        {
                                                                                            "type": "string",
                                                                                            "label": "\"*\"",
                                                                                            "start_token": 3427,
                                                                                            "end_token": 3427,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "string_start",
                                                                                                    "label": "\"",
                                                                                                    "start_token": 3427,
                                                                                                    "end_token": 3427,
                                                                                                    "children": []
                                                                                                },
                                                                                                {
                                                                                                    "type": "string_content",
                                                                                                    "label": "*",
                                                                                                    "start_token": 3427,
                                                                                                    "end_token": 3427,
                                                                                                    "children": []
                                                                                                },
                                                                                                {
                                                                                                    "type": "string_end",
                                                                                                    "label": "\"",
                                                                                                    "start_token": 3427,
                                                                                                    "end_token": 3427,
                                                                                                    "children": []
                                                                                                }
                                                                                            ]
                                                                                        }
                                                                                    ]
                                                                                },
                                                                                {
                                                                                    "type": "keyword_argument",
                                                                                    "label": "block_name=\"-\"",
                                                                                    "start_token": -1,
                                                                                    "end_token": 3432,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "label": "block_name",
                                                                                            "start_token": -1,
                                                                                            "end_token": 3432,
                                                                                            "children": []
                                                                                        },
                                                                                        {
                                                                                            "type": "string",
                                                                                            "label": "\"-\"",
                                                                                            "start_token": 3432,
                                                                                            "end_token": 3432,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "string_start",
                                                                                                    "label": "\"",
                                                                                                    "start_token": 3432,
                                                                                                    "end_token": 3432,
                                                                                                    "children": []
                                                                                                },
                                                                                                {
                                                                                                    "type": "string_content",
                                                                                                    "label": "-",
                                                                                                    "start_token": 3432,
                                                                                                    "end_token": 3432,
                                                                                                    "children": []
                                                                                                },
                                                                                                {
                                                                                                    "type": "string_end",
                                                                                                    "label": "\"",
                                                                                                    "start_token": 3432,
                                                                                                    "end_token": 3432,
                                                                                                    "children": []
                                                                                                }
                                                                                            ]
                                                                                        }
                                                                                    ]
                                                                                }
                                                                            ]
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                },
                                                {
                                                    "type": "expression_statement",
                                                    "label": "timing_info, (exec_stats, error) = cls._on_graph_execution(\n            graph_exec, cancel, log_metadata\n        )",
                                                    "start_token": 3437,
                                                    "end_token": 3455,
                                                    "children": [
                                                        {
                                                            "type": "assignment",
                                                            "label": "timing_info, (exec_stats, error) = cls._on_graph_execution(\n            graph_exec, cancel, log_metadata\n        )",
                                                            "start_token": 3437,
                                                            "end_token": 3455,
                                                            "children": [
                                                                {
                                                                    "type": "pattern_list",
                                                                    "label": "timing_info, (exec_stats, error)",
                                                                    "start_token": 3437,
                                                                    "end_token": 3444,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "timing_info",
                                                                            "start_token": 3437,
                                                                            "end_token": 3441,
                                                                            "children": []
                                                                        },
                                                                        {
                                                                            "type": "tuple_pattern",
                                                                            "label": "(exec_stats, error)",
                                                                            "start_token": 3442,
                                                                            "end_token": 3444,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "exec_stats",
                                                                                    "start_token": 3442,
                                                                                    "end_token": 3442,
                                                                                    "children": []
                                                                                },
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "error",
                                                                                    "start_token": 3442,
                                                                                    "end_token": 3443,
                                                                                    "children": []
                                                                                }
                                                                            ]
                                                                        }
                                                                    ]
                                                                },
                                                                {
                                                                    "type": "call",
                                                                    "label": "cls._on_graph_execution(\n            graph_exec, cancel, log_metadata\n        )",
                                                                    "start_token": -1,
                                                                    "end_token": 3455,
                                                                    "children": [
                                                                        {
                                                                            "type": "attribute",
                                                                            "label": "cls._on_graph_execution",
                                                                            "start_token": -1,
                                                                            "end_token": 3447,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "cls",
                                                                                    "start_token": -1,
                                                                                    "end_token": -1,
                                                                                    "children": []
                                                                                },
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "_on_graph_execution",
                                                                                    "start_token": -1,
                                                                                    "end_token": 3447,
                                                                                    "children": []
                                                                                }
                                                                            ]
                                                                        },
                                                                        {
                                                                            "type": "argument_list",
                                                                            "label": "(\n            graph_exec, cancel, log_metadata\n        )",
                                                                            "start_token": 3447,
                                                                            "end_token": 3455,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "graph_exec",
                                                                                    "start_token": 3449,
                                                                                    "end_token": -1,
                                                                                    "children": []
                                                                                },
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "cancel",
                                                                                    "start_token": -1,
                                                                                    "end_token": -1,
                                                                                    "children": []
                                                                                },
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "log_metadata",
                                                                                    "start_token": -1,
                                                                                    "end_token": 3453,
                                                                                    "children": []
                                                                                }
                                                                            ]
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                },
                                                {
                                                    "type": "expression_statement",
                                                    "label": "exec_stats[\"walltime\"] = timing_info.wall_time",
                                                    "start_token": 3458,
                                                    "end_token": 3464,
                                                    "children": [
                                                        {
                                                            "type": "assignment",
                                                            "label": "exec_stats[\"walltime\"] = timing_info.wall_time",
                                                            "start_token": 3458,
                                                            "end_token": 3464,
                                                            "children": [
                                                                {
                                                                    "type": "subscript",
                                                                    "label": "exec_stats[\"walltime\"]",
                                                                    "start_token": 3458,
                                                                    "end_token": -1,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "exec_stats",
                                                                            "start_token": 3458,
                                                                            "end_token": 3460,
                                                                            "children": []
                                                                        },
                                                                        {
                                                                            "type": "string",
                                                                            "label": "\"walltime\"",
                                                                            "start_token": 3460,
                                                                            "end_token": -1,
                                                                            "children": [
                                                                                {
                                                                                    "type": "string_start",
                                                                                    "label": "\"",
                                                                                    "start_token": 3460,
                                                                                    "end_token": 3460,
                                                                                    "children": []
                                                                                },
                                                                                {
                                                                                    "type": "string_content",
                                                                                    "label": "walltime",
                                                                                    "start_token": 3460,
                                                                                    "end_token": -1,
                                                                                    "children": []
                                                                                },
                                                                                {
                                                                                    "type": "string_end",
                                                                                    "label": "\"",
                                                                                    "start_token": -1,
                                                                                    "end_token": -1,
                                                                                    "children": []
                                                                                }
                                                                            ]
                                                                        }
                                                                    ]
                                                                },
                                                                {
                                                                    "type": "attribute",
                                                                    "label": "timing_info.wall_time",
                                                                    "start_token": -1,
                                                                    "end_token": 3464,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "timing_info",
                                                                            "start_token": -1,
                                                                            "end_token": 3462,
                                                                            "children": []
                                                                        },
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "wall_time",
                                                                            "start_token": 3463,
                                                                            "end_token": 3464,
                                                                            "children": []
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                },
                                                {
                                                    "type": "expression_statement",
                                                    "label": "exec_stats[\"cputime\"] = timing_info.cpu_time",
                                                    "start_token": 3467,
                                                    "end_token": 3474,
                                                    "children": [
                                                        {
                                                            "type": "assignment",
                                                            "label": "exec_stats[\"cputime\"] = timing_info.cpu_time",
                                                            "start_token": 3467,
                                                            "end_token": 3474,
                                                            "children": [
                                                                {
                                                                    "type": "subscript",
                                                                    "label": "exec_stats[\"cputime\"]",
                                                                    "start_token": 3467,
                                                                    "end_token": -1,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "exec_stats",
                                                                            "start_token": 3467,
                                                                            "end_token": 3469,
                                                                            "children": []
                                                                        },
                                                                        {
                                                                            "type": "string",
                                                                            "label": "\"cputime\"",
                                                                            "start_token": 3469,
                                                                            "end_token": -1,
                                                                            "children": [
                                                                                {
                                                                                    "type": "string_start",
                                                                                    "label": "\"",
                                                                                    "start_token": 3469,
                                                                                    "end_token": 3469,
                                                                                    "children": []
                                                                                },
                                                                                {
                                                                                    "type": "string_content",
                                                                                    "label": "cputime",
                                                                                    "start_token": 3469,
                                                                                    "end_token": -1,
                                                                                    "children": []
                                                                                },
                                                                                {
                                                                                    "type": "string_end",
                                                                                    "label": "\"",
                                                                                    "start_token": -1,
                                                                                    "end_token": -1,
                                                                                    "children": []
                                                                                }
                                                                            ]
                                                                        }
                                                                    ]
                                                                },
                                                                {
                                                                    "type": "attribute",
                                                                    "label": "timing_info.cpu_time",
                                                                    "start_token": -1,
                                                                    "end_token": 3474,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "timing_info",
                                                                            "start_token": -1,
                                                                            "end_token": 3471,
                                                                            "children": []
                                                                        },
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "cpu_time",
                                                                            "start_token": 3473,
                                                                            "end_token": 3474,
                                                                            "children": []
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                },
                                                {
                                                    "type": "expression_statement",
                                                    "label": "exec_stats[\"error\"] = str(error) if error else None",
                                                    "start_token": 3478,
                                                    "end_token": 3489,
                                                    "children": [
                                                        {
                                                            "type": "assignment",
                                                            "label": "exec_stats[\"error\"] = str(error) if error else None",
                                                            "start_token": 3478,
                                                            "end_token": 3489,
                                                            "children": [
                                                                {
                                                                    "type": "subscript",
                                                                    "label": "exec_stats[\"error\"]",
                                                                    "start_token": 3478,
                                                                    "end_token": -1,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "exec_stats",
                                                                            "start_token": 3478,
                                                                            "end_token": 3481,
                                                                            "children": []
                                                                        },
                                                                        {
                                                                            "type": "string",
                                                                            "label": "\"error\"",
                                                                            "start_token": 3481,
                                                                            "end_token": 3482,
                                                                            "children": [
                                                                                {
                                                                                    "type": "string_start",
                                                                                    "label": "\"",
                                                                                    "start_token": 3481,
                                                                                    "end_token": 3481,
                                                                                    "children": []
                                                                                },
                                                                                {
                                                                                    "type": "string_content",
                                                                                    "label": "error",
                                                                                    "start_token": 3481,
                                                                                    "end_token": 3482,
                                                                                    "children": []
                                                                                },
                                                                                {
                                                                                    "type": "string_end",
                                                                                    "label": "\"",
                                                                                    "start_token": 3482,
                                                                                    "end_token": 3482,
                                                                                    "children": []
                                                                                }
                                                                            ]
                                                                        }
                                                                    ]
                                                                },
                                                                {
                                                                    "type": "conditional_expression",
                                                                    "label": "str(error) if error else None",
                                                                    "start_token": 3483,
                                                                    "end_token": 3489,
                                                                    "children": [
                                                                        {
                                                                            "type": "call",
                                                                            "label": "str(error)",
                                                                            "start_token": 3483,
                                                                            "end_token": -1,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "str",
                                                                                    "start_token": 3483,
                                                                                    "end_token": -1,
                                                                                    "children": []
                                                                                },
                                                                                {
                                                                                    "type": "argument_list",
                                                                                    "label": "(error)",
                                                                                    "start_token": -1,
                                                                                    "end_token": -1,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "label": "error",
                                                                                            "start_token": -1,
                                                                                            "end_token": -1,
                                                                                            "children": []
                                                                                        }
                                                                                    ]
                                                                                }
                                                                            ]
                                                                        },
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "error",
                                                                            "start_token": 3485,
                                                                            "end_token": -1,
                                                                            "children": []
                                                                        },
                                                                        {
                                                                            "type": "none",
                                                                            "label": "None",
                                                                            "start_token": 3489,
                                                                            "end_token": 3489,
                                                                            "children": []
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                },
                                                {
                                                    "type": "expression_statement",
                                                    "label": "result = cls.db_client.update_graph_execution_stats(\n            graph_exec_id=graph_exec.graph_exec_id,\n            stats=exec_stats,\n        )",
                                                    "start_token": 3491,
                                                    "end_token": 3512,
                                                    "children": [
                                                        {
                                                            "type": "assignment",
                                                            "label": "result = cls.db_client.update_graph_execution_stats(\n            graph_exec_id=graph_exec.graph_exec_id,\n            stats=exec_stats,\n        )",
                                                            "start_token": 3491,
                                                            "end_token": 3512,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "label": "result",
                                                                    "start_token": 3491,
                                                                    "end_token": 3491,
                                                                    "children": []
                                                                },
                                                                {
                                                                    "type": "call",
                                                                    "label": "cls.db_client.update_graph_execution_stats(\n            graph_exec_id=graph_exec.graph_exec_id,\n            stats=exec_stats,\n        )",
                                                                    "start_token": 3491,
                                                                    "end_token": 3512,
                                                                    "children": [
                                                                        {
                                                                            "type": "attribute",
                                                                            "label": "cls.db_client.update_graph_execution_stats",
                                                                            "start_token": 3491,
                                                                            "end_token": 3495,
                                                                            "children": [
                                                                                {
                                                                                    "type": "attribute",
                                                                                    "label": "cls.db_client",
                                                                                    "start_token": 3491,
                                                                                    "end_token": 3491,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "label": "cls",
                                                                                            "start_token": 3491,
                                                                                            "end_token": 3491,
                                                                                            "children": []
                                                                                        },
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "label": "db_client",
                                                                                            "start_token": 3491,
                                                                                            "end_token": 3491,
                                                                                            "children": []
                                                                                        }
                                                                                    ]
                                                                                },
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "update_graph_execution_stats",
                                                                                    "start_token": 3492,
                                                                                    "end_token": 3495,
                                                                                    "children": []
                                                                                }
                                                                            ]
                                                                        },
                                                                        {
                                                                            "type": "argument_list",
                                                                            "label": "(\n            graph_exec_id=graph_exec.graph_exec_id,\n            stats=exec_stats,\n        )",
                                                                            "start_token": 3496,
                                                                            "end_token": 3512,
                                                                            "children": [
                                                                                {
                                                                                    "type": "keyword_argument",
                                                                                    "label": "graph_exec_id=graph_exec.graph_exec_id",
                                                                                    "start_token": 3498,
                                                                                    "end_token": 3503,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "label": "graph_exec_id",
                                                                                            "start_token": 3498,
                                                                                            "end_token": -1,
                                                                                            "children": []
                                                                                        },
                                                                                        {
                                                                                            "type": "attribute",
                                                                                            "label": "graph_exec.graph_exec_id",
                                                                                            "start_token": -1,
                                                                                            "end_token": 3503,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "label": "graph_exec",
                                                                                                    "start_token": -1,
                                                                                                    "end_token": -1,
                                                                                                    "children": []
                                                                                                },
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "label": "graph_exec_id",
                                                                                                    "start_token": 3501,
                                                                                                    "end_token": 3503,
                                                                                                    "children": []
                                                                                                }
                                                                                            ]
                                                                                        }
                                                                                    ]
                                                                                },
                                                                                {
                                                                                    "type": "keyword_argument",
                                                                                    "label": "stats=exec_stats",
                                                                                    "start_token": -1,
                                                                                    "end_token": 3510,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "label": "stats",
                                                                                            "start_token": -1,
                                                                                            "end_token": -1,
                                                                                            "children": []
                                                                                        },
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "label": "exec_stats",
                                                                                            "start_token": -1,
                                                                                            "end_token": 3510,
                                                                                            "children": []
                                                                                        }
                                                                                    ]
                                                                                }
                                                                            ]
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                },
                                                {
                                                    "type": "expression_statement",
                                                    "label": "cls.db_client.send_execution_update(result)",
                                                    "start_token": 3512,
                                                    "end_token": 3522,
                                                    "children": [
                                                        {
                                                            "type": "call",
                                                            "label": "cls.db_client.send_execution_update(result)",
                                                            "start_token": 3512,
                                                            "end_token": 3522,
                                                            "children": [
                                                                {
                                                                    "type": "attribute",
                                                                    "label": "cls.db_client.send_execution_update",
                                                                    "start_token": 3512,
                                                                    "end_token": -1,
                                                                    "children": [
                                                                        {
                                                                            "type": "attribute",
                                                                            "label": "cls.db_client",
                                                                            "start_token": 3512,
                                                                            "end_token": 3514,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "cls",
                                                                                    "start_token": 3512,
                                                                                    "end_token": 3512,
                                                                                    "children": []
                                                                                },
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "db_client",
                                                                                    "start_token": 3512,
                                                                                    "end_token": 3514,
                                                                                    "children": []
                                                                                }
                                                                            ]
                                                                        },
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "send_execution_update",
                                                                            "start_token": 3515,
                                                                            "end_token": -1,
                                                                            "children": []
                                                                        }
                                                                    ]
                                                                },
                                                                {
                                                                    "type": "argument_list",
                                                                    "label": "(result)",
                                                                    "start_token": -1,
                                                                    "end_token": 3522,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "result",
                                                                            "start_token": -1,
                                                                            "end_token": 3522,
                                                                            "children": []
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                }
                                            ]
                                        }
                                    ]
                                }
                            ]
                        },
                        {
                            "type": "decorated_definition",
                            "label": "@classmethod\n    @time_measured\n    def _on_graph_execution(\n        cls,\n        graph_exec: GraphExecutionEntry,\n        cancel: threading.Event,\n        log_metadata: LogMetadata,\n    ) -> tuple[dict[str, Any], Exception | None]:\n        \"\"\"\n        Returns:\n            The execution statistics of the graph execution.\n            The error that occurred during the execution.\n        \"\"\"\n        log_metadata.info(f\"Start graph execution {graph_exec.graph_exec_id}\")\n        exec_stats = {\n            \"nodes_walltime\": 0,\n            \"nodes_cputime\": 0,\n            \"node_count\": 0,\n        }\n        error = None\n        finished = False\n\n        def cancel_handler():\n            while not cancel.is_set():\n                cancel.wait(1)\n            if finished:\n                return\n            cls.executor.terminate()\n            log_metadata.info(f\"Terminated graph execution {graph_exec.graph_exec_id}\")\n            cls._init_node_executor_pool()\n\n        cancel_thread = threading.Thread(target=cancel_handler)\n        cancel_thread.start()\n\n        try:\n            queue = ExecutionQueue[NodeExecutionEntry]()\n            for node_exec in graph_exec.start_node_execs:\n                queue.add(node_exec)\n\n            running_executions: dict[str, AsyncResult] = {}\n\n            def make_exec_callback(exec_data: NodeExecutionEntry):\n                node_id = exec_data.node_id\n\n                def callback(result: object):\n                    running_executions.pop(node_id)\n                    nonlocal exec_stats\n                    if isinstance(result, dict):\n                        exec_stats[\"node_count\"] += 1\n                        exec_stats[\"nodes_cputime\"] += result.get(\"cputime\", 0)\n                        exec_stats[\"nodes_walltime\"] += result.get(\"walltime\", 0)\n\n                return callback\n\n            while not queue.empty():\n                if cancel.is_set():\n                    error = RuntimeError(\"Execution is cancelled\")\n                    return exec_stats, error\n\n                exec_data = queue.get()\n\n                # Avoid parallel execution of the same node.\n                execution = running_executions.get(exec_data.node_id)\n                if execution and not execution.ready():\n                    # TODO (performance improvement):\n                    #   Wait for the completion of the same node execution is blocking.\n                    #   To improve this we need a separate queue for each node.\n                    #   Re-enqueueing the data back to the queue will disrupt the order.\n                    execution.wait()\n\n                log_metadata.debug(\n                    f\"Dispatching node execution {exec_data.node_exec_id} \"\n                    f\"for node {exec_data.node_id}\",\n                )\n                running_executions[exec_data.node_id] = cls.executor.apply_async(\n                    cls.on_node_execution,\n                    (queue, exec_data),\n                    callback=make_exec_callback(exec_data),\n                )\n\n                # Avoid terminating graph execution when some nodes are still running.\n                while queue.empty() and running_executions:\n                    log_metadata.debug(\n                        f\"Queue empty; running nodes: {list(running_executions.keys())}\"\n                    )\n                    for node_id, execution in list(running_executions.items()):\n                        if cancel.is_set():\n                            error = RuntimeError(\"Execution is cancelled\")\n                            return exec_stats, error\n\n                        if not queue.empty():\n                            break  # yield to parent loop to execute new queue items\n\n                        log_metadata.debug(f\"Waiting on execution of node {node_id}\")\n                        execution.wait(3)\n\n            log_metadata.info(f\"Finished graph execution {graph_exec.graph_exec_id}\")\n        except Exception as e:\n            log_metadata.exception(\n                f\"Failed graph execution {graph_exec.graph_exec_id}: {e}\"\n            )\n            error = e\n        finally:\n            if not cancel.is_set():\n                finished = True\n                cancel.set()\n            cancel_thread.join()\n            return exec_stats, error",
                            "start_token": 3522,
                            "end_token": 4159,
                            "children": [
                                {
                                    "type": "decorator",
                                    "label": "@classmethod",
                                    "start_token": 3522,
                                    "end_token": -1,
                                    "children": [
                                        {
                                            "type": "identifier",
                                            "label": "classmethod",
                                            "start_token": 3522,
                                            "end_token": -1,
                                            "children": []
                                        }
                                    ]
                                },
                                {
                                    "type": "decorator",
                                    "label": "@time_measured",
                                    "start_token": 3525,
                                    "end_token": 3525,
                                    "children": [
                                        {
                                            "type": "identifier",
                                            "label": "time_measured",
                                            "start_token": 3525,
                                            "end_token": 3525,
                                            "children": []
                                        }
                                    ]
                                },
                                {
                                    "type": "function_definition",
                                    "label": "def _on_graph_execution(\n        cls,\n        graph_exec: GraphExecutionEntry,\n        cancel: threading.Event,\n        log_metadata: LogMetadata,\n    ) -> tuple[dict[str, Any], Exception | None]:\n        \"\"\"\n        Returns:\n            The execution statistics of the graph execution.\n            The error that occurred during the execution.\n        \"\"\"\n        log_metadata.info(f\"Start graph execution {graph_exec.graph_exec_id}\")\n        exec_stats = {\n            \"nodes_walltime\": 0,\n            \"nodes_cputime\": 0,\n            \"node_count\": 0,\n        }\n        error = None\n        finished = False\n\n        def cancel_handler():\n            while not cancel.is_set():\n                cancel.wait(1)\n            if finished:\n                return\n            cls.executor.terminate()\n            log_metadata.info(f\"Terminated graph execution {graph_exec.graph_exec_id}\")\n            cls._init_node_executor_pool()\n\n        cancel_thread = threading.Thread(target=cancel_handler)\n        cancel_thread.start()\n\n        try:\n            queue = ExecutionQueue[NodeExecutionEntry]()\n            for node_exec in graph_exec.start_node_execs:\n                queue.add(node_exec)\n\n            running_executions: dict[str, AsyncResult] = {}\n\n            def make_exec_callback(exec_data: NodeExecutionEntry):\n                node_id = exec_data.node_id\n\n                def callback(result: object):\n                    running_executions.pop(node_id)\n                    nonlocal exec_stats\n                    if isinstance(result, dict):\n                        exec_stats[\"node_count\"] += 1\n                        exec_stats[\"nodes_cputime\"] += result.get(\"cputime\", 0)\n                        exec_stats[\"nodes_walltime\"] += result.get(\"walltime\", 0)\n\n                return callback\n\n            while not queue.empty():\n                if cancel.is_set():\n                    error = RuntimeError(\"Execution is cancelled\")\n                    return exec_stats, error\n\n                exec_data = queue.get()\n\n                # Avoid parallel execution of the same node.\n                execution = running_executions.get(exec_data.node_id)\n                if execution and not execution.ready():\n                    # TODO (performance improvement):\n                    #   Wait for the completion of the same node execution is blocking.\n                    #   To improve this we need a separate queue for each node.\n                    #   Re-enqueueing the data back to the queue will disrupt the order.\n                    execution.wait()\n\n                log_metadata.debug(\n                    f\"Dispatching node execution {exec_data.node_exec_id} \"\n                    f\"for node {exec_data.node_id}\",\n                )\n                running_executions[exec_data.node_id] = cls.executor.apply_async(\n                    cls.on_node_execution,\n                    (queue, exec_data),\n                    callback=make_exec_callback(exec_data),\n                )\n\n                # Avoid terminating graph execution when some nodes are still running.\n                while queue.empty() and running_executions:\n                    log_metadata.debug(\n                        f\"Queue empty; running nodes: {list(running_executions.keys())}\"\n                    )\n                    for node_id, execution in list(running_executions.items()):\n                        if cancel.is_set():\n                            error = RuntimeError(\"Execution is cancelled\")\n                            return exec_stats, error\n\n                        if not queue.empty():\n                            break  # yield to parent loop to execute new queue items\n\n                        log_metadata.debug(f\"Waiting on execution of node {node_id}\")\n                        execution.wait(3)\n\n            log_metadata.info(f\"Finished graph execution {graph_exec.graph_exec_id}\")\n        except Exception as e:\n            log_metadata.exception(\n                f\"Failed graph execution {graph_exec.graph_exec_id}: {e}\"\n            )\n            error = e\n        finally:\n            if not cancel.is_set():\n                finished = True\n                cancel.set()\n            cancel_thread.join()\n            return exec_stats, error",
                                    "start_token": -1,
                                    "end_token": 4159,
                                    "children": [
                                        {
                                            "type": "identifier",
                                            "label": "_on_graph_execution",
                                            "start_token": -1,
                                            "end_token": 3531,
                                            "children": []
                                        },
                                        {
                                            "type": "parameters",
                                            "label": "(\n        cls,\n        graph_exec: GraphExecutionEntry,\n        cancel: threading.Event,\n        log_metadata: LogMetadata,\n    )",
                                            "start_token": 3531,
                                            "end_token": 3560,
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "label": "cls",
                                                    "start_token": 3533,
                                                    "end_token": 3533,
                                                    "children": []
                                                },
                                                {
                                                    "type": "typed_parameter",
                                                    "label": "graph_exec: GraphExecutionEntry",
                                                    "start_token": 3533,
                                                    "end_token": 3539,
                                                    "children": [
                                                        {
                                                            "type": "identifier",
                                                            "label": "graph_exec",
                                                            "start_token": 3533,
                                                            "end_token": -1,
                                                            "children": []
                                                        },
                                                        {
                                                            "type": "type",
                                                            "label": "GraphExecutionEntry",
                                                            "start_token": -1,
                                                            "end_token": 3539,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "label": "GraphExecutionEntry",
                                                                    "start_token": -1,
                                                                    "end_token": 3539,
                                                                    "children": []
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                },
                                                {
                                                    "type": "typed_parameter",
                                                    "label": "cancel: threading.Event",
                                                    "start_token": -1,
                                                    "end_token": 3545,
                                                    "children": [
                                                        {
                                                            "type": "identifier",
                                                            "label": "cancel",
                                                            "start_token": -1,
                                                            "end_token": 3543,
                                                            "children": []
                                                        },
                                                        {
                                                            "type": "type",
                                                            "label": "threading.Event",
                                                            "start_token": 3543,
                                                            "end_token": 3545,
                                                            "children": [
                                                                {
                                                                    "type": "attribute",
                                                                    "label": "threading.Event",
                                                                    "start_token": 3543,
                                                                    "end_token": 3545,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "threading",
                                                                            "start_token": 3543,
                                                                            "end_token": 3543,
                                                                            "children": []
                                                                        },
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "Event",
                                                                            "start_token": -1,
                                                                            "end_token": 3545,
                                                                            "children": []
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                },
                                                {
                                                    "type": "typed_parameter",
                                                    "label": "log_metadata: LogMetadata",
                                                    "start_token": -1,
                                                    "end_token": 3557,
                                                    "children": [
                                                        {
                                                            "type": "identifier",
                                                            "label": "log_metadata",
                                                            "start_token": -1,
                                                            "end_token": 3551,
                                                            "children": []
                                                        },
                                                        {
                                                            "type": "type",
                                                            "label": "LogMetadata",
                                                            "start_token": 3553,
                                                            "end_token": 3557,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "label": "LogMetadata",
                                                                    "start_token": 3553,
                                                                    "end_token": 3557,
                                                                    "children": []
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                }
                                            ]
                                        },
                                        {
                                            "type": "type",
                                            "label": "tuple[dict[str, Any], Exception | None]",
                                            "start_token": 3560,
                                            "end_token": 3567,
                                            "children": [
                                                {
                                                    "type": "generic_type",
                                                    "label": "tuple[dict[str, Any], Exception | None]",
                                                    "start_token": 3560,
                                                    "end_token": 3567,
                                                    "children": [
                                                        {
                                                            "type": "identifier",
                                                            "label": "tuple",
                                                            "start_token": 3560,
                                                            "end_token": 3561,
                                                            "children": []
                                                        },
                                                        {
                                                            "type": "type_parameter",
                                                            "label": "[dict[str, Any], Exception | None]",
                                                            "start_token": -1,
                                                            "end_token": 3567,
                                                            "children": [
                                                                {
                                                                    "type": "type",
                                                                    "label": "dict[str, Any]",
                                                                    "start_token": 3562,
                                                                    "end_token": -1,
                                                                    "children": [
                                                                        {
                                                                            "type": "generic_type",
                                                                            "label": "dict[str, Any]",
                                                                            "start_token": 3562,
                                                                            "end_token": -1,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "dict",
                                                                                    "start_token": 3562,
                                                                                    "end_token": 3562,
                                                                                    "children": []
                                                                                },
                                                                                {
                                                                                    "type": "type_parameter",
                                                                                    "label": "[str, Any]",
                                                                                    "start_token": 3563,
                                                                                    "end_token": -1,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "type",
                                                                                            "label": "str",
                                                                                            "start_token": 3564,
                                                                                            "end_token": -1,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "label": "str",
                                                                                                    "start_token": 3564,
                                                                                                    "end_token": -1,
                                                                                                    "children": []
                                                                                                }
                                                                                            ]
                                                                                        },
                                                                                        {
                                                                                            "type": "type",
                                                                                            "label": "Any",
                                                                                            "start_token": -1,
                                                                                            "end_token": -1,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "label": "Any",
                                                                                                    "start_token": -1,
                                                                                                    "end_token": -1,
                                                                                                    "children": []
                                                                                                }
                                                                                            ]
                                                                                        }
                                                                                    ]
                                                                                }
                                                                            ]
                                                                        }
                                                                    ]
                                                                },
                                                                {
                                                                    "type": "type",
                                                                    "label": "Exception | None",
                                                                    "start_token": 3566,
                                                                    "end_token": 3567,
                                                                    "children": [
                                                                        {
                                                                            "type": "binary_operator",
                                                                            "label": "Exception | None",
                                                                            "start_token": 3566,
                                                                            "end_token": 3567,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "Exception",
                                                                                    "start_token": 3566,
                                                                                    "end_token": 3567,
                                                                                    "children": []
                                                                                },
                                                                                {
                                                                                    "type": "none",
                                                                                    "label": "None",
                                                                                    "start_token": 3567,
                                                                                    "end_token": 3567,
                                                                                    "children": []
                                                                                }
                                                                            ]
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                }
                                            ]
                                        },
                                        {
                                            "type": "block",
                                            "label": "\"\"\"\n        Returns:\n            The execution statistics of the graph execution.\n            The error that occurred during the execution.\n        \"\"\"\n        log_metadata.info(f\"Start graph execution {graph_exec.graph_exec_id}\")\n        exec_stats = {\n            \"nodes_walltime\": 0,\n            \"nodes_cputime\": 0,\n            \"node_count\": 0,\n        }\n        error = None\n        finished = False\n\n        def cancel_handler():\n            while not cancel.is_set():\n                cancel.wait(1)\n            if finished:\n                return\n            cls.executor.terminate()\n            log_metadata.info(f\"Terminated graph execution {graph_exec.graph_exec_id}\")\n            cls._init_node_executor_pool()\n\n        cancel_thread = threading.Thread(target=cancel_handler)\n        cancel_thread.start()\n\n        try:\n            queue = ExecutionQueue[NodeExecutionEntry]()\n            for node_exec in graph_exec.start_node_execs:\n                queue.add(node_exec)\n\n            running_executions: dict[str, AsyncResult] = {}\n\n            def make_exec_callback(exec_data: NodeExecutionEntry):\n                node_id = exec_data.node_id\n\n                def callback(result: object):\n                    running_executions.pop(node_id)\n                    nonlocal exec_stats\n                    if isinstance(result, dict):\n                        exec_stats[\"node_count\"] += 1\n                        exec_stats[\"nodes_cputime\"] += result.get(\"cputime\", 0)\n                        exec_stats[\"nodes_walltime\"] += result.get(\"walltime\", 0)\n\n                return callback\n\n            while not queue.empty():\n                if cancel.is_set():\n                    error = RuntimeError(\"Execution is cancelled\")\n                    return exec_stats, error\n\n                exec_data = queue.get()\n\n                # Avoid parallel execution of the same node.\n                execution = running_executions.get(exec_data.node_id)\n                if execution and not execution.ready():\n                    # TODO (performance improvement):\n                    #   Wait for the completion of the same node execution is blocking.\n                    #   To improve this we need a separate queue for each node.\n                    #   Re-enqueueing the data back to the queue will disrupt the order.\n                    execution.wait()\n\n                log_metadata.debug(\n                    f\"Dispatching node execution {exec_data.node_exec_id} \"\n                    f\"for node {exec_data.node_id}\",\n                )\n                running_executions[exec_data.node_id] = cls.executor.apply_async(\n                    cls.on_node_execution,\n                    (queue, exec_data),\n                    callback=make_exec_callback(exec_data),\n                )\n\n                # Avoid terminating graph execution when some nodes are still running.\n                while queue.empty() and running_executions:\n                    log_metadata.debug(\n                        f\"Queue empty; running nodes: {list(running_executions.keys())}\"\n                    )\n                    for node_id, execution in list(running_executions.items()):\n                        if cancel.is_set():\n                            error = RuntimeError(\"Execution is cancelled\")\n                            return exec_stats, error\n\n                        if not queue.empty():\n                            break  # yield to parent loop to execute new queue items\n\n                        log_metadata.debug(f\"Waiting on execution of node {node_id}\")\n                        execution.wait(3)\n\n            log_metadata.info(f\"Finished graph execution {graph_exec.graph_exec_id}\")\n        except Exception as e:\n            log_metadata.exception(\n                f\"Failed graph execution {graph_exec.graph_exec_id}: {e}\"\n            )\n            error = e\n        finally:\n            if not cancel.is_set():\n                finished = True\n                cancel.set()\n            cancel_thread.join()\n            return exec_stats, error",
                                            "start_token": 3567,
                                            "end_token": 4159,
                                            "children": [
                                                {
                                                    "type": "expression_statement",
                                                    "label": "\"\"\"\n        Returns:\n            The execution statistics of the graph execution.\n            The error that occurred during the execution.\n        \"\"\"",
                                                    "start_token": 3567,
                                                    "end_token": 3574,
                                                    "children": [
                                                        {
                                                            "type": "string",
                                                            "label": "\"\"\"\n        Returns:\n            The execution statistics of the graph execution.\n            The error that occurred during the execution.\n        \"\"\"",
                                                            "start_token": 3567,
                                                            "end_token": 3574,
                                                            "children": [
                                                                {
                                                                    "type": "string_start",
                                                                    "label": "\"\"\"",
                                                                    "start_token": 3567,
                                                                    "end_token": 3567,
                                                                    "children": []
                                                                },
                                                                {
                                                                    "type": "string_content",
                                                                    "label": "\n        Returns:\n            The execution statistics of the graph execution.\n            The error that occurred during the execution.\n        ",
                                                                    "start_token": 3567,
                                                                    "end_token": 3572,
                                                                    "children": []
                                                                },
                                                                {
                                                                    "type": "string_end",
                                                                    "label": "\"\"\"",
                                                                    "start_token": 3572,
                                                                    "end_token": 3574,
                                                                    "children": []
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                },
                                                {
                                                    "type": "expression_statement",
                                                    "label": "log_metadata.info(f\"Start graph execution {graph_exec.graph_exec_id}\")",
                                                    "start_token": 3575,
                                                    "end_token": -1,
                                                    "children": [
                                                        {
                                                            "type": "call",
                                                            "label": "log_metadata.info(f\"Start graph execution {graph_exec.graph_exec_id}\")",
                                                            "start_token": 3575,
                                                            "end_token": -1,
                                                            "children": [
                                                                {
                                                                    "type": "attribute",
                                                                    "label": "log_metadata.info",
                                                                    "start_token": 3575,
                                                                    "end_token": 3575,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "log_metadata",
                                                                            "start_token": 3575,
                                                                            "end_token": 3575,
                                                                            "children": []
                                                                        },
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "info",
                                                                            "start_token": 3575,
                                                                            "end_token": 3575,
                                                                            "children": []
                                                                        }
                                                                    ]
                                                                },
                                                                {
                                                                    "type": "argument_list",
                                                                    "label": "(f\"Start graph execution {graph_exec.graph_exec_id}\")",
                                                                    "start_token": 3575,
                                                                    "end_token": -1,
                                                                    "children": [
                                                                        {
                                                                            "type": "string",
                                                                            "label": "f\"Start graph execution {graph_exec.graph_exec_id}\"",
                                                                            "start_token": 3575,
                                                                            "end_token": -1,
                                                                            "children": [
                                                                                {
                                                                                    "type": "string_start",
                                                                                    "label": "f\"",
                                                                                    "start_token": 3575,
                                                                                    "end_token": 3575,
                                                                                    "children": []
                                                                                },
                                                                                {
                                                                                    "type": "string_content",
                                                                                    "label": "Start graph execution ",
                                                                                    "start_token": 3575,
                                                                                    "end_token": 3576,
                                                                                    "children": []
                                                                                },
                                                                                {
                                                                                    "type": "interpolation",
                                                                                    "label": "{graph_exec.graph_exec_id}",
                                                                                    "start_token": 3577,
                                                                                    "end_token": -1,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "attribute",
                                                                                            "label": "graph_exec.graph_exec_id",
                                                                                            "start_token": -1,
                                                                                            "end_token": -1,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "label": "graph_exec",
                                                                                                    "start_token": -1,
                                                                                                    "end_token": 3578,
                                                                                                    "children": []
                                                                                                },
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "label": "graph_exec_id",
                                                                                                    "start_token": 3578,
                                                                                                    "end_token": -1,
                                                                                                    "children": []
                                                                                                }
                                                                                            ]
                                                                                        }
                                                                                    ]
                                                                                },
                                                                                {
                                                                                    "type": "string_end",
                                                                                    "label": "\"",
                                                                                    "start_token": -1,
                                                                                    "end_token": -1,
                                                                                    "children": []
                                                                                }
                                                                            ]
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                },
                                                {
                                                    "type": "expression_statement",
                                                    "label": "exec_stats = {\n            \"nodes_walltime\": 0,\n            \"nodes_cputime\": 0,\n            \"node_count\": 0,\n        }",
                                                    "start_token": 3582,
                                                    "end_token": -1,
                                                    "children": [
                                                        {
                                                            "type": "assignment",
                                                            "label": "exec_stats = {\n            \"nodes_walltime\": 0,\n            \"nodes_cputime\": 0,\n            \"node_count\": 0,\n        }",
                                                            "start_token": 3582,
                                                            "end_token": -1,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "label": "exec_stats",
                                                                    "start_token": 3582,
                                                                    "end_token": 3582,
                                                                    "children": []
                                                                },
                                                                {
                                                                    "type": "dictionary",
                                                                    "label": "{\n            \"nodes_walltime\": 0,\n            \"nodes_cputime\": 0,\n            \"node_count\": 0,\n        }",
                                                                    "start_token": 3582,
                                                                    "end_token": -1,
                                                                    "children": [
                                                                        {
                                                                            "type": "pair",
                                                                            "label": "\"nodes_walltime\": 0",
                                                                            "start_token": -1,
                                                                            "end_token": 3587,
                                                                            "children": [
                                                                                {
                                                                                    "type": "string",
                                                                                    "label": "\"nodes_walltime\"",
                                                                                    "start_token": -1,
                                                                                    "end_token": 3587,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "string_start",
                                                                                            "label": "\"",
                                                                                            "start_token": -1,
                                                                                            "end_token": -1,
                                                                                            "children": []
                                                                                        },
                                                                                        {
                                                                                            "type": "string_content",
                                                                                            "label": "nodes_walltime",
                                                                                            "start_token": -1,
                                                                                            "end_token": 3587,
                                                                                            "children": []
                                                                                        },
                                                                                        {
                                                                                            "type": "string_end",
                                                                                            "label": "\"",
                                                                                            "start_token": 3587,
                                                                                            "end_token": 3587,
                                                                                            "children": []
                                                                                        }
                                                                                    ]
                                                                                },
                                                                                {
                                                                                    "type": "integer",
                                                                                    "label": "0",
                                                                                    "start_token": 3587,
                                                                                    "end_token": 3587,
                                                                                    "children": []
                                                                                }
                                                                            ]
                                                                        },
                                                                        {
                                                                            "type": "pair",
                                                                            "label": "\"nodes_cputime\": 0",
                                                                            "start_token": -1,
                                                                            "end_token": -1,
                                                                            "children": [
                                                                                {
                                                                                    "type": "string",
                                                                                    "label": "\"nodes_cputime\"",
                                                                                    "start_token": -1,
                                                                                    "end_token": 3592,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "string_start",
                                                                                            "label": "\"",
                                                                                            "start_token": -1,
                                                                                            "end_token": -1,
                                                                                            "children": []
                                                                                        },
                                                                                        {
                                                                                            "type": "string_content",
                                                                                            "label": "nodes_cputime",
                                                                                            "start_token": -1,
                                                                                            "end_token": 3592,
                                                                                            "children": []
                                                                                        },
                                                                                        {
                                                                                            "type": "string_end",
                                                                                            "label": "\"",
                                                                                            "start_token": 3592,
                                                                                            "end_token": 3592,
                                                                                            "children": []
                                                                                        }
                                                                                    ]
                                                                                },
                                                                                {
                                                                                    "type": "integer",
                                                                                    "label": "0",
                                                                                    "start_token": -1,
                                                                                    "end_token": -1,
                                                                                    "children": []
                                                                                }
                                                                            ]
                                                                        },
                                                                        {
                                                                            "type": "pair",
                                                                            "label": "\"node_count\": 0",
                                                                            "start_token": -1,
                                                                            "end_token": -1,
                                                                            "children": [
                                                                                {
                                                                                    "type": "string",
                                                                                    "label": "\"node_count\"",
                                                                                    "start_token": -1,
                                                                                    "end_token": 3599,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "string_start",
                                                                                            "label": "\"",
                                                                                            "start_token": -1,
                                                                                            "end_token": -1,
                                                                                            "children": []
                                                                                        },
                                                                                        {
                                                                                            "type": "string_content",
                                                                                            "label": "node_count",
                                                                                            "start_token": -1,
                                                                                            "end_token": 3599,
                                                                                            "children": []
                                                                                        },
                                                                                        {
                                                                                            "type": "string_end",
                                                                                            "label": "\"",
                                                                                            "start_token": 3599,
                                                                                            "end_token": 3599,
                                                                                            "children": []
                                                                                        }
                                                                                    ]
                                                                                },
                                                                                {
                                                                                    "type": "integer",
                                                                                    "label": "0",
                                                                                    "start_token": -1,
                                                                                    "end_token": -1,
                                                                                    "children": []
                                                                                }
                                                                            ]
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                },
                                                {
                                                    "type": "expression_statement",
                                                    "label": "error = None",
                                                    "start_token": 3603,
                                                    "end_token": -1,
                                                    "children": [
                                                        {
                                                            "type": "assignment",
                                                            "label": "error = None",
                                                            "start_token": 3603,
                                                            "end_token": -1,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "label": "error",
                                                                    "start_token": 3603,
                                                                    "end_token": 3605,
                                                                    "children": []
                                                                },
                                                                {
                                                                    "type": "none",
                                                                    "label": "None",
                                                                    "start_token": 3605,
                                                                    "end_token": -1,
                                                                    "children": []
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                },
                                                {
                                                    "type": "expression_statement",
                                                    "label": "finished = False",
                                                    "start_token": 3608,
                                                    "end_token": 3609,
                                                    "children": [
                                                        {
                                                            "type": "assignment",
                                                            "label": "finished = False",
                                                            "start_token": 3608,
                                                            "end_token": 3609,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "label": "finished",
                                                                    "start_token": 3608,
                                                                    "end_token": 3609,
                                                                    "children": []
                                                                },
                                                                {
                                                                    "type": "false",
                                                                    "label": "False",
                                                                    "start_token": 3609,
                                                                    "end_token": 3609,
                                                                    "children": []
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                },
                                                {
                                                    "type": "function_definition",
                                                    "label": "def cancel_handler():\n            while not cancel.is_set():\n                cancel.wait(1)\n            if finished:\n                return\n            cls.executor.terminate()\n            log_metadata.info(f\"Terminated graph execution {graph_exec.graph_exec_id}\")\n            cls._init_node_executor_pool()",
                                                    "start_token": -1,
                                                    "end_token": 3661,
                                                    "children": [
                                                        {
                                                            "type": "identifier",
                                                            "label": "cancel_handler",
                                                            "start_token": -1,
                                                            "end_token": 3616,
                                                            "children": []
                                                        },
                                                        {
                                                            "type": "parameters",
                                                            "label": "()",
                                                            "start_token": 3616,
                                                            "end_token": 3616,
                                                            "children": []
                                                        },
                                                        {
                                                            "type": "block",
                                                            "label": "while not cancel.is_set():\n                cancel.wait(1)\n            if finished:\n                return\n            cls.executor.terminate()\n            log_metadata.info(f\"Terminated graph execution {graph_exec.graph_exec_id}\")\n            cls._init_node_executor_pool()",
                                                            "start_token": -1,
                                                            "end_token": 3661,
                                                            "children": [
                                                                {
                                                                    "type": "while_statement",
                                                                    "label": "while not cancel.is_set():\n                cancel.wait(1)",
                                                                    "start_token": -1,
                                                                    "end_token": -1,
                                                                    "children": [
                                                                        {
                                                                            "type": "not_operator",
                                                                            "label": "not cancel.is_set()",
                                                                            "start_token": -1,
                                                                            "end_token": 3625,
                                                                            "children": [
                                                                                {
                                                                                    "type": "call",
                                                                                    "label": "cancel.is_set()",
                                                                                    "start_token": -1,
                                                                                    "end_token": 3625,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "attribute",
                                                                                            "label": "cancel.is_set",
                                                                                            "start_token": -1,
                                                                                            "end_token": 3625,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "label": "cancel",
                                                                                                    "start_token": -1,
                                                                                                    "end_token": 3623,
                                                                                                    "children": []
                                                                                                },
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "label": "is_set",
                                                                                                    "start_token": 3623,
                                                                                                    "end_token": 3625,
                                                                                                    "children": []
                                                                                                }
                                                                                            ]
                                                                                        },
                                                                                        {
                                                                                            "type": "argument_list",
                                                                                            "label": "()",
                                                                                            "start_token": 3625,
                                                                                            "end_token": 3625,
                                                                                            "children": []
                                                                                        }
                                                                                    ]
                                                                                }
                                                                            ]
                                                                        },
                                                                        {
                                                                            "type": "block",
                                                                            "label": "cancel.wait(1)",
                                                                            "start_token": 3630,
                                                                            "end_token": -1,
                                                                            "children": [
                                                                                {
                                                                                    "type": "expression_statement",
                                                                                    "label": "cancel.wait(1)",
                                                                                    "start_token": 3630,
                                                                                    "end_token": -1,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "call",
                                                                                            "label": "cancel.wait(1)",
                                                                                            "start_token": 3630,
                                                                                            "end_token": -1,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "attribute",
                                                                                                    "label": "cancel.wait",
                                                                                                    "start_token": 3630,
                                                                                                    "end_token": 3632,
                                                                                                    "children": [
                                                                                                        {
                                                                                                            "type": "identifier",
                                                                                                            "label": "cancel",
                                                                                                            "start_token": 3630,
                                                                                                            "end_token": 3631,
                                                                                                            "children": []
                                                                                                        },
                                                                                                        {
                                                                                                            "type": "identifier",
                                                                                                            "label": "wait",
                                                                                                            "start_token": 3631,
                                                                                                            "end_token": 3632,
                                                                                                            "children": []
                                                                                                        }
                                                                                                    ]
                                                                                                },
                                                                                                {
                                                                                                    "type": "argument_list",
                                                                                                    "label": "(1)",
                                                                                                    "start_token": 3633,
                                                                                                    "end_token": -1,
                                                                                                    "children": [
                                                                                                        {
                                                                                                            "type": "integer",
                                                                                                            "label": "1",
                                                                                                            "start_token": -1,
                                                                                                            "end_token": -1,
                                                                                                            "children": []
                                                                                                        }
                                                                                                    ]
                                                                                                }
                                                                                            ]
                                                                                        }
                                                                                    ]
                                                                                }
                                                                            ]
                                                                        }
                                                                    ]
                                                                },
                                                                {
                                                                    "type": "if_statement",
                                                                    "label": "if finished:\n                return",
                                                                    "start_token": -1,
                                                                    "end_token": 3640,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "finished",
                                                                            "start_token": 3634,
                                                                            "end_token": -1,
                                                                            "children": []
                                                                        },
                                                                        {
                                                                            "type": "block",
                                                                            "label": "return",
                                                                            "start_token": 3638,
                                                                            "end_token": 3640,
                                                                            "children": [
                                                                                {
                                                                                    "type": "return_statement",
                                                                                    "label": "return",
                                                                                    "start_token": 3638,
                                                                                    "end_token": 3640,
                                                                                    "children": []
                                                                                }
                                                                            ]
                                                                        }
                                                                    ]
                                                                },
                                                                {
                                                                    "type": "expression_statement",
                                                                    "label": "cls.executor.terminate()",
                                                                    "start_token": -1,
                                                                    "end_token": 3646,
                                                                    "children": [
                                                                        {
                                                                            "type": "call",
                                                                            "label": "cls.executor.terminate()",
                                                                            "start_token": -1,
                                                                            "end_token": 3646,
                                                                            "children": [
                                                                                {
                                                                                    "type": "attribute",
                                                                                    "label": "cls.executor.terminate",
                                                                                    "start_token": -1,
                                                                                    "end_token": 3645,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "attribute",
                                                                                            "label": "cls.executor",
                                                                                            "start_token": -1,
                                                                                            "end_token": 3644,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "label": "cls",
                                                                                                    "start_token": -1,
                                                                                                    "end_token": -1,
                                                                                                    "children": []
                                                                                                },
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "label": "executor",
                                                                                                    "start_token": -1,
                                                                                                    "end_token": 3644,
                                                                                                    "children": []
                                                                                                }
                                                                                            ]
                                                                                        },
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "label": "terminate",
                                                                                            "start_token": 3644,
                                                                                            "end_token": 3645,
                                                                                            "children": []
                                                                                        }
                                                                                    ]
                                                                                },
                                                                                {
                                                                                    "type": "argument_list",
                                                                                    "label": "()",
                                                                                    "start_token": 3646,
                                                                                    "end_token": 3646,
                                                                                    "children": []
                                                                                }
                                                                            ]
                                                                        }
                                                                    ]
                                                                },
                                                                {
                                                                    "type": "expression_statement",
                                                                    "label": "log_metadata.info(f\"Terminated graph execution {graph_exec.graph_exec_id}\")",
                                                                    "start_token": 3649,
                                                                    "end_token": 3654,
                                                                    "children": [
                                                                        {
                                                                            "type": "call",
                                                                            "label": "log_metadata.info(f\"Terminated graph execution {graph_exec.graph_exec_id}\")",
                                                                            "start_token": 3649,
                                                                            "end_token": 3654,
                                                                            "children": [
                                                                                {
                                                                                    "type": "attribute",
                                                                                    "label": "log_metadata.info",
                                                                                    "start_token": 3649,
                                                                                    "end_token": 3649,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "label": "log_metadata",
                                                                                            "start_token": 3649,
                                                                                            "end_token": 3649,
                                                                                            "children": []
                                                                                        },
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "label": "info",
                                                                                            "start_token": 3649,
                                                                                            "end_token": 3649,
                                                                                            "children": []
                                                                                        }
                                                                                    ]
                                                                                },
                                                                                {
                                                                                    "type": "argument_list",
                                                                                    "label": "(f\"Terminated graph execution {graph_exec.graph_exec_id}\")",
                                                                                    "start_token": 3649,
                                                                                    "end_token": 3654,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "string",
                                                                                            "label": "f\"Terminated graph execution {graph_exec.graph_exec_id}\"",
                                                                                            "start_token": 3649,
                                                                                            "end_token": 3654,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "string_start",
                                                                                                    "label": "f\"",
                                                                                                    "start_token": 3649,
                                                                                                    "end_token": 3649,
                                                                                                    "children": []
                                                                                                },
                                                                                                {
                                                                                                    "type": "string_content",
                                                                                                    "label": "Terminated graph execution ",
                                                                                                    "start_token": 3649,
                                                                                                    "end_token": 3650,
                                                                                                    "children": []
                                                                                                },
                                                                                                {
                                                                                                    "type": "interpolation",
                                                                                                    "label": "{graph_exec.graph_exec_id}",
                                                                                                    "start_token": 3651,
                                                                                                    "end_token": 3654,
                                                                                                    "children": [
                                                                                                        {
                                                                                                            "type": "attribute",
                                                                                                            "label": "graph_exec.graph_exec_id",
                                                                                                            "start_token": -1,
                                                                                                            "end_token": 3654,
                                                                                                            "children": [
                                                                                                                {
                                                                                                                    "type": "identifier",
                                                                                                                    "label": "graph_exec",
                                                                                                                    "start_token": -1,
                                                                                                                    "end_token": -1,
                                                                                                                    "children": []
                                                                                                                },
                                                                                                                {
                                                                                                                    "type": "identifier",
                                                                                                                    "label": "graph_exec_id",
                                                                                                                    "start_token": -1,
                                                                                                                    "end_token": 3654,
                                                                                                                    "children": []
                                                                                                                }
                                                                                                            ]
                                                                                                        }
                                                                                                    ]
                                                                                                },
                                                                                                {
                                                                                                    "type": "string_end",
                                                                                                    "label": "\"",
                                                                                                    "start_token": 3654,
                                                                                                    "end_token": 3654,
                                                                                                    "children": []
                                                                                                }
                                                                                            ]
                                                                                        }
                                                                                    ]
                                                                                }
                                                                            ]
                                                                        }
                                                                    ]
                                                                },
                                                                {
                                                                    "type": "expression_statement",
                                                                    "label": "cls._init_node_executor_pool()",
                                                                    "start_token": 3655,
                                                                    "end_token": 3661,
                                                                    "children": [
                                                                        {
                                                                            "type": "call",
                                                                            "label": "cls._init_node_executor_pool()",
                                                                            "start_token": 3655,
                                                                            "end_token": 3661,
                                                                            "children": [
                                                                                {
                                                                                    "type": "attribute",
                                                                                    "label": "cls._init_node_executor_pool",
                                                                                    "start_token": 3655,
                                                                                    "end_token": -1,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "label": "cls",
                                                                                            "start_token": 3655,
                                                                                            "end_token": 3657,
                                                                                            "children": []
                                                                                        },
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "label": "_init_node_executor_pool",
                                                                                            "start_token": -1,
                                                                                            "end_token": -1,
                                                                                            "children": []
                                                                                        }
                                                                                    ]
                                                                                },
                                                                                {
                                                                                    "type": "argument_list",
                                                                                    "label": "()",
                                                                                    "start_token": 3661,
                                                                                    "end_token": 3661,
                                                                                    "children": []
                                                                                }
                                                                            ]
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                },
                                                {
                                                    "type": "expression_statement",
                                                    "label": "cancel_thread = threading.Thread(target=cancel_handler)",
                                                    "start_token": 3663,
                                                    "end_token": 3672,
                                                    "children": [
                                                        {
                                                            "type": "assignment",
                                                            "label": "cancel_thread = threading.Thread(target=cancel_handler)",
                                                            "start_token": 3663,
                                                            "end_token": 3672,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "label": "cancel_thread",
                                                                    "start_token": 3663,
                                                                    "end_token": 3667,
                                                                    "children": []
                                                                },
                                                                {
                                                                    "type": "call",
                                                                    "label": "threading.Thread(target=cancel_handler)",
                                                                    "start_token": 3667,
                                                                    "end_token": 3672,
                                                                    "children": [
                                                                        {
                                                                            "type": "attribute",
                                                                            "label": "threading.Thread",
                                                                            "start_token": 3667,
                                                                            "end_token": -1,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "threading",
                                                                                    "start_token": 3667,
                                                                                    "end_token": 3667,
                                                                                    "children": []
                                                                                },
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "Thread",
                                                                                    "start_token": 3668,
                                                                                    "end_token": -1,
                                                                                    "children": []
                                                                                }
                                                                            ]
                                                                        },
                                                                        {
                                                                            "type": "argument_list",
                                                                            "label": "(target=cancel_handler)",
                                                                            "start_token": -1,
                                                                            "end_token": 3672,
                                                                            "children": [
                                                                                {
                                                                                    "type": "keyword_argument",
                                                                                    "label": "target=cancel_handler",
                                                                                    "start_token": -1,
                                                                                    "end_token": 3672,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "label": "target",
                                                                                            "start_token": -1,
                                                                                            "end_token": 3670,
                                                                                            "children": []
                                                                                        },
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "label": "cancel_handler",
                                                                                            "start_token": 3670,
                                                                                            "end_token": 3672,
                                                                                            "children": []
                                                                                        }
                                                                                    ]
                                                                                }
                                                                            ]
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                },
                                                {
                                                    "type": "expression_statement",
                                                    "label": "cancel_thread.start()",
                                                    "start_token": -1,
                                                    "end_token": 3680,
                                                    "children": [
                                                        {
                                                            "type": "call",
                                                            "label": "cancel_thread.start()",
                                                            "start_token": -1,
                                                            "end_token": 3680,
                                                            "children": [
                                                                {
                                                                    "type": "attribute",
                                                                    "label": "cancel_thread.start",
                                                                    "start_token": -1,
                                                                    "end_token": -1,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "cancel_thread",
                                                                            "start_token": -1,
                                                                            "end_token": -1,
                                                                            "children": []
                                                                        },
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "start",
                                                                            "start_token": -1,
                                                                            "end_token": -1,
                                                                            "children": []
                                                                        }
                                                                    ]
                                                                },
                                                                {
                                                                    "type": "argument_list",
                                                                    "label": "()",
                                                                    "start_token": -1,
                                                                    "end_token": 3680,
                                                                    "children": []
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                },
                                                {
                                                    "type": "try_statement",
                                                    "label": "try:\n            queue = ExecutionQueue[NodeExecutionEntry]()\n            for node_exec in graph_exec.start_node_execs:\n                queue.add(node_exec)\n\n            running_executions: dict[str, AsyncResult] = {}\n\n            def make_exec_callback(exec_data: NodeExecutionEntry):\n                node_id = exec_data.node_id\n\n                def callback(result: object):\n                    running_executions.pop(node_id)\n                    nonlocal exec_stats\n                    if isinstance(result, dict):\n                        exec_stats[\"node_count\"] += 1\n                        exec_stats[\"nodes_cputime\"] += result.get(\"cputime\", 0)\n                        exec_stats[\"nodes_walltime\"] += result.get(\"walltime\", 0)\n\n                return callback\n\n            while not queue.empty():\n                if cancel.is_set():\n                    error = RuntimeError(\"Execution is cancelled\")\n                    return exec_stats, error\n\n                exec_data = queue.get()\n\n                # Avoid parallel execution of the same node.\n                execution = running_executions.get(exec_data.node_id)\n                if execution and not execution.ready():\n                    # TODO (performance improvement):\n                    #   Wait for the completion of the same node execution is blocking.\n                    #   To improve this we need a separate queue for each node.\n                    #   Re-enqueueing the data back to the queue will disrupt the order.\n                    execution.wait()\n\n                log_metadata.debug(\n                    f\"Dispatching node execution {exec_data.node_exec_id} \"\n                    f\"for node {exec_data.node_id}\",\n                )\n                running_executions[exec_data.node_id] = cls.executor.apply_async(\n                    cls.on_node_execution,\n                    (queue, exec_data),\n                    callback=make_exec_callback(exec_data),\n                )\n\n                # Avoid terminating graph execution when some nodes are still running.\n                while queue.empty() and running_executions:\n                    log_metadata.debug(\n                        f\"Queue empty; running nodes: {list(running_executions.keys())}\"\n                    )\n                    for node_id, execution in list(running_executions.items()):\n                        if cancel.is_set():\n                            error = RuntimeError(\"Execution is cancelled\")\n                            return exec_stats, error\n\n                        if not queue.empty():\n                            break  # yield to parent loop to execute new queue items\n\n                        log_metadata.debug(f\"Waiting on execution of node {node_id}\")\n                        execution.wait(3)\n\n            log_metadata.info(f\"Finished graph execution {graph_exec.graph_exec_id}\")\n        except Exception as e:\n            log_metadata.exception(\n                f\"Failed graph execution {graph_exec.graph_exec_id}: {e}\"\n            )\n            error = e\n        finally:\n            if not cancel.is_set():\n                finished = True\n                cancel.set()\n            cancel_thread.join()\n            return exec_stats, error",
                                                    "start_token": 3682,
                                                    "end_token": 4159,
                                                    "children": [
                                                        {
                                                            "type": "block",
                                                            "label": "queue = ExecutionQueue[NodeExecutionEntry]()\n            for node_exec in graph_exec.start_node_execs:\n                queue.add(node_exec)\n\n            running_executions: dict[str, AsyncResult] = {}\n\n            def make_exec_callback(exec_data: NodeExecutionEntry):\n                node_id = exec_data.node_id\n\n                def callback(result: object):\n                    running_executions.pop(node_id)\n                    nonlocal exec_stats\n                    if isinstance(result, dict):\n                        exec_stats[\"node_count\"] += 1\n                        exec_stats[\"nodes_cputime\"] += result.get(\"cputime\", 0)\n                        exec_stats[\"nodes_walltime\"] += result.get(\"walltime\", 0)\n\n                return callback\n\n            while not queue.empty():\n                if cancel.is_set():\n                    error = RuntimeError(\"Execution is cancelled\")\n                    return exec_stats, error\n\n                exec_data = queue.get()\n\n                # Avoid parallel execution of the same node.\n                execution = running_executions.get(exec_data.node_id)\n                if execution and not execution.ready():\n                    # TODO (performance improvement):\n                    #   Wait for the completion of the same node execution is blocking.\n                    #   To improve this we need a separate queue for each node.\n                    #   Re-enqueueing the data back to the queue will disrupt the order.\n                    execution.wait()\n\n                log_metadata.debug(\n                    f\"Dispatching node execution {exec_data.node_exec_id} \"\n                    f\"for node {exec_data.node_id}\",\n                )\n                running_executions[exec_data.node_id] = cls.executor.apply_async(\n                    cls.on_node_execution,\n                    (queue, exec_data),\n                    callback=make_exec_callback(exec_data),\n                )\n\n                # Avoid terminating graph execution when some nodes are still running.\n                while queue.empty() and running_executions:\n                    log_metadata.debug(\n                        f\"Queue empty; running nodes: {list(running_executions.keys())}\"\n                    )\n                    for node_id, execution in list(running_executions.items()):\n                        if cancel.is_set():\n                            error = RuntimeError(\"Execution is cancelled\")\n                            return exec_stats, error\n\n                        if not queue.empty():\n                            break  # yield to parent loop to execute new queue items\n\n                        log_metadata.debug(f\"Waiting on execution of node {node_id}\")\n                        execution.wait(3)\n\n            log_metadata.info(f\"Finished graph execution {graph_exec.graph_exec_id}\")",
                                                            "start_token": 3684,
                                                            "end_token": 4103,
                                                            "children": [
                                                                {
                                                                    "type": "expression_statement",
                                                                    "label": "queue = ExecutionQueue[NodeExecutionEntry]()",
                                                                    "start_token": 3684,
                                                                    "end_token": 3691,
                                                                    "children": [
                                                                        {
                                                                            "type": "assignment",
                                                                            "label": "queue = ExecutionQueue[NodeExecutionEntry]()",
                                                                            "start_token": 3684,
                                                                            "end_token": 3691,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "queue",
                                                                                    "start_token": 3684,
                                                                                    "end_token": 3684,
                                                                                    "children": []
                                                                                },
                                                                                {
                                                                                    "type": "call",
                                                                                    "label": "ExecutionQueue[NodeExecutionEntry]()",
                                                                                    "start_token": 3684,
                                                                                    "end_token": 3691,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "subscript",
                                                                                            "label": "ExecutionQueue[NodeExecutionEntry]",
                                                                                            "start_token": 3684,
                                                                                            "end_token": 3690,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "label": "ExecutionQueue",
                                                                                                    "start_token": 3684,
                                                                                                    "end_token": -1,
                                                                                                    "children": []
                                                                                                },
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "label": "NodeExecutionEntry",
                                                                                                    "start_token": -1,
                                                                                                    "end_token": 3690,
                                                                                                    "children": []
                                                                                                }
                                                                                            ]
                                                                                        },
                                                                                        {
                                                                                            "type": "argument_list",
                                                                                            "label": "()",
                                                                                            "start_token": -1,
                                                                                            "end_token": 3691,
                                                                                            "children": []
                                                                                        }
                                                                                    ]
                                                                                }
                                                                            ]
                                                                        }
                                                                    ]
                                                                },
                                                                {
                                                                    "type": "for_statement",
                                                                    "label": "for node_exec in graph_exec.start_node_execs:\n                queue.add(node_exec)",
                                                                    "start_token": 3694,
                                                                    "end_token": 3705,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "node_exec",
                                                                            "start_token": 3694,
                                                                            "end_token": 3694,
                                                                            "children": []
                                                                        },
                                                                        {
                                                                            "type": "attribute",
                                                                            "label": "graph_exec.start_node_execs",
                                                                            "start_token": 3696,
                                                                            "end_token": 3700,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "graph_exec",
                                                                                    "start_token": 3696,
                                                                                    "end_token": -1,
                                                                                    "children": []
                                                                                },
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "start_node_execs",
                                                                                    "start_token": -1,
                                                                                    "end_token": 3700,
                                                                                    "children": []
                                                                                }
                                                                            ]
                                                                        },
                                                                        {
                                                                            "type": "block",
                                                                            "label": "queue.add(node_exec)",
                                                                            "start_token": -1,
                                                                            "end_token": 3705,
                                                                            "children": [
                                                                                {
                                                                                    "type": "expression_statement",
                                                                                    "label": "queue.add(node_exec)",
                                                                                    "start_token": -1,
                                                                                    "end_token": 3705,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "call",
                                                                                            "label": "queue.add(node_exec)",
                                                                                            "start_token": -1,
                                                                                            "end_token": 3705,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "attribute",
                                                                                                    "label": "queue.add",
                                                                                                    "start_token": -1,
                                                                                                    "end_token": 3705,
                                                                                                    "children": [
                                                                                                        {
                                                                                                            "type": "identifier",
                                                                                                            "label": "queue",
                                                                                                            "start_token": -1,
                                                                                                            "end_token": -1,
                                                                                                            "children": []
                                                                                                        },
                                                                                                        {
                                                                                                            "type": "identifier",
                                                                                                            "label": "add",
                                                                                                            "start_token": 3705,
                                                                                                            "end_token": 3705,
                                                                                                            "children": []
                                                                                                        }
                                                                                                    ]
                                                                                                },
                                                                                                {
                                                                                                    "type": "argument_list",
                                                                                                    "label": "(node_exec)",
                                                                                                    "start_token": 3705,
                                                                                                    "end_token": 3705,
                                                                                                    "children": [
                                                                                                        {
                                                                                                            "type": "identifier",
                                                                                                            "label": "node_exec",
                                                                                                            "start_token": 3705,
                                                                                                            "end_token": 3705,
                                                                                                            "children": []
                                                                                                        }
                                                                                                    ]
                                                                                                }
                                                                                            ]
                                                                                        }
                                                                                    ]
                                                                                }
                                                                            ]
                                                                        }
                                                                    ]
                                                                },
                                                                {
                                                                    "type": "expression_statement",
                                                                    "label": "running_executions: dict[str, AsyncResult] = {}",
                                                                    "start_token": 3710,
                                                                    "end_token": 3719,
                                                                    "children": [
                                                                        {
                                                                            "type": "assignment",
                                                                            "label": "running_executions: dict[str, AsyncResult] = {}",
                                                                            "start_token": 3710,
                                                                            "end_token": 3719,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "running_executions",
                                                                                    "start_token": 3710,
                                                                                    "end_token": 3714,
                                                                                    "children": []
                                                                                },
                                                                                {
                                                                                    "type": "type",
                                                                                    "label": "dict[str, AsyncResult]",
                                                                                    "start_token": 3717,
                                                                                    "end_token": 3719,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "generic_type",
                                                                                            "label": "dict[str, AsyncResult]",
                                                                                            "start_token": 3717,
                                                                                            "end_token": 3719,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "label": "dict",
                                                                                                    "start_token": 3717,
                                                                                                    "end_token": -1,
                                                                                                    "children": []
                                                                                                },
                                                                                                {
                                                                                                    "type": "type_parameter",
                                                                                                    "label": "[str, AsyncResult]",
                                                                                                    "start_token": -1,
                                                                                                    "end_token": 3719,
                                                                                                    "children": [
                                                                                                        {
                                                                                                            "type": "type",
                                                                                                            "label": "str",
                                                                                                            "start_token": -1,
                                                                                                            "end_token": -1,
                                                                                                            "children": [
                                                                                                                {
                                                                                                                    "type": "identifier",
                                                                                                                    "label": "str",
                                                                                                                    "start_token": -1,
                                                                                                                    "end_token": -1,
                                                                                                                    "children": []
                                                                                                                }
                                                                                                            ]
                                                                                                        },
                                                                                                        {
                                                                                                            "type": "type",
                                                                                                            "label": "AsyncResult",
                                                                                                            "start_token": -1,
                                                                                                            "end_token": 3719,
                                                                                                            "children": [
                                                                                                                {
                                                                                                                    "type": "identifier",
                                                                                                                    "label": "AsyncResult",
                                                                                                                    "start_token": -1,
                                                                                                                    "end_token": 3719,
                                                                                                                    "children": []
                                                                                                                }
                                                                                                            ]
                                                                                                        }
                                                                                                    ]
                                                                                                }
                                                                                            ]
                                                                                        }
                                                                                    ]
                                                                                },
                                                                                {
                                                                                    "type": "dictionary",
                                                                                    "label": "{}",
                                                                                    "start_token": 3719,
                                                                                    "end_token": 3719,
                                                                                    "children": []
                                                                                }
                                                                            ]
                                                                        }
                                                                    ]
                                                                },
                                                                {
                                                                    "type": "function_definition",
                                                                    "label": "def make_exec_callback(exec_data: NodeExecutionEntry):\n                node_id = exec_data.node_id\n\n                def callback(result: object):\n                    running_executions.pop(node_id)\n                    nonlocal exec_stats\n                    if isinstance(result, dict):\n                        exec_stats[\"node_count\"] += 1\n                        exec_stats[\"nodes_cputime\"] += result.get(\"cputime\", 0)\n                        exec_stats[\"nodes_walltime\"] += result.get(\"walltime\", 0)\n\n                return callback",
                                                                    "start_token": 3721,
                                                                    "end_token": 3807,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "make_exec_callback",
                                                                            "start_token": 3722,
                                                                            "end_token": 3723,
                                                                            "children": []
                                                                        },
                                                                        {
                                                                            "type": "parameters",
                                                                            "label": "(exec_data: NodeExecutionEntry)",
                                                                            "start_token": 3723,
                                                                            "end_token": -1,
                                                                            "children": [
                                                                                {
                                                                                    "type": "typed_parameter",
                                                                                    "label": "exec_data: NodeExecutionEntry",
                                                                                    "start_token": 3723,
                                                                                    "end_token": 3728,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "label": "exec_data",
                                                                                            "start_token": 3723,
                                                                                            "end_token": -1,
                                                                                            "children": []
                                                                                        },
                                                                                        {
                                                                                            "type": "type",
                                                                                            "label": "NodeExecutionEntry",
                                                                                            "start_token": -1,
                                                                                            "end_token": 3728,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "label": "NodeExecutionEntry",
                                                                                                    "start_token": -1,
                                                                                                    "end_token": 3728,
                                                                                                    "children": []
                                                                                                }
                                                                                            ]
                                                                                        }
                                                                                    ]
                                                                                }
                                                                            ]
                                                                        },
                                                                        {
                                                                            "type": "block",
                                                                            "label": "node_id = exec_data.node_id\n\n                def callback(result: object):\n                    running_executions.pop(node_id)\n                    nonlocal exec_stats\n                    if isinstance(result, dict):\n                        exec_stats[\"node_count\"] += 1\n                        exec_stats[\"nodes_cputime\"] += result.get(\"cputime\", 0)\n                        exec_stats[\"nodes_walltime\"] += result.get(\"walltime\", 0)\n\n                return callback",
                                                                            "start_token": 3733,
                                                                            "end_token": 3807,
                                                                            "children": [
                                                                                {
                                                                                    "type": "expression_statement",
                                                                                    "label": "node_id = exec_data.node_id",
                                                                                    "start_token": 3733,
                                                                                    "end_token": 3735,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "assignment",
                                                                                            "label": "node_id = exec_data.node_id",
                                                                                            "start_token": 3733,
                                                                                            "end_token": 3735,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "label": "node_id",
                                                                                                    "start_token": 3733,
                                                                                                    "end_token": -1,
                                                                                                    "children": []
                                                                                                },
                                                                                                {
                                                                                                    "type": "attribute",
                                                                                                    "label": "exec_data.node_id",
                                                                                                    "start_token": -1,
                                                                                                    "end_token": 3735,
                                                                                                    "children": [
                                                                                                        {
                                                                                                            "type": "identifier",
                                                                                                            "label": "exec_data",
                                                                                                            "start_token": -1,
                                                                                                            "end_token": 3734,
                                                                                                            "children": []
                                                                                                        },
                                                                                                        {
                                                                                                            "type": "identifier",
                                                                                                            "label": "node_id",
                                                                                                            "start_token": -1,
                                                                                                            "end_token": 3735,
                                                                                                            "children": []
                                                                                                        }
                                                                                                    ]
                                                                                                }
                                                                                            ]
                                                                                        }
                                                                                    ]
                                                                                },
                                                                                {
                                                                                    "type": "function_definition",
                                                                                    "label": "def callback(result: object):\n                    running_executions.pop(node_id)\n                    nonlocal exec_stats\n                    if isinstance(result, dict):\n                        exec_stats[\"node_count\"] += 1\n                        exec_stats[\"nodes_cputime\"] += result.get(\"cputime\", 0)\n                        exec_stats[\"nodes_walltime\"] += result.get(\"walltime\", 0)",
                                                                                    "start_token": 3741,
                                                                                    "end_token": 3802,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "label": "callback",
                                                                                            "start_token": -1,
                                                                                            "end_token": -1,
                                                                                            "children": []
                                                                                        },
                                                                                        {
                                                                                            "type": "parameters",
                                                                                            "label": "(result: object)",
                                                                                            "start_token": -1,
                                                                                            "end_token": 3743,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "typed_parameter",
                                                                                                    "label": "result: object",
                                                                                                    "start_token": -1,
                                                                                                    "end_token": 3743,
                                                                                                    "children": [
                                                                                                        {
                                                                                                            "type": "identifier",
                                                                                                            "label": "result",
                                                                                                            "start_token": -1,
                                                                                                            "end_token": -1,
                                                                                                            "children": []
                                                                                                        },
                                                                                                        {
                                                                                                            "type": "type",
                                                                                                            "label": "object",
                                                                                                            "start_token": -1,
                                                                                                            "end_token": 3743,
                                                                                                            "children": [
                                                                                                                {
                                                                                                                    "type": "identifier",
                                                                                                                    "label": "object",
                                                                                                                    "start_token": -1,
                                                                                                                    "end_token": 3743,
                                                                                                                    "children": []
                                                                                                                }
                                                                                                            ]
                                                                                                        }
                                                                                                    ]
                                                                                                }
                                                                                            ]
                                                                                        },
                                                                                        {
                                                                                            "type": "block",
                                                                                            "label": "running_executions.pop(node_id)\n                    nonlocal exec_stats\n                    if isinstance(result, dict):\n                        exec_stats[\"node_count\"] += 1\n                        exec_stats[\"nodes_cputime\"] += result.get(\"cputime\", 0)\n                        exec_stats[\"nodes_walltime\"] += result.get(\"walltime\", 0)",
                                                                                            "start_token": 3747,
                                                                                            "end_token": 3802,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "expression_statement",
                                                                                                    "label": "running_executions.pop(node_id)",
                                                                                                    "start_token": 3747,
                                                                                                    "end_token": 3750,
                                                                                                    "children": [
                                                                                                        {
                                                                                                            "type": "call",
                                                                                                            "label": "running_executions.pop(node_id)",
                                                                                                            "start_token": 3747,
                                                                                                            "end_token": 3750,
                                                                                                            "children": [
                                                                                                                {
                                                                                                                    "type": "attribute",
                                                                                                                    "label": "running_executions.pop",
                                                                                                                    "start_token": 3747,
                                                                                                                    "end_token": -1,
                                                                                                                    "children": [
                                                                                                                        {
                                                                                                                            "type": "identifier",
                                                                                                                            "label": "running_executions",
                                                                                                                            "start_token": 3747,
                                                                                                                            "end_token": -1,
                                                                                                                            "children": []
                                                                                                                        },
                                                                                                                        {
                                                                                                                            "type": "identifier",
                                                                                                                            "label": "pop",
                                                                                                                            "start_token": -1,
                                                                                                                            "end_token": -1,
                                                                                                                            "children": []
                                                                                                                        }
                                                                                                                    ]
                                                                                                                },
                                                                                                                {
                                                                                                                    "type": "argument_list",
                                                                                                                    "label": "(node_id)",
                                                                                                                    "start_token": -1,
                                                                                                                    "end_token": 3750,
                                                                                                                    "children": [
                                                                                                                        {
                                                                                                                            "type": "identifier",
                                                                                                                            "label": "node_id",
                                                                                                                            "start_token": -1,
                                                                                                                            "end_token": 3750,
                                                                                                                            "children": []
                                                                                                                        }
                                                                                                                    ]
                                                                                                                }
                                                                                                            ]
                                                                                                        }
                                                                                                    ]
                                                                                                },
                                                                                                {
                                                                                                    "type": "nonlocal_statement",
                                                                                                    "label": "nonlocal exec_stats",
                                                                                                    "start_token": -1,
                                                                                                    "end_token": 3754,
                                                                                                    "children": [
                                                                                                        {
                                                                                                            "type": "identifier",
                                                                                                            "label": "exec_stats",
                                                                                                            "start_token": -1,
                                                                                                            "end_token": 3754,
                                                                                                            "children": []
                                                                                                        }
                                                                                                    ]
                                                                                                },
                                                                                                {
                                                                                                    "type": "if_statement",
                                                                                                    "label": "if isinstance(result, dict):\n                        exec_stats[\"node_count\"] += 1\n                        exec_stats[\"nodes_cputime\"] += result.get(\"cputime\", 0)\n                        exec_stats[\"nodes_walltime\"] += result.get(\"walltime\", 0)",
                                                                                                    "start_token": 3761,
                                                                                                    "end_token": 3802,
                                                                                                    "children": [
                                                                                                        {
                                                                                                            "type": "call",
                                                                                                            "label": "isinstance(result, dict)",
                                                                                                            "start_token": -1,
                                                                                                            "end_token": 3762,
                                                                                                            "children": [
                                                                                                                {
                                                                                                                    "type": "identifier",
                                                                                                                    "label": "isinstance",
                                                                                                                    "start_token": -1,
                                                                                                                    "end_token": -1,
                                                                                                                    "children": []
                                                                                                                },
                                                                                                                {
                                                                                                                    "type": "argument_list",
                                                                                                                    "label": "(result, dict)",
                                                                                                                    "start_token": -1,
                                                                                                                    "end_token": 3762,
                                                                                                                    "children": [
                                                                                                                        {
                                                                                                                            "type": "identifier",
                                                                                                                            "label": "result",
                                                                                                                            "start_token": -1,
                                                                                                                            "end_token": -1,
                                                                                                                            "children": []
                                                                                                                        },
                                                                                                                        {
                                                                                                                            "type": "identifier",
                                                                                                                            "label": "dict",
                                                                                                                            "start_token": -1,
                                                                                                                            "end_token": 3762,
                                                                                                                            "children": []
                                                                                                                        }
                                                                                                                    ]
                                                                                                                }
                                                                                                            ]
                                                                                                        },
                                                                                                        {
                                                                                                            "type": "block",
                                                                                                            "label": "exec_stats[\"node_count\"] += 1\n                        exec_stats[\"nodes_cputime\"] += result.get(\"cputime\", 0)\n                        exec_stats[\"nodes_walltime\"] += result.get(\"walltime\", 0)",
                                                                                                            "start_token": 3768,
                                                                                                            "end_token": 3802,
                                                                                                            "children": [
                                                                                                                {
                                                                                                                    "type": "expression_statement",
                                                                                                                    "label": "exec_stats[\"node_count\"] += 1",
                                                                                                                    "start_token": 3768,
                                                                                                                    "end_token": 3770,
                                                                                                                    "children": [
                                                                                                                        {
                                                                                                                            "type": "augmented_assignment",
                                                                                                                            "label": "exec_stats[\"node_count\"] += 1",
                                                                                                                            "start_token": 3768,
                                                                                                                            "end_token": 3770,
                                                                                                                            "children": [
                                                                                                                                {
                                                                                                                                    "type": "subscript",
                                                                                                                                    "label": "exec_stats[\"node_count\"]",
                                                                                                                                    "start_token": 3768,
                                                                                                                                    "end_token": -1,
                                                                                                                                    "children": [
                                                                                                                                        {
                                                                                                                                            "type": "identifier",
                                                                                                                                            "label": "exec_stats",
                                                                                                                                            "start_token": 3768,
                                                                                                                                            "end_token": -1,
                                                                                                                                            "children": []
                                                                                                                                        },
                                                                                                                                        {
                                                                                                                                            "type": "string",
                                                                                                                                            "label": "\"node_count\"",
                                                                                                                                            "start_token": -1,
                                                                                                                                            "end_token": -1,
                                                                                                                                            "children": [
                                                                                                                                                {
                                                                                                                                                    "type": "string_start",
                                                                                                                                                    "label": "\"",
                                                                                                                                                    "start_token": -1,
                                                                                                                                                    "end_token": -1,
                                                                                                                                                    "children": []
                                                                                                                                                },
                                                                                                                                                {
                                                                                                                                                    "type": "string_content",
                                                                                                                                                    "label": "node_count",
                                                                                                                                                    "start_token": -1,
                                                                                                                                                    "end_token": -1,
                                                                                                                                                    "children": []
                                                                                                                                                },
                                                                                                                                                {
                                                                                                                                                    "type": "string_end",
                                                                                                                                                    "label": "\"",
                                                                                                                                                    "start_token": -1,
                                                                                                                                                    "end_token": -1,
                                                                                                                                                    "children": []
                                                                                                                                                }
                                                                                                                                            ]
                                                                                                                                        }
                                                                                                                                    ]
                                                                                                                                },
                                                                                                                                {
                                                                                                                                    "type": "integer",
                                                                                                                                    "label": "1",
                                                                                                                                    "start_token": 3770,
                                                                                                                                    "end_token": 3770,
                                                                                                                                    "children": []
                                                                                                                                }
                                                                                                                            ]
                                                                                                                        }
                                                                                                                    ]
                                                                                                                },
                                                                                                                {
                                                                                                                    "type": "expression_statement",
                                                                                                                    "label": "exec_stats[\"nodes_cputime\"] += result.get(\"cputime\", 0)",
                                                                                                                    "start_token": 3774,
                                                                                                                    "end_token": 3785,
                                                                                                                    "children": [
                                                                                                                        {
                                                                                                                            "type": "augmented_assignment",
                                                                                                                            "label": "exec_stats[\"nodes_cputime\"] += result.get(\"cputime\", 0)",
                                                                                                                            "start_token": 3774,
                                                                                                                            "end_token": 3785,
                                                                                                                            "children": [
                                                                                                                                {
                                                                                                                                    "type": "subscript",
                                                                                                                                    "label": "exec_stats[\"nodes_cputime\"]",
                                                                                                                                    "start_token": 3774,
                                                                                                                                    "end_token": 3783,
                                                                                                                                    "children": [
                                                                                                                                        {
                                                                                                                                            "type": "identifier",
                                                                                                                                            "label": "exec_stats",
                                                                                                                                            "start_token": 3774,
                                                                                                                                            "end_token": 3777,
                                                                                                                                            "children": []
                                                                                                                                        },
                                                                                                                                        {
                                                                                                                                            "type": "string",
                                                                                                                                            "label": "\"nodes_cputime\"",
                                                                                                                                            "start_token": 3778,
                                                                                                                                            "end_token": 3782,
                                                                                                                                            "children": [
                                                                                                                                                {
                                                                                                                                                    "type": "string_start",
                                                                                                                                                    "label": "\"",
                                                                                                                                                    "start_token": 3778,
                                                                                                                                                    "end_token": 3778,
                                                                                                                                                    "children": []
                                                                                                                                                },
                                                                                                                                                {
                                                                                                                                                    "type": "string_content",
                                                                                                                                                    "label": "nodes_cputime",
                                                                                                                                                    "start_token": 3778,
                                                                                                                                                    "end_token": -1,
                                                                                                                                                    "children": []
                                                                                                                                                },
                                                                                                                                                {
                                                                                                                                                    "type": "string_end",
                                                                                                                                                    "label": "\"",
                                                                                                                                                    "start_token": 3782,
                                                                                                                                                    "end_token": 3782,
                                                                                                                                                    "children": []
                                                                                                                                                }
                                                                                                                                            ]
                                                                                                                                        }
                                                                                                                                    ]
                                                                                                                                },
                                                                                                                                {
                                                                                                                                    "type": "call",
                                                                                                                                    "label": "result.get(\"cputime\", 0)",
                                                                                                                                    "start_token": -1,
                                                                                                                                    "end_token": 3785,
                                                                                                                                    "children": [
                                                                                                                                        {
                                                                                                                                            "type": "attribute",
                                                                                                                                            "label": "result.get",
                                                                                                                                            "start_token": -1,
                                                                                                                                            "end_token": -1,
                                                                                                                                            "children": [
                                                                                                                                                {
                                                                                                                                                    "type": "identifier",
                                                                                                                                                    "label": "result",
                                                                                                                                                    "start_token": -1,
                                                                                                                                                    "end_token": -1,
                                                                                                                                                    "children": []
                                                                                                                                                },
                                                                                                                                                {
                                                                                                                                                    "type": "identifier",
                                                                                                                                                    "label": "get",
                                                                                                                                                    "start_token": -1,
                                                                                                                                                    "end_token": -1,
                                                                                                                                                    "children": []
                                                                                                                                                }
                                                                                                                                            ]
                                                                                                                                        },
                                                                                                                                        {
                                                                                                                                            "type": "argument_list",
                                                                                                                                            "label": "(\"cputime\", 0)",
                                                                                                                                            "start_token": -1,
                                                                                                                                            "end_token": 3785,
                                                                                                                                            "children": [
                                                                                                                                                {
                                                                                                                                                    "type": "string",
                                                                                                                                                    "label": "\"cputime\"",
                                                                                                                                                    "start_token": -1,
                                                                                                                                                    "end_token": -1,
                                                                                                                                                    "children": [
                                                                                                                                                        {
                                                                                                                                                            "type": "string_start",
                                                                                                                                                            "label": "\"",
                                                                                                                                                            "start_token": -1,
                                                                                                                                                            "end_token": -1,
                                                                                                                                                            "children": []
                                                                                                                                                        },
                                                                                                                                                        {
                                                                                                                                                            "type": "string_content",
                                                                                                                                                            "label": "cputime",
                                                                                                                                                            "start_token": -1,
                                                                                                                                                            "end_token": -1,
                                                                                                                                                            "children": []
                                                                                                                                                        },
                                                                                                                                                        {
                                                                                                                                                            "type": "string_end",
                                                                                                                                                            "label": "\"",
                                                                                                                                                            "start_token": -1,
                                                                                                                                                            "end_token": -1,
                                                                                                                                                            "children": []
                                                                                                                                                        }
                                                                                                                                                    ]
                                                                                                                                                },
                                                                                                                                                {
                                                                                                                                                    "type": "integer",
                                                                                                                                                    "label": "0",
                                                                                                                                                    "start_token": 3785,
                                                                                                                                                    "end_token": 3785,
                                                                                                                                                    "children": []
                                                                                                                                                }
                                                                                                                                            ]
                                                                                                                                        }
                                                                                                                                    ]
                                                                                                                                }
                                                                                                                            ]
                                                                                                                        }
                                                                                                                    ]
                                                                                                                },
                                                                                                                {
                                                                                                                    "type": "expression_statement",
                                                                                                                    "label": "exec_stats[\"nodes_walltime\"] += result.get(\"walltime\", 0)",
                                                                                                                    "start_token": -1,
                                                                                                                    "end_token": 3802,
                                                                                                                    "children": [
                                                                                                                        {
                                                                                                                            "type": "augmented_assignment",
                                                                                                                            "label": "exec_stats[\"nodes_walltime\"] += result.get(\"walltime\", 0)",
                                                                                                                            "start_token": -1,
                                                                                                                            "end_token": 3802,
                                                                                                                            "children": [
                                                                                                                                {
                                                                                                                                    "type": "subscript",
                                                                                                                                    "label": "exec_stats[\"nodes_walltime\"]",
                                                                                                                                    "start_token": -1,
                                                                                                                                    "end_token": 3797,
                                                                                                                                    "children": [
                                                                                                                                        {
                                                                                                                                            "type": "identifier",
                                                                                                                                            "label": "exec_stats",
                                                                                                                                            "start_token": -1,
                                                                                                                                            "end_token": 3791,
                                                                                                                                            "children": []
                                                                                                                                        },
                                                                                                                                        {
                                                                                                                                            "type": "string",
                                                                                                                                            "label": "\"nodes_walltime\"",
                                                                                                                                            "start_token": 3793,
                                                                                                                                            "end_token": -1,
                                                                                                                                            "children": [
                                                                                                                                                {
                                                                                                                                                    "type": "string_start",
                                                                                                                                                    "label": "\"",
                                                                                                                                                    "start_token": 3793,
                                                                                                                                                    "end_token": 3793,
                                                                                                                                                    "children": []
                                                                                                                                                },
                                                                                                                                                {
                                                                                                                                                    "type": "string_content",
                                                                                                                                                    "label": "nodes_walltime",
                                                                                                                                                    "start_token": 3793,
                                                                                                                                                    "end_token": 3796,
                                                                                                                                                    "children": []
                                                                                                                                                },
                                                                                                                                                {
                                                                                                                                                    "type": "string_end",
                                                                                                                                                    "label": "\"",
                                                                                                                                                    "start_token": -1,
                                                                                                                                                    "end_token": -1,
                                                                                                                                                    "children": []
                                                                                                                                                }
                                                                                                                                            ]
                                                                                                                                        }
                                                                                                                                    ]
                                                                                                                                },
                                                                                                                                {
                                                                                                                                    "type": "call",
                                                                                                                                    "label": "result.get(\"walltime\", 0)",
                                                                                                                                    "start_token": -1,
                                                                                                                                    "end_token": 3802,
                                                                                                                                    "children": [
                                                                                                                                        {
                                                                                                                                            "type": "attribute",
                                                                                                                                            "label": "result.get",
                                                                                                                                            "start_token": -1,
                                                                                                                                            "end_token": -1,
                                                                                                                                            "children": [
                                                                                                                                                {
                                                                                                                                                    "type": "identifier",
                                                                                                                                                    "label": "result",
                                                                                                                                                    "start_token": -1,
                                                                                                                                                    "end_token": -1,
                                                                                                                                                    "children": []
                                                                                                                                                },
                                                                                                                                                {
                                                                                                                                                    "type": "identifier",
                                                                                                                                                    "label": "get",
                                                                                                                                                    "start_token": -1,
                                                                                                                                                    "end_token": -1,
                                                                                                                                                    "children": []
                                                                                                                                                }
                                                                                                                                            ]
                                                                                                                                        },
                                                                                                                                        {
                                                                                                                                            "type": "argument_list",
                                                                                                                                            "label": "(\"walltime\", 0)",
                                                                                                                                            "start_token": -1,
                                                                                                                                            "end_token": 3802,
                                                                                                                                            "children": [
                                                                                                                                                {
                                                                                                                                                    "type": "string",
                                                                                                                                                    "label": "\"walltime\"",
                                                                                                                                                    "start_token": -1,
                                                                                                                                                    "end_token": 3801,
                                                                                                                                                    "children": [
                                                                                                                                                        {
                                                                                                                                                            "type": "string_start",
                                                                                                                                                            "label": "\"",
                                                                                                                                                            "start_token": -1,
                                                                                                                                                            "end_token": -1,
                                                                                                                                                            "children": []
                                                                                                                                                        },
                                                                                                                                                        {
                                                                                                                                                            "type": "string_content",
                                                                                                                                                            "label": "walltime",
                                                                                                                                                            "start_token": -1,
                                                                                                                                                            "end_token": 3801,
                                                                                                                                                            "children": []
                                                                                                                                                        },
                                                                                                                                                        {
                                                                                                                                                            "type": "string_end",
                                                                                                                                                            "label": "\"",
                                                                                                                                                            "start_token": 3801,
                                                                                                                                                            "end_token": 3801,
                                                                                                                                                            "children": []
                                                                                                                                                        }
                                                                                                                                                    ]
                                                                                                                                                },
                                                                                                                                                {
                                                                                                                                                    "type": "integer",
                                                                                                                                                    "label": "0",
                                                                                                                                                    "start_token": 3802,
                                                                                                                                                    "end_token": 3802,
                                                                                                                                                    "children": []
                                                                                                                                                }
                                                                                                                                            ]
                                                                                                                                        }
                                                                                                                                    ]
                                                                                                                                }
                                                                                                                            ]
                                                                                                                        }
                                                                                                                    ]
                                                                                                                }
                                                                                                            ]
                                                                                                        }
                                                                                                    ]
                                                                                                }
                                                                                            ]
                                                                                        }
                                                                                    ]
                                                                                },
                                                                                {
                                                                                    "type": "return_statement",
                                                                                    "label": "return callback",
                                                                                    "start_token": -1,
                                                                                    "end_token": 3807,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "label": "callback",
                                                                                            "start_token": 3806,
                                                                                            "end_token": 3807,
                                                                                            "children": []
                                                                                        }
                                                                                    ]
                                                                                }
                                                                            ]
                                                                        }
                                                                    ]
                                                                },
                                                                {
                                                                    "type": "while_statement",
                                                                    "label": "while not queue.empty():\n                if cancel.is_set():\n                    error = RuntimeError(\"Execution is cancelled\")\n                    return exec_stats, error\n\n                exec_data = queue.get()\n\n                # Avoid parallel execution of the same node.\n                execution = running_executions.get(exec_data.node_id)\n                if execution and not execution.ready():\n                    # TODO (performance improvement):\n                    #   Wait for the completion of the same node execution is blocking.\n                    #   To improve this we need a separate queue for each node.\n                    #   Re-enqueueing the data back to the queue will disrupt the order.\n                    execution.wait()\n\n                log_metadata.debug(\n                    f\"Dispatching node execution {exec_data.node_exec_id} \"\n                    f\"for node {exec_data.node_id}\",\n                )\n                running_executions[exec_data.node_id] = cls.executor.apply_async(\n                    cls.on_node_execution,\n                    (queue, exec_data),\n                    callback=make_exec_callback(exec_data),\n                )\n\n                # Avoid terminating graph execution when some nodes are still running.\n                while queue.empty() and running_executions:\n                    log_metadata.debug(\n                        f\"Queue empty; running nodes: {list(running_executions.keys())}\"\n                    )\n                    for node_id, execution in list(running_executions.items()):\n                        if cancel.is_set():\n                            error = RuntimeError(\"Execution is cancelled\")\n                            return exec_stats, error\n\n                        if not queue.empty():\n                            break  # yield to parent loop to execute new queue items\n\n                        log_metadata.debug(f\"Waiting on execution of node {node_id}\")\n                        execution.wait(3)",
                                                                    "start_token": -1,
                                                                    "end_token": 4095,
                                                                    "children": [
                                                                        {
                                                                            "type": "not_operator",
                                                                            "label": "not queue.empty()",
                                                                            "start_token": -1,
                                                                            "end_token": 3816,
                                                                            "children": [
                                                                                {
                                                                                    "type": "call",
                                                                                    "label": "queue.empty()",
                                                                                    "start_token": -1,
                                                                                    "end_token": 3816,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "attribute",
                                                                                            "label": "queue.empty",
                                                                                            "start_token": -1,
                                                                                            "end_token": 3815,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "label": "queue",
                                                                                                    "start_token": -1,
                                                                                                    "end_token": 3814,
                                                                                                    "children": []
                                                                                                },
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "label": "empty",
                                                                                                    "start_token": 3815,
                                                                                                    "end_token": 3815,
                                                                                                    "children": []
                                                                                                }
                                                                                            ]
                                                                                        },
                                                                                        {
                                                                                            "type": "argument_list",
                                                                                            "label": "()",
                                                                                            "start_token": 3815,
                                                                                            "end_token": 3816,
                                                                                            "children": []
                                                                                        }
                                                                                    ]
                                                                                }
                                                                            ]
                                                                        },
                                                                        {
                                                                            "type": "block",
                                                                            "label": "if cancel.is_set():\n                    error = RuntimeError(\"Execution is cancelled\")\n                    return exec_stats, error\n\n                exec_data = queue.get()\n\n                # Avoid parallel execution of the same node.\n                execution = running_executions.get(exec_data.node_id)\n                if execution and not execution.ready():\n                    # TODO (performance improvement):\n                    #   Wait for the completion of the same node execution is blocking.\n                    #   To improve this we need a separate queue for each node.\n                    #   Re-enqueueing the data back to the queue will disrupt the order.\n                    execution.wait()\n\n                log_metadata.debug(\n                    f\"Dispatching node execution {exec_data.node_exec_id} \"\n                    f\"for node {exec_data.node_id}\",\n                )\n                running_executions[exec_data.node_id] = cls.executor.apply_async(\n                    cls.on_node_execution,\n                    (queue, exec_data),\n                    callback=make_exec_callback(exec_data),\n                )\n\n                # Avoid terminating graph execution when some nodes are still running.\n                while queue.empty() and running_executions:\n                    log_metadata.debug(\n                        f\"Queue empty; running nodes: {list(running_executions.keys())}\"\n                    )\n                    for node_id, execution in list(running_executions.items()):\n                        if cancel.is_set():\n                            error = RuntimeError(\"Execution is cancelled\")\n                            return exec_stats, error\n\n                        if not queue.empty():\n                            break  # yield to parent loop to execute new queue items\n\n                        log_metadata.debug(f\"Waiting on execution of node {node_id}\")\n                        execution.wait(3)",
                                                                            "start_token": -1,
                                                                            "end_token": 4095,
                                                                            "children": [
                                                                                {
                                                                                    "type": "if_statement",
                                                                                    "label": "if cancel.is_set():\n                    error = RuntimeError(\"Execution is cancelled\")\n                    return exec_stats, error",
                                                                                    "start_token": -1,
                                                                                    "end_token": -1,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "call",
                                                                                            "label": "cancel.is_set()",
                                                                                            "start_token": -1,
                                                                                            "end_token": -1,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "attribute",
                                                                                                    "label": "cancel.is_set",
                                                                                                    "start_token": -1,
                                                                                                    "end_token": 3822,
                                                                                                    "children": [
                                                                                                        {
                                                                                                            "type": "identifier",
                                                                                                            "label": "cancel",
                                                                                                            "start_token": -1,
                                                                                                            "end_token": -1,
                                                                                                            "children": []
                                                                                                        },
                                                                                                        {
                                                                                                            "type": "identifier",
                                                                                                            "label": "is_set",
                                                                                                            "start_token": -1,
                                                                                                            "end_token": 3822,
                                                                                                            "children": []
                                                                                                        }
                                                                                                    ]
                                                                                                },
                                                                                                {
                                                                                                    "type": "argument_list",
                                                                                                    "label": "()",
                                                                                                    "start_token": 3822,
                                                                                                    "end_token": -1,
                                                                                                    "children": []
                                                                                                }
                                                                                            ]
                                                                                        },
                                                                                        {
                                                                                            "type": "block",
                                                                                            "label": "error = RuntimeError(\"Execution is cancelled\")\n                    return exec_stats, error",
                                                                                            "start_token": 3826,
                                                                                            "end_token": -1,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "expression_statement",
                                                                                                    "label": "error = RuntimeError(\"Execution is cancelled\")",
                                                                                                    "start_token": 3826,
                                                                                                    "end_token": -1,
                                                                                                    "children": [
                                                                                                        {
                                                                                                            "type": "assignment",
                                                                                                            "label": "error = RuntimeError(\"Execution is cancelled\")",
                                                                                                            "start_token": 3826,
                                                                                                            "end_token": -1,
                                                                                                            "children": [
                                                                                                                {
                                                                                                                    "type": "identifier",
                                                                                                                    "label": "error",
                                                                                                                    "start_token": 3826,
                                                                                                                    "end_token": 3826,
                                                                                                                    "children": []
                                                                                                                },
                                                                                                                {
                                                                                                                    "type": "call",
                                                                                                                    "label": "RuntimeError(\"Execution is cancelled\")",
                                                                                                                    "start_token": 3826,
                                                                                                                    "end_token": -1,
                                                                                                                    "children": [
                                                                                                                        {
                                                                                                                            "type": "identifier",
                                                                                                                            "label": "RuntimeError",
                                                                                                                            "start_token": 3826,
                                                                                                                            "end_token": -1,
                                                                                                                            "children": []
                                                                                                                        },
                                                                                                                        {
                                                                                                                            "type": "argument_list",
                                                                                                                            "label": "(\"Execution is cancelled\")",
                                                                                                                            "start_token": -1,
                                                                                                                            "end_token": -1,
                                                                                                                            "children": [
                                                                                                                                {
                                                                                                                                    "type": "string",
                                                                                                                                    "label": "\"Execution is cancelled\"",
                                                                                                                                    "start_token": -1,
                                                                                                                                    "end_token": 3829,
                                                                                                                                    "children": [
                                                                                                                                        {
                                                                                                                                            "type": "string_start",
                                                                                                                                            "label": "\"",
                                                                                                                                            "start_token": -1,
                                                                                                                                            "end_token": -1,
                                                                                                                                            "children": []
                                                                                                                                        },
                                                                                                                                        {
                                                                                                                                            "type": "string_content",
                                                                                                                                            "label": "Execution is cancelled",
                                                                                                                                            "start_token": -1,
                                                                                                                                            "end_token": 3829,
                                                                                                                                            "children": []
                                                                                                                                        },
                                                                                                                                        {
                                                                                                                                            "type": "string_end",
                                                                                                                                            "label": "\"",
                                                                                                                                            "start_token": 3829,
                                                                                                                                            "end_token": 3829,
                                                                                                                                            "children": []
                                                                                                                                        }
                                                                                                                                    ]
                                                                                                                                }
                                                                                                                            ]
                                                                                                                        }
                                                                                                                    ]
                                                                                                                }
                                                                                                            ]
                                                                                                        }
                                                                                                    ]
                                                                                                },
                                                                                                {
                                                                                                    "type": "return_statement",
                                                                                                    "label": "return exec_stats, error",
                                                                                                    "start_token": -1,
                                                                                                    "end_token": -1,
                                                                                                    "children": [
                                                                                                        {
                                                                                                            "type": "expression_list",
                                                                                                            "label": "exec_stats, error",
                                                                                                            "start_token": -1,
                                                                                                            "end_token": -1,
                                                                                                            "children": [
                                                                                                                {
                                                                                                                    "type": "identifier",
                                                                                                                    "label": "exec_stats",
                                                                                                                    "start_token": -1,
                                                                                                                    "end_token": 3835,
                                                                                                                    "children": []
                                                                                                                },
                                                                                                                {
                                                                                                                    "type": "identifier",
                                                                                                                    "label": "error",
                                                                                                                    "start_token": 3835,
                                                                                                                    "end_token": -1,
                                                                                                                    "children": []
                                                                                                                }
                                                                                                            ]
                                                                                                        }
                                                                                                    ]
                                                                                                }
                                                                                            ]
                                                                                        }
                                                                                    ]
                                                                                },
                                                                                {
                                                                                    "type": "expression_statement",
                                                                                    "label": "exec_data = queue.get()",
                                                                                    "start_token": -1,
                                                                                    "end_token": 3846,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "assignment",
                                                                                            "label": "exec_data = queue.get()",
                                                                                            "start_token": -1,
                                                                                            "end_token": 3846,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "label": "exec_data",
                                                                                                    "start_token": -1,
                                                                                                    "end_token": -1,
                                                                                                    "children": []
                                                                                                },
                                                                                                {
                                                                                                    "type": "call",
                                                                                                    "label": "queue.get()",
                                                                                                    "start_token": -1,
                                                                                                    "end_token": 3846,
                                                                                                    "children": [
                                                                                                        {
                                                                                                            "type": "attribute",
                                                                                                            "label": "queue.get",
                                                                                                            "start_token": -1,
                                                                                                            "end_token": -1,
                                                                                                            "children": [
                                                                                                                {
                                                                                                                    "type": "identifier",
                                                                                                                    "label": "queue",
                                                                                                                    "start_token": -1,
                                                                                                                    "end_token": 3845,
                                                                                                                    "children": []
                                                                                                                },
                                                                                                                {
                                                                                                                    "type": "identifier",
                                                                                                                    "label": "get",
                                                                                                                    "start_token": 3845,
                                                                                                                    "end_token": -1,
                                                                                                                    "children": []
                                                                                                                }
                                                                                                            ]
                                                                                                        },
                                                                                                        {
                                                                                                            "type": "argument_list",
                                                                                                            "label": "()",
                                                                                                            "start_token": 3846,
                                                                                                            "end_token": 3846,
                                                                                                            "children": []
                                                                                                        }
                                                                                                    ]
                                                                                                }
                                                                                            ]
                                                                                        }
                                                                                    ]
                                                                                },
                                                                                {
                                                                                    "type": "comment",
                                                                                    "label": "# Avoid parallel execution of the same node.",
                                                                                    "start_token": 3848,
                                                                                    "end_token": 3855,
                                                                                    "children": []
                                                                                },
                                                                                {
                                                                                    "type": "expression_statement",
                                                                                    "label": "execution = running_executions.get(exec_data.node_id)",
                                                                                    "start_token": 3856,
                                                                                    "end_token": 3866,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "assignment",
                                                                                            "label": "execution = running_executions.get(exec_data.node_id)",
                                                                                            "start_token": 3856,
                                                                                            "end_token": 3866,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "label": "execution",
                                                                                                    "start_token": 3856,
                                                                                                    "end_token": 3860,
                                                                                                    "children": []
                                                                                                },
                                                                                                {
                                                                                                    "type": "call",
                                                                                                    "label": "running_executions.get(exec_data.node_id)",
                                                                                                    "start_token": 3860,
                                                                                                    "end_token": 3866,
                                                                                                    "children": [
                                                                                                        {
                                                                                                            "type": "attribute",
                                                                                                            "label": "running_executions.get",
                                                                                                            "start_token": 3860,
                                                                                                            "end_token": -1,
                                                                                                            "children": [
                                                                                                                {
                                                                                                                    "type": "identifier",
                                                                                                                    "label": "running_executions",
                                                                                                                    "start_token": 3860,
                                                                                                                    "end_token": -1,
                                                                                                                    "children": []
                                                                                                                },
                                                                                                                {
                                                                                                                    "type": "identifier",
                                                                                                                    "label": "get",
                                                                                                                    "start_token": -1,
                                                                                                                    "end_token": -1,
                                                                                                                    "children": []
                                                                                                                }
                                                                                                            ]
                                                                                                        },
                                                                                                        {
                                                                                                            "type": "argument_list",
                                                                                                            "label": "(exec_data.node_id)",
                                                                                                            "start_token": -1,
                                                                                                            "end_token": 3866,
                                                                                                            "children": [
                                                                                                                {
                                                                                                                    "type": "attribute",
                                                                                                                    "label": "exec_data.node_id",
                                                                                                                    "start_token": -1,
                                                                                                                    "end_token": 3866,
                                                                                                                    "children": [
                                                                                                                        {
                                                                                                                            "type": "identifier",
                                                                                                                            "label": "exec_data",
                                                                                                                            "start_token": -1,
                                                                                                                            "end_token": 3865,
                                                                                                                            "children": []
                                                                                                                        },
                                                                                                                        {
                                                                                                                            "type": "identifier",
                                                                                                                            "label": "node_id",
                                                                                                                            "start_token": 3866,
                                                                                                                            "end_token": 3866,
                                                                                                                            "children": []
                                                                                                                        }
                                                                                                                    ]
                                                                                                                }
                                                                                                            ]
                                                                                                        }
                                                                                                    ]
                                                                                                }
                                                                                            ]
                                                                                        }
                                                                                    ]
                                                                                },
                                                                                {
                                                                                    "type": "if_statement",
                                                                                    "label": "if execution and not execution.ready():\n                    # TODO (performance improvement):\n                    #   Wait for the completion of the same node execution is blocking.\n                    #   To improve this we need a separate queue for each node.\n                    #   Re-enqueueing the data back to the queue will disrupt the order.\n                    execution.wait()",
                                                                                    "start_token": 3869,
                                                                                    "end_token": 3935,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "boolean_operator",
                                                                                            "label": "execution and not execution.ready()",
                                                                                            "start_token": 3871,
                                                                                            "end_token": 3877,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "label": "execution",
                                                                                                    "start_token": 3871,
                                                                                                    "end_token": 3875,
                                                                                                    "children": []
                                                                                                },
                                                                                                {
                                                                                                    "type": "not_operator",
                                                                                                    "label": "not execution.ready()",
                                                                                                    "start_token": -1,
                                                                                                    "end_token": 3877,
                                                                                                    "children": [
                                                                                                        {
                                                                                                            "type": "call",
                                                                                                            "label": "execution.ready()",
                                                                                                            "start_token": -1,
                                                                                                            "end_token": 3877,
                                                                                                            "children": [
                                                                                                                {
                                                                                                                    "type": "attribute",
                                                                                                                    "label": "execution.ready",
                                                                                                                    "start_token": -1,
                                                                                                                    "end_token": 3877,
                                                                                                                    "children": [
                                                                                                                        {
                                                                                                                            "type": "identifier",
                                                                                                                            "label": "execution",
                                                                                                                            "start_token": -1,
                                                                                                                            "end_token": -1,
                                                                                                                            "children": []
                                                                                                                        },
                                                                                                                        {
                                                                                                                            "type": "identifier",
                                                                                                                            "label": "ready",
                                                                                                                            "start_token": -1,
                                                                                                                            "end_token": 3877,
                                                                                                                            "children": []
                                                                                                                        }
                                                                                                                    ]
                                                                                                                },
                                                                                                                {
                                                                                                                    "type": "argument_list",
                                                                                                                    "label": "()",
                                                                                                                    "start_token": 3877,
                                                                                                                    "end_token": 3877,
                                                                                                                    "children": []
                                                                                                                }
                                                                                                            ]
                                                                                                        }
                                                                                                    ]
                                                                                                }
                                                                                            ]
                                                                                        },
                                                                                        {
                                                                                            "type": "comment",
                                                                                            "label": "# TODO (performance improvement):",
                                                                                            "start_token": 3880,
                                                                                            "end_token": 3885,
                                                                                            "children": []
                                                                                        },
                                                                                        {
                                                                                            "type": "comment",
                                                                                            "label": "#   Wait for the completion of the same node execution is blocking.",
                                                                                            "start_token": 3889,
                                                                                            "end_token": -1,
                                                                                            "children": []
                                                                                        },
                                                                                        {
                                                                                            "type": "comment",
                                                                                            "label": "#   To improve this we need a separate queue for each node.",
                                                                                            "start_token": 3904,
                                                                                            "end_token": 3914,
                                                                                            "children": []
                                                                                        },
                                                                                        {
                                                                                            "type": "comment",
                                                                                            "label": "#   Re-enqueueing the data back to the queue will disrupt the order.",
                                                                                            "start_token": 3918,
                                                                                            "end_token": 3928,
                                                                                            "children": []
                                                                                        },
                                                                                        {
                                                                                            "type": "block",
                                                                                            "label": "execution.wait()",
                                                                                            "start_token": -1,
                                                                                            "end_token": 3935,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "expression_statement",
                                                                                                    "label": "execution.wait()",
                                                                                                    "start_token": -1,
                                                                                                    "end_token": 3935,
                                                                                                    "children": [
                                                                                                        {
                                                                                                            "type": "call",
                                                                                                            "label": "execution.wait()",
                                                                                                            "start_token": -1,
                                                                                                            "end_token": 3935,
                                                                                                            "children": [
                                                                                                                {
                                                                                                                    "type": "attribute",
                                                                                                                    "label": "execution.wait",
                                                                                                                    "start_token": -1,
                                                                                                                    "end_token": 3935,
                                                                                                                    "children": [
                                                                                                                        {
                                                                                                                            "type": "identifier",
                                                                                                                            "label": "execution",
                                                                                                                            "start_token": -1,
                                                                                                                            "end_token": 3935,
                                                                                                                            "children": []
                                                                                                                        },
                                                                                                                        {
                                                                                                                            "type": "identifier",
                                                                                                                            "label": "wait",
                                                                                                                            "start_token": 3935,
                                                                                                                            "end_token": 3935,
                                                                                                                            "children": []
                                                                                                                        }
                                                                                                                    ]
                                                                                                                },
                                                                                                                {
                                                                                                                    "type": "argument_list",
                                                                                                                    "label": "()",
                                                                                                                    "start_token": 3935,
                                                                                                                    "end_token": 3935,
                                                                                                                    "children": []
                                                                                                                }
                                                                                                            ]
                                                                                                        }
                                                                                                    ]
                                                                                                }
                                                                                            ]
                                                                                        }
                                                                                    ]
                                                                                },
                                                                                {
                                                                                    "type": "expression_statement",
                                                                                    "label": "log_metadata.debug(\n                    f\"Dispatching node execution {exec_data.node_exec_id} \"\n                    f\"for node {exec_data.node_id}\",\n                )",
                                                                                    "start_token": -1,
                                                                                    "end_token": 3949,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "call",
                                                                                            "label": "log_metadata.debug(\n                    f\"Dispatching node execution {exec_data.node_exec_id} \"\n                    f\"for node {exec_data.node_id}\",\n                )",
                                                                                            "start_token": -1,
                                                                                            "end_token": 3949,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "attribute",
                                                                                                    "label": "log_metadata.debug",
                                                                                                    "start_token": -1,
                                                                                                    "end_token": 3941,
                                                                                                    "children": [
                                                                                                        {
                                                                                                            "type": "identifier",
                                                                                                            "label": "log_metadata",
                                                                                                            "start_token": -1,
                                                                                                            "end_token": -1,
                                                                                                            "children": []
                                                                                                        },
                                                                                                        {
                                                                                                            "type": "identifier",
                                                                                                            "label": "debug",
                                                                                                            "start_token": 3941,
                                                                                                            "end_token": 3941,
                                                                                                            "children": []
                                                                                                        }
                                                                                                    ]
                                                                                                },
                                                                                                {
                                                                                                    "type": "argument_list",
                                                                                                    "label": "(\n                    f\"Dispatching node execution {exec_data.node_exec_id} \"\n                    f\"for node {exec_data.node_id}\",\n                )",
                                                                                                    "start_token": 3941,
                                                                                                    "end_token": 3949,
                                                                                                    "children": [
                                                                                                        {
                                                                                                            "type": "concatenated_string",
                                                                                                            "label": "f\"Dispatching node execution {exec_data.node_exec_id} \"\n                    f\"for node {exec_data.node_id}\"",
                                                                                                            "start_token": 3941,
                                                                                                            "end_token": -1,
                                                                                                            "children": [
                                                                                                                {
                                                                                                                    "type": "string",
                                                                                                                    "label": "f\"Dispatching node execution {exec_data.node_exec_id} \"",
                                                                                                                    "start_token": 3941,
                                                                                                                    "end_token": 3944,
                                                                                                                    "children": [
                                                                                                                        {
                                                                                                                            "type": "string_start",
                                                                                                                            "label": "f\"",
                                                                                                                            "start_token": 3941,
                                                                                                                            "end_token": 3941,
                                                                                                                            "children": []
                                                                                                                        },
                                                                                                                        {
                                                                                                                            "type": "string_content",
                                                                                                                            "label": "Dispatching node execution ",
                                                                                                                            "start_token": 3941,
                                                                                                                            "end_token": -1,
                                                                                                                            "children": []
                                                                                                                        },
                                                                                                                        {
                                                                                                                            "type": "interpolation",
                                                                                                                            "label": "{exec_data.node_exec_id}",
                                                                                                                            "start_token": -1,
                                                                                                                            "end_token": 3944,
                                                                                                                            "children": [
                                                                                                                                {
                                                                                                                                    "type": "attribute",
                                                                                                                                    "label": "exec_data.node_exec_id",
                                                                                                                                    "start_token": -1,
                                                                                                                                    "end_token": 3944,
                                                                                                                                    "children": [
                                                                                                                                        {
                                                                                                                                            "type": "identifier",
                                                                                                                                            "label": "exec_data",
                                                                                                                                            "start_token": -1,
                                                                                                                                            "end_token": -1,
                                                                                                                                            "children": []
                                                                                                                                        },
                                                                                                                                        {
                                                                                                                                            "type": "identifier",
                                                                                                                                            "label": "node_exec_id",
                                                                                                                                            "start_token": -1,
                                                                                                                                            "end_token": 3944,
                                                                                                                                            "children": []
                                                                                                                                        }
                                                                                                                                    ]
                                                                                                                                }
                                                                                                                            ]
                                                                                                                        },
                                                                                                                        {
                                                                                                                            "type": "string_content",
                                                                                                                            "label": " ",
                                                                                                                            "start_token": 3944,
                                                                                                                            "end_token": 3944,
                                                                                                                            "children": []
                                                                                                                        },
                                                                                                                        {
                                                                                                                            "type": "string_end",
                                                                                                                            "label": "\"",
                                                                                                                            "start_token": 3944,
                                                                                                                            "end_token": 3944,
                                                                                                                            "children": []
                                                                                                                        }
                                                                                                                    ]
                                                                                                                },
                                                                                                                {
                                                                                                                    "type": "string",
                                                                                                                    "label": "f\"for node {exec_data.node_id}\"",
                                                                                                                    "start_token": 3944,
                                                                                                                    "end_token": -1,
                                                                                                                    "children": [
                                                                                                                        {
                                                                                                                            "type": "string_start",
                                                                                                                            "label": "f\"",
                                                                                                                            "start_token": 3944,
                                                                                                                            "end_token": 3944,
                                                                                                                            "children": []
                                                                                                                        },
                                                                                                                        {
                                                                                                                            "type": "string_content",
                                                                                                                            "label": "for node ",
                                                                                                                            "start_token": 3944,
                                                                                                                            "end_token": -1,
                                                                                                                            "children": []
                                                                                                                        },
                                                                                                                        {
                                                                                                                            "type": "interpolation",
                                                                                                                            "label": "{exec_data.node_id}",
                                                                                                                            "start_token": -1,
                                                                                                                            "end_token": -1,
                                                                                                                            "children": [
                                                                                                                                {
                                                                                                                                    "type": "attribute",
                                                                                                                                    "label": "exec_data.node_id",
                                                                                                                                    "start_token": -1,
                                                                                                                                    "end_token": -1,
                                                                                                                                    "children": [
                                                                                                                                        {
                                                                                                                                            "type": "identifier",
                                                                                                                                            "label": "exec_data",
                                                                                                                                            "start_token": -1,
                                                                                                                                            "end_token": -1,
                                                                                                                                            "children": []
                                                                                                                                        },
                                                                                                                                        {
                                                                                                                                            "type": "identifier",
                                                                                                                                            "label": "node_id",
                                                                                                                                            "start_token": 3948,
                                                                                                                                            "end_token": -1,
                                                                                                                                            "children": []
                                                                                                                                        }
                                                                                                                                    ]
                                                                                                                                }
                                                                                                                            ]
                                                                                                                        },
                                                                                                                        {
                                                                                                                            "type": "string_end",
                                                                                                                            "label": "\"",
                                                                                                                            "start_token": -1,
                                                                                                                            "end_token": -1,
                                                                                                                            "children": []
                                                                                                                        }
                                                                                                                    ]
                                                                                                                }
                                                                                                            ]
                                                                                                        }
                                                                                                    ]
                                                                                                }
                                                                                            ]
                                                                                        }
                                                                                    ]
                                                                                },
                                                                                {
                                                                                    "type": "expression_statement",
                                                                                    "label": "running_executions[exec_data.node_id] = cls.executor.apply_async(\n                    cls.on_node_execution,\n                    (queue, exec_data),\n                    callback=make_exec_callback(exec_data),\n                )",
                                                                                    "start_token": 3952,
                                                                                    "end_token": 3988,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "assignment",
                                                                                            "label": "running_executions[exec_data.node_id] = cls.executor.apply_async(\n                    cls.on_node_execution,\n                    (queue, exec_data),\n                    callback=make_exec_callback(exec_data),\n                )",
                                                                                            "start_token": 3952,
                                                                                            "end_token": 3988,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "subscript",
                                                                                                    "label": "running_executions[exec_data.node_id]",
                                                                                                    "start_token": 3952,
                                                                                                    "end_token": 3961,
                                                                                                    "children": [
                                                                                                        {
                                                                                                            "type": "identifier",
                                                                                                            "label": "running_executions",
                                                                                                            "start_token": 3952,
                                                                                                            "end_token": 3958,
                                                                                                            "children": []
                                                                                                        },
                                                                                                        {
                                                                                                            "type": "attribute",
                                                                                                            "label": "exec_data.node_id",
                                                                                                            "start_token": 3958,
                                                                                                            "end_token": 3960,
                                                                                                            "children": [
                                                                                                                {
                                                                                                                    "type": "identifier",
                                                                                                                    "label": "exec_data",
                                                                                                                    "start_token": 3958,
                                                                                                                    "end_token": 3960,
                                                                                                                    "children": []
                                                                                                                },
                                                                                                                {
                                                                                                                    "type": "identifier",
                                                                                                                    "label": "node_id",
                                                                                                                    "start_token": 3960,
                                                                                                                    "end_token": 3960,
                                                                                                                    "children": []
                                                                                                                }
                                                                                                            ]
                                                                                                        }
                                                                                                    ]
                                                                                                },
                                                                                                {
                                                                                                    "type": "call",
                                                                                                    "label": "cls.executor.apply_async(\n                    cls.on_node_execution,\n                    (queue, exec_data),\n                    callback=make_exec_callback(exec_data),\n                )",
                                                                                                    "start_token": -1,
                                                                                                    "end_token": 3988,
                                                                                                    "children": [
                                                                                                        {
                                                                                                            "type": "attribute",
                                                                                                            "label": "cls.executor.apply_async",
                                                                                                            "start_token": -1,
                                                                                                            "end_token": 3965,
                                                                                                            "children": [
                                                                                                                {
                                                                                                                    "type": "attribute",
                                                                                                                    "label": "cls.executor",
                                                                                                                    "start_token": -1,
                                                                                                                    "end_token": -1,
                                                                                                                    "children": [
                                                                                                                        {
                                                                                                                            "type": "identifier",
                                                                                                                            "label": "cls",
                                                                                                                            "start_token": -1,
                                                                                                                            "end_token": -1,
                                                                                                                            "children": []
                                                                                                                        },
                                                                                                                        {
                                                                                                                            "type": "identifier",
                                                                                                                            "label": "executor",
                                                                                                                            "start_token": -1,
                                                                                                                            "end_token": -1,
                                                                                                                            "children": []
                                                                                                                        }
                                                                                                                    ]
                                                                                                                },
                                                                                                                {
                                                                                                                    "type": "identifier",
                                                                                                                    "label": "apply_async",
                                                                                                                    "start_token": -1,
                                                                                                                    "end_token": 3965,
                                                                                                                    "children": []
                                                                                                                }
                                                                                                            ]
                                                                                                        },
                                                                                                        {
                                                                                                            "type": "argument_list",
                                                                                                            "label": "(\n                    cls.on_node_execution,\n                    (queue, exec_data),\n                    callback=make_exec_callback(exec_data),\n                )",
                                                                                                            "start_token": 3965,
                                                                                                            "end_token": 3988,
                                                                                                            "children": [
                                                                                                                {
                                                                                                                    "type": "attribute",
                                                                                                                    "label": "cls.on_node_execution",
                                                                                                                    "start_token": -1,
                                                                                                                    "end_token": 3969,
                                                                                                                    "children": [
                                                                                                                        {
                                                                                                                            "type": "identifier",
                                                                                                                            "label": "cls",
                                                                                                                            "start_token": -1,
                                                                                                                            "end_token": -1,
                                                                                                                            "children": []
                                                                                                                        },
                                                                                                                        {
                                                                                                                            "type": "identifier",
                                                                                                                            "label": "on_node_execution",
                                                                                                                            "start_token": -1,
                                                                                                                            "end_token": 3969,
                                                                                                                            "children": []
                                                                                                                        }
                                                                                                                    ]
                                                                                                                },
                                                                                                                {
                                                                                                                    "type": "tuple",
                                                                                                                    "label": "(queue, exec_data)",
                                                                                                                    "start_token": -1,
                                                                                                                    "end_token": 3975,
                                                                                                                    "children": [
                                                                                                                        {
                                                                                                                            "type": "identifier",
                                                                                                                            "label": "queue",
                                                                                                                            "start_token": -1,
                                                                                                                            "end_token": -1,
                                                                                                                            "children": []
                                                                                                                        },
                                                                                                                        {
                                                                                                                            "type": "identifier",
                                                                                                                            "label": "exec_data",
                                                                                                                            "start_token": -1,
                                                                                                                            "end_token": 3975,
                                                                                                                            "children": []
                                                                                                                        }
                                                                                                                    ]
                                                                                                                },
                                                                                                                {
                                                                                                                    "type": "keyword_argument",
                                                                                                                    "label": "callback=make_exec_callback(exec_data)",
                                                                                                                    "start_token": 3979,
                                                                                                                    "end_token": -1,
                                                                                                                    "children": [
                                                                                                                        {
                                                                                                                            "type": "identifier",
                                                                                                                            "label": "callback",
                                                                                                                            "start_token": 3979,
                                                                                                                            "end_token": 3979,
                                                                                                                            "children": []
                                                                                                                        },
                                                                                                                        {
                                                                                                                            "type": "call",
                                                                                                                            "label": "make_exec_callback(exec_data)",
                                                                                                                            "start_token": 3980,
                                                                                                                            "end_token": -1,
                                                                                                                            "children": [
                                                                                                                                {
                                                                                                                                    "type": "identifier",
                                                                                                                                    "label": "make_exec_callback",
                                                                                                                                    "start_token": 3980,
                                                                                                                                    "end_token": -1,
                                                                                                                                    "children": []
                                                                                                                                },
                                                                                                                                {
                                                                                                                                    "type": "argument_list",
                                                                                                                                    "label": "(exec_data)",
                                                                                                                                    "start_token": -1,
                                                                                                                                    "end_token": -1,
                                                                                                                                    "children": [
                                                                                                                                        {
                                                                                                                                            "type": "identifier",
                                                                                                                                            "label": "exec_data",
                                                                                                                                            "start_token": 3983,
                                                                                                                                            "end_token": -1,
                                                                                                                                            "children": []
                                                                                                                                        }
                                                                                                                                    ]
                                                                                                                                }
                                                                                                                            ]
                                                                                                                        }
                                                                                                                    ]
                                                                                                                }
                                                                                                            ]
                                                                                                        }
                                                                                                    ]
                                                                                                }
                                                                                            ]
                                                                                        }
                                                                                    ]
                                                                                },
                                                                                {
                                                                                    "type": "comment",
                                                                                    "label": "# Avoid terminating graph execution when some nodes are still running.",
                                                                                    "start_token": 3990,
                                                                                    "end_token": 4000,
                                                                                    "children": []
                                                                                },
                                                                                {
                                                                                    "type": "while_statement",
                                                                                    "label": "while queue.empty() and running_executions:\n                    log_metadata.debug(\n                        f\"Queue empty; running nodes: {list(running_executions.keys())}\"\n                    )\n                    for node_id, execution in list(running_executions.items()):\n                        if cancel.is_set():\n                            error = RuntimeError(\"Execution is cancelled\")\n                            return exec_stats, error\n\n                        if not queue.empty():\n                            break  # yield to parent loop to execute new queue items\n\n                        log_metadata.debug(f\"Waiting on execution of node {node_id}\")\n                        execution.wait(3)",
                                                                                    "start_token": 4006,
                                                                                    "end_token": 4095,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "boolean_operator",
                                                                                            "label": "queue.empty() and running_executions",
                                                                                            "start_token": 4006,
                                                                                            "end_token": 4009,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "call",
                                                                                                    "label": "queue.empty()",
                                                                                                    "start_token": 4006,
                                                                                                    "end_token": -1,
                                                                                                    "children": [
                                                                                                        {
                                                                                                            "type": "attribute",
                                                                                                            "label": "queue.empty",
                                                                                                            "start_token": 4006,
                                                                                                            "end_token": -1,
                                                                                                            "children": [
                                                                                                                {
                                                                                                                    "type": "identifier",
                                                                                                                    "label": "queue",
                                                                                                                    "start_token": 4006,
                                                                                                                    "end_token": 4006,
                                                                                                                    "children": []
                                                                                                                },
                                                                                                                {
                                                                                                                    "type": "identifier",
                                                                                                                    "label": "empty",
                                                                                                                    "start_token": 4006,
                                                                                                                    "end_token": -1,
                                                                                                                    "children": []
                                                                                                                }
                                                                                                            ]
                                                                                                        },
                                                                                                        {
                                                                                                            "type": "argument_list",
                                                                                                            "label": "()",
                                                                                                            "start_token": -1,
                                                                                                            "end_token": -1,
                                                                                                            "children": []
                                                                                                        }
                                                                                                    ]
                                                                                                },
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "label": "running_executions",
                                                                                                    "start_token": -1,
                                                                                                    "end_token": 4009,
                                                                                                    "children": []
                                                                                                }
                                                                                            ]
                                                                                        },
                                                                                        {
                                                                                            "type": "block",
                                                                                            "label": "log_metadata.debug(\n                        f\"Queue empty; running nodes: {list(running_executions.keys())}\"\n                    )\n                    for node_id, execution in list(running_executions.items()):\n                        if cancel.is_set():\n                            error = RuntimeError(\"Execution is cancelled\")\n                            return exec_stats, error\n\n                        if not queue.empty():\n                            break  # yield to parent loop to execute new queue items\n\n                        log_metadata.debug(f\"Waiting on execution of node {node_id}\")\n                        execution.wait(3)",
                                                                                            "start_token": -1,
                                                                                            "end_token": 4095,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "expression_statement",
                                                                                                    "label": "log_metadata.debug(\n                        f\"Queue empty; running nodes: {list(running_executions.keys())}\"\n                    )",
                                                                                                    "start_token": -1,
                                                                                                    "end_token": 4020,
                                                                                                    "children": [
                                                                                                        {
                                                                                                            "type": "call",
                                                                                                            "label": "log_metadata.debug(\n                        f\"Queue empty; running nodes: {list(running_executions.keys())}\"\n                    )",
                                                                                                            "start_token": -1,
                                                                                                            "end_token": 4020,
                                                                                                            "children": [
                                                                                                                {
                                                                                                                    "type": "attribute",
                                                                                                                    "label": "log_metadata.debug",
                                                                                                                    "start_token": -1,
                                                                                                                    "end_token": 4015,
                                                                                                                    "children": [
                                                                                                                        {
                                                                                                                            "type": "identifier",
                                                                                                                            "label": "log_metadata",
                                                                                                                            "start_token": -1,
                                                                                                                            "end_token": -1,
                                                                                                                            "children": []
                                                                                                                        },
                                                                                                                        {
                                                                                                                            "type": "identifier",
                                                                                                                            "label": "debug",
                                                                                                                            "start_token": -1,
                                                                                                                            "end_token": 4015,
                                                                                                                            "children": []
                                                                                                                        }
                                                                                                                    ]
                                                                                                                },
                                                                                                                {
                                                                                                                    "type": "argument_list",
                                                                                                                    "label": "(\n                        f\"Queue empty; running nodes: {list(running_executions.keys())}\"\n                    )",
                                                                                                                    "start_token": 4015,
                                                                                                                    "end_token": 4020,
                                                                                                                    "children": [
                                                                                                                        {
                                                                                                                            "type": "string",
                                                                                                                            "label": "f\"Queue empty; running nodes: {list(running_executions.keys())}\"",
                                                                                                                            "start_token": 4015,
                                                                                                                            "end_token": -1,
                                                                                                                            "children": [
                                                                                                                                {
                                                                                                                                    "type": "string_start",
                                                                                                                                    "label": "f\"",
                                                                                                                                    "start_token": 4015,
                                                                                                                                    "end_token": 4015,
                                                                                                                                    "children": []
                                                                                                                                },
                                                                                                                                {
                                                                                                                                    "type": "string_content",
                                                                                                                                    "label": "Queue empty; running nodes: ",
                                                                                                                                    "start_token": 4015,
                                                                                                                                    "end_token": 4015,
                                                                                                                                    "children": []
                                                                                                                                },
                                                                                                                                {
                                                                                                                                    "type": "interpolation",
                                                                                                                                    "label": "{list(running_executions.keys())}",
                                                                                                                                    "start_token": 4015,
                                                                                                                                    "end_token": -1,
                                                                                                                                    "children": [
                                                                                                                                        {
                                                                                                                                            "type": "call",
                                                                                                                                            "label": "list(running_executions.keys())",
                                                                                                                                            "start_token": 4015,
                                                                                                                                            "end_token": -1,
                                                                                                                                            "children": [
                                                                                                                                                {
                                                                                                                                                    "type": "identifier",
                                                                                                                                                    "label": "list",
                                                                                                                                                    "start_token": 4015,
                                                                                                                                                    "end_token": 4015,
                                                                                                                                                    "children": []
                                                                                                                                                },
                                                                                                                                                {
                                                                                                                                                    "type": "argument_list",
                                                                                                                                                    "label": "(running_executions.keys())",
                                                                                                                                                    "start_token": 4015,
                                                                                                                                                    "end_token": -1,
                                                                                                                                                    "children": [
                                                                                                                                                        {
                                                                                                                                                            "type": "call",
                                                                                                                                                            "label": "running_executions.keys()",
                                                                                                                                                            "start_token": 4016,
                                                                                                                                                            "end_token": -1,
                                                                                                                                                            "children": [
                                                                                                                                                                {
                                                                                                                                                                    "type": "attribute",
                                                                                                                                                                    "label": "running_executions.keys",
                                                                                                                                                                    "start_token": 4016,
                                                                                                                                                                    "end_token": 4018,
                                                                                                                                                                    "children": [
                                                                                                                                                                        {
                                                                                                                                                                            "type": "identifier",
                                                                                                                                                                            "label": "running_executions",
                                                                                                                                                                            "start_token": 4016,
                                                                                                                                                                            "end_token": -1,
                                                                                                                                                                            "children": []
                                                                                                                                                                        },
                                                                                                                                                                        {
                                                                                                                                                                            "type": "identifier",
                                                                                                                                                                            "label": "keys",
                                                                                                                                                                            "start_token": -1,
                                                                                                                                                                            "end_token": 4018,
                                                                                                                                                                            "children": []
                                                                                                                                                                        }
                                                                                                                                                                    ]
                                                                                                                                                                },
                                                                                                                                                                {
                                                                                                                                                                    "type": "argument_list",
                                                                                                                                                                    "label": "()",
                                                                                                                                                                    "start_token": -1,
                                                                                                                                                                    "end_token": -1,
                                                                                                                                                                    "children": []
                                                                                                                                                                }
                                                                                                                                                            ]
                                                                                                                                                        }
                                                                                                                                                    ]
                                                                                                                                                }
                                                                                                                                            ]
                                                                                                                                        }
                                                                                                                                    ]
                                                                                                                                },
                                                                                                                                {
                                                                                                                                    "type": "string_end",
                                                                                                                                    "label": "\"",
                                                                                                                                    "start_token": -1,
                                                                                                                                    "end_token": -1,
                                                                                                                                    "children": []
                                                                                                                                }
                                                                                                                            ]
                                                                                                                        }
                                                                                                                    ]
                                                                                                                }
                                                                                                            ]
                                                                                                        }
                                                                                                    ]
                                                                                                },
                                                                                                {
                                                                                                    "type": "for_statement",
                                                                                                    "label": "for node_id, execution in list(running_executions.items()):\n                        if cancel.is_set():\n                            error = RuntimeError(\"Execution is cancelled\")\n                            return exec_stats, error\n\n                        if not queue.empty():\n                            break  # yield to parent loop to execute new queue items\n\n                        log_metadata.debug(f\"Waiting on execution of node {node_id}\")\n                        execution.wait(3)",
                                                                                                    "start_token": 4024,
                                                                                                    "end_token": 4095,
                                                                                                    "children": [
                                                                                                        {
                                                                                                            "type": "pattern_list",
                                                                                                            "label": "node_id, execution",
                                                                                                            "start_token": 4026,
                                                                                                            "end_token": 4027,
                                                                                                            "children": [
                                                                                                                {
                                                                                                                    "type": "identifier",
                                                                                                                    "label": "node_id",
                                                                                                                    "start_token": 4026,
                                                                                                                    "end_token": 4026,
                                                                                                                    "children": []
                                                                                                                },
                                                                                                                {
                                                                                                                    "type": "identifier",
                                                                                                                    "label": "execution",
                                                                                                                    "start_token": 4026,
                                                                                                                    "end_token": 4027,
                                                                                                                    "children": []
                                                                                                                }
                                                                                                            ]
                                                                                                        },
                                                                                                        {
                                                                                                            "type": "call",
                                                                                                            "label": "list(running_executions.items())",
                                                                                                            "start_token": 4028,
                                                                                                            "end_token": 4034,
                                                                                                            "children": [
                                                                                                                {
                                                                                                                    "type": "identifier",
                                                                                                                    "label": "list",
                                                                                                                    "start_token": 4028,
                                                                                                                    "end_token": 4031,
                                                                                                                    "children": []
                                                                                                                },
                                                                                                                {
                                                                                                                    "type": "argument_list",
                                                                                                                    "label": "(running_executions.items())",
                                                                                                                    "start_token": 4032,
                                                                                                                    "end_token": 4034,
                                                                                                                    "children": [
                                                                                                                        {
                                                                                                                            "type": "call",
                                                                                                                            "label": "running_executions.items()",
                                                                                                                            "start_token": 4033,
                                                                                                                            "end_token": 4034,
                                                                                                                            "children": [
                                                                                                                                {
                                                                                                                                    "type": "attribute",
                                                                                                                                    "label": "running_executions.items",
                                                                                                                                    "start_token": 4033,
                                                                                                                                    "end_token": -1,
                                                                                                                                    "children": [
                                                                                                                                        {
                                                                                                                                            "type": "identifier",
                                                                                                                                            "label": "running_executions",
                                                                                                                                            "start_token": 4033,
                                                                                                                                            "end_token": -1,
                                                                                                                                            "children": []
                                                                                                                                        },
                                                                                                                                        {
                                                                                                                                            "type": "identifier",
                                                                                                                                            "label": "items",
                                                                                                                                            "start_token": -1,
                                                                                                                                            "end_token": -1,
                                                                                                                                            "children": []
                                                                                                                                        }
                                                                                                                                    ]
                                                                                                                                },
                                                                                                                                {
                                                                                                                                    "type": "argument_list",
                                                                                                                                    "label": "()",
                                                                                                                                    "start_token": -1,
                                                                                                                                    "end_token": 4034,
                                                                                                                                    "children": []
                                                                                                                                }
                                                                                                                            ]
                                                                                                                        }
                                                                                                                    ]
                                                                                                                }
                                                                                                            ]
                                                                                                        },
                                                                                                        {
                                                                                                            "type": "block",
                                                                                                            "label": "if cancel.is_set():\n                            error = RuntimeError(\"Execution is cancelled\")\n                            return exec_stats, error\n\n                        if not queue.empty():\n                            break  # yield to parent loop to execute new queue items\n\n                        log_metadata.debug(f\"Waiting on execution of node {node_id}\")\n                        execution.wait(3)",
                                                                                                            "start_token": -1,
                                                                                                            "end_token": 4095,
                                                                                                            "children": [
                                                                                                                {
                                                                                                                    "type": "if_statement",
                                                                                                                    "label": "if cancel.is_set():\n                            error = RuntimeError(\"Execution is cancelled\")\n                            return exec_stats, error",
                                                                                                                    "start_token": -1,
                                                                                                                    "end_token": 4055,
                                                                                                                    "children": [
                                                                                                                        {
                                                                                                                            "type": "call",
                                                                                                                            "label": "cancel.is_set()",
                                                                                                                            "start_token": -1,
                                                                                                                            "end_token": -1,
                                                                                                                            "children": [
                                                                                                                                {
                                                                                                                                    "type": "attribute",
                                                                                                                                    "label": "cancel.is_set",
                                                                                                                                    "start_token": -1,
                                                                                                                                    "end_token": -1,
                                                                                                                                    "children": [
                                                                                                                                        {
                                                                                                                                            "type": "identifier",
                                                                                                                                            "label": "cancel",
                                                                                                                                            "start_token": -1,
                                                                                                                                            "end_token": -1,
                                                                                                                                            "children": []
                                                                                                                                        },
                                                                                                                                        {
                                                                                                                                            "type": "identifier",
                                                                                                                                            "label": "is_set",
                                                                                                                                            "start_token": -1,
                                                                                                                                            "end_token": -1,
                                                                                                                                            "children": []
                                                                                                                                        }
                                                                                                                                    ]
                                                                                                                                },
                                                                                                                                {
                                                                                                                                    "type": "argument_list",
                                                                                                                                    "label": "()",
                                                                                                                                    "start_token": -1,
                                                                                                                                    "end_token": -1,
                                                                                                                                    "children": []
                                                                                                                                }
                                                                                                                            ]
                                                                                                                        },
                                                                                                                        {
                                                                                                                            "type": "block",
                                                                                                                            "label": "error = RuntimeError(\"Execution is cancelled\")\n                            return exec_stats, error",
                                                                                                                            "start_token": 4046,
                                                                                                                            "end_token": 4055,
                                                                                                                            "children": [
                                                                                                                                {
                                                                                                                                    "type": "expression_statement",
                                                                                                                                    "label": "error = RuntimeError(\"Execution is cancelled\")",
                                                                                                                                    "start_token": 4046,
                                                                                                                                    "end_token": -1,
                                                                                                                                    "children": [
                                                                                                                                        {
                                                                                                                                            "type": "assignment",
                                                                                                                                            "label": "error = RuntimeError(\"Execution is cancelled\")",
                                                                                                                                            "start_token": 4046,
                                                                                                                                            "end_token": -1,
                                                                                                                                            "children": [
                                                                                                                                                {
                                                                                                                                                    "type": "identifier",
                                                                                                                                                    "label": "error",
                                                                                                                                                    "start_token": 4046,
                                                                                                                                                    "end_token": 4046,
                                                                                                                                                    "children": []
                                                                                                                                                },
                                                                                                                                                {
                                                                                                                                                    "type": "call",
                                                                                                                                                    "label": "RuntimeError(\"Execution is cancelled\")",
                                                                                                                                                    "start_token": 4046,
                                                                                                                                                    "end_token": -1,
                                                                                                                                                    "children": [
                                                                                                                                                        {
                                                                                                                                                            "type": "identifier",
                                                                                                                                                            "label": "RuntimeError",
                                                                                                                                                            "start_token": 4046,
                                                                                                                                                            "end_token": -1,
                                                                                                                                                            "children": []
                                                                                                                                                        },
                                                                                                                                                        {
                                                                                                                                                            "type": "argument_list",
                                                                                                                                                            "label": "(\"Execution is cancelled\")",
                                                                                                                                                            "start_token": -1,
                                                                                                                                                            "end_token": -1,
                                                                                                                                                            "children": [
                                                                                                                                                                {
                                                                                                                                                                    "type": "string",
                                                                                                                                                                    "label": "\"Execution is cancelled\"",
                                                                                                                                                                    "start_token": -1,
                                                                                                                                                                    "end_token": -1,
                                                                                                                                                                    "children": [
                                                                                                                                                                        {
                                                                                                                                                                            "type": "string_start",
                                                                                                                                                                            "label": "\"",
                                                                                                                                                                            "start_token": -1,
                                                                                                                                                                            "end_token": -1,
                                                                                                                                                                            "children": []
                                                                                                                                                                        },
                                                                                                                                                                        {
                                                                                                                                                                            "type": "string_content",
                                                                                                                                                                            "label": "Execution is cancelled",
                                                                                                                                                                            "start_token": -1,
                                                                                                                                                                            "end_token": -1,
                                                                                                                                                                            "children": []
                                                                                                                                                                        },
                                                                                                                                                                        {
                                                                                                                                                                            "type": "string_end",
                                                                                                                                                                            "label": "\"",
                                                                                                                                                                            "start_token": -1,
                                                                                                                                                                            "end_token": -1,
                                                                                                                                                                            "children": []
                                                                                                                                                                        }
                                                                                                                                                                    ]
                                                                                                                                                                }
                                                                                                                                                            ]
                                                                                                                                                        }
                                                                                                                                                    ]
                                                                                                                                                }
                                                                                                                                            ]
                                                                                                                                        }
                                                                                                                                    ]
                                                                                                                                },
                                                                                                                                {
                                                                                                                                    "type": "return_statement",
                                                                                                                                    "label": "return exec_stats, error",
                                                                                                                                    "start_token": -1,
                                                                                                                                    "end_token": 4055,
                                                                                                                                    "children": [
                                                                                                                                        {
                                                                                                                                            "type": "expression_list",
                                                                                                                                            "label": "exec_stats, error",
                                                                                                                                            "start_token": -1,
                                                                                                                                            "end_token": 4055,
                                                                                                                                            "children": [
                                                                                                                                                {
                                                                                                                                                    "type": "identifier",
                                                                                                                                                    "label": "exec_stats",
                                                                                                                                                    "start_token": -1,
                                                                                                                                                    "end_token": -1,
                                                                                                                                                    "children": []
                                                                                                                                                },
                                                                                                                                                {
                                                                                                                                                    "type": "identifier",
                                                                                                                                                    "label": "error",
                                                                                                                                                    "start_token": -1,
                                                                                                                                                    "end_token": 4055,
                                                                                                                                                    "children": []
                                                                                                                                                }
                                                                                                                                            ]
                                                                                                                                        }
                                                                                                                                    ]
                                                                                                                                }
                                                                                                                            ]
                                                                                                                        }
                                                                                                                    ]
                                                                                                                },
                                                                                                                {
                                                                                                                    "type": "if_statement",
                                                                                                                    "label": "if not queue.empty():\n                            break  # yield to parent loop to execute new queue items",
                                                                                                                    "start_token": -1,
                                                                                                                    "end_token": 4077,
                                                                                                                    "children": [
                                                                                                                        {
                                                                                                                            "type": "not_operator",
                                                                                                                            "label": "not queue.empty()",
                                                                                                                            "start_token": -1,
                                                                                                                            "end_token": -1,
                                                                                                                            "children": [
                                                                                                                                {
                                                                                                                                    "type": "call",
                                                                                                                                    "label": "queue.empty()",
                                                                                                                                    "start_token": -1,
                                                                                                                                    "end_token": -1,
                                                                                                                                    "children": [
                                                                                                                                        {
                                                                                                                                            "type": "attribute",
                                                                                                                                            "label": "queue.empty",
                                                                                                                                            "start_token": -1,
                                                                                                                                            "end_token": -1,
                                                                                                                                            "children": [
                                                                                                                                                {
                                                                                                                                                    "type": "identifier",
                                                                                                                                                    "label": "queue",
                                                                                                                                                    "start_token": -1,
                                                                                                                                                    "end_token": -1,
                                                                                                                                                    "children": []
                                                                                                                                                },
                                                                                                                                                {
                                                                                                                                                    "type": "identifier",
                                                                                                                                                    "label": "empty",
                                                                                                                                                    "start_token": -1,
                                                                                                                                                    "end_token": -1,
                                                                                                                                                    "children": []
                                                                                                                                                }
                                                                                                                                            ]
                                                                                                                                        },
                                                                                                                                        {
                                                                                                                                            "type": "argument_list",
                                                                                                                                            "label": "()",
                                                                                                                                            "start_token": -1,
                                                                                                                                            "end_token": -1,
                                                                                                                                            "children": []
                                                                                                                                        }
                                                                                                                                    ]
                                                                                                                                }
                                                                                                                            ]
                                                                                                                        },
                                                                                                                        {
                                                                                                                            "type": "block",
                                                                                                                            "label": "break  # yield to parent loop to execute new queue items",
                                                                                                                            "start_token": 4069,
                                                                                                                            "end_token": 4077,
                                                                                                                            "children": [
                                                                                                                                {
                                                                                                                                    "type": "break_statement",
                                                                                                                                    "label": "break",
                                                                                                                                    "start_token": 4069,
                                                                                                                                    "end_token": -1,
                                                                                                                                    "children": []
                                                                                                                                },
                                                                                                                                {
                                                                                                                                    "type": "comment",
                                                                                                                                    "label": "# yield to parent loop to execute new queue items",
                                                                                                                                    "start_token": 4071,
                                                                                                                                    "end_token": 4077,
                                                                                                                                    "children": []
                                                                                                                                }
                                                                                                                            ]
                                                                                                                        }
                                                                                                                    ]
                                                                                                                },
                                                                                                                {
                                                                                                                    "type": "expression_statement",
                                                                                                                    "label": "log_metadata.debug(f\"Waiting on execution of node {node_id}\")",
                                                                                                                    "start_token": 4082,
                                                                                                                    "end_token": 4085,
                                                                                                                    "children": [
                                                                                                                        {
                                                                                                                            "type": "call",
                                                                                                                            "label": "log_metadata.debug(f\"Waiting on execution of node {node_id}\")",
                                                                                                                            "start_token": 4082,
                                                                                                                            "end_token": 4085,
                                                                                                                            "children": [
                                                                                                                                {
                                                                                                                                    "type": "attribute",
                                                                                                                                    "label": "log_metadata.debug",
                                                                                                                                    "start_token": 4082,
                                                                                                                                    "end_token": 4082,
                                                                                                                                    "children": [
                                                                                                                                        {
                                                                                                                                            "type": "identifier",
                                                                                                                                            "label": "log_metadata",
                                                                                                                                            "start_token": 4082,
                                                                                                                                            "end_token": 4082,
                                                                                                                                            "children": []
                                                                                                                                        },
                                                                                                                                        {
                                                                                                                                            "type": "identifier",
                                                                                                                                            "label": "debug",
                                                                                                                                            "start_token": 4082,
                                                                                                                                            "end_token": 4082,
                                                                                                                                            "children": []
                                                                                                                                        }
                                                                                                                                    ]
                                                                                                                                },
                                                                                                                                {
                                                                                                                                    "type": "argument_list",
                                                                                                                                    "label": "(f\"Waiting on execution of node {node_id}\")",
                                                                                                                                    "start_token": 4082,
                                                                                                                                    "end_token": 4085,
                                                                                                                                    "children": [
                                                                                                                                        {
                                                                                                                                            "type": "string",
                                                                                                                                            "label": "f\"Waiting on execution of node {node_id}\"",
                                                                                                                                            "start_token": 4082,
                                                                                                                                            "end_token": 4085,
                                                                                                                                            "children": [
                                                                                                                                                {
                                                                                                                                                    "type": "string_start",
                                                                                                                                                    "label": "f\"",
                                                                                                                                                    "start_token": 4082,
                                                                                                                                                    "end_token": 4082,
                                                                                                                                                    "children": []
                                                                                                                                                },
                                                                                                                                                {
                                                                                                                                                    "type": "string_content",
                                                                                                                                                    "label": "Waiting on execution of node ",
                                                                                                                                                    "start_token": 4082,
                                                                                                                                                    "end_token": -1,
                                                                                                                                                    "children": []
                                                                                                                                                },
                                                                                                                                                {
                                                                                                                                                    "type": "interpolation",
                                                                                                                                                    "label": "{node_id}",
                                                                                                                                                    "start_token": -1,
                                                                                                                                                    "end_token": 4085,
                                                                                                                                                    "children": [
                                                                                                                                                        {
                                                                                                                                                            "type": "identifier",
                                                                                                                                                            "label": "node_id",
                                                                                                                                                            "start_token": -1,
                                                                                                                                                            "end_token": -1,
                                                                                                                                                            "children": []
                                                                                                                                                        }
                                                                                                                                                    ]
                                                                                                                                                },
                                                                                                                                                {
                                                                                                                                                    "type": "string_end",
                                                                                                                                                    "label": "\"",
                                                                                                                                                    "start_token": 4085,
                                                                                                                                                    "end_token": 4085,
                                                                                                                                                    "children": []
                                                                                                                                                }
                                                                                                                                            ]
                                                                                                                                        }
                                                                                                                                    ]
                                                                                                                                }
                                                                                                                            ]
                                                                                                                        }
                                                                                                                    ]
                                                                                                                },
                                                                                                                {
                                                                                                                    "type": "expression_statement",
                                                                                                                    "label": "execution.wait(3)",
                                                                                                                    "start_token": -1,
                                                                                                                    "end_token": 4095,
                                                                                                                    "children": [
                                                                                                                        {
                                                                                                                            "type": "call",
                                                                                                                            "label": "execution.wait(3)",
                                                                                                                            "start_token": -1,
                                                                                                                            "end_token": 4095,
                                                                                                                            "children": [
                                                                                                                                {
                                                                                                                                    "type": "attribute",
                                                                                                                                    "label": "execution.wait",
                                                                                                                                    "start_token": -1,
                                                                                                                                    "end_token": 4093,
                                                                                                                                    "children": [
                                                                                                                                        {
                                                                                                                                            "type": "identifier",
                                                                                                                                            "label": "execution",
                                                                                                                                            "start_token": -1,
                                                                                                                                            "end_token": 4093,
                                                                                                                                            "children": []
                                                                                                                                        },
                                                                                                                                        {
                                                                                                                                            "type": "identifier",
                                                                                                                                            "label": "wait",
                                                                                                                                            "start_token": 4093,
                                                                                                                                            "end_token": 4093,
                                                                                                                                            "children": []
                                                                                                                                        }
                                                                                                                                    ]
                                                                                                                                },
                                                                                                                                {
                                                                                                                                    "type": "argument_list",
                                                                                                                                    "label": "(3)",
                                                                                                                                    "start_token": 4093,
                                                                                                                                    "end_token": 4095,
                                                                                                                                    "children": [
                                                                                                                                        {
                                                                                                                                            "type": "integer",
                                                                                                                                            "label": "3",
                                                                                                                                            "start_token": 4094,
                                                                                                                                            "end_token": 4094,
                                                                                                                                            "children": []
                                                                                                                                        }
                                                                                                                                    ]
                                                                                                                                }
                                                                                                                            ]
                                                                                                                        }
                                                                                                                    ]
                                                                                                                }
                                                                                                            ]
                                                                                                        }
                                                                                                    ]
                                                                                                }
                                                                                            ]
                                                                                        }
                                                                                    ]
                                                                                }
                                                                            ]
                                                                        }
                                                                    ]
                                                                },
                                                                {
                                                                    "type": "expression_statement",
                                                                    "label": "log_metadata.info(f\"Finished graph execution {graph_exec.graph_exec_id}\")",
                                                                    "start_token": 4098,
                                                                    "end_token": 4103,
                                                                    "children": [
                                                                        {
                                                                            "type": "call",
                                                                            "label": "log_metadata.info(f\"Finished graph execution {graph_exec.graph_exec_id}\")",
                                                                            "start_token": 4098,
                                                                            "end_token": 4103,
                                                                            "children": [
                                                                                {
                                                                                    "type": "attribute",
                                                                                    "label": "log_metadata.info",
                                                                                    "start_token": 4098,
                                                                                    "end_token": 4098,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "label": "log_metadata",
                                                                                            "start_token": 4098,
                                                                                            "end_token": 4098,
                                                                                            "children": []
                                                                                        },
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "label": "info",
                                                                                            "start_token": 4098,
                                                                                            "end_token": 4098,
                                                                                            "children": []
                                                                                        }
                                                                                    ]
                                                                                },
                                                                                {
                                                                                    "type": "argument_list",
                                                                                    "label": "(f\"Finished graph execution {graph_exec.graph_exec_id}\")",
                                                                                    "start_token": 4098,
                                                                                    "end_token": 4103,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "string",
                                                                                            "label": "f\"Finished graph execution {graph_exec.graph_exec_id}\"",
                                                                                            "start_token": 4098,
                                                                                            "end_token": 4103,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "string_start",
                                                                                                    "label": "f\"",
                                                                                                    "start_token": 4098,
                                                                                                    "end_token": 4098,
                                                                                                    "children": []
                                                                                                },
                                                                                                {
                                                                                                    "type": "string_content",
                                                                                                    "label": "Finished graph execution ",
                                                                                                    "start_token": 4098,
                                                                                                    "end_token": 4099,
                                                                                                    "children": []
                                                                                                },
                                                                                                {
                                                                                                    "type": "interpolation",
                                                                                                    "label": "{graph_exec.graph_exec_id}",
                                                                                                    "start_token": 4100,
                                                                                                    "end_token": -1,
                                                                                                    "children": [
                                                                                                        {
                                                                                                            "type": "attribute",
                                                                                                            "label": "graph_exec.graph_exec_id",
                                                                                                            "start_token": -1,
                                                                                                            "end_token": 4102,
                                                                                                            "children": [
                                                                                                                {
                                                                                                                    "type": "identifier",
                                                                                                                    "label": "graph_exec",
                                                                                                                    "start_token": -1,
                                                                                                                    "end_token": 4101,
                                                                                                                    "children": []
                                                                                                                },
                                                                                                                {
                                                                                                                    "type": "identifier",
                                                                                                                    "label": "graph_exec_id",
                                                                                                                    "start_token": 4101,
                                                                                                                    "end_token": 4102,
                                                                                                                    "children": []
                                                                                                                }
                                                                                                            ]
                                                                                                        }
                                                                                                    ]
                                                                                                },
                                                                                                {
                                                                                                    "type": "string_end",
                                                                                                    "label": "\"",
                                                                                                    "start_token": 4103,
                                                                                                    "end_token": 4103,
                                                                                                    "children": []
                                                                                                }
                                                                                            ]
                                                                                        }
                                                                                    ]
                                                                                }
                                                                            ]
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        },
                                                        {
                                                            "type": "except_clause",
                                                            "label": "except Exception as e:\n            log_metadata.exception(\n                f\"Failed graph execution {graph_exec.graph_exec_id}: {e}\"\n            )\n            error = e",
                                                            "start_token": -1,
                                                            "end_token": -1,
                                                            "children": [
                                                                {
                                                                    "type": "as_pattern",
                                                                    "label": "Exception as e",
                                                                    "start_token": 4107,
                                                                    "end_token": 4109,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "Exception",
                                                                            "start_token": 4107,
                                                                            "end_token": 4107,
                                                                            "children": []
                                                                        },
                                                                        {
                                                                            "type": "as_pattern_target",
                                                                            "label": "e",
                                                                            "start_token": 4109,
                                                                            "end_token": 4109,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "e",
                                                                                    "start_token": 4109,
                                                                                    "end_token": 4109,
                                                                                    "children": []
                                                                                }
                                                                            ]
                                                                        }
                                                                    ]
                                                                },
                                                                {
                                                                    "type": "block",
                                                                    "label": "log_metadata.exception(\n                f\"Failed graph execution {graph_exec.graph_exec_id}: {e}\"\n            )\n            error = e",
                                                                    "start_token": -1,
                                                                    "end_token": -1,
                                                                    "children": [
                                                                        {
                                                                            "type": "expression_statement",
                                                                            "label": "log_metadata.exception(\n                f\"Failed graph execution {graph_exec.graph_exec_id}: {e}\"\n            )",
                                                                            "start_token": -1,
                                                                            "end_token": -1,
                                                                            "children": [
                                                                                {
                                                                                    "type": "call",
                                                                                    "label": "log_metadata.exception(\n                f\"Failed graph execution {graph_exec.graph_exec_id}: {e}\"\n            )",
                                                                                    "start_token": -1,
                                                                                    "end_token": -1,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "attribute",
                                                                                            "label": "log_metadata.exception",
                                                                                            "start_token": -1,
                                                                                            "end_token": 4113,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "label": "log_metadata",
                                                                                                    "start_token": -1,
                                                                                                    "end_token": -1,
                                                                                                    "children": []
                                                                                                },
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "label": "exception",
                                                                                                    "start_token": 4113,
                                                                                                    "end_token": 4113,
                                                                                                    "children": []
                                                                                                }
                                                                                            ]
                                                                                        },
                                                                                        {
                                                                                            "type": "argument_list",
                                                                                            "label": "(\n                f\"Failed graph execution {graph_exec.graph_exec_id}: {e}\"\n            )",
                                                                                            "start_token": 4113,
                                                                                            "end_token": -1,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "string",
                                                                                                    "label": "f\"Failed graph execution {graph_exec.graph_exec_id}: {e}\"",
                                                                                                    "start_token": 4113,
                                                                                                    "end_token": 4117,
                                                                                                    "children": [
                                                                                                        {
                                                                                                            "type": "string_start",
                                                                                                            "label": "f\"",
                                                                                                            "start_token": 4113,
                                                                                                            "end_token": 4113,
                                                                                                            "children": []
                                                                                                        },
                                                                                                        {
                                                                                                            "type": "string_content",
                                                                                                            "label": "Failed graph execution ",
                                                                                                            "start_token": 4113,
                                                                                                            "end_token": 4113,
                                                                                                            "children": []
                                                                                                        },
                                                                                                        {
                                                                                                            "type": "interpolation",
                                                                                                            "label": "{graph_exec.graph_exec_id}",
                                                                                                            "start_token": 4113,
                                                                                                            "end_token": -1,
                                                                                                            "children": [
                                                                                                                {
                                                                                                                    "type": "attribute",
                                                                                                                    "label": "graph_exec.graph_exec_id",
                                                                                                                    "start_token": 4113,
                                                                                                                    "end_token": -1,
                                                                                                                    "children": [
                                                                                                                        {
                                                                                                                            "type": "identifier",
                                                                                                                            "label": "graph_exec",
                                                                                                                            "start_token": 4113,
                                                                                                                            "end_token": -1,
                                                                                                                            "children": []
                                                                                                                        },
                                                                                                                        {
                                                                                                                            "type": "identifier",
                                                                                                                            "label": "graph_exec_id",
                                                                                                                            "start_token": -1,
                                                                                                                            "end_token": -1,
                                                                                                                            "children": []
                                                                                                                        }
                                                                                                                    ]
                                                                                                                }
                                                                                                            ]
                                                                                                        },
                                                                                                        {
                                                                                                            "type": "string_content",
                                                                                                            "label": ": ",
                                                                                                            "start_token": -1,
                                                                                                            "end_token": -1,
                                                                                                            "children": []
                                                                                                        },
                                                                                                        {
                                                                                                            "type": "interpolation",
                                                                                                            "label": "{e}",
                                                                                                            "start_token": -1,
                                                                                                            "end_token": -1,
                                                                                                            "children": [
                                                                                                                {
                                                                                                                    "type": "identifier",
                                                                                                                    "label": "e",
                                                                                                                    "start_token": -1,
                                                                                                                    "end_token": -1,
                                                                                                                    "children": []
                                                                                                                }
                                                                                                            ]
                                                                                                        },
                                                                                                        {
                                                                                                            "type": "string_end",
                                                                                                            "label": "\"",
                                                                                                            "start_token": 4117,
                                                                                                            "end_token": 4117,
                                                                                                            "children": []
                                                                                                        }
                                                                                                    ]
                                                                                                }
                                                                                            ]
                                                                                        }
                                                                                    ]
                                                                                }
                                                                            ]
                                                                        },
                                                                        {
                                                                            "type": "expression_statement",
                                                                            "label": "error = e",
                                                                            "start_token": -1,
                                                                            "end_token": -1,
                                                                            "children": [
                                                                                {
                                                                                    "type": "assignment",
                                                                                    "label": "error = e",
                                                                                    "start_token": -1,
                                                                                    "end_token": -1,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "label": "error",
                                                                                            "start_token": -1,
                                                                                            "end_token": -1,
                                                                                            "children": []
                                                                                        },
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "label": "e",
                                                                                            "start_token": -1,
                                                                                            "end_token": -1,
                                                                                            "children": []
                                                                                        }
                                                                                    ]
                                                                                }
                                                                            ]
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        },
                                                        {
                                                            "type": "finally_clause",
                                                            "label": "finally:\n            if not cancel.is_set():\n                finished = True\n                cancel.set()\n            cancel_thread.join()\n            return exec_stats, error",
                                                            "start_token": 4126,
                                                            "end_token": 4159,
                                                            "children": [
                                                                {
                                                                    "type": "block",
                                                                    "label": "if not cancel.is_set():\n                finished = True\n                cancel.set()\n            cancel_thread.join()\n            return exec_stats, error",
                                                                    "start_token": -1,
                                                                    "end_token": 4159,
                                                                    "children": [
                                                                        {
                                                                            "type": "if_statement",
                                                                            "label": "if not cancel.is_set():\n                finished = True\n                cancel.set()",
                                                                            "start_token": -1,
                                                                            "end_token": 4145,
                                                                            "children": [
                                                                                {
                                                                                    "type": "not_operator",
                                                                                    "label": "not cancel.is_set()",
                                                                                    "start_token": -1,
                                                                                    "end_token": 4134,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "call",
                                                                                            "label": "cancel.is_set()",
                                                                                            "start_token": -1,
                                                                                            "end_token": 4134,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "attribute",
                                                                                                    "label": "cancel.is_set",
                                                                                                    "start_token": -1,
                                                                                                    "end_token": 4133,
                                                                                                    "children": [
                                                                                                        {
                                                                                                            "type": "identifier",
                                                                                                            "label": "cancel",
                                                                                                            "start_token": -1,
                                                                                                            "end_token": 4133,
                                                                                                            "children": []
                                                                                                        },
                                                                                                        {
                                                                                                            "type": "identifier",
                                                                                                            "label": "is_set",
                                                                                                            "start_token": 4133,
                                                                                                            "end_token": 4133,
                                                                                                            "children": []
                                                                                                        }
                                                                                                    ]
                                                                                                },
                                                                                                {
                                                                                                    "type": "argument_list",
                                                                                                    "label": "()",
                                                                                                    "start_token": -1,
                                                                                                    "end_token": 4134,
                                                                                                    "children": []
                                                                                                }
                                                                                            ]
                                                                                        }
                                                                                    ]
                                                                                },
                                                                                {
                                                                                    "type": "block",
                                                                                    "label": "finished = True\n                cancel.set()",
                                                                                    "start_token": -1,
                                                                                    "end_token": 4145,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "expression_statement",
                                                                                            "label": "finished = True",
                                                                                            "start_token": -1,
                                                                                            "end_token": 4140,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "assignment",
                                                                                                    "label": "finished = True",
                                                                                                    "start_token": -1,
                                                                                                    "end_token": 4140,
                                                                                                    "children": [
                                                                                                        {
                                                                                                            "type": "identifier",
                                                                                                            "label": "finished",
                                                                                                            "start_token": -1,
                                                                                                            "end_token": 4137,
                                                                                                            "children": []
                                                                                                        },
                                                                                                        {
                                                                                                            "type": "true",
                                                                                                            "label": "True",
                                                                                                            "start_token": 4139,
                                                                                                            "end_token": 4140,
                                                                                                            "children": []
                                                                                                        }
                                                                                                    ]
                                                                                                }
                                                                                            ]
                                                                                        },
                                                                                        {
                                                                                            "type": "expression_statement",
                                                                                            "label": "cancel.set()",
                                                                                            "start_token": 4143,
                                                                                            "end_token": 4145,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "call",
                                                                                                    "label": "cancel.set()",
                                                                                                    "start_token": 4143,
                                                                                                    "end_token": 4145,
                                                                                                    "children": [
                                                                                                        {
                                                                                                            "type": "attribute",
                                                                                                            "label": "cancel.set",
                                                                                                            "start_token": 4143,
                                                                                                            "end_token": 4143,
                                                                                                            "children": [
                                                                                                                {
                                                                                                                    "type": "identifier",
                                                                                                                    "label": "cancel",
                                                                                                                    "start_token": 4143,
                                                                                                                    "end_token": 4143,
                                                                                                                    "children": []
                                                                                                                },
                                                                                                                {
                                                                                                                    "type": "identifier",
                                                                                                                    "label": "set",
                                                                                                                    "start_token": 4143,
                                                                                                                    "end_token": 4143,
                                                                                                                    "children": []
                                                                                                                }
                                                                                                            ]
                                                                                                        },
                                                                                                        {
                                                                                                            "type": "argument_list",
                                                                                                            "label": "()",
                                                                                                            "start_token": 4144,
                                                                                                            "end_token": 4145,
                                                                                                            "children": []
                                                                                                        }
                                                                                                    ]
                                                                                                }
                                                                                            ]
                                                                                        }
                                                                                    ]
                                                                                }
                                                                            ]
                                                                        },
                                                                        {
                                                                            "type": "expression_statement",
                                                                            "label": "cancel_thread.join()",
                                                                            "start_token": -1,
                                                                            "end_token": 4150,
                                                                            "children": [
                                                                                {
                                                                                    "type": "call",
                                                                                    "label": "cancel_thread.join()",
                                                                                    "start_token": -1,
                                                                                    "end_token": 4150,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "attribute",
                                                                                            "label": "cancel_thread.join",
                                                                                            "start_token": -1,
                                                                                            "end_token": 4150,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "label": "cancel_thread",
                                                                                                    "start_token": -1,
                                                                                                    "end_token": 4150,
                                                                                                    "children": []
                                                                                                },
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "label": "join",
                                                                                                    "start_token": 4150,
                                                                                                    "end_token": 4150,
                                                                                                    "children": []
                                                                                                }
                                                                                            ]
                                                                                        },
                                                                                        {
                                                                                            "type": "argument_list",
                                                                                            "label": "()",
                                                                                            "start_token": 4150,
                                                                                            "end_token": 4150,
                                                                                            "children": []
                                                                                        }
                                                                                    ]
                                                                                }
                                                                            ]
                                                                        },
                                                                        {
                                                                            "type": "return_statement",
                                                                            "label": "return exec_stats, error",
                                                                            "start_token": 4156,
                                                                            "end_token": 4159,
                                                                            "children": [
                                                                                {
                                                                                    "type": "expression_list",
                                                                                    "label": "exec_stats, error",
                                                                                    "start_token": 4157,
                                                                                    "end_token": 4159,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "label": "exec_stats",
                                                                                            "start_token": 4157,
                                                                                            "end_token": 4157,
                                                                                            "children": []
                                                                                        },
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "label": "error",
                                                                                            "start_token": 4157,
                                                                                            "end_token": 4159,
                                                                                            "children": []
                                                                                        }
                                                                                    ]
                                                                                }
                                                                            ]
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                }
                                            ]
                                        }
                                    ]
                                }
                            ]
                        }
                    ]
                }
            ]
        },
        {
            "type": "class_definition",
            "label": "class ExecutionManager(AppService):\n    def __init__(self):\n        super().__init__()\n        self.use_redis = True\n        self.use_supabase = True\n        self.pool_size = settings.config.num_graph_workers\n        self.queue = ExecutionQueue[GraphExecutionEntry]()\n        self.active_graph_runs: dict[str, tuple[Future, threading.Event]] = {}\n\n    @classmethod\n    def get_port(cls) -> int:\n        return settings.config.execution_manager_port\n\n    def run_service(self):\n        from backend.integrations.credentials_store import IntegrationCredentialsStore\n\n        self.credentials_store = IntegrationCredentialsStore()\n        self.executor = ProcessPoolExecutor(\n            max_workers=self.pool_size,\n            initializer=Executor.on_graph_executor_start,\n        )\n        sync_manager = multiprocessing.Manager()\n        logger.info(\n            f\"[{self.service_name}] Started with max-{self.pool_size} graph workers\"\n        )\n        while True:\n            graph_exec_data = self.queue.get()\n            graph_exec_id = graph_exec_data.graph_exec_id\n            logger.debug(\n                f\"[ExecutionManager] Dispatching graph execution {graph_exec_id}\"\n            )\n            cancel_event = sync_manager.Event()\n            future = self.executor.submit(\n                Executor.on_graph_execution, graph_exec_data, cancel_event\n            )\n            self.active_graph_runs[graph_exec_id] = (future, cancel_event)\n            future.add_done_callback(\n                lambda _: self.active_graph_runs.pop(graph_exec_id, None)\n            )\n\n    def cleanup(self):\n        logger.info(f\"[{__class__.__name__}] ⏳ Shutting down graph executor pool...\")\n        self.executor.shutdown(cancel_futures=True)\n\n        super().cleanup()\n\n    @property\n    def db_client(self) -> \"DatabaseManager\":\n        return get_db_client()\n\n    @expose\n    def add_execution(\n        self,\n        graph_id: str,\n        data: BlockInput,\n        user_id: str,\n        graph_version: int | None = None,\n    ) -> GraphExecutionEntry:\n        graph: GraphModel | None = self.db_client.get_graph(\n            graph_id=graph_id, user_id=user_id, version=graph_version\n        )\n        if not graph:\n            raise ValueError(f\"Graph #{graph_id} not found.\")\n\n        graph.validate_graph(for_run=True)\n        self._validate_node_input_credentials(graph, user_id)\n\n        nodes_input = []\n        for node in graph.starting_nodes:\n            input_data = {}\n            block = get_block(node.block_id)\n\n            # Invalid block & Note block should never be executed.\n            if not block or block.block_type == BlockType.NOTE:\n                continue\n\n            # Extract request input data, and assign it to the input pin.\n            if block.block_type == BlockType.INPUT:\n                name = node.input_default.get(\"name\")\n                if name and name in data:\n                    input_data = {\"value\": data[name]}\n\n            # Extract webhook payload, and assign it to the input pin\n            webhook_payload_key = f\"webhook_{node.webhook_id}_payload\"\n            if (\n                block.block_type in (BlockType.WEBHOOK, BlockType.WEBHOOK_MANUAL)\n                and node.webhook_id\n            ):\n                if webhook_payload_key not in data:\n                    raise ValueError(\n                        f\"Node {block.name} #{node.id} webhook payload is missing\"\n                    )\n                input_data = {\"payload\": data[webhook_payload_key]}\n\n            input_data, error = validate_exec(node, input_data)\n            if input_data is None:\n                raise ValueError(error)\n            else:\n                nodes_input.append((node.id, input_data))\n\n        graph_exec_id, node_execs = self.db_client.create_graph_execution(\n            graph_id=graph_id,\n            graph_version=graph.version,\n            nodes_input=nodes_input,\n            user_id=user_id,\n        )\n\n        starting_node_execs = []\n        for node_exec in node_execs:\n            starting_node_execs.append(\n                NodeExecutionEntry(\n                    user_id=user_id,\n                    graph_exec_id=node_exec.graph_exec_id,\n                    graph_id=node_exec.graph_id,\n                    node_exec_id=node_exec.node_exec_id,\n                    node_id=node_exec.node_id,\n                    data=node_exec.input_data,\n                )\n            )\n            exec_update = self.db_client.update_execution_status(\n                node_exec.node_exec_id, ExecutionStatus.QUEUED, node_exec.input_data\n            )\n            self.db_client.send_execution_update(exec_update)\n\n        graph_exec = GraphExecutionEntry(\n            user_id=user_id,\n            graph_id=graph_id,\n            graph_exec_id=graph_exec_id,\n            start_node_execs=starting_node_execs,\n        )\n        self.queue.add(graph_exec)\n\n        return graph_exec\n\n    @expose\n    def cancel_execution(self, graph_exec_id: str) -> None:\n        \"\"\"\n        Mechanism:\n        1. Set the cancel event\n        2. Graph executor's cancel handler thread detects the event, terminates workers,\n           reinitializes worker pool, and returns.\n        3. Update execution statuses in DB and set `error` outputs to `\"TERMINATED\"`.\n        \"\"\"\n        if graph_exec_id not in self.active_graph_runs:\n            raise Exception(\n                f\"Graph execution #{graph_exec_id} not active/running: \"\n                \"possibly already completed/cancelled.\"\n            )\n\n        future, cancel_event = self.active_graph_runs[graph_exec_id]\n        if cancel_event.is_set():\n            return\n\n        cancel_event.set()\n        future.result()\n\n        # Update the status of the unfinished node executions\n        node_execs = self.db_client.get_execution_results(graph_exec_id)\n        for node_exec in node_execs:\n            if node_exec.status not in (\n                ExecutionStatus.COMPLETED,\n                ExecutionStatus.FAILED,\n            ):\n                self.db_client.upsert_execution_output(\n                    node_exec.node_exec_id, \"error\", \"TERMINATED\"\n                )\n                exec_update = self.db_client.update_execution_status(\n                    node_exec.node_exec_id, ExecutionStatus.FAILED\n                )\n                self.db_client.send_execution_update(exec_update)\n\n    def _validate_node_input_credentials(self, graph: GraphModel, user_id: str):\n        \"\"\"Checks all credentials for all nodes of the graph\"\"\"\n\n        for node in graph.nodes:\n            block = get_block(node.block_id)\n            if not block:\n                raise ValueError(f\"Unknown block {node.block_id} for node #{node.id}\")\n\n            # Find any fields of type CredentialsMetaInput\n            model_fields = cast(type[BaseModel], block.input_schema).model_fields\n            if CREDENTIALS_FIELD_NAME not in model_fields:\n                continue\n\n            field = model_fields[CREDENTIALS_FIELD_NAME]\n\n            # The BlockSchema class enforces that a `credentials` field is always a\n            # `CredentialsMetaInput`, so we can safely assume this here.\n            credentials_meta_type = cast(CredentialsMetaInput, field.annotation)\n            credentials_meta = credentials_meta_type.model_validate(\n                node.input_default[CREDENTIALS_FIELD_NAME]\n            )\n            # Fetch the corresponding Credentials and perform sanity checks\n            credentials = self.credentials_store.get_creds_by_id(\n                user_id, credentials_meta.id\n            )\n            if not credentials:\n                raise ValueError(\n                    f\"Unknown credentials #{credentials_meta.id} \"\n                    f\"for node #{node.id}\"\n                )\n            if (\n                credentials.provider != credentials_meta.provider\n                or credentials.type != credentials_meta.type\n            ):\n                logger.warning(\n                    f\"Invalid credentials #{credentials.id} for node #{node.id}: \"\n                    \"type/provider mismatch: \"\n                    f\"{credentials_meta.type}<>{credentials.type};\"\n                    f\"{credentials_meta.provider}<>{credentials.provider}\"\n                )\n                raise ValueError(\n                    f\"Invalid credentials #{credentials.id} for node #{node.id}: \"\n                    \"type/provider mismatch\"\n                )",
            "start_token": 4159,
            "end_token": 5400,
            "children": [
                {
                    "type": "identifier",
                    "label": "ExecutionManager",
                    "start_token": 4161,
                    "end_token": 4164,
                    "children": []
                },
                {
                    "type": "argument_list",
                    "label": "(AppService)",
                    "start_token": 4164,
                    "end_token": -1,
                    "children": [
                        {
                            "type": "identifier",
                            "label": "AppService",
                            "start_token": 4164,
                            "end_token": -1,
                            "children": []
                        }
                    ]
                },
                {
                    "type": "block",
                    "label": "def __init__(self):\n        super().__init__()\n        self.use_redis = True\n        self.use_supabase = True\n        self.pool_size = settings.config.num_graph_workers\n        self.queue = ExecutionQueue[GraphExecutionEntry]()\n        self.active_graph_runs: dict[str, tuple[Future, threading.Event]] = {}\n\n    @classmethod\n    def get_port(cls) -> int:\n        return settings.config.execution_manager_port\n\n    def run_service(self):\n        from backend.integrations.credentials_store import IntegrationCredentialsStore\n\n        self.credentials_store = IntegrationCredentialsStore()\n        self.executor = ProcessPoolExecutor(\n            max_workers=self.pool_size,\n            initializer=Executor.on_graph_executor_start,\n        )\n        sync_manager = multiprocessing.Manager()\n        logger.info(\n            f\"[{self.service_name}] Started with max-{self.pool_size} graph workers\"\n        )\n        while True:\n            graph_exec_data = self.queue.get()\n            graph_exec_id = graph_exec_data.graph_exec_id\n            logger.debug(\n                f\"[ExecutionManager] Dispatching graph execution {graph_exec_id}\"\n            )\n            cancel_event = sync_manager.Event()\n            future = self.executor.submit(\n                Executor.on_graph_execution, graph_exec_data, cancel_event\n            )\n            self.active_graph_runs[graph_exec_id] = (future, cancel_event)\n            future.add_done_callback(\n                lambda _: self.active_graph_runs.pop(graph_exec_id, None)\n            )\n\n    def cleanup(self):\n        logger.info(f\"[{__class__.__name__}] ⏳ Shutting down graph executor pool...\")\n        self.executor.shutdown(cancel_futures=True)\n\n        super().cleanup()\n\n    @property\n    def db_client(self) -> \"DatabaseManager\":\n        return get_db_client()\n\n    @expose\n    def add_execution(\n        self,\n        graph_id: str,\n        data: BlockInput,\n        user_id: str,\n        graph_version: int | None = None,\n    ) -> GraphExecutionEntry:\n        graph: GraphModel | None = self.db_client.get_graph(\n            graph_id=graph_id, user_id=user_id, version=graph_version\n        )\n        if not graph:\n            raise ValueError(f\"Graph #{graph_id} not found.\")\n\n        graph.validate_graph(for_run=True)\n        self._validate_node_input_credentials(graph, user_id)\n\n        nodes_input = []\n        for node in graph.starting_nodes:\n            input_data = {}\n            block = get_block(node.block_id)\n\n            # Invalid block & Note block should never be executed.\n            if not block or block.block_type == BlockType.NOTE:\n                continue\n\n            # Extract request input data, and assign it to the input pin.\n            if block.block_type == BlockType.INPUT:\n                name = node.input_default.get(\"name\")\n                if name and name in data:\n                    input_data = {\"value\": data[name]}\n\n            # Extract webhook payload, and assign it to the input pin\n            webhook_payload_key = f\"webhook_{node.webhook_id}_payload\"\n            if (\n                block.block_type in (BlockType.WEBHOOK, BlockType.WEBHOOK_MANUAL)\n                and node.webhook_id\n            ):\n                if webhook_payload_key not in data:\n                    raise ValueError(\n                        f\"Node {block.name} #{node.id} webhook payload is missing\"\n                    )\n                input_data = {\"payload\": data[webhook_payload_key]}\n\n            input_data, error = validate_exec(node, input_data)\n            if input_data is None:\n                raise ValueError(error)\n            else:\n                nodes_input.append((node.id, input_data))\n\n        graph_exec_id, node_execs = self.db_client.create_graph_execution(\n            graph_id=graph_id,\n            graph_version=graph.version,\n            nodes_input=nodes_input,\n            user_id=user_id,\n        )\n\n        starting_node_execs = []\n        for node_exec in node_execs:\n            starting_node_execs.append(\n                NodeExecutionEntry(\n                    user_id=user_id,\n                    graph_exec_id=node_exec.graph_exec_id,\n                    graph_id=node_exec.graph_id,\n                    node_exec_id=node_exec.node_exec_id,\n                    node_id=node_exec.node_id,\n                    data=node_exec.input_data,\n                )\n            )\n            exec_update = self.db_client.update_execution_status(\n                node_exec.node_exec_id, ExecutionStatus.QUEUED, node_exec.input_data\n            )\n            self.db_client.send_execution_update(exec_update)\n\n        graph_exec = GraphExecutionEntry(\n            user_id=user_id,\n            graph_id=graph_id,\n            graph_exec_id=graph_exec_id,\n            start_node_execs=starting_node_execs,\n        )\n        self.queue.add(graph_exec)\n\n        return graph_exec\n\n    @expose\n    def cancel_execution(self, graph_exec_id: str) -> None:\n        \"\"\"\n        Mechanism:\n        1. Set the cancel event\n        2. Graph executor's cancel handler thread detects the event, terminates workers,\n           reinitializes worker pool, and returns.\n        3. Update execution statuses in DB and set `error` outputs to `\"TERMINATED\"`.\n        \"\"\"\n        if graph_exec_id not in self.active_graph_runs:\n            raise Exception(\n                f\"Graph execution #{graph_exec_id} not active/running: \"\n                \"possibly already completed/cancelled.\"\n            )\n\n        future, cancel_event = self.active_graph_runs[graph_exec_id]\n        if cancel_event.is_set():\n            return\n\n        cancel_event.set()\n        future.result()\n\n        # Update the status of the unfinished node executions\n        node_execs = self.db_client.get_execution_results(graph_exec_id)\n        for node_exec in node_execs:\n            if node_exec.status not in (\n                ExecutionStatus.COMPLETED,\n                ExecutionStatus.FAILED,\n            ):\n                self.db_client.upsert_execution_output(\n                    node_exec.node_exec_id, \"error\", \"TERMINATED\"\n                )\n                exec_update = self.db_client.update_execution_status(\n                    node_exec.node_exec_id, ExecutionStatus.FAILED\n                )\n                self.db_client.send_execution_update(exec_update)\n\n    def _validate_node_input_credentials(self, graph: GraphModel, user_id: str):\n        \"\"\"Checks all credentials for all nodes of the graph\"\"\"\n\n        for node in graph.nodes:\n            block = get_block(node.block_id)\n            if not block:\n                raise ValueError(f\"Unknown block {node.block_id} for node #{node.id}\")\n\n            # Find any fields of type CredentialsMetaInput\n            model_fields = cast(type[BaseModel], block.input_schema).model_fields\n            if CREDENTIALS_FIELD_NAME not in model_fields:\n                continue\n\n            field = model_fields[CREDENTIALS_FIELD_NAME]\n\n            # The BlockSchema class enforces that a `credentials` field is always a\n            # `CredentialsMetaInput`, so we can safely assume this here.\n            credentials_meta_type = cast(CredentialsMetaInput, field.annotation)\n            credentials_meta = credentials_meta_type.model_validate(\n                node.input_default[CREDENTIALS_FIELD_NAME]\n            )\n            # Fetch the corresponding Credentials and perform sanity checks\n            credentials = self.credentials_store.get_creds_by_id(\n                user_id, credentials_meta.id\n            )\n            if not credentials:\n                raise ValueError(\n                    f\"Unknown credentials #{credentials_meta.id} \"\n                    f\"for node #{node.id}\"\n                )\n            if (\n                credentials.provider != credentials_meta.provider\n                or credentials.type != credentials_meta.type\n            ):\n                logger.warning(\n                    f\"Invalid credentials #{credentials.id} for node #{node.id}: \"\n                    \"type/provider mismatch: \"\n                    f\"{credentials_meta.type}<>{credentials.type};\"\n                    f\"{credentials_meta.provider}<>{credentials.provider}\"\n                )\n                raise ValueError(\n                    f\"Invalid credentials #{credentials.id} for node #{node.id}: \"\n                    \"type/provider mismatch\"\n                )",
                    "start_token": 4170,
                    "end_token": 5400,
                    "children": [
                        {
                            "type": "function_definition",
                            "label": "def __init__(self):\n        super().__init__()\n        self.use_redis = True\n        self.use_supabase = True\n        self.pool_size = settings.config.num_graph_workers\n        self.queue = ExecutionQueue[GraphExecutionEntry]()\n        self.active_graph_runs: dict[str, tuple[Future, threading.Event]] = {}",
                            "start_token": 4170,
                            "end_token": 4237,
                            "children": [
                                {
                                    "type": "identifier",
                                    "label": "__init__",
                                    "start_token": 4170,
                                    "end_token": 4174,
                                    "children": []
                                },
                                {
                                    "type": "parameters",
                                    "label": "(self)",
                                    "start_token": 4174,
                                    "end_token": 4176,
                                    "children": [
                                        {
                                            "type": "identifier",
                                            "label": "self",
                                            "start_token": 4174,
                                            "end_token": 4175,
                                            "children": []
                                        }
                                    ]
                                },
                                {
                                    "type": "block",
                                    "label": "super().__init__()\n        self.use_redis = True\n        self.use_supabase = True\n        self.pool_size = settings.config.num_graph_workers\n        self.queue = ExecutionQueue[GraphExecutionEntry]()\n        self.active_graph_runs: dict[str, tuple[Future, threading.Event]] = {}",
                                    "start_token": 4178,
                                    "end_token": 4237,
                                    "children": [
                                        {
                                            "type": "expression_statement",
                                            "label": "super().__init__()",
                                            "start_token": 4178,
                                            "end_token": 4182,
                                            "children": [
                                                {
                                                    "type": "call",
                                                    "label": "super().__init__()",
                                                    "start_token": 4178,
                                                    "end_token": 4182,
                                                    "children": [
                                                        {
                                                            "type": "attribute",
                                                            "label": "super().__init__",
                                                            "start_token": 4178,
                                                            "end_token": -1,
                                                            "children": [
                                                                {
                                                                    "type": "call",
                                                                    "label": "super()",
                                                                    "start_token": 4178,
                                                                    "end_token": 4180,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "super",
                                                                            "start_token": 4178,
                                                                            "end_token": 4180,
                                                                            "children": []
                                                                        },
                                                                        {
                                                                            "type": "argument_list",
                                                                            "label": "()",
                                                                            "start_token": 4180,
                                                                            "end_token": 4180,
                                                                            "children": []
                                                                        }
                                                                    ]
                                                                },
                                                                {
                                                                    "type": "identifier",
                                                                    "label": "__init__",
                                                                    "start_token": 4180,
                                                                    "end_token": -1,
                                                                    "children": []
                                                                }
                                                            ]
                                                        },
                                                        {
                                                            "type": "argument_list",
                                                            "label": "()",
                                                            "start_token": 4182,
                                                            "end_token": 4182,
                                                            "children": []
                                                        }
                                                    ]
                                                }
                                            ]
                                        },
                                        {
                                            "type": "expression_statement",
                                            "label": "self.use_redis = True",
                                            "start_token": -1,
                                            "end_token": 4187,
                                            "children": [
                                                {
                                                    "type": "assignment",
                                                    "label": "self.use_redis = True",
                                                    "start_token": -1,
                                                    "end_token": 4187,
                                                    "children": [
                                                        {
                                                            "type": "attribute",
                                                            "label": "self.use_redis",
                                                            "start_token": -1,
                                                            "end_token": 4186,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "label": "self",
                                                                    "start_token": -1,
                                                                    "end_token": 4184,
                                                                    "children": []
                                                                },
                                                                {
                                                                    "type": "identifier",
                                                                    "label": "use_redis",
                                                                    "start_token": 4184,
                                                                    "end_token": 4186,
                                                                    "children": []
                                                                }
                                                            ]
                                                        },
                                                        {
                                                            "type": "true",
                                                            "label": "True",
                                                            "start_token": 4186,
                                                            "end_token": 4187,
                                                            "children": []
                                                        }
                                                    ]
                                                }
                                            ]
                                        },
                                        {
                                            "type": "expression_statement",
                                            "label": "self.use_supabase = True",
                                            "start_token": -1,
                                            "end_token": 4194,
                                            "children": [
                                                {
                                                    "type": "assignment",
                                                    "label": "self.use_supabase = True",
                                                    "start_token": -1,
                                                    "end_token": 4194,
                                                    "children": [
                                                        {
                                                            "type": "attribute",
                                                            "label": "self.use_supabase",
                                                            "start_token": -1,
                                                            "end_token": 4192,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "label": "self",
                                                                    "start_token": -1,
                                                                    "end_token": -1,
                                                                    "children": []
                                                                },
                                                                {
                                                                    "type": "identifier",
                                                                    "label": "use_supabase",
                                                                    "start_token": 4190,
                                                                    "end_token": 4192,
                                                                    "children": []
                                                                }
                                                            ]
                                                        },
                                                        {
                                                            "type": "true",
                                                            "label": "True",
                                                            "start_token": 4193,
                                                            "end_token": 4194,
                                                            "children": []
                                                        }
                                                    ]
                                                }
                                            ]
                                        },
                                        {
                                            "type": "expression_statement",
                                            "label": "self.pool_size = settings.config.num_graph_workers",
                                            "start_token": 4196,
                                            "end_token": 4204,
                                            "children": [
                                                {
                                                    "type": "assignment",
                                                    "label": "self.pool_size = settings.config.num_graph_workers",
                                                    "start_token": 4196,
                                                    "end_token": 4204,
                                                    "children": [
                                                        {
                                                            "type": "attribute",
                                                            "label": "self.pool_size",
                                                            "start_token": 4196,
                                                            "end_token": 4198,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "label": "self",
                                                                    "start_token": 4196,
                                                                    "end_token": 4196,
                                                                    "children": []
                                                                },
                                                                {
                                                                    "type": "identifier",
                                                                    "label": "pool_size",
                                                                    "start_token": 4198,
                                                                    "end_token": 4198,
                                                                    "children": []
                                                                }
                                                            ]
                                                        },
                                                        {
                                                            "type": "attribute",
                                                            "label": "settings.config.num_graph_workers",
                                                            "start_token": 4198,
                                                            "end_token": 4204,
                                                            "children": [
                                                                {
                                                                    "type": "attribute",
                                                                    "label": "settings.config",
                                                                    "start_token": 4198,
                                                                    "end_token": 4200,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "settings",
                                                                            "start_token": 4198,
                                                                            "end_token": -1,
                                                                            "children": []
                                                                        },
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "config",
                                                                            "start_token": -1,
                                                                            "end_token": 4200,
                                                                            "children": []
                                                                        }
                                                                    ]
                                                                },
                                                                {
                                                                    "type": "identifier",
                                                                    "label": "num_graph_workers",
                                                                    "start_token": 4200,
                                                                    "end_token": 4204,
                                                                    "children": []
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                }
                                            ]
                                        },
                                        {
                                            "type": "expression_statement",
                                            "label": "self.queue = ExecutionQueue[GraphExecutionEntry]()",
                                            "start_token": 4206,
                                            "end_token": 4213,
                                            "children": [
                                                {
                                                    "type": "assignment",
                                                    "label": "self.queue = ExecutionQueue[GraphExecutionEntry]()",
                                                    "start_token": 4206,
                                                    "end_token": 4213,
                                                    "children": [
                                                        {
                                                            "type": "attribute",
                                                            "label": "self.queue",
                                                            "start_token": 4206,
                                                            "end_token": 4206,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "label": "self",
                                                                    "start_token": 4206,
                                                                    "end_token": 4206,
                                                                    "children": []
                                                                },
                                                                {
                                                                    "type": "identifier",
                                                                    "label": "queue",
                                                                    "start_token": 4206,
                                                                    "end_token": 4206,
                                                                    "children": []
                                                                }
                                                            ]
                                                        },
                                                        {
                                                            "type": "call",
                                                            "label": "ExecutionQueue[GraphExecutionEntry]()",
                                                            "start_token": 4206,
                                                            "end_token": 4213,
                                                            "children": [
                                                                {
                                                                    "type": "subscript",
                                                                    "label": "ExecutionQueue[GraphExecutionEntry]",
                                                                    "start_token": 4206,
                                                                    "end_token": 4213,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "ExecutionQueue",
                                                                            "start_token": 4206,
                                                                            "end_token": -1,
                                                                            "children": []
                                                                        },
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "GraphExecutionEntry",
                                                                            "start_token": -1,
                                                                            "end_token": 4213,
                                                                            "children": []
                                                                        }
                                                                    ]
                                                                },
                                                                {
                                                                    "type": "argument_list",
                                                                    "label": "()",
                                                                    "start_token": 4213,
                                                                    "end_token": 4213,
                                                                    "children": []
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                }
                                            ]
                                        },
                                        {
                                            "type": "expression_statement",
                                            "label": "self.active_graph_runs: dict[str, tuple[Future, threading.Event]] = {}",
                                            "start_token": 4216,
                                            "end_token": 4237,
                                            "children": [
                                                {
                                                    "type": "assignment",
                                                    "label": "self.active_graph_runs: dict[str, tuple[Future, threading.Event]] = {}",
                                                    "start_token": 4216,
                                                    "end_token": 4237,
                                                    "children": [
                                                        {
                                                            "type": "attribute",
                                                            "label": "self.active_graph_runs",
                                                            "start_token": 4216,
                                                            "end_token": 4223,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "label": "self",
                                                                    "start_token": 4216,
                                                                    "end_token": 4217,
                                                                    "children": []
                                                                },
                                                                {
                                                                    "type": "identifier",
                                                                    "label": "active_graph_runs",
                                                                    "start_token": -1,
                                                                    "end_token": 4223,
                                                                    "children": []
                                                                }
                                                            ]
                                                        },
                                                        {
                                                            "type": "type",
                                                            "label": "dict[str, tuple[Future, threading.Event]]",
                                                            "start_token": 4223,
                                                            "end_token": -1,
                                                            "children": [
                                                                {
                                                                    "type": "generic_type",
                                                                    "label": "dict[str, tuple[Future, threading.Event]]",
                                                                    "start_token": 4223,
                                                                    "end_token": -1,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "dict",
                                                                            "start_token": 4223,
                                                                            "end_token": 4223,
                                                                            "children": []
                                                                        },
                                                                        {
                                                                            "type": "type_parameter",
                                                                            "label": "[str, tuple[Future, threading.Event]]",
                                                                            "start_token": 4223,
                                                                            "end_token": -1,
                                                                            "children": [
                                                                                {
                                                                                    "type": "type",
                                                                                    "label": "str",
                                                                                    "start_token": 4224,
                                                                                    "end_token": 4225,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "label": "str",
                                                                                            "start_token": 4224,
                                                                                            "end_token": 4225,
                                                                                            "children": []
                                                                                        }
                                                                                    ]
                                                                                },
                                                                                {
                                                                                    "type": "type",
                                                                                    "label": "tuple[Future, threading.Event]",
                                                                                    "start_token": 4225,
                                                                                    "end_token": -1,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "generic_type",
                                                                                            "label": "tuple[Future, threading.Event]",
                                                                                            "start_token": 4225,
                                                                                            "end_token": -1,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "label": "tuple",
                                                                                                    "start_token": 4225,
                                                                                                    "end_token": 4228,
                                                                                                    "children": []
                                                                                                },
                                                                                                {
                                                                                                    "type": "type_parameter",
                                                                                                    "label": "[Future, threading.Event]",
                                                                                                    "start_token": -1,
                                                                                                    "end_token": -1,
                                                                                                    "children": [
                                                                                                        {
                                                                                                            "type": "type",
                                                                                                            "label": "Future",
                                                                                                            "start_token": 4229,
                                                                                                            "end_token": -1,
                                                                                                            "children": [
                                                                                                                {
                                                                                                                    "type": "identifier",
                                                                                                                    "label": "Future",
                                                                                                                    "start_token": 4229,
                                                                                                                    "end_token": -1,
                                                                                                                    "children": []
                                                                                                                }
                                                                                                            ]
                                                                                                        },
                                                                                                        {
                                                                                                            "type": "type",
                                                                                                            "label": "threading.Event",
                                                                                                            "start_token": 4233,
                                                                                                            "end_token": -1,
                                                                                                            "children": [
                                                                                                                {
                                                                                                                    "type": "attribute",
                                                                                                                    "label": "threading.Event",
                                                                                                                    "start_token": 4233,
                                                                                                                    "end_token": -1,
                                                                                                                    "children": [
                                                                                                                        {
                                                                                                                            "type": "identifier",
                                                                                                                            "label": "threading",
                                                                                                                            "start_token": 4233,
                                                                                                                            "end_token": 4234,
                                                                                                                            "children": []
                                                                                                                        },
                                                                                                                        {
                                                                                                                            "type": "identifier",
                                                                                                                            "label": "Event",
                                                                                                                            "start_token": 4234,
                                                                                                                            "end_token": -1,
                                                                                                                            "children": []
                                                                                                                        }
                                                                                                                    ]
                                                                                                                }
                                                                                                            ]
                                                                                                        }
                                                                                                    ]
                                                                                                }
                                                                                            ]
                                                                                        }
                                                                                    ]
                                                                                }
                                                                            ]
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        },
                                                        {
                                                            "type": "dictionary",
                                                            "label": "{}",
                                                            "start_token": -1,
                                                            "end_token": 4237,
                                                            "children": []
                                                        }
                                                    ]
                                                }
                                            ]
                                        }
                                    ]
                                }
                            ]
                        },
                        {
                            "type": "decorated_definition",
                            "label": "@classmethod\n    def get_port(cls) -> int:\n        return settings.config.execution_manager_port",
                            "start_token": 4237,
                            "end_token": 4259,
                            "children": [
                                {
                                    "type": "decorator",
                                    "label": "@classmethod",
                                    "start_token": 4237,
                                    "end_token": 4243,
                                    "children": [
                                        {
                                            "type": "identifier",
                                            "label": "classmethod",
                                            "start_token": 4238,
                                            "end_token": 4243,
                                            "children": []
                                        }
                                    ]
                                },
                                {
                                    "type": "function_definition",
                                    "label": "def get_port(cls) -> int:\n        return settings.config.execution_manager_port",
                                    "start_token": -1,
                                    "end_token": 4259,
                                    "children": [
                                        {
                                            "type": "identifier",
                                            "label": "get_port",
                                            "start_token": -1,
                                            "end_token": 4246,
                                            "children": []
                                        },
                                        {
                                            "type": "parameters",
                                            "label": "(cls)",
                                            "start_token": -1,
                                            "end_token": 4247,
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "label": "cls",
                                                    "start_token": 4247,
                                                    "end_token": 4247,
                                                    "children": []
                                                }
                                            ]
                                        },
                                        {
                                            "type": "type",
                                            "label": "int",
                                            "start_token": 4248,
                                            "end_token": 4249,
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "label": "int",
                                                    "start_token": 4248,
                                                    "end_token": 4249,
                                                    "children": []
                                                }
                                            ]
                                        },
                                        {
                                            "type": "block",
                                            "label": "return settings.config.execution_manager_port",
                                            "start_token": 4251,
                                            "end_token": 4259,
                                            "children": [
                                                {
                                                    "type": "return_statement",
                                                    "label": "return settings.config.execution_manager_port",
                                                    "start_token": 4251,
                                                    "end_token": 4259,
                                                    "children": [
                                                        {
                                                            "type": "attribute",
                                                            "label": "settings.config.execution_manager_port",
                                                            "start_token": 4251,
                                                            "end_token": 4259,
                                                            "children": [
                                                                {
                                                                    "type": "attribute",
                                                                    "label": "settings.config",
                                                                    "start_token": 4251,
                                                                    "end_token": -1,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "settings",
                                                                            "start_token": 4251,
                                                                            "end_token": 4251,
                                                                            "children": []
                                                                        },
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "config",
                                                                            "start_token": 4251,
                                                                            "end_token": -1,
                                                                            "children": []
                                                                        }
                                                                    ]
                                                                },
                                                                {
                                                                    "type": "identifier",
                                                                    "label": "execution_manager_port",
                                                                    "start_token": 4254,
                                                                    "end_token": 4259,
                                                                    "children": []
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                }
                                            ]
                                        }
                                    ]
                                }
                            ]
                        },
                        {
                            "type": "function_definition",
                            "label": "def run_service(self):\n        from backend.integrations.credentials_store import IntegrationCredentialsStore\n\n        self.credentials_store = IntegrationCredentialsStore()\n        self.executor = ProcessPoolExecutor(\n            max_workers=self.pool_size,\n            initializer=Executor.on_graph_executor_start,\n        )\n        sync_manager = multiprocessing.Manager()\n        logger.info(\n            f\"[{self.service_name}] Started with max-{self.pool_size} graph workers\"\n        )\n        while True:\n            graph_exec_data = self.queue.get()\n            graph_exec_id = graph_exec_data.graph_exec_id\n            logger.debug(\n                f\"[ExecutionManager] Dispatching graph execution {graph_exec_id}\"\n            )\n            cancel_event = sync_manager.Event()\n            future = self.executor.submit(\n                Executor.on_graph_execution, graph_exec_data, cancel_event\n            )\n            self.active_graph_runs[graph_exec_id] = (future, cancel_event)\n            future.add_done_callback(\n                lambda _: self.active_graph_runs.pop(graph_exec_id, None)\n            )",
                            "start_token": -1,
                            "end_token": -1,
                            "children": [
                                {
                                    "type": "identifier",
                                    "label": "run_service",
                                    "start_token": 4261,
                                    "end_token": 4262,
                                    "children": []
                                },
                                {
                                    "type": "parameters",
                                    "label": "(self)",
                                    "start_token": 4263,
                                    "end_token": 4264,
                                    "children": [
                                        {
                                            "type": "identifier",
                                            "label": "self",
                                            "start_token": 4264,
                                            "end_token": 4264,
                                            "children": []
                                        }
                                    ]
                                },
                                {
                                    "type": "block",
                                    "label": "from backend.integrations.credentials_store import IntegrationCredentialsStore\n\n        self.credentials_store = IntegrationCredentialsStore()\n        self.executor = ProcessPoolExecutor(\n            max_workers=self.pool_size,\n            initializer=Executor.on_graph_executor_start,\n        )\n        sync_manager = multiprocessing.Manager()\n        logger.info(\n            f\"[{self.service_name}] Started with max-{self.pool_size} graph workers\"\n        )\n        while True:\n            graph_exec_data = self.queue.get()\n            graph_exec_id = graph_exec_data.graph_exec_id\n            logger.debug(\n                f\"[ExecutionManager] Dispatching graph execution {graph_exec_id}\"\n            )\n            cancel_event = sync_manager.Event()\n            future = self.executor.submit(\n                Executor.on_graph_execution, graph_exec_data, cancel_event\n            )\n            self.active_graph_runs[graph_exec_id] = (future, cancel_event)\n            future.add_done_callback(\n                lambda _: self.active_graph_runs.pop(graph_exec_id, None)\n            )",
                                    "start_token": 4266,
                                    "end_token": -1,
                                    "children": [
                                        {
                                            "type": "import_from_statement",
                                            "label": "from backend.integrations.credentials_store import IntegrationCredentialsStore",
                                            "start_token": 4266,
                                            "end_token": 4273,
                                            "children": [
                                                {
                                                    "type": "dotted_name",
                                                    "label": "backend.integrations.credentials_store",
                                                    "start_token": 4266,
                                                    "end_token": 4268,
                                                    "children": [
                                                        {
                                                            "type": "identifier",
                                                            "label": "backend",
                                                            "start_token": 4266,
                                                            "end_token": 4266,
                                                            "children": []
                                                        },
                                                        {
                                                            "type": "identifier",
                                                            "label": "integrations",
                                                            "start_token": 4266,
                                                            "end_token": 4268,
                                                            "children": []
                                                        },
                                                        {
                                                            "type": "identifier",
                                                            "label": "credentials_store",
                                                            "start_token": 4268,
                                                            "end_token": 4268,
                                                            "children": []
                                                        }
                                                    ]
                                                },
                                                {
                                                    "type": "dotted_name",
                                                    "label": "IntegrationCredentialsStore",
                                                    "start_token": 4270,
                                                    "end_token": 4273,
                                                    "children": [
                                                        {
                                                            "type": "identifier",
                                                            "label": "IntegrationCredentialsStore",
                                                            "start_token": 4270,
                                                            "end_token": 4273,
                                                            "children": []
                                                        }
                                                    ]
                                                }
                                            ]
                                        },
                                        {
                                            "type": "expression_statement",
                                            "label": "self.credentials_store = IntegrationCredentialsStore()",
                                            "start_token": 4275,
                                            "end_token": 4283,
                                            "children": [
                                                {
                                                    "type": "assignment",
                                                    "label": "self.credentials_store = IntegrationCredentialsStore()",
                                                    "start_token": 4275,
                                                    "end_token": 4283,
                                                    "children": [
                                                        {
                                                            "type": "attribute",
                                                            "label": "self.credentials_store",
                                                            "start_token": 4275,
                                                            "end_token": 4275,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "label": "self",
                                                                    "start_token": 4275,
                                                                    "end_token": 4275,
                                                                    "children": []
                                                                },
                                                                {
                                                                    "type": "identifier",
                                                                    "label": "credentials_store",
                                                                    "start_token": 4275,
                                                                    "end_token": 4275,
                                                                    "children": []
                                                                }
                                                            ]
                                                        },
                                                        {
                                                            "type": "call",
                                                            "label": "IntegrationCredentialsStore()",
                                                            "start_token": 4277,
                                                            "end_token": 4283,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "label": "IntegrationCredentialsStore",
                                                                    "start_token": 4277,
                                                                    "end_token": 4283,
                                                                    "children": []
                                                                },
                                                                {
                                                                    "type": "argument_list",
                                                                    "label": "()",
                                                                    "start_token": 4283,
                                                                    "end_token": 4283,
                                                                    "children": []
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                }
                                            ]
                                        },
                                        {
                                            "type": "expression_statement",
                                            "label": "self.executor = ProcessPoolExecutor(\n            max_workers=self.pool_size,\n            initializer=Executor.on_graph_executor_start,\n        )",
                                            "start_token": 4283,
                                            "end_token": 4304,
                                            "children": [
                                                {
                                                    "type": "assignment",
                                                    "label": "self.executor = ProcessPoolExecutor(\n            max_workers=self.pool_size,\n            initializer=Executor.on_graph_executor_start,\n        )",
                                                    "start_token": 4283,
                                                    "end_token": 4304,
                                                    "children": [
                                                        {
                                                            "type": "attribute",
                                                            "label": "self.executor",
                                                            "start_token": 4283,
                                                            "end_token": -1,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "label": "self",
                                                                    "start_token": 4283,
                                                                    "end_token": 4283,
                                                                    "children": []
                                                                },
                                                                {
                                                                    "type": "identifier",
                                                                    "label": "executor",
                                                                    "start_token": 4283,
                                                                    "end_token": -1,
                                                                    "children": []
                                                                }
                                                            ]
                                                        },
                                                        {
                                                            "type": "call",
                                                            "label": "ProcessPoolExecutor(\n            max_workers=self.pool_size,\n            initializer=Executor.on_graph_executor_start,\n        )",
                                                            "start_token": -1,
                                                            "end_token": 4304,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "label": "ProcessPoolExecutor",
                                                                    "start_token": -1,
                                                                    "end_token": 4288,
                                                                    "children": []
                                                                },
                                                                {
                                                                    "type": "argument_list",
                                                                    "label": "(\n            max_workers=self.pool_size,\n            initializer=Executor.on_graph_executor_start,\n        )",
                                                                    "start_token": 4288,
                                                                    "end_token": 4304,
                                                                    "children": [
                                                                        {
                                                                            "type": "keyword_argument",
                                                                            "label": "max_workers=self.pool_size",
                                                                            "start_token": -1,
                                                                            "end_token": 4295,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "max_workers",
                                                                                    "start_token": -1,
                                                                                    "end_token": -1,
                                                                                    "children": []
                                                                                },
                                                                                {
                                                                                    "type": "attribute",
                                                                                    "label": "self.pool_size",
                                                                                    "start_token": 4293,
                                                                                    "end_token": 4295,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "label": "self",
                                                                                            "start_token": 4293,
                                                                                            "end_token": 4293,
                                                                                            "children": []
                                                                                        },
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "label": "pool_size",
                                                                                            "start_token": 4293,
                                                                                            "end_token": 4295,
                                                                                            "children": []
                                                                                        }
                                                                                    ]
                                                                                }
                                                                            ]
                                                                        },
                                                                        {
                                                                            "type": "keyword_argument",
                                                                            "label": "initializer=Executor.on_graph_executor_start",
                                                                            "start_token": 4297,
                                                                            "end_token": 4302,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "initializer",
                                                                                    "start_token": 4297,
                                                                                    "end_token": 4297,
                                                                                    "children": []
                                                                                },
                                                                                {
                                                                                    "type": "attribute",
                                                                                    "label": "Executor.on_graph_executor_start",
                                                                                    "start_token": 4297,
                                                                                    "end_token": 4302,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "label": "Executor",
                                                                                            "start_token": 4297,
                                                                                            "end_token": -1,
                                                                                            "children": []
                                                                                        },
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "label": "on_graph_executor_start",
                                                                                            "start_token": -1,
                                                                                            "end_token": 4302,
                                                                                            "children": []
                                                                                        }
                                                                                    ]
                                                                                }
                                                                            ]
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                }
                                            ]
                                        },
                                        {
                                            "type": "expression_statement",
                                            "label": "sync_manager = multiprocessing.Manager()",
                                            "start_token": 4304,
                                            "end_token": -1,
                                            "children": [
                                                {
                                                    "type": "assignment",
                                                    "label": "sync_manager = multiprocessing.Manager()",
                                                    "start_token": 4304,
                                                    "end_token": -1,
                                                    "children": [
                                                        {
                                                            "type": "identifier",
                                                            "label": "sync_manager",
                                                            "start_token": 4304,
                                                            "end_token": 4308,
                                                            "children": []
                                                        },
                                                        {
                                                            "type": "call",
                                                            "label": "multiprocessing.Manager()",
                                                            "start_token": -1,
                                                            "end_token": -1,
                                                            "children": [
                                                                {
                                                                    "type": "attribute",
                                                                    "label": "multiprocessing.Manager",
                                                                    "start_token": -1,
                                                                    "end_token": -1,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "multiprocessing",
                                                                            "start_token": -1,
                                                                            "end_token": 4312,
                                                                            "children": []
                                                                        },
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "Manager",
                                                                            "start_token": 4312,
                                                                            "end_token": -1,
                                                                            "children": []
                                                                        }
                                                                    ]
                                                                },
                                                                {
                                                                    "type": "argument_list",
                                                                    "label": "()",
                                                                    "start_token": -1,
                                                                    "end_token": -1,
                                                                    "children": []
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                }
                                            ]
                                        },
                                        {
                                            "type": "expression_statement",
                                            "label": "logger.info(\n            f\"[{self.service_name}] Started with max-{self.pool_size} graph workers\"\n        )",
                                            "start_token": 4316,
                                            "end_token": -1,
                                            "children": [
                                                {
                                                    "type": "call",
                                                    "label": "logger.info(\n            f\"[{self.service_name}] Started with max-{self.pool_size} graph workers\"\n        )",
                                                    "start_token": 4316,
                                                    "end_token": -1,
                                                    "children": [
                                                        {
                                                            "type": "attribute",
                                                            "label": "logger.info",
                                                            "start_token": 4316,
                                                            "end_token": 4316,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "label": "logger",
                                                                    "start_token": 4316,
                                                                    "end_token": 4316,
                                                                    "children": []
                                                                },
                                                                {
                                                                    "type": "identifier",
                                                                    "label": "info",
                                                                    "start_token": 4316,
                                                                    "end_token": 4316,
                                                                    "children": []
                                                                }
                                                            ]
                                                        },
                                                        {
                                                            "type": "argument_list",
                                                            "label": "(\n            f\"[{self.service_name}] Started with max-{self.pool_size} graph workers\"\n        )",
                                                            "start_token": 4316,
                                                            "end_token": -1,
                                                            "children": [
                                                                {
                                                                    "type": "string",
                                                                    "label": "f\"[{self.service_name}] Started with max-{self.pool_size} graph workers\"",
                                                                    "start_token": 4316,
                                                                    "end_token": 4321,
                                                                    "children": [
                                                                        {
                                                                            "type": "string_start",
                                                                            "label": "f\"",
                                                                            "start_token": 4316,
                                                                            "end_token": 4316,
                                                                            "children": []
                                                                        },
                                                                        {
                                                                            "type": "string_content",
                                                                            "label": "[",
                                                                            "start_token": 4316,
                                                                            "end_token": 4316,
                                                                            "children": []
                                                                        },
                                                                        {
                                                                            "type": "interpolation",
                                                                            "label": "{self.service_name}",
                                                                            "start_token": 4316,
                                                                            "end_token": 4316,
                                                                            "children": [
                                                                                {
                                                                                    "type": "attribute",
                                                                                    "label": "self.service_name",
                                                                                    "start_token": 4316,
                                                                                    "end_token": 4316,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "label": "self",
                                                                                            "start_token": 4316,
                                                                                            "end_token": 4316,
                                                                                            "children": []
                                                                                        },
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "label": "service_name",
                                                                                            "start_token": 4316,
                                                                                            "end_token": 4316,
                                                                                            "children": []
                                                                                        }
                                                                                    ]
                                                                                }
                                                                            ]
                                                                        },
                                                                        {
                                                                            "type": "string_content",
                                                                            "label": "] Started with max-",
                                                                            "start_token": 4316,
                                                                            "end_token": 4316,
                                                                            "children": []
                                                                        },
                                                                        {
                                                                            "type": "interpolation",
                                                                            "label": "{self.pool_size}",
                                                                            "start_token": 4316,
                                                                            "end_token": -1,
                                                                            "children": [
                                                                                {
                                                                                    "type": "attribute",
                                                                                    "label": "self.pool_size",
                                                                                    "start_token": 4316,
                                                                                    "end_token": -1,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "label": "self",
                                                                                            "start_token": 4316,
                                                                                            "end_token": -1,
                                                                                            "children": []
                                                                                        },
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "label": "pool_size",
                                                                                            "start_token": -1,
                                                                                            "end_token": -1,
                                                                                            "children": []
                                                                                        }
                                                                                    ]
                                                                                }
                                                                            ]
                                                                        },
                                                                        {
                                                                            "type": "string_content",
                                                                            "label": " graph workers",
                                                                            "start_token": -1,
                                                                            "end_token": 4321,
                                                                            "children": []
                                                                        },
                                                                        {
                                                                            "type": "string_end",
                                                                            "label": "\"",
                                                                            "start_token": 4321,
                                                                            "end_token": 4321,
                                                                            "children": []
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                }
                                            ]
                                        },
                                        {
                                            "type": "while_statement",
                                            "label": "while True:\n            graph_exec_data = self.queue.get()\n            graph_exec_id = graph_exec_data.graph_exec_id\n            logger.debug(\n                f\"[ExecutionManager] Dispatching graph execution {graph_exec_id}\"\n            )\n            cancel_event = sync_manager.Event()\n            future = self.executor.submit(\n                Executor.on_graph_execution, graph_exec_data, cancel_event\n            )\n            self.active_graph_runs[graph_exec_id] = (future, cancel_event)\n            future.add_done_callback(\n                lambda _: self.active_graph_runs.pop(graph_exec_id, None)\n            )",
                                            "start_token": 4324,
                                            "end_token": -1,
                                            "children": [
                                                {
                                                    "type": "true",
                                                    "label": "True",
                                                    "start_token": 4324,
                                                    "end_token": 4324,
                                                    "children": []
                                                },
                                                {
                                                    "type": "block",
                                                    "label": "graph_exec_data = self.queue.get()\n            graph_exec_id = graph_exec_data.graph_exec_id\n            logger.debug(\n                f\"[ExecutionManager] Dispatching graph execution {graph_exec_id}\"\n            )\n            cancel_event = sync_manager.Event()\n            future = self.executor.submit(\n                Executor.on_graph_execution, graph_exec_data, cancel_event\n            )\n            self.active_graph_runs[graph_exec_id] = (future, cancel_event)\n            future.add_done_callback(\n                lambda _: self.active_graph_runs.pop(graph_exec_id, None)\n            )",
                                                    "start_token": 4329,
                                                    "end_token": -1,
                                                    "children": [
                                                        {
                                                            "type": "expression_statement",
                                                            "label": "graph_exec_data = self.queue.get()",
                                                            "start_token": 4329,
                                                            "end_token": 4335,
                                                            "children": [
                                                                {
                                                                    "type": "assignment",
                                                                    "label": "graph_exec_data = self.queue.get()",
                                                                    "start_token": 4329,
                                                                    "end_token": 4335,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "graph_exec_data",
                                                                            "start_token": 4329,
                                                                            "end_token": -1,
                                                                            "children": []
                                                                        },
                                                                        {
                                                                            "type": "call",
                                                                            "label": "self.queue.get()",
                                                                            "start_token": -1,
                                                                            "end_token": 4335,
                                                                            "children": [
                                                                                {
                                                                                    "type": "attribute",
                                                                                    "label": "self.queue.get",
                                                                                    "start_token": -1,
                                                                                    "end_token": 4334,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "attribute",
                                                                                            "label": "self.queue",
                                                                                            "start_token": -1,
                                                                                            "end_token": 4334,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "label": "self",
                                                                                                    "start_token": -1,
                                                                                                    "end_token": 4334,
                                                                                                    "children": []
                                                                                                },
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "label": "queue",
                                                                                                    "start_token": 4334,
                                                                                                    "end_token": 4334,
                                                                                                    "children": []
                                                                                                }
                                                                                            ]
                                                                                        },
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "label": "get",
                                                                                            "start_token": 4334,
                                                                                            "end_token": 4334,
                                                                                            "children": []
                                                                                        }
                                                                                    ]
                                                                                },
                                                                                {
                                                                                    "type": "argument_list",
                                                                                    "label": "()",
                                                                                    "start_token": -1,
                                                                                    "end_token": 4335,
                                                                                    "children": []
                                                                                }
                                                                            ]
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        },
                                                        {
                                                            "type": "expression_statement",
                                                            "label": "graph_exec_id = graph_exec_data.graph_exec_id",
                                                            "start_token": 4336,
                                                            "end_token": -1,
                                                            "children": [
                                                                {
                                                                    "type": "assignment",
                                                                    "label": "graph_exec_id = graph_exec_data.graph_exec_id",
                                                                    "start_token": 4336,
                                                                    "end_token": -1,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "graph_exec_id",
                                                                            "start_token": 4336,
                                                                            "end_token": 4338,
                                                                            "children": []
                                                                        },
                                                                        {
                                                                            "type": "attribute",
                                                                            "label": "graph_exec_data.graph_exec_id",
                                                                            "start_token": 4338,
                                                                            "end_token": -1,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "graph_exec_data",
                                                                                    "start_token": 4338,
                                                                                    "end_token": 4340,
                                                                                    "children": []
                                                                                },
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "graph_exec_id",
                                                                                    "start_token": 4340,
                                                                                    "end_token": -1,
                                                                                    "children": []
                                                                                }
                                                                            ]
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        },
                                                        {
                                                            "type": "expression_statement",
                                                            "label": "logger.debug(\n                f\"[ExecutionManager] Dispatching graph execution {graph_exec_id}\"\n            )",
                                                            "start_token": -1,
                                                            "end_token": -1,
                                                            "children": [
                                                                {
                                                                    "type": "call",
                                                                    "label": "logger.debug(\n                f\"[ExecutionManager] Dispatching graph execution {graph_exec_id}\"\n            )",
                                                                    "start_token": -1,
                                                                    "end_token": -1,
                                                                    "children": [
                                                                        {
                                                                            "type": "attribute",
                                                                            "label": "logger.debug",
                                                                            "start_token": -1,
                                                                            "end_token": 4346,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "logger",
                                                                                    "start_token": -1,
                                                                                    "end_token": 4346,
                                                                                    "children": []
                                                                                },
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "debug",
                                                                                    "start_token": 4346,
                                                                                    "end_token": 4346,
                                                                                    "children": []
                                                                                }
                                                                            ]
                                                                        },
                                                                        {
                                                                            "type": "argument_list",
                                                                            "label": "(\n                f\"[ExecutionManager] Dispatching graph execution {graph_exec_id}\"\n            )",
                                                                            "start_token": 4346,
                                                                            "end_token": -1,
                                                                            "children": [
                                                                                {
                                                                                    "type": "string",
                                                                                    "label": "f\"[ExecutionManager] Dispatching graph execution {graph_exec_id}\"",
                                                                                    "start_token": 4346,
                                                                                    "end_token": 4350,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "string_start",
                                                                                            "label": "f\"",
                                                                                            "start_token": 4346,
                                                                                            "end_token": 4346,
                                                                                            "children": []
                                                                                        },
                                                                                        {
                                                                                            "type": "string_content",
                                                                                            "label": "[ExecutionManager] Dispatching graph execution ",
                                                                                            "start_token": 4346,
                                                                                            "end_token": -1,
                                                                                            "children": []
                                                                                        },
                                                                                        {
                                                                                            "type": "interpolation",
                                                                                            "label": "{graph_exec_id}",
                                                                                            "start_token": -1,
                                                                                            "end_token": -1,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "label": "graph_exec_id",
                                                                                                    "start_token": 4348,
                                                                                                    "end_token": -1,
                                                                                                    "children": []
                                                                                                }
                                                                                            ]
                                                                                        },
                                                                                        {
                                                                                            "type": "string_end",
                                                                                            "label": "\"",
                                                                                            "start_token": 4350,
                                                                                            "end_token": 4350,
                                                                                            "children": []
                                                                                        }
                                                                                    ]
                                                                                }
                                                                            ]
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        },
                                                        {
                                                            "type": "expression_statement",
                                                            "label": "cancel_event = sync_manager.Event()",
                                                            "start_token": 4354,
                                                            "end_token": 4362,
                                                            "children": [
                                                                {
                                                                    "type": "assignment",
                                                                    "label": "cancel_event = sync_manager.Event()",
                                                                    "start_token": 4354,
                                                                    "end_token": 4362,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "cancel_event",
                                                                            "start_token": 4354,
                                                                            "end_token": -1,
                                                                            "children": []
                                                                        },
                                                                        {
                                                                            "type": "call",
                                                                            "label": "sync_manager.Event()",
                                                                            "start_token": -1,
                                                                            "end_token": 4362,
                                                                            "children": [
                                                                                {
                                                                                    "type": "attribute",
                                                                                    "label": "sync_manager.Event",
                                                                                    "start_token": -1,
                                                                                    "end_token": 4360,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "label": "sync_manager",
                                                                                            "start_token": -1,
                                                                                            "end_token": -1,
                                                                                            "children": []
                                                                                        },
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "label": "Event",
                                                                                            "start_token": -1,
                                                                                            "end_token": 4360,
                                                                                            "children": []
                                                                                        }
                                                                                    ]
                                                                                },
                                                                                {
                                                                                    "type": "argument_list",
                                                                                    "label": "()",
                                                                                    "start_token": 4361,
                                                                                    "end_token": 4362,
                                                                                    "children": []
                                                                                }
                                                                            ]
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        },
                                                        {
                                                            "type": "expression_statement",
                                                            "label": "future = self.executor.submit(\n                Executor.on_graph_execution, graph_exec_data, cancel_event\n            )",
                                                            "start_token": 4364,
                                                            "end_token": 4379,
                                                            "children": [
                                                                {
                                                                    "type": "assignment",
                                                                    "label": "future = self.executor.submit(\n                Executor.on_graph_execution, graph_exec_data, cancel_event\n            )",
                                                                    "start_token": 4364,
                                                                    "end_token": 4379,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "future",
                                                                            "start_token": 4364,
                                                                            "end_token": -1,
                                                                            "children": []
                                                                        },
                                                                        {
                                                                            "type": "call",
                                                                            "label": "self.executor.submit(\n                Executor.on_graph_execution, graph_exec_data, cancel_event\n            )",
                                                                            "start_token": -1,
                                                                            "end_token": 4379,
                                                                            "children": [
                                                                                {
                                                                                    "type": "attribute",
                                                                                    "label": "self.executor.submit",
                                                                                    "start_token": -1,
                                                                                    "end_token": 4369,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "attribute",
                                                                                            "label": "self.executor",
                                                                                            "start_token": -1,
                                                                                            "end_token": 4367,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "label": "self",
                                                                                                    "start_token": -1,
                                                                                                    "end_token": -1,
                                                                                                    "children": []
                                                                                                },
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "label": "executor",
                                                                                                    "start_token": -1,
                                                                                                    "end_token": 4367,
                                                                                                    "children": []
                                                                                                }
                                                                                            ]
                                                                                        },
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "label": "submit",
                                                                                            "start_token": 4367,
                                                                                            "end_token": 4369,
                                                                                            "children": []
                                                                                        }
                                                                                    ]
                                                                                },
                                                                                {
                                                                                    "type": "argument_list",
                                                                                    "label": "(\n                Executor.on_graph_execution, graph_exec_data, cancel_event\n            )",
                                                                                    "start_token": 4369,
                                                                                    "end_token": 4379,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "attribute",
                                                                                            "label": "Executor.on_graph_execution",
                                                                                            "start_token": -1,
                                                                                            "end_token": 4373,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "label": "Executor",
                                                                                                    "start_token": -1,
                                                                                                    "end_token": 4371,
                                                                                                    "children": []
                                                                                                },
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "label": "on_graph_execution",
                                                                                                    "start_token": 4371,
                                                                                                    "end_token": 4373,
                                                                                                    "children": []
                                                                                                }
                                                                                            ]
                                                                                        },
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "label": "graph_exec_data",
                                                                                            "start_token": 4373,
                                                                                            "end_token": 4375,
                                                                                            "children": []
                                                                                        },
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "label": "cancel_event",
                                                                                            "start_token": -1,
                                                                                            "end_token": 4377,
                                                                                            "children": []
                                                                                        }
                                                                                    ]
                                                                                }
                                                                            ]
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        },
                                                        {
                                                            "type": "expression_statement",
                                                            "label": "self.active_graph_runs[graph_exec_id] = (future, cancel_event)",
                                                            "start_token": 4381,
                                                            "end_token": 4392,
                                                            "children": [
                                                                {
                                                                    "type": "assignment",
                                                                    "label": "self.active_graph_runs[graph_exec_id] = (future, cancel_event)",
                                                                    "start_token": 4381,
                                                                    "end_token": 4392,
                                                                    "children": [
                                                                        {
                                                                            "type": "subscript",
                                                                            "label": "self.active_graph_runs[graph_exec_id]",
                                                                            "start_token": 4381,
                                                                            "end_token": -1,
                                                                            "children": [
                                                                                {
                                                                                    "type": "attribute",
                                                                                    "label": "self.active_graph_runs",
                                                                                    "start_token": 4381,
                                                                                    "end_token": 4387,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "label": "self",
                                                                                            "start_token": 4381,
                                                                                            "end_token": 4381,
                                                                                            "children": []
                                                                                        },
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "label": "active_graph_runs",
                                                                                            "start_token": 4381,
                                                                                            "end_token": 4387,
                                                                                            "children": []
                                                                                        }
                                                                                    ]
                                                                                },
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "graph_exec_id",
                                                                                    "start_token": 4387,
                                                                                    "end_token": -1,
                                                                                    "children": []
                                                                                }
                                                                            ]
                                                                        },
                                                                        {
                                                                            "type": "tuple",
                                                                            "label": "(future, cancel_event)",
                                                                            "start_token": -1,
                                                                            "end_token": 4392,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "future",
                                                                                    "start_token": -1,
                                                                                    "end_token": -1,
                                                                                    "children": []
                                                                                },
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "cancel_event",
                                                                                    "start_token": 4390,
                                                                                    "end_token": 4392,
                                                                                    "children": []
                                                                                }
                                                                            ]
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        },
                                                        {
                                                            "type": "expression_statement",
                                                            "label": "future.add_done_callback(\n                lambda _: self.active_graph_runs.pop(graph_exec_id, None)\n            )",
                                                            "start_token": -1,
                                                            "end_token": -1,
                                                            "children": [
                                                                {
                                                                    "type": "call",
                                                                    "label": "future.add_done_callback(\n                lambda _: self.active_graph_runs.pop(graph_exec_id, None)\n            )",
                                                                    "start_token": -1,
                                                                    "end_token": -1,
                                                                    "children": [
                                                                        {
                                                                            "type": "attribute",
                                                                            "label": "future.add_done_callback",
                                                                            "start_token": -1,
                                                                            "end_token": -1,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "future",
                                                                                    "start_token": -1,
                                                                                    "end_token": -1,
                                                                                    "children": []
                                                                                },
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "add_done_callback",
                                                                                    "start_token": -1,
                                                                                    "end_token": -1,
                                                                                    "children": []
                                                                                }
                                                                            ]
                                                                        },
                                                                        {
                                                                            "type": "argument_list",
                                                                            "label": "(\n                lambda _: self.active_graph_runs.pop(graph_exec_id, None)\n            )",
                                                                            "start_token": 4398,
                                                                            "end_token": -1,
                                                                            "children": [
                                                                                {
                                                                                    "type": "lambda",
                                                                                    "label": "lambda _: self.active_graph_runs.pop(graph_exec_id, None)",
                                                                                    "start_token": 4400,
                                                                                    "end_token": 4413,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "lambda_parameters",
                                                                                            "label": "_",
                                                                                            "start_token": 4402,
                                                                                            "end_token": 4402,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "label": "_",
                                                                                                    "start_token": 4402,
                                                                                                    "end_token": 4402,
                                                                                                    "children": []
                                                                                                }
                                                                                            ]
                                                                                        },
                                                                                        {
                                                                                            "type": "call",
                                                                                            "label": "self.active_graph_runs.pop(graph_exec_id, None)",
                                                                                            "start_token": 4404,
                                                                                            "end_token": 4413,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "attribute",
                                                                                                    "label": "self.active_graph_runs.pop",
                                                                                                    "start_token": 4404,
                                                                                                    "end_token": -1,
                                                                                                    "children": [
                                                                                                        {
                                                                                                            "type": "attribute",
                                                                                                            "label": "self.active_graph_runs",
                                                                                                            "start_token": 4404,
                                                                                                            "end_token": -1,
                                                                                                            "children": [
                                                                                                                {
                                                                                                                    "type": "identifier",
                                                                                                                    "label": "self",
                                                                                                                    "start_token": 4404,
                                                                                                                    "end_token": 4404,
                                                                                                                    "children": []
                                                                                                                },
                                                                                                                {
                                                                                                                    "type": "identifier",
                                                                                                                    "label": "active_graph_runs",
                                                                                                                    "start_token": 4404,
                                                                                                                    "end_token": -1,
                                                                                                                    "children": []
                                                                                                                }
                                                                                                            ]
                                                                                                        },
                                                                                                        {
                                                                                                            "type": "identifier",
                                                                                                            "label": "pop",
                                                                                                            "start_token": -1,
                                                                                                            "end_token": -1,
                                                                                                            "children": []
                                                                                                        }
                                                                                                    ]
                                                                                                },
                                                                                                {
                                                                                                    "type": "argument_list",
                                                                                                    "label": "(graph_exec_id, None)",
                                                                                                    "start_token": -1,
                                                                                                    "end_token": 4413,
                                                                                                    "children": [
                                                                                                        {
                                                                                                            "type": "identifier",
                                                                                                            "label": "graph_exec_id",
                                                                                                            "start_token": -1,
                                                                                                            "end_token": 4412,
                                                                                                            "children": []
                                                                                                        },
                                                                                                        {
                                                                                                            "type": "none",
                                                                                                            "label": "None",
                                                                                                            "start_token": -1,
                                                                                                            "end_token": 4413,
                                                                                                            "children": []
                                                                                                        }
                                                                                                    ]
                                                                                                }
                                                                                            ]
                                                                                        }
                                                                                    ]
                                                                                }
                                                                            ]
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                }
                                            ]
                                        }
                                    ]
                                }
                            ]
                        },
                        {
                            "type": "function_definition",
                            "label": "def cleanup(self):\n        logger.info(f\"[{__class__.__name__}] ⏳ Shutting down graph executor pool...\")\n        self.executor.shutdown(cancel_futures=True)\n\n        super().cleanup()",
                            "start_token": 4419,
                            "end_token": 4452,
                            "children": [
                                {
                                    "type": "identifier",
                                    "label": "cleanup",
                                    "start_token": 4419,
                                    "end_token": 4422,
                                    "children": []
                                },
                                {
                                    "type": "parameters",
                                    "label": "(self)",
                                    "start_token": 4423,
                                    "end_token": 4424,
                                    "children": [
                                        {
                                            "type": "identifier",
                                            "label": "self",
                                            "start_token": 4424,
                                            "end_token": 4424,
                                            "children": []
                                        }
                                    ]
                                },
                                {
                                    "type": "block",
                                    "label": "logger.info(f\"[{__class__.__name__}] ⏳ Shutting down graph executor pool...\")\n        self.executor.shutdown(cancel_futures=True)\n\n        super().cleanup()",
                                    "start_token": 4424,
                                    "end_token": 4452,
                                    "children": [
                                        {
                                            "type": "expression_statement",
                                            "label": "logger.info(f\"[{__class__.__name__}] ⏳ Shutting down graph executor pool...\")",
                                            "start_token": 4424,
                                            "end_token": 4431,
                                            "children": [
                                                {
                                                    "type": "call",
                                                    "label": "logger.info(f\"[{__class__.__name__}] ⏳ Shutting down graph executor pool...\")",
                                                    "start_token": 4424,
                                                    "end_token": 4431,
                                                    "children": [
                                                        {
                                                            "type": "attribute",
                                                            "label": "logger.info",
                                                            "start_token": 4424,
                                                            "end_token": 4424,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "label": "logger",
                                                                    "start_token": 4424,
                                                                    "end_token": 4424,
                                                                    "children": []
                                                                },
                                                                {
                                                                    "type": "identifier",
                                                                    "label": "info",
                                                                    "start_token": 4424,
                                                                    "end_token": 4424,
                                                                    "children": []
                                                                }
                                                            ]
                                                        },
                                                        {
                                                            "type": "argument_list",
                                                            "label": "(f\"[{__class__.__name__}] ⏳ Shutting down graph executor pool...\")",
                                                            "start_token": 4424,
                                                            "end_token": 4431,
                                                            "children": [
                                                                {
                                                                    "type": "string",
                                                                    "label": "f\"[{__class__.__name__}] ⏳ Shutting down graph executor pool...\"",
                                                                    "start_token": 4424,
                                                                    "end_token": 4431,
                                                                    "children": [
                                                                        {
                                                                            "type": "string_start",
                                                                            "label": "f\"",
                                                                            "start_token": 4424,
                                                                            "end_token": 4424,
                                                                            "children": []
                                                                        },
                                                                        {
                                                                            "type": "string_content",
                                                                            "label": "[",
                                                                            "start_token": 4424,
                                                                            "end_token": 4424,
                                                                            "children": []
                                                                        },
                                                                        {
                                                                            "type": "interpolation",
                                                                            "label": "{__class__.__name__}",
                                                                            "start_token": 4424,
                                                                            "end_token": 4424,
                                                                            "children": [
                                                                                {
                                                                                    "type": "attribute",
                                                                                    "label": "__class__.__name__",
                                                                                    "start_token": 4424,
                                                                                    "end_token": 4424,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "label": "__class__",
                                                                                            "start_token": 4424,
                                                                                            "end_token": 4424,
                                                                                            "children": []
                                                                                        },
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "label": "__name__",
                                                                                            "start_token": 4424,
                                                                                            "end_token": 4424,
                                                                                            "children": []
                                                                                        }
                                                                                    ]
                                                                                }
                                                                            ]
                                                                        },
                                                                        {
                                                                            "type": "string_content",
                                                                            "label": "] ⏳ Shutting down graph executor pool...",
                                                                            "start_token": 4424,
                                                                            "end_token": 4431,
                                                                            "children": []
                                                                        },
                                                                        {
                                                                            "type": "string_end",
                                                                            "label": "\"",
                                                                            "start_token": 4431,
                                                                            "end_token": 4431,
                                                                            "children": []
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                }
                                            ]
                                        },
                                        {
                                            "type": "expression_statement",
                                            "label": "self.executor.shutdown(cancel_futures=True)",
                                            "start_token": 4433,
                                            "end_token": -1,
                                            "children": [
                                                {
                                                    "type": "call",
                                                    "label": "self.executor.shutdown(cancel_futures=True)",
                                                    "start_token": 4433,
                                                    "end_token": -1,
                                                    "children": [
                                                        {
                                                            "type": "attribute",
                                                            "label": "self.executor.shutdown",
                                                            "start_token": 4433,
                                                            "end_token": -1,
                                                            "children": [
                                                                {
                                                                    "type": "attribute",
                                                                    "label": "self.executor",
                                                                    "start_token": 4433,
                                                                    "end_token": 4436,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "self",
                                                                            "start_token": 4433,
                                                                            "end_token": 4433,
                                                                            "children": []
                                                                        },
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "executor",
                                                                            "start_token": 4433,
                                                                            "end_token": 4436,
                                                                            "children": []
                                                                        }
                                                                    ]
                                                                },
                                                                {
                                                                    "type": "identifier",
                                                                    "label": "shutdown",
                                                                    "start_token": 4438,
                                                                    "end_token": -1,
                                                                    "children": []
                                                                }
                                                            ]
                                                        },
                                                        {
                                                            "type": "argument_list",
                                                            "label": "(cancel_futures=True)",
                                                            "start_token": -1,
                                                            "end_token": -1,
                                                            "children": [
                                                                {
                                                                    "type": "keyword_argument",
                                                                    "label": "cancel_futures=True",
                                                                    "start_token": 4439,
                                                                    "end_token": 4447,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "cancel_futures",
                                                                            "start_token": 4439,
                                                                            "end_token": 4443,
                                                                            "children": []
                                                                        },
                                                                        {
                                                                            "type": "true",
                                                                            "label": "True",
                                                                            "start_token": 4444,
                                                                            "end_token": 4447,
                                                                            "children": []
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                }
                                            ]
                                        },
                                        {
                                            "type": "expression_statement",
                                            "label": "super().cleanup()",
                                            "start_token": 4449,
                                            "end_token": 4452,
                                            "children": [
                                                {
                                                    "type": "call",
                                                    "label": "super().cleanup()",
                                                    "start_token": 4449,
                                                    "end_token": 4452,
                                                    "children": [
                                                        {
                                                            "type": "attribute",
                                                            "label": "super().cleanup",
                                                            "start_token": 4449,
                                                            "end_token": 4452,
                                                            "children": [
                                                                {
                                                                    "type": "call",
                                                                    "label": "super()",
                                                                    "start_token": 4449,
                                                                    "end_token": -1,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "super",
                                                                            "start_token": 4449,
                                                                            "end_token": -1,
                                                                            "children": []
                                                                        },
                                                                        {
                                                                            "type": "argument_list",
                                                                            "label": "()",
                                                                            "start_token": -1,
                                                                            "end_token": -1,
                                                                            "children": []
                                                                        }
                                                                    ]
                                                                },
                                                                {
                                                                    "type": "identifier",
                                                                    "label": "cleanup",
                                                                    "start_token": 4451,
                                                                    "end_token": 4452,
                                                                    "children": []
                                                                }
                                                            ]
                                                        },
                                                        {
                                                            "type": "argument_list",
                                                            "label": "()",
                                                            "start_token": 4452,
                                                            "end_token": 4452,
                                                            "children": []
                                                        }
                                                    ]
                                                }
                                            ]
                                        }
                                    ]
                                }
                            ]
                        },
                        {
                            "type": "decorated_definition",
                            "label": "@property\n    def db_client(self) -> \"DatabaseManager\":\n        return get_db_client()",
                            "start_token": 4454,
                            "end_token": 4471,
                            "children": [
                                {
                                    "type": "decorator",
                                    "label": "@property",
                                    "start_token": 4454,
                                    "end_token": 4458,
                                    "children": [
                                        {
                                            "type": "identifier",
                                            "label": "property",
                                            "start_token": 4454,
                                            "end_token": 4458,
                                            "children": []
                                        }
                                    ]
                                },
                                {
                                    "type": "function_definition",
                                    "label": "def db_client(self) -> \"DatabaseManager\":\n        return get_db_client()",
                                    "start_token": 4458,
                                    "end_token": 4471,
                                    "children": [
                                        {
                                            "type": "identifier",
                                            "label": "db_client",
                                            "start_token": 4458,
                                            "end_token": -1,
                                            "children": []
                                        },
                                        {
                                            "type": "parameters",
                                            "label": "(self)",
                                            "start_token": -1,
                                            "end_token": -1,
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "label": "self",
                                                    "start_token": -1,
                                                    "end_token": -1,
                                                    "children": []
                                                }
                                            ]
                                        },
                                        {
                                            "type": "type",
                                            "label": "\"DatabaseManager\"",
                                            "start_token": 4461,
                                            "end_token": 4462,
                                            "children": [
                                                {
                                                    "type": "string",
                                                    "label": "\"DatabaseManager\"",
                                                    "start_token": 4461,
                                                    "end_token": 4462,
                                                    "children": [
                                                        {
                                                            "type": "string_start",
                                                            "label": "\"",
                                                            "start_token": 4461,
                                                            "end_token": 4461,
                                                            "children": []
                                                        },
                                                        {
                                                            "type": "string_content",
                                                            "label": "DatabaseManager",
                                                            "start_token": 4461,
                                                            "end_token": 4462,
                                                            "children": []
                                                        },
                                                        {
                                                            "type": "string_end",
                                                            "label": "\"",
                                                            "start_token": 4462,
                                                            "end_token": 4462,
                                                            "children": []
                                                        }
                                                    ]
                                                }
                                            ]
                                        },
                                        {
                                            "type": "block",
                                            "label": "return get_db_client()",
                                            "start_token": 4468,
                                            "end_token": 4471,
                                            "children": [
                                                {
                                                    "type": "return_statement",
                                                    "label": "return get_db_client()",
                                                    "start_token": 4468,
                                                    "end_token": 4471,
                                                    "children": [
                                                        {
                                                            "type": "call",
                                                            "label": "get_db_client()",
                                                            "start_token": -1,
                                                            "end_token": 4471,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "label": "get_db_client",
                                                                    "start_token": -1,
                                                                    "end_token": 4471,
                                                                    "children": []
                                                                },
                                                                {
                                                                    "type": "argument_list",
                                                                    "label": "()",
                                                                    "start_token": 4471,
                                                                    "end_token": 4471,
                                                                    "children": []
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                }
                                            ]
                                        }
                                    ]
                                }
                            ]
                        },
                        {
                            "type": "decorated_definition",
                            "label": "@expose\n    def add_execution(\n        self,\n        graph_id: str,\n        data: BlockInput,\n        user_id: str,\n        graph_version: int | None = None,\n    ) -> GraphExecutionEntry:\n        graph: GraphModel | None = self.db_client.get_graph(\n            graph_id=graph_id, user_id=user_id, version=graph_version\n        )\n        if not graph:\n            raise ValueError(f\"Graph #{graph_id} not found.\")\n\n        graph.validate_graph(for_run=True)\n        self._validate_node_input_credentials(graph, user_id)\n\n        nodes_input = []\n        for node in graph.starting_nodes:\n            input_data = {}\n            block = get_block(node.block_id)\n\n            # Invalid block & Note block should never be executed.\n            if not block or block.block_type == BlockType.NOTE:\n                continue\n\n            # Extract request input data, and assign it to the input pin.\n            if block.block_type == BlockType.INPUT:\n                name = node.input_default.get(\"name\")\n                if name and name in data:\n                    input_data = {\"value\": data[name]}\n\n            # Extract webhook payload, and assign it to the input pin\n            webhook_payload_key = f\"webhook_{node.webhook_id}_payload\"\n            if (\n                block.block_type in (BlockType.WEBHOOK, BlockType.WEBHOOK_MANUAL)\n                and node.webhook_id\n            ):\n                if webhook_payload_key not in data:\n                    raise ValueError(\n                        f\"Node {block.name} #{node.id} webhook payload is missing\"\n                    )\n                input_data = {\"payload\": data[webhook_payload_key]}\n\n            input_data, error = validate_exec(node, input_data)\n            if input_data is None:\n                raise ValueError(error)\n            else:\n                nodes_input.append((node.id, input_data))\n\n        graph_exec_id, node_execs = self.db_client.create_graph_execution(\n            graph_id=graph_id,\n            graph_version=graph.version,\n            nodes_input=nodes_input,\n            user_id=user_id,\n        )\n\n        starting_node_execs = []\n        for node_exec in node_execs:\n            starting_node_execs.append(\n                NodeExecutionEntry(\n                    user_id=user_id,\n                    graph_exec_id=node_exec.graph_exec_id,\n                    graph_id=node_exec.graph_id,\n                    node_exec_id=node_exec.node_exec_id,\n                    node_id=node_exec.node_id,\n                    data=node_exec.input_data,\n                )\n            )\n            exec_update = self.db_client.update_execution_status(\n                node_exec.node_exec_id, ExecutionStatus.QUEUED, node_exec.input_data\n            )\n            self.db_client.send_execution_update(exec_update)\n\n        graph_exec = GraphExecutionEntry(\n            user_id=user_id,\n            graph_id=graph_id,\n            graph_exec_id=graph_exec_id,\n            start_node_execs=starting_node_execs,\n        )\n        self.queue.add(graph_exec)\n\n        return graph_exec",
                            "start_token": 4473,
                            "end_token": 4968,
                            "children": [
                                {
                                    "type": "decorator",
                                    "label": "@expose",
                                    "start_token": 4473,
                                    "end_token": -1,
                                    "children": [
                                        {
                                            "type": "identifier",
                                            "label": "expose",
                                            "start_token": -1,
                                            "end_token": -1,
                                            "children": []
                                        }
                                    ]
                                },
                                {
                                    "type": "function_definition",
                                    "label": "def add_execution(\n        self,\n        graph_id: str,\n        data: BlockInput,\n        user_id: str,\n        graph_version: int | None = None,\n    ) -> GraphExecutionEntry:\n        graph: GraphModel | None = self.db_client.get_graph(\n            graph_id=graph_id, user_id=user_id, version=graph_version\n        )\n        if not graph:\n            raise ValueError(f\"Graph #{graph_id} not found.\")\n\n        graph.validate_graph(for_run=True)\n        self._validate_node_input_credentials(graph, user_id)\n\n        nodes_input = []\n        for node in graph.starting_nodes:\n            input_data = {}\n            block = get_block(node.block_id)\n\n            # Invalid block & Note block should never be executed.\n            if not block or block.block_type == BlockType.NOTE:\n                continue\n\n            # Extract request input data, and assign it to the input pin.\n            if block.block_type == BlockType.INPUT:\n                name = node.input_default.get(\"name\")\n                if name and name in data:\n                    input_data = {\"value\": data[name]}\n\n            # Extract webhook payload, and assign it to the input pin\n            webhook_payload_key = f\"webhook_{node.webhook_id}_payload\"\n            if (\n                block.block_type in (BlockType.WEBHOOK, BlockType.WEBHOOK_MANUAL)\n                and node.webhook_id\n            ):\n                if webhook_payload_key not in data:\n                    raise ValueError(\n                        f\"Node {block.name} #{node.id} webhook payload is missing\"\n                    )\n                input_data = {\"payload\": data[webhook_payload_key]}\n\n            input_data, error = validate_exec(node, input_data)\n            if input_data is None:\n                raise ValueError(error)\n            else:\n                nodes_input.append((node.id, input_data))\n\n        graph_exec_id, node_execs = self.db_client.create_graph_execution(\n            graph_id=graph_id,\n            graph_version=graph.version,\n            nodes_input=nodes_input,\n            user_id=user_id,\n        )\n\n        starting_node_execs = []\n        for node_exec in node_execs:\n            starting_node_execs.append(\n                NodeExecutionEntry(\n                    user_id=user_id,\n                    graph_exec_id=node_exec.graph_exec_id,\n                    graph_id=node_exec.graph_id,\n                    node_exec_id=node_exec.node_exec_id,\n                    node_id=node_exec.node_id,\n                    data=node_exec.input_data,\n                )\n            )\n            exec_update = self.db_client.update_execution_status(\n                node_exec.node_exec_id, ExecutionStatus.QUEUED, node_exec.input_data\n            )\n            self.db_client.send_execution_update(exec_update)\n\n        graph_exec = GraphExecutionEntry(\n            user_id=user_id,\n            graph_id=graph_id,\n            graph_exec_id=graph_exec_id,\n            start_node_execs=starting_node_execs,\n        )\n        self.queue.add(graph_exec)\n\n        return graph_exec",
                                    "start_token": 4474,
                                    "end_token": 4968,
                                    "children": [
                                        {
                                            "type": "identifier",
                                            "label": "add_execution",
                                            "start_token": -1,
                                            "end_token": 4477,
                                            "children": []
                                        },
                                        {
                                            "type": "parameters",
                                            "label": "(\n        self,\n        graph_id: str,\n        data: BlockInput,\n        user_id: str,\n        graph_version: int | None = None,\n    )",
                                            "start_token": 4477,
                                            "end_token": -1,
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "label": "self",
                                                    "start_token": -1,
                                                    "end_token": -1,
                                                    "children": []
                                                },
                                                {
                                                    "type": "typed_parameter",
                                                    "label": "graph_id: str",
                                                    "start_token": 4484,
                                                    "end_token": -1,
                                                    "children": [
                                                        {
                                                            "type": "identifier",
                                                            "label": "graph_id",
                                                            "start_token": 4484,
                                                            "end_token": 4484,
                                                            "children": []
                                                        },
                                                        {
                                                            "type": "type",
                                                            "label": "str",
                                                            "start_token": 4486,
                                                            "end_token": -1,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "label": "str",
                                                                    "start_token": 4486,
                                                                    "end_token": -1,
                                                                    "children": []
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                },
                                                {
                                                    "type": "typed_parameter",
                                                    "label": "data: BlockInput",
                                                    "start_token": 4487,
                                                    "end_token": -1,
                                                    "children": [
                                                        {
                                                            "type": "identifier",
                                                            "label": "data",
                                                            "start_token": 4487,
                                                            "end_token": 4488,
                                                            "children": []
                                                        },
                                                        {
                                                            "type": "type",
                                                            "label": "BlockInput",
                                                            "start_token": 4489,
                                                            "end_token": -1,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "label": "BlockInput",
                                                                    "start_token": 4489,
                                                                    "end_token": -1,
                                                                    "children": []
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                },
                                                {
                                                    "type": "typed_parameter",
                                                    "label": "user_id: str",
                                                    "start_token": 4492,
                                                    "end_token": 4495,
                                                    "children": [
                                                        {
                                                            "type": "identifier",
                                                            "label": "user_id",
                                                            "start_token": 4492,
                                                            "end_token": -1,
                                                            "children": []
                                                        },
                                                        {
                                                            "type": "type",
                                                            "label": "str",
                                                            "start_token": 4494,
                                                            "end_token": 4495,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "label": "str",
                                                                    "start_token": 4494,
                                                                    "end_token": 4495,
                                                                    "children": []
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                },
                                                {
                                                    "type": "typed_default_parameter",
                                                    "label": "graph_version: int | None = None",
                                                    "start_token": 4498,
                                                    "end_token": 4504,
                                                    "children": [
                                                        {
                                                            "type": "identifier",
                                                            "label": "graph_version",
                                                            "start_token": 4498,
                                                            "end_token": -1,
                                                            "children": []
                                                        },
                                                        {
                                                            "type": "type",
                                                            "label": "int | None",
                                                            "start_token": 4504,
                                                            "end_token": 4504,
                                                            "children": [
                                                                {
                                                                    "type": "binary_operator",
                                                                    "label": "int | None",
                                                                    "start_token": 4504,
                                                                    "end_token": 4504,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "int",
                                                                            "start_token": 4504,
                                                                            "end_token": 4504,
                                                                            "children": []
                                                                        },
                                                                        {
                                                                            "type": "none",
                                                                            "label": "None",
                                                                            "start_token": 4504,
                                                                            "end_token": 4504,
                                                                            "children": []
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        },
                                                        {
                                                            "type": "none",
                                                            "label": "None",
                                                            "start_token": 4504,
                                                            "end_token": 4504,
                                                            "children": []
                                                        }
                                                    ]
                                                }
                                            ]
                                        },
                                        {
                                            "type": "type",
                                            "label": "GraphExecutionEntry",
                                            "start_token": 4507,
                                            "end_token": -1,
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "label": "GraphExecutionEntry",
                                                    "start_token": 4507,
                                                    "end_token": -1,
                                                    "children": []
                                                }
                                            ]
                                        },
                                        {
                                            "type": "block",
                                            "label": "graph: GraphModel | None = self.db_client.get_graph(\n            graph_id=graph_id, user_id=user_id, version=graph_version\n        )\n        if not graph:\n            raise ValueError(f\"Graph #{graph_id} not found.\")\n\n        graph.validate_graph(for_run=True)\n        self._validate_node_input_credentials(graph, user_id)\n\n        nodes_input = []\n        for node in graph.starting_nodes:\n            input_data = {}\n            block = get_block(node.block_id)\n\n            # Invalid block & Note block should never be executed.\n            if not block or block.block_type == BlockType.NOTE:\n                continue\n\n            # Extract request input data, and assign it to the input pin.\n            if block.block_type == BlockType.INPUT:\n                name = node.input_default.get(\"name\")\n                if name and name in data:\n                    input_data = {\"value\": data[name]}\n\n            # Extract webhook payload, and assign it to the input pin\n            webhook_payload_key = f\"webhook_{node.webhook_id}_payload\"\n            if (\n                block.block_type in (BlockType.WEBHOOK, BlockType.WEBHOOK_MANUAL)\n                and node.webhook_id\n            ):\n                if webhook_payload_key not in data:\n                    raise ValueError(\n                        f\"Node {block.name} #{node.id} webhook payload is missing\"\n                    )\n                input_data = {\"payload\": data[webhook_payload_key]}\n\n            input_data, error = validate_exec(node, input_data)\n            if input_data is None:\n                raise ValueError(error)\n            else:\n                nodes_input.append((node.id, input_data))\n\n        graph_exec_id, node_execs = self.db_client.create_graph_execution(\n            graph_id=graph_id,\n            graph_version=graph.version,\n            nodes_input=nodes_input,\n            user_id=user_id,\n        )\n\n        starting_node_execs = []\n        for node_exec in node_execs:\n            starting_node_execs.append(\n                NodeExecutionEntry(\n                    user_id=user_id,\n                    graph_exec_id=node_exec.graph_exec_id,\n                    graph_id=node_exec.graph_id,\n                    node_exec_id=node_exec.node_exec_id,\n                    node_id=node_exec.node_id,\n                    data=node_exec.input_data,\n                )\n            )\n            exec_update = self.db_client.update_execution_status(\n                node_exec.node_exec_id, ExecutionStatus.QUEUED, node_exec.input_data\n            )\n            self.db_client.send_execution_update(exec_update)\n\n        graph_exec = GraphExecutionEntry(\n            user_id=user_id,\n            graph_id=graph_id,\n            graph_exec_id=graph_exec_id,\n            start_node_execs=starting_node_execs,\n        )\n        self.queue.add(graph_exec)\n\n        return graph_exec",
                                            "start_token": 4513,
                                            "end_token": 4968,
                                            "children": [
                                                {
                                                    "type": "expression_statement",
                                                    "label": "graph: GraphModel | None = self.db_client.get_graph(\n            graph_id=graph_id, user_id=user_id, version=graph_version\n        )",
                                                    "start_token": 4513,
                                                    "end_token": -1,
                                                    "children": [
                                                        {
                                                            "type": "assignment",
                                                            "label": "graph: GraphModel | None = self.db_client.get_graph(\n            graph_id=graph_id, user_id=user_id, version=graph_version\n        )",
                                                            "start_token": 4513,
                                                            "end_token": -1,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "label": "graph",
                                                                    "start_token": 4513,
                                                                    "end_token": 4515,
                                                                    "children": []
                                                                },
                                                                {
                                                                    "type": "type",
                                                                    "label": "GraphModel | None",
                                                                    "start_token": 4515,
                                                                    "end_token": -1,
                                                                    "children": [
                                                                        {
                                                                            "type": "binary_operator",
                                                                            "label": "GraphModel | None",
                                                                            "start_token": 4515,
                                                                            "end_token": -1,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "GraphModel",
                                                                                    "start_token": 4515,
                                                                                    "end_token": 4517,
                                                                                    "children": []
                                                                                },
                                                                                {
                                                                                    "type": "none",
                                                                                    "label": "None",
                                                                                    "start_token": 4517,
                                                                                    "end_token": -1,
                                                                                    "children": []
                                                                                }
                                                                            ]
                                                                        }
                                                                    ]
                                                                },
                                                                {
                                                                    "type": "call",
                                                                    "label": "self.db_client.get_graph(\n            graph_id=graph_id, user_id=user_id, version=graph_version\n        )",
                                                                    "start_token": -1,
                                                                    "end_token": -1,
                                                                    "children": [
                                                                        {
                                                                            "type": "attribute",
                                                                            "label": "self.db_client.get_graph",
                                                                            "start_token": -1,
                                                                            "end_token": 4522,
                                                                            "children": [
                                                                                {
                                                                                    "type": "attribute",
                                                                                    "label": "self.db_client",
                                                                                    "start_token": -1,
                                                                                    "end_token": 4520,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "label": "self",
                                                                                            "start_token": -1,
                                                                                            "end_token": -1,
                                                                                            "children": []
                                                                                        },
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "label": "db_client",
                                                                                            "start_token": -1,
                                                                                            "end_token": 4520,
                                                                                            "children": []
                                                                                        }
                                                                                    ]
                                                                                },
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "get_graph",
                                                                                    "start_token": 4520,
                                                                                    "end_token": 4522,
                                                                                    "children": []
                                                                                }
                                                                            ]
                                                                        },
                                                                        {
                                                                            "type": "argument_list",
                                                                            "label": "(\n            graph_id=graph_id, user_id=user_id, version=graph_version\n        )",
                                                                            "start_token": 4522,
                                                                            "end_token": -1,
                                                                            "children": [
                                                                                {
                                                                                    "type": "keyword_argument",
                                                                                    "label": "graph_id=graph_id",
                                                                                    "start_token": 4526,
                                                                                    "end_token": 4530,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "label": "graph_id",
                                                                                            "start_token": 4526,
                                                                                            "end_token": 4528,
                                                                                            "children": []
                                                                                        },
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "label": "graph_id",
                                                                                            "start_token": 4528,
                                                                                            "end_token": 4530,
                                                                                            "children": []
                                                                                        }
                                                                                    ]
                                                                                },
                                                                                {
                                                                                    "type": "keyword_argument",
                                                                                    "label": "user_id=user_id",
                                                                                    "start_token": 4530,
                                                                                    "end_token": -1,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "label": "user_id",
                                                                                            "start_token": 4530,
                                                                                            "end_token": 4530,
                                                                                            "children": []
                                                                                        },
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "label": "user_id",
                                                                                            "start_token": 4531,
                                                                                            "end_token": -1,
                                                                                            "children": []
                                                                                        }
                                                                                    ]
                                                                                },
                                                                                {
                                                                                    "type": "keyword_argument",
                                                                                    "label": "version=graph_version",
                                                                                    "start_token": 4532,
                                                                                    "end_token": 4536,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "label": "version",
                                                                                            "start_token": 4532,
                                                                                            "end_token": -1,
                                                                                            "children": []
                                                                                        },
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "label": "graph_version",
                                                                                            "start_token": -1,
                                                                                            "end_token": 4536,
                                                                                            "children": []
                                                                                        }
                                                                                    ]
                                                                                }
                                                                            ]
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                },
                                                {
                                                    "type": "if_statement",
                                                    "label": "if not graph:\n            raise ValueError(f\"Graph #{graph_id} not found.\")",
                                                    "start_token": 4539,
                                                    "end_token": 4549,
                                                    "children": [
                                                        {
                                                            "type": "not_operator",
                                                            "label": "not graph",
                                                            "start_token": 4540,
                                                            "end_token": 4540,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "label": "graph",
                                                                    "start_token": 4540,
                                                                    "end_token": 4540,
                                                                    "children": []
                                                                }
                                                            ]
                                                        },
                                                        {
                                                            "type": "block",
                                                            "label": "raise ValueError(f\"Graph #{graph_id} not found.\")",
                                                            "start_token": 4543,
                                                            "end_token": 4549,
                                                            "children": [
                                                                {
                                                                    "type": "raise_statement",
                                                                    "label": "raise ValueError(f\"Graph #{graph_id} not found.\")",
                                                                    "start_token": 4543,
                                                                    "end_token": 4549,
                                                                    "children": [
                                                                        {
                                                                            "type": "call",
                                                                            "label": "ValueError(f\"Graph #{graph_id} not found.\")",
                                                                            "start_token": 4543,
                                                                            "end_token": 4549,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "ValueError",
                                                                                    "start_token": 4543,
                                                                                    "end_token": 4543,
                                                                                    "children": []
                                                                                },
                                                                                {
                                                                                    "type": "argument_list",
                                                                                    "label": "(f\"Graph #{graph_id} not found.\")",
                                                                                    "start_token": 4543,
                                                                                    "end_token": 4549,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "string",
                                                                                            "label": "f\"Graph #{graph_id} not found.\"",
                                                                                            "start_token": 4543,
                                                                                            "end_token": 4549,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "string_start",
                                                                                                    "label": "f\"",
                                                                                                    "start_token": 4543,
                                                                                                    "end_token": 4544,
                                                                                                    "children": []
                                                                                                },
                                                                                                {
                                                                                                    "type": "string_content",
                                                                                                    "label": "Graph #",
                                                                                                    "start_token": 4545,
                                                                                                    "end_token": -1,
                                                                                                    "children": []
                                                                                                },
                                                                                                {
                                                                                                    "type": "interpolation",
                                                                                                    "label": "{graph_id}",
                                                                                                    "start_token": -1,
                                                                                                    "end_token": 4549,
                                                                                                    "children": [
                                                                                                        {
                                                                                                            "type": "identifier",
                                                                                                            "label": "graph_id",
                                                                                                            "start_token": -1,
                                                                                                            "end_token": 4548,
                                                                                                            "children": []
                                                                                                        }
                                                                                                    ]
                                                                                                },
                                                                                                {
                                                                                                    "type": "string_content",
                                                                                                    "label": " not found.",
                                                                                                    "start_token": 4549,
                                                                                                    "end_token": 4549,
                                                                                                    "children": []
                                                                                                },
                                                                                                {
                                                                                                    "type": "string_end",
                                                                                                    "label": "\"",
                                                                                                    "start_token": 4549,
                                                                                                    "end_token": 4549,
                                                                                                    "children": []
                                                                                                }
                                                                                            ]
                                                                                        }
                                                                                    ]
                                                                                }
                                                                            ]
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                },
                                                {
                                                    "type": "expression_statement",
                                                    "label": "graph.validate_graph(for_run=True)",
                                                    "start_token": 4553,
                                                    "end_token": 4558,
                                                    "children": [
                                                        {
                                                            "type": "call",
                                                            "label": "graph.validate_graph(for_run=True)",
                                                            "start_token": 4553,
                                                            "end_token": 4558,
                                                            "children": [
                                                                {
                                                                    "type": "attribute",
                                                                    "label": "graph.validate_graph",
                                                                    "start_token": 4553,
                                                                    "end_token": 4558,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "graph",
                                                                            "start_token": 4553,
                                                                            "end_token": 4555,
                                                                            "children": []
                                                                        },
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "validate_graph",
                                                                            "start_token": -1,
                                                                            "end_token": 4558,
                                                                            "children": []
                                                                        }
                                                                    ]
                                                                },
                                                                {
                                                                    "type": "argument_list",
                                                                    "label": "(for_run=True)",
                                                                    "start_token": 4558,
                                                                    "end_token": 4558,
                                                                    "children": [
                                                                        {
                                                                            "type": "keyword_argument",
                                                                            "label": "for_run=True",
                                                                            "start_token": 4558,
                                                                            "end_token": 4558,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "for_run",
                                                                                    "start_token": 4558,
                                                                                    "end_token": 4558,
                                                                                    "children": []
                                                                                },
                                                                                {
                                                                                    "type": "true",
                                                                                    "label": "True",
                                                                                    "start_token": 4558,
                                                                                    "end_token": 4558,
                                                                                    "children": []
                                                                                }
                                                                            ]
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                },
                                                {
                                                    "type": "expression_statement",
                                                    "label": "self._validate_node_input_credentials(graph, user_id)",
                                                    "start_token": 4558,
                                                    "end_token": -1,
                                                    "children": [
                                                        {
                                                            "type": "call",
                                                            "label": "self._validate_node_input_credentials(graph, user_id)",
                                                            "start_token": 4558,
                                                            "end_token": -1,
                                                            "children": [
                                                                {
                                                                    "type": "attribute",
                                                                    "label": "self._validate_node_input_credentials",
                                                                    "start_token": 4558,
                                                                    "end_token": 4566,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "self",
                                                                            "start_token": 4558,
                                                                            "end_token": 4558,
                                                                            "children": []
                                                                        },
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "_validate_node_input_credentials",
                                                                            "start_token": 4558,
                                                                            "end_token": 4566,
                                                                            "children": []
                                                                        }
                                                                    ]
                                                                },
                                                                {
                                                                    "type": "argument_list",
                                                                    "label": "(graph, user_id)",
                                                                    "start_token": 4566,
                                                                    "end_token": -1,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "graph",
                                                                            "start_token": 4566,
                                                                            "end_token": 4566,
                                                                            "children": []
                                                                        },
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "user_id",
                                                                            "start_token": 4567,
                                                                            "end_token": -1,
                                                                            "children": []
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                },
                                                {
                                                    "type": "expression_statement",
                                                    "label": "nodes_input = []",
                                                    "start_token": 4572,
                                                    "end_token": 4576,
                                                    "children": [
                                                        {
                                                            "type": "assignment",
                                                            "label": "nodes_input = []",
                                                            "start_token": 4572,
                                                            "end_token": 4576,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "label": "nodes_input",
                                                                    "start_token": 4572,
                                                                    "end_token": 4574,
                                                                    "children": []
                                                                },
                                                                {
                                                                    "type": "list",
                                                                    "label": "[]",
                                                                    "start_token": 4576,
                                                                    "end_token": 4576,
                                                                    "children": []
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                },
                                                {
                                                    "type": "for_statement",
                                                    "label": "for node in graph.starting_nodes:\n            input_data = {}\n            block = get_block(node.block_id)\n\n            # Invalid block & Note block should never be executed.\n            if not block or block.block_type == BlockType.NOTE:\n                continue\n\n            # Extract request input data, and assign it to the input pin.\n            if block.block_type == BlockType.INPUT:\n                name = node.input_default.get(\"name\")\n                if name and name in data:\n                    input_data = {\"value\": data[name]}\n\n            # Extract webhook payload, and assign it to the input pin\n            webhook_payload_key = f\"webhook_{node.webhook_id}_payload\"\n            if (\n                block.block_type in (BlockType.WEBHOOK, BlockType.WEBHOOK_MANUAL)\n                and node.webhook_id\n            ):\n                if webhook_payload_key not in data:\n                    raise ValueError(\n                        f\"Node {block.name} #{node.id} webhook payload is missing\"\n                    )\n                input_data = {\"payload\": data[webhook_payload_key]}\n\n            input_data, error = validate_exec(node, input_data)\n            if input_data is None:\n                raise ValueError(error)\n            else:\n                nodes_input.append((node.id, input_data))",
                                                    "start_token": 4576,
                                                    "end_token": 4793,
                                                    "children": [
                                                        {
                                                            "type": "identifier",
                                                            "label": "node",
                                                            "start_token": -1,
                                                            "end_token": -1,
                                                            "children": []
                                                        },
                                                        {
                                                            "type": "attribute",
                                                            "label": "graph.starting_nodes",
                                                            "start_token": -1,
                                                            "end_token": 4583,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "label": "graph",
                                                                    "start_token": -1,
                                                                    "end_token": 4579,
                                                                    "children": []
                                                                },
                                                                {
                                                                    "type": "identifier",
                                                                    "label": "starting_nodes",
                                                                    "start_token": 4579,
                                                                    "end_token": 4583,
                                                                    "children": []
                                                                }
                                                            ]
                                                        },
                                                        {
                                                            "type": "block",
                                                            "label": "input_data = {}\n            block = get_block(node.block_id)\n\n            # Invalid block & Note block should never be executed.\n            if not block or block.block_type == BlockType.NOTE:\n                continue\n\n            # Extract request input data, and assign it to the input pin.\n            if block.block_type == BlockType.INPUT:\n                name = node.input_default.get(\"name\")\n                if name and name in data:\n                    input_data = {\"value\": data[name]}\n\n            # Extract webhook payload, and assign it to the input pin\n            webhook_payload_key = f\"webhook_{node.webhook_id}_payload\"\n            if (\n                block.block_type in (BlockType.WEBHOOK, BlockType.WEBHOOK_MANUAL)\n                and node.webhook_id\n            ):\n                if webhook_payload_key not in data:\n                    raise ValueError(\n                        f\"Node {block.name} #{node.id} webhook payload is missing\"\n                    )\n                input_data = {\"payload\": data[webhook_payload_key]}\n\n            input_data, error = validate_exec(node, input_data)\n            if input_data is None:\n                raise ValueError(error)\n            else:\n                nodes_input.append((node.id, input_data))",
                                                            "start_token": 4584,
                                                            "end_token": 4793,
                                                            "children": [
                                                                {
                                                                    "type": "expression_statement",
                                                                    "label": "input_data = {}",
                                                                    "start_token": 4584,
                                                                    "end_token": 4586,
                                                                    "children": [
                                                                        {
                                                                            "type": "assignment",
                                                                            "label": "input_data = {}",
                                                                            "start_token": 4584,
                                                                            "end_token": 4586,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "input_data",
                                                                                    "start_token": 4584,
                                                                                    "end_token": 4586,
                                                                                    "children": []
                                                                                },
                                                                                {
                                                                                    "type": "dictionary",
                                                                                    "label": "{}",
                                                                                    "start_token": 4586,
                                                                                    "end_token": 4586,
                                                                                    "children": []
                                                                                }
                                                                            ]
                                                                        }
                                                                    ]
                                                                },
                                                                {
                                                                    "type": "expression_statement",
                                                                    "label": "block = get_block(node.block_id)",
                                                                    "start_token": 4590,
                                                                    "end_token": -1,
                                                                    "children": [
                                                                        {
                                                                            "type": "assignment",
                                                                            "label": "block = get_block(node.block_id)",
                                                                            "start_token": 4590,
                                                                            "end_token": -1,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "block",
                                                                                    "start_token": 4590,
                                                                                    "end_token": -1,
                                                                                    "children": []
                                                                                },
                                                                                {
                                                                                    "type": "call",
                                                                                    "label": "get_block(node.block_id)",
                                                                                    "start_token": -1,
                                                                                    "end_token": -1,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "label": "get_block",
                                                                                            "start_token": -1,
                                                                                            "end_token": 4594,
                                                                                            "children": []
                                                                                        },
                                                                                        {
                                                                                            "type": "argument_list",
                                                                                            "label": "(node.block_id)",
                                                                                            "start_token": -1,
                                                                                            "end_token": -1,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "attribute",
                                                                                                    "label": "node.block_id",
                                                                                                    "start_token": 4595,
                                                                                                    "end_token": 4596,
                                                                                                    "children": [
                                                                                                        {
                                                                                                            "type": "identifier",
                                                                                                            "label": "node",
                                                                                                            "start_token": 4595,
                                                                                                            "end_token": 4595,
                                                                                                            "children": []
                                                                                                        },
                                                                                                        {
                                                                                                            "type": "identifier",
                                                                                                            "label": "block_id",
                                                                                                            "start_token": 4595,
                                                                                                            "end_token": 4596,
                                                                                                            "children": []
                                                                                                        }
                                                                                                    ]
                                                                                                }
                                                                                            ]
                                                                                        }
                                                                                    ]
                                                                                }
                                                                            ]
                                                                        }
                                                                    ]
                                                                },
                                                                {
                                                                    "type": "comment",
                                                                    "label": "# Invalid block & Note block should never be executed.",
                                                                    "start_token": 4600,
                                                                    "end_token": 4610,
                                                                    "children": []
                                                                },
                                                                {
                                                                    "type": "if_statement",
                                                                    "label": "if not block or block.block_type == BlockType.NOTE:\n                continue",
                                                                    "start_token": 4612,
                                                                    "end_token": 4625,
                                                                    "children": [
                                                                        {
                                                                            "type": "boolean_operator",
                                                                            "label": "not block or block.block_type == BlockType.NOTE",
                                                                            "start_token": 4613,
                                                                            "end_token": -1,
                                                                            "children": [
                                                                                {
                                                                                    "type": "not_operator",
                                                                                    "label": "not block",
                                                                                    "start_token": 4613,
                                                                                    "end_token": 4615,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "label": "block",
                                                                                            "start_token": 4615,
                                                                                            "end_token": 4615,
                                                                                            "children": []
                                                                                        }
                                                                                    ]
                                                                                },
                                                                                {
                                                                                    "type": "comparison_operator",
                                                                                    "label": "block.block_type == BlockType.NOTE",
                                                                                    "start_token": 4617,
                                                                                    "end_token": -1,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "attribute",
                                                                                            "label": "block.block_type",
                                                                                            "start_token": 4617,
                                                                                            "end_token": -1,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "label": "block",
                                                                                                    "start_token": 4617,
                                                                                                    "end_token": 4618,
                                                                                                    "children": []
                                                                                                },
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "label": "block_type",
                                                                                                    "start_token": -1,
                                                                                                    "end_token": -1,
                                                                                                    "children": []
                                                                                                }
                                                                                            ]
                                                                                        },
                                                                                        {
                                                                                            "type": "attribute",
                                                                                            "label": "BlockType.NOTE",
                                                                                            "start_token": -1,
                                                                                            "end_token": -1,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "label": "BlockType",
                                                                                                    "start_token": -1,
                                                                                                    "end_token": 4620,
                                                                                                    "children": []
                                                                                                },
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "label": "NOTE",
                                                                                                    "start_token": 4621,
                                                                                                    "end_token": -1,
                                                                                                    "children": []
                                                                                                }
                                                                                            ]
                                                                                        }
                                                                                    ]
                                                                                }
                                                                            ]
                                                                        },
                                                                        {
                                                                            "type": "block",
                                                                            "label": "continue",
                                                                            "start_token": 4624,
                                                                            "end_token": 4625,
                                                                            "children": [
                                                                                {
                                                                                    "type": "continue_statement",
                                                                                    "label": "continue",
                                                                                    "start_token": 4624,
                                                                                    "end_token": 4625,
                                                                                    "children": []
                                                                                }
                                                                            ]
                                                                        }
                                                                    ]
                                                                },
                                                                {
                                                                    "type": "comment",
                                                                    "label": "# Extract request input data, and assign it to the input pin.",
                                                                    "start_token": 4629,
                                                                    "end_token": 4641,
                                                                    "children": []
                                                                },
                                                                {
                                                                    "type": "if_statement",
                                                                    "label": "if block.block_type == BlockType.INPUT:\n                name = node.input_default.get(\"name\")\n                if name and name in data:\n                    input_data = {\"value\": data[name]}",
                                                                    "start_token": 4644,
                                                                    "end_token": 4682,
                                                                    "children": [
                                                                        {
                                                                            "type": "comparison_operator",
                                                                            "label": "block.block_type == BlockType.INPUT",
                                                                            "start_token": 4646,
                                                                            "end_token": 4652,
                                                                            "children": [
                                                                                {
                                                                                    "type": "attribute",
                                                                                    "label": "block.block_type",
                                                                                    "start_token": 4646,
                                                                                    "end_token": -1,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "label": "block",
                                                                                            "start_token": 4646,
                                                                                            "end_token": 4646,
                                                                                            "children": []
                                                                                        },
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "label": "block_type",
                                                                                            "start_token": 4648,
                                                                                            "end_token": -1,
                                                                                            "children": []
                                                                                        }
                                                                                    ]
                                                                                },
                                                                                {
                                                                                    "type": "attribute",
                                                                                    "label": "BlockType.INPUT",
                                                                                    "start_token": -1,
                                                                                    "end_token": 4652,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "label": "BlockType",
                                                                                            "start_token": -1,
                                                                                            "end_token": 4650,
                                                                                            "children": []
                                                                                        },
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "label": "INPUT",
                                                                                            "start_token": 4651,
                                                                                            "end_token": 4652,
                                                                                            "children": []
                                                                                        }
                                                                                    ]
                                                                                }
                                                                            ]
                                                                        },
                                                                        {
                                                                            "type": "block",
                                                                            "label": "name = node.input_default.get(\"name\")\n                if name and name in data:\n                    input_data = {\"value\": data[name]}",
                                                                            "start_token": 4657,
                                                                            "end_token": 4682,
                                                                            "children": [
                                                                                {
                                                                                    "type": "expression_statement",
                                                                                    "label": "name = node.input_default.get(\"name\")",
                                                                                    "start_token": 4657,
                                                                                    "end_token": 4663,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "assignment",
                                                                                            "label": "name = node.input_default.get(\"name\")",
                                                                                            "start_token": 4657,
                                                                                            "end_token": 4663,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "label": "name",
                                                                                                    "start_token": 4657,
                                                                                                    "end_token": 4657,
                                                                                                    "children": []
                                                                                                },
                                                                                                {
                                                                                                    "type": "call",
                                                                                                    "label": "node.input_default.get(\"name\")",
                                                                                                    "start_token": 4659,
                                                                                                    "end_token": 4663,
                                                                                                    "children": [
                                                                                                        {
                                                                                                            "type": "attribute",
                                                                                                            "label": "node.input_default.get",
                                                                                                            "start_token": 4659,
                                                                                                            "end_token": 4661,
                                                                                                            "children": [
                                                                                                                {
                                                                                                                    "type": "attribute",
                                                                                                                    "label": "node.input_default",
                                                                                                                    "start_token": 4659,
                                                                                                                    "end_token": 4660,
                                                                                                                    "children": [
                                                                                                                        {
                                                                                                                            "type": "identifier",
                                                                                                                            "label": "node",
                                                                                                                            "start_token": 4659,
                                                                                                                            "end_token": -1,
                                                                                                                            "children": []
                                                                                                                        },
                                                                                                                        {
                                                                                                                            "type": "identifier",
                                                                                                                            "label": "input_default",
                                                                                                                            "start_token": -1,
                                                                                                                            "end_token": 4660,
                                                                                                                            "children": []
                                                                                                                        }
                                                                                                                    ]
                                                                                                                },
                                                                                                                {
                                                                                                                    "type": "identifier",
                                                                                                                    "label": "get",
                                                                                                                    "start_token": -1,
                                                                                                                    "end_token": 4661,
                                                                                                                    "children": []
                                                                                                                }
                                                                                                            ]
                                                                                                        },
                                                                                                        {
                                                                                                            "type": "argument_list",
                                                                                                            "label": "(\"name\")",
                                                                                                            "start_token": 4661,
                                                                                                            "end_token": 4663,
                                                                                                            "children": [
                                                                                                                {
                                                                                                                    "type": "string",
                                                                                                                    "label": "\"name\"",
                                                                                                                    "start_token": 4661,
                                                                                                                    "end_token": -1,
                                                                                                                    "children": [
                                                                                                                        {
                                                                                                                            "type": "string_start",
                                                                                                                            "label": "\"",
                                                                                                                            "start_token": 4661,
                                                                                                                            "end_token": 4661,
                                                                                                                            "children": []
                                                                                                                        },
                                                                                                                        {
                                                                                                                            "type": "string_content",
                                                                                                                            "label": "name",
                                                                                                                            "start_token": -1,
                                                                                                                            "end_token": 4662,
                                                                                                                            "children": []
                                                                                                                        },
                                                                                                                        {
                                                                                                                            "type": "string_end",
                                                                                                                            "label": "\"",
                                                                                                                            "start_token": -1,
                                                                                                                            "end_token": -1,
                                                                                                                            "children": []
                                                                                                                        }
                                                                                                                    ]
                                                                                                                }
                                                                                                            ]
                                                                                                        }
                                                                                                    ]
                                                                                                }
                                                                                            ]
                                                                                        }
                                                                                    ]
                                                                                },
                                                                                {
                                                                                    "type": "if_statement",
                                                                                    "label": "if name and name in data:\n                    input_data = {\"value\": data[name]}",
                                                                                    "start_token": -1,
                                                                                    "end_token": 4682,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "boolean_operator",
                                                                                            "label": "name and name in data",
                                                                                            "start_token": -1,
                                                                                            "end_token": 4668,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "label": "name",
                                                                                                    "start_token": -1,
                                                                                                    "end_token": -1,
                                                                                                    "children": []
                                                                                                },
                                                                                                {
                                                                                                    "type": "comparison_operator",
                                                                                                    "label": "name in data",
                                                                                                    "start_token": -1,
                                                                                                    "end_token": 4668,
                                                                                                    "children": [
                                                                                                        {
                                                                                                            "type": "identifier",
                                                                                                            "label": "name",
                                                                                                            "start_token": -1,
                                                                                                            "end_token": -1,
                                                                                                            "children": []
                                                                                                        },
                                                                                                        {
                                                                                                            "type": "identifier",
                                                                                                            "label": "data",
                                                                                                            "start_token": 4668,
                                                                                                            "end_token": 4668,
                                                                                                            "children": []
                                                                                                        }
                                                                                                    ]
                                                                                                }
                                                                                            ]
                                                                                        },
                                                                                        {
                                                                                            "type": "block",
                                                                                            "label": "input_data = {\"value\": data[name]}",
                                                                                            "start_token": 4675,
                                                                                            "end_token": 4682,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "expression_statement",
                                                                                                    "label": "input_data = {\"value\": data[name]}",
                                                                                                    "start_token": 4675,
                                                                                                    "end_token": 4682,
                                                                                                    "children": [
                                                                                                        {
                                                                                                            "type": "assignment",
                                                                                                            "label": "input_data = {\"value\": data[name]}",
                                                                                                            "start_token": 4675,
                                                                                                            "end_token": 4682,
                                                                                                            "children": [
                                                                                                                {
                                                                                                                    "type": "identifier",
                                                                                                                    "label": "input_data",
                                                                                                                    "start_token": 4675,
                                                                                                                    "end_token": -1,
                                                                                                                    "children": []
                                                                                                                },
                                                                                                                {
                                                                                                                    "type": "dictionary",
                                                                                                                    "label": "{\"value\": data[name]}",
                                                                                                                    "start_token": -1,
                                                                                                                    "end_token": 4682,
                                                                                                                    "children": [
                                                                                                                        {
                                                                                                                            "type": "pair",
                                                                                                                            "label": "\"value\": data[name]",
                                                                                                                            "start_token": -1,
                                                                                                                            "end_token": 4682,
                                                                                                                            "children": [
                                                                                                                                {
                                                                                                                                    "type": "string",
                                                                                                                                    "label": "\"value\"",
                                                                                                                                    "start_token": -1,
                                                                                                                                    "end_token": 4681,
                                                                                                                                    "children": [
                                                                                                                                        {
                                                                                                                                            "type": "string_start",
                                                                                                                                            "label": "\"",
                                                                                                                                            "start_token": -1,
                                                                                                                                            "end_token": -1,
                                                                                                                                            "children": []
                                                                                                                                        },
                                                                                                                                        {
                                                                                                                                            "type": "string_content",
                                                                                                                                            "label": "value",
                                                                                                                                            "start_token": -1,
                                                                                                                                            "end_token": -1,
                                                                                                                                            "children": []
                                                                                                                                        },
                                                                                                                                        {
                                                                                                                                            "type": "string_end",
                                                                                                                                            "label": "\"",
                                                                                                                                            "start_token": 4681,
                                                                                                                                            "end_token": 4681,
                                                                                                                                            "children": []
                                                                                                                                        }
                                                                                                                                    ]
                                                                                                                                },
                                                                                                                                {
                                                                                                                                    "type": "subscript",
                                                                                                                                    "label": "data[name]",
                                                                                                                                    "start_token": 4681,
                                                                                                                                    "end_token": 4682,
                                                                                                                                    "children": [
                                                                                                                                        {
                                                                                                                                            "type": "identifier",
                                                                                                                                            "label": "data",
                                                                                                                                            "start_token": 4681,
                                                                                                                                            "end_token": 4681,
                                                                                                                                            "children": []
                                                                                                                                        },
                                                                                                                                        {
                                                                                                                                            "type": "identifier",
                                                                                                                                            "label": "name",
                                                                                                                                            "start_token": 4682,
                                                                                                                                            "end_token": 4682,
                                                                                                                                            "children": []
                                                                                                                                        }
                                                                                                                                    ]
                                                                                                                                }
                                                                                                                            ]
                                                                                                                        }
                                                                                                                    ]
                                                                                                                }
                                                                                                            ]
                                                                                                        }
                                                                                                    ]
                                                                                                }
                                                                                            ]
                                                                                        }
                                                                                    ]
                                                                                }
                                                                            ]
                                                                        }
                                                                    ]
                                                                },
                                                                {
                                                                    "type": "comment",
                                                                    "label": "# Extract webhook payload, and assign it to the input pin",
                                                                    "start_token": -1,
                                                                    "end_token": 4693,
                                                                    "children": []
                                                                },
                                                                {
                                                                    "type": "expression_statement",
                                                                    "label": "webhook_payload_key = f\"webhook_{node.webhook_id}_payload\"",
                                                                    "start_token": 4696,
                                                                    "end_token": -1,
                                                                    "children": [
                                                                        {
                                                                            "type": "assignment",
                                                                            "label": "webhook_payload_key = f\"webhook_{node.webhook_id}_payload\"",
                                                                            "start_token": 4696,
                                                                            "end_token": -1,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "webhook_payload_key",
                                                                                    "start_token": 4696,
                                                                                    "end_token": 4696,
                                                                                    "children": []
                                                                                },
                                                                                {
                                                                                    "type": "string",
                                                                                    "label": "f\"webhook_{node.webhook_id}_payload\"",
                                                                                    "start_token": 4696,
                                                                                    "end_token": -1,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "string_start",
                                                                                            "label": "f\"",
                                                                                            "start_token": 4696,
                                                                                            "end_token": 4696,
                                                                                            "children": []
                                                                                        },
                                                                                        {
                                                                                            "type": "string_content",
                                                                                            "label": "webhook_",
                                                                                            "start_token": 4696,
                                                                                            "end_token": -1,
                                                                                            "children": []
                                                                                        },
                                                                                        {
                                                                                            "type": "interpolation",
                                                                                            "label": "{node.webhook_id}",
                                                                                            "start_token": -1,
                                                                                            "end_token": -1,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "attribute",
                                                                                                    "label": "node.webhook_id",
                                                                                                    "start_token": -1,
                                                                                                    "end_token": -1,
                                                                                                    "children": [
                                                                                                        {
                                                                                                            "type": "identifier",
                                                                                                            "label": "node",
                                                                                                            "start_token": -1,
                                                                                                            "end_token": -1,
                                                                                                            "children": []
                                                                                                        },
                                                                                                        {
                                                                                                            "type": "identifier",
                                                                                                            "label": "webhook_id",
                                                                                                            "start_token": -1,
                                                                                                            "end_token": -1,
                                                                                                            "children": []
                                                                                                        }
                                                                                                    ]
                                                                                                }
                                                                                            ]
                                                                                        },
                                                                                        {
                                                                                            "type": "string_content",
                                                                                            "label": "_payload",
                                                                                            "start_token": -1,
                                                                                            "end_token": -1,
                                                                                            "children": []
                                                                                        },
                                                                                        {
                                                                                            "type": "string_end",
                                                                                            "label": "\"",
                                                                                            "start_token": -1,
                                                                                            "end_token": -1,
                                                                                            "children": []
                                                                                        }
                                                                                    ]
                                                                                }
                                                                            ]
                                                                        }
                                                                    ]
                                                                },
                                                                {
                                                                    "type": "if_statement",
                                                                    "label": "if (\n                block.block_type in (BlockType.WEBHOOK, BlockType.WEBHOOK_MANUAL)\n                and node.webhook_id\n            ):\n                if webhook_payload_key not in data:\n                    raise ValueError(\n                        f\"Node {block.name} #{node.id} webhook payload is missing\"\n                    )\n                input_data = {\"payload\": data[webhook_payload_key]}",
                                                                    "start_token": 4703,
                                                                    "end_token": 4753,
                                                                    "children": [
                                                                        {
                                                                            "type": "parenthesized_expression",
                                                                            "label": "(\n                block.block_type in (BlockType.WEBHOOK, BlockType.WEBHOOK_MANUAL)\n                and node.webhook_id\n            )",
                                                                            "start_token": 4703,
                                                                            "end_token": 4724,
                                                                            "children": [
                                                                                {
                                                                                    "type": "boolean_operator",
                                                                                    "label": "block.block_type in (BlockType.WEBHOOK, BlockType.WEBHOOK_MANUAL)\n                and node.webhook_id",
                                                                                    "start_token": 4707,
                                                                                    "end_token": -1,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "comparison_operator",
                                                                                            "label": "block.block_type in (BlockType.WEBHOOK, BlockType.WEBHOOK_MANUAL)",
                                                                                            "start_token": 4707,
                                                                                            "end_token": 4718,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "attribute",
                                                                                                    "label": "block.block_type",
                                                                                                    "start_token": 4707,
                                                                                                    "end_token": 4710,
                                                                                                    "children": [
                                                                                                        {
                                                                                                            "type": "identifier",
                                                                                                            "label": "block",
                                                                                                            "start_token": 4707,
                                                                                                            "end_token": 4708,
                                                                                                            "children": []
                                                                                                        },
                                                                                                        {
                                                                                                            "type": "identifier",
                                                                                                            "label": "block_type",
                                                                                                            "start_token": 4708,
                                                                                                            "end_token": 4710,
                                                                                                            "children": []
                                                                                                        }
                                                                                                    ]
                                                                                                },
                                                                                                {
                                                                                                    "type": "tuple",
                                                                                                    "label": "(BlockType.WEBHOOK, BlockType.WEBHOOK_MANUAL)",
                                                                                                    "start_token": 4712,
                                                                                                    "end_token": 4718,
                                                                                                    "children": [
                                                                                                        {
                                                                                                            "type": "attribute",
                                                                                                            "label": "BlockType.WEBHOOK",
                                                                                                            "start_token": 4712,
                                                                                                            "end_token": -1,
                                                                                                            "children": [
                                                                                                                {
                                                                                                                    "type": "identifier",
                                                                                                                    "label": "BlockType",
                                                                                                                    "start_token": 4712,
                                                                                                                    "end_token": 4712,
                                                                                                                    "children": []
                                                                                                                },
                                                                                                                {
                                                                                                                    "type": "identifier",
                                                                                                                    "label": "WEBHOOK",
                                                                                                                    "start_token": 4712,
                                                                                                                    "end_token": -1,
                                                                                                                    "children": []
                                                                                                                }
                                                                                                            ]
                                                                                                        },
                                                                                                        {
                                                                                                            "type": "attribute",
                                                                                                            "label": "BlockType.WEBHOOK_MANUAL",
                                                                                                            "start_token": -1,
                                                                                                            "end_token": 4718,
                                                                                                            "children": [
                                                                                                                {
                                                                                                                    "type": "identifier",
                                                                                                                    "label": "BlockType",
                                                                                                                    "start_token": -1,
                                                                                                                    "end_token": -1,
                                                                                                                    "children": []
                                                                                                                },
                                                                                                                {
                                                                                                                    "type": "identifier",
                                                                                                                    "label": "WEBHOOK_MANUAL",
                                                                                                                    "start_token": -1,
                                                                                                                    "end_token": 4718,
                                                                                                                    "children": []
                                                                                                                }
                                                                                                            ]
                                                                                                        }
                                                                                                    ]
                                                                                                }
                                                                                            ]
                                                                                        },
                                                                                        {
                                                                                            "type": "attribute",
                                                                                            "label": "node.webhook_id",
                                                                                            "start_token": 4722,
                                                                                            "end_token": -1,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "label": "node",
                                                                                                    "start_token": 4722,
                                                                                                    "end_token": -1,
                                                                                                    "children": []
                                                                                                },
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "label": "webhook_id",
                                                                                                    "start_token": -1,
                                                                                                    "end_token": -1,
                                                                                                    "children": []
                                                                                                }
                                                                                            ]
                                                                                        }
                                                                                    ]
                                                                                }
                                                                            ]
                                                                        },
                                                                        {
                                                                            "type": "block",
                                                                            "label": "if webhook_payload_key not in data:\n                    raise ValueError(\n                        f\"Node {block.name} #{node.id} webhook payload is missing\"\n                    )\n                input_data = {\"payload\": data[webhook_payload_key]}",
                                                                            "start_token": 4727,
                                                                            "end_token": 4753,
                                                                            "children": [
                                                                                {
                                                                                    "type": "if_statement",
                                                                                    "label": "if webhook_payload_key not in data:\n                    raise ValueError(\n                        f\"Node {block.name} #{node.id} webhook payload is missing\"\n                    )",
                                                                                    "start_token": 4727,
                                                                                    "end_token": -1,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "comparison_operator",
                                                                                            "label": "webhook_payload_key not in data",
                                                                                            "start_token": 4727,
                                                                                            "end_token": 4731,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "label": "webhook_payload_key",
                                                                                                    "start_token": 4727,
                                                                                                    "end_token": -1,
                                                                                                    "children": []
                                                                                                },
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "label": "data",
                                                                                                    "start_token": 4730,
                                                                                                    "end_token": 4731,
                                                                                                    "children": []
                                                                                                }
                                                                                            ]
                                                                                        },
                                                                                        {
                                                                                            "type": "block",
                                                                                            "label": "raise ValueError(\n                        f\"Node {block.name} #{node.id} webhook payload is missing\"\n                    )",
                                                                                            "start_token": -1,
                                                                                            "end_token": -1,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "raise_statement",
                                                                                                    "label": "raise ValueError(\n                        f\"Node {block.name} #{node.id} webhook payload is missing\"\n                    )",
                                                                                                    "start_token": -1,
                                                                                                    "end_token": -1,
                                                                                                    "children": [
                                                                                                        {
                                                                                                            "type": "call",
                                                                                                            "label": "ValueError(\n                        f\"Node {block.name} #{node.id} webhook payload is missing\"\n                    )",
                                                                                                            "start_token": -1,
                                                                                                            "end_token": -1,
                                                                                                            "children": [
                                                                                                                {
                                                                                                                    "type": "identifier",
                                                                                                                    "label": "ValueError",
                                                                                                                    "start_token": -1,
                                                                                                                    "end_token": 4735,
                                                                                                                    "children": []
                                                                                                                },
                                                                                                                {
                                                                                                                    "type": "argument_list",
                                                                                                                    "label": "(\n                        f\"Node {block.name} #{node.id} webhook payload is missing\"\n                    )",
                                                                                                                    "start_token": 4735,
                                                                                                                    "end_token": -1,
                                                                                                                    "children": [
                                                                                                                        {
                                                                                                                            "type": "string",
                                                                                                                            "label": "f\"Node {block.name} #{node.id} webhook payload is missing\"",
                                                                                                                            "start_token": 4735,
                                                                                                                            "end_token": -1,
                                                                                                                            "children": [
                                                                                                                                {
                                                                                                                                    "type": "string_start",
                                                                                                                                    "label": "f\"",
                                                                                                                                    "start_token": 4735,
                                                                                                                                    "end_token": 4735,
                                                                                                                                    "children": []
                                                                                                                                },
                                                                                                                                {
                                                                                                                                    "type": "string_content",
                                                                                                                                    "label": "Node ",
                                                                                                                                    "start_token": 4735,
                                                                                                                                    "end_token": 4735,
                                                                                                                                    "children": []
                                                                                                                                },
                                                                                                                                {
                                                                                                                                    "type": "interpolation",
                                                                                                                                    "label": "{block.name}",
                                                                                                                                    "start_token": 4735,
                                                                                                                                    "end_token": 4735,
                                                                                                                                    "children": [
                                                                                                                                        {
                                                                                                                                            "type": "attribute",
                                                                                                                                            "label": "block.name",
                                                                                                                                            "start_token": 4735,
                                                                                                                                            "end_token": 4735,
                                                                                                                                            "children": [
                                                                                                                                                {
                                                                                                                                                    "type": "identifier",
                                                                                                                                                    "label": "block",
                                                                                                                                                    "start_token": 4735,
                                                                                                                                                    "end_token": 4735,
                                                                                                                                                    "children": []
                                                                                                                                                },
                                                                                                                                                {
                                                                                                                                                    "type": "identifier",
                                                                                                                                                    "label": "name",
                                                                                                                                                    "start_token": 4735,
                                                                                                                                                    "end_token": 4735,
                                                                                                                                                    "children": []
                                                                                                                                                }
                                                                                                                                            ]
                                                                                                                                        }
                                                                                                                                    ]
                                                                                                                                },
                                                                                                                                {
                                                                                                                                    "type": "string_content",
                                                                                                                                    "label": " #",
                                                                                                                                    "start_token": 4735,
                                                                                                                                    "end_token": 4735,
                                                                                                                                    "children": []
                                                                                                                                },
                                                                                                                                {
                                                                                                                                    "type": "interpolation",
                                                                                                                                    "label": "{node.id}",
                                                                                                                                    "start_token": 4735,
                                                                                                                                    "end_token": -1,
                                                                                                                                    "children": [
                                                                                                                                        {
                                                                                                                                            "type": "attribute",
                                                                                                                                            "label": "node.id",
                                                                                                                                            "start_token": 4735,
                                                                                                                                            "end_token": 4736,
                                                                                                                                            "children": [
                                                                                                                                                {
                                                                                                                                                    "type": "identifier",
                                                                                                                                                    "label": "node",
                                                                                                                                                    "start_token": 4735,
                                                                                                                                                    "end_token": 4735,
                                                                                                                                                    "children": []
                                                                                                                                                },
                                                                                                                                                {
                                                                                                                                                    "type": "identifier",
                                                                                                                                                    "label": "id",
                                                                                                                                                    "start_token": 4735,
                                                                                                                                                    "end_token": 4736,
                                                                                                                                                    "children": []
                                                                                                                                                }
                                                                                                                                            ]
                                                                                                                                        }
                                                                                                                                    ]
                                                                                                                                },
                                                                                                                                {
                                                                                                                                    "type": "string_content",
                                                                                                                                    "label": " webhook payload is missing",
                                                                                                                                    "start_token": -1,
                                                                                                                                    "end_token": -1,
                                                                                                                                    "children": []
                                                                                                                                },
                                                                                                                                {
                                                                                                                                    "type": "string_end",
                                                                                                                                    "label": "\"",
                                                                                                                                    "start_token": -1,
                                                                                                                                    "end_token": -1,
                                                                                                                                    "children": []
                                                                                                                                }
                                                                                                                            ]
                                                                                                                        }
                                                                                                                    ]
                                                                                                                }
                                                                                                            ]
                                                                                                        }
                                                                                                    ]
                                                                                                }
                                                                                            ]
                                                                                        }
                                                                                    ]
                                                                                },
                                                                                {
                                                                                    "type": "expression_statement",
                                                                                    "label": "input_data = {\"payload\": data[webhook_payload_key]}",
                                                                                    "start_token": 4746,
                                                                                    "end_token": 4753,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "assignment",
                                                                                            "label": "input_data = {\"payload\": data[webhook_payload_key]}",
                                                                                            "start_token": 4746,
                                                                                            "end_token": 4753,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "label": "input_data",
                                                                                                    "start_token": 4746,
                                                                                                    "end_token": 4746,
                                                                                                    "children": []
                                                                                                },
                                                                                                {
                                                                                                    "type": "dictionary",
                                                                                                    "label": "{\"payload\": data[webhook_payload_key]}",
                                                                                                    "start_token": 4746,
                                                                                                    "end_token": 4753,
                                                                                                    "children": [
                                                                                                        {
                                                                                                            "type": "pair",
                                                                                                            "label": "\"payload\": data[webhook_payload_key]",
                                                                                                            "start_token": 4746,
                                                                                                            "end_token": 4753,
                                                                                                            "children": [
                                                                                                                {
                                                                                                                    "type": "string",
                                                                                                                    "label": "\"payload\"",
                                                                                                                    "start_token": 4746,
                                                                                                                    "end_token": 4750,
                                                                                                                    "children": [
                                                                                                                        {
                                                                                                                            "type": "string_start",
                                                                                                                            "label": "\"",
                                                                                                                            "start_token": 4746,
                                                                                                                            "end_token": 4746,
                                                                                                                            "children": []
                                                                                                                        },
                                                                                                                        {
                                                                                                                            "type": "string_content",
                                                                                                                            "label": "payload",
                                                                                                                            "start_token": 4746,
                                                                                                                            "end_token": 4749,
                                                                                                                            "children": []
                                                                                                                        },
                                                                                                                        {
                                                                                                                            "type": "string_end",
                                                                                                                            "label": "\"",
                                                                                                                            "start_token": 4750,
                                                                                                                            "end_token": 4750,
                                                                                                                            "children": []
                                                                                                                        }
                                                                                                                    ]
                                                                                                                },
                                                                                                                {
                                                                                                                    "type": "subscript",
                                                                                                                    "label": "data[webhook_payload_key]",
                                                                                                                    "start_token": -1,
                                                                                                                    "end_token": 4753,
                                                                                                                    "children": [
                                                                                                                        {
                                                                                                                            "type": "identifier",
                                                                                                                            "label": "data",
                                                                                                                            "start_token": -1,
                                                                                                                            "end_token": -1,
                                                                                                                            "children": []
                                                                                                                        },
                                                                                                                        {
                                                                                                                            "type": "identifier",
                                                                                                                            "label": "webhook_payload_key",
                                                                                                                            "start_token": -1,
                                                                                                                            "end_token": 4753,
                                                                                                                            "children": []
                                                                                                                        }
                                                                                                                    ]
                                                                                                                }
                                                                                                            ]
                                                                                                        }
                                                                                                    ]
                                                                                                }
                                                                                            ]
                                                                                        }
                                                                                    ]
                                                                                }
                                                                            ]
                                                                        }
                                                                    ]
                                                                },
                                                                {
                                                                    "type": "expression_statement",
                                                                    "label": "input_data, error = validate_exec(node, input_data)",
                                                                    "start_token": 4755,
                                                                    "end_token": -1,
                                                                    "children": [
                                                                        {
                                                                            "type": "assignment",
                                                                            "label": "input_data, error = validate_exec(node, input_data)",
                                                                            "start_token": 4755,
                                                                            "end_token": -1,
                                                                            "children": [
                                                                                {
                                                                                    "type": "pattern_list",
                                                                                    "label": "input_data, error",
                                                                                    "start_token": 4755,
                                                                                    "end_token": 4759,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "label": "input_data",
                                                                                            "start_token": 4755,
                                                                                            "end_token": -1,
                                                                                            "children": []
                                                                                        },
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "label": "error",
                                                                                            "start_token": 4759,
                                                                                            "end_token": 4759,
                                                                                            "children": []
                                                                                        }
                                                                                    ]
                                                                                },
                                                                                {
                                                                                    "type": "call",
                                                                                    "label": "validate_exec(node, input_data)",
                                                                                    "start_token": 4760,
                                                                                    "end_token": -1,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "label": "validate_exec",
                                                                                            "start_token": 4760,
                                                                                            "end_token": -1,
                                                                                            "children": []
                                                                                        },
                                                                                        {
                                                                                            "type": "argument_list",
                                                                                            "label": "(node, input_data)",
                                                                                            "start_token": -1,
                                                                                            "end_token": -1,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "label": "node",
                                                                                                    "start_token": 4762,
                                                                                                    "end_token": 4763,
                                                                                                    "children": []
                                                                                                },
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "label": "input_data",
                                                                                                    "start_token": 4763,
                                                                                                    "end_token": 4764,
                                                                                                    "children": []
                                                                                                }
                                                                                            ]
                                                                                        }
                                                                                    ]
                                                                                }
                                                                            ]
                                                                        }
                                                                    ]
                                                                },
                                                                {
                                                                    "type": "if_statement",
                                                                    "label": "if input_data is None:\n                raise ValueError(error)\n            else:\n                nodes_input.append((node.id, input_data))",
                                                                    "start_token": -1,
                                                                    "end_token": 4793,
                                                                    "children": [
                                                                        {
                                                                            "type": "comparison_operator",
                                                                            "label": "input_data is None",
                                                                            "start_token": -1,
                                                                            "end_token": 4769,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "input_data",
                                                                                    "start_token": -1,
                                                                                    "end_token": 4768,
                                                                                    "children": []
                                                                                },
                                                                                {
                                                                                    "type": "none",
                                                                                    "label": "None",
                                                                                    "start_token": 4769,
                                                                                    "end_token": 4769,
                                                                                    "children": []
                                                                                }
                                                                            ]
                                                                        },
                                                                        {
                                                                            "type": "block",
                                                                            "label": "raise ValueError(error)",
                                                                            "start_token": -1,
                                                                            "end_token": -1,
                                                                            "children": [
                                                                                {
                                                                                    "type": "raise_statement",
                                                                                    "label": "raise ValueError(error)",
                                                                                    "start_token": -1,
                                                                                    "end_token": -1,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "call",
                                                                                            "label": "ValueError(error)",
                                                                                            "start_token": 4774,
                                                                                            "end_token": -1,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "label": "ValueError",
                                                                                                    "start_token": 4774,
                                                                                                    "end_token": -1,
                                                                                                    "children": []
                                                                                                },
                                                                                                {
                                                                                                    "type": "argument_list",
                                                                                                    "label": "(error)",
                                                                                                    "start_token": -1,
                                                                                                    "end_token": -1,
                                                                                                    "children": [
                                                                                                        {
                                                                                                            "type": "identifier",
                                                                                                            "label": "error",
                                                                                                            "start_token": -1,
                                                                                                            "end_token": -1,
                                                                                                            "children": []
                                                                                                        }
                                                                                                    ]
                                                                                                }
                                                                                            ]
                                                                                        }
                                                                                    ]
                                                                                }
                                                                            ]
                                                                        },
                                                                        {
                                                                            "type": "else_clause",
                                                                            "label": "else:\n                nodes_input.append((node.id, input_data))",
                                                                            "start_token": 4777,
                                                                            "end_token": 4793,
                                                                            "children": [
                                                                                {
                                                                                    "type": "block",
                                                                                    "label": "nodes_input.append((node.id, input_data))",
                                                                                    "start_token": 4786,
                                                                                    "end_token": 4793,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "expression_statement",
                                                                                            "label": "nodes_input.append((node.id, input_data))",
                                                                                            "start_token": 4786,
                                                                                            "end_token": 4793,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "call",
                                                                                                    "label": "nodes_input.append((node.id, input_data))",
                                                                                                    "start_token": 4786,
                                                                                                    "end_token": 4793,
                                                                                                    "children": [
                                                                                                        {
                                                                                                            "type": "attribute",
                                                                                                            "label": "nodes_input.append",
                                                                                                            "start_token": 4786,
                                                                                                            "end_token": -1,
                                                                                                            "children": [
                                                                                                                {
                                                                                                                    "type": "identifier",
                                                                                                                    "label": "nodes_input",
                                                                                                                    "start_token": 4786,
                                                                                                                    "end_token": 4788,
                                                                                                                    "children": []
                                                                                                                },
                                                                                                                {
                                                                                                                    "type": "identifier",
                                                                                                                    "label": "append",
                                                                                                                    "start_token": 4790,
                                                                                                                    "end_token": -1,
                                                                                                                    "children": []
                                                                                                                }
                                                                                                            ]
                                                                                                        },
                                                                                                        {
                                                                                                            "type": "argument_list",
                                                                                                            "label": "((node.id, input_data))",
                                                                                                            "start_token": -1,
                                                                                                            "end_token": 4793,
                                                                                                            "children": [
                                                                                                                {
                                                                                                                    "type": "tuple",
                                                                                                                    "label": "(node.id, input_data)",
                                                                                                                    "start_token": -1,
                                                                                                                    "end_token": 4793,
                                                                                                                    "children": [
                                                                                                                        {
                                                                                                                            "type": "attribute",
                                                                                                                            "label": "node.id",
                                                                                                                            "start_token": -1,
                                                                                                                            "end_token": 4791,
                                                                                                                            "children": [
                                                                                                                                {
                                                                                                                                    "type": "identifier",
                                                                                                                                    "label": "node",
                                                                                                                                    "start_token": -1,
                                                                                                                                    "end_token": 4791,
                                                                                                                                    "children": []
                                                                                                                                },
                                                                                                                                {
                                                                                                                                    "type": "identifier",
                                                                                                                                    "label": "id",
                                                                                                                                    "start_token": 4791,
                                                                                                                                    "end_token": 4791,
                                                                                                                                    "children": []
                                                                                                                                }
                                                                                                                            ]
                                                                                                                        },
                                                                                                                        {
                                                                                                                            "type": "identifier",
                                                                                                                            "label": "input_data",
                                                                                                                            "start_token": 4791,
                                                                                                                            "end_token": 4793,
                                                                                                                            "children": []
                                                                                                                        }
                                                                                                                    ]
                                                                                                                }
                                                                                                            ]
                                                                                                        }
                                                                                                    ]
                                                                                                }
                                                                                            ]
                                                                                        }
                                                                                    ]
                                                                                }
                                                                            ]
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                },
                                                {
                                                    "type": "expression_statement",
                                                    "label": "graph_exec_id, node_execs = self.db_client.create_graph_execution(\n            graph_id=graph_id,\n            graph_version=graph.version,\n            nodes_input=nodes_input,\n            user_id=user_id,\n        )",
                                                    "start_token": 4795,
                                                    "end_token": -1,
                                                    "children": [
                                                        {
                                                            "type": "assignment",
                                                            "label": "graph_exec_id, node_execs = self.db_client.create_graph_execution(\n            graph_id=graph_id,\n            graph_version=graph.version,\n            nodes_input=nodes_input,\n            user_id=user_id,\n        )",
                                                            "start_token": 4795,
                                                            "end_token": -1,
                                                            "children": [
                                                                {
                                                                    "type": "pattern_list",
                                                                    "label": "graph_exec_id, node_execs",
                                                                    "start_token": 4795,
                                                                    "end_token": 4799,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "graph_exec_id",
                                                                            "start_token": 4795,
                                                                            "end_token": 4798,
                                                                            "children": []
                                                                        },
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "node_execs",
                                                                            "start_token": 4799,
                                                                            "end_token": 4799,
                                                                            "children": []
                                                                        }
                                                                    ]
                                                                },
                                                                {
                                                                    "type": "call",
                                                                    "label": "self.db_client.create_graph_execution(\n            graph_id=graph_id,\n            graph_version=graph.version,\n            nodes_input=nodes_input,\n            user_id=user_id,\n        )",
                                                                    "start_token": 4799,
                                                                    "end_token": -1,
                                                                    "children": [
                                                                        {
                                                                            "type": "attribute",
                                                                            "label": "self.db_client.create_graph_execution",
                                                                            "start_token": 4799,
                                                                            "end_token": 4804,
                                                                            "children": [
                                                                                {
                                                                                    "type": "attribute",
                                                                                    "label": "self.db_client",
                                                                                    "start_token": 4799,
                                                                                    "end_token": -1,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "label": "self",
                                                                                            "start_token": 4799,
                                                                                            "end_token": 4799,
                                                                                            "children": []
                                                                                        },
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "label": "db_client",
                                                                                            "start_token": 4799,
                                                                                            "end_token": -1,
                                                                                            "children": []
                                                                                        }
                                                                                    ]
                                                                                },
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "create_graph_execution",
                                                                                    "start_token": -1,
                                                                                    "end_token": 4804,
                                                                                    "children": []
                                                                                }
                                                                            ]
                                                                        },
                                                                        {
                                                                            "type": "argument_list",
                                                                            "label": "(\n            graph_id=graph_id,\n            graph_version=graph.version,\n            nodes_input=nodes_input,\n            user_id=user_id,\n        )",
                                                                            "start_token": 4804,
                                                                            "end_token": -1,
                                                                            "children": [
                                                                                {
                                                                                    "type": "keyword_argument",
                                                                                    "label": "graph_id=graph_id",
                                                                                    "start_token": -1,
                                                                                    "end_token": 4809,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "label": "graph_id",
                                                                                            "start_token": -1,
                                                                                            "end_token": 4807,
                                                                                            "children": []
                                                                                        },
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "label": "graph_id",
                                                                                            "start_token": 4807,
                                                                                            "end_token": 4809,
                                                                                            "children": []
                                                                                        }
                                                                                    ]
                                                                                },
                                                                                {
                                                                                    "type": "keyword_argument",
                                                                                    "label": "graph_version=graph.version",
                                                                                    "start_token": -1,
                                                                                    "end_token": 4816,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "label": "graph_version",
                                                                                            "start_token": -1,
                                                                                            "end_token": 4814,
                                                                                            "children": []
                                                                                        },
                                                                                        {
                                                                                            "type": "attribute",
                                                                                            "label": "graph.version",
                                                                                            "start_token": 4814,
                                                                                            "end_token": 4816,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "label": "graph",
                                                                                                    "start_token": 4814,
                                                                                                    "end_token": 4814,
                                                                                                    "children": []
                                                                                                },
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "label": "version",
                                                                                                    "start_token": 4814,
                                                                                                    "end_token": 4816,
                                                                                                    "children": []
                                                                                                }
                                                                                            ]
                                                                                        }
                                                                                    ]
                                                                                },
                                                                                {
                                                                                    "type": "keyword_argument",
                                                                                    "label": "nodes_input=nodes_input",
                                                                                    "start_token": -1,
                                                                                    "end_token": 4822,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "label": "nodes_input",
                                                                                            "start_token": -1,
                                                                                            "end_token": 4819,
                                                                                            "children": []
                                                                                        },
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "label": "nodes_input",
                                                                                            "start_token": 4819,
                                                                                            "end_token": 4822,
                                                                                            "children": []
                                                                                        }
                                                                                    ]
                                                                                },
                                                                                {
                                                                                    "type": "keyword_argument",
                                                                                    "label": "user_id=user_id",
                                                                                    "start_token": -1,
                                                                                    "end_token": 4827,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "label": "user_id",
                                                                                            "start_token": -1,
                                                                                            "end_token": 4827,
                                                                                            "children": []
                                                                                        },
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "label": "user_id",
                                                                                            "start_token": 4827,
                                                                                            "end_token": 4827,
                                                                                            "children": []
                                                                                        }
                                                                                    ]
                                                                                }
                                                                            ]
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                },
                                                {
                                                    "type": "expression_statement",
                                                    "label": "starting_node_execs = []",
                                                    "start_token": -1,
                                                    "end_token": 4835,
                                                    "children": [
                                                        {
                                                            "type": "assignment",
                                                            "label": "starting_node_execs = []",
                                                            "start_token": -1,
                                                            "end_token": 4835,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "label": "starting_node_execs",
                                                                    "start_token": -1,
                                                                    "end_token": 4834,
                                                                    "children": []
                                                                },
                                                                {
                                                                    "type": "list",
                                                                    "label": "[]",
                                                                    "start_token": 4835,
                                                                    "end_token": 4835,
                                                                    "children": []
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                },
                                                {
                                                    "type": "for_statement",
                                                    "label": "for node_exec in node_execs:\n            starting_node_execs.append(\n                NodeExecutionEntry(\n                    user_id=user_id,\n                    graph_exec_id=node_exec.graph_exec_id,\n                    graph_id=node_exec.graph_id,\n                    node_exec_id=node_exec.node_exec_id,\n                    node_id=node_exec.node_id,\n                    data=node_exec.input_data,\n                )\n            )\n            exec_update = self.db_client.update_execution_status(\n                node_exec.node_exec_id, ExecutionStatus.QUEUED, node_exec.input_data\n            )\n            self.db_client.send_execution_update(exec_update)",
                                                    "start_token": -1,
                                                    "end_token": 4925,
                                                    "children": [
                                                        {
                                                            "type": "identifier",
                                                            "label": "node_exec",
                                                            "start_token": -1,
                                                            "end_token": 4838,
                                                            "children": []
                                                        },
                                                        {
                                                            "type": "identifier",
                                                            "label": "node_execs",
                                                            "start_token": 4838,
                                                            "end_token": 4838,
                                                            "children": []
                                                        },
                                                        {
                                                            "type": "block",
                                                            "label": "starting_node_execs.append(\n                NodeExecutionEntry(\n                    user_id=user_id,\n                    graph_exec_id=node_exec.graph_exec_id,\n                    graph_id=node_exec.graph_id,\n                    node_exec_id=node_exec.node_exec_id,\n                    node_id=node_exec.node_id,\n                    data=node_exec.input_data,\n                )\n            )\n            exec_update = self.db_client.update_execution_status(\n                node_exec.node_exec_id, ExecutionStatus.QUEUED, node_exec.input_data\n            )\n            self.db_client.send_execution_update(exec_update)",
                                                            "start_token": -1,
                                                            "end_token": 4925,
                                                            "children": [
                                                                {
                                                                    "type": "expression_statement",
                                                                    "label": "starting_node_execs.append(\n                NodeExecutionEntry(\n                    user_id=user_id,\n                    graph_exec_id=node_exec.graph_exec_id,\n                    graph_id=node_exec.graph_id,\n                    node_exec_id=node_exec.node_exec_id,\n                    node_id=node_exec.node_id,\n                    data=node_exec.input_data,\n                )\n            )",
                                                                    "start_token": -1,
                                                                    "end_token": 4892,
                                                                    "children": [
                                                                        {
                                                                            "type": "call",
                                                                            "label": "starting_node_execs.append(\n                NodeExecutionEntry(\n                    user_id=user_id,\n                    graph_exec_id=node_exec.graph_exec_id,\n                    graph_id=node_exec.graph_id,\n                    node_exec_id=node_exec.node_exec_id,\n                    node_id=node_exec.node_id,\n                    data=node_exec.input_data,\n                )\n            )",
                                                                            "start_token": -1,
                                                                            "end_token": 4892,
                                                                            "children": [
                                                                                {
                                                                                    "type": "attribute",
                                                                                    "label": "starting_node_execs.append",
                                                                                    "start_token": -1,
                                                                                    "end_token": 4843,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "label": "starting_node_execs",
                                                                                            "start_token": -1,
                                                                                            "end_token": 4843,
                                                                                            "children": []
                                                                                        },
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "label": "append",
                                                                                            "start_token": 4843,
                                                                                            "end_token": 4843,
                                                                                            "children": []
                                                                                        }
                                                                                    ]
                                                                                },
                                                                                {
                                                                                    "type": "argument_list",
                                                                                    "label": "(\n                NodeExecutionEntry(\n                    user_id=user_id,\n                    graph_exec_id=node_exec.graph_exec_id,\n                    graph_id=node_exec.graph_id,\n                    node_exec_id=node_exec.node_exec_id,\n                    node_id=node_exec.node_id,\n                    data=node_exec.input_data,\n                )\n            )",
                                                                                    "start_token": 4843,
                                                                                    "end_token": 4892,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "call",
                                                                                            "label": "NodeExecutionEntry(\n                    user_id=user_id,\n                    graph_exec_id=node_exec.graph_exec_id,\n                    graph_id=node_exec.graph_id,\n                    node_exec_id=node_exec.node_exec_id,\n                    node_id=node_exec.node_id,\n                    data=node_exec.input_data,\n                )",
                                                                                            "start_token": -1,
                                                                                            "end_token": 4890,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "label": "NodeExecutionEntry",
                                                                                                    "start_token": -1,
                                                                                                    "end_token": 4847,
                                                                                                    "children": []
                                                                                                },
                                                                                                {
                                                                                                    "type": "argument_list",
                                                                                                    "label": "(\n                    user_id=user_id,\n                    graph_exec_id=node_exec.graph_exec_id,\n                    graph_id=node_exec.graph_id,\n                    node_exec_id=node_exec.node_exec_id,\n                    node_id=node_exec.node_id,\n                    data=node_exec.input_data,\n                )",
                                                                                                    "start_token": 4848,
                                                                                                    "end_token": 4890,
                                                                                                    "children": [
                                                                                                        {
                                                                                                            "type": "keyword_argument",
                                                                                                            "label": "user_id=user_id",
                                                                                                            "start_token": -1,
                                                                                                            "end_token": 4851,
                                                                                                            "children": [
                                                                                                                {
                                                                                                                    "type": "identifier",
                                                                                                                    "label": "user_id",
                                                                                                                    "start_token": -1,
                                                                                                                    "end_token": -1,
                                                                                                                    "children": []
                                                                                                                },
                                                                                                                {
                                                                                                                    "type": "identifier",
                                                                                                                    "label": "user_id",
                                                                                                                    "start_token": 4851,
                                                                                                                    "end_token": 4851,
                                                                                                                    "children": []
                                                                                                                }
                                                                                                            ]
                                                                                                        },
                                                                                                        {
                                                                                                            "type": "keyword_argument",
                                                                                                            "label": "graph_exec_id=node_exec.graph_exec_id",
                                                                                                            "start_token": 4855,
                                                                                                            "end_token": 4858,
                                                                                                            "children": [
                                                                                                                {
                                                                                                                    "type": "identifier",
                                                                                                                    "label": "graph_exec_id",
                                                                                                                    "start_token": 4855,
                                                                                                                    "end_token": -1,
                                                                                                                    "children": []
                                                                                                                },
                                                                                                                {
                                                                                                                    "type": "attribute",
                                                                                                                    "label": "node_exec.graph_exec_id",
                                                                                                                    "start_token": -1,
                                                                                                                    "end_token": 4858,
                                                                                                                    "children": [
                                                                                                                        {
                                                                                                                            "type": "identifier",
                                                                                                                            "label": "node_exec",
                                                                                                                            "start_token": -1,
                                                                                                                            "end_token": -1,
                                                                                                                            "children": []
                                                                                                                        },
                                                                                                                        {
                                                                                                                            "type": "identifier",
                                                                                                                            "label": "graph_exec_id",
                                                                                                                            "start_token": -1,
                                                                                                                            "end_token": 4858,
                                                                                                                            "children": []
                                                                                                                        }
                                                                                                                    ]
                                                                                                                }
                                                                                                            ]
                                                                                                        },
                                                                                                        {
                                                                                                            "type": "keyword_argument",
                                                                                                            "label": "graph_id=node_exec.graph_id",
                                                                                                            "start_token": -1,
                                                                                                            "end_token": 4865,
                                                                                                            "children": [
                                                                                                                {
                                                                                                                    "type": "identifier",
                                                                                                                    "label": "graph_id",
                                                                                                                    "start_token": -1,
                                                                                                                    "end_token": -1,
                                                                                                                    "children": []
                                                                                                                },
                                                                                                                {
                                                                                                                    "type": "attribute",
                                                                                                                    "label": "node_exec.graph_id",
                                                                                                                    "start_token": -1,
                                                                                                                    "end_token": 4865,
                                                                                                                    "children": [
                                                                                                                        {
                                                                                                                            "type": "identifier",
                                                                                                                            "label": "node_exec",
                                                                                                                            "start_token": -1,
                                                                                                                            "end_token": -1,
                                                                                                                            "children": []
                                                                                                                        },
                                                                                                                        {
                                                                                                                            "type": "identifier",
                                                                                                                            "label": "graph_id",
                                                                                                                            "start_token": 4865,
                                                                                                                            "end_token": 4865,
                                                                                                                            "children": []
                                                                                                                        }
                                                                                                                    ]
                                                                                                                }
                                                                                                            ]
                                                                                                        },
                                                                                                        {
                                                                                                            "type": "keyword_argument",
                                                                                                            "label": "node_exec_id=node_exec.node_exec_id",
                                                                                                            "start_token": 4869,
                                                                                                            "end_token": 4873,
                                                                                                            "children": [
                                                                                                                {
                                                                                                                    "type": "identifier",
                                                                                                                    "label": "node_exec_id",
                                                                                                                    "start_token": 4869,
                                                                                                                    "end_token": -1,
                                                                                                                    "children": []
                                                                                                                },
                                                                                                                {
                                                                                                                    "type": "attribute",
                                                                                                                    "label": "node_exec.node_exec_id",
                                                                                                                    "start_token": -1,
                                                                                                                    "end_token": 4873,
                                                                                                                    "children": [
                                                                                                                        {
                                                                                                                            "type": "identifier",
                                                                                                                            "label": "node_exec",
                                                                                                                            "start_token": -1,
                                                                                                                            "end_token": -1,
                                                                                                                            "children": []
                                                                                                                        },
                                                                                                                        {
                                                                                                                            "type": "identifier",
                                                                                                                            "label": "node_exec_id",
                                                                                                                            "start_token": -1,
                                                                                                                            "end_token": 4873,
                                                                                                                            "children": []
                                                                                                                        }
                                                                                                                    ]
                                                                                                                }
                                                                                                            ]
                                                                                                        },
                                                                                                        {
                                                                                                            "type": "keyword_argument",
                                                                                                            "label": "node_id=node_exec.node_id",
                                                                                                            "start_token": -1,
                                                                                                            "end_token": 4881,
                                                                                                            "children": [
                                                                                                                {
                                                                                                                    "type": "identifier",
                                                                                                                    "label": "node_id",
                                                                                                                    "start_token": -1,
                                                                                                                    "end_token": -1,
                                                                                                                    "children": []
                                                                                                                },
                                                                                                                {
                                                                                                                    "type": "attribute",
                                                                                                                    "label": "node_exec.node_id",
                                                                                                                    "start_token": -1,
                                                                                                                    "end_token": 4881,
                                                                                                                    "children": [
                                                                                                                        {
                                                                                                                            "type": "identifier",
                                                                                                                            "label": "node_exec",
                                                                                                                            "start_token": -1,
                                                                                                                            "end_token": -1,
                                                                                                                            "children": []
                                                                                                                        },
                                                                                                                        {
                                                                                                                            "type": "identifier",
                                                                                                                            "label": "node_id",
                                                                                                                            "start_token": 4879,
                                                                                                                            "end_token": 4881,
                                                                                                                            "children": []
                                                                                                                        }
                                                                                                                    ]
                                                                                                                }
                                                                                                            ]
                                                                                                        },
                                                                                                        {
                                                                                                            "type": "keyword_argument",
                                                                                                            "label": "data=node_exec.input_data",
                                                                                                            "start_token": -1,
                                                                                                            "end_token": -1,
                                                                                                            "children": [
                                                                                                                {
                                                                                                                    "type": "identifier",
                                                                                                                    "label": "data",
                                                                                                                    "start_token": -1,
                                                                                                                    "end_token": -1,
                                                                                                                    "children": []
                                                                                                                },
                                                                                                                {
                                                                                                                    "type": "attribute",
                                                                                                                    "label": "node_exec.input_data",
                                                                                                                    "start_token": -1,
                                                                                                                    "end_token": -1,
                                                                                                                    "children": [
                                                                                                                        {
                                                                                                                            "type": "identifier",
                                                                                                                            "label": "node_exec",
                                                                                                                            "start_token": -1,
                                                                                                                            "end_token": 4886,
                                                                                                                            "children": []
                                                                                                                        },
                                                                                                                        {
                                                                                                                            "type": "identifier",
                                                                                                                            "label": "input_data",
                                                                                                                            "start_token": -1,
                                                                                                                            "end_token": -1,
                                                                                                                            "children": []
                                                                                                                        }
                                                                                                                    ]
                                                                                                                }
                                                                                                            ]
                                                                                                        }
                                                                                                    ]
                                                                                                }
                                                                                            ]
                                                                                        }
                                                                                    ]
                                                                                }
                                                                            ]
                                                                        }
                                                                    ]
                                                                },
                                                                {
                                                                    "type": "expression_statement",
                                                                    "label": "exec_update = self.db_client.update_execution_status(\n                node_exec.node_exec_id, ExecutionStatus.QUEUED, node_exec.input_data\n            )",
                                                                    "start_token": 4896,
                                                                    "end_token": 4917,
                                                                    "children": [
                                                                        {
                                                                            "type": "assignment",
                                                                            "label": "exec_update = self.db_client.update_execution_status(\n                node_exec.node_exec_id, ExecutionStatus.QUEUED, node_exec.input_data\n            )",
                                                                            "start_token": 4896,
                                                                            "end_token": 4917,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "exec_update",
                                                                                    "start_token": 4896,
                                                                                    "end_token": 4896,
                                                                                    "children": []
                                                                                },
                                                                                {
                                                                                    "type": "call",
                                                                                    "label": "self.db_client.update_execution_status(\n                node_exec.node_exec_id, ExecutionStatus.QUEUED, node_exec.input_data\n            )",
                                                                                    "start_token": 4896,
                                                                                    "end_token": 4917,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "attribute",
                                                                                            "label": "self.db_client.update_execution_status",
                                                                                            "start_token": 4896,
                                                                                            "end_token": 4901,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "attribute",
                                                                                                    "label": "self.db_client",
                                                                                                    "start_token": 4896,
                                                                                                    "end_token": -1,
                                                                                                    "children": [
                                                                                                        {
                                                                                                            "type": "identifier",
                                                                                                            "label": "self",
                                                                                                            "start_token": 4896,
                                                                                                            "end_token": 4896,
                                                                                                            "children": []
                                                                                                        },
                                                                                                        {
                                                                                                            "type": "identifier",
                                                                                                            "label": "db_client",
                                                                                                            "start_token": 4896,
                                                                                                            "end_token": -1,
                                                                                                            "children": []
                                                                                                        }
                                                                                                    ]
                                                                                                },
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "label": "update_execution_status",
                                                                                                    "start_token": -1,
                                                                                                    "end_token": 4901,
                                                                                                    "children": []
                                                                                                }
                                                                                            ]
                                                                                        },
                                                                                        {
                                                                                            "type": "argument_list",
                                                                                            "label": "(\n                node_exec.node_exec_id, ExecutionStatus.QUEUED, node_exec.input_data\n            )",
                                                                                            "start_token": 4901,
                                                                                            "end_token": 4917,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "attribute",
                                                                                                    "label": "node_exec.node_exec_id",
                                                                                                    "start_token": 4903,
                                                                                                    "end_token": 4907,
                                                                                                    "children": [
                                                                                                        {
                                                                                                            "type": "identifier",
                                                                                                            "label": "node_exec",
                                                                                                            "start_token": 4903,
                                                                                                            "end_token": 4903,
                                                                                                            "children": []
                                                                                                        },
                                                                                                        {
                                                                                                            "type": "identifier",
                                                                                                            "label": "node_exec_id",
                                                                                                            "start_token": 4905,
                                                                                                            "end_token": 4907,
                                                                                                            "children": []
                                                                                                        }
                                                                                                    ]
                                                                                                },
                                                                                                {
                                                                                                    "type": "attribute",
                                                                                                    "label": "ExecutionStatus.QUEUED",
                                                                                                    "start_token": 4907,
                                                                                                    "end_token": -1,
                                                                                                    "children": [
                                                                                                        {
                                                                                                            "type": "identifier",
                                                                                                            "label": "ExecutionStatus",
                                                                                                            "start_token": 4907,
                                                                                                            "end_token": 4910,
                                                                                                            "children": []
                                                                                                        },
                                                                                                        {
                                                                                                            "type": "identifier",
                                                                                                            "label": "QUEUED",
                                                                                                            "start_token": -1,
                                                                                                            "end_token": -1,
                                                                                                            "children": []
                                                                                                        }
                                                                                                    ]
                                                                                                },
                                                                                                {
                                                                                                    "type": "attribute",
                                                                                                    "label": "node_exec.input_data",
                                                                                                    "start_token": -1,
                                                                                                    "end_token": 4913,
                                                                                                    "children": [
                                                                                                        {
                                                                                                            "type": "identifier",
                                                                                                            "label": "node_exec",
                                                                                                            "start_token": -1,
                                                                                                            "end_token": -1,
                                                                                                            "children": []
                                                                                                        },
                                                                                                        {
                                                                                                            "type": "identifier",
                                                                                                            "label": "input_data",
                                                                                                            "start_token": -1,
                                                                                                            "end_token": 4913,
                                                                                                            "children": []
                                                                                                        }
                                                                                                    ]
                                                                                                }
                                                                                            ]
                                                                                        }
                                                                                    ]
                                                                                }
                                                                            ]
                                                                        }
                                                                    ]
                                                                },
                                                                {
                                                                    "type": "expression_statement",
                                                                    "label": "self.db_client.send_execution_update(exec_update)",
                                                                    "start_token": 4917,
                                                                    "end_token": 4925,
                                                                    "children": [
                                                                        {
                                                                            "type": "call",
                                                                            "label": "self.db_client.send_execution_update(exec_update)",
                                                                            "start_token": 4917,
                                                                            "end_token": 4925,
                                                                            "children": [
                                                                                {
                                                                                    "type": "attribute",
                                                                                    "label": "self.db_client.send_execution_update",
                                                                                    "start_token": 4917,
                                                                                    "end_token": 4923,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "attribute",
                                                                                            "label": "self.db_client",
                                                                                            "start_token": 4917,
                                                                                            "end_token": 4919,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "label": "self",
                                                                                                    "start_token": 4917,
                                                                                                    "end_token": 4917,
                                                                                                    "children": []
                                                                                                },
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "label": "db_client",
                                                                                                    "start_token": 4917,
                                                                                                    "end_token": 4919,
                                                                                                    "children": []
                                                                                                }
                                                                                            ]
                                                                                        },
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "label": "send_execution_update",
                                                                                            "start_token": 4919,
                                                                                            "end_token": 4923,
                                                                                            "children": []
                                                                                        }
                                                                                    ]
                                                                                },
                                                                                {
                                                                                    "type": "argument_list",
                                                                                    "label": "(exec_update)",
                                                                                    "start_token": 4923,
                                                                                    "end_token": 4925,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "label": "exec_update",
                                                                                            "start_token": 4923,
                                                                                            "end_token": 4925,
                                                                                            "children": []
                                                                                        }
                                                                                    ]
                                                                                }
                                                                            ]
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                },
                                                {
                                                    "type": "expression_statement",
                                                    "label": "graph_exec = GraphExecutionEntry(\n            user_id=user_id,\n            graph_id=graph_id,\n            graph_exec_id=graph_exec_id,\n            start_node_execs=starting_node_execs,\n        )",
                                                    "start_token": 4925,
                                                    "end_token": 4956,
                                                    "children": [
                                                        {
                                                            "type": "assignment",
                                                            "label": "graph_exec = GraphExecutionEntry(\n            user_id=user_id,\n            graph_id=graph_id,\n            graph_exec_id=graph_exec_id,\n            start_node_execs=starting_node_execs,\n        )",
                                                            "start_token": 4925,
                                                            "end_token": 4956,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "label": "graph_exec",
                                                                    "start_token": 4925,
                                                                    "end_token": -1,
                                                                    "children": []
                                                                },
                                                                {
                                                                    "type": "call",
                                                                    "label": "GraphExecutionEntry(\n            user_id=user_id,\n            graph_id=graph_id,\n            graph_exec_id=graph_exec_id,\n            start_node_execs=starting_node_execs,\n        )",
                                                                    "start_token": -1,
                                                                    "end_token": 4956,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "GraphExecutionEntry",
                                                                            "start_token": -1,
                                                                            "end_token": 4931,
                                                                            "children": []
                                                                        },
                                                                        {
                                                                            "type": "argument_list",
                                                                            "label": "(\n            user_id=user_id,\n            graph_id=graph_id,\n            graph_exec_id=graph_exec_id,\n            start_node_execs=starting_node_execs,\n        )",
                                                                            "start_token": 4932,
                                                                            "end_token": 4956,
                                                                            "children": [
                                                                                {
                                                                                    "type": "keyword_argument",
                                                                                    "label": "user_id=user_id",
                                                                                    "start_token": 4933,
                                                                                    "end_token": 4935,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "label": "user_id",
                                                                                            "start_token": 4933,
                                                                                            "end_token": 4933,
                                                                                            "children": []
                                                                                        },
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "label": "user_id",
                                                                                            "start_token": 4935,
                                                                                            "end_token": 4935,
                                                                                            "children": []
                                                                                        }
                                                                                    ]
                                                                                },
                                                                                {
                                                                                    "type": "keyword_argument",
                                                                                    "label": "graph_id=graph_id",
                                                                                    "start_token": -1,
                                                                                    "end_token": 4940,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "label": "graph_id",
                                                                                            "start_token": -1,
                                                                                            "end_token": 4938,
                                                                                            "children": []
                                                                                        },
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "label": "graph_id",
                                                                                            "start_token": 4938,
                                                                                            "end_token": 4940,
                                                                                            "children": []
                                                                                        }
                                                                                    ]
                                                                                },
                                                                                {
                                                                                    "type": "keyword_argument",
                                                                                    "label": "graph_exec_id=graph_exec_id",
                                                                                    "start_token": -1,
                                                                                    "end_token": 4943,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "label": "graph_exec_id",
                                                                                            "start_token": -1,
                                                                                            "end_token": 4943,
                                                                                            "children": []
                                                                                        },
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "label": "graph_exec_id",
                                                                                            "start_token": 4943,
                                                                                            "end_token": 4943,
                                                                                            "children": []
                                                                                        }
                                                                                    ]
                                                                                },
                                                                                {
                                                                                    "type": "keyword_argument",
                                                                                    "label": "start_node_execs=starting_node_execs",
                                                                                    "start_token": 4945,
                                                                                    "end_token": 4952,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "label": "start_node_execs",
                                                                                            "start_token": 4945,
                                                                                            "end_token": -1,
                                                                                            "children": []
                                                                                        },
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "label": "starting_node_execs",
                                                                                            "start_token": 4949,
                                                                                            "end_token": 4952,
                                                                                            "children": []
                                                                                        }
                                                                                    ]
                                                                                }
                                                                            ]
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                },
                                                {
                                                    "type": "expression_statement",
                                                    "label": "self.queue.add(graph_exec)",
                                                    "start_token": -1,
                                                    "end_token": -1,
                                                    "children": [
                                                        {
                                                            "type": "call",
                                                            "label": "self.queue.add(graph_exec)",
                                                            "start_token": -1,
                                                            "end_token": -1,
                                                            "children": [
                                                                {
                                                                    "type": "attribute",
                                                                    "label": "self.queue.add",
                                                                    "start_token": -1,
                                                                    "end_token": 4961,
                                                                    "children": [
                                                                        {
                                                                            "type": "attribute",
                                                                            "label": "self.queue",
                                                                            "start_token": -1,
                                                                            "end_token": 4960,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "self",
                                                                                    "start_token": -1,
                                                                                    "end_token": -1,
                                                                                    "children": []
                                                                                },
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "queue",
                                                                                    "start_token": -1,
                                                                                    "end_token": 4960,
                                                                                    "children": []
                                                                                }
                                                                            ]
                                                                        },
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "add",
                                                                            "start_token": 4960,
                                                                            "end_token": 4961,
                                                                            "children": []
                                                                        }
                                                                    ]
                                                                },
                                                                {
                                                                    "type": "argument_list",
                                                                    "label": "(graph_exec)",
                                                                    "start_token": 4961,
                                                                    "end_token": -1,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "graph_exec",
                                                                            "start_token": 4961,
                                                                            "end_token": 4963,
                                                                            "children": []
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                },
                                                {
                                                    "type": "return_statement",
                                                    "label": "return graph_exec",
                                                    "start_token": 4966,
                                                    "end_token": 4968,
                                                    "children": [
                                                        {
                                                            "type": "identifier",
                                                            "label": "graph_exec",
                                                            "start_token": 4967,
                                                            "end_token": 4968,
                                                            "children": []
                                                        }
                                                    ]
                                                }
                                            ]
                                        }
                                    ]
                                }
                            ]
                        },
                        {
                            "type": "decorated_definition",
                            "label": "@expose\n    def cancel_execution(self, graph_exec_id: str) -> None:\n        \"\"\"\n        Mechanism:\n        1. Set the cancel event\n        2. Graph executor's cancel handler thread detects the event, terminates workers,\n           reinitializes worker pool, and returns.\n        3. Update execution statuses in DB and set `error` outputs to `\"TERMINATED\"`.\n        \"\"\"\n        if graph_exec_id not in self.active_graph_runs:\n            raise Exception(\n                f\"Graph execution #{graph_exec_id} not active/running: \"\n                \"possibly already completed/cancelled.\"\n            )\n\n        future, cancel_event = self.active_graph_runs[graph_exec_id]\n        if cancel_event.is_set():\n            return\n\n        cancel_event.set()\n        future.result()\n\n        # Update the status of the unfinished node executions\n        node_execs = self.db_client.get_execution_results(graph_exec_id)\n        for node_exec in node_execs:\n            if node_exec.status not in (\n                ExecutionStatus.COMPLETED,\n                ExecutionStatus.FAILED,\n            ):\n                self.db_client.upsert_execution_output(\n                    node_exec.node_exec_id, \"error\", \"TERMINATED\"\n                )\n                exec_update = self.db_client.update_execution_status(\n                    node_exec.node_exec_id, ExecutionStatus.FAILED\n                )\n                self.db_client.send_execution_update(exec_update)",
                            "start_token": 4968,
                            "end_token": 5138,
                            "children": [
                                {
                                    "type": "decorator",
                                    "label": "@expose",
                                    "start_token": 4968,
                                    "end_token": 4970,
                                    "children": [
                                        {
                                            "type": "identifier",
                                            "label": "expose",
                                            "start_token": 4968,
                                            "end_token": 4970,
                                            "children": []
                                        }
                                    ]
                                },
                                {
                                    "type": "function_definition",
                                    "label": "def cancel_execution(self, graph_exec_id: str) -> None:\n        \"\"\"\n        Mechanism:\n        1. Set the cancel event\n        2. Graph executor's cancel handler thread detects the event, terminates workers,\n           reinitializes worker pool, and returns.\n        3. Update execution statuses in DB and set `error` outputs to `\"TERMINATED\"`.\n        \"\"\"\n        if graph_exec_id not in self.active_graph_runs:\n            raise Exception(\n                f\"Graph execution #{graph_exec_id} not active/running: \"\n                \"possibly already completed/cancelled.\"\n            )\n\n        future, cancel_event = self.active_graph_runs[graph_exec_id]\n        if cancel_event.is_set():\n            return\n\n        cancel_event.set()\n        future.result()\n\n        # Update the status of the unfinished node executions\n        node_execs = self.db_client.get_execution_results(graph_exec_id)\n        for node_exec in node_execs:\n            if node_exec.status not in (\n                ExecutionStatus.COMPLETED,\n                ExecutionStatus.FAILED,\n            ):\n                self.db_client.upsert_execution_output(\n                    node_exec.node_exec_id, \"error\", \"TERMINATED\"\n                )\n                exec_update = self.db_client.update_execution_status(\n                    node_exec.node_exec_id, ExecutionStatus.FAILED\n                )\n                self.db_client.send_execution_update(exec_update)",
                                    "start_token": 4972,
                                    "end_token": 5138,
                                    "children": [
                                        {
                                            "type": "identifier",
                                            "label": "cancel_execution",
                                            "start_token": 4972,
                                            "end_token": -1,
                                            "children": []
                                        },
                                        {
                                            "type": "parameters",
                                            "label": "(self, graph_exec_id: str)",
                                            "start_token": 4978,
                                            "end_token": 4982,
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "label": "self",
                                                    "start_token": 4978,
                                                    "end_token": 4979,
                                                    "children": []
                                                },
                                                {
                                                    "type": "typed_parameter",
                                                    "label": "graph_exec_id: str",
                                                    "start_token": -1,
                                                    "end_token": 4982,
                                                    "children": [
                                                        {
                                                            "type": "identifier",
                                                            "label": "graph_exec_id",
                                                            "start_token": -1,
                                                            "end_token": 4982,
                                                            "children": []
                                                        },
                                                        {
                                                            "type": "type",
                                                            "label": "str",
                                                            "start_token": 4982,
                                                            "end_token": 4982,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "label": "str",
                                                                    "start_token": 4982,
                                                                    "end_token": 4982,
                                                                    "children": []
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                }
                                            ]
                                        },
                                        {
                                            "type": "type",
                                            "label": "None",
                                            "start_token": 4982,
                                            "end_token": 4982,
                                            "children": [
                                                {
                                                    "type": "none",
                                                    "label": "None",
                                                    "start_token": 4982,
                                                    "end_token": 4982,
                                                    "children": []
                                                }
                                            ]
                                        },
                                        {
                                            "type": "block",
                                            "label": "\"\"\"\n        Mechanism:\n        1. Set the cancel event\n        2. Graph executor's cancel handler thread detects the event, terminates workers,\n           reinitializes worker pool, and returns.\n        3. Update execution statuses in DB and set `error` outputs to `\"TERMINATED\"`.\n        \"\"\"\n        if graph_exec_id not in self.active_graph_runs:\n            raise Exception(\n                f\"Graph execution #{graph_exec_id} not active/running: \"\n                \"possibly already completed/cancelled.\"\n            )\n\n        future, cancel_event = self.active_graph_runs[graph_exec_id]\n        if cancel_event.is_set():\n            return\n\n        cancel_event.set()\n        future.result()\n\n        # Update the status of the unfinished node executions\n        node_execs = self.db_client.get_execution_results(graph_exec_id)\n        for node_exec in node_execs:\n            if node_exec.status not in (\n                ExecutionStatus.COMPLETED,\n                ExecutionStatus.FAILED,\n            ):\n                self.db_client.upsert_execution_output(\n                    node_exec.node_exec_id, \"error\", \"TERMINATED\"\n                )\n                exec_update = self.db_client.update_execution_status(\n                    node_exec.node_exec_id, ExecutionStatus.FAILED\n                )\n                self.db_client.send_execution_update(exec_update)",
                                            "start_token": 4982,
                                            "end_token": 5138,
                                            "children": [
                                                {
                                                    "type": "expression_statement",
                                                    "label": "\"\"\"\n        Mechanism:\n        1. Set the cancel event\n        2. Graph executor's cancel handler thread detects the event, terminates workers,\n           reinitializes worker pool, and returns.\n        3. Update execution statuses in DB and set `error` outputs to `\"TERMINATED\"`.\n        \"\"\"",
                                                    "start_token": 4982,
                                                    "end_token": -1,
                                                    "children": [
                                                        {
                                                            "type": "string",
                                                            "label": "\"\"\"\n        Mechanism:\n        1. Set the cancel event\n        2. Graph executor's cancel handler thread detects the event, terminates workers,\n           reinitializes worker pool, and returns.\n        3. Update execution statuses in DB and set `error` outputs to `\"TERMINATED\"`.\n        \"\"\"",
                                                            "start_token": 4982,
                                                            "end_token": -1,
                                                            "children": [
                                                                {
                                                                    "type": "string_start",
                                                                    "label": "\"\"\"",
                                                                    "start_token": 4982,
                                                                    "end_token": 4982,
                                                                    "children": []
                                                                },
                                                                {
                                                                    "type": "string_content",
                                                                    "label": "\n        Mechanism:\n        1. Set the cancel event\n        2. Graph executor's cancel handler thread detects the event, terminates workers,\n           reinitializes worker pool, and returns.\n        3. Update execution statuses in DB and set `error` outputs to `\"TERMINATED\"`.\n        ",
                                                                    "start_token": 4982,
                                                                    "end_token": 4989,
                                                                    "children": []
                                                                },
                                                                {
                                                                    "type": "string_end",
                                                                    "label": "\"\"\"",
                                                                    "start_token": 4989,
                                                                    "end_token": -1,
                                                                    "children": []
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                },
                                                {
                                                    "type": "if_statement",
                                                    "label": "if graph_exec_id not in self.active_graph_runs:\n            raise Exception(\n                f\"Graph execution #{graph_exec_id} not active/running: \"\n                \"possibly already completed/cancelled.\"\n            )",
                                                    "start_token": 4993,
                                                    "end_token": 5010,
                                                    "children": [
                                                        {
                                                            "type": "comparison_operator",
                                                            "label": "graph_exec_id not in self.active_graph_runs",
                                                            "start_token": 4993,
                                                            "end_token": 4998,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "label": "graph_exec_id",
                                                                    "start_token": 4993,
                                                                    "end_token": 4993,
                                                                    "children": []
                                                                },
                                                                {
                                                                    "type": "attribute",
                                                                    "label": "self.active_graph_runs",
                                                                    "start_token": -1,
                                                                    "end_token": 4998,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "self",
                                                                            "start_token": -1,
                                                                            "end_token": -1,
                                                                            "children": []
                                                                        },
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "active_graph_runs",
                                                                            "start_token": -1,
                                                                            "end_token": 4998,
                                                                            "children": []
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        },
                                                        {
                                                            "type": "block",
                                                            "label": "raise Exception(\n                f\"Graph execution #{graph_exec_id} not active/running: \"\n                \"possibly already completed/cancelled.\"\n            )",
                                                            "start_token": -1,
                                                            "end_token": 5010,
                                                            "children": [
                                                                {
                                                                    "type": "raise_statement",
                                                                    "label": "raise Exception(\n                f\"Graph execution #{graph_exec_id} not active/running: \"\n                \"possibly already completed/cancelled.\"\n            )",
                                                                    "start_token": -1,
                                                                    "end_token": 5010,
                                                                    "children": [
                                                                        {
                                                                            "type": "call",
                                                                            "label": "Exception(\n                f\"Graph execution #{graph_exec_id} not active/running: \"\n                \"possibly already completed/cancelled.\"\n            )",
                                                                            "start_token": 5001,
                                                                            "end_token": 5010,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "Exception",
                                                                                    "start_token": 5001,
                                                                                    "end_token": 5001,
                                                                                    "children": []
                                                                                },
                                                                                {
                                                                                    "type": "argument_list",
                                                                                    "label": "(\n                f\"Graph execution #{graph_exec_id} not active/running: \"\n                \"possibly already completed/cancelled.\"\n            )",
                                                                                    "start_token": 5001,
                                                                                    "end_token": 5010,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "concatenated_string",
                                                                                            "label": "f\"Graph execution #{graph_exec_id} not active/running: \"\n                \"possibly already completed/cancelled.\"",
                                                                                            "start_token": 5001,
                                                                                            "end_token": 5008,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "string",
                                                                                                    "label": "f\"Graph execution #{graph_exec_id} not active/running: \"",
                                                                                                    "start_token": 5001,
                                                                                                    "end_token": 5003,
                                                                                                    "children": [
                                                                                                        {
                                                                                                            "type": "string_start",
                                                                                                            "label": "f\"",
                                                                                                            "start_token": 5001,
                                                                                                            "end_token": 5001,
                                                                                                            "children": []
                                                                                                        },
                                                                                                        {
                                                                                                            "type": "string_content",
                                                                                                            "label": "Graph execution #",
                                                                                                            "start_token": 5001,
                                                                                                            "end_token": 5001,
                                                                                                            "children": []
                                                                                                        },
                                                                                                        {
                                                                                                            "type": "interpolation",
                                                                                                            "label": "{graph_exec_id}",
                                                                                                            "start_token": 5001,
                                                                                                            "end_token": -1,
                                                                                                            "children": [
                                                                                                                {
                                                                                                                    "type": "identifier",
                                                                                                                    "label": "graph_exec_id",
                                                                                                                    "start_token": 5001,
                                                                                                                    "end_token": -1,
                                                                                                                    "children": []
                                                                                                                }
                                                                                                            ]
                                                                                                        },
                                                                                                        {
                                                                                                            "type": "string_content",
                                                                                                            "label": " not active/running: ",
                                                                                                            "start_token": -1,
                                                                                                            "end_token": 5003,
                                                                                                            "children": []
                                                                                                        },
                                                                                                        {
                                                                                                            "type": "string_end",
                                                                                                            "label": "\"",
                                                                                                            "start_token": 5003,
                                                                                                            "end_token": 5003,
                                                                                                            "children": []
                                                                                                        }
                                                                                                    ]
                                                                                                },
                                                                                                {
                                                                                                    "type": "string",
                                                                                                    "label": "\"possibly already completed/cancelled.\"",
                                                                                                    "start_token": 5003,
                                                                                                    "end_token": 5008,
                                                                                                    "children": [
                                                                                                        {
                                                                                                            "type": "string_start",
                                                                                                            "label": "\"",
                                                                                                            "start_token": 5003,
                                                                                                            "end_token": 5003,
                                                                                                            "children": []
                                                                                                        },
                                                                                                        {
                                                                                                            "type": "string_content",
                                                                                                            "label": "possibly already completed/cancelled.",
                                                                                                            "start_token": 5003,
                                                                                                            "end_token": 5008,
                                                                                                            "children": []
                                                                                                        },
                                                                                                        {
                                                                                                            "type": "string_end",
                                                                                                            "label": "\"",
                                                                                                            "start_token": 5008,
                                                                                                            "end_token": 5008,
                                                                                                            "children": []
                                                                                                        }
                                                                                                    ]
                                                                                                }
                                                                                            ]
                                                                                        }
                                                                                    ]
                                                                                }
                                                                            ]
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                },
                                                {
                                                    "type": "expression_statement",
                                                    "label": "future, cancel_event = self.active_graph_runs[graph_exec_id]",
                                                    "start_token": 5014,
                                                    "end_token": 5022,
                                                    "children": [
                                                        {
                                                            "type": "assignment",
                                                            "label": "future, cancel_event = self.active_graph_runs[graph_exec_id]",
                                                            "start_token": 5014,
                                                            "end_token": 5022,
                                                            "children": [
                                                                {
                                                                    "type": "pattern_list",
                                                                    "label": "future, cancel_event",
                                                                    "start_token": 5014,
                                                                    "end_token": 5016,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "future",
                                                                            "start_token": 5014,
                                                                            "end_token": 5014,
                                                                            "children": []
                                                                        },
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "cancel_event",
                                                                            "start_token": 5014,
                                                                            "end_token": 5016,
                                                                            "children": []
                                                                        }
                                                                    ]
                                                                },
                                                                {
                                                                    "type": "subscript",
                                                                    "label": "self.active_graph_runs[graph_exec_id]",
                                                                    "start_token": 5016,
                                                                    "end_token": 5022,
                                                                    "children": [
                                                                        {
                                                                            "type": "attribute",
                                                                            "label": "self.active_graph_runs",
                                                                            "start_token": 5016,
                                                                            "end_token": 5020,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "self",
                                                                                    "start_token": 5016,
                                                                                    "end_token": 5016,
                                                                                    "children": []
                                                                                },
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "active_graph_runs",
                                                                                    "start_token": 5016,
                                                                                    "end_token": 5020,
                                                                                    "children": []
                                                                                }
                                                                            ]
                                                                        },
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "graph_exec_id",
                                                                            "start_token": 5020,
                                                                            "end_token": 5022,
                                                                            "children": []
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                },
                                                {
                                                    "type": "if_statement",
                                                    "label": "if cancel_event.is_set():\n            return",
                                                    "start_token": -1,
                                                    "end_token": -1,
                                                    "children": [
                                                        {
                                                            "type": "call",
                                                            "label": "cancel_event.is_set()",
                                                            "start_token": -1,
                                                            "end_token": -1,
                                                            "children": [
                                                                {
                                                                    "type": "attribute",
                                                                    "label": "cancel_event.is_set",
                                                                    "start_token": -1,
                                                                    "end_token": -1,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "cancel_event",
                                                                            "start_token": -1,
                                                                            "end_token": 5028,
                                                                            "children": []
                                                                        },
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "is_set",
                                                                            "start_token": -1,
                                                                            "end_token": -1,
                                                                            "children": []
                                                                        }
                                                                    ]
                                                                },
                                                                {
                                                                    "type": "argument_list",
                                                                    "label": "()",
                                                                    "start_token": -1,
                                                                    "end_token": -1,
                                                                    "children": []
                                                                }
                                                            ]
                                                        },
                                                        {
                                                            "type": "block",
                                                            "label": "return",
                                                            "start_token": 5032,
                                                            "end_token": -1,
                                                            "children": [
                                                                {
                                                                    "type": "return_statement",
                                                                    "label": "return",
                                                                    "start_token": 5032,
                                                                    "end_token": -1,
                                                                    "children": []
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                },
                                                {
                                                    "type": "expression_statement",
                                                    "label": "cancel_event.set()",
                                                    "start_token": 5036,
                                                    "end_token": -1,
                                                    "children": [
                                                        {
                                                            "type": "call",
                                                            "label": "cancel_event.set()",
                                                            "start_token": 5036,
                                                            "end_token": -1,
                                                            "children": [
                                                                {
                                                                    "type": "attribute",
                                                                    "label": "cancel_event.set",
                                                                    "start_token": 5036,
                                                                    "end_token": -1,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "cancel_event",
                                                                            "start_token": 5036,
                                                                            "end_token": 5040,
                                                                            "children": []
                                                                        },
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "set",
                                                                            "start_token": 5042,
                                                                            "end_token": -1,
                                                                            "children": []
                                                                        }
                                                                    ]
                                                                },
                                                                {
                                                                    "type": "argument_list",
                                                                    "label": "()",
                                                                    "start_token": -1,
                                                                    "end_token": -1,
                                                                    "children": []
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                },
                                                {
                                                    "type": "expression_statement",
                                                    "label": "future.result()",
                                                    "start_token": 5044,
                                                    "end_token": -1,
                                                    "children": [
                                                        {
                                                            "type": "call",
                                                            "label": "future.result()",
                                                            "start_token": 5044,
                                                            "end_token": -1,
                                                            "children": [
                                                                {
                                                                    "type": "attribute",
                                                                    "label": "future.result",
                                                                    "start_token": 5044,
                                                                    "end_token": 5046,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "future",
                                                                            "start_token": 5044,
                                                                            "end_token": 5045,
                                                                            "children": []
                                                                        },
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "result",
                                                                            "start_token": -1,
                                                                            "end_token": 5046,
                                                                            "children": []
                                                                        }
                                                                    ]
                                                                },
                                                                {
                                                                    "type": "argument_list",
                                                                    "label": "()",
                                                                    "start_token": 5046,
                                                                    "end_token": -1,
                                                                    "children": []
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                },
                                                {
                                                    "type": "comment",
                                                    "label": "# Update the status of the unfinished node executions",
                                                    "start_token": 5049,
                                                    "end_token": 5057,
                                                    "children": []
                                                },
                                                {
                                                    "type": "expression_statement",
                                                    "label": "node_execs = self.db_client.get_execution_results(graph_exec_id)",
                                                    "start_token": 5059,
                                                    "end_token": 5067,
                                                    "children": [
                                                        {
                                                            "type": "assignment",
                                                            "label": "node_execs = self.db_client.get_execution_results(graph_exec_id)",
                                                            "start_token": 5059,
                                                            "end_token": 5067,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "label": "node_execs",
                                                                    "start_token": 5059,
                                                                    "end_token": 5059,
                                                                    "children": []
                                                                },
                                                                {
                                                                    "type": "call",
                                                                    "label": "self.db_client.get_execution_results(graph_exec_id)",
                                                                    "start_token": 5059,
                                                                    "end_token": 5067,
                                                                    "children": [
                                                                        {
                                                                            "type": "attribute",
                                                                            "label": "self.db_client.get_execution_results",
                                                                            "start_token": 5059,
                                                                            "end_token": 5065,
                                                                            "children": [
                                                                                {
                                                                                    "type": "attribute",
                                                                                    "label": "self.db_client",
                                                                                    "start_token": 5059,
                                                                                    "end_token": 5061,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "label": "self",
                                                                                            "start_token": 5059,
                                                                                            "end_token": 5059,
                                                                                            "children": []
                                                                                        },
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "label": "db_client",
                                                                                            "start_token": 5059,
                                                                                            "end_token": 5061,
                                                                                            "children": []
                                                                                        }
                                                                                    ]
                                                                                },
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "get_execution_results",
                                                                                    "start_token": 5061,
                                                                                    "end_token": 5065,
                                                                                    "children": []
                                                                                }
                                                                            ]
                                                                        },
                                                                        {
                                                                            "type": "argument_list",
                                                                            "label": "(graph_exec_id)",
                                                                            "start_token": 5065,
                                                                            "end_token": 5067,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "graph_exec_id",
                                                                                    "start_token": 5065,
                                                                                    "end_token": 5067,
                                                                                    "children": []
                                                                                }
                                                                            ]
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                },
                                                {
                                                    "type": "for_statement",
                                                    "label": "for node_exec in node_execs:\n            if node_exec.status not in (\n                ExecutionStatus.COMPLETED,\n                ExecutionStatus.FAILED,\n            ):\n                self.db_client.upsert_execution_output(\n                    node_exec.node_exec_id, \"error\", \"TERMINATED\"\n                )\n                exec_update = self.db_client.update_execution_status(\n                    node_exec.node_exec_id, ExecutionStatus.FAILED\n                )\n                self.db_client.send_execution_update(exec_update)",
                                                    "start_token": -1,
                                                    "end_token": 5138,
                                                    "children": [
                                                        {
                                                            "type": "identifier",
                                                            "label": "node_exec",
                                                            "start_token": -1,
                                                            "end_token": 5070,
                                                            "children": []
                                                        },
                                                        {
                                                            "type": "identifier",
                                                            "label": "node_execs",
                                                            "start_token": 5071,
                                                            "end_token": 5073,
                                                            "children": []
                                                        },
                                                        {
                                                            "type": "block",
                                                            "label": "if node_exec.status not in (\n                ExecutionStatus.COMPLETED,\n                ExecutionStatus.FAILED,\n            ):\n                self.db_client.upsert_execution_output(\n                    node_exec.node_exec_id, \"error\", \"TERMINATED\"\n                )\n                exec_update = self.db_client.update_execution_status(\n                    node_exec.node_exec_id, ExecutionStatus.FAILED\n                )\n                self.db_client.send_execution_update(exec_update)",
                                                            "start_token": -1,
                                                            "end_token": 5138,
                                                            "children": [
                                                                {
                                                                    "type": "if_statement",
                                                                    "label": "if node_exec.status not in (\n                ExecutionStatus.COMPLETED,\n                ExecutionStatus.FAILED,\n            ):\n                self.db_client.upsert_execution_output(\n                    node_exec.node_exec_id, \"error\", \"TERMINATED\"\n                )\n                exec_update = self.db_client.update_execution_status(\n                    node_exec.node_exec_id, ExecutionStatus.FAILED\n                )\n                self.db_client.send_execution_update(exec_update)",
                                                                    "start_token": -1,
                                                                    "end_token": 5138,
                                                                    "children": [
                                                                        {
                                                                            "type": "comparison_operator",
                                                                            "label": "node_exec.status not in (\n                ExecutionStatus.COMPLETED,\n                ExecutionStatus.FAILED,\n            )",
                                                                            "start_token": -1,
                                                                            "end_token": 5093,
                                                                            "children": [
                                                                                {
                                                                                    "type": "attribute",
                                                                                    "label": "node_exec.status",
                                                                                    "start_token": -1,
                                                                                    "end_token": 5078,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "label": "node_exec",
                                                                                            "start_token": -1,
                                                                                            "end_token": -1,
                                                                                            "children": []
                                                                                        },
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "label": "status",
                                                                                            "start_token": -1,
                                                                                            "end_token": 5078,
                                                                                            "children": []
                                                                                        }
                                                                                    ]
                                                                                },
                                                                                {
                                                                                    "type": "tuple",
                                                                                    "label": "(\n                ExecutionStatus.COMPLETED,\n                ExecutionStatus.FAILED,\n            )",
                                                                                    "start_token": 5078,
                                                                                    "end_token": 5093,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "attribute",
                                                                                            "label": "ExecutionStatus.COMPLETED",
                                                                                            "start_token": -1,
                                                                                            "end_token": 5083,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "label": "ExecutionStatus",
                                                                                                    "start_token": -1,
                                                                                                    "end_token": 5083,
                                                                                                    "children": []
                                                                                                },
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "label": "COMPLETED",
                                                                                                    "start_token": 5083,
                                                                                                    "end_token": 5083,
                                                                                                    "children": []
                                                                                                }
                                                                                            ]
                                                                                        },
                                                                                        {
                                                                                            "type": "attribute",
                                                                                            "label": "ExecutionStatus.FAILED",
                                                                                            "start_token": -1,
                                                                                            "end_token": -1,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "label": "ExecutionStatus",
                                                                                                    "start_token": -1,
                                                                                                    "end_token": -1,
                                                                                                    "children": []
                                                                                                },
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "label": "FAILED",
                                                                                                    "start_token": -1,
                                                                                                    "end_token": -1,
                                                                                                    "children": []
                                                                                                }
                                                                                            ]
                                                                                        }
                                                                                    ]
                                                                                }
                                                                            ]
                                                                        },
                                                                        {
                                                                            "type": "block",
                                                                            "label": "self.db_client.upsert_execution_output(\n                    node_exec.node_exec_id, \"error\", \"TERMINATED\"\n                )\n                exec_update = self.db_client.update_execution_status(\n                    node_exec.node_exec_id, ExecutionStatus.FAILED\n                )\n                self.db_client.send_execution_update(exec_update)",
                                                                            "start_token": 5095,
                                                                            "end_token": 5138,
                                                                            "children": [
                                                                                {
                                                                                    "type": "expression_statement",
                                                                                    "label": "self.db_client.upsert_execution_output(\n                    node_exec.node_exec_id, \"error\", \"TERMINATED\"\n                )",
                                                                                    "start_token": 5095,
                                                                                    "end_token": 5109,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "call",
                                                                                            "label": "self.db_client.upsert_execution_output(\n                    node_exec.node_exec_id, \"error\", \"TERMINATED\"\n                )",
                                                                                            "start_token": 5095,
                                                                                            "end_token": 5109,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "attribute",
                                                                                                    "label": "self.db_client.upsert_execution_output",
                                                                                                    "start_token": 5095,
                                                                                                    "end_token": 5098,
                                                                                                    "children": [
                                                                                                        {
                                                                                                            "type": "attribute",
                                                                                                            "label": "self.db_client",
                                                                                                            "start_token": 5095,
                                                                                                            "end_token": -1,
                                                                                                            "children": [
                                                                                                                {
                                                                                                                    "type": "identifier",
                                                                                                                    "label": "self",
                                                                                                                    "start_token": 5095,
                                                                                                                    "end_token": 5095,
                                                                                                                    "children": []
                                                                                                                },
                                                                                                                {
                                                                                                                    "type": "identifier",
                                                                                                                    "label": "db_client",
                                                                                                                    "start_token": 5095,
                                                                                                                    "end_token": -1,
                                                                                                                    "children": []
                                                                                                                }
                                                                                                            ]
                                                                                                        },
                                                                                                        {
                                                                                                            "type": "identifier",
                                                                                                            "label": "upsert_execution_output",
                                                                                                            "start_token": -1,
                                                                                                            "end_token": 5098,
                                                                                                            "children": []
                                                                                                        }
                                                                                                    ]
                                                                                                },
                                                                                                {
                                                                                                    "type": "argument_list",
                                                                                                    "label": "(\n                    node_exec.node_exec_id, \"error\", \"TERMINATED\"\n                )",
                                                                                                    "start_token": 5098,
                                                                                                    "end_token": 5109,
                                                                                                    "children": [
                                                                                                        {
                                                                                                            "type": "attribute",
                                                                                                            "label": "node_exec.node_exec_id",
                                                                                                            "start_token": 5102,
                                                                                                            "end_token": -1,
                                                                                                            "children": [
                                                                                                                {
                                                                                                                    "type": "identifier",
                                                                                                                    "label": "node_exec",
                                                                                                                    "start_token": 5102,
                                                                                                                    "end_token": 5104,
                                                                                                                    "children": []
                                                                                                                },
                                                                                                                {
                                                                                                                    "type": "identifier",
                                                                                                                    "label": "node_exec_id",
                                                                                                                    "start_token": 5104,
                                                                                                                    "end_token": -1,
                                                                                                                    "children": []
                                                                                                                }
                                                                                                            ]
                                                                                                        },
                                                                                                        {
                                                                                                            "type": "string",
                                                                                                            "label": "\"error\"",
                                                                                                            "start_token": -1,
                                                                                                            "end_token": -1,
                                                                                                            "children": [
                                                                                                                {
                                                                                                                    "type": "string_start",
                                                                                                                    "label": "\"",
                                                                                                                    "start_token": -1,
                                                                                                                    "end_token": -1,
                                                                                                                    "children": []
                                                                                                                },
                                                                                                                {
                                                                                                                    "type": "string_content",
                                                                                                                    "label": "error",
                                                                                                                    "start_token": -1,
                                                                                                                    "end_token": -1,
                                                                                                                    "children": []
                                                                                                                },
                                                                                                                {
                                                                                                                    "type": "string_end",
                                                                                                                    "label": "\"",
                                                                                                                    "start_token": -1,
                                                                                                                    "end_token": -1,
                                                                                                                    "children": []
                                                                                                                }
                                                                                                            ]
                                                                                                        },
                                                                                                        {
                                                                                                            "type": "string",
                                                                                                            "label": "\"TERMINATED\"",
                                                                                                            "start_token": 5107,
                                                                                                            "end_token": -1,
                                                                                                            "children": [
                                                                                                                {
                                                                                                                    "type": "string_start",
                                                                                                                    "label": "\"",
                                                                                                                    "start_token": 5107,
                                                                                                                    "end_token": 5107,
                                                                                                                    "children": []
                                                                                                                },
                                                                                                                {
                                                                                                                    "type": "string_content",
                                                                                                                    "label": "TERMINATED",
                                                                                                                    "start_token": -1,
                                                                                                                    "end_token": -1,
                                                                                                                    "children": []
                                                                                                                },
                                                                                                                {
                                                                                                                    "type": "string_end",
                                                                                                                    "label": "\"",
                                                                                                                    "start_token": -1,
                                                                                                                    "end_token": -1,
                                                                                                                    "children": []
                                                                                                                }
                                                                                                            ]
                                                                                                        }
                                                                                                    ]
                                                                                                }
                                                                                            ]
                                                                                        }
                                                                                    ]
                                                                                },
                                                                                {
                                                                                    "type": "expression_statement",
                                                                                    "label": "exec_update = self.db_client.update_execution_status(\n                    node_exec.node_exec_id, ExecutionStatus.FAILED\n                )",
                                                                                    "start_token": 5114,
                                                                                    "end_token": 5129,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "assignment",
                                                                                            "label": "exec_update = self.db_client.update_execution_status(\n                    node_exec.node_exec_id, ExecutionStatus.FAILED\n                )",
                                                                                            "start_token": 5114,
                                                                                            "end_token": 5129,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "label": "exec_update",
                                                                                                    "start_token": 5114,
                                                                                                    "end_token": 5114,
                                                                                                    "children": []
                                                                                                },
                                                                                                {
                                                                                                    "type": "call",
                                                                                                    "label": "self.db_client.update_execution_status(\n                    node_exec.node_exec_id, ExecutionStatus.FAILED\n                )",
                                                                                                    "start_token": 5114,
                                                                                                    "end_token": 5129,
                                                                                                    "children": [
                                                                                                        {
                                                                                                            "type": "attribute",
                                                                                                            "label": "self.db_client.update_execution_status",
                                                                                                            "start_token": 5114,
                                                                                                            "end_token": 5117,
                                                                                                            "children": [
                                                                                                                {
                                                                                                                    "type": "attribute",
                                                                                                                    "label": "self.db_client",
                                                                                                                    "start_token": 5114,
                                                                                                                    "end_token": -1,
                                                                                                                    "children": [
                                                                                                                        {
                                                                                                                            "type": "identifier",
                                                                                                                            "label": "self",
                                                                                                                            "start_token": 5114,
                                                                                                                            "end_token": 5114,
                                                                                                                            "children": []
                                                                                                                        },
                                                                                                                        {
                                                                                                                            "type": "identifier",
                                                                                                                            "label": "db_client",
                                                                                                                            "start_token": 5114,
                                                                                                                            "end_token": -1,
                                                                                                                            "children": []
                                                                                                                        }
                                                                                                                    ]
                                                                                                                },
                                                                                                                {
                                                                                                                    "type": "identifier",
                                                                                                                    "label": "update_execution_status",
                                                                                                                    "start_token": -1,
                                                                                                                    "end_token": 5117,
                                                                                                                    "children": []
                                                                                                                }
                                                                                                            ]
                                                                                                        },
                                                                                                        {
                                                                                                            "type": "argument_list",
                                                                                                            "label": "(\n                    node_exec.node_exec_id, ExecutionStatus.FAILED\n                )",
                                                                                                            "start_token": 5117,
                                                                                                            "end_token": 5129,
                                                                                                            "children": [
                                                                                                                {
                                                                                                                    "type": "attribute",
                                                                                                                    "label": "node_exec.node_exec_id",
                                                                                                                    "start_token": 5121,
                                                                                                                    "end_token": -1,
                                                                                                                    "children": [
                                                                                                                        {
                                                                                                                            "type": "identifier",
                                                                                                                            "label": "node_exec",
                                                                                                                            "start_token": 5121,
                                                                                                                            "end_token": 5121,
                                                                                                                            "children": []
                                                                                                                        },
                                                                                                                        {
                                                                                                                            "type": "identifier",
                                                                                                                            "label": "node_exec_id",
                                                                                                                            "start_token": 5123,
                                                                                                                            "end_token": -1,
                                                                                                                            "children": []
                                                                                                                        }
                                                                                                                    ]
                                                                                                                },
                                                                                                                {
                                                                                                                    "type": "attribute",
                                                                                                                    "label": "ExecutionStatus.FAILED",
                                                                                                                    "start_token": -1,
                                                                                                                    "end_token": -1,
                                                                                                                    "children": [
                                                                                                                        {
                                                                                                                            "type": "identifier",
                                                                                                                            "label": "ExecutionStatus",
                                                                                                                            "start_token": -1,
                                                                                                                            "end_token": -1,
                                                                                                                            "children": []
                                                                                                                        },
                                                                                                                        {
                                                                                                                            "type": "identifier",
                                                                                                                            "label": "FAILED",
                                                                                                                            "start_token": -1,
                                                                                                                            "end_token": -1,
                                                                                                                            "children": []
                                                                                                                        }
                                                                                                                    ]
                                                                                                                }
                                                                                                            ]
                                                                                                        }
                                                                                                    ]
                                                                                                }
                                                                                            ]
                                                                                        }
                                                                                    ]
                                                                                },
                                                                                {
                                                                                    "type": "expression_statement",
                                                                                    "label": "self.db_client.send_execution_update(exec_update)",
                                                                                    "start_token": 5131,
                                                                                    "end_token": 5138,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "call",
                                                                                            "label": "self.db_client.send_execution_update(exec_update)",
                                                                                            "start_token": 5131,
                                                                                            "end_token": 5138,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "attribute",
                                                                                                    "label": "self.db_client.send_execution_update",
                                                                                                    "start_token": 5131,
                                                                                                    "end_token": 5138,
                                                                                                    "children": [
                                                                                                        {
                                                                                                            "type": "attribute",
                                                                                                            "label": "self.db_client",
                                                                                                            "start_token": 5131,
                                                                                                            "end_token": 5133,
                                                                                                            "children": [
                                                                                                                {
                                                                                                                    "type": "identifier",
                                                                                                                    "label": "self",
                                                                                                                    "start_token": 5131,
                                                                                                                    "end_token": 5131,
                                                                                                                    "children": []
                                                                                                                },
                                                                                                                {
                                                                                                                    "type": "identifier",
                                                                                                                    "label": "db_client",
                                                                                                                    "start_token": 5131,
                                                                                                                    "end_token": 5133,
                                                                                                                    "children": []
                                                                                                                }
                                                                                                            ]
                                                                                                        },
                                                                                                        {
                                                                                                            "type": "identifier",
                                                                                                            "label": "send_execution_update",
                                                                                                            "start_token": 5133,
                                                                                                            "end_token": 5138,
                                                                                                            "children": []
                                                                                                        }
                                                                                                    ]
                                                                                                },
                                                                                                {
                                                                                                    "type": "argument_list",
                                                                                                    "label": "(exec_update)",
                                                                                                    "start_token": 5138,
                                                                                                    "end_token": 5138,
                                                                                                    "children": [
                                                                                                        {
                                                                                                            "type": "identifier",
                                                                                                            "label": "exec_update",
                                                                                                            "start_token": 5138,
                                                                                                            "end_token": 5138,
                                                                                                            "children": []
                                                                                                        }
                                                                                                    ]
                                                                                                }
                                                                                            ]
                                                                                        }
                                                                                    ]
                                                                                }
                                                                            ]
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                }
                                            ]
                                        }
                                    ]
                                }
                            ]
                        },
                        {
                            "type": "function_definition",
                            "label": "def _validate_node_input_credentials(self, graph: GraphModel, user_id: str):\n        \"\"\"Checks all credentials for all nodes of the graph\"\"\"\n\n        for node in graph.nodes:\n            block = get_block(node.block_id)\n            if not block:\n                raise ValueError(f\"Unknown block {node.block_id} for node #{node.id}\")\n\n            # Find any fields of type CredentialsMetaInput\n            model_fields = cast(type[BaseModel], block.input_schema).model_fields\n            if CREDENTIALS_FIELD_NAME not in model_fields:\n                continue\n\n            field = model_fields[CREDENTIALS_FIELD_NAME]\n\n            # The BlockSchema class enforces that a `credentials` field is always a\n            # `CredentialsMetaInput`, so we can safely assume this here.\n            credentials_meta_type = cast(CredentialsMetaInput, field.annotation)\n            credentials_meta = credentials_meta_type.model_validate(\n                node.input_default[CREDENTIALS_FIELD_NAME]\n            )\n            # Fetch the corresponding Credentials and perform sanity checks\n            credentials = self.credentials_store.get_creds_by_id(\n                user_id, credentials_meta.id\n            )\n            if not credentials:\n                raise ValueError(\n                    f\"Unknown credentials #{credentials_meta.id} \"\n                    f\"for node #{node.id}\"\n                )\n            if (\n                credentials.provider != credentials_meta.provider\n                or credentials.type != credentials_meta.type\n            ):\n                logger.warning(\n                    f\"Invalid credentials #{credentials.id} for node #{node.id}: \"\n                    \"type/provider mismatch: \"\n                    f\"{credentials_meta.type}<>{credentials.type};\"\n                    f\"{credentials_meta.provider}<>{credentials.provider}\"\n                )\n                raise ValueError(\n                    f\"Invalid credentials #{credentials.id} for node #{node.id}: \"\n                    \"type/provider mismatch\"\n                )",
                            "start_token": 5138,
                            "end_token": 5400,
                            "children": [
                                {
                                    "type": "identifier",
                                    "label": "_validate_node_input_credentials",
                                    "start_token": 5138,
                                    "end_token": 5146,
                                    "children": []
                                },
                                {
                                    "type": "parameters",
                                    "label": "(self, graph: GraphModel, user_id: str)",
                                    "start_token": 5146,
                                    "end_token": 5153,
                                    "children": [
                                        {
                                            "type": "identifier",
                                            "label": "self",
                                            "start_token": 5146,
                                            "end_token": -1,
                                            "children": []
                                        },
                                        {
                                            "type": "typed_parameter",
                                            "label": "graph: GraphModel",
                                            "start_token": 5148,
                                            "end_token": 5153,
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "label": "graph",
                                                    "start_token": 5148,
                                                    "end_token": -1,
                                                    "children": []
                                                },
                                                {
                                                    "type": "type",
                                                    "label": "GraphModel",
                                                    "start_token": -1,
                                                    "end_token": 5153,
                                                    "children": [
                                                        {
                                                            "type": "identifier",
                                                            "label": "GraphModel",
                                                            "start_token": -1,
                                                            "end_token": 5153,
                                                            "children": []
                                                        }
                                                    ]
                                                }
                                            ]
                                        },
                                        {
                                            "type": "typed_parameter",
                                            "label": "user_id: str",
                                            "start_token": 5153,
                                            "end_token": 5153,
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "label": "user_id",
                                                    "start_token": 5153,
                                                    "end_token": 5153,
                                                    "children": []
                                                },
                                                {
                                                    "type": "type",
                                                    "label": "str",
                                                    "start_token": 5153,
                                                    "end_token": 5153,
                                                    "children": [
                                                        {
                                                            "type": "identifier",
                                                            "label": "str",
                                                            "start_token": 5153,
                                                            "end_token": 5153,
                                                            "children": []
                                                        }
                                                    ]
                                                }
                                            ]
                                        }
                                    ]
                                },
                                {
                                    "type": "block",
                                    "label": "\"\"\"Checks all credentials for all nodes of the graph\"\"\"\n\n        for node in graph.nodes:\n            block = get_block(node.block_id)\n            if not block:\n                raise ValueError(f\"Unknown block {node.block_id} for node #{node.id}\")\n\n            # Find any fields of type CredentialsMetaInput\n            model_fields = cast(type[BaseModel], block.input_schema).model_fields\n            if CREDENTIALS_FIELD_NAME not in model_fields:\n                continue\n\n            field = model_fields[CREDENTIALS_FIELD_NAME]\n\n            # The BlockSchema class enforces that a `credentials` field is always a\n            # `CredentialsMetaInput`, so we can safely assume this here.\n            credentials_meta_type = cast(CredentialsMetaInput, field.annotation)\n            credentials_meta = credentials_meta_type.model_validate(\n                node.input_default[CREDENTIALS_FIELD_NAME]\n            )\n            # Fetch the corresponding Credentials and perform sanity checks\n            credentials = self.credentials_store.get_creds_by_id(\n                user_id, credentials_meta.id\n            )\n            if not credentials:\n                raise ValueError(\n                    f\"Unknown credentials #{credentials_meta.id} \"\n                    f\"for node #{node.id}\"\n                )\n            if (\n                credentials.provider != credentials_meta.provider\n                or credentials.type != credentials_meta.type\n            ):\n                logger.warning(\n                    f\"Invalid credentials #{credentials.id} for node #{node.id}: \"\n                    \"type/provider mismatch: \"\n                    f\"{credentials_meta.type}<>{credentials.type};\"\n                    f\"{credentials_meta.provider}<>{credentials.provider}\"\n                )\n                raise ValueError(\n                    f\"Invalid credentials #{credentials.id} for node #{node.id}: \"\n                    \"type/provider mismatch\"\n                )",
                                    "start_token": 5153,
                                    "end_token": 5400,
                                    "children": [
                                        {
                                            "type": "expression_statement",
                                            "label": "\"\"\"Checks all credentials for all nodes of the graph\"\"\"",
                                            "start_token": 5153,
                                            "end_token": 5162,
                                            "children": [
                                                {
                                                    "type": "string",
                                                    "label": "\"\"\"Checks all credentials for all nodes of the graph\"\"\"",
                                                    "start_token": 5153,
                                                    "end_token": 5162,
                                                    "children": [
                                                        {
                                                            "type": "string_start",
                                                            "label": "\"\"\"",
                                                            "start_token": 5153,
                                                            "end_token": 5153,
                                                            "children": []
                                                        },
                                                        {
                                                            "type": "string_content",
                                                            "label": "Checks all credentials for all nodes of the graph",
                                                            "start_token": 5153,
                                                            "end_token": 5160,
                                                            "children": []
                                                        },
                                                        {
                                                            "type": "string_end",
                                                            "label": "\"\"\"",
                                                            "start_token": 5161,
                                                            "end_token": 5162,
                                                            "children": []
                                                        }
                                                    ]
                                                }
                                            ]
                                        },
                                        {
                                            "type": "for_statement",
                                            "label": "for node in graph.nodes:\n            block = get_block(node.block_id)\n            if not block:\n                raise ValueError(f\"Unknown block {node.block_id} for node #{node.id}\")\n\n            # Find any fields of type CredentialsMetaInput\n            model_fields = cast(type[BaseModel], block.input_schema).model_fields\n            if CREDENTIALS_FIELD_NAME not in model_fields:\n                continue\n\n            field = model_fields[CREDENTIALS_FIELD_NAME]\n\n            # The BlockSchema class enforces that a `credentials` field is always a\n            # `CredentialsMetaInput`, so we can safely assume this here.\n            credentials_meta_type = cast(CredentialsMetaInput, field.annotation)\n            credentials_meta = credentials_meta_type.model_validate(\n                node.input_default[CREDENTIALS_FIELD_NAME]\n            )\n            # Fetch the corresponding Credentials and perform sanity checks\n            credentials = self.credentials_store.get_creds_by_id(\n                user_id, credentials_meta.id\n            )\n            if not credentials:\n                raise ValueError(\n                    f\"Unknown credentials #{credentials_meta.id} \"\n                    f\"for node #{node.id}\"\n                )\n            if (\n                credentials.provider != credentials_meta.provider\n                or credentials.type != credentials_meta.type\n            ):\n                logger.warning(\n                    f\"Invalid credentials #{credentials.id} for node #{node.id}: \"\n                    \"type/provider mismatch: \"\n                    f\"{credentials_meta.type}<>{credentials.type};\"\n                    f\"{credentials_meta.provider}<>{credentials.provider}\"\n                )\n                raise ValueError(\n                    f\"Invalid credentials #{credentials.id} for node #{node.id}: \"\n                    \"type/provider mismatch\"\n                )",
                                            "start_token": -1,
                                            "end_token": 5400,
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "label": "node",
                                                    "start_token": -1,
                                                    "end_token": 5165,
                                                    "children": []
                                                },
                                                {
                                                    "type": "attribute",
                                                    "label": "graph.nodes",
                                                    "start_token": -1,
                                                    "end_token": 5167,
                                                    "children": [
                                                        {
                                                            "type": "identifier",
                                                            "label": "graph",
                                                            "start_token": -1,
                                                            "end_token": 5167,
                                                            "children": []
                                                        },
                                                        {
                                                            "type": "identifier",
                                                            "label": "nodes",
                                                            "start_token": 5167,
                                                            "end_token": 5167,
                                                            "children": []
                                                        }
                                                    ]
                                                },
                                                {
                                                    "type": "block",
                                                    "label": "block = get_block(node.block_id)\n            if not block:\n                raise ValueError(f\"Unknown block {node.block_id} for node #{node.id}\")\n\n            # Find any fields of type CredentialsMetaInput\n            model_fields = cast(type[BaseModel], block.input_schema).model_fields\n            if CREDENTIALS_FIELD_NAME not in model_fields:\n                continue\n\n            field = model_fields[CREDENTIALS_FIELD_NAME]\n\n            # The BlockSchema class enforces that a `credentials` field is always a\n            # `CredentialsMetaInput`, so we can safely assume this here.\n            credentials_meta_type = cast(CredentialsMetaInput, field.annotation)\n            credentials_meta = credentials_meta_type.model_validate(\n                node.input_default[CREDENTIALS_FIELD_NAME]\n            )\n            # Fetch the corresponding Credentials and perform sanity checks\n            credentials = self.credentials_store.get_creds_by_id(\n                user_id, credentials_meta.id\n            )\n            if not credentials:\n                raise ValueError(\n                    f\"Unknown credentials #{credentials_meta.id} \"\n                    f\"for node #{node.id}\"\n                )\n            if (\n                credentials.provider != credentials_meta.provider\n                or credentials.type != credentials_meta.type\n            ):\n                logger.warning(\n                    f\"Invalid credentials #{credentials.id} for node #{node.id}: \"\n                    \"type/provider mismatch: \"\n                    f\"{credentials_meta.type}<>{credentials.type};\"\n                    f\"{credentials_meta.provider}<>{credentials.provider}\"\n                )\n                raise ValueError(\n                    f\"Invalid credentials #{credentials.id} for node #{node.id}: \"\n                    \"type/provider mismatch\"\n                )",
                                                    "start_token": 5171,
                                                    "end_token": 5400,
                                                    "children": [
                                                        {
                                                            "type": "expression_statement",
                                                            "label": "block = get_block(node.block_id)",
                                                            "start_token": 5171,
                                                            "end_token": -1,
                                                            "children": [
                                                                {
                                                                    "type": "assignment",
                                                                    "label": "block = get_block(node.block_id)",
                                                                    "start_token": 5171,
                                                                    "end_token": -1,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "block",
                                                                            "start_token": 5171,
                                                                            "end_token": -1,
                                                                            "children": []
                                                                        },
                                                                        {
                                                                            "type": "call",
                                                                            "label": "get_block(node.block_id)",
                                                                            "start_token": -1,
                                                                            "end_token": -1,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "get_block",
                                                                                    "start_token": -1,
                                                                                    "end_token": 5174,
                                                                                    "children": []
                                                                                },
                                                                                {
                                                                                    "type": "argument_list",
                                                                                    "label": "(node.block_id)",
                                                                                    "start_token": -1,
                                                                                    "end_token": -1,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "attribute",
                                                                                            "label": "node.block_id",
                                                                                            "start_token": 5175,
                                                                                            "end_token": -1,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "label": "node",
                                                                                                    "start_token": 5175,
                                                                                                    "end_token": -1,
                                                                                                    "children": []
                                                                                                },
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "label": "block_id",
                                                                                                    "start_token": 5176,
                                                                                                    "end_token": -1,
                                                                                                    "children": []
                                                                                                }
                                                                                            ]
                                                                                        }
                                                                                    ]
                                                                                }
                                                                            ]
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        },
                                                        {
                                                            "type": "if_statement",
                                                            "label": "if not block:\n                raise ValueError(f\"Unknown block {node.block_id} for node #{node.id}\")",
                                                            "start_token": 5179,
                                                            "end_token": 5190,
                                                            "children": [
                                                                {
                                                                    "type": "not_operator",
                                                                    "label": "not block",
                                                                    "start_token": 5179,
                                                                    "end_token": 5180,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "block",
                                                                            "start_token": 5180,
                                                                            "end_token": 5180,
                                                                            "children": []
                                                                        }
                                                                    ]
                                                                },
                                                                {
                                                                    "type": "block",
                                                                    "label": "raise ValueError(f\"Unknown block {node.block_id} for node #{node.id}\")",
                                                                    "start_token": 5183,
                                                                    "end_token": 5190,
                                                                    "children": [
                                                                        {
                                                                            "type": "raise_statement",
                                                                            "label": "raise ValueError(f\"Unknown block {node.block_id} for node #{node.id}\")",
                                                                            "start_token": 5183,
                                                                            "end_token": 5190,
                                                                            "children": [
                                                                                {
                                                                                    "type": "call",
                                                                                    "label": "ValueError(f\"Unknown block {node.block_id} for node #{node.id}\")",
                                                                                    "start_token": 5183,
                                                                                    "end_token": 5190,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "label": "ValueError",
                                                                                            "start_token": 5183,
                                                                                            "end_token": 5183,
                                                                                            "children": []
                                                                                        },
                                                                                        {
                                                                                            "type": "argument_list",
                                                                                            "label": "(f\"Unknown block {node.block_id} for node #{node.id}\")",
                                                                                            "start_token": 5183,
                                                                                            "end_token": 5190,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "string",
                                                                                                    "label": "f\"Unknown block {node.block_id} for node #{node.id}\"",
                                                                                                    "start_token": 5183,
                                                                                                    "end_token": 5190,
                                                                                                    "children": [
                                                                                                        {
                                                                                                            "type": "string_start",
                                                                                                            "label": "f\"",
                                                                                                            "start_token": 5183,
                                                                                                            "end_token": 5183,
                                                                                                            "children": []
                                                                                                        },
                                                                                                        {
                                                                                                            "type": "string_content",
                                                                                                            "label": "Unknown block ",
                                                                                                            "start_token": 5183,
                                                                                                            "end_token": 5183,
                                                                                                            "children": []
                                                                                                        },
                                                                                                        {
                                                                                                            "type": "interpolation",
                                                                                                            "label": "{node.block_id}",
                                                                                                            "start_token": 5183,
                                                                                                            "end_token": -1,
                                                                                                            "children": [
                                                                                                                {
                                                                                                                    "type": "attribute",
                                                                                                                    "label": "node.block_id",
                                                                                                                    "start_token": 5183,
                                                                                                                    "end_token": -1,
                                                                                                                    "children": [
                                                                                                                        {
                                                                                                                            "type": "identifier",
                                                                                                                            "label": "node",
                                                                                                                            "start_token": 5183,
                                                                                                                            "end_token": 5183,
                                                                                                                            "children": []
                                                                                                                        },
                                                                                                                        {
                                                                                                                            "type": "identifier",
                                                                                                                            "label": "block_id",
                                                                                                                            "start_token": 5184,
                                                                                                                            "end_token": -1,
                                                                                                                            "children": []
                                                                                                                        }
                                                                                                                    ]
                                                                                                                }
                                                                                                            ]
                                                                                                        },
                                                                                                        {
                                                                                                            "type": "string_content",
                                                                                                            "label": " for node #",
                                                                                                            "start_token": -1,
                                                                                                            "end_token": 5188,
                                                                                                            "children": []
                                                                                                        },
                                                                                                        {
                                                                                                            "type": "interpolation",
                                                                                                            "label": "{node.id}",
                                                                                                            "start_token": 5188,
                                                                                                            "end_token": 5190,
                                                                                                            "children": [
                                                                                                                {
                                                                                                                    "type": "attribute",
                                                                                                                    "label": "node.id",
                                                                                                                    "start_token": -1,
                                                                                                                    "end_token": 5190,
                                                                                                                    "children": [
                                                                                                                        {
                                                                                                                            "type": "identifier",
                                                                                                                            "label": "node",
                                                                                                                            "start_token": -1,
                                                                                                                            "end_token": 5189,
                                                                                                                            "children": []
                                                                                                                        },
                                                                                                                        {
                                                                                                                            "type": "identifier",
                                                                                                                            "label": "id",
                                                                                                                            "start_token": 5190,
                                                                                                                            "end_token": 5190,
                                                                                                                            "children": []
                                                                                                                        }
                                                                                                                    ]
                                                                                                                }
                                                                                                            ]
                                                                                                        },
                                                                                                        {
                                                                                                            "type": "string_end",
                                                                                                            "label": "\"",
                                                                                                            "start_token": 5190,
                                                                                                            "end_token": 5190,
                                                                                                            "children": []
                                                                                                        }
                                                                                                    ]
                                                                                                }
                                                                                            ]
                                                                                        }
                                                                                    ]
                                                                                }
                                                                            ]
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        },
                                                        {
                                                            "type": "comment",
                                                            "label": "# Find any fields of type CredentialsMetaInput",
                                                            "start_token": 5193,
                                                            "end_token": 5197,
                                                            "children": []
                                                        },
                                                        {
                                                            "type": "expression_statement",
                                                            "label": "model_fields = cast(type[BaseModel], block.input_schema).model_fields",
                                                            "start_token": 5201,
                                                            "end_token": 5212,
                                                            "children": [
                                                                {
                                                                    "type": "assignment",
                                                                    "label": "model_fields = cast(type[BaseModel], block.input_schema).model_fields",
                                                                    "start_token": 5201,
                                                                    "end_token": 5212,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "model_fields",
                                                                            "start_token": 5201,
                                                                            "end_token": 5204,
                                                                            "children": []
                                                                        },
                                                                        {
                                                                            "type": "attribute",
                                                                            "label": "cast(type[BaseModel], block.input_schema).model_fields",
                                                                            "start_token": 5206,
                                                                            "end_token": 5212,
                                                                            "children": [
                                                                                {
                                                                                    "type": "call",
                                                                                    "label": "cast(type[BaseModel], block.input_schema)",
                                                                                    "start_token": 5206,
                                                                                    "end_token": 5212,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "label": "cast",
                                                                                            "start_token": 5206,
                                                                                            "end_token": 5206,
                                                                                            "children": []
                                                                                        },
                                                                                        {
                                                                                            "type": "argument_list",
                                                                                            "label": "(type[BaseModel], block.input_schema)",
                                                                                            "start_token": 5206,
                                                                                            "end_token": 5212,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "subscript",
                                                                                                    "label": "type[BaseModel]",
                                                                                                    "start_token": 5206,
                                                                                                    "end_token": 5209,
                                                                                                    "children": [
                                                                                                        {
                                                                                                            "type": "identifier",
                                                                                                            "label": "type",
                                                                                                            "start_token": 5206,
                                                                                                            "end_token": 5206,
                                                                                                            "children": []
                                                                                                        },
                                                                                                        {
                                                                                                            "type": "identifier",
                                                                                                            "label": "BaseModel",
                                                                                                            "start_token": 5207,
                                                                                                            "end_token": 5209,
                                                                                                            "children": []
                                                                                                        }
                                                                                                    ]
                                                                                                },
                                                                                                {
                                                                                                    "type": "attribute",
                                                                                                    "label": "block.input_schema",
                                                                                                    "start_token": 5209,
                                                                                                    "end_token": -1,
                                                                                                    "children": [
                                                                                                        {
                                                                                                            "type": "identifier",
                                                                                                            "label": "block",
                                                                                                            "start_token": 5209,
                                                                                                            "end_token": -1,
                                                                                                            "children": []
                                                                                                        },
                                                                                                        {
                                                                                                            "type": "identifier",
                                                                                                            "label": "input_schema",
                                                                                                            "start_token": -1,
                                                                                                            "end_token": -1,
                                                                                                            "children": []
                                                                                                        }
                                                                                                    ]
                                                                                                }
                                                                                            ]
                                                                                        }
                                                                                    ]
                                                                                },
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "model_fields",
                                                                                    "start_token": 5212,
                                                                                    "end_token": 5212,
                                                                                    "children": []
                                                                                }
                                                                            ]
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        },
                                                        {
                                                            "type": "if_statement",
                                                            "label": "if CREDENTIALS_FIELD_NAME not in model_fields:\n                continue",
                                                            "start_token": 5214,
                                                            "end_token": 5223,
                                                            "children": [
                                                                {
                                                                    "type": "comparison_operator",
                                                                    "label": "CREDENTIALS_FIELD_NAME not in model_fields",
                                                                    "start_token": 5215,
                                                                    "end_token": -1,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "CREDENTIALS_FIELD_NAME",
                                                                            "start_token": 5215,
                                                                            "end_token": -1,
                                                                            "children": []
                                                                        },
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "model_fields",
                                                                            "start_token": 5218,
                                                                            "end_token": -1,
                                                                            "children": []
                                                                        }
                                                                    ]
                                                                },
                                                                {
                                                                    "type": "block",
                                                                    "label": "continue",
                                                                    "start_token": 5223,
                                                                    "end_token": 5223,
                                                                    "children": [
                                                                        {
                                                                            "type": "continue_statement",
                                                                            "label": "continue",
                                                                            "start_token": 5223,
                                                                            "end_token": 5223,
                                                                            "children": []
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        },
                                                        {
                                                            "type": "expression_statement",
                                                            "label": "field = model_fields[CREDENTIALS_FIELD_NAME]",
                                                            "start_token": 5225,
                                                            "end_token": 5231,
                                                            "children": [
                                                                {
                                                                    "type": "assignment",
                                                                    "label": "field = model_fields[CREDENTIALS_FIELD_NAME]",
                                                                    "start_token": 5225,
                                                                    "end_token": 5231,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "field",
                                                                            "start_token": 5225,
                                                                            "end_token": 5225,
                                                                            "children": []
                                                                        },
                                                                        {
                                                                            "type": "subscript",
                                                                            "label": "model_fields[CREDENTIALS_FIELD_NAME]",
                                                                            "start_token": 5225,
                                                                            "end_token": 5231,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "model_fields",
                                                                                    "start_token": 5225,
                                                                                    "end_token": -1,
                                                                                    "children": []
                                                                                },
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "CREDENTIALS_FIELD_NAME",
                                                                                    "start_token": -1,
                                                                                    "end_token": 5231,
                                                                                    "children": []
                                                                                }
                                                                            ]
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        },
                                                        {
                                                            "type": "comment",
                                                            "label": "# The BlockSchema class enforces that a `credentials` field is always a",
                                                            "start_token": 5233,
                                                            "end_token": 5246,
                                                            "children": []
                                                        },
                                                        {
                                                            "type": "comment",
                                                            "label": "# `CredentialsMetaInput`, so we can safely assume this here.",
                                                            "start_token": 5250,
                                                            "end_token": 5258,
                                                            "children": []
                                                        },
                                                        {
                                                            "type": "expression_statement",
                                                            "label": "credentials_meta_type = cast(CredentialsMetaInput, field.annotation)",
                                                            "start_token": 5262,
                                                            "end_token": -1,
                                                            "children": [
                                                                {
                                                                    "type": "assignment",
                                                                    "label": "credentials_meta_type = cast(CredentialsMetaInput, field.annotation)",
                                                                    "start_token": 5262,
                                                                    "end_token": -1,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "credentials_meta_type",
                                                                            "start_token": 5262,
                                                                            "end_token": -1,
                                                                            "children": []
                                                                        },
                                                                        {
                                                                            "type": "call",
                                                                            "label": "cast(CredentialsMetaInput, field.annotation)",
                                                                            "start_token": 5264,
                                                                            "end_token": -1,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "cast",
                                                                                    "start_token": 5264,
                                                                                    "end_token": 5266,
                                                                                    "children": []
                                                                                },
                                                                                {
                                                                                    "type": "argument_list",
                                                                                    "label": "(CredentialsMetaInput, field.annotation)",
                                                                                    "start_token": 5266,
                                                                                    "end_token": -1,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "label": "CredentialsMetaInput",
                                                                                            "start_token": 5266,
                                                                                            "end_token": -1,
                                                                                            "children": []
                                                                                        },
                                                                                        {
                                                                                            "type": "attribute",
                                                                                            "label": "field.annotation",
                                                                                            "start_token": 5269,
                                                                                            "end_token": 5269,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "label": "field",
                                                                                                    "start_token": 5269,
                                                                                                    "end_token": 5269,
                                                                                                    "children": []
                                                                                                },
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "label": "annotation",
                                                                                                    "start_token": 5269,
                                                                                                    "end_token": 5269,
                                                                                                    "children": []
                                                                                                }
                                                                                            ]
                                                                                        }
                                                                                    ]
                                                                                }
                                                                            ]
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        },
                                                        {
                                                            "type": "expression_statement",
                                                            "label": "credentials_meta = credentials_meta_type.model_validate(\n                node.input_default[CREDENTIALS_FIELD_NAME]\n            )",
                                                            "start_token": 5271,
                                                            "end_token": 5288,
                                                            "children": [
                                                                {
                                                                    "type": "assignment",
                                                                    "label": "credentials_meta = credentials_meta_type.model_validate(\n                node.input_default[CREDENTIALS_FIELD_NAME]\n            )",
                                                                    "start_token": 5271,
                                                                    "end_token": 5288,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "credentials_meta",
                                                                            "start_token": 5271,
                                                                            "end_token": 5273,
                                                                            "children": []
                                                                        },
                                                                        {
                                                                            "type": "call",
                                                                            "label": "credentials_meta_type.model_validate(\n                node.input_default[CREDENTIALS_FIELD_NAME]\n            )",
                                                                            "start_token": 5273,
                                                                            "end_token": 5288,
                                                                            "children": [
                                                                                {
                                                                                    "type": "attribute",
                                                                                    "label": "credentials_meta_type.model_validate",
                                                                                    "start_token": 5273,
                                                                                    "end_token": 5278,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "label": "credentials_meta_type",
                                                                                            "start_token": 5273,
                                                                                            "end_token": -1,
                                                                                            "children": []
                                                                                        },
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "label": "model_validate",
                                                                                            "start_token": -1,
                                                                                            "end_token": 5278,
                                                                                            "children": []
                                                                                        }
                                                                                    ]
                                                                                },
                                                                                {
                                                                                    "type": "argument_list",
                                                                                    "label": "(\n                node.input_default[CREDENTIALS_FIELD_NAME]\n            )",
                                                                                    "start_token": 5278,
                                                                                    "end_token": 5288,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "subscript",
                                                                                            "label": "node.input_default[CREDENTIALS_FIELD_NAME]",
                                                                                            "start_token": 5280,
                                                                                            "end_token": 5286,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "attribute",
                                                                                                    "label": "node.input_default",
                                                                                                    "start_token": 5280,
                                                                                                    "end_token": -1,
                                                                                                    "children": [
                                                                                                        {
                                                                                                            "type": "identifier",
                                                                                                            "label": "node",
                                                                                                            "start_token": 5280,
                                                                                                            "end_token": 5280,
                                                                                                            "children": []
                                                                                                        },
                                                                                                        {
                                                                                                            "type": "identifier",
                                                                                                            "label": "input_default",
                                                                                                            "start_token": 5280,
                                                                                                            "end_token": -1,
                                                                                                            "children": []
                                                                                                        }
                                                                                                    ]
                                                                                                },
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "label": "CREDENTIALS_FIELD_NAME",
                                                                                                    "start_token": -1,
                                                                                                    "end_token": -1,
                                                                                                    "children": []
                                                                                                }
                                                                                            ]
                                                                                        }
                                                                                    ]
                                                                                }
                                                                            ]
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        },
                                                        {
                                                            "type": "comment",
                                                            "label": "# Fetch the corresponding Credentials and perform sanity checks",
                                                            "start_token": 5289,
                                                            "end_token": 5297,
                                                            "children": []
                                                        },
                                                        {
                                                            "type": "expression_statement",
                                                            "label": "credentials = self.credentials_store.get_creds_by_id(\n                user_id, credentials_meta.id\n            )",
                                                            "start_token": 5299,
                                                            "end_token": 5314,
                                                            "children": [
                                                                {
                                                                    "type": "assignment",
                                                                    "label": "credentials = self.credentials_store.get_creds_by_id(\n                user_id, credentials_meta.id\n            )",
                                                                    "start_token": 5299,
                                                                    "end_token": 5314,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "credentials",
                                                                            "start_token": 5299,
                                                                            "end_token": 5301,
                                                                            "children": []
                                                                        },
                                                                        {
                                                                            "type": "call",
                                                                            "label": "self.credentials_store.get_creds_by_id(\n                user_id, credentials_meta.id\n            )",
                                                                            "start_token": 5301,
                                                                            "end_token": 5314,
                                                                            "children": [
                                                                                {
                                                                                    "type": "attribute",
                                                                                    "label": "self.credentials_store.get_creds_by_id",
                                                                                    "start_token": 5301,
                                                                                    "end_token": 5306,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "attribute",
                                                                                            "label": "self.credentials_store",
                                                                                            "start_token": 5301,
                                                                                            "end_token": -1,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "label": "self",
                                                                                                    "start_token": 5301,
                                                                                                    "end_token": 5301,
                                                                                                    "children": []
                                                                                                },
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "label": "credentials_store",
                                                                                                    "start_token": 5301,
                                                                                                    "end_token": -1,
                                                                                                    "children": []
                                                                                                }
                                                                                            ]
                                                                                        },
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "label": "get_creds_by_id",
                                                                                            "start_token": -1,
                                                                                            "end_token": 5306,
                                                                                            "children": []
                                                                                        }
                                                                                    ]
                                                                                },
                                                                                {
                                                                                    "type": "argument_list",
                                                                                    "label": "(\n                user_id, credentials_meta.id\n            )",
                                                                                    "start_token": 5306,
                                                                                    "end_token": 5314,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "label": "user_id",
                                                                                            "start_token": -1,
                                                                                            "end_token": -1,
                                                                                            "children": []
                                                                                        },
                                                                                        {
                                                                                            "type": "attribute",
                                                                                            "label": "credentials_meta.id",
                                                                                            "start_token": -1,
                                                                                            "end_token": -1,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "label": "credentials_meta",
                                                                                                    "start_token": -1,
                                                                                                    "end_token": -1,
                                                                                                    "children": []
                                                                                                },
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "label": "id",
                                                                                                    "start_token": 5312,
                                                                                                    "end_token": -1,
                                                                                                    "children": []
                                                                                                }
                                                                                            ]
                                                                                        }
                                                                                    ]
                                                                                }
                                                                            ]
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        },
                                                        {
                                                            "type": "if_statement",
                                                            "label": "if not credentials:\n                raise ValueError(\n                    f\"Unknown credentials #{credentials_meta.id} \"\n                    f\"for node #{node.id}\"\n                )",
                                                            "start_token": -1,
                                                            "end_token": -1,
                                                            "children": [
                                                                {
                                                                    "type": "not_operator",
                                                                    "label": "not credentials",
                                                                    "start_token": -1,
                                                                    "end_token": 5318,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "credentials",
                                                                            "start_token": 5317,
                                                                            "end_token": 5318,
                                                                            "children": []
                                                                        }
                                                                    ]
                                                                },
                                                                {
                                                                    "type": "block",
                                                                    "label": "raise ValueError(\n                    f\"Unknown credentials #{credentials_meta.id} \"\n                    f\"for node #{node.id}\"\n                )",
                                                                    "start_token": -1,
                                                                    "end_token": -1,
                                                                    "children": [
                                                                        {
                                                                            "type": "raise_statement",
                                                                            "label": "raise ValueError(\n                    f\"Unknown credentials #{credentials_meta.id} \"\n                    f\"for node #{node.id}\"\n                )",
                                                                            "start_token": -1,
                                                                            "end_token": -1,
                                                                            "children": [
                                                                                {
                                                                                    "type": "call",
                                                                                    "label": "ValueError(\n                    f\"Unknown credentials #{credentials_meta.id} \"\n                    f\"for node #{node.id}\"\n                )",
                                                                                    "start_token": -1,
                                                                                    "end_token": -1,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "label": "ValueError",
                                                                                            "start_token": -1,
                                                                                            "end_token": 5322,
                                                                                            "children": []
                                                                                        },
                                                                                        {
                                                                                            "type": "argument_list",
                                                                                            "label": "(\n                    f\"Unknown credentials #{credentials_meta.id} \"\n                    f\"for node #{node.id}\"\n                )",
                                                                                            "start_token": 5322,
                                                                                            "end_token": -1,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "concatenated_string",
                                                                                                    "label": "f\"Unknown credentials #{credentials_meta.id} \"\n                    f\"for node #{node.id}\"",
                                                                                                    "start_token": 5322,
                                                                                                    "end_token": -1,
                                                                                                    "children": [
                                                                                                        {
                                                                                                            "type": "string",
                                                                                                            "label": "f\"Unknown credentials #{credentials_meta.id} \"",
                                                                                                            "start_token": 5322,
                                                                                                            "end_token": 5325,
                                                                                                            "children": [
                                                                                                                {
                                                                                                                    "type": "string_start",
                                                                                                                    "label": "f\"",
                                                                                                                    "start_token": 5322,
                                                                                                                    "end_token": 5322,
                                                                                                                    "children": []
                                                                                                                },
                                                                                                                {
                                                                                                                    "type": "string_content",
                                                                                                                    "label": "Unknown credentials #",
                                                                                                                    "start_token": 5322,
                                                                                                                    "end_token": -1,
                                                                                                                    "children": []
                                                                                                                },
                                                                                                                {
                                                                                                                    "type": "interpolation",
                                                                                                                    "label": "{credentials_meta.id}",
                                                                                                                    "start_token": -1,
                                                                                                                    "end_token": 5325,
                                                                                                                    "children": [
                                                                                                                        {
                                                                                                                            "type": "attribute",
                                                                                                                            "label": "credentials_meta.id",
                                                                                                                            "start_token": -1,
                                                                                                                            "end_token": 5325,
                                                                                                                            "children": [
                                                                                                                                {
                                                                                                                                    "type": "identifier",
                                                                                                                                    "label": "credentials_meta",
                                                                                                                                    "start_token": -1,
                                                                                                                                    "end_token": 5325,
                                                                                                                                    "children": []
                                                                                                                                },
                                                                                                                                {
                                                                                                                                    "type": "identifier",
                                                                                                                                    "label": "id",
                                                                                                                                    "start_token": 5325,
                                                                                                                                    "end_token": 5325,
                                                                                                                                    "children": []
                                                                                                                                }
                                                                                                                            ]
                                                                                                                        }
                                                                                                                    ]
                                                                                                                },
                                                                                                                {
                                                                                                                    "type": "string_content",
                                                                                                                    "label": " ",
                                                                                                                    "start_token": 5325,
                                                                                                                    "end_token": 5325,
                                                                                                                    "children": []
                                                                                                                },
                                                                                                                {
                                                                                                                    "type": "string_end",
                                                                                                                    "label": "\"",
                                                                                                                    "start_token": 5325,
                                                                                                                    "end_token": 5325,
                                                                                                                    "children": []
                                                                                                                }
                                                                                                            ]
                                                                                                        },
                                                                                                        {
                                                                                                            "type": "string",
                                                                                                            "label": "f\"for node #{node.id}\"",
                                                                                                            "start_token": -1,
                                                                                                            "end_token": -1,
                                                                                                            "children": [
                                                                                                                {
                                                                                                                    "type": "string_start",
                                                                                                                    "label": "f\"",
                                                                                                                    "start_token": -1,
                                                                                                                    "end_token": -1,
                                                                                                                    "children": []
                                                                                                                },
                                                                                                                {
                                                                                                                    "type": "string_content",
                                                                                                                    "label": "for node #",
                                                                                                                    "start_token": -1,
                                                                                                                    "end_token": -1,
                                                                                                                    "children": []
                                                                                                                },
                                                                                                                {
                                                                                                                    "type": "interpolation",
                                                                                                                    "label": "{node.id}",
                                                                                                                    "start_token": -1,
                                                                                                                    "end_token": -1,
                                                                                                                    "children": [
                                                                                                                        {
                                                                                                                            "type": "attribute",
                                                                                                                            "label": "node.id",
                                                                                                                            "start_token": -1,
                                                                                                                            "end_token": -1,
                                                                                                                            "children": [
                                                                                                                                {
                                                                                                                                    "type": "identifier",
                                                                                                                                    "label": "node",
                                                                                                                                    "start_token": -1,
                                                                                                                                    "end_token": -1,
                                                                                                                                    "children": []
                                                                                                                                },
                                                                                                                                {
                                                                                                                                    "type": "identifier",
                                                                                                                                    "label": "id",
                                                                                                                                    "start_token": -1,
                                                                                                                                    "end_token": -1,
                                                                                                                                    "children": []
                                                                                                                                }
                                                                                                                            ]
                                                                                                                        }
                                                                                                                    ]
                                                                                                                },
                                                                                                                {
                                                                                                                    "type": "string_end",
                                                                                                                    "label": "\"",
                                                                                                                    "start_token": -1,
                                                                                                                    "end_token": -1,
                                                                                                                    "children": []
                                                                                                                }
                                                                                                            ]
                                                                                                        }
                                                                                                    ]
                                                                                                }
                                                                                            ]
                                                                                        }
                                                                                    ]
                                                                                }
                                                                            ]
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        },
                                                        {
                                                            "type": "if_statement",
                                                            "label": "if (\n                credentials.provider != credentials_meta.provider\n                or credentials.type != credentials_meta.type\n            ):\n                logger.warning(\n                    f\"Invalid credentials #{credentials.id} for node #{node.id}: \"\n                    \"type/provider mismatch: \"\n                    f\"{credentials_meta.type}<>{credentials.type};\"\n                    f\"{credentials_meta.provider}<>{credentials.provider}\"\n                )\n                raise ValueError(\n                    f\"Invalid credentials #{credentials.id} for node #{node.id}: \"\n                    \"type/provider mismatch\"\n                )",
                                                            "start_token": 5332,
                                                            "end_token": 5400,
                                                            "children": [
                                                                {
                                                                    "type": "parenthesized_expression",
                                                                    "label": "(\n                credentials.provider != credentials_meta.provider\n                or credentials.type != credentials_meta.type\n            )",
                                                                    "start_token": 5334,
                                                                    "end_token": 5356,
                                                                    "children": [
                                                                        {
                                                                            "type": "boolean_operator",
                                                                            "label": "credentials.provider != credentials_meta.provider\n                or credentials.type != credentials_meta.type",
                                                                            "start_token": 5337,
                                                                            "end_token": -1,
                                                                            "children": [
                                                                                {
                                                                                    "type": "comparison_operator",
                                                                                    "label": "credentials.provider != credentials_meta.provider",
                                                                                    "start_token": 5337,
                                                                                    "end_token": 5342,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "attribute",
                                                                                            "label": "credentials.provider",
                                                                                            "start_token": 5337,
                                                                                            "end_token": 5340,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "label": "credentials",
                                                                                                    "start_token": 5337,
                                                                                                    "end_token": 5338,
                                                                                                    "children": []
                                                                                                },
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "label": "provider",
                                                                                                    "start_token": 5339,
                                                                                                    "end_token": 5340,
                                                                                                    "children": []
                                                                                                }
                                                                                            ]
                                                                                        },
                                                                                        {
                                                                                            "type": "attribute",
                                                                                            "label": "credentials_meta.provider",
                                                                                            "start_token": -1,
                                                                                            "end_token": 5342,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "label": "credentials_meta",
                                                                                                    "start_token": -1,
                                                                                                    "end_token": 5342,
                                                                                                    "children": []
                                                                                                },
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "label": "provider",
                                                                                                    "start_token": 5342,
                                                                                                    "end_token": 5342,
                                                                                                    "children": []
                                                                                                }
                                                                                            ]
                                                                                        }
                                                                                    ]
                                                                                },
                                                                                {
                                                                                    "type": "comparison_operator",
                                                                                    "label": "credentials.type != credentials_meta.type",
                                                                                    "start_token": 5347,
                                                                                    "end_token": -1,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "attribute",
                                                                                            "label": "credentials.type",
                                                                                            "start_token": 5347,
                                                                                            "end_token": -1,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "label": "credentials",
                                                                                                    "start_token": 5347,
                                                                                                    "end_token": 5349,
                                                                                                    "children": []
                                                                                                },
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "label": "type",
                                                                                                    "start_token": -1,
                                                                                                    "end_token": -1,
                                                                                                    "children": []
                                                                                                }
                                                                                            ]
                                                                                        },
                                                                                        {
                                                                                            "type": "attribute",
                                                                                            "label": "credentials_meta.type",
                                                                                            "start_token": -1,
                                                                                            "end_token": -1,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "label": "credentials_meta",
                                                                                                    "start_token": -1,
                                                                                                    "end_token": -1,
                                                                                                    "children": []
                                                                                                },
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "label": "type",
                                                                                                    "start_token": -1,
                                                                                                    "end_token": -1,
                                                                                                    "children": []
                                                                                                }
                                                                                            ]
                                                                                        }
                                                                                    ]
                                                                                }
                                                                            ]
                                                                        }
                                                                    ]
                                                                },
                                                                {
                                                                    "type": "block",
                                                                    "label": "logger.warning(\n                    f\"Invalid credentials #{credentials.id} for node #{node.id}: \"\n                    \"type/provider mismatch: \"\n                    f\"{credentials_meta.type}<>{credentials.type};\"\n                    f\"{credentials_meta.provider}<>{credentials.provider}\"\n                )\n                raise ValueError(\n                    f\"Invalid credentials #{credentials.id} for node #{node.id}: \"\n                    \"type/provider mismatch\"\n                )",
                                                                    "start_token": -1,
                                                                    "end_token": 5400,
                                                                    "children": [
                                                                        {
                                                                            "type": "expression_statement",
                                                                            "label": "logger.warning(\n                    f\"Invalid credentials #{credentials.id} for node #{node.id}: \"\n                    \"type/provider mismatch: \"\n                    f\"{credentials_meta.type}<>{credentials.type};\"\n                    f\"{credentials_meta.provider}<>{credentials.provider}\"\n                )",
                                                                            "start_token": -1,
                                                                            "end_token": 5373,
                                                                            "children": [
                                                                                {
                                                                                    "type": "call",
                                                                                    "label": "logger.warning(\n                    f\"Invalid credentials #{credentials.id} for node #{node.id}: \"\n                    \"type/provider mismatch: \"\n                    f\"{credentials_meta.type}<>{credentials.type};\"\n                    f\"{credentials_meta.provider}<>{credentials.provider}\"\n                )",
                                                                                    "start_token": -1,
                                                                                    "end_token": 5373,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "attribute",
                                                                                            "label": "logger.warning",
                                                                                            "start_token": -1,
                                                                                            "end_token": 5360,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "label": "logger",
                                                                                                    "start_token": -1,
                                                                                                    "end_token": -1,
                                                                                                    "children": []
                                                                                                },
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "label": "warning",
                                                                                                    "start_token": 5360,
                                                                                                    "end_token": 5360,
                                                                                                    "children": []
                                                                                                }
                                                                                            ]
                                                                                        },
                                                                                        {
                                                                                            "type": "argument_list",
                                                                                            "label": "(\n                    f\"Invalid credentials #{credentials.id} for node #{node.id}: \"\n                    \"type/provider mismatch: \"\n                    f\"{credentials_meta.type}<>{credentials.type};\"\n                    f\"{credentials_meta.provider}<>{credentials.provider}\"\n                )",
                                                                                            "start_token": 5360,
                                                                                            "end_token": 5373,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "concatenated_string",
                                                                                                    "label": "f\"Invalid credentials #{credentials.id} for node #{node.id}: \"\n                    \"type/provider mismatch: \"\n                    f\"{credentials_meta.type}<>{credentials.type};\"\n                    f\"{credentials_meta.provider}<>{credentials.provider}\"",
                                                                                                    "start_token": 5360,
                                                                                                    "end_token": -1,
                                                                                                    "children": [
                                                                                                        {
                                                                                                            "type": "string",
                                                                                                            "label": "f\"Invalid credentials #{credentials.id} for node #{node.id}: \"",
                                                                                                            "start_token": 5360,
                                                                                                            "end_token": 5362,
                                                                                                            "children": [
                                                                                                                {
                                                                                                                    "type": "string_start",
                                                                                                                    "label": "f\"",
                                                                                                                    "start_token": 5360,
                                                                                                                    "end_token": 5360,
                                                                                                                    "children": []
                                                                                                                },
                                                                                                                {
                                                                                                                    "type": "string_content",
                                                                                                                    "label": "Invalid credentials #",
                                                                                                                    "start_token": 5360,
                                                                                                                    "end_token": 5360,
                                                                                                                    "children": []
                                                                                                                },
                                                                                                                {
                                                                                                                    "type": "interpolation",
                                                                                                                    "label": "{credentials.id}",
                                                                                                                    "start_token": 5360,
                                                                                                                    "end_token": -1,
                                                                                                                    "children": [
                                                                                                                        {
                                                                                                                            "type": "attribute",
                                                                                                                            "label": "credentials.id",
                                                                                                                            "start_token": 5360,
                                                                                                                            "end_token": -1,
                                                                                                                            "children": [
                                                                                                                                {
                                                                                                                                    "type": "identifier",
                                                                                                                                    "label": "credentials",
                                                                                                                                    "start_token": 5360,
                                                                                                                                    "end_token": -1,
                                                                                                                                    "children": []
                                                                                                                                },
                                                                                                                                {
                                                                                                                                    "type": "identifier",
                                                                                                                                    "label": "id",
                                                                                                                                    "start_token": -1,
                                                                                                                                    "end_token": -1,
                                                                                                                                    "children": []
                                                                                                                                }
                                                                                                                            ]
                                                                                                                        }
                                                                                                                    ]
                                                                                                                },
                                                                                                                {
                                                                                                                    "type": "string_content",
                                                                                                                    "label": " for node #",
                                                                                                                    "start_token": -1,
                                                                                                                    "end_token": -1,
                                                                                                                    "children": []
                                                                                                                },
                                                                                                                {
                                                                                                                    "type": "interpolation",
                                                                                                                    "label": "{node.id}",
                                                                                                                    "start_token": -1,
                                                                                                                    "end_token": 5362,
                                                                                                                    "children": [
                                                                                                                        {
                                                                                                                            "type": "attribute",
                                                                                                                            "label": "node.id",
                                                                                                                            "start_token": -1,
                                                                                                                            "end_token": 5362,
                                                                                                                            "children": [
                                                                                                                                {
                                                                                                                                    "type": "identifier",
                                                                                                                                    "label": "node",
                                                                                                                                    "start_token": -1,
                                                                                                                                    "end_token": 5362,
                                                                                                                                    "children": []
                                                                                                                                },
                                                                                                                                {
                                                                                                                                    "type": "identifier",
                                                                                                                                    "label": "id",
                                                                                                                                    "start_token": 5362,
                                                                                                                                    "end_token": 5362,
                                                                                                                                    "children": []
                                                                                                                                }
                                                                                                                            ]
                                                                                                                        }
                                                                                                                    ]
                                                                                                                },
                                                                                                                {
                                                                                                                    "type": "string_content",
                                                                                                                    "label": ": ",
                                                                                                                    "start_token": 5362,
                                                                                                                    "end_token": 5362,
                                                                                                                    "children": []
                                                                                                                },
                                                                                                                {
                                                                                                                    "type": "string_end",
                                                                                                                    "label": "\"",
                                                                                                                    "start_token": 5362,
                                                                                                                    "end_token": 5362,
                                                                                                                    "children": []
                                                                                                                }
                                                                                                            ]
                                                                                                        },
                                                                                                        {
                                                                                                            "type": "string",
                                                                                                            "label": "\"type/provider mismatch: \"",
                                                                                                            "start_token": -1,
                                                                                                            "end_token": 5365,
                                                                                                            "children": [
                                                                                                                {
                                                                                                                    "type": "string_start",
                                                                                                                    "label": "\"",
                                                                                                                    "start_token": -1,
                                                                                                                    "end_token": -1,
                                                                                                                    "children": []
                                                                                                                },
                                                                                                                {
                                                                                                                    "type": "string_content",
                                                                                                                    "label": "type/provider mismatch: ",
                                                                                                                    "start_token": -1,
                                                                                                                    "end_token": 5365,
                                                                                                                    "children": []
                                                                                                                },
                                                                                                                {
                                                                                                                    "type": "string_end",
                                                                                                                    "label": "\"",
                                                                                                                    "start_token": 5365,
                                                                                                                    "end_token": 5365,
                                                                                                                    "children": []
                                                                                                                }
                                                                                                            ]
                                                                                                        },
                                                                                                        {
                                                                                                            "type": "string",
                                                                                                            "label": "f\"{credentials_meta.type}<>{credentials.type};\"",
                                                                                                            "start_token": 5365,
                                                                                                            "end_token": 5368,
                                                                                                            "children": [
                                                                                                                {
                                                                                                                    "type": "string_start",
                                                                                                                    "label": "f\"",
                                                                                                                    "start_token": 5365,
                                                                                                                    "end_token": 5365,
                                                                                                                    "children": []
                                                                                                                },
                                                                                                                {
                                                                                                                    "type": "interpolation",
                                                                                                                    "label": "{credentials_meta.type}",
                                                                                                                    "start_token": 5365,
                                                                                                                    "end_token": -1,
                                                                                                                    "children": [
                                                                                                                        {
                                                                                                                            "type": "attribute",
                                                                                                                            "label": "credentials_meta.type",
                                                                                                                            "start_token": 5365,
                                                                                                                            "end_token": -1,
                                                                                                                            "children": [
                                                                                                                                {
                                                                                                                                    "type": "identifier",
                                                                                                                                    "label": "credentials_meta",
                                                                                                                                    "start_token": 5365,
                                                                                                                                    "end_token": -1,
                                                                                                                                    "children": []
                                                                                                                                },
                                                                                                                                {
                                                                                                                                    "type": "identifier",
                                                                                                                                    "label": "type",
                                                                                                                                    "start_token": -1,
                                                                                                                                    "end_token": -1,
                                                                                                                                    "children": []
                                                                                                                                }
                                                                                                                            ]
                                                                                                                        }
                                                                                                                    ]
                                                                                                                },
                                                                                                                {
                                                                                                                    "type": "string_content",
                                                                                                                    "label": "<>",
                                                                                                                    "start_token": -1,
                                                                                                                    "end_token": -1,
                                                                                                                    "children": []
                                                                                                                },
                                                                                                                {
                                                                                                                    "type": "interpolation",
                                                                                                                    "label": "{credentials.type}",
                                                                                                                    "start_token": -1,
                                                                                                                    "end_token": 5368,
                                                                                                                    "children": [
                                                                                                                        {
                                                                                                                            "type": "attribute",
                                                                                                                            "label": "credentials.type",
                                                                                                                            "start_token": -1,
                                                                                                                            "end_token": 5368,
                                                                                                                            "children": [
                                                                                                                                {
                                                                                                                                    "type": "identifier",
                                                                                                                                    "label": "credentials",
                                                                                                                                    "start_token": -1,
                                                                                                                                    "end_token": 5367,
                                                                                                                                    "children": []
                                                                                                                                },
                                                                                                                                {
                                                                                                                                    "type": "identifier",
                                                                                                                                    "label": "type",
                                                                                                                                    "start_token": 5368,
                                                                                                                                    "end_token": 5368,
                                                                                                                                    "children": []
                                                                                                                                }
                                                                                                                            ]
                                                                                                                        }
                                                                                                                    ]
                                                                                                                },
                                                                                                                {
                                                                                                                    "type": "string_content",
                                                                                                                    "label": ";",
                                                                                                                    "start_token": 5368,
                                                                                                                    "end_token": 5368,
                                                                                                                    "children": []
                                                                                                                },
                                                                                                                {
                                                                                                                    "type": "string_end",
                                                                                                                    "label": "\"",
                                                                                                                    "start_token": 5368,
                                                                                                                    "end_token": 5368,
                                                                                                                    "children": []
                                                                                                                }
                                                                                                            ]
                                                                                                        },
                                                                                                        {
                                                                                                            "type": "string",
                                                                                                            "label": "f\"{credentials_meta.provider}<>{credentials.provider}\"",
                                                                                                            "start_token": 5368,
                                                                                                            "end_token": -1,
                                                                                                            "children": [
                                                                                                                {
                                                                                                                    "type": "string_start",
                                                                                                                    "label": "f\"",
                                                                                                                    "start_token": 5368,
                                                                                                                    "end_token": 5368,
                                                                                                                    "children": []
                                                                                                                },
                                                                                                                {
                                                                                                                    "type": "interpolation",
                                                                                                                    "label": "{credentials_meta.provider}",
                                                                                                                    "start_token": 5368,
                                                                                                                    "end_token": -1,
                                                                                                                    "children": [
                                                                                                                        {
                                                                                                                            "type": "attribute",
                                                                                                                            "label": "credentials_meta.provider",
                                                                                                                            "start_token": 5368,
                                                                                                                            "end_token": -1,
                                                                                                                            "children": [
                                                                                                                                {
                                                                                                                                    "type": "identifier",
                                                                                                                                    "label": "credentials_meta",
                                                                                                                                    "start_token": 5368,
                                                                                                                                    "end_token": 5368,
                                                                                                                                    "children": []
                                                                                                                                },
                                                                                                                                {
                                                                                                                                    "type": "identifier",
                                                                                                                                    "label": "provider",
                                                                                                                                    "start_token": 5368,
                                                                                                                                    "end_token": -1,
                                                                                                                                    "children": []
                                                                                                                                }
                                                                                                                            ]
                                                                                                                        }
                                                                                                                    ]
                                                                                                                },
                                                                                                                {
                                                                                                                    "type": "string_content",
                                                                                                                    "label": "<>",
                                                                                                                    "start_token": -1,
                                                                                                                    "end_token": -1,
                                                                                                                    "children": []
                                                                                                                },
                                                                                                                {
                                                                                                                    "type": "interpolation",
                                                                                                                    "label": "{credentials.provider}",
                                                                                                                    "start_token": -1,
                                                                                                                    "end_token": -1,
                                                                                                                    "children": [
                                                                                                                        {
                                                                                                                            "type": "attribute",
                                                                                                                            "label": "credentials.provider",
                                                                                                                            "start_token": -1,
                                                                                                                            "end_token": -1,
                                                                                                                            "children": [
                                                                                                                                {
                                                                                                                                    "type": "identifier",
                                                                                                                                    "label": "credentials",
                                                                                                                                    "start_token": -1,
                                                                                                                                    "end_token": 5371,
                                                                                                                                    "children": []
                                                                                                                                },
                                                                                                                                {
                                                                                                                                    "type": "identifier",
                                                                                                                                    "label": "provider",
                                                                                                                                    "start_token": -1,
                                                                                                                                    "end_token": -1,
                                                                                                                                    "children": []
                                                                                                                                }
                                                                                                                            ]
                                                                                                                        }
                                                                                                                    ]
                                                                                                                },
                                                                                                                {
                                                                                                                    "type": "string_end",
                                                                                                                    "label": "\"",
                                                                                                                    "start_token": -1,
                                                                                                                    "end_token": -1,
                                                                                                                    "children": []
                                                                                                                }
                                                                                                            ]
                                                                                                        }
                                                                                                    ]
                                                                                                }
                                                                                            ]
                                                                                        }
                                                                                    ]
                                                                                }
                                                                            ]
                                                                        },
                                                                        {
                                                                            "type": "raise_statement",
                                                                            "label": "raise ValueError(\n                    f\"Invalid credentials #{credentials.id} for node #{node.id}: \"\n                    \"type/provider mismatch\"\n                )",
                                                                            "start_token": -1,
                                                                            "end_token": 5400,
                                                                            "children": [
                                                                                {
                                                                                    "type": "call",
                                                                                    "label": "ValueError(\n                    f\"Invalid credentials #{credentials.id} for node #{node.id}: \"\n                    \"type/provider mismatch\"\n                )",
                                                                                    "start_token": -1,
                                                                                    "end_token": 5400,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "label": "ValueError",
                                                                                            "start_token": -1,
                                                                                            "end_token": 5377,
                                                                                            "children": []
                                                                                        },
                                                                                        {
                                                                                            "type": "argument_list",
                                                                                            "label": "(\n                    f\"Invalid credentials #{credentials.id} for node #{node.id}: \"\n                    \"type/provider mismatch\"\n                )",
                                                                                            "start_token": 5377,
                                                                                            "end_token": 5400,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "concatenated_string",
                                                                                                    "label": "f\"Invalid credentials #{credentials.id} for node #{node.id}: \"\n                    \"type/provider mismatch\"",
                                                                                                    "start_token": 5377,
                                                                                                    "end_token": 5392,
                                                                                                    "children": [
                                                                                                        {
                                                                                                            "type": "string",
                                                                                                            "label": "f\"Invalid credentials #{credentials.id} for node #{node.id}: \"",
                                                                                                            "start_token": 5377,
                                                                                                            "end_token": 5379,
                                                                                                            "children": [
                                                                                                                {
                                                                                                                    "type": "string_start",
                                                                                                                    "label": "f\"",
                                                                                                                    "start_token": 5377,
                                                                                                                    "end_token": 5377,
                                                                                                                    "children": []
                                                                                                                },
                                                                                                                {
                                                                                                                    "type": "string_content",
                                                                                                                    "label": "Invalid credentials #",
                                                                                                                    "start_token": 5377,
                                                                                                                    "end_token": 5377,
                                                                                                                    "children": []
                                                                                                                },
                                                                                                                {
                                                                                                                    "type": "interpolation",
                                                                                                                    "label": "{credentials.id}",
                                                                                                                    "start_token": 5377,
                                                                                                                    "end_token": -1,
                                                                                                                    "children": [
                                                                                                                        {
                                                                                                                            "type": "attribute",
                                                                                                                            "label": "credentials.id",
                                                                                                                            "start_token": 5377,
                                                                                                                            "end_token": -1,
                                                                                                                            "children": [
                                                                                                                                {
                                                                                                                                    "type": "identifier",
                                                                                                                                    "label": "credentials",
                                                                                                                                    "start_token": 5377,
                                                                                                                                    "end_token": -1,
                                                                                                                                    "children": []
                                                                                                                                },
                                                                                                                                {
                                                                                                                                    "type": "identifier",
                                                                                                                                    "label": "id",
                                                                                                                                    "start_token": -1,
                                                                                                                                    "end_token": -1,
                                                                                                                                    "children": []
                                                                                                                                }
                                                                                                                            ]
                                                                                                                        }
                                                                                                                    ]
                                                                                                                },
                                                                                                                {
                                                                                                                    "type": "string_content",
                                                                                                                    "label": " for node #",
                                                                                                                    "start_token": -1,
                                                                                                                    "end_token": -1,
                                                                                                                    "children": []
                                                                                                                },
                                                                                                                {
                                                                                                                    "type": "interpolation",
                                                                                                                    "label": "{node.id}",
                                                                                                                    "start_token": -1,
                                                                                                                    "end_token": 5379,
                                                                                                                    "children": [
                                                                                                                        {
                                                                                                                            "type": "attribute",
                                                                                                                            "label": "node.id",
                                                                                                                            "start_token": -1,
                                                                                                                            "end_token": 5379,
                                                                                                                            "children": [
                                                                                                                                {
                                                                                                                                    "type": "identifier",
                                                                                                                                    "label": "node",
                                                                                                                                    "start_token": -1,
                                                                                                                                    "end_token": 5379,
                                                                                                                                    "children": []
                                                                                                                                },
                                                                                                                                {
                                                                                                                                    "type": "identifier",
                                                                                                                                    "label": "id",
                                                                                                                                    "start_token": 5379,
                                                                                                                                    "end_token": 5379,
                                                                                                                                    "children": []
                                                                                                                                }
                                                                                                                            ]
                                                                                                                        }
                                                                                                                    ]
                                                                                                                },
                                                                                                                {
                                                                                                                    "type": "string_content",
                                                                                                                    "label": ": ",
                                                                                                                    "start_token": 5379,
                                                                                                                    "end_token": 5379,
                                                                                                                    "children": []
                                                                                                                },
                                                                                                                {
                                                                                                                    "type": "string_end",
                                                                                                                    "label": "\"",
                                                                                                                    "start_token": 5379,
                                                                                                                    "end_token": 5379,
                                                                                                                    "children": []
                                                                                                                }
                                                                                                            ]
                                                                                                        },
                                                                                                        {
                                                                                                            "type": "string",
                                                                                                            "label": "\"type/provider mismatch\"",
                                                                                                            "start_token": -1,
                                                                                                            "end_token": 5392,
                                                                                                            "children": [
                                                                                                                {
                                                                                                                    "type": "string_start",
                                                                                                                    "label": "\"",
                                                                                                                    "start_token": -1,
                                                                                                                    "end_token": -1,
                                                                                                                    "children": []
                                                                                                                },
                                                                                                                {
                                                                                                                    "type": "string_content",
                                                                                                                    "label": "type/provider mismatch",
                                                                                                                    "start_token": -1,
                                                                                                                    "end_token": 5391,
                                                                                                                    "children": []
                                                                                                                },
                                                                                                                {
                                                                                                                    "type": "string_end",
                                                                                                                    "label": "\"",
                                                                                                                    "start_token": 5392,
                                                                                                                    "end_token": 5392,
                                                                                                                    "children": []
                                                                                                                }
                                                                                                            ]
                                                                                                        }
                                                                                                    ]
                                                                                                }
                                                                                            ]
                                                                                        }
                                                                                    ]
                                                                                }
                                                                            ]
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                }
                                            ]
                                        }
                                    ]
                                }
                            ]
                        }
                    ]
                }
            ]
        },
        {
            "type": "comment",
            "label": "# ------- UTILITIES ------- #",
            "start_token": 5403,
            "end_token": 5409,
            "children": []
        },
        {
            "type": "decorated_definition",
            "label": "@thread_cached\ndef get_db_client() -> \"DatabaseManager\":\n    from backend.executor import DatabaseManager\n\n    return get_service_client(DatabaseManager)",
            "start_token": 5409,
            "end_token": 5437,
            "children": [
                {
                    "type": "decorator",
                    "label": "@thread_cached",
                    "start_token": 5409,
                    "end_token": 5414,
                    "children": [
                        {
                            "type": "identifier",
                            "label": "thread_cached",
                            "start_token": 5409,
                            "end_token": 5414,
                            "children": []
                        }
                    ]
                },
                {
                    "type": "function_definition",
                    "label": "def get_db_client() -> \"DatabaseManager\":\n    from backend.executor import DatabaseManager\n\n    return get_service_client(DatabaseManager)",
                    "start_token": 5414,
                    "end_token": 5437,
                    "children": [
                        {
                            "type": "identifier",
                            "label": "get_db_client",
                            "start_token": 5414,
                            "end_token": 5417,
                            "children": []
                        },
                        {
                            "type": "parameters",
                            "label": "()",
                            "start_token": 5417,
                            "end_token": 5417,
                            "children": []
                        },
                        {
                            "type": "type",
                            "label": "\"DatabaseManager\"",
                            "start_token": 5418,
                            "end_token": 5421,
                            "children": [
                                {
                                    "type": "string",
                                    "label": "\"DatabaseManager\"",
                                    "start_token": 5418,
                                    "end_token": 5421,
                                    "children": [
                                        {
                                            "type": "string_start",
                                            "label": "\"",
                                            "start_token": 5418,
                                            "end_token": 5418,
                                            "children": []
                                        },
                                        {
                                            "type": "string_content",
                                            "label": "DatabaseManager",
                                            "start_token": 5418,
                                            "end_token": 5421,
                                            "children": []
                                        },
                                        {
                                            "type": "string_end",
                                            "label": "\"",
                                            "start_token": 5421,
                                            "end_token": 5421,
                                            "children": []
                                        }
                                    ]
                                }
                            ]
                        },
                        {
                            "type": "block",
                            "label": "from backend.executor import DatabaseManager\n\n    return get_service_client(DatabaseManager)",
                            "start_token": 5422,
                            "end_token": 5437,
                            "children": [
                                {
                                    "type": "import_from_statement",
                                    "label": "from backend.executor import DatabaseManager",
                                    "start_token": 5422,
                                    "end_token": 5426,
                                    "children": [
                                        {
                                            "type": "dotted_name",
                                            "label": "backend.executor",
                                            "start_token": 5422,
                                            "end_token": 5425,
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "label": "backend",
                                                    "start_token": 5422,
                                                    "end_token": 5422,
                                                    "children": []
                                                },
                                                {
                                                    "type": "identifier",
                                                    "label": "executor",
                                                    "start_token": 5422,
                                                    "end_token": 5425,
                                                    "children": []
                                                }
                                            ]
                                        },
                                        {
                                            "type": "dotted_name",
                                            "label": "DatabaseManager",
                                            "start_token": 5426,
                                            "end_token": 5426,
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "label": "DatabaseManager",
                                                    "start_token": 5426,
                                                    "end_token": 5426,
                                                    "children": []
                                                }
                                            ]
                                        }
                                    ]
                                },
                                {
                                    "type": "return_statement",
                                    "label": "return get_service_client(DatabaseManager)",
                                    "start_token": 5428,
                                    "end_token": 5437,
                                    "children": [
                                        {
                                            "type": "call",
                                            "label": "get_service_client(DatabaseManager)",
                                            "start_token": 5428,
                                            "end_token": 5437,
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "label": "get_service_client",
                                                    "start_token": 5428,
                                                    "end_token": 5434,
                                                    "children": []
                                                },
                                                {
                                                    "type": "argument_list",
                                                    "label": "(DatabaseManager)",
                                                    "start_token": 5434,
                                                    "end_token": 5437,
                                                    "children": [
                                                        {
                                                            "type": "identifier",
                                                            "label": "DatabaseManager",
                                                            "start_token": 5434,
                                                            "end_token": 5437,
                                                            "children": []
                                                        }
                                                    ]
                                                }
                                            ]
                                        }
                                    ]
                                }
                            ]
                        }
                    ]
                }
            ]
        },
        {
            "type": "decorated_definition",
            "label": "@contextmanager\ndef synchronized(key: str, timeout: int = 60):\n    lock: RedisLock = redis.get_redis().lock(f\"lock:{key}\", timeout=timeout)\n    try:\n        lock.acquire()\n        yield\n    finally:\n        if lock.locked():\n            lock.release()",
            "start_token": 5437,
            "end_token": 5509,
            "children": [
                {
                    "type": "decorator",
                    "label": "@contextmanager",
                    "start_token": 5437,
                    "end_token": 5443,
                    "children": [
                        {
                            "type": "identifier",
                            "label": "contextmanager",
                            "start_token": 5437,
                            "end_token": 5443,
                            "children": []
                        }
                    ]
                },
                {
                    "type": "function_definition",
                    "label": "def synchronized(key: str, timeout: int = 60):\n    lock: RedisLock = redis.get_redis().lock(f\"lock:{key}\", timeout=timeout)\n    try:\n        lock.acquire()\n        yield\n    finally:\n        if lock.locked():\n            lock.release()",
                    "start_token": 5443,
                    "end_token": 5509,
                    "children": [
                        {
                            "type": "identifier",
                            "label": "synchronized",
                            "start_token": 5444,
                            "end_token": 5449,
                            "children": []
                        },
                        {
                            "type": "parameters",
                            "label": "(key: str, timeout: int = 60)",
                            "start_token": 5450,
                            "end_token": 5456,
                            "children": [
                                {
                                    "type": "typed_parameter",
                                    "label": "key: str",
                                    "start_token": -1,
                                    "end_token": 5451,
                                    "children": [
                                        {
                                            "type": "identifier",
                                            "label": "key",
                                            "start_token": -1,
                                            "end_token": -1,
                                            "children": []
                                        },
                                        {
                                            "type": "type",
                                            "label": "str",
                                            "start_token": 5451,
                                            "end_token": 5451,
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "label": "str",
                                                    "start_token": 5451,
                                                    "end_token": 5451,
                                                    "children": []
                                                }
                                            ]
                                        }
                                    ]
                                },
                                {
                                    "type": "typed_default_parameter",
                                    "label": "timeout: int = 60",
                                    "start_token": 5453,
                                    "end_token": 5455,
                                    "children": [
                                        {
                                            "type": "identifier",
                                            "label": "timeout",
                                            "start_token": 5453,
                                            "end_token": 5453,
                                            "children": []
                                        },
                                        {
                                            "type": "type",
                                            "label": "int",
                                            "start_token": -1,
                                            "end_token": -1,
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "label": "int",
                                                    "start_token": -1,
                                                    "end_token": -1,
                                                    "children": []
                                                }
                                            ]
                                        },
                                        {
                                            "type": "integer",
                                            "label": "60",
                                            "start_token": 5455,
                                            "end_token": 5455,
                                            "children": []
                                        }
                                    ]
                                }
                            ]
                        },
                        {
                            "type": "block",
                            "label": "lock: RedisLock = redis.get_redis().lock(f\"lock:{key}\", timeout=timeout)\n    try:\n        lock.acquire()\n        yield\n    finally:\n        if lock.locked():\n            lock.release()",
                            "start_token": 5457,
                            "end_token": 5509,
                            "children": [
                                {
                                    "type": "expression_statement",
                                    "label": "lock: RedisLock = redis.get_redis().lock(f\"lock:{key}\", timeout=timeout)",
                                    "start_token": 5457,
                                    "end_token": 5476,
                                    "children": [
                                        {
                                            "type": "assignment",
                                            "label": "lock: RedisLock = redis.get_redis().lock(f\"lock:{key}\", timeout=timeout)",
                                            "start_token": 5457,
                                            "end_token": 5476,
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "label": "lock",
                                                    "start_token": 5457,
                                                    "end_token": 5458,
                                                    "children": []
                                                },
                                                {
                                                    "type": "type",
                                                    "label": "RedisLock",
                                                    "start_token": 5461,
                                                    "end_token": 5464,
                                                    "children": [
                                                        {
                                                            "type": "identifier",
                                                            "label": "RedisLock",
                                                            "start_token": 5461,
                                                            "end_token": 5464,
                                                            "children": []
                                                        }
                                                    ]
                                                },
                                                {
                                                    "type": "call",
                                                    "label": "redis.get_redis().lock(f\"lock:{key}\", timeout=timeout)",
                                                    "start_token": 5464,
                                                    "end_token": 5476,
                                                    "children": [
                                                        {
                                                            "type": "attribute",
                                                            "label": "redis.get_redis().lock",
                                                            "start_token": 5464,
                                                            "end_token": 5468,
                                                            "children": [
                                                                {
                                                                    "type": "call",
                                                                    "label": "redis.get_redis()",
                                                                    "start_token": 5464,
                                                                    "end_token": 5468,
                                                                    "children": [
                                                                        {
                                                                            "type": "attribute",
                                                                            "label": "redis.get_redis",
                                                                            "start_token": 5464,
                                                                            "end_token": 5466,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "redis",
                                                                                    "start_token": 5464,
                                                                                    "end_token": 5464,
                                                                                    "children": []
                                                                                },
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "get_redis",
                                                                                    "start_token": 5465,
                                                                                    "end_token": 5466,
                                                                                    "children": []
                                                                                }
                                                                            ]
                                                                        },
                                                                        {
                                                                            "type": "argument_list",
                                                                            "label": "()",
                                                                            "start_token": 5467,
                                                                            "end_token": 5468,
                                                                            "children": []
                                                                        }
                                                                    ]
                                                                },
                                                                {
                                                                    "type": "identifier",
                                                                    "label": "lock",
                                                                    "start_token": 5468,
                                                                    "end_token": 5468,
                                                                    "children": []
                                                                }
                                                            ]
                                                        },
                                                        {
                                                            "type": "argument_list",
                                                            "label": "(f\"lock:{key}\", timeout=timeout)",
                                                            "start_token": 5468,
                                                            "end_token": 5476,
                                                            "children": [
                                                                {
                                                                    "type": "string",
                                                                    "label": "f\"lock:{key}\"",
                                                                    "start_token": 5469,
                                                                    "end_token": -1,
                                                                    "children": [
                                                                        {
                                                                            "type": "string_start",
                                                                            "label": "f\"",
                                                                            "start_token": 5469,
                                                                            "end_token": 5470,
                                                                            "children": []
                                                                        },
                                                                        {
                                                                            "type": "string_content",
                                                                            "label": "lock:",
                                                                            "start_token": -1,
                                                                            "end_token": 5471,
                                                                            "children": []
                                                                        },
                                                                        {
                                                                            "type": "interpolation",
                                                                            "label": "{key}",
                                                                            "start_token": 5471,
                                                                            "end_token": -1,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "key",
                                                                                    "start_token": 5471,
                                                                                    "end_token": 5473,
                                                                                    "children": []
                                                                                }
                                                                            ]
                                                                        },
                                                                        {
                                                                            "type": "string_end",
                                                                            "label": "\"",
                                                                            "start_token": -1,
                                                                            "end_token": -1,
                                                                            "children": []
                                                                        }
                                                                    ]
                                                                },
                                                                {
                                                                    "type": "keyword_argument",
                                                                    "label": "timeout=timeout",
                                                                    "start_token": -1,
                                                                    "end_token": 5476,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "timeout",
                                                                            "start_token": -1,
                                                                            "end_token": 5474,
                                                                            "children": []
                                                                        },
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "timeout",
                                                                            "start_token": 5475,
                                                                            "end_token": 5476,
                                                                            "children": []
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                }
                                            ]
                                        }
                                    ]
                                },
                                {
                                    "type": "try_statement",
                                    "label": "try:\n        lock.acquire()\n        yield\n    finally:\n        if lock.locked():\n            lock.release()",
                                    "start_token": -1,
                                    "end_token": 5509,
                                    "children": [
                                        {
                                            "type": "block",
                                            "label": "lock.acquire()\n        yield",
                                            "start_token": -1,
                                            "end_token": 5487,
                                            "children": [
                                                {
                                                    "type": "expression_statement",
                                                    "label": "lock.acquire()",
                                                    "start_token": -1,
                                                    "end_token": -1,
                                                    "children": [
                                                        {
                                                            "type": "call",
                                                            "label": "lock.acquire()",
                                                            "start_token": -1,
                                                            "end_token": -1,
                                                            "children": [
                                                                {
                                                                    "type": "attribute",
                                                                    "label": "lock.acquire",
                                                                    "start_token": -1,
                                                                    "end_token": 5484,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "lock",
                                                                            "start_token": -1,
                                                                            "end_token": 5482,
                                                                            "children": []
                                                                        },
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "acquire",
                                                                            "start_token": 5482,
                                                                            "end_token": 5484,
                                                                            "children": []
                                                                        }
                                                                    ]
                                                                },
                                                                {
                                                                    "type": "argument_list",
                                                                    "label": "()",
                                                                    "start_token": -1,
                                                                    "end_token": -1,
                                                                    "children": []
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                },
                                                {
                                                    "type": "expression_statement",
                                                    "label": "yield",
                                                    "start_token": 5486,
                                                    "end_token": 5487,
                                                    "children": [
                                                        {
                                                            "type": "yield",
                                                            "label": "yield",
                                                            "start_token": 5486,
                                                            "end_token": 5487,
                                                            "children": []
                                                        }
                                                    ]
                                                }
                                            ]
                                        },
                                        {
                                            "type": "finally_clause",
                                            "label": "finally:\n        if lock.locked():\n            lock.release()",
                                            "start_token": 5488,
                                            "end_token": 5509,
                                            "children": [
                                                {
                                                    "type": "block",
                                                    "label": "if lock.locked():\n            lock.release()",
                                                    "start_token": 5493,
                                                    "end_token": 5509,
                                                    "children": [
                                                        {
                                                            "type": "if_statement",
                                                            "label": "if lock.locked():\n            lock.release()",
                                                            "start_token": 5493,
                                                            "end_token": 5509,
                                                            "children": [
                                                                {
                                                                    "type": "call",
                                                                    "label": "lock.locked()",
                                                                    "start_token": 5493,
                                                                    "end_token": 5499,
                                                                    "children": [
                                                                        {
                                                                            "type": "attribute",
                                                                            "label": "lock.locked",
                                                                            "start_token": 5493,
                                                                            "end_token": 5497,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "lock",
                                                                                    "start_token": 5493,
                                                                                    "end_token": 5495,
                                                                                    "children": []
                                                                                },
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "locked",
                                                                                    "start_token": 5495,
                                                                                    "end_token": 5497,
                                                                                    "children": []
                                                                                }
                                                                            ]
                                                                        },
                                                                        {
                                                                            "type": "argument_list",
                                                                            "label": "()",
                                                                            "start_token": 5498,
                                                                            "end_token": 5499,
                                                                            "children": []
                                                                        }
                                                                    ]
                                                                },
                                                                {
                                                                    "type": "block",
                                                                    "label": "lock.release()",
                                                                    "start_token": 5504,
                                                                    "end_token": 5509,
                                                                    "children": [
                                                                        {
                                                                            "type": "expression_statement",
                                                                            "label": "lock.release()",
                                                                            "start_token": 5504,
                                                                            "end_token": 5509,
                                                                            "children": [
                                                                                {
                                                                                    "type": "call",
                                                                                    "label": "lock.release()",
                                                                                    "start_token": 5504,
                                                                                    "end_token": 5509,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "attribute",
                                                                                            "label": "lock.release",
                                                                                            "start_token": 5504,
                                                                                            "end_token": 5507,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "label": "lock",
                                                                                                    "start_token": 5504,
                                                                                                    "end_token": 5504,
                                                                                                    "children": []
                                                                                                },
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "label": "release",
                                                                                                    "start_token": 5504,
                                                                                                    "end_token": 5507,
                                                                                                    "children": []
                                                                                                }
                                                                                            ]
                                                                                        },
                                                                                        {
                                                                                            "type": "argument_list",
                                                                                            "label": "()",
                                                                                            "start_token": 5508,
                                                                                            "end_token": 5509,
                                                                                            "children": []
                                                                                        }
                                                                                    ]
                                                                                }
                                                                            ]
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                }
                                            ]
                                        }
                                    ]
                                }
                            ]
                        }
                    ]
                }
            ]
        },
        {
            "type": "function_definition",
            "label": "def llprint(message: str):\n    \"\"\"\n    Low-level print/log helper function for use in signal handlers.\n    Regular log/print statements are not allowed in signal handlers.\n    \"\"\"\n    if logger.getEffectiveLevel() == logging.DEBUG:\n        os.write(sys.stdout.fileno(), (message + \"\\n\").encode())",
            "start_token": -1,
            "end_token": -1,
            "children": [
                {
                    "type": "identifier",
                    "label": "llprint",
                    "start_token": 5511,
                    "end_token": 5511,
                    "children": []
                },
                {
                    "type": "parameters",
                    "label": "(message: str)",
                    "start_token": 5511,
                    "end_token": 5511,
                    "children": [
                        {
                            "type": "typed_parameter",
                            "label": "message: str",
                            "start_token": 5511,
                            "end_token": 5511,
                            "children": [
                                {
                                    "type": "identifier",
                                    "label": "message",
                                    "start_token": 5511,
                                    "end_token": 5511,
                                    "children": []
                                },
                                {
                                    "type": "type",
                                    "label": "str",
                                    "start_token": 5511,
                                    "end_token": 5511,
                                    "children": [
                                        {
                                            "type": "identifier",
                                            "label": "str",
                                            "start_token": 5511,
                                            "end_token": 5511,
                                            "children": []
                                        }
                                    ]
                                }
                            ]
                        }
                    ]
                },
                {
                    "type": "block",
                    "label": "\"\"\"\n    Low-level print/log helper function for use in signal handlers.\n    Regular log/print statements are not allowed in signal handlers.\n    \"\"\"\n    if logger.getEffectiveLevel() == logging.DEBUG:\n        os.write(sys.stdout.fileno(), (message + \"\\n\").encode())",
                    "start_token": 5511,
                    "end_token": -1,
                    "children": [
                        {
                            "type": "expression_statement",
                            "label": "\"\"\"\n    Low-level print/log helper function for use in signal handlers.\n    Regular log/print statements are not allowed in signal handlers.\n    \"\"\"",
                            "start_token": 5511,
                            "end_token": 5517,
                            "children": [
                                {
                                    "type": "string",
                                    "label": "\"\"\"\n    Low-level print/log helper function for use in signal handlers.\n    Regular log/print statements are not allowed in signal handlers.\n    \"\"\"",
                                    "start_token": 5511,
                                    "end_token": 5517,
                                    "children": [
                                        {
                                            "type": "string_start",
                                            "label": "\"\"\"",
                                            "start_token": 5511,
                                            "end_token": 5511,
                                            "children": []
                                        },
                                        {
                                            "type": "string_content",
                                            "label": "\n    Low-level print/log helper function for use in signal handlers.\n    Regular log/print statements are not allowed in signal handlers.\n    ",
                                            "start_token": 5511,
                                            "end_token": 5517,
                                            "children": []
                                        },
                                        {
                                            "type": "string_end",
                                            "label": "\"\"\"",
                                            "start_token": 5517,
                                            "end_token": 5517,
                                            "children": []
                                        }
                                    ]
                                }
                            ]
                        },
                        {
                            "type": "if_statement",
                            "label": "if logger.getEffectiveLevel() == logging.DEBUG:\n        os.write(sys.stdout.fileno(), (message + \"\\n\").encode())",
                            "start_token": 5520,
                            "end_token": -1,
                            "children": [
                                {
                                    "type": "comparison_operator",
                                    "label": "logger.getEffectiveLevel() == logging.DEBUG",
                                    "start_token": 5522,
                                    "end_token": 5534,
                                    "children": [
                                        {
                                            "type": "call",
                                            "label": "logger.getEffectiveLevel()",
                                            "start_token": 5522,
                                            "end_token": 5528,
                                            "children": [
                                                {
                                                    "type": "attribute",
                                                    "label": "logger.getEffectiveLevel",
                                                    "start_token": 5522,
                                                    "end_token": 5527,
                                                    "children": [
                                                        {
                                                            "type": "identifier",
                                                            "label": "logger",
                                                            "start_token": 5522,
                                                            "end_token": 5522,
                                                            "children": []
                                                        },
                                                        {
                                                            "type": "identifier",
                                                            "label": "getEffectiveLevel",
                                                            "start_token": 5523,
                                                            "end_token": 5527,
                                                            "children": []
                                                        }
                                                    ]
                                                },
                                                {
                                                    "type": "argument_list",
                                                    "label": "()",
                                                    "start_token": 5527,
                                                    "end_token": 5528,
                                                    "children": []
                                                }
                                            ]
                                        },
                                        {
                                            "type": "attribute",
                                            "label": "logging.DEBUG",
                                            "start_token": 5529,
                                            "end_token": 5534,
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "label": "logging",
                                                    "start_token": 5529,
                                                    "end_token": 5533,
                                                    "children": []
                                                },
                                                {
                                                    "type": "identifier",
                                                    "label": "DEBUG",
                                                    "start_token": 5533,
                                                    "end_token": 5534,
                                                    "children": []
                                                }
                                            ]
                                        }
                                    ]
                                },
                                {
                                    "type": "block",
                                    "label": "os.write(sys.stdout.fileno(), (message + \"\\n\").encode())",
                                    "start_token": 5539,
                                    "end_token": -1,
                                    "children": [
                                        {
                                            "type": "expression_statement",
                                            "label": "os.write(sys.stdout.fileno(), (message + \"\\n\").encode())",
                                            "start_token": 5539,
                                            "end_token": -1,
                                            "children": [
                                                {
                                                    "type": "call",
                                                    "label": "os.write(sys.stdout.fileno(), (message + \"\\n\").encode())",
                                                    "start_token": 5539,
                                                    "end_token": -1,
                                                    "children": [
                                                        {
                                                            "type": "attribute",
                                                            "label": "os.write",
                                                            "start_token": 5539,
                                                            "end_token": 5540,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "label": "os",
                                                                    "start_token": 5539,
                                                                    "end_token": 5540,
                                                                    "children": []
                                                                },
                                                                {
                                                                    "type": "identifier",
                                                                    "label": "write",
                                                                    "start_token": 5540,
                                                                    "end_token": 5540,
                                                                    "children": []
                                                                }
                                                            ]
                                                        },
                                                        {
                                                            "type": "argument_list",
                                                            "label": "(sys.stdout.fileno(), (message + \"\\n\").encode())",
                                                            "start_token": -1,
                                                            "end_token": -1,
                                                            "children": [
                                                                {
                                                                    "type": "call",
                                                                    "label": "sys.stdout.fileno()",
                                                                    "start_token": 5541,
                                                                    "end_token": -1,
                                                                    "children": [
                                                                        {
                                                                            "type": "attribute",
                                                                            "label": "sys.stdout.fileno",
                                                                            "start_token": 5541,
                                                                            "end_token": 5548,
                                                                            "children": [
                                                                                {
                                                                                    "type": "attribute",
                                                                                    "label": "sys.stdout",
                                                                                    "start_token": 5541,
                                                                                    "end_token": 5545,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "label": "sys",
                                                                                            "start_token": 5541,
                                                                                            "end_token": 5542,
                                                                                            "children": []
                                                                                        },
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "label": "stdout",
                                                                                            "start_token": 5542,
                                                                                            "end_token": 5545,
                                                                                            "children": []
                                                                                        }
                                                                                    ]
                                                                                },
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "fileno",
                                                                                    "start_token": 5545,
                                                                                    "end_token": 5548,
                                                                                    "children": []
                                                                                }
                                                                            ]
                                                                        },
                                                                        {
                                                                            "type": "argument_list",
                                                                            "label": "()",
                                                                            "start_token": 5549,
                                                                            "end_token": -1,
                                                                            "children": []
                                                                        }
                                                                    ]
                                                                },
                                                                {
                                                                    "type": "call",
                                                                    "label": "(message + \"\\n\").encode()",
                                                                    "start_token": -1,
                                                                    "end_token": -1,
                                                                    "children": [
                                                                        {
                                                                            "type": "attribute",
                                                                            "label": "(message + \"\\n\").encode",
                                                                            "start_token": -1,
                                                                            "end_token": -1,
                                                                            "children": [
                                                                                {
                                                                                    "type": "parenthesized_expression",
                                                                                    "label": "(message + \"\\n\")",
                                                                                    "start_token": -1,
                                                                                    "end_token": -1,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "binary_operator",
                                                                                            "label": "message + \"\\n\"",
                                                                                            "start_token": -1,
                                                                                            "end_token": -1,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "label": "message",
                                                                                                    "start_token": -1,
                                                                                                    "end_token": -1,
                                                                                                    "children": []
                                                                                                },
                                                                                                {
                                                                                                    "type": "string",
                                                                                                    "label": "\"\\n\"",
                                                                                                    "start_token": -1,
                                                                                                    "end_token": -1,
                                                                                                    "children": [
                                                                                                        {
                                                                                                            "type": "string_start",
                                                                                                            "label": "\"",
                                                                                                            "start_token": -1,
                                                                                                            "end_token": -1,
                                                                                                            "children": []
                                                                                                        },
                                                                                                        {
                                                                                                            "type": "string_content",
                                                                                                            "label": "\\n",
                                                                                                            "start_token": -1,
                                                                                                            "end_token": -1,
                                                                                                            "children": [
                                                                                                                {
                                                                                                                    "type": "escape_sequence",
                                                                                                                    "label": "\\n",
                                                                                                                    "start_token": -1,
                                                                                                                    "end_token": -1,
                                                                                                                    "children": []
                                                                                                                }
                                                                                                            ]
                                                                                                        },
                                                                                                        {
                                                                                                            "type": "string_end",
                                                                                                            "label": "\"",
                                                                                                            "start_token": -1,
                                                                                                            "end_token": -1,
                                                                                                            "children": []
                                                                                                        }
                                                                                                    ]
                                                                                                }
                                                                                            ]
                                                                                        }
                                                                                    ]
                                                                                },
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "encode",
                                                                                    "start_token": -1,
                                                                                    "end_token": -1,
                                                                                    "children": []
                                                                                }
                                                                            ]
                                                                        },
                                                                        {
                                                                            "type": "argument_list",
                                                                            "label": "()",
                                                                            "start_token": -1,
                                                                            "end_token": -1,
                                                                            "children": []
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                }
                                            ]
                                        }
                                    ]
                                }
                            ]
                        }
                    ]
                }
            ]
        }
    ]
}
{
    "type": "module",
    "label": "from typing import Dict, Set\n\nfrom fastapi import WebSocket\n\nfrom backend.data import execution\nfrom backend.server.model import Methods, WsMessage\n\n\nclass ConnectionManager:\n    def __init__(self):\n        self.active_connections: Set[WebSocket] = set()\n        self.subscriptions: Dict[str, Set[WebSocket]] = {}\n\n    async def connect(self, websocket: WebSocket):\n        await websocket.accept()\n        self.active_connections.add(websocket)\n\n    def disconnect(self, websocket: WebSocket):\n        self.active_connections.remove(websocket)\n        for subscribers in self.subscriptions.values():\n            subscribers.discard(websocket)\n\n    async def subscribe(self, graph_id: str, websocket: WebSocket):\n        if graph_id not in self.subscriptions:\n            self.subscriptions[graph_id] = set()\n        self.subscriptions[graph_id].add(websocket)\n\n    async def unsubscribe(self, graph_id: str, websocket: WebSocket):\n        if graph_id in self.subscriptions:\n            self.subscriptions[graph_id].discard(websocket)\n            if not self.subscriptions[graph_id]:\n                del self.subscriptions[graph_id]\n\n    async def send_execution_result(self, result: execution.ExecutionResult):\n        graph_id = result.graph_id\n        if graph_id in self.subscriptions:\n            message = WsMessage(\n                method=Methods.EXECUTION_EVENT,\n                channel=graph_id,\n                data=result.model_dump(),\n            ).model_dump_json()\n            for connection in self.subscriptions[graph_id]:\n                await connection.send_text(message)\n",
    "children": [
        {
            "type": "import_from_statement",
            "label": "from typing import Dict, Set",
            "children": [
                {
                    "type": "dotted_name",
                    "label": "typing",
                    "children": [
                        {
                            "type": "identifier",
                            "label": "typing",
                            "children": []
                        }
                    ]
                },
                {
                    "type": "dotted_name",
                    "label": "Dict",
                    "children": [
                        {
                            "type": "identifier",
                            "label": "Dict",
                            "children": []
                        }
                    ]
                },
                {
                    "type": "dotted_name",
                    "label": "Set",
                    "children": [
                        {
                            "type": "identifier",
                            "label": "Set",
                            "children": []
                        }
                    ]
                }
            ]
        },
        {
            "type": "import_from_statement",
            "label": "from fastapi import WebSocket",
            "children": [
                {
                    "type": "dotted_name",
                    "label": "fastapi",
                    "children": [
                        {
                            "type": "identifier",
                            "label": "fastapi",
                            "children": []
                        }
                    ]
                },
                {
                    "type": "dotted_name",
                    "label": "WebSocket",
                    "children": [
                        {
                            "type": "identifier",
                            "label": "WebSocket",
                            "children": []
                        }
                    ]
                }
            ]
        },
        {
            "type": "import_from_statement",
            "label": "from backend.data import execution",
            "children": [
                {
                    "type": "dotted_name",
                    "label": "backend.data",
                    "children": [
                        {
                            "type": "identifier",
                            "label": "backend",
                            "children": []
                        },
                        {
                            "type": "identifier",
                            "label": "data",
                            "children": []
                        }
                    ]
                },
                {
                    "type": "dotted_name",
                    "label": "execution",
                    "children": [
                        {
                            "type": "identifier",
                            "label": "execution",
                            "children": []
                        }
                    ]
                }
            ]
        },
        {
            "type": "import_from_statement",
            "label": "from backend.server.model import Methods, WsMessage",
            "children": [
                {
                    "type": "dotted_name",
                    "label": "backend.server.model",
                    "children": [
                        {
                            "type": "identifier",
                            "label": "backend",
                            "children": []
                        },
                        {
                            "type": "identifier",
                            "label": "server",
                            "children": []
                        },
                        {
                            "type": "identifier",
                            "label": "model",
                            "children": []
                        }
                    ]
                },
                {
                    "type": "dotted_name",
                    "label": "Methods",
                    "children": [
                        {
                            "type": "identifier",
                            "label": "Methods",
                            "children": []
                        }
                    ]
                },
                {
                    "type": "dotted_name",
                    "label": "WsMessage",
                    "children": [
                        {
                            "type": "identifier",
                            "label": "WsMessage",
                            "children": []
                        }
                    ]
                }
            ]
        },
        {
            "type": "class_definition",
            "label": "class ConnectionManager:\n    def __init__(self):\n        self.active_connections: Set[WebSocket] = set()\n        self.subscriptions: Dict[str, Set[WebSocket]] = {}\n\n    async def connect(self, websocket: WebSocket):\n        await websocket.accept()\n        self.active_connections.add(websocket)\n\n    def disconnect(self, websocket: WebSocket):\n        self.active_connections.remove(websocket)\n        for subscribers in self.subscriptions.values():\n            subscribers.discard(websocket)\n\n    async def subscribe(self, graph_id: str, websocket: WebSocket):\n        if graph_id not in self.subscriptions:\n            self.subscriptions[graph_id] = set()\n        self.subscriptions[graph_id].add(websocket)\n\n    async def unsubscribe(self, graph_id: str, websocket: WebSocket):\n        if graph_id in self.subscriptions:\n            self.subscriptions[graph_id].discard(websocket)\n            if not self.subscriptions[graph_id]:\n                del self.subscriptions[graph_id]\n\n    async def send_execution_result(self, result: execution.ExecutionResult):\n        graph_id = result.graph_id\n        if graph_id in self.subscriptions:\n            message = WsMessage(\n                method=Methods.EXECUTION_EVENT,\n                channel=graph_id,\n                data=result.model_dump(),\n            ).model_dump_json()\n            for connection in self.subscriptions[graph_id]:\n                await connection.send_text(message)",
            "children": [
                {
                    "type": "identifier",
                    "label": "ConnectionManager",
                    "children": []
                },
                {
                    "type": "block",
                    "label": "def __init__(self):\n        self.active_connections: Set[WebSocket] = set()\n        self.subscriptions: Dict[str, Set[WebSocket]] = {}\n\n    async def connect(self, websocket: WebSocket):\n        await websocket.accept()\n        self.active_connections.add(websocket)\n\n    def disconnect(self, websocket: WebSocket):\n        self.active_connections.remove(websocket)\n        for subscribers in self.subscriptions.values():\n            subscribers.discard(websocket)\n\n    async def subscribe(self, graph_id: str, websocket: WebSocket):\n        if graph_id not in self.subscriptions:\n            self.subscriptions[graph_id] = set()\n        self.subscriptions[graph_id].add(websocket)\n\n    async def unsubscribe(self, graph_id: str, websocket: WebSocket):\n        if graph_id in self.subscriptions:\n            self.subscriptions[graph_id].discard(websocket)\n            if not self.subscriptions[graph_id]:\n                del self.subscriptions[graph_id]\n\n    async def send_execution_result(self, result: execution.ExecutionResult):\n        graph_id = result.graph_id\n        if graph_id in self.subscriptions:\n            message = WsMessage(\n                method=Methods.EXECUTION_EVENT,\n                channel=graph_id,\n                data=result.model_dump(),\n            ).model_dump_json()\n            for connection in self.subscriptions[graph_id]:\n                await connection.send_text(message)",
                    "children": [
                        {
                            "type": "function_definition",
                            "label": "def __init__(self):\n        self.active_connections: Set[WebSocket] = set()\n        self.subscriptions: Dict[str, Set[WebSocket]] = {}",
                            "children": [
                                {
                                    "type": "identifier",
                                    "label": "__init__",
                                    "children": []
                                },
                                {
                                    "type": "parameters",
                                    "label": "(self)",
                                    "children": [
                                        {
                                            "type": "identifier",
                                            "label": "self",
                                            "children": []
                                        }
                                    ]
                                },
                                {
                                    "type": "block",
                                    "label": "self.active_connections: Set[WebSocket] = set()\n        self.subscriptions: Dict[str, Set[WebSocket]] = {}",
                                    "children": [
                                        {
                                            "type": "expression_statement",
                                            "label": "self.active_connections: Set[WebSocket] = set()",
                                            "children": [
                                                {
                                                    "type": "assignment",
                                                    "label": "self.active_connections: Set[WebSocket] = set()",
                                                    "children": [
                                                        {
                                                            "type": "attribute",
                                                            "label": "self.active_connections",
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "label": "self",
                                                                    "children": []
                                                                },
                                                                {
                                                                    "type": "identifier",
                                                                    "label": "active_connections",
                                                                    "children": []
                                                                }
                                                            ]
                                                        },
                                                        {
                                                            "type": "type",
                                                            "label": "Set[WebSocket]",
                                                            "children": [
                                                                {
                                                                    "type": "generic_type",
                                                                    "label": "Set[WebSocket]",
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "Set",
                                                                            "children": []
                                                                        },
                                                                        {
                                                                            "type": "type_parameter",
                                                                            "label": "[WebSocket]",
                                                                            "children": [
                                                                                {
                                                                                    "type": "type",
                                                                                    "label": "WebSocket",
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "label": "WebSocket",
                                                                                            "children": []
                                                                                        }
                                                                                    ]
                                                                                }
                                                                            ]
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        },
                                                        {
                                                            "type": "call",
                                                            "label": "set()",
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "label": "set",
                                                                    "children": []
                                                                },
                                                                {
                                                                    "type": "argument_list",
                                                                    "label": "()",
                                                                    "children": []
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                }
                                            ]
                                        },
                                        {
                                            "type": "expression_statement",
                                            "label": "self.subscriptions: Dict[str, Set[WebSocket]] = {}",
                                            "children": [
                                                {
                                                    "type": "assignment",
                                                    "label": "self.subscriptions: Dict[str, Set[WebSocket]] = {}",
                                                    "children": [
                                                        {
                                                            "type": "attribute",
                                                            "label": "self.subscriptions",
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "label": "self",
                                                                    "children": []
                                                                },
                                                                {
                                                                    "type": "identifier",
                                                                    "label": "subscriptions",
                                                                    "children": []
                                                                }
                                                            ]
                                                        },
                                                        {
                                                            "type": "type",
                                                            "label": "Dict[str, Set[WebSocket]]",
                                                            "children": [
                                                                {
                                                                    "type": "generic_type",
                                                                    "label": "Dict[str, Set[WebSocket]]",
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "Dict",
                                                                            "children": []
                                                                        },
                                                                        {
                                                                            "type": "type_parameter",
                                                                            "label": "[str, Set[WebSocket]]",
                                                                            "children": [
                                                                                {
                                                                                    "type": "type",
                                                                                    "label": "str",
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "label": "str",
                                                                                            "children": []
                                                                                        }
                                                                                    ]
                                                                                },
                                                                                {
                                                                                    "type": "type",
                                                                                    "label": "Set[WebSocket]",
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "generic_type",
                                                                                            "label": "Set[WebSocket]",
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "label": "Set",
                                                                                                    "children": []
                                                                                                },
                                                                                                {
                                                                                                    "type": "type_parameter",
                                                                                                    "label": "[WebSocket]",
                                                                                                    "children": [
                                                                                                        {
                                                                                                            "type": "type",
                                                                                                            "label": "WebSocket",
                                                                                                            "children": [
                                                                                                                {
                                                                                                                    "type": "identifier",
                                                                                                                    "label": "WebSocket",
                                                                                                                    "children": []
                                                                                                                }
                                                                                                            ]
                                                                                                        }
                                                                                                    ]
                                                                                                }
                                                                                            ]
                                                                                        }
                                                                                    ]
                                                                                }
                                                                            ]
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        },
                                                        {
                                                            "type": "dictionary",
                                                            "label": "{}",
                                                            "children": []
                                                        }
                                                    ]
                                                }
                                            ]
                                        }
                                    ]
                                }
                            ]
                        },
                        {
                            "type": "function_definition",
                            "label": "async def connect(self, websocket: WebSocket):\n        await websocket.accept()\n        self.active_connections.add(websocket)",
                            "children": [
                                {
                                    "type": "identifier",
                                    "label": "connect",
                                    "children": []
                                },
                                {
                                    "type": "parameters",
                                    "label": "(self, websocket: WebSocket)",
                                    "children": [
                                        {
                                            "type": "identifier",
                                            "label": "self",
                                            "children": []
                                        },
                                        {
                                            "type": "typed_parameter",
                                            "label": "websocket: WebSocket",
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "label": "websocket",
                                                    "children": []
                                                },
                                                {
                                                    "type": "type",
                                                    "label": "WebSocket",
                                                    "children": [
                                                        {
                                                            "type": "identifier",
                                                            "label": "WebSocket",
                                                            "children": []
                                                        }
                                                    ]
                                                }
                                            ]
                                        }
                                    ]
                                },
                                {
                                    "type": "block",
                                    "label": "await websocket.accept()\n        self.active_connections.add(websocket)",
                                    "children": [
                                        {
                                            "type": "expression_statement",
                                            "label": "await websocket.accept()",
                                            "children": [
                                                {
                                                    "type": "await",
                                                    "label": "await websocket.accept()",
                                                    "children": [
                                                        {
                                                            "type": "call",
                                                            "label": "websocket.accept()",
                                                            "children": [
                                                                {
                                                                    "type": "attribute",
                                                                    "label": "websocket.accept",
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "websocket",
                                                                            "children": []
                                                                        },
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "accept",
                                                                            "children": []
                                                                        }
                                                                    ]
                                                                },
                                                                {
                                                                    "type": "argument_list",
                                                                    "label": "()",
                                                                    "children": []
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                }
                                            ]
                                        },
                                        {
                                            "type": "expression_statement",
                                            "label": "self.active_connections.add(websocket)",
                                            "children": [
                                                {
                                                    "type": "call",
                                                    "label": "self.active_connections.add(websocket)",
                                                    "children": [
                                                        {
                                                            "type": "attribute",
                                                            "label": "self.active_connections.add",
                                                            "children": [
                                                                {
                                                                    "type": "attribute",
                                                                    "label": "self.active_connections",
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "self",
                                                                            "children": []
                                                                        },
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "active_connections",
                                                                            "children": []
                                                                        }
                                                                    ]
                                                                },
                                                                {
                                                                    "type": "identifier",
                                                                    "label": "add",
                                                                    "children": []
                                                                }
                                                            ]
                                                        },
                                                        {
                                                            "type": "argument_list",
                                                            "label": "(websocket)",
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "label": "websocket",
                                                                    "children": []
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                }
                                            ]
                                        }
                                    ]
                                }
                            ]
                        },
                        {
                            "type": "function_definition",
                            "label": "def disconnect(self, websocket: WebSocket):\n        self.active_connections.remove(websocket)\n        for subscribers in self.subscriptions.values():\n            subscribers.discard(websocket)",
                            "children": [
                                {
                                    "type": "identifier",
                                    "label": "disconnect",
                                    "children": []
                                },
                                {
                                    "type": "parameters",
                                    "label": "(self, websocket: WebSocket)",
                                    "children": [
                                        {
                                            "type": "identifier",
                                            "label": "self",
                                            "children": []
                                        },
                                        {
                                            "type": "typed_parameter",
                                            "label": "websocket: WebSocket",
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "label": "websocket",
                                                    "children": []
                                                },
                                                {
                                                    "type": "type",
                                                    "label": "WebSocket",
                                                    "children": [
                                                        {
                                                            "type": "identifier",
                                                            "label": "WebSocket",
                                                            "children": []
                                                        }
                                                    ]
                                                }
                                            ]
                                        }
                                    ]
                                },
                                {
                                    "type": "block",
                                    "label": "self.active_connections.remove(websocket)\n        for subscribers in self.subscriptions.values():\n            subscribers.discard(websocket)",
                                    "children": [
                                        {
                                            "type": "expression_statement",
                                            "label": "self.active_connections.remove(websocket)",
                                            "children": [
                                                {
                                                    "type": "call",
                                                    "label": "self.active_connections.remove(websocket)",
                                                    "children": [
                                                        {
                                                            "type": "attribute",
                                                            "label": "self.active_connections.remove",
                                                            "children": [
                                                                {
                                                                    "type": "attribute",
                                                                    "label": "self.active_connections",
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "self",
                                                                            "children": []
                                                                        },
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "active_connections",
                                                                            "children": []
                                                                        }
                                                                    ]
                                                                },
                                                                {
                                                                    "type": "identifier",
                                                                    "label": "remove",
                                                                    "children": []
                                                                }
                                                            ]
                                                        },
                                                        {
                                                            "type": "argument_list",
                                                            "label": "(websocket)",
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "label": "websocket",
                                                                    "children": []
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                }
                                            ]
                                        },
                                        {
                                            "type": "for_statement",
                                            "label": "for subscribers in self.subscriptions.values():\n            subscribers.discard(websocket)",
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "label": "subscribers",
                                                    "children": []
                                                },
                                                {
                                                    "type": "call",
                                                    "label": "self.subscriptions.values()",
                                                    "children": [
                                                        {
                                                            "type": "attribute",
                                                            "label": "self.subscriptions.values",
                                                            "children": [
                                                                {
                                                                    "type": "attribute",
                                                                    "label": "self.subscriptions",
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "self",
                                                                            "children": []
                                                                        },
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "subscriptions",
                                                                            "children": []
                                                                        }
                                                                    ]
                                                                },
                                                                {
                                                                    "type": "identifier",
                                                                    "label": "values",
                                                                    "children": []
                                                                }
                                                            ]
                                                        },
                                                        {
                                                            "type": "argument_list",
                                                            "label": "()",
                                                            "children": []
                                                        }
                                                    ]
                                                },
                                                {
                                                    "type": "block",
                                                    "label": "subscribers.discard(websocket)",
                                                    "children": [
                                                        {
                                                            "type": "expression_statement",
                                                            "label": "subscribers.discard(websocket)",
                                                            "children": [
                                                                {
                                                                    "type": "call",
                                                                    "label": "subscribers.discard(websocket)",
                                                                    "children": [
                                                                        {
                                                                            "type": "attribute",
                                                                            "label": "subscribers.discard",
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "subscribers",
                                                                                    "children": []
                                                                                },
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "discard",
                                                                                    "children": []
                                                                                }
                                                                            ]
                                                                        },
                                                                        {
                                                                            "type": "argument_list",
                                                                            "label": "(websocket)",
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "websocket",
                                                                                    "children": []
                                                                                }
                                                                            ]
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                }
                                            ]
                                        }
                                    ]
                                }
                            ]
                        },
                        {
                            "type": "function_definition",
                            "label": "async def subscribe(self, graph_id: str, websocket: WebSocket):\n        if graph_id not in self.subscriptions:\n            self.subscriptions[graph_id] = set()\n        self.subscriptions[graph_id].add(websocket)",
                            "children": [
                                {
                                    "type": "identifier",
                                    "label": "subscribe",
                                    "children": []
                                },
                                {
                                    "type": "parameters",
                                    "label": "(self, graph_id: str, websocket: WebSocket)",
                                    "children": [
                                        {
                                            "type": "identifier",
                                            "label": "self",
                                            "children": []
                                        },
                                        {
                                            "type": "typed_parameter",
                                            "label": "graph_id: str",
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "label": "graph_id",
                                                    "children": []
                                                },
                                                {
                                                    "type": "type",
                                                    "label": "str",
                                                    "children": [
                                                        {
                                                            "type": "identifier",
                                                            "label": "str",
                                                            "children": []
                                                        }
                                                    ]
                                                }
                                            ]
                                        },
                                        {
                                            "type": "typed_parameter",
                                            "label": "websocket: WebSocket",
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "label": "websocket",
                                                    "children": []
                                                },
                                                {
                                                    "type": "type",
                                                    "label": "WebSocket",
                                                    "children": [
                                                        {
                                                            "type": "identifier",
                                                            "label": "WebSocket",
                                                            "children": []
                                                        }
                                                    ]
                                                }
                                            ]
                                        }
                                    ]
                                },
                                {
                                    "type": "block",
                                    "label": "if graph_id not in self.subscriptions:\n            self.subscriptions[graph_id] = set()\n        self.subscriptions[graph_id].add(websocket)",
                                    "children": [
                                        {
                                            "type": "if_statement",
                                            "label": "if graph_id not in self.subscriptions:\n            self.subscriptions[graph_id] = set()",
                                            "children": [
                                                {
                                                    "type": "comparison_operator",
                                                    "label": "graph_id not in self.subscriptions",
                                                    "children": [
                                                        {
                                                            "type": "identifier",
                                                            "label": "graph_id",
                                                            "children": []
                                                        },
                                                        {
                                                            "type": "attribute",
                                                            "label": "self.subscriptions",
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "label": "self",
                                                                    "children": []
                                                                },
                                                                {
                                                                    "type": "identifier",
                                                                    "label": "subscriptions",
                                                                    "children": []
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                },
                                                {
                                                    "type": "block",
                                                    "label": "self.subscriptions[graph_id] = set()",
                                                    "children": [
                                                        {
                                                            "type": "expression_statement",
                                                            "label": "self.subscriptions[graph_id] = set()",
                                                            "children": [
                                                                {
                                                                    "type": "assignment",
                                                                    "label": "self.subscriptions[graph_id] = set()",
                                                                    "children": [
                                                                        {
                                                                            "type": "subscript",
                                                                            "label": "self.subscriptions[graph_id]",
                                                                            "children": [
                                                                                {
                                                                                    "type": "attribute",
                                                                                    "label": "self.subscriptions",
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "label": "self",
                                                                                            "children": []
                                                                                        },
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "label": "subscriptions",
                                                                                            "children": []
                                                                                        }
                                                                                    ]
                                                                                },
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "graph_id",
                                                                                    "children": []
                                                                                }
                                                                            ]
                                                                        },
                                                                        {
                                                                            "type": "call",
                                                                            "label": "set()",
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "set",
                                                                                    "children": []
                                                                                },
                                                                                {
                                                                                    "type": "argument_list",
                                                                                    "label": "()",
                                                                                    "children": []
                                                                                }
                                                                            ]
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                }
                                            ]
                                        },
                                        {
                                            "type": "expression_statement",
                                            "label": "self.subscriptions[graph_id].add(websocket)",
                                            "children": [
                                                {
                                                    "type": "call",
                                                    "label": "self.subscriptions[graph_id].add(websocket)",
                                                    "children": [
                                                        {
                                                            "type": "attribute",
                                                            "label": "self.subscriptions[graph_id].add",
                                                            "children": [
                                                                {
                                                                    "type": "subscript",
                                                                    "label": "self.subscriptions[graph_id]",
                                                                    "children": [
                                                                        {
                                                                            "type": "attribute",
                                                                            "label": "self.subscriptions",
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "self",
                                                                                    "children": []
                                                                                },
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "subscriptions",
                                                                                    "children": []
                                                                                }
                                                                            ]
                                                                        },
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "graph_id",
                                                                            "children": []
                                                                        }
                                                                    ]
                                                                },
                                                                {
                                                                    "type": "identifier",
                                                                    "label": "add",
                                                                    "children": []
                                                                }
                                                            ]
                                                        },
                                                        {
                                                            "type": "argument_list",
                                                            "label": "(websocket)",
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "label": "websocket",
                                                                    "children": []
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                }
                                            ]
                                        }
                                    ]
                                }
                            ]
                        },
                        {
                            "type": "function_definition",
                            "label": "async def unsubscribe(self, graph_id: str, websocket: WebSocket):\n        if graph_id in self.subscriptions:\n            self.subscriptions[graph_id].discard(websocket)\n            if not self.subscriptions[graph_id]:\n                del self.subscriptions[graph_id]",
                            "children": [
                                {
                                    "type": "identifier",
                                    "label": "unsubscribe",
                                    "children": []
                                },
                                {
                                    "type": "parameters",
                                    "label": "(self, graph_id: str, websocket: WebSocket)",
                                    "children": [
                                        {
                                            "type": "identifier",
                                            "label": "self",
                                            "children": []
                                        },
                                        {
                                            "type": "typed_parameter",
                                            "label": "graph_id: str",
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "label": "graph_id",
                                                    "children": []
                                                },
                                                {
                                                    "type": "type",
                                                    "label": "str",
                                                    "children": [
                                                        {
                                                            "type": "identifier",
                                                            "label": "str",
                                                            "children": []
                                                        }
                                                    ]
                                                }
                                            ]
                                        },
                                        {
                                            "type": "typed_parameter",
                                            "label": "websocket: WebSocket",
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "label": "websocket",
                                                    "children": []
                                                },
                                                {
                                                    "type": "type",
                                                    "label": "WebSocket",
                                                    "children": [
                                                        {
                                                            "type": "identifier",
                                                            "label": "WebSocket",
                                                            "children": []
                                                        }
                                                    ]
                                                }
                                            ]
                                        }
                                    ]
                                },
                                {
                                    "type": "block",
                                    "label": "if graph_id in self.subscriptions:\n            self.subscriptions[graph_id].discard(websocket)\n            if not self.subscriptions[graph_id]:\n                del self.subscriptions[graph_id]",
                                    "children": [
                                        {
                                            "type": "if_statement",
                                            "label": "if graph_id in self.subscriptions:\n            self.subscriptions[graph_id].discard(websocket)\n            if not self.subscriptions[graph_id]:\n                del self.subscriptions[graph_id]",
                                            "children": [
                                                {
                                                    "type": "comparison_operator",
                                                    "label": "graph_id in self.subscriptions",
                                                    "children": [
                                                        {
                                                            "type": "identifier",
                                                            "label": "graph_id",
                                                            "children": []
                                                        },
                                                        {
                                                            "type": "attribute",
                                                            "label": "self.subscriptions",
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "label": "self",
                                                                    "children": []
                                                                },
                                                                {
                                                                    "type": "identifier",
                                                                    "label": "subscriptions",
                                                                    "children": []
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                },
                                                {
                                                    "type": "block",
                                                    "label": "self.subscriptions[graph_id].discard(websocket)\n            if not self.subscriptions[graph_id]:\n                del self.subscriptions[graph_id]",
                                                    "children": [
                                                        {
                                                            "type": "expression_statement",
                                                            "label": "self.subscriptions[graph_id].discard(websocket)",
                                                            "children": [
                                                                {
                                                                    "type": "call",
                                                                    "label": "self.subscriptions[graph_id].discard(websocket)",
                                                                    "children": [
                                                                        {
                                                                            "type": "attribute",
                                                                            "label": "self.subscriptions[graph_id].discard",
                                                                            "children": [
                                                                                {
                                                                                    "type": "subscript",
                                                                                    "label": "self.subscriptions[graph_id]",
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "attribute",
                                                                                            "label": "self.subscriptions",
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "label": "self",
                                                                                                    "children": []
                                                                                                },
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "label": "subscriptions",
                                                                                                    "children": []
                                                                                                }
                                                                                            ]
                                                                                        },
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "label": "graph_id",
                                                                                            "children": []
                                                                                        }
                                                                                    ]
                                                                                },
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "discard",
                                                                                    "children": []
                                                                                }
                                                                            ]
                                                                        },
                                                                        {
                                                                            "type": "argument_list",
                                                                            "label": "(websocket)",
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "websocket",
                                                                                    "children": []
                                                                                }
                                                                            ]
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        },
                                                        {
                                                            "type": "if_statement",
                                                            "label": "if not self.subscriptions[graph_id]:\n                del self.subscriptions[graph_id]",
                                                            "children": [
                                                                {
                                                                    "type": "not_operator",
                                                                    "label": "not self.subscriptions[graph_id]",
                                                                    "children": [
                                                                        {
                                                                            "type": "subscript",
                                                                            "label": "self.subscriptions[graph_id]",
                                                                            "children": [
                                                                                {
                                                                                    "type": "attribute",
                                                                                    "label": "self.subscriptions",
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "label": "self",
                                                                                            "children": []
                                                                                        },
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "label": "subscriptions",
                                                                                            "children": []
                                                                                        }
                                                                                    ]
                                                                                },
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "graph_id",
                                                                                    "children": []
                                                                                }
                                                                            ]
                                                                        }
                                                                    ]
                                                                },
                                                                {
                                                                    "type": "block",
                                                                    "label": "del self.subscriptions[graph_id]",
                                                                    "children": [
                                                                        {
                                                                            "type": "delete_statement",
                                                                            "label": "del self.subscriptions[graph_id]",
                                                                            "children": [
                                                                                {
                                                                                    "type": "subscript",
                                                                                    "label": "self.subscriptions[graph_id]",
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "attribute",
                                                                                            "label": "self.subscriptions",
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "label": "self",
                                                                                                    "children": []
                                                                                                },
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "label": "subscriptions",
                                                                                                    "children": []
                                                                                                }
                                                                                            ]
                                                                                        },
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "label": "graph_id",
                                                                                            "children": []
                                                                                        }
                                                                                    ]
                                                                                }
                                                                            ]
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                }
                                            ]
                                        }
                                    ]
                                }
                            ]
                        },
                        {
                            "type": "function_definition",
                            "label": "async def send_execution_result(self, result: execution.ExecutionResult):\n        graph_id = result.graph_id\n        if graph_id in self.subscriptions:\n            message = WsMessage(\n                method=Methods.EXECUTION_EVENT,\n                channel=graph_id,\n                data=result.model_dump(),\n            ).model_dump_json()\n            for connection in self.subscriptions[graph_id]:\n                await connection.send_text(message)",
                            "children": [
                                {
                                    "type": "identifier",
                                    "label": "send_execution_result",
                                    "children": []
                                },
                                {
                                    "type": "parameters",
                                    "label": "(self, result: execution.ExecutionResult)",
                                    "children": [
                                        {
                                            "type": "identifier",
                                            "label": "self",
                                            "children": []
                                        },
                                        {
                                            "type": "typed_parameter",
                                            "label": "result: execution.ExecutionResult",
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "label": "result",
                                                    "children": []
                                                },
                                                {
                                                    "type": "type",
                                                    "label": "execution.ExecutionResult",
                                                    "children": [
                                                        {
                                                            "type": "attribute",
                                                            "label": "execution.ExecutionResult",
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "label": "execution",
                                                                    "children": []
                                                                },
                                                                {
                                                                    "type": "identifier",
                                                                    "label": "ExecutionResult",
                                                                    "children": []
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                }
                                            ]
                                        }
                                    ]
                                },
                                {
                                    "type": "block",
                                    "label": "graph_id = result.graph_id\n        if graph_id in self.subscriptions:\n            message = WsMessage(\n                method=Methods.EXECUTION_EVENT,\n                channel=graph_id,\n                data=result.model_dump(),\n            ).model_dump_json()\n            for connection in self.subscriptions[graph_id]:\n                await connection.send_text(message)",
                                    "children": [
                                        {
                                            "type": "expression_statement",
                                            "label": "graph_id = result.graph_id",
                                            "children": [
                                                {
                                                    "type": "assignment",
                                                    "label": "graph_id = result.graph_id",
                                                    "children": [
                                                        {
                                                            "type": "identifier",
                                                            "label": "graph_id",
                                                            "children": []
                                                        },
                                                        {
                                                            "type": "attribute",
                                                            "label": "result.graph_id",
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "label": "result",
                                                                    "children": []
                                                                },
                                                                {
                                                                    "type": "identifier",
                                                                    "label": "graph_id",
                                                                    "children": []
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                }
                                            ]
                                        },
                                        {
                                            "type": "if_statement",
                                            "label": "if graph_id in self.subscriptions:\n            message = WsMessage(\n                method=Methods.EXECUTION_EVENT,\n                channel=graph_id,\n                data=result.model_dump(),\n            ).model_dump_json()\n            for connection in self.subscriptions[graph_id]:\n                await connection.send_text(message)",
                                            "children": [
                                                {
                                                    "type": "comparison_operator",
                                                    "label": "graph_id in self.subscriptions",
                                                    "children": [
                                                        {
                                                            "type": "identifier",
                                                            "label": "graph_id",
                                                            "children": []
                                                        },
                                                        {
                                                            "type": "attribute",
                                                            "label": "self.subscriptions",
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "label": "self",
                                                                    "children": []
                                                                },
                                                                {
                                                                    "type": "identifier",
                                                                    "label": "subscriptions",
                                                                    "children": []
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                },
                                                {
                                                    "type": "block",
                                                    "label": "message = WsMessage(\n                method=Methods.EXECUTION_EVENT,\n                channel=graph_id,\n                data=result.model_dump(),\n            ).model_dump_json()\n            for connection in self.subscriptions[graph_id]:\n                await connection.send_text(message)",
                                                    "children": [
                                                        {
                                                            "type": "expression_statement",
                                                            "label": "message = WsMessage(\n                method=Methods.EXECUTION_EVENT,\n                channel=graph_id,\n                data=result.model_dump(),\n            ).model_dump_json()",
                                                            "children": [
                                                                {
                                                                    "type": "assignment",
                                                                    "label": "message = WsMessage(\n                method=Methods.EXECUTION_EVENT,\n                channel=graph_id,\n                data=result.model_dump(),\n            ).model_dump_json()",
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "message",
                                                                            "children": []
                                                                        },
                                                                        {
                                                                            "type": "call",
                                                                            "label": "WsMessage(\n                method=Methods.EXECUTION_EVENT,\n                channel=graph_id,\n                data=result.model_dump(),\n            ).model_dump_json()",
                                                                            "children": [
                                                                                {
                                                                                    "type": "attribute",
                                                                                    "label": "WsMessage(\n                method=Methods.EXECUTION_EVENT,\n                channel=graph_id,\n                data=result.model_dump(),\n            ).model_dump_json",
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "call",
                                                                                            "label": "WsMessage(\n                method=Methods.EXECUTION_EVENT,\n                channel=graph_id,\n                data=result.model_dump(),\n            )",
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "label": "WsMessage",
                                                                                                    "children": []
                                                                                                },
                                                                                                {
                                                                                                    "type": "argument_list",
                                                                                                    "label": "(\n                method=Methods.EXECUTION_EVENT,\n                channel=graph_id,\n                data=result.model_dump(),\n            )",
                                                                                                    "children": [
                                                                                                        {
                                                                                                            "type": "keyword_argument",
                                                                                                            "label": "method=Methods.EXECUTION_EVENT",
                                                                                                            "children": [
                                                                                                                {
                                                                                                                    "type": "identifier",
                                                                                                                    "label": "method",
                                                                                                                    "children": []
                                                                                                                },
                                                                                                                {
                                                                                                                    "type": "attribute",
                                                                                                                    "label": "Methods.EXECUTION_EVENT",
                                                                                                                    "children": [
                                                                                                                        {
                                                                                                                            "type": "identifier",
                                                                                                                            "label": "Methods",
                                                                                                                            "children": []
                                                                                                                        },
                                                                                                                        {
                                                                                                                            "type": "identifier",
                                                                                                                            "label": "EXECUTION_EVENT",
                                                                                                                            "children": []
                                                                                                                        }
                                                                                                                    ]
                                                                                                                }
                                                                                                            ]
                                                                                                        },
                                                                                                        {
                                                                                                            "type": "keyword_argument",
                                                                                                            "label": "channel=graph_id",
                                                                                                            "children": [
                                                                                                                {
                                                                                                                    "type": "identifier",
                                                                                                                    "label": "channel",
                                                                                                                    "children": []
                                                                                                                },
                                                                                                                {
                                                                                                                    "type": "identifier",
                                                                                                                    "label": "graph_id",
                                                                                                                    "children": []
                                                                                                                }
                                                                                                            ]
                                                                                                        },
                                                                                                        {
                                                                                                            "type": "keyword_argument",
                                                                                                            "label": "data=result.model_dump()",
                                                                                                            "children": [
                                                                                                                {
                                                                                                                    "type": "identifier",
                                                                                                                    "label": "data",
                                                                                                                    "children": []
                                                                                                                },
                                                                                                                {
                                                                                                                    "type": "call",
                                                                                                                    "label": "result.model_dump()",
                                                                                                                    "children": [
                                                                                                                        {
                                                                                                                            "type": "attribute",
                                                                                                                            "label": "result.model_dump",
                                                                                                                            "children": [
                                                                                                                                {
                                                                                                                                    "type": "identifier",
                                                                                                                                    "label": "result",
                                                                                                                                    "children": []
                                                                                                                                },
                                                                                                                                {
                                                                                                                                    "type": "identifier",
                                                                                                                                    "label": "model_dump",
                                                                                                                                    "children": []
                                                                                                                                }
                                                                                                                            ]
                                                                                                                        },
                                                                                                                        {
                                                                                                                            "type": "argument_list",
                                                                                                                            "label": "()",
                                                                                                                            "children": []
                                                                                                                        }
                                                                                                                    ]
                                                                                                                }
                                                                                                            ]
                                                                                                        }
                                                                                                    ]
                                                                                                }
                                                                                            ]
                                                                                        },
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "label": "model_dump_json",
                                                                                            "children": []
                                                                                        }
                                                                                    ]
                                                                                },
                                                                                {
                                                                                    "type": "argument_list",
                                                                                    "label": "()",
                                                                                    "children": []
                                                                                }
                                                                            ]
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        },
                                                        {
                                                            "type": "for_statement",
                                                            "label": "for connection in self.subscriptions[graph_id]:\n                await connection.send_text(message)",
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "label": "connection",
                                                                    "children": []
                                                                },
                                                                {
                                                                    "type": "subscript",
                                                                    "label": "self.subscriptions[graph_id]",
                                                                    "children": [
                                                                        {
                                                                            "type": "attribute",
                                                                            "label": "self.subscriptions",
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "self",
                                                                                    "children": []
                                                                                },
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "subscriptions",
                                                                                    "children": []
                                                                                }
                                                                            ]
                                                                        },
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "graph_id",
                                                                            "children": []
                                                                        }
                                                                    ]
                                                                },
                                                                {
                                                                    "type": "block",
                                                                    "label": "await connection.send_text(message)",
                                                                    "children": [
                                                                        {
                                                                            "type": "expression_statement",
                                                                            "label": "await connection.send_text(message)",
                                                                            "children": [
                                                                                {
                                                                                    "type": "await",
                                                                                    "label": "await connection.send_text(message)",
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "call",
                                                                                            "label": "connection.send_text(message)",
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "attribute",
                                                                                                    "label": "connection.send_text",
                                                                                                    "children": [
                                                                                                        {
                                                                                                            "type": "identifier",
                                                                                                            "label": "connection",
                                                                                                            "children": []
                                                                                                        },
                                                                                                        {
                                                                                                            "type": "identifier",
                                                                                                            "label": "send_text",
                                                                                                            "children": []
                                                                                                        }
                                                                                                    ]
                                                                                                },
                                                                                                {
                                                                                                    "type": "argument_list",
                                                                                                    "label": "(message)",
                                                                                                    "children": [
                                                                                                        {
                                                                                                            "type": "identifier",
                                                                                                            "label": "message",
                                                                                                            "children": []
                                                                                                        }
                                                                                                    ]
                                                                                                }
                                                                                            ]
                                                                                        }
                                                                                    ]
                                                                                }
                                                                            ]
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                }
                                            ]
                                        }
                                    ]
                                }
                            ]
                        }
                    ]
                }
            ]
        }
    ]
}
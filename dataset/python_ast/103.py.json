{
    "type": "module",
    "label": "import secrets\nfrom datetime import datetime, timedelta, timezone\nfrom typing import TYPE_CHECKING\n\nfrom pydantic import SecretStr\n\nif TYPE_CHECKING:\n    from backend.executor.database import DatabaseManager\n\nfrom autogpt_libs.utils.cache import thread_cached\nfrom autogpt_libs.utils.synchronize import RedisKeyedMutex\n\nfrom backend.data.model import (\n    APIKeyCredentials,\n    Credentials,\n    OAuth2Credentials,\n    OAuthState,\n    UserIntegrations,\n)\nfrom backend.util.settings import Settings\n\nsettings = Settings()\n\nrevid_credentials = APIKeyCredentials(\n    id=\"fdb7f412-f519-48d1-9b5f-d2f73d0e01fe\",\n    provider=\"revid\",\n    api_key=SecretStr(settings.secrets.revid_api_key),\n    title=\"Use Credits for Revid\",\n    expires_at=None,\n)\nideogram_credentials = APIKeyCredentials(\n    id=\"760f84fc-b270-42de-91f6-08efe1b512d0\",\n    provider=\"ideogram\",\n    api_key=SecretStr(settings.secrets.ideogram_api_key),\n    title=\"Use Credits for Ideogram\",\n    expires_at=None,\n)\nreplicate_credentials = APIKeyCredentials(\n    id=\"6b9fc200-4726-4973-86c9-cd526f5ce5db\",\n    provider=\"replicate\",\n    api_key=SecretStr(settings.secrets.replicate_api_key),\n    title=\"Use Credits for Replicate\",\n    expires_at=None,\n)\nopenai_credentials = APIKeyCredentials(\n    id=\"53c25cb8-e3ee-465c-a4d1-e75a4c899c2a\",\n    provider=\"openai\",\n    api_key=SecretStr(settings.secrets.openai_api_key),\n    title=\"Use Credits for OpenAI\",\n    expires_at=None,\n)\nanthropic_credentials = APIKeyCredentials(\n    id=\"24e5d942-d9e3-4798-8151-90143ee55629\",\n    provider=\"anthropic\",\n    api_key=SecretStr(settings.secrets.anthropic_api_key),\n    title=\"Use Credits for Anthropic\",\n    expires_at=None,\n)\ngroq_credentials = APIKeyCredentials(\n    id=\"4ec22295-8f97-4dd1-b42b-2c6957a02545\",\n    provider=\"groq\",\n    api_key=SecretStr(settings.secrets.groq_api_key),\n    title=\"Use Credits for Groq\",\n    expires_at=None,\n)\ndid_credentials = APIKeyCredentials(\n    id=\"7f7b0654-c36b-4565-8fa7-9a52575dfae2\",\n    provider=\"d_id\",\n    api_key=SecretStr(settings.secrets.did_api_key),\n    title=\"Use Credits for D-ID\",\n    expires_at=None,\n)\njina_credentials = APIKeyCredentials(\n    id=\"7f26de70-ba0d-494e-ba76-238e65e7b45f\",\n    provider=\"jina\",\n    api_key=SecretStr(settings.secrets.jina_api_key),\n    title=\"Use Credits for Jina\",\n    expires_at=None,\n)\nunreal_credentials = APIKeyCredentials(\n    id=\"66f20754-1b81-48e4-91d0-f4f0dd82145f\",\n    provider=\"unreal\",\n    api_key=SecretStr(settings.secrets.unreal_speech_api_key),\n    title=\"Use Credits for Unreal\",\n    expires_at=None,\n)\nopen_router_credentials = APIKeyCredentials(\n    id=\"b5a0e27d-0c98-4df3-a4b9-10193e1f3c40\",\n    provider=\"open_router\",\n    api_key=SecretStr(settings.secrets.open_router_api_key),\n    title=\"Use Credits for Open Router\",\n    expires_at=None,\n)\n\n\nDEFAULT_CREDENTIALS = [\n    revid_credentials,\n    ideogram_credentials,\n    replicate_credentials,\n    openai_credentials,\n    anthropic_credentials,\n    groq_credentials,\n    did_credentials,\n    jina_credentials,\n    unreal_credentials,\n    open_router_credentials,\n]\n\n\nclass IntegrationCredentialsStore:\n    def __init__(self):\n        from backend.data.redis import get_redis\n\n        self.locks = RedisKeyedMutex(get_redis())\n\n    @property\n    @thread_cached\n    def db_manager(self) -> \"DatabaseManager\":\n        from backend.executor.database import DatabaseManager\n        from backend.util.service import get_service_client\n\n        return get_service_client(DatabaseManager)\n\n    def add_creds(self, user_id: str, credentials: Credentials) -> None:\n        with self.locked_user_integrations(user_id):\n            if self.get_creds_by_id(user_id, credentials.id):\n                raise ValueError(\n                    f\"Can not re-create existing credentials #{credentials.id} \"\n                    f\"for user #{user_id}\"\n                )\n            self._set_user_integration_creds(\n                user_id, [*self.get_all_creds(user_id), credentials]\n            )\n\n    def get_all_creds(self, user_id: str) -> list[Credentials]:\n        users_credentials = self._get_user_integrations(user_id).credentials\n        all_credentials = users_credentials\n        if settings.secrets.revid_api_key:\n            all_credentials.append(revid_credentials)\n        if settings.secrets.ideogram_api_key:\n            all_credentials.append(ideogram_credentials)\n        if settings.secrets.groq_api_key:\n            all_credentials.append(groq_credentials)\n        if settings.secrets.replicate_api_key:\n            all_credentials.append(replicate_credentials)\n        if settings.secrets.openai_api_key:\n            all_credentials.append(openai_credentials)\n        if settings.secrets.anthropic_api_key:\n            all_credentials.append(anthropic_credentials)\n        if settings.secrets.did_api_key:\n            all_credentials.append(did_credentials)\n        if settings.secrets.jina_api_key:\n            all_credentials.append(jina_credentials)\n        if settings.secrets.unreal_speech_api_key:\n            all_credentials.append(unreal_credentials)\n        if settings.secrets.open_router_api_key:\n            all_credentials.append(open_router_credentials)\n        return all_credentials\n\n    def get_creds_by_id(self, user_id: str, credentials_id: str) -> Credentials | None:\n        all_credentials = self.get_all_creds(user_id)\n        return next((c for c in all_credentials if c.id == credentials_id), None)\n\n    def get_creds_by_provider(self, user_id: str, provider: str) -> list[Credentials]:\n        credentials = self.get_all_creds(user_id)\n        return [c for c in credentials if c.provider == provider]\n\n    def get_authorized_providers(self, user_id: str) -> list[str]:\n        credentials = self.get_all_creds(user_id)\n        return list(set(c.provider for c in credentials))\n\n    def update_creds(self, user_id: str, updated: Credentials) -> None:\n        with self.locked_user_integrations(user_id):\n            current = self.get_creds_by_id(user_id, updated.id)\n            if not current:\n                raise ValueError(\n                    f\"Credentials with ID {updated.id} \"\n                    f\"for user with ID {user_id} not found\"\n                )\n            if type(current) is not type(updated):\n                raise TypeError(\n                    f\"Can not update credentials with ID {updated.id} \"\n                    f\"from type {type(current)} \"\n                    f\"to type {type(updated)}\"\n                )\n\n            # Ensure no scopes are removed when updating credentials\n            if (\n                isinstance(updated, OAuth2Credentials)\n                and isinstance(current, OAuth2Credentials)\n                and not set(updated.scopes).issuperset(current.scopes)\n            ):\n                raise ValueError(\n                    f\"Can not update credentials with ID {updated.id} \"\n                    f\"and scopes {current.scopes} \"\n                    f\"to more restrictive set of scopes {updated.scopes}\"\n                )\n\n            # Update the credentials\n            updated_credentials_list = [\n                updated if c.id == updated.id else c\n                for c in self.get_all_creds(user_id)\n            ]\n            self._set_user_integration_creds(user_id, updated_credentials_list)\n\n    def delete_creds_by_id(self, user_id: str, credentials_id: str) -> None:\n        with self.locked_user_integrations(user_id):\n            filtered_credentials = [\n                c for c in self.get_all_creds(user_id) if c.id != credentials_id\n            ]\n            self._set_user_integration_creds(user_id, filtered_credentials)\n\n    def store_state_token(self, user_id: str, provider: str, scopes: list[str]) -> str:\n        token = secrets.token_urlsafe(32)\n        expires_at = datetime.now(timezone.utc) + timedelta(minutes=10)\n\n        state = OAuthState(\n            token=token,\n            provider=provider,\n            expires_at=int(expires_at.timestamp()),\n            scopes=scopes,\n        )\n\n        with self.locked_user_integrations(user_id):\n            user_integrations = self._get_user_integrations(user_id)\n            oauth_states = user_integrations.oauth_states\n            oauth_states.append(state)\n            user_integrations.oauth_states = oauth_states\n\n            self.db_manager.update_user_integrations(\n                user_id=user_id, data=user_integrations\n            )\n\n        return token\n\n    def get_any_valid_scopes_from_state_token(\n        self, user_id: str, token: str, provider: str\n    ) -> list[str]:\n        \"\"\"\n        Get the valid scopes from the OAuth state token. This will return any valid scopes\n        from any OAuth state token for the given provider. If no valid scopes are found,\n        an empty list is returned. DO NOT RELY ON THIS TOKEN TO AUTHENTICATE A USER, AS IT\n        IS TO CHECK IF THE USER HAS GIVEN PERMISSIONS TO THE APPLICATION BEFORE EXCHANGING\n        THE CODE FOR TOKENS.\n        \"\"\"\n        user_integrations = self._get_user_integrations(user_id)\n        oauth_states = user_integrations.oauth_states\n\n        now = datetime.now(timezone.utc)\n        valid_state = next(\n            (\n                state\n                for state in oauth_states\n                if state.token == token\n                and state.provider == provider\n                and state.expires_at > now.timestamp()\n            ),\n            None,\n        )\n\n        if valid_state:\n            return valid_state.scopes\n\n        return []\n\n    def verify_state_token(self, user_id: str, token: str, provider: str) -> bool:\n        with self.locked_user_integrations(user_id):\n            user_integrations = self._get_user_integrations(user_id)\n            oauth_states = user_integrations.oauth_states\n\n            now = datetime.now(timezone.utc)\n            valid_state = next(\n                (\n                    state\n                    for state in oauth_states\n                    if state.token == token\n                    and state.provider == provider\n                    and state.expires_at > now.timestamp()\n                ),\n                None,\n            )\n\n            if valid_state:\n                # Remove the used state\n                oauth_states.remove(valid_state)\n                user_integrations.oauth_states = oauth_states\n                self.db_manager.update_user_integrations(user_id, user_integrations)\n                return True\n\n        return False\n\n    def _set_user_integration_creds(\n        self, user_id: str, credentials: list[Credentials]\n    ) -> None:\n        integrations = self._get_user_integrations(user_id)\n        # Remove default credentials from the list\n        credentials = [c for c in credentials if c not in DEFAULT_CREDENTIALS]\n        integrations.credentials = credentials\n        self.db_manager.update_user_integrations(user_id, integrations)\n\n    def _get_user_integrations(self, user_id: str) -> UserIntegrations:\n        integrations: UserIntegrations = self.db_manager.get_user_integrations(\n            user_id=user_id\n        )\n        return integrations\n\n    def locked_user_integrations(self, user_id: str):\n        key = (f\"user:{user_id}\", \"integrations\")\n        return self.locks.locked(key)\n",
    "start_token": 0,
    "end_token": 1817,
    "children": [
        {
            "type": "import_statement",
            "label": "import secrets",
            "start_token": 0,
            "end_token": 1,
            "children": [
                {
                    "type": "dotted_name",
                    "label": "secrets",
                    "start_token": 1,
                    "end_token": 1,
                    "children": [
                        {
                            "type": "identifier",
                            "label": "secrets",
                            "start_token": 1,
                            "end_token": 1,
                            "children": []
                        }
                    ]
                }
            ]
        },
        {
            "type": "import_from_statement",
            "label": "from datetime import datetime, timedelta, timezone",
            "start_token": 3,
            "end_token": 10,
            "children": [
                {
                    "type": "dotted_name",
                    "label": "datetime",
                    "start_token": 4,
                    "end_token": 4,
                    "children": [
                        {
                            "type": "identifier",
                            "label": "datetime",
                            "start_token": 4,
                            "end_token": 4,
                            "children": []
                        }
                    ]
                },
                {
                    "type": "dotted_name",
                    "label": "datetime",
                    "start_token": 6,
                    "end_token": 6,
                    "children": [
                        {
                            "type": "identifier",
                            "label": "datetime",
                            "start_token": 6,
                            "end_token": 6,
                            "children": []
                        }
                    ]
                },
                {
                    "type": "dotted_name",
                    "label": "timedelta",
                    "start_token": 8,
                    "end_token": 8,
                    "children": [
                        {
                            "type": "identifier",
                            "label": "timedelta",
                            "start_token": 8,
                            "end_token": 8,
                            "children": []
                        }
                    ]
                },
                {
                    "type": "dotted_name",
                    "label": "timezone",
                    "start_token": 10,
                    "end_token": 10,
                    "children": [
                        {
                            "type": "identifier",
                            "label": "timezone",
                            "start_token": 10,
                            "end_token": 10,
                            "children": []
                        }
                    ]
                }
            ]
        },
        {
            "type": "import_from_statement",
            "label": "from typing import TYPE_CHECKING",
            "start_token": 12,
            "end_token": 15,
            "children": [
                {
                    "type": "dotted_name",
                    "label": "typing",
                    "start_token": 13,
                    "end_token": 13,
                    "children": [
                        {
                            "type": "identifier",
                            "label": "typing",
                            "start_token": 13,
                            "end_token": 13,
                            "children": []
                        }
                    ]
                },
                {
                    "type": "dotted_name",
                    "label": "TYPE_CHECKING",
                    "start_token": 15,
                    "end_token": 15,
                    "children": [
                        {
                            "type": "identifier",
                            "label": "TYPE_CHECKING",
                            "start_token": 15,
                            "end_token": 15,
                            "children": []
                        }
                    ]
                }
            ]
        },
        {
            "type": "import_from_statement",
            "label": "from pydantic import SecretStr",
            "start_token": 18,
            "end_token": 21,
            "children": [
                {
                    "type": "dotted_name",
                    "label": "pydantic",
                    "start_token": 19,
                    "end_token": 19,
                    "children": [
                        {
                            "type": "identifier",
                            "label": "pydantic",
                            "start_token": 19,
                            "end_token": 19,
                            "children": []
                        }
                    ]
                },
                {
                    "type": "dotted_name",
                    "label": "SecretStr",
                    "start_token": 21,
                    "end_token": 21,
                    "children": [
                        {
                            "type": "identifier",
                            "label": "SecretStr",
                            "start_token": 21,
                            "end_token": 21,
                            "children": []
                        }
                    ]
                }
            ]
        },
        {
            "type": "if_statement",
            "label": "if TYPE_CHECKING:\n    from backend.executor.database import DatabaseManager",
            "start_token": 24,
            "end_token": 35,
            "children": [
                {
                    "type": "identifier",
                    "label": "TYPE_CHECKING",
                    "start_token": 25,
                    "end_token": 25,
                    "children": []
                },
                {
                    "type": "block",
                    "label": "from backend.executor.database import DatabaseManager",
                    "start_token": 28,
                    "end_token": 35,
                    "children": [
                        {
                            "type": "import_from_statement",
                            "label": "from backend.executor.database import DatabaseManager",
                            "start_token": 28,
                            "end_token": 35,
                            "children": [
                                {
                                    "type": "dotted_name",
                                    "label": "backend.executor.database",
                                    "start_token": 29,
                                    "end_token": 33,
                                    "children": [
                                        {
                                            "type": "identifier",
                                            "label": "backend",
                                            "start_token": 29,
                                            "end_token": 29,
                                            "children": []
                                        },
                                        {
                                            "type": "identifier",
                                            "label": "executor",
                                            "start_token": 31,
                                            "end_token": 31,
                                            "children": []
                                        },
                                        {
                                            "type": "identifier",
                                            "label": "database",
                                            "start_token": 33,
                                            "end_token": 33,
                                            "children": []
                                        }
                                    ]
                                },
                                {
                                    "type": "dotted_name",
                                    "label": "DatabaseManager",
                                    "start_token": 35,
                                    "end_token": 35,
                                    "children": [
                                        {
                                            "type": "identifier",
                                            "label": "DatabaseManager",
                                            "start_token": 35,
                                            "end_token": 35,
                                            "children": []
                                        }
                                    ]
                                }
                            ]
                        }
                    ]
                }
            ]
        },
        {
            "type": "import_from_statement",
            "label": "from autogpt_libs.utils.cache import thread_cached",
            "start_token": 38,
            "end_token": 45,
            "children": [
                {
                    "type": "dotted_name",
                    "label": "autogpt_libs.utils.cache",
                    "start_token": 39,
                    "end_token": 43,
                    "children": [
                        {
                            "type": "identifier",
                            "label": "autogpt_libs",
                            "start_token": 39,
                            "end_token": 39,
                            "children": []
                        },
                        {
                            "type": "identifier",
                            "label": "utils",
                            "start_token": 41,
                            "end_token": 41,
                            "children": []
                        },
                        {
                            "type": "identifier",
                            "label": "cache",
                            "start_token": 43,
                            "end_token": 43,
                            "children": []
                        }
                    ]
                },
                {
                    "type": "dotted_name",
                    "label": "thread_cached",
                    "start_token": 45,
                    "end_token": 45,
                    "children": [
                        {
                            "type": "identifier",
                            "label": "thread_cached",
                            "start_token": 45,
                            "end_token": 45,
                            "children": []
                        }
                    ]
                }
            ]
        },
        {
            "type": "import_from_statement",
            "label": "from autogpt_libs.utils.synchronize import RedisKeyedMutex",
            "start_token": 47,
            "end_token": 54,
            "children": [
                {
                    "type": "dotted_name",
                    "label": "autogpt_libs.utils.synchronize",
                    "start_token": 48,
                    "end_token": 52,
                    "children": [
                        {
                            "type": "identifier",
                            "label": "autogpt_libs",
                            "start_token": 48,
                            "end_token": 48,
                            "children": []
                        },
                        {
                            "type": "identifier",
                            "label": "utils",
                            "start_token": 50,
                            "end_token": 50,
                            "children": []
                        },
                        {
                            "type": "identifier",
                            "label": "synchronize",
                            "start_token": 52,
                            "end_token": 52,
                            "children": []
                        }
                    ]
                },
                {
                    "type": "dotted_name",
                    "label": "RedisKeyedMutex",
                    "start_token": 54,
                    "end_token": 54,
                    "children": [
                        {
                            "type": "identifier",
                            "label": "RedisKeyedMutex",
                            "start_token": 54,
                            "end_token": 54,
                            "children": []
                        }
                    ]
                }
            ]
        },
        {
            "type": "import_from_statement",
            "label": "from backend.data.model import (\n    APIKeyCredentials,\n    Credentials,\n    OAuth2Credentials,\n    OAuthState,\n    UserIntegrations,\n)",
            "start_token": 57,
            "end_token": 81,
            "children": [
                {
                    "type": "dotted_name",
                    "label": "backend.data.model",
                    "start_token": 58,
                    "end_token": 62,
                    "children": [
                        {
                            "type": "identifier",
                            "label": "backend",
                            "start_token": 58,
                            "end_token": 58,
                            "children": []
                        },
                        {
                            "type": "identifier",
                            "label": "data",
                            "start_token": 60,
                            "end_token": 60,
                            "children": []
                        },
                        {
                            "type": "identifier",
                            "label": "model",
                            "start_token": 62,
                            "end_token": 62,
                            "children": []
                        }
                    ]
                },
                {
                    "type": "dotted_name",
                    "label": "APIKeyCredentials",
                    "start_token": 66,
                    "end_token": 66,
                    "children": [
                        {
                            "type": "identifier",
                            "label": "APIKeyCredentials",
                            "start_token": 66,
                            "end_token": 66,
                            "children": []
                        }
                    ]
                },
                {
                    "type": "dotted_name",
                    "label": "Credentials",
                    "start_token": 69,
                    "end_token": 69,
                    "children": [
                        {
                            "type": "identifier",
                            "label": "Credentials",
                            "start_token": 69,
                            "end_token": 69,
                            "children": []
                        }
                    ]
                },
                {
                    "type": "dotted_name",
                    "label": "OAuth2Credentials",
                    "start_token": 72,
                    "end_token": 72,
                    "children": [
                        {
                            "type": "identifier",
                            "label": "OAuth2Credentials",
                            "start_token": 72,
                            "end_token": 72,
                            "children": []
                        }
                    ]
                },
                {
                    "type": "dotted_name",
                    "label": "OAuthState",
                    "start_token": 75,
                    "end_token": 75,
                    "children": [
                        {
                            "type": "identifier",
                            "label": "OAuthState",
                            "start_token": 75,
                            "end_token": 75,
                            "children": []
                        }
                    ]
                },
                {
                    "type": "dotted_name",
                    "label": "UserIntegrations",
                    "start_token": 78,
                    "end_token": 78,
                    "children": [
                        {
                            "type": "identifier",
                            "label": "UserIntegrations",
                            "start_token": 78,
                            "end_token": 78,
                            "children": []
                        }
                    ]
                }
            ]
        },
        {
            "type": "import_from_statement",
            "label": "from backend.util.settings import Settings",
            "start_token": 83,
            "end_token": 90,
            "children": [
                {
                    "type": "dotted_name",
                    "label": "backend.util.settings",
                    "start_token": 84,
                    "end_token": 88,
                    "children": [
                        {
                            "type": "identifier",
                            "label": "backend",
                            "start_token": 84,
                            "end_token": 84,
                            "children": []
                        },
                        {
                            "type": "identifier",
                            "label": "util",
                            "start_token": 86,
                            "end_token": 86,
                            "children": []
                        },
                        {
                            "type": "identifier",
                            "label": "settings",
                            "start_token": 88,
                            "end_token": 88,
                            "children": []
                        }
                    ]
                },
                {
                    "type": "dotted_name",
                    "label": "Settings",
                    "start_token": 90,
                    "end_token": 90,
                    "children": [
                        {
                            "type": "identifier",
                            "label": "Settings",
                            "start_token": 90,
                            "end_token": 90,
                            "children": []
                        }
                    ]
                }
            ]
        },
        {
            "type": "expression_statement",
            "label": "settings = Settings()",
            "start_token": 93,
            "end_token": 97,
            "children": [
                {
                    "type": "assignment",
                    "label": "settings = Settings()",
                    "start_token": 93,
                    "end_token": 97,
                    "children": [
                        {
                            "type": "identifier",
                            "label": "settings",
                            "start_token": 93,
                            "end_token": 93,
                            "children": []
                        },
                        {
                            "type": "call",
                            "label": "Settings()",
                            "start_token": 95,
                            "end_token": 97,
                            "children": [
                                {
                                    "type": "identifier",
                                    "label": "Settings",
                                    "start_token": 95,
                                    "end_token": 95,
                                    "children": []
                                },
                                {
                                    "type": "argument_list",
                                    "label": "()",
                                    "start_token": 96,
                                    "end_token": 97,
                                    "children": []
                                }
                            ]
                        }
                    ]
                }
            ]
        },
        {
            "type": "expression_statement",
            "label": "revid_credentials = APIKeyCredentials(\n    id=\"fdb7f412-f519-48d1-9b5f-d2f73d0e01fe\",\n    provider=\"revid\",\n    api_key=SecretStr(settings.secrets.revid_api_key),\n    title=\"Use Credits for Revid\",\n    expires_at=None,\n)",
            "start_token": 100,
            "end_token": 137,
            "children": [
                {
                    "type": "assignment",
                    "label": "revid_credentials = APIKeyCredentials(\n    id=\"fdb7f412-f519-48d1-9b5f-d2f73d0e01fe\",\n    provider=\"revid\",\n    api_key=SecretStr(settings.secrets.revid_api_key),\n    title=\"Use Credits for Revid\",\n    expires_at=None,\n)",
                    "start_token": 100,
                    "end_token": 137,
                    "children": [
                        {
                            "type": "identifier",
                            "label": "revid_credentials",
                            "start_token": 100,
                            "end_token": 100,
                            "children": []
                        },
                        {
                            "type": "call",
                            "label": "APIKeyCredentials(\n    id=\"fdb7f412-f519-48d1-9b5f-d2f73d0e01fe\",\n    provider=\"revid\",\n    api_key=SecretStr(settings.secrets.revid_api_key),\n    title=\"Use Credits for Revid\",\n    expires_at=None,\n)",
                            "start_token": 102,
                            "end_token": 137,
                            "children": [
                                {
                                    "type": "identifier",
                                    "label": "APIKeyCredentials",
                                    "start_token": 102,
                                    "end_token": 102,
                                    "children": []
                                },
                                {
                                    "type": "argument_list",
                                    "label": "(\n    id=\"fdb7f412-f519-48d1-9b5f-d2f73d0e01fe\",\n    provider=\"revid\",\n    api_key=SecretStr(settings.secrets.revid_api_key),\n    title=\"Use Credits for Revid\",\n    expires_at=None,\n)",
                                    "start_token": 103,
                                    "end_token": 137,
                                    "children": [
                                        {
                                            "type": "keyword_argument",
                                            "label": "id=\"fdb7f412-f519-48d1-9b5f-d2f73d0e01fe\"",
                                            "start_token": 105,
                                            "end_token": 107,
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "label": "id",
                                                    "start_token": 105,
                                                    "end_token": 105,
                                                    "children": []
                                                },
                                                {
                                                    "type": "string",
                                                    "label": "\"fdb7f412-f519-48d1-9b5f-d2f73d0e01fe\"",
                                                    "start_token": 107,
                                                    "end_token": 107,
                                                    "children": [
                                                        {
                                                            "type": "string_start",
                                                            "label": "\"",
                                                            "start_token": 107,
                                                            "end_token": 107,
                                                            "children": []
                                                        },
                                                        {
                                                            "type": "string_content",
                                                            "label": "fdb7f412-f519-48d1-9b5f-d2f73d0e01fe",
                                                            "start_token": 107,
                                                            "end_token": 107,
                                                            "children": []
                                                        },
                                                        {
                                                            "type": "string_end",
                                                            "label": "\"",
                                                            "start_token": 107,
                                                            "end_token": 107,
                                                            "children": []
                                                        }
                                                    ]
                                                }
                                            ]
                                        },
                                        {
                                            "type": "keyword_argument",
                                            "label": "provider=\"revid\"",
                                            "start_token": 110,
                                            "end_token": 112,
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "label": "provider",
                                                    "start_token": 110,
                                                    "end_token": 110,
                                                    "children": []
                                                },
                                                {
                                                    "type": "string",
                                                    "label": "\"revid\"",
                                                    "start_token": 112,
                                                    "end_token": 112,
                                                    "children": [
                                                        {
                                                            "type": "string_start",
                                                            "label": "\"",
                                                            "start_token": 112,
                                                            "end_token": 112,
                                                            "children": []
                                                        },
                                                        {
                                                            "type": "string_content",
                                                            "label": "revid",
                                                            "start_token": 112,
                                                            "end_token": 112,
                                                            "children": []
                                                        },
                                                        {
                                                            "type": "string_end",
                                                            "label": "\"",
                                                            "start_token": 112,
                                                            "end_token": 112,
                                                            "children": []
                                                        }
                                                    ]
                                                }
                                            ]
                                        },
                                        {
                                            "type": "keyword_argument",
                                            "label": "api_key=SecretStr(settings.secrets.revid_api_key)",
                                            "start_token": 115,
                                            "end_token": 124,
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "label": "api_key",
                                                    "start_token": 115,
                                                    "end_token": 115,
                                                    "children": []
                                                },
                                                {
                                                    "type": "call",
                                                    "label": "SecretStr(settings.secrets.revid_api_key)",
                                                    "start_token": 117,
                                                    "end_token": 124,
                                                    "children": [
                                                        {
                                                            "type": "identifier",
                                                            "label": "SecretStr",
                                                            "start_token": 117,
                                                            "end_token": 117,
                                                            "children": []
                                                        },
                                                        {
                                                            "type": "argument_list",
                                                            "label": "(settings.secrets.revid_api_key)",
                                                            "start_token": 118,
                                                            "end_token": 124,
                                                            "children": [
                                                                {
                                                                    "type": "attribute",
                                                                    "label": "settings.secrets.revid_api_key",
                                                                    "start_token": 119,
                                                                    "end_token": 123,
                                                                    "children": [
                                                                        {
                                                                            "type": "attribute",
                                                                            "label": "settings.secrets",
                                                                            "start_token": 119,
                                                                            "end_token": 121,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "settings",
                                                                                    "start_token": 119,
                                                                                    "end_token": 119,
                                                                                    "children": []
                                                                                },
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "secrets",
                                                                                    "start_token": 121,
                                                                                    "end_token": 121,
                                                                                    "children": []
                                                                                }
                                                                            ]
                                                                        },
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "revid_api_key",
                                                                            "start_token": 123,
                                                                            "end_token": 123,
                                                                            "children": []
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                }
                                            ]
                                        },
                                        {
                                            "type": "keyword_argument",
                                            "label": "title=\"Use Credits for Revid\"",
                                            "start_token": 127,
                                            "end_token": 129,
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "label": "title",
                                                    "start_token": 127,
                                                    "end_token": 127,
                                                    "children": []
                                                },
                                                {
                                                    "type": "string",
                                                    "label": "\"Use Credits for Revid\"",
                                                    "start_token": 129,
                                                    "end_token": 129,
                                                    "children": [
                                                        {
                                                            "type": "string_start",
                                                            "label": "\"",
                                                            "start_token": 129,
                                                            "end_token": 129,
                                                            "children": []
                                                        },
                                                        {
                                                            "type": "string_content",
                                                            "label": "Use Credits for Revid",
                                                            "start_token": 129,
                                                            "end_token": 129,
                                                            "children": []
                                                        },
                                                        {
                                                            "type": "string_end",
                                                            "label": "\"",
                                                            "start_token": 129,
                                                            "end_token": 129,
                                                            "children": []
                                                        }
                                                    ]
                                                }
                                            ]
                                        },
                                        {
                                            "type": "keyword_argument",
                                            "label": "expires_at=None",
                                            "start_token": 132,
                                            "end_token": 134,
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "label": "expires_at",
                                                    "start_token": 132,
                                                    "end_token": 132,
                                                    "children": []
                                                },
                                                {
                                                    "type": "none",
                                                    "label": "None",
                                                    "start_token": 134,
                                                    "end_token": 134,
                                                    "children": []
                                                }
                                            ]
                                        }
                                    ]
                                }
                            ]
                        }
                    ]
                }
            ]
        },
        {
            "type": "expression_statement",
            "label": "ideogram_credentials = APIKeyCredentials(\n    id=\"760f84fc-b270-42de-91f6-08efe1b512d0\",\n    provider=\"ideogram\",\n    api_key=SecretStr(settings.secrets.ideogram_api_key),\n    title=\"Use Credits for Ideogram\",\n    expires_at=None,\n)",
            "start_token": 139,
            "end_token": 176,
            "children": [
                {
                    "type": "assignment",
                    "label": "ideogram_credentials = APIKeyCredentials(\n    id=\"760f84fc-b270-42de-91f6-08efe1b512d0\",\n    provider=\"ideogram\",\n    api_key=SecretStr(settings.secrets.ideogram_api_key),\n    title=\"Use Credits for Ideogram\",\n    expires_at=None,\n)",
                    "start_token": 139,
                    "end_token": 176,
                    "children": [
                        {
                            "type": "identifier",
                            "label": "ideogram_credentials",
                            "start_token": 139,
                            "end_token": 139,
                            "children": []
                        },
                        {
                            "type": "call",
                            "label": "APIKeyCredentials(\n    id=\"760f84fc-b270-42de-91f6-08efe1b512d0\",\n    provider=\"ideogram\",\n    api_key=SecretStr(settings.secrets.ideogram_api_key),\n    title=\"Use Credits for Ideogram\",\n    expires_at=None,\n)",
                            "start_token": 141,
                            "end_token": 176,
                            "children": [
                                {
                                    "type": "identifier",
                                    "label": "APIKeyCredentials",
                                    "start_token": 141,
                                    "end_token": 141,
                                    "children": []
                                },
                                {
                                    "type": "argument_list",
                                    "label": "(\n    id=\"760f84fc-b270-42de-91f6-08efe1b512d0\",\n    provider=\"ideogram\",\n    api_key=SecretStr(settings.secrets.ideogram_api_key),\n    title=\"Use Credits for Ideogram\",\n    expires_at=None,\n)",
                                    "start_token": 142,
                                    "end_token": 176,
                                    "children": [
                                        {
                                            "type": "keyword_argument",
                                            "label": "id=\"760f84fc-b270-42de-91f6-08efe1b512d0\"",
                                            "start_token": 144,
                                            "end_token": 146,
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "label": "id",
                                                    "start_token": 144,
                                                    "end_token": 144,
                                                    "children": []
                                                },
                                                {
                                                    "type": "string",
                                                    "label": "\"760f84fc-b270-42de-91f6-08efe1b512d0\"",
                                                    "start_token": 146,
                                                    "end_token": 146,
                                                    "children": [
                                                        {
                                                            "type": "string_start",
                                                            "label": "\"",
                                                            "start_token": 146,
                                                            "end_token": 146,
                                                            "children": []
                                                        },
                                                        {
                                                            "type": "string_content",
                                                            "label": "760f84fc-b270-42de-91f6-08efe1b512d0",
                                                            "start_token": 146,
                                                            "end_token": 146,
                                                            "children": []
                                                        },
                                                        {
                                                            "type": "string_end",
                                                            "label": "\"",
                                                            "start_token": 146,
                                                            "end_token": 146,
                                                            "children": []
                                                        }
                                                    ]
                                                }
                                            ]
                                        },
                                        {
                                            "type": "keyword_argument",
                                            "label": "provider=\"ideogram\"",
                                            "start_token": 149,
                                            "end_token": 151,
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "label": "provider",
                                                    "start_token": 149,
                                                    "end_token": 149,
                                                    "children": []
                                                },
                                                {
                                                    "type": "string",
                                                    "label": "\"ideogram\"",
                                                    "start_token": 151,
                                                    "end_token": 151,
                                                    "children": [
                                                        {
                                                            "type": "string_start",
                                                            "label": "\"",
                                                            "start_token": 151,
                                                            "end_token": 151,
                                                            "children": []
                                                        },
                                                        {
                                                            "type": "string_content",
                                                            "label": "ideogram",
                                                            "start_token": 151,
                                                            "end_token": 151,
                                                            "children": []
                                                        },
                                                        {
                                                            "type": "string_end",
                                                            "label": "\"",
                                                            "start_token": 151,
                                                            "end_token": 151,
                                                            "children": []
                                                        }
                                                    ]
                                                }
                                            ]
                                        },
                                        {
                                            "type": "keyword_argument",
                                            "label": "api_key=SecretStr(settings.secrets.ideogram_api_key)",
                                            "start_token": 154,
                                            "end_token": 163,
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "label": "api_key",
                                                    "start_token": 154,
                                                    "end_token": 154,
                                                    "children": []
                                                },
                                                {
                                                    "type": "call",
                                                    "label": "SecretStr(settings.secrets.ideogram_api_key)",
                                                    "start_token": 156,
                                                    "end_token": 163,
                                                    "children": [
                                                        {
                                                            "type": "identifier",
                                                            "label": "SecretStr",
                                                            "start_token": 156,
                                                            "end_token": 156,
                                                            "children": []
                                                        },
                                                        {
                                                            "type": "argument_list",
                                                            "label": "(settings.secrets.ideogram_api_key)",
                                                            "start_token": 157,
                                                            "end_token": 163,
                                                            "children": [
                                                                {
                                                                    "type": "attribute",
                                                                    "label": "settings.secrets.ideogram_api_key",
                                                                    "start_token": 158,
                                                                    "end_token": 162,
                                                                    "children": [
                                                                        {
                                                                            "type": "attribute",
                                                                            "label": "settings.secrets",
                                                                            "start_token": 158,
                                                                            "end_token": 160,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "settings",
                                                                                    "start_token": 158,
                                                                                    "end_token": 158,
                                                                                    "children": []
                                                                                },
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "secrets",
                                                                                    "start_token": 160,
                                                                                    "end_token": 160,
                                                                                    "children": []
                                                                                }
                                                                            ]
                                                                        },
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "ideogram_api_key",
                                                                            "start_token": 162,
                                                                            "end_token": 162,
                                                                            "children": []
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                }
                                            ]
                                        },
                                        {
                                            "type": "keyword_argument",
                                            "label": "title=\"Use Credits for Ideogram\"",
                                            "start_token": 166,
                                            "end_token": 168,
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "label": "title",
                                                    "start_token": 166,
                                                    "end_token": 166,
                                                    "children": []
                                                },
                                                {
                                                    "type": "string",
                                                    "label": "\"Use Credits for Ideogram\"",
                                                    "start_token": 168,
                                                    "end_token": 168,
                                                    "children": [
                                                        {
                                                            "type": "string_start",
                                                            "label": "\"",
                                                            "start_token": 168,
                                                            "end_token": 168,
                                                            "children": []
                                                        },
                                                        {
                                                            "type": "string_content",
                                                            "label": "Use Credits for Ideogram",
                                                            "start_token": 168,
                                                            "end_token": 168,
                                                            "children": []
                                                        },
                                                        {
                                                            "type": "string_end",
                                                            "label": "\"",
                                                            "start_token": 168,
                                                            "end_token": 168,
                                                            "children": []
                                                        }
                                                    ]
                                                }
                                            ]
                                        },
                                        {
                                            "type": "keyword_argument",
                                            "label": "expires_at=None",
                                            "start_token": 171,
                                            "end_token": 173,
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "label": "expires_at",
                                                    "start_token": 171,
                                                    "end_token": 171,
                                                    "children": []
                                                },
                                                {
                                                    "type": "none",
                                                    "label": "None",
                                                    "start_token": 173,
                                                    "end_token": 173,
                                                    "children": []
                                                }
                                            ]
                                        }
                                    ]
                                }
                            ]
                        }
                    ]
                }
            ]
        },
        {
            "type": "expression_statement",
            "label": "replicate_credentials = APIKeyCredentials(\n    id=\"6b9fc200-4726-4973-86c9-cd526f5ce5db\",\n    provider=\"replicate\",\n    api_key=SecretStr(settings.secrets.replicate_api_key),\n    title=\"Use Credits for Replicate\",\n    expires_at=None,\n)",
            "start_token": 178,
            "end_token": 215,
            "children": [
                {
                    "type": "assignment",
                    "label": "replicate_credentials = APIKeyCredentials(\n    id=\"6b9fc200-4726-4973-86c9-cd526f5ce5db\",\n    provider=\"replicate\",\n    api_key=SecretStr(settings.secrets.replicate_api_key),\n    title=\"Use Credits for Replicate\",\n    expires_at=None,\n)",
                    "start_token": 178,
                    "end_token": 215,
                    "children": [
                        {
                            "type": "identifier",
                            "label": "replicate_credentials",
                            "start_token": 178,
                            "end_token": 178,
                            "children": []
                        },
                        {
                            "type": "call",
                            "label": "APIKeyCredentials(\n    id=\"6b9fc200-4726-4973-86c9-cd526f5ce5db\",\n    provider=\"replicate\",\n    api_key=SecretStr(settings.secrets.replicate_api_key),\n    title=\"Use Credits for Replicate\",\n    expires_at=None,\n)",
                            "start_token": 180,
                            "end_token": 215,
                            "children": [
                                {
                                    "type": "identifier",
                                    "label": "APIKeyCredentials",
                                    "start_token": 180,
                                    "end_token": 180,
                                    "children": []
                                },
                                {
                                    "type": "argument_list",
                                    "label": "(\n    id=\"6b9fc200-4726-4973-86c9-cd526f5ce5db\",\n    provider=\"replicate\",\n    api_key=SecretStr(settings.secrets.replicate_api_key),\n    title=\"Use Credits for Replicate\",\n    expires_at=None,\n)",
                                    "start_token": 181,
                                    "end_token": 215,
                                    "children": [
                                        {
                                            "type": "keyword_argument",
                                            "label": "id=\"6b9fc200-4726-4973-86c9-cd526f5ce5db\"",
                                            "start_token": 183,
                                            "end_token": 185,
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "label": "id",
                                                    "start_token": 183,
                                                    "end_token": 183,
                                                    "children": []
                                                },
                                                {
                                                    "type": "string",
                                                    "label": "\"6b9fc200-4726-4973-86c9-cd526f5ce5db\"",
                                                    "start_token": 185,
                                                    "end_token": 185,
                                                    "children": [
                                                        {
                                                            "type": "string_start",
                                                            "label": "\"",
                                                            "start_token": 185,
                                                            "end_token": 185,
                                                            "children": []
                                                        },
                                                        {
                                                            "type": "string_content",
                                                            "label": "6b9fc200-4726-4973-86c9-cd526f5ce5db",
                                                            "start_token": 185,
                                                            "end_token": 185,
                                                            "children": []
                                                        },
                                                        {
                                                            "type": "string_end",
                                                            "label": "\"",
                                                            "start_token": 185,
                                                            "end_token": 185,
                                                            "children": []
                                                        }
                                                    ]
                                                }
                                            ]
                                        },
                                        {
                                            "type": "keyword_argument",
                                            "label": "provider=\"replicate\"",
                                            "start_token": 188,
                                            "end_token": 190,
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "label": "provider",
                                                    "start_token": 188,
                                                    "end_token": 188,
                                                    "children": []
                                                },
                                                {
                                                    "type": "string",
                                                    "label": "\"replicate\"",
                                                    "start_token": 190,
                                                    "end_token": 190,
                                                    "children": [
                                                        {
                                                            "type": "string_start",
                                                            "label": "\"",
                                                            "start_token": 190,
                                                            "end_token": 190,
                                                            "children": []
                                                        },
                                                        {
                                                            "type": "string_content",
                                                            "label": "replicate",
                                                            "start_token": 190,
                                                            "end_token": 190,
                                                            "children": []
                                                        },
                                                        {
                                                            "type": "string_end",
                                                            "label": "\"",
                                                            "start_token": 190,
                                                            "end_token": 190,
                                                            "children": []
                                                        }
                                                    ]
                                                }
                                            ]
                                        },
                                        {
                                            "type": "keyword_argument",
                                            "label": "api_key=SecretStr(settings.secrets.replicate_api_key)",
                                            "start_token": 193,
                                            "end_token": 202,
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "label": "api_key",
                                                    "start_token": 193,
                                                    "end_token": 193,
                                                    "children": []
                                                },
                                                {
                                                    "type": "call",
                                                    "label": "SecretStr(settings.secrets.replicate_api_key)",
                                                    "start_token": 195,
                                                    "end_token": 202,
                                                    "children": [
                                                        {
                                                            "type": "identifier",
                                                            "label": "SecretStr",
                                                            "start_token": 195,
                                                            "end_token": 195,
                                                            "children": []
                                                        },
                                                        {
                                                            "type": "argument_list",
                                                            "label": "(settings.secrets.replicate_api_key)",
                                                            "start_token": 196,
                                                            "end_token": 202,
                                                            "children": [
                                                                {
                                                                    "type": "attribute",
                                                                    "label": "settings.secrets.replicate_api_key",
                                                                    "start_token": 197,
                                                                    "end_token": 201,
                                                                    "children": [
                                                                        {
                                                                            "type": "attribute",
                                                                            "label": "settings.secrets",
                                                                            "start_token": 197,
                                                                            "end_token": 199,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "settings",
                                                                                    "start_token": 197,
                                                                                    "end_token": 197,
                                                                                    "children": []
                                                                                },
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "secrets",
                                                                                    "start_token": 199,
                                                                                    "end_token": 199,
                                                                                    "children": []
                                                                                }
                                                                            ]
                                                                        },
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "replicate_api_key",
                                                                            "start_token": 201,
                                                                            "end_token": 201,
                                                                            "children": []
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                }
                                            ]
                                        },
                                        {
                                            "type": "keyword_argument",
                                            "label": "title=\"Use Credits for Replicate\"",
                                            "start_token": 205,
                                            "end_token": 207,
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "label": "title",
                                                    "start_token": 205,
                                                    "end_token": 205,
                                                    "children": []
                                                },
                                                {
                                                    "type": "string",
                                                    "label": "\"Use Credits for Replicate\"",
                                                    "start_token": 207,
                                                    "end_token": 207,
                                                    "children": [
                                                        {
                                                            "type": "string_start",
                                                            "label": "\"",
                                                            "start_token": 207,
                                                            "end_token": 207,
                                                            "children": []
                                                        },
                                                        {
                                                            "type": "string_content",
                                                            "label": "Use Credits for Replicate",
                                                            "start_token": 207,
                                                            "end_token": 207,
                                                            "children": []
                                                        },
                                                        {
                                                            "type": "string_end",
                                                            "label": "\"",
                                                            "start_token": 207,
                                                            "end_token": 207,
                                                            "children": []
                                                        }
                                                    ]
                                                }
                                            ]
                                        },
                                        {
                                            "type": "keyword_argument",
                                            "label": "expires_at=None",
                                            "start_token": 210,
                                            "end_token": 212,
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "label": "expires_at",
                                                    "start_token": 210,
                                                    "end_token": 210,
                                                    "children": []
                                                },
                                                {
                                                    "type": "none",
                                                    "label": "None",
                                                    "start_token": 212,
                                                    "end_token": 212,
                                                    "children": []
                                                }
                                            ]
                                        }
                                    ]
                                }
                            ]
                        }
                    ]
                }
            ]
        },
        {
            "type": "expression_statement",
            "label": "openai_credentials = APIKeyCredentials(\n    id=\"53c25cb8-e3ee-465c-a4d1-e75a4c899c2a\",\n    provider=\"openai\",\n    api_key=SecretStr(settings.secrets.openai_api_key),\n    title=\"Use Credits for OpenAI\",\n    expires_at=None,\n)",
            "start_token": 217,
            "end_token": 254,
            "children": [
                {
                    "type": "assignment",
                    "label": "openai_credentials = APIKeyCredentials(\n    id=\"53c25cb8-e3ee-465c-a4d1-e75a4c899c2a\",\n    provider=\"openai\",\n    api_key=SecretStr(settings.secrets.openai_api_key),\n    title=\"Use Credits for OpenAI\",\n    expires_at=None,\n)",
                    "start_token": 217,
                    "end_token": 254,
                    "children": [
                        {
                            "type": "identifier",
                            "label": "openai_credentials",
                            "start_token": 217,
                            "end_token": 217,
                            "children": []
                        },
                        {
                            "type": "call",
                            "label": "APIKeyCredentials(\n    id=\"53c25cb8-e3ee-465c-a4d1-e75a4c899c2a\",\n    provider=\"openai\",\n    api_key=SecretStr(settings.secrets.openai_api_key),\n    title=\"Use Credits for OpenAI\",\n    expires_at=None,\n)",
                            "start_token": 219,
                            "end_token": 254,
                            "children": [
                                {
                                    "type": "identifier",
                                    "label": "APIKeyCredentials",
                                    "start_token": 219,
                                    "end_token": 219,
                                    "children": []
                                },
                                {
                                    "type": "argument_list",
                                    "label": "(\n    id=\"53c25cb8-e3ee-465c-a4d1-e75a4c899c2a\",\n    provider=\"openai\",\n    api_key=SecretStr(settings.secrets.openai_api_key),\n    title=\"Use Credits for OpenAI\",\n    expires_at=None,\n)",
                                    "start_token": 220,
                                    "end_token": 254,
                                    "children": [
                                        {
                                            "type": "keyword_argument",
                                            "label": "id=\"53c25cb8-e3ee-465c-a4d1-e75a4c899c2a\"",
                                            "start_token": 222,
                                            "end_token": 224,
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "label": "id",
                                                    "start_token": 222,
                                                    "end_token": 222,
                                                    "children": []
                                                },
                                                {
                                                    "type": "string",
                                                    "label": "\"53c25cb8-e3ee-465c-a4d1-e75a4c899c2a\"",
                                                    "start_token": 224,
                                                    "end_token": 224,
                                                    "children": [
                                                        {
                                                            "type": "string_start",
                                                            "label": "\"",
                                                            "start_token": 224,
                                                            "end_token": 224,
                                                            "children": []
                                                        },
                                                        {
                                                            "type": "string_content",
                                                            "label": "53c25cb8-e3ee-465c-a4d1-e75a4c899c2a",
                                                            "start_token": 224,
                                                            "end_token": 224,
                                                            "children": []
                                                        },
                                                        {
                                                            "type": "string_end",
                                                            "label": "\"",
                                                            "start_token": 224,
                                                            "end_token": 224,
                                                            "children": []
                                                        }
                                                    ]
                                                }
                                            ]
                                        },
                                        {
                                            "type": "keyword_argument",
                                            "label": "provider=\"openai\"",
                                            "start_token": 227,
                                            "end_token": 229,
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "label": "provider",
                                                    "start_token": 227,
                                                    "end_token": 227,
                                                    "children": []
                                                },
                                                {
                                                    "type": "string",
                                                    "label": "\"openai\"",
                                                    "start_token": 229,
                                                    "end_token": 229,
                                                    "children": [
                                                        {
                                                            "type": "string_start",
                                                            "label": "\"",
                                                            "start_token": 229,
                                                            "end_token": 229,
                                                            "children": []
                                                        },
                                                        {
                                                            "type": "string_content",
                                                            "label": "openai",
                                                            "start_token": 229,
                                                            "end_token": 229,
                                                            "children": []
                                                        },
                                                        {
                                                            "type": "string_end",
                                                            "label": "\"",
                                                            "start_token": 229,
                                                            "end_token": 229,
                                                            "children": []
                                                        }
                                                    ]
                                                }
                                            ]
                                        },
                                        {
                                            "type": "keyword_argument",
                                            "label": "api_key=SecretStr(settings.secrets.openai_api_key)",
                                            "start_token": 232,
                                            "end_token": 241,
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "label": "api_key",
                                                    "start_token": 232,
                                                    "end_token": 232,
                                                    "children": []
                                                },
                                                {
                                                    "type": "call",
                                                    "label": "SecretStr(settings.secrets.openai_api_key)",
                                                    "start_token": 234,
                                                    "end_token": 241,
                                                    "children": [
                                                        {
                                                            "type": "identifier",
                                                            "label": "SecretStr",
                                                            "start_token": 234,
                                                            "end_token": 234,
                                                            "children": []
                                                        },
                                                        {
                                                            "type": "argument_list",
                                                            "label": "(settings.secrets.openai_api_key)",
                                                            "start_token": 235,
                                                            "end_token": 241,
                                                            "children": [
                                                                {
                                                                    "type": "attribute",
                                                                    "label": "settings.secrets.openai_api_key",
                                                                    "start_token": 236,
                                                                    "end_token": 240,
                                                                    "children": [
                                                                        {
                                                                            "type": "attribute",
                                                                            "label": "settings.secrets",
                                                                            "start_token": 236,
                                                                            "end_token": 238,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "settings",
                                                                                    "start_token": 236,
                                                                                    "end_token": 236,
                                                                                    "children": []
                                                                                },
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "secrets",
                                                                                    "start_token": 238,
                                                                                    "end_token": 238,
                                                                                    "children": []
                                                                                }
                                                                            ]
                                                                        },
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "openai_api_key",
                                                                            "start_token": 240,
                                                                            "end_token": 240,
                                                                            "children": []
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                }
                                            ]
                                        },
                                        {
                                            "type": "keyword_argument",
                                            "label": "title=\"Use Credits for OpenAI\"",
                                            "start_token": 244,
                                            "end_token": 246,
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "label": "title",
                                                    "start_token": 244,
                                                    "end_token": 244,
                                                    "children": []
                                                },
                                                {
                                                    "type": "string",
                                                    "label": "\"Use Credits for OpenAI\"",
                                                    "start_token": 246,
                                                    "end_token": 246,
                                                    "children": [
                                                        {
                                                            "type": "string_start",
                                                            "label": "\"",
                                                            "start_token": 246,
                                                            "end_token": 246,
                                                            "children": []
                                                        },
                                                        {
                                                            "type": "string_content",
                                                            "label": "Use Credits for OpenAI",
                                                            "start_token": 246,
                                                            "end_token": 246,
                                                            "children": []
                                                        },
                                                        {
                                                            "type": "string_end",
                                                            "label": "\"",
                                                            "start_token": 246,
                                                            "end_token": 246,
                                                            "children": []
                                                        }
                                                    ]
                                                }
                                            ]
                                        },
                                        {
                                            "type": "keyword_argument",
                                            "label": "expires_at=None",
                                            "start_token": 249,
                                            "end_token": 251,
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "label": "expires_at",
                                                    "start_token": 249,
                                                    "end_token": 249,
                                                    "children": []
                                                },
                                                {
                                                    "type": "none",
                                                    "label": "None",
                                                    "start_token": 251,
                                                    "end_token": 251,
                                                    "children": []
                                                }
                                            ]
                                        }
                                    ]
                                }
                            ]
                        }
                    ]
                }
            ]
        },
        {
            "type": "expression_statement",
            "label": "anthropic_credentials = APIKeyCredentials(\n    id=\"24e5d942-d9e3-4798-8151-90143ee55629\",\n    provider=\"anthropic\",\n    api_key=SecretStr(settings.secrets.anthropic_api_key),\n    title=\"Use Credits for Anthropic\",\n    expires_at=None,\n)",
            "start_token": 256,
            "end_token": 293,
            "children": [
                {
                    "type": "assignment",
                    "label": "anthropic_credentials = APIKeyCredentials(\n    id=\"24e5d942-d9e3-4798-8151-90143ee55629\",\n    provider=\"anthropic\",\n    api_key=SecretStr(settings.secrets.anthropic_api_key),\n    title=\"Use Credits for Anthropic\",\n    expires_at=None,\n)",
                    "start_token": 256,
                    "end_token": 293,
                    "children": [
                        {
                            "type": "identifier",
                            "label": "anthropic_credentials",
                            "start_token": 256,
                            "end_token": 256,
                            "children": []
                        },
                        {
                            "type": "call",
                            "label": "APIKeyCredentials(\n    id=\"24e5d942-d9e3-4798-8151-90143ee55629\",\n    provider=\"anthropic\",\n    api_key=SecretStr(settings.secrets.anthropic_api_key),\n    title=\"Use Credits for Anthropic\",\n    expires_at=None,\n)",
                            "start_token": 258,
                            "end_token": 293,
                            "children": [
                                {
                                    "type": "identifier",
                                    "label": "APIKeyCredentials",
                                    "start_token": 258,
                                    "end_token": 258,
                                    "children": []
                                },
                                {
                                    "type": "argument_list",
                                    "label": "(\n    id=\"24e5d942-d9e3-4798-8151-90143ee55629\",\n    provider=\"anthropic\",\n    api_key=SecretStr(settings.secrets.anthropic_api_key),\n    title=\"Use Credits for Anthropic\",\n    expires_at=None,\n)",
                                    "start_token": 259,
                                    "end_token": 293,
                                    "children": [
                                        {
                                            "type": "keyword_argument",
                                            "label": "id=\"24e5d942-d9e3-4798-8151-90143ee55629\"",
                                            "start_token": 261,
                                            "end_token": 263,
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "label": "id",
                                                    "start_token": 261,
                                                    "end_token": 261,
                                                    "children": []
                                                },
                                                {
                                                    "type": "string",
                                                    "label": "\"24e5d942-d9e3-4798-8151-90143ee55629\"",
                                                    "start_token": 263,
                                                    "end_token": 263,
                                                    "children": [
                                                        {
                                                            "type": "string_start",
                                                            "label": "\"",
                                                            "start_token": 263,
                                                            "end_token": 263,
                                                            "children": []
                                                        },
                                                        {
                                                            "type": "string_content",
                                                            "label": "24e5d942-d9e3-4798-8151-90143ee55629",
                                                            "start_token": 263,
                                                            "end_token": 263,
                                                            "children": []
                                                        },
                                                        {
                                                            "type": "string_end",
                                                            "label": "\"",
                                                            "start_token": 263,
                                                            "end_token": 263,
                                                            "children": []
                                                        }
                                                    ]
                                                }
                                            ]
                                        },
                                        {
                                            "type": "keyword_argument",
                                            "label": "provider=\"anthropic\"",
                                            "start_token": 266,
                                            "end_token": 268,
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "label": "provider",
                                                    "start_token": 266,
                                                    "end_token": 266,
                                                    "children": []
                                                },
                                                {
                                                    "type": "string",
                                                    "label": "\"anthropic\"",
                                                    "start_token": 268,
                                                    "end_token": 268,
                                                    "children": [
                                                        {
                                                            "type": "string_start",
                                                            "label": "\"",
                                                            "start_token": 268,
                                                            "end_token": 268,
                                                            "children": []
                                                        },
                                                        {
                                                            "type": "string_content",
                                                            "label": "anthropic",
                                                            "start_token": 268,
                                                            "end_token": 268,
                                                            "children": []
                                                        },
                                                        {
                                                            "type": "string_end",
                                                            "label": "\"",
                                                            "start_token": 268,
                                                            "end_token": 268,
                                                            "children": []
                                                        }
                                                    ]
                                                }
                                            ]
                                        },
                                        {
                                            "type": "keyword_argument",
                                            "label": "api_key=SecretStr(settings.secrets.anthropic_api_key)",
                                            "start_token": 271,
                                            "end_token": 280,
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "label": "api_key",
                                                    "start_token": 271,
                                                    "end_token": 271,
                                                    "children": []
                                                },
                                                {
                                                    "type": "call",
                                                    "label": "SecretStr(settings.secrets.anthropic_api_key)",
                                                    "start_token": 273,
                                                    "end_token": 280,
                                                    "children": [
                                                        {
                                                            "type": "identifier",
                                                            "label": "SecretStr",
                                                            "start_token": 273,
                                                            "end_token": 273,
                                                            "children": []
                                                        },
                                                        {
                                                            "type": "argument_list",
                                                            "label": "(settings.secrets.anthropic_api_key)",
                                                            "start_token": 274,
                                                            "end_token": 280,
                                                            "children": [
                                                                {
                                                                    "type": "attribute",
                                                                    "label": "settings.secrets.anthropic_api_key",
                                                                    "start_token": 275,
                                                                    "end_token": 279,
                                                                    "children": [
                                                                        {
                                                                            "type": "attribute",
                                                                            "label": "settings.secrets",
                                                                            "start_token": 275,
                                                                            "end_token": 277,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "settings",
                                                                                    "start_token": 275,
                                                                                    "end_token": 275,
                                                                                    "children": []
                                                                                },
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "secrets",
                                                                                    "start_token": 277,
                                                                                    "end_token": 277,
                                                                                    "children": []
                                                                                }
                                                                            ]
                                                                        },
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "anthropic_api_key",
                                                                            "start_token": 279,
                                                                            "end_token": 279,
                                                                            "children": []
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                }
                                            ]
                                        },
                                        {
                                            "type": "keyword_argument",
                                            "label": "title=\"Use Credits for Anthropic\"",
                                            "start_token": 283,
                                            "end_token": 285,
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "label": "title",
                                                    "start_token": 283,
                                                    "end_token": 283,
                                                    "children": []
                                                },
                                                {
                                                    "type": "string",
                                                    "label": "\"Use Credits for Anthropic\"",
                                                    "start_token": 285,
                                                    "end_token": 285,
                                                    "children": [
                                                        {
                                                            "type": "string_start",
                                                            "label": "\"",
                                                            "start_token": 285,
                                                            "end_token": 285,
                                                            "children": []
                                                        },
                                                        {
                                                            "type": "string_content",
                                                            "label": "Use Credits for Anthropic",
                                                            "start_token": 285,
                                                            "end_token": 285,
                                                            "children": []
                                                        },
                                                        {
                                                            "type": "string_end",
                                                            "label": "\"",
                                                            "start_token": 285,
                                                            "end_token": 285,
                                                            "children": []
                                                        }
                                                    ]
                                                }
                                            ]
                                        },
                                        {
                                            "type": "keyword_argument",
                                            "label": "expires_at=None",
                                            "start_token": 288,
                                            "end_token": 290,
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "label": "expires_at",
                                                    "start_token": 288,
                                                    "end_token": 288,
                                                    "children": []
                                                },
                                                {
                                                    "type": "none",
                                                    "label": "None",
                                                    "start_token": 290,
                                                    "end_token": 290,
                                                    "children": []
                                                }
                                            ]
                                        }
                                    ]
                                }
                            ]
                        }
                    ]
                }
            ]
        },
        {
            "type": "expression_statement",
            "label": "groq_credentials = APIKeyCredentials(\n    id=\"4ec22295-8f97-4dd1-b42b-2c6957a02545\",\n    provider=\"groq\",\n    api_key=SecretStr(settings.secrets.groq_api_key),\n    title=\"Use Credits for Groq\",\n    expires_at=None,\n)",
            "start_token": 295,
            "end_token": 332,
            "children": [
                {
                    "type": "assignment",
                    "label": "groq_credentials = APIKeyCredentials(\n    id=\"4ec22295-8f97-4dd1-b42b-2c6957a02545\",\n    provider=\"groq\",\n    api_key=SecretStr(settings.secrets.groq_api_key),\n    title=\"Use Credits for Groq\",\n    expires_at=None,\n)",
                    "start_token": 295,
                    "end_token": 332,
                    "children": [
                        {
                            "type": "identifier",
                            "label": "groq_credentials",
                            "start_token": 295,
                            "end_token": 295,
                            "children": []
                        },
                        {
                            "type": "call",
                            "label": "APIKeyCredentials(\n    id=\"4ec22295-8f97-4dd1-b42b-2c6957a02545\",\n    provider=\"groq\",\n    api_key=SecretStr(settings.secrets.groq_api_key),\n    title=\"Use Credits for Groq\",\n    expires_at=None,\n)",
                            "start_token": 297,
                            "end_token": 332,
                            "children": [
                                {
                                    "type": "identifier",
                                    "label": "APIKeyCredentials",
                                    "start_token": 297,
                                    "end_token": 297,
                                    "children": []
                                },
                                {
                                    "type": "argument_list",
                                    "label": "(\n    id=\"4ec22295-8f97-4dd1-b42b-2c6957a02545\",\n    provider=\"groq\",\n    api_key=SecretStr(settings.secrets.groq_api_key),\n    title=\"Use Credits for Groq\",\n    expires_at=None,\n)",
                                    "start_token": 298,
                                    "end_token": 332,
                                    "children": [
                                        {
                                            "type": "keyword_argument",
                                            "label": "id=\"4ec22295-8f97-4dd1-b42b-2c6957a02545\"",
                                            "start_token": 300,
                                            "end_token": 302,
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "label": "id",
                                                    "start_token": 300,
                                                    "end_token": 300,
                                                    "children": []
                                                },
                                                {
                                                    "type": "string",
                                                    "label": "\"4ec22295-8f97-4dd1-b42b-2c6957a02545\"",
                                                    "start_token": 302,
                                                    "end_token": 302,
                                                    "children": [
                                                        {
                                                            "type": "string_start",
                                                            "label": "\"",
                                                            "start_token": 302,
                                                            "end_token": 302,
                                                            "children": []
                                                        },
                                                        {
                                                            "type": "string_content",
                                                            "label": "4ec22295-8f97-4dd1-b42b-2c6957a02545",
                                                            "start_token": 302,
                                                            "end_token": 302,
                                                            "children": []
                                                        },
                                                        {
                                                            "type": "string_end",
                                                            "label": "\"",
                                                            "start_token": 302,
                                                            "end_token": 302,
                                                            "children": []
                                                        }
                                                    ]
                                                }
                                            ]
                                        },
                                        {
                                            "type": "keyword_argument",
                                            "label": "provider=\"groq\"",
                                            "start_token": 305,
                                            "end_token": 307,
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "label": "provider",
                                                    "start_token": 305,
                                                    "end_token": 305,
                                                    "children": []
                                                },
                                                {
                                                    "type": "string",
                                                    "label": "\"groq\"",
                                                    "start_token": 307,
                                                    "end_token": 307,
                                                    "children": [
                                                        {
                                                            "type": "string_start",
                                                            "label": "\"",
                                                            "start_token": 307,
                                                            "end_token": 307,
                                                            "children": []
                                                        },
                                                        {
                                                            "type": "string_content",
                                                            "label": "groq",
                                                            "start_token": 307,
                                                            "end_token": 307,
                                                            "children": []
                                                        },
                                                        {
                                                            "type": "string_end",
                                                            "label": "\"",
                                                            "start_token": 307,
                                                            "end_token": 307,
                                                            "children": []
                                                        }
                                                    ]
                                                }
                                            ]
                                        },
                                        {
                                            "type": "keyword_argument",
                                            "label": "api_key=SecretStr(settings.secrets.groq_api_key)",
                                            "start_token": 310,
                                            "end_token": 319,
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "label": "api_key",
                                                    "start_token": 310,
                                                    "end_token": 310,
                                                    "children": []
                                                },
                                                {
                                                    "type": "call",
                                                    "label": "SecretStr(settings.secrets.groq_api_key)",
                                                    "start_token": 312,
                                                    "end_token": 319,
                                                    "children": [
                                                        {
                                                            "type": "identifier",
                                                            "label": "SecretStr",
                                                            "start_token": 312,
                                                            "end_token": 312,
                                                            "children": []
                                                        },
                                                        {
                                                            "type": "argument_list",
                                                            "label": "(settings.secrets.groq_api_key)",
                                                            "start_token": 313,
                                                            "end_token": 319,
                                                            "children": [
                                                                {
                                                                    "type": "attribute",
                                                                    "label": "settings.secrets.groq_api_key",
                                                                    "start_token": 314,
                                                                    "end_token": 318,
                                                                    "children": [
                                                                        {
                                                                            "type": "attribute",
                                                                            "label": "settings.secrets",
                                                                            "start_token": 314,
                                                                            "end_token": 316,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "settings",
                                                                                    "start_token": 314,
                                                                                    "end_token": 314,
                                                                                    "children": []
                                                                                },
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "secrets",
                                                                                    "start_token": 316,
                                                                                    "end_token": 316,
                                                                                    "children": []
                                                                                }
                                                                            ]
                                                                        },
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "groq_api_key",
                                                                            "start_token": 318,
                                                                            "end_token": 318,
                                                                            "children": []
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                }
                                            ]
                                        },
                                        {
                                            "type": "keyword_argument",
                                            "label": "title=\"Use Credits for Groq\"",
                                            "start_token": 322,
                                            "end_token": 324,
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "label": "title",
                                                    "start_token": 322,
                                                    "end_token": 322,
                                                    "children": []
                                                },
                                                {
                                                    "type": "string",
                                                    "label": "\"Use Credits for Groq\"",
                                                    "start_token": 324,
                                                    "end_token": 324,
                                                    "children": [
                                                        {
                                                            "type": "string_start",
                                                            "label": "\"",
                                                            "start_token": 324,
                                                            "end_token": 324,
                                                            "children": []
                                                        },
                                                        {
                                                            "type": "string_content",
                                                            "label": "Use Credits for Groq",
                                                            "start_token": 324,
                                                            "end_token": 324,
                                                            "children": []
                                                        },
                                                        {
                                                            "type": "string_end",
                                                            "label": "\"",
                                                            "start_token": 324,
                                                            "end_token": 324,
                                                            "children": []
                                                        }
                                                    ]
                                                }
                                            ]
                                        },
                                        {
                                            "type": "keyword_argument",
                                            "label": "expires_at=None",
                                            "start_token": 327,
                                            "end_token": 329,
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "label": "expires_at",
                                                    "start_token": 327,
                                                    "end_token": 327,
                                                    "children": []
                                                },
                                                {
                                                    "type": "none",
                                                    "label": "None",
                                                    "start_token": 329,
                                                    "end_token": 329,
                                                    "children": []
                                                }
                                            ]
                                        }
                                    ]
                                }
                            ]
                        }
                    ]
                }
            ]
        },
        {
            "type": "expression_statement",
            "label": "did_credentials = APIKeyCredentials(\n    id=\"7f7b0654-c36b-4565-8fa7-9a52575dfae2\",\n    provider=\"d_id\",\n    api_key=SecretStr(settings.secrets.did_api_key),\n    title=\"Use Credits for D-ID\",\n    expires_at=None,\n)",
            "start_token": 334,
            "end_token": 371,
            "children": [
                {
                    "type": "assignment",
                    "label": "did_credentials = APIKeyCredentials(\n    id=\"7f7b0654-c36b-4565-8fa7-9a52575dfae2\",\n    provider=\"d_id\",\n    api_key=SecretStr(settings.secrets.did_api_key),\n    title=\"Use Credits for D-ID\",\n    expires_at=None,\n)",
                    "start_token": 334,
                    "end_token": 371,
                    "children": [
                        {
                            "type": "identifier",
                            "label": "did_credentials",
                            "start_token": 334,
                            "end_token": 334,
                            "children": []
                        },
                        {
                            "type": "call",
                            "label": "APIKeyCredentials(\n    id=\"7f7b0654-c36b-4565-8fa7-9a52575dfae2\",\n    provider=\"d_id\",\n    api_key=SecretStr(settings.secrets.did_api_key),\n    title=\"Use Credits for D-ID\",\n    expires_at=None,\n)",
                            "start_token": 336,
                            "end_token": 371,
                            "children": [
                                {
                                    "type": "identifier",
                                    "label": "APIKeyCredentials",
                                    "start_token": 336,
                                    "end_token": 336,
                                    "children": []
                                },
                                {
                                    "type": "argument_list",
                                    "label": "(\n    id=\"7f7b0654-c36b-4565-8fa7-9a52575dfae2\",\n    provider=\"d_id\",\n    api_key=SecretStr(settings.secrets.did_api_key),\n    title=\"Use Credits for D-ID\",\n    expires_at=None,\n)",
                                    "start_token": 337,
                                    "end_token": 371,
                                    "children": [
                                        {
                                            "type": "keyword_argument",
                                            "label": "id=\"7f7b0654-c36b-4565-8fa7-9a52575dfae2\"",
                                            "start_token": 339,
                                            "end_token": 341,
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "label": "id",
                                                    "start_token": 339,
                                                    "end_token": 339,
                                                    "children": []
                                                },
                                                {
                                                    "type": "string",
                                                    "label": "\"7f7b0654-c36b-4565-8fa7-9a52575dfae2\"",
                                                    "start_token": 341,
                                                    "end_token": 341,
                                                    "children": [
                                                        {
                                                            "type": "string_start",
                                                            "label": "\"",
                                                            "start_token": 341,
                                                            "end_token": 341,
                                                            "children": []
                                                        },
                                                        {
                                                            "type": "string_content",
                                                            "label": "7f7b0654-c36b-4565-8fa7-9a52575dfae2",
                                                            "start_token": 341,
                                                            "end_token": 341,
                                                            "children": []
                                                        },
                                                        {
                                                            "type": "string_end",
                                                            "label": "\"",
                                                            "start_token": 341,
                                                            "end_token": 341,
                                                            "children": []
                                                        }
                                                    ]
                                                }
                                            ]
                                        },
                                        {
                                            "type": "keyword_argument",
                                            "label": "provider=\"d_id\"",
                                            "start_token": 344,
                                            "end_token": 346,
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "label": "provider",
                                                    "start_token": 344,
                                                    "end_token": 344,
                                                    "children": []
                                                },
                                                {
                                                    "type": "string",
                                                    "label": "\"d_id\"",
                                                    "start_token": 346,
                                                    "end_token": 346,
                                                    "children": [
                                                        {
                                                            "type": "string_start",
                                                            "label": "\"",
                                                            "start_token": 346,
                                                            "end_token": 346,
                                                            "children": []
                                                        },
                                                        {
                                                            "type": "string_content",
                                                            "label": "d_id",
                                                            "start_token": 346,
                                                            "end_token": 346,
                                                            "children": []
                                                        },
                                                        {
                                                            "type": "string_end",
                                                            "label": "\"",
                                                            "start_token": 346,
                                                            "end_token": 346,
                                                            "children": []
                                                        }
                                                    ]
                                                }
                                            ]
                                        },
                                        {
                                            "type": "keyword_argument",
                                            "label": "api_key=SecretStr(settings.secrets.did_api_key)",
                                            "start_token": 349,
                                            "end_token": 358,
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "label": "api_key",
                                                    "start_token": 349,
                                                    "end_token": 349,
                                                    "children": []
                                                },
                                                {
                                                    "type": "call",
                                                    "label": "SecretStr(settings.secrets.did_api_key)",
                                                    "start_token": 351,
                                                    "end_token": 358,
                                                    "children": [
                                                        {
                                                            "type": "identifier",
                                                            "label": "SecretStr",
                                                            "start_token": 351,
                                                            "end_token": 351,
                                                            "children": []
                                                        },
                                                        {
                                                            "type": "argument_list",
                                                            "label": "(settings.secrets.did_api_key)",
                                                            "start_token": 352,
                                                            "end_token": 358,
                                                            "children": [
                                                                {
                                                                    "type": "attribute",
                                                                    "label": "settings.secrets.did_api_key",
                                                                    "start_token": 353,
                                                                    "end_token": 357,
                                                                    "children": [
                                                                        {
                                                                            "type": "attribute",
                                                                            "label": "settings.secrets",
                                                                            "start_token": 353,
                                                                            "end_token": 355,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "settings",
                                                                                    "start_token": 353,
                                                                                    "end_token": 353,
                                                                                    "children": []
                                                                                },
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "secrets",
                                                                                    "start_token": 355,
                                                                                    "end_token": 355,
                                                                                    "children": []
                                                                                }
                                                                            ]
                                                                        },
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "did_api_key",
                                                                            "start_token": 357,
                                                                            "end_token": 357,
                                                                            "children": []
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                }
                                            ]
                                        },
                                        {
                                            "type": "keyword_argument",
                                            "label": "title=\"Use Credits for D-ID\"",
                                            "start_token": 361,
                                            "end_token": 363,
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "label": "title",
                                                    "start_token": 361,
                                                    "end_token": 361,
                                                    "children": []
                                                },
                                                {
                                                    "type": "string",
                                                    "label": "\"Use Credits for D-ID\"",
                                                    "start_token": 363,
                                                    "end_token": 363,
                                                    "children": [
                                                        {
                                                            "type": "string_start",
                                                            "label": "\"",
                                                            "start_token": 363,
                                                            "end_token": 363,
                                                            "children": []
                                                        },
                                                        {
                                                            "type": "string_content",
                                                            "label": "Use Credits for D-ID",
                                                            "start_token": 363,
                                                            "end_token": 363,
                                                            "children": []
                                                        },
                                                        {
                                                            "type": "string_end",
                                                            "label": "\"",
                                                            "start_token": 363,
                                                            "end_token": 363,
                                                            "children": []
                                                        }
                                                    ]
                                                }
                                            ]
                                        },
                                        {
                                            "type": "keyword_argument",
                                            "label": "expires_at=None",
                                            "start_token": 366,
                                            "end_token": 368,
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "label": "expires_at",
                                                    "start_token": 366,
                                                    "end_token": 366,
                                                    "children": []
                                                },
                                                {
                                                    "type": "none",
                                                    "label": "None",
                                                    "start_token": 368,
                                                    "end_token": 368,
                                                    "children": []
                                                }
                                            ]
                                        }
                                    ]
                                }
                            ]
                        }
                    ]
                }
            ]
        },
        {
            "type": "expression_statement",
            "label": "jina_credentials = APIKeyCredentials(\n    id=\"7f26de70-ba0d-494e-ba76-238e65e7b45f\",\n    provider=\"jina\",\n    api_key=SecretStr(settings.secrets.jina_api_key),\n    title=\"Use Credits for Jina\",\n    expires_at=None,\n)",
            "start_token": 373,
            "end_token": 410,
            "children": [
                {
                    "type": "assignment",
                    "label": "jina_credentials = APIKeyCredentials(\n    id=\"7f26de70-ba0d-494e-ba76-238e65e7b45f\",\n    provider=\"jina\",\n    api_key=SecretStr(settings.secrets.jina_api_key),\n    title=\"Use Credits for Jina\",\n    expires_at=None,\n)",
                    "start_token": 373,
                    "end_token": 410,
                    "children": [
                        {
                            "type": "identifier",
                            "label": "jina_credentials",
                            "start_token": 373,
                            "end_token": 373,
                            "children": []
                        },
                        {
                            "type": "call",
                            "label": "APIKeyCredentials(\n    id=\"7f26de70-ba0d-494e-ba76-238e65e7b45f\",\n    provider=\"jina\",\n    api_key=SecretStr(settings.secrets.jina_api_key),\n    title=\"Use Credits for Jina\",\n    expires_at=None,\n)",
                            "start_token": 375,
                            "end_token": 410,
                            "children": [
                                {
                                    "type": "identifier",
                                    "label": "APIKeyCredentials",
                                    "start_token": 375,
                                    "end_token": 375,
                                    "children": []
                                },
                                {
                                    "type": "argument_list",
                                    "label": "(\n    id=\"7f26de70-ba0d-494e-ba76-238e65e7b45f\",\n    provider=\"jina\",\n    api_key=SecretStr(settings.secrets.jina_api_key),\n    title=\"Use Credits for Jina\",\n    expires_at=None,\n)",
                                    "start_token": 376,
                                    "end_token": 410,
                                    "children": [
                                        {
                                            "type": "keyword_argument",
                                            "label": "id=\"7f26de70-ba0d-494e-ba76-238e65e7b45f\"",
                                            "start_token": 378,
                                            "end_token": 380,
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "label": "id",
                                                    "start_token": 378,
                                                    "end_token": 378,
                                                    "children": []
                                                },
                                                {
                                                    "type": "string",
                                                    "label": "\"7f26de70-ba0d-494e-ba76-238e65e7b45f\"",
                                                    "start_token": 380,
                                                    "end_token": 380,
                                                    "children": [
                                                        {
                                                            "type": "string_start",
                                                            "label": "\"",
                                                            "start_token": 380,
                                                            "end_token": 380,
                                                            "children": []
                                                        },
                                                        {
                                                            "type": "string_content",
                                                            "label": "7f26de70-ba0d-494e-ba76-238e65e7b45f",
                                                            "start_token": 380,
                                                            "end_token": 380,
                                                            "children": []
                                                        },
                                                        {
                                                            "type": "string_end",
                                                            "label": "\"",
                                                            "start_token": 380,
                                                            "end_token": 380,
                                                            "children": []
                                                        }
                                                    ]
                                                }
                                            ]
                                        },
                                        {
                                            "type": "keyword_argument",
                                            "label": "provider=\"jina\"",
                                            "start_token": 383,
                                            "end_token": 385,
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "label": "provider",
                                                    "start_token": 383,
                                                    "end_token": 383,
                                                    "children": []
                                                },
                                                {
                                                    "type": "string",
                                                    "label": "\"jina\"",
                                                    "start_token": 385,
                                                    "end_token": 385,
                                                    "children": [
                                                        {
                                                            "type": "string_start",
                                                            "label": "\"",
                                                            "start_token": 385,
                                                            "end_token": 385,
                                                            "children": []
                                                        },
                                                        {
                                                            "type": "string_content",
                                                            "label": "jina",
                                                            "start_token": 385,
                                                            "end_token": 385,
                                                            "children": []
                                                        },
                                                        {
                                                            "type": "string_end",
                                                            "label": "\"",
                                                            "start_token": 385,
                                                            "end_token": 385,
                                                            "children": []
                                                        }
                                                    ]
                                                }
                                            ]
                                        },
                                        {
                                            "type": "keyword_argument",
                                            "label": "api_key=SecretStr(settings.secrets.jina_api_key)",
                                            "start_token": 388,
                                            "end_token": 397,
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "label": "api_key",
                                                    "start_token": 388,
                                                    "end_token": 388,
                                                    "children": []
                                                },
                                                {
                                                    "type": "call",
                                                    "label": "SecretStr(settings.secrets.jina_api_key)",
                                                    "start_token": 390,
                                                    "end_token": 397,
                                                    "children": [
                                                        {
                                                            "type": "identifier",
                                                            "label": "SecretStr",
                                                            "start_token": 390,
                                                            "end_token": 390,
                                                            "children": []
                                                        },
                                                        {
                                                            "type": "argument_list",
                                                            "label": "(settings.secrets.jina_api_key)",
                                                            "start_token": 391,
                                                            "end_token": 397,
                                                            "children": [
                                                                {
                                                                    "type": "attribute",
                                                                    "label": "settings.secrets.jina_api_key",
                                                                    "start_token": 392,
                                                                    "end_token": 396,
                                                                    "children": [
                                                                        {
                                                                            "type": "attribute",
                                                                            "label": "settings.secrets",
                                                                            "start_token": 392,
                                                                            "end_token": 394,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "settings",
                                                                                    "start_token": 392,
                                                                                    "end_token": 392,
                                                                                    "children": []
                                                                                },
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "secrets",
                                                                                    "start_token": 394,
                                                                                    "end_token": 394,
                                                                                    "children": []
                                                                                }
                                                                            ]
                                                                        },
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "jina_api_key",
                                                                            "start_token": 396,
                                                                            "end_token": 396,
                                                                            "children": []
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                }
                                            ]
                                        },
                                        {
                                            "type": "keyword_argument",
                                            "label": "title=\"Use Credits for Jina\"",
                                            "start_token": 400,
                                            "end_token": 402,
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "label": "title",
                                                    "start_token": 400,
                                                    "end_token": 400,
                                                    "children": []
                                                },
                                                {
                                                    "type": "string",
                                                    "label": "\"Use Credits for Jina\"",
                                                    "start_token": 402,
                                                    "end_token": 402,
                                                    "children": [
                                                        {
                                                            "type": "string_start",
                                                            "label": "\"",
                                                            "start_token": 402,
                                                            "end_token": 402,
                                                            "children": []
                                                        },
                                                        {
                                                            "type": "string_content",
                                                            "label": "Use Credits for Jina",
                                                            "start_token": 402,
                                                            "end_token": 402,
                                                            "children": []
                                                        },
                                                        {
                                                            "type": "string_end",
                                                            "label": "\"",
                                                            "start_token": 402,
                                                            "end_token": 402,
                                                            "children": []
                                                        }
                                                    ]
                                                }
                                            ]
                                        },
                                        {
                                            "type": "keyword_argument",
                                            "label": "expires_at=None",
                                            "start_token": 405,
                                            "end_token": 407,
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "label": "expires_at",
                                                    "start_token": 405,
                                                    "end_token": 405,
                                                    "children": []
                                                },
                                                {
                                                    "type": "none",
                                                    "label": "None",
                                                    "start_token": 407,
                                                    "end_token": 407,
                                                    "children": []
                                                }
                                            ]
                                        }
                                    ]
                                }
                            ]
                        }
                    ]
                }
            ]
        },
        {
            "type": "expression_statement",
            "label": "unreal_credentials = APIKeyCredentials(\n    id=\"66f20754-1b81-48e4-91d0-f4f0dd82145f\",\n    provider=\"unreal\",\n    api_key=SecretStr(settings.secrets.unreal_speech_api_key),\n    title=\"Use Credits for Unreal\",\n    expires_at=None,\n)",
            "start_token": 412,
            "end_token": 449,
            "children": [
                {
                    "type": "assignment",
                    "label": "unreal_credentials = APIKeyCredentials(\n    id=\"66f20754-1b81-48e4-91d0-f4f0dd82145f\",\n    provider=\"unreal\",\n    api_key=SecretStr(settings.secrets.unreal_speech_api_key),\n    title=\"Use Credits for Unreal\",\n    expires_at=None,\n)",
                    "start_token": 412,
                    "end_token": 449,
                    "children": [
                        {
                            "type": "identifier",
                            "label": "unreal_credentials",
                            "start_token": 412,
                            "end_token": 412,
                            "children": []
                        },
                        {
                            "type": "call",
                            "label": "APIKeyCredentials(\n    id=\"66f20754-1b81-48e4-91d0-f4f0dd82145f\",\n    provider=\"unreal\",\n    api_key=SecretStr(settings.secrets.unreal_speech_api_key),\n    title=\"Use Credits for Unreal\",\n    expires_at=None,\n)",
                            "start_token": 414,
                            "end_token": 449,
                            "children": [
                                {
                                    "type": "identifier",
                                    "label": "APIKeyCredentials",
                                    "start_token": 414,
                                    "end_token": 414,
                                    "children": []
                                },
                                {
                                    "type": "argument_list",
                                    "label": "(\n    id=\"66f20754-1b81-48e4-91d0-f4f0dd82145f\",\n    provider=\"unreal\",\n    api_key=SecretStr(settings.secrets.unreal_speech_api_key),\n    title=\"Use Credits for Unreal\",\n    expires_at=None,\n)",
                                    "start_token": 415,
                                    "end_token": 449,
                                    "children": [
                                        {
                                            "type": "keyword_argument",
                                            "label": "id=\"66f20754-1b81-48e4-91d0-f4f0dd82145f\"",
                                            "start_token": 417,
                                            "end_token": 419,
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "label": "id",
                                                    "start_token": 417,
                                                    "end_token": 417,
                                                    "children": []
                                                },
                                                {
                                                    "type": "string",
                                                    "label": "\"66f20754-1b81-48e4-91d0-f4f0dd82145f\"",
                                                    "start_token": 419,
                                                    "end_token": 419,
                                                    "children": [
                                                        {
                                                            "type": "string_start",
                                                            "label": "\"",
                                                            "start_token": 419,
                                                            "end_token": 419,
                                                            "children": []
                                                        },
                                                        {
                                                            "type": "string_content",
                                                            "label": "66f20754-1b81-48e4-91d0-f4f0dd82145f",
                                                            "start_token": 419,
                                                            "end_token": 419,
                                                            "children": []
                                                        },
                                                        {
                                                            "type": "string_end",
                                                            "label": "\"",
                                                            "start_token": 419,
                                                            "end_token": 419,
                                                            "children": []
                                                        }
                                                    ]
                                                }
                                            ]
                                        },
                                        {
                                            "type": "keyword_argument",
                                            "label": "provider=\"unreal\"",
                                            "start_token": 422,
                                            "end_token": 424,
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "label": "provider",
                                                    "start_token": 422,
                                                    "end_token": 422,
                                                    "children": []
                                                },
                                                {
                                                    "type": "string",
                                                    "label": "\"unreal\"",
                                                    "start_token": 424,
                                                    "end_token": 424,
                                                    "children": [
                                                        {
                                                            "type": "string_start",
                                                            "label": "\"",
                                                            "start_token": 424,
                                                            "end_token": 424,
                                                            "children": []
                                                        },
                                                        {
                                                            "type": "string_content",
                                                            "label": "unreal",
                                                            "start_token": 424,
                                                            "end_token": 424,
                                                            "children": []
                                                        },
                                                        {
                                                            "type": "string_end",
                                                            "label": "\"",
                                                            "start_token": 424,
                                                            "end_token": 424,
                                                            "children": []
                                                        }
                                                    ]
                                                }
                                            ]
                                        },
                                        {
                                            "type": "keyword_argument",
                                            "label": "api_key=SecretStr(settings.secrets.unreal_speech_api_key)",
                                            "start_token": 427,
                                            "end_token": 436,
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "label": "api_key",
                                                    "start_token": 427,
                                                    "end_token": 427,
                                                    "children": []
                                                },
                                                {
                                                    "type": "call",
                                                    "label": "SecretStr(settings.secrets.unreal_speech_api_key)",
                                                    "start_token": 429,
                                                    "end_token": 436,
                                                    "children": [
                                                        {
                                                            "type": "identifier",
                                                            "label": "SecretStr",
                                                            "start_token": 429,
                                                            "end_token": 429,
                                                            "children": []
                                                        },
                                                        {
                                                            "type": "argument_list",
                                                            "label": "(settings.secrets.unreal_speech_api_key)",
                                                            "start_token": 430,
                                                            "end_token": 436,
                                                            "children": [
                                                                {
                                                                    "type": "attribute",
                                                                    "label": "settings.secrets.unreal_speech_api_key",
                                                                    "start_token": 431,
                                                                    "end_token": 435,
                                                                    "children": [
                                                                        {
                                                                            "type": "attribute",
                                                                            "label": "settings.secrets",
                                                                            "start_token": 431,
                                                                            "end_token": 433,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "settings",
                                                                                    "start_token": 431,
                                                                                    "end_token": 431,
                                                                                    "children": []
                                                                                },
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "secrets",
                                                                                    "start_token": 433,
                                                                                    "end_token": 433,
                                                                                    "children": []
                                                                                }
                                                                            ]
                                                                        },
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "unreal_speech_api_key",
                                                                            "start_token": 435,
                                                                            "end_token": 435,
                                                                            "children": []
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                }
                                            ]
                                        },
                                        {
                                            "type": "keyword_argument",
                                            "label": "title=\"Use Credits for Unreal\"",
                                            "start_token": 439,
                                            "end_token": 441,
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "label": "title",
                                                    "start_token": 439,
                                                    "end_token": 439,
                                                    "children": []
                                                },
                                                {
                                                    "type": "string",
                                                    "label": "\"Use Credits for Unreal\"",
                                                    "start_token": 441,
                                                    "end_token": 441,
                                                    "children": [
                                                        {
                                                            "type": "string_start",
                                                            "label": "\"",
                                                            "start_token": 441,
                                                            "end_token": 441,
                                                            "children": []
                                                        },
                                                        {
                                                            "type": "string_content",
                                                            "label": "Use Credits for Unreal",
                                                            "start_token": 441,
                                                            "end_token": 441,
                                                            "children": []
                                                        },
                                                        {
                                                            "type": "string_end",
                                                            "label": "\"",
                                                            "start_token": 441,
                                                            "end_token": 441,
                                                            "children": []
                                                        }
                                                    ]
                                                }
                                            ]
                                        },
                                        {
                                            "type": "keyword_argument",
                                            "label": "expires_at=None",
                                            "start_token": 444,
                                            "end_token": 446,
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "label": "expires_at",
                                                    "start_token": 444,
                                                    "end_token": 444,
                                                    "children": []
                                                },
                                                {
                                                    "type": "none",
                                                    "label": "None",
                                                    "start_token": 446,
                                                    "end_token": 446,
                                                    "children": []
                                                }
                                            ]
                                        }
                                    ]
                                }
                            ]
                        }
                    ]
                }
            ]
        },
        {
            "type": "expression_statement",
            "label": "open_router_credentials = APIKeyCredentials(\n    id=\"b5a0e27d-0c98-4df3-a4b9-10193e1f3c40\",\n    provider=\"open_router\",\n    api_key=SecretStr(settings.secrets.open_router_api_key),\n    title=\"Use Credits for Open Router\",\n    expires_at=None,\n)",
            "start_token": 451,
            "end_token": 488,
            "children": [
                {
                    "type": "assignment",
                    "label": "open_router_credentials = APIKeyCredentials(\n    id=\"b5a0e27d-0c98-4df3-a4b9-10193e1f3c40\",\n    provider=\"open_router\",\n    api_key=SecretStr(settings.secrets.open_router_api_key),\n    title=\"Use Credits for Open Router\",\n    expires_at=None,\n)",
                    "start_token": 451,
                    "end_token": 488,
                    "children": [
                        {
                            "type": "identifier",
                            "label": "open_router_credentials",
                            "start_token": 451,
                            "end_token": 451,
                            "children": []
                        },
                        {
                            "type": "call",
                            "label": "APIKeyCredentials(\n    id=\"b5a0e27d-0c98-4df3-a4b9-10193e1f3c40\",\n    provider=\"open_router\",\n    api_key=SecretStr(settings.secrets.open_router_api_key),\n    title=\"Use Credits for Open Router\",\n    expires_at=None,\n)",
                            "start_token": 453,
                            "end_token": 488,
                            "children": [
                                {
                                    "type": "identifier",
                                    "label": "APIKeyCredentials",
                                    "start_token": 453,
                                    "end_token": 453,
                                    "children": []
                                },
                                {
                                    "type": "argument_list",
                                    "label": "(\n    id=\"b5a0e27d-0c98-4df3-a4b9-10193e1f3c40\",\n    provider=\"open_router\",\n    api_key=SecretStr(settings.secrets.open_router_api_key),\n    title=\"Use Credits for Open Router\",\n    expires_at=None,\n)",
                                    "start_token": 454,
                                    "end_token": 488,
                                    "children": [
                                        {
                                            "type": "keyword_argument",
                                            "label": "id=\"b5a0e27d-0c98-4df3-a4b9-10193e1f3c40\"",
                                            "start_token": 456,
                                            "end_token": 458,
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "label": "id",
                                                    "start_token": 456,
                                                    "end_token": 456,
                                                    "children": []
                                                },
                                                {
                                                    "type": "string",
                                                    "label": "\"b5a0e27d-0c98-4df3-a4b9-10193e1f3c40\"",
                                                    "start_token": 458,
                                                    "end_token": 458,
                                                    "children": [
                                                        {
                                                            "type": "string_start",
                                                            "label": "\"",
                                                            "start_token": 458,
                                                            "end_token": 458,
                                                            "children": []
                                                        },
                                                        {
                                                            "type": "string_content",
                                                            "label": "b5a0e27d-0c98-4df3-a4b9-10193e1f3c40",
                                                            "start_token": 458,
                                                            "end_token": 458,
                                                            "children": []
                                                        },
                                                        {
                                                            "type": "string_end",
                                                            "label": "\"",
                                                            "start_token": 458,
                                                            "end_token": 458,
                                                            "children": []
                                                        }
                                                    ]
                                                }
                                            ]
                                        },
                                        {
                                            "type": "keyword_argument",
                                            "label": "provider=\"open_router\"",
                                            "start_token": 461,
                                            "end_token": 463,
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "label": "provider",
                                                    "start_token": 461,
                                                    "end_token": 461,
                                                    "children": []
                                                },
                                                {
                                                    "type": "string",
                                                    "label": "\"open_router\"",
                                                    "start_token": 463,
                                                    "end_token": 463,
                                                    "children": [
                                                        {
                                                            "type": "string_start",
                                                            "label": "\"",
                                                            "start_token": 463,
                                                            "end_token": 463,
                                                            "children": []
                                                        },
                                                        {
                                                            "type": "string_content",
                                                            "label": "open_router",
                                                            "start_token": 463,
                                                            "end_token": 463,
                                                            "children": []
                                                        },
                                                        {
                                                            "type": "string_end",
                                                            "label": "\"",
                                                            "start_token": 463,
                                                            "end_token": 463,
                                                            "children": []
                                                        }
                                                    ]
                                                }
                                            ]
                                        },
                                        {
                                            "type": "keyword_argument",
                                            "label": "api_key=SecretStr(settings.secrets.open_router_api_key)",
                                            "start_token": 466,
                                            "end_token": 475,
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "label": "api_key",
                                                    "start_token": 466,
                                                    "end_token": 466,
                                                    "children": []
                                                },
                                                {
                                                    "type": "call",
                                                    "label": "SecretStr(settings.secrets.open_router_api_key)",
                                                    "start_token": 468,
                                                    "end_token": 475,
                                                    "children": [
                                                        {
                                                            "type": "identifier",
                                                            "label": "SecretStr",
                                                            "start_token": 468,
                                                            "end_token": 468,
                                                            "children": []
                                                        },
                                                        {
                                                            "type": "argument_list",
                                                            "label": "(settings.secrets.open_router_api_key)",
                                                            "start_token": 469,
                                                            "end_token": 475,
                                                            "children": [
                                                                {
                                                                    "type": "attribute",
                                                                    "label": "settings.secrets.open_router_api_key",
                                                                    "start_token": 470,
                                                                    "end_token": 474,
                                                                    "children": [
                                                                        {
                                                                            "type": "attribute",
                                                                            "label": "settings.secrets",
                                                                            "start_token": 470,
                                                                            "end_token": 472,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "settings",
                                                                                    "start_token": 470,
                                                                                    "end_token": 470,
                                                                                    "children": []
                                                                                },
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "secrets",
                                                                                    "start_token": 472,
                                                                                    "end_token": 472,
                                                                                    "children": []
                                                                                }
                                                                            ]
                                                                        },
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "open_router_api_key",
                                                                            "start_token": 474,
                                                                            "end_token": 474,
                                                                            "children": []
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                }
                                            ]
                                        },
                                        {
                                            "type": "keyword_argument",
                                            "label": "title=\"Use Credits for Open Router\"",
                                            "start_token": 478,
                                            "end_token": 480,
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "label": "title",
                                                    "start_token": 478,
                                                    "end_token": 478,
                                                    "children": []
                                                },
                                                {
                                                    "type": "string",
                                                    "label": "\"Use Credits for Open Router\"",
                                                    "start_token": 480,
                                                    "end_token": 480,
                                                    "children": [
                                                        {
                                                            "type": "string_start",
                                                            "label": "\"",
                                                            "start_token": 480,
                                                            "end_token": 480,
                                                            "children": []
                                                        },
                                                        {
                                                            "type": "string_content",
                                                            "label": "Use Credits for Open Router",
                                                            "start_token": 480,
                                                            "end_token": 480,
                                                            "children": []
                                                        },
                                                        {
                                                            "type": "string_end",
                                                            "label": "\"",
                                                            "start_token": 480,
                                                            "end_token": 480,
                                                            "children": []
                                                        }
                                                    ]
                                                }
                                            ]
                                        },
                                        {
                                            "type": "keyword_argument",
                                            "label": "expires_at=None",
                                            "start_token": 483,
                                            "end_token": 485,
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "label": "expires_at",
                                                    "start_token": 483,
                                                    "end_token": 483,
                                                    "children": []
                                                },
                                                {
                                                    "type": "none",
                                                    "label": "None",
                                                    "start_token": 485,
                                                    "end_token": 485,
                                                    "children": []
                                                }
                                            ]
                                        }
                                    ]
                                }
                            ]
                        }
                    ]
                }
            ]
        },
        {
            "type": "expression_statement",
            "label": "DEFAULT_CREDENTIALS = [\n    revid_credentials,\n    ideogram_credentials,\n    replicate_credentials,\n    openai_credentials,\n    anthropic_credentials,\n    groq_credentials,\n    did_credentials,\n    jina_credentials,\n    unreal_credentials,\n    open_router_credentials,\n]",
            "start_token": 492,
            "end_token": 526,
            "children": [
                {
                    "type": "assignment",
                    "label": "DEFAULT_CREDENTIALS = [\n    revid_credentials,\n    ideogram_credentials,\n    replicate_credentials,\n    openai_credentials,\n    anthropic_credentials,\n    groq_credentials,\n    did_credentials,\n    jina_credentials,\n    unreal_credentials,\n    open_router_credentials,\n]",
                    "start_token": 492,
                    "end_token": 526,
                    "children": [
                        {
                            "type": "identifier",
                            "label": "DEFAULT_CREDENTIALS",
                            "start_token": 492,
                            "end_token": 492,
                            "children": []
                        },
                        {
                            "type": "list",
                            "label": "[\n    revid_credentials,\n    ideogram_credentials,\n    replicate_credentials,\n    openai_credentials,\n    anthropic_credentials,\n    groq_credentials,\n    did_credentials,\n    jina_credentials,\n    unreal_credentials,\n    open_router_credentials,\n]",
                            "start_token": 494,
                            "end_token": 526,
                            "children": [
                                {
                                    "type": "identifier",
                                    "label": "revid_credentials",
                                    "start_token": 496,
                                    "end_token": 496,
                                    "children": []
                                },
                                {
                                    "type": "identifier",
                                    "label": "ideogram_credentials",
                                    "start_token": 499,
                                    "end_token": 499,
                                    "children": []
                                },
                                {
                                    "type": "identifier",
                                    "label": "replicate_credentials",
                                    "start_token": 502,
                                    "end_token": 502,
                                    "children": []
                                },
                                {
                                    "type": "identifier",
                                    "label": "openai_credentials",
                                    "start_token": 505,
                                    "end_token": 505,
                                    "children": []
                                },
                                {
                                    "type": "identifier",
                                    "label": "anthropic_credentials",
                                    "start_token": 508,
                                    "end_token": 508,
                                    "children": []
                                },
                                {
                                    "type": "identifier",
                                    "label": "groq_credentials",
                                    "start_token": 511,
                                    "end_token": 511,
                                    "children": []
                                },
                                {
                                    "type": "identifier",
                                    "label": "did_credentials",
                                    "start_token": 514,
                                    "end_token": 514,
                                    "children": []
                                },
                                {
                                    "type": "identifier",
                                    "label": "jina_credentials",
                                    "start_token": 517,
                                    "end_token": 517,
                                    "children": []
                                },
                                {
                                    "type": "identifier",
                                    "label": "unreal_credentials",
                                    "start_token": 520,
                                    "end_token": 520,
                                    "children": []
                                },
                                {
                                    "type": "identifier",
                                    "label": "open_router_credentials",
                                    "start_token": 523,
                                    "end_token": 523,
                                    "children": []
                                }
                            ]
                        }
                    ]
                }
            ]
        },
        {
            "type": "class_definition",
            "label": "class IntegrationCredentialsStore:\n    def __init__(self):\n        from backend.data.redis import get_redis\n\n        self.locks = RedisKeyedMutex(get_redis())\n\n    @property\n    @thread_cached\n    def db_manager(self) -> \"DatabaseManager\":\n        from backend.executor.database import DatabaseManager\n        from backend.util.service import get_service_client\n\n        return get_service_client(DatabaseManager)\n\n    def add_creds(self, user_id: str, credentials: Credentials) -> None:\n        with self.locked_user_integrations(user_id):\n            if self.get_creds_by_id(user_id, credentials.id):\n                raise ValueError(\n                    f\"Can not re-create existing credentials #{credentials.id} \"\n                    f\"for user #{user_id}\"\n                )\n            self._set_user_integration_creds(\n                user_id, [*self.get_all_creds(user_id), credentials]\n            )\n\n    def get_all_creds(self, user_id: str) -> list[Credentials]:\n        users_credentials = self._get_user_integrations(user_id).credentials\n        all_credentials = users_credentials\n        if settings.secrets.revid_api_key:\n            all_credentials.append(revid_credentials)\n        if settings.secrets.ideogram_api_key:\n            all_credentials.append(ideogram_credentials)\n        if settings.secrets.groq_api_key:\n            all_credentials.append(groq_credentials)\n        if settings.secrets.replicate_api_key:\n            all_credentials.append(replicate_credentials)\n        if settings.secrets.openai_api_key:\n            all_credentials.append(openai_credentials)\n        if settings.secrets.anthropic_api_key:\n            all_credentials.append(anthropic_credentials)\n        if settings.secrets.did_api_key:\n            all_credentials.append(did_credentials)\n        if settings.secrets.jina_api_key:\n            all_credentials.append(jina_credentials)\n        if settings.secrets.unreal_speech_api_key:\n            all_credentials.append(unreal_credentials)\n        if settings.secrets.open_router_api_key:\n            all_credentials.append(open_router_credentials)\n        return all_credentials\n\n    def get_creds_by_id(self, user_id: str, credentials_id: str) -> Credentials | None:\n        all_credentials = self.get_all_creds(user_id)\n        return next((c for c in all_credentials if c.id == credentials_id), None)\n\n    def get_creds_by_provider(self, user_id: str, provider: str) -> list[Credentials]:\n        credentials = self.get_all_creds(user_id)\n        return [c for c in credentials if c.provider == provider]\n\n    def get_authorized_providers(self, user_id: str) -> list[str]:\n        credentials = self.get_all_creds(user_id)\n        return list(set(c.provider for c in credentials))\n\n    def update_creds(self, user_id: str, updated: Credentials) -> None:\n        with self.locked_user_integrations(user_id):\n            current = self.get_creds_by_id(user_id, updated.id)\n            if not current:\n                raise ValueError(\n                    f\"Credentials with ID {updated.id} \"\n                    f\"for user with ID {user_id} not found\"\n                )\n            if type(current) is not type(updated):\n                raise TypeError(\n                    f\"Can not update credentials with ID {updated.id} \"\n                    f\"from type {type(current)} \"\n                    f\"to type {type(updated)}\"\n                )\n\n            # Ensure no scopes are removed when updating credentials\n            if (\n                isinstance(updated, OAuth2Credentials)\n                and isinstance(current, OAuth2Credentials)\n                and not set(updated.scopes).issuperset(current.scopes)\n            ):\n                raise ValueError(\n                    f\"Can not update credentials with ID {updated.id} \"\n                    f\"and scopes {current.scopes} \"\n                    f\"to more restrictive set of scopes {updated.scopes}\"\n                )\n\n            # Update the credentials\n            updated_credentials_list = [\n                updated if c.id == updated.id else c\n                for c in self.get_all_creds(user_id)\n            ]\n            self._set_user_integration_creds(user_id, updated_credentials_list)\n\n    def delete_creds_by_id(self, user_id: str, credentials_id: str) -> None:\n        with self.locked_user_integrations(user_id):\n            filtered_credentials = [\n                c for c in self.get_all_creds(user_id) if c.id != credentials_id\n            ]\n            self._set_user_integration_creds(user_id, filtered_credentials)\n\n    def store_state_token(self, user_id: str, provider: str, scopes: list[str]) -> str:\n        token = secrets.token_urlsafe(32)\n        expires_at = datetime.now(timezone.utc) + timedelta(minutes=10)\n\n        state = OAuthState(\n            token=token,\n            provider=provider,\n            expires_at=int(expires_at.timestamp()),\n            scopes=scopes,\n        )\n\n        with self.locked_user_integrations(user_id):\n            user_integrations = self._get_user_integrations(user_id)\n            oauth_states = user_integrations.oauth_states\n            oauth_states.append(state)\n            user_integrations.oauth_states = oauth_states\n\n            self.db_manager.update_user_integrations(\n                user_id=user_id, data=user_integrations\n            )\n\n        return token\n\n    def get_any_valid_scopes_from_state_token(\n        self, user_id: str, token: str, provider: str\n    ) -> list[str]:\n        \"\"\"\n        Get the valid scopes from the OAuth state token. This will return any valid scopes\n        from any OAuth state token for the given provider. If no valid scopes are found,\n        an empty list is returned. DO NOT RELY ON THIS TOKEN TO AUTHENTICATE A USER, AS IT\n        IS TO CHECK IF THE USER HAS GIVEN PERMISSIONS TO THE APPLICATION BEFORE EXCHANGING\n        THE CODE FOR TOKENS.\n        \"\"\"\n        user_integrations = self._get_user_integrations(user_id)\n        oauth_states = user_integrations.oauth_states\n\n        now = datetime.now(timezone.utc)\n        valid_state = next(\n            (\n                state\n                for state in oauth_states\n                if state.token == token\n                and state.provider == provider\n                and state.expires_at > now.timestamp()\n            ),\n            None,\n        )\n\n        if valid_state:\n            return valid_state.scopes\n\n        return []\n\n    def verify_state_token(self, user_id: str, token: str, provider: str) -> bool:\n        with self.locked_user_integrations(user_id):\n            user_integrations = self._get_user_integrations(user_id)\n            oauth_states = user_integrations.oauth_states\n\n            now = datetime.now(timezone.utc)\n            valid_state = next(\n                (\n                    state\n                    for state in oauth_states\n                    if state.token == token\n                    and state.provider == provider\n                    and state.expires_at > now.timestamp()\n                ),\n                None,\n            )\n\n            if valid_state:\n                # Remove the used state\n                oauth_states.remove(valid_state)\n                user_integrations.oauth_states = oauth_states\n                self.db_manager.update_user_integrations(user_id, user_integrations)\n                return True\n\n        return False\n\n    def _set_user_integration_creds(\n        self, user_id: str, credentials: list[Credentials]\n    ) -> None:\n        integrations = self._get_user_integrations(user_id)\n        # Remove default credentials from the list\n        credentials = [c for c in credentials if c not in DEFAULT_CREDENTIALS]\n        integrations.credentials = credentials\n        self.db_manager.update_user_integrations(user_id, integrations)\n\n    def _get_user_integrations(self, user_id: str) -> UserIntegrations:\n        integrations: UserIntegrations = self.db_manager.get_user_integrations(\n            user_id=user_id\n        )\n        return integrations\n\n    def locked_user_integrations(self, user_id: str):\n        key = (f\"user:{user_id}\", \"integrations\")\n        return self.locks.locked(key)",
            "start_token": 530,
            "end_token": 1816,
            "children": [
                {
                    "type": "identifier",
                    "label": "IntegrationCredentialsStore",
                    "start_token": 531,
                    "end_token": 531,
                    "children": []
                },
                {
                    "type": "block",
                    "label": "def __init__(self):\n        from backend.data.redis import get_redis\n\n        self.locks = RedisKeyedMutex(get_redis())\n\n    @property\n    @thread_cached\n    def db_manager(self) -> \"DatabaseManager\":\n        from backend.executor.database import DatabaseManager\n        from backend.util.service import get_service_client\n\n        return get_service_client(DatabaseManager)\n\n    def add_creds(self, user_id: str, credentials: Credentials) -> None:\n        with self.locked_user_integrations(user_id):\n            if self.get_creds_by_id(user_id, credentials.id):\n                raise ValueError(\n                    f\"Can not re-create existing credentials #{credentials.id} \"\n                    f\"for user #{user_id}\"\n                )\n            self._set_user_integration_creds(\n                user_id, [*self.get_all_creds(user_id), credentials]\n            )\n\n    def get_all_creds(self, user_id: str) -> list[Credentials]:\n        users_credentials = self._get_user_integrations(user_id).credentials\n        all_credentials = users_credentials\n        if settings.secrets.revid_api_key:\n            all_credentials.append(revid_credentials)\n        if settings.secrets.ideogram_api_key:\n            all_credentials.append(ideogram_credentials)\n        if settings.secrets.groq_api_key:\n            all_credentials.append(groq_credentials)\n        if settings.secrets.replicate_api_key:\n            all_credentials.append(replicate_credentials)\n        if settings.secrets.openai_api_key:\n            all_credentials.append(openai_credentials)\n        if settings.secrets.anthropic_api_key:\n            all_credentials.append(anthropic_credentials)\n        if settings.secrets.did_api_key:\n            all_credentials.append(did_credentials)\n        if settings.secrets.jina_api_key:\n            all_credentials.append(jina_credentials)\n        if settings.secrets.unreal_speech_api_key:\n            all_credentials.append(unreal_credentials)\n        if settings.secrets.open_router_api_key:\n            all_credentials.append(open_router_credentials)\n        return all_credentials\n\n    def get_creds_by_id(self, user_id: str, credentials_id: str) -> Credentials | None:\n        all_credentials = self.get_all_creds(user_id)\n        return next((c for c in all_credentials if c.id == credentials_id), None)\n\n    def get_creds_by_provider(self, user_id: str, provider: str) -> list[Credentials]:\n        credentials = self.get_all_creds(user_id)\n        return [c for c in credentials if c.provider == provider]\n\n    def get_authorized_providers(self, user_id: str) -> list[str]:\n        credentials = self.get_all_creds(user_id)\n        return list(set(c.provider for c in credentials))\n\n    def update_creds(self, user_id: str, updated: Credentials) -> None:\n        with self.locked_user_integrations(user_id):\n            current = self.get_creds_by_id(user_id, updated.id)\n            if not current:\n                raise ValueError(\n                    f\"Credentials with ID {updated.id} \"\n                    f\"for user with ID {user_id} not found\"\n                )\n            if type(current) is not type(updated):\n                raise TypeError(\n                    f\"Can not update credentials with ID {updated.id} \"\n                    f\"from type {type(current)} \"\n                    f\"to type {type(updated)}\"\n                )\n\n            # Ensure no scopes are removed when updating credentials\n            if (\n                isinstance(updated, OAuth2Credentials)\n                and isinstance(current, OAuth2Credentials)\n                and not set(updated.scopes).issuperset(current.scopes)\n            ):\n                raise ValueError(\n                    f\"Can not update credentials with ID {updated.id} \"\n                    f\"and scopes {current.scopes} \"\n                    f\"to more restrictive set of scopes {updated.scopes}\"\n                )\n\n            # Update the credentials\n            updated_credentials_list = [\n                updated if c.id == updated.id else c\n                for c in self.get_all_creds(user_id)\n            ]\n            self._set_user_integration_creds(user_id, updated_credentials_list)\n\n    def delete_creds_by_id(self, user_id: str, credentials_id: str) -> None:\n        with self.locked_user_integrations(user_id):\n            filtered_credentials = [\n                c for c in self.get_all_creds(user_id) if c.id != credentials_id\n            ]\n            self._set_user_integration_creds(user_id, filtered_credentials)\n\n    def store_state_token(self, user_id: str, provider: str, scopes: list[str]) -> str:\n        token = secrets.token_urlsafe(32)\n        expires_at = datetime.now(timezone.utc) + timedelta(minutes=10)\n\n        state = OAuthState(\n            token=token,\n            provider=provider,\n            expires_at=int(expires_at.timestamp()),\n            scopes=scopes,\n        )\n\n        with self.locked_user_integrations(user_id):\n            user_integrations = self._get_user_integrations(user_id)\n            oauth_states = user_integrations.oauth_states\n            oauth_states.append(state)\n            user_integrations.oauth_states = oauth_states\n\n            self.db_manager.update_user_integrations(\n                user_id=user_id, data=user_integrations\n            )\n\n        return token\n\n    def get_any_valid_scopes_from_state_token(\n        self, user_id: str, token: str, provider: str\n    ) -> list[str]:\n        \"\"\"\n        Get the valid scopes from the OAuth state token. This will return any valid scopes\n        from any OAuth state token for the given provider. If no valid scopes are found,\n        an empty list is returned. DO NOT RELY ON THIS TOKEN TO AUTHENTICATE A USER, AS IT\n        IS TO CHECK IF THE USER HAS GIVEN PERMISSIONS TO THE APPLICATION BEFORE EXCHANGING\n        THE CODE FOR TOKENS.\n        \"\"\"\n        user_integrations = self._get_user_integrations(user_id)\n        oauth_states = user_integrations.oauth_states\n\n        now = datetime.now(timezone.utc)\n        valid_state = next(\n            (\n                state\n                for state in oauth_states\n                if state.token == token\n                and state.provider == provider\n                and state.expires_at > now.timestamp()\n            ),\n            None,\n        )\n\n        if valid_state:\n            return valid_state.scopes\n\n        return []\n\n    def verify_state_token(self, user_id: str, token: str, provider: str) -> bool:\n        with self.locked_user_integrations(user_id):\n            user_integrations = self._get_user_integrations(user_id)\n            oauth_states = user_integrations.oauth_states\n\n            now = datetime.now(timezone.utc)\n            valid_state = next(\n                (\n                    state\n                    for state in oauth_states\n                    if state.token == token\n                    and state.provider == provider\n                    and state.expires_at > now.timestamp()\n                ),\n                None,\n            )\n\n            if valid_state:\n                # Remove the used state\n                oauth_states.remove(valid_state)\n                user_integrations.oauth_states = oauth_states\n                self.db_manager.update_user_integrations(user_id, user_integrations)\n                return True\n\n        return False\n\n    def _set_user_integration_creds(\n        self, user_id: str, credentials: list[Credentials]\n    ) -> None:\n        integrations = self._get_user_integrations(user_id)\n        # Remove default credentials from the list\n        credentials = [c for c in credentials if c not in DEFAULT_CREDENTIALS]\n        integrations.credentials = credentials\n        self.db_manager.update_user_integrations(user_id, integrations)\n\n    def _get_user_integrations(self, user_id: str) -> UserIntegrations:\n        integrations: UserIntegrations = self.db_manager.get_user_integrations(\n            user_id=user_id\n        )\n        return integrations\n\n    def locked_user_integrations(self, user_id: str):\n        key = (f\"user:{user_id}\", \"integrations\")\n        return self.locks.locked(key)",
                    "start_token": 534,
                    "end_token": 1816,
                    "children": [
                        {
                            "type": "function_definition",
                            "label": "def __init__(self):\n        from backend.data.redis import get_redis\n\n        self.locks = RedisKeyedMutex(get_redis())",
                            "start_token": 534,
                            "end_token": 560,
                            "children": [
                                {
                                    "type": "identifier",
                                    "label": "__init__",
                                    "start_token": 535,
                                    "end_token": 535,
                                    "children": []
                                },
                                {
                                    "type": "parameters",
                                    "label": "(self)",
                                    "start_token": 536,
                                    "end_token": 538,
                                    "children": [
                                        {
                                            "type": "identifier",
                                            "label": "self",
                                            "start_token": 537,
                                            "end_token": 537,
                                            "children": []
                                        }
                                    ]
                                },
                                {
                                    "type": "block",
                                    "label": "from backend.data.redis import get_redis\n\n        self.locks = RedisKeyedMutex(get_redis())",
                                    "start_token": 541,
                                    "end_token": 560,
                                    "children": [
                                        {
                                            "type": "import_from_statement",
                                            "label": "from backend.data.redis import get_redis",
                                            "start_token": 541,
                                            "end_token": 548,
                                            "children": [
                                                {
                                                    "type": "dotted_name",
                                                    "label": "backend.data.redis",
                                                    "start_token": 542,
                                                    "end_token": 546,
                                                    "children": [
                                                        {
                                                            "type": "identifier",
                                                            "label": "backend",
                                                            "start_token": 542,
                                                            "end_token": 542,
                                                            "children": []
                                                        },
                                                        {
                                                            "type": "identifier",
                                                            "label": "data",
                                                            "start_token": 544,
                                                            "end_token": 544,
                                                            "children": []
                                                        },
                                                        {
                                                            "type": "identifier",
                                                            "label": "redis",
                                                            "start_token": 546,
                                                            "end_token": 546,
                                                            "children": []
                                                        }
                                                    ]
                                                },
                                                {
                                                    "type": "dotted_name",
                                                    "label": "get_redis",
                                                    "start_token": 548,
                                                    "end_token": 548,
                                                    "children": [
                                                        {
                                                            "type": "identifier",
                                                            "label": "get_redis",
                                                            "start_token": 548,
                                                            "end_token": 548,
                                                            "children": []
                                                        }
                                                    ]
                                                }
                                            ]
                                        },
                                        {
                                            "type": "expression_statement",
                                            "label": "self.locks = RedisKeyedMutex(get_redis())",
                                            "start_token": 551,
                                            "end_token": 560,
                                            "children": [
                                                {
                                                    "type": "assignment",
                                                    "label": "self.locks = RedisKeyedMutex(get_redis())",
                                                    "start_token": 551,
                                                    "end_token": 560,
                                                    "children": [
                                                        {
                                                            "type": "attribute",
                                                            "label": "self.locks",
                                                            "start_token": 551,
                                                            "end_token": 553,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "label": "self",
                                                                    "start_token": 551,
                                                                    "end_token": 551,
                                                                    "children": []
                                                                },
                                                                {
                                                                    "type": "identifier",
                                                                    "label": "locks",
                                                                    "start_token": 553,
                                                                    "end_token": 553,
                                                                    "children": []
                                                                }
                                                            ]
                                                        },
                                                        {
                                                            "type": "call",
                                                            "label": "RedisKeyedMutex(get_redis())",
                                                            "start_token": 555,
                                                            "end_token": 560,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "label": "RedisKeyedMutex",
                                                                    "start_token": 555,
                                                                    "end_token": 555,
                                                                    "children": []
                                                                },
                                                                {
                                                                    "type": "argument_list",
                                                                    "label": "(get_redis())",
                                                                    "start_token": 556,
                                                                    "end_token": 560,
                                                                    "children": [
                                                                        {
                                                                            "type": "call",
                                                                            "label": "get_redis()",
                                                                            "start_token": 557,
                                                                            "end_token": 559,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "get_redis",
                                                                                    "start_token": 557,
                                                                                    "end_token": 557,
                                                                                    "children": []
                                                                                },
                                                                                {
                                                                                    "type": "argument_list",
                                                                                    "label": "()",
                                                                                    "start_token": 558,
                                                                                    "end_token": 559,
                                                                                    "children": []
                                                                                }
                                                                            ]
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                }
                                            ]
                                        }
                                    ]
                                }
                            ]
                        },
                        {
                            "type": "decorated_definition",
                            "label": "@property\n    @thread_cached\n    def db_manager(self) -> \"DatabaseManager\":\n        from backend.executor.database import DatabaseManager\n        from backend.util.service import get_service_client\n\n        return get_service_client(DatabaseManager)",
                            "start_token": 563,
                            "end_token": 602,
                            "children": [
                                {
                                    "type": "decorator",
                                    "label": "@property",
                                    "start_token": 563,
                                    "end_token": 564,
                                    "children": [
                                        {
                                            "type": "identifier",
                                            "label": "property",
                                            "start_token": 564,
                                            "end_token": 564,
                                            "children": []
                                        }
                                    ]
                                },
                                {
                                    "type": "decorator",
                                    "label": "@thread_cached",
                                    "start_token": 566,
                                    "end_token": 567,
                                    "children": [
                                        {
                                            "type": "identifier",
                                            "label": "thread_cached",
                                            "start_token": 567,
                                            "end_token": 567,
                                            "children": []
                                        }
                                    ]
                                },
                                {
                                    "type": "function_definition",
                                    "label": "def db_manager(self) -> \"DatabaseManager\":\n        from backend.executor.database import DatabaseManager\n        from backend.util.service import get_service_client\n\n        return get_service_client(DatabaseManager)",
                                    "start_token": 569,
                                    "end_token": 602,
                                    "children": [
                                        {
                                            "type": "identifier",
                                            "label": "db_manager",
                                            "start_token": 570,
                                            "end_token": 570,
                                            "children": []
                                        },
                                        {
                                            "type": "parameters",
                                            "label": "(self)",
                                            "start_token": 571,
                                            "end_token": 573,
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "label": "self",
                                                    "start_token": 572,
                                                    "end_token": 572,
                                                    "children": []
                                                }
                                            ]
                                        },
                                        {
                                            "type": "type",
                                            "label": "\"DatabaseManager\"",
                                            "start_token": 576,
                                            "end_token": 576,
                                            "children": [
                                                {
                                                    "type": "string",
                                                    "label": "\"DatabaseManager\"",
                                                    "start_token": 576,
                                                    "end_token": 576,
                                                    "children": [
                                                        {
                                                            "type": "string_start",
                                                            "label": "\"",
                                                            "start_token": 576,
                                                            "end_token": 576,
                                                            "children": []
                                                        },
                                                        {
                                                            "type": "string_content",
                                                            "label": "DatabaseManager",
                                                            "start_token": 576,
                                                            "end_token": 576,
                                                            "children": []
                                                        },
                                                        {
                                                            "type": "string_end",
                                                            "label": "\"",
                                                            "start_token": 576,
                                                            "end_token": 576,
                                                            "children": []
                                                        }
                                                    ]
                                                }
                                            ]
                                        },
                                        {
                                            "type": "block",
                                            "label": "from backend.executor.database import DatabaseManager\n        from backend.util.service import get_service_client\n\n        return get_service_client(DatabaseManager)",
                                            "start_token": 579,
                                            "end_token": 602,
                                            "children": [
                                                {
                                                    "type": "import_from_statement",
                                                    "label": "from backend.executor.database import DatabaseManager",
                                                    "start_token": 579,
                                                    "end_token": 586,
                                                    "children": [
                                                        {
                                                            "type": "dotted_name",
                                                            "label": "backend.executor.database",
                                                            "start_token": 580,
                                                            "end_token": 584,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "label": "backend",
                                                                    "start_token": 580,
                                                                    "end_token": 580,
                                                                    "children": []
                                                                },
                                                                {
                                                                    "type": "identifier",
                                                                    "label": "executor",
                                                                    "start_token": 582,
                                                                    "end_token": 582,
                                                                    "children": []
                                                                },
                                                                {
                                                                    "type": "identifier",
                                                                    "label": "database",
                                                                    "start_token": 584,
                                                                    "end_token": 584,
                                                                    "children": []
                                                                }
                                                            ]
                                                        },
                                                        {
                                                            "type": "dotted_name",
                                                            "label": "DatabaseManager",
                                                            "start_token": 586,
                                                            "end_token": 586,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "label": "DatabaseManager",
                                                                    "start_token": 586,
                                                                    "end_token": 586,
                                                                    "children": []
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                },
                                                {
                                                    "type": "import_from_statement",
                                                    "label": "from backend.util.service import get_service_client",
                                                    "start_token": 588,
                                                    "end_token": 595,
                                                    "children": [
                                                        {
                                                            "type": "dotted_name",
                                                            "label": "backend.util.service",
                                                            "start_token": 589,
                                                            "end_token": 593,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "label": "backend",
                                                                    "start_token": 589,
                                                                    "end_token": 589,
                                                                    "children": []
                                                                },
                                                                {
                                                                    "type": "identifier",
                                                                    "label": "util",
                                                                    "start_token": 591,
                                                                    "end_token": 591,
                                                                    "children": []
                                                                },
                                                                {
                                                                    "type": "identifier",
                                                                    "label": "service",
                                                                    "start_token": 593,
                                                                    "end_token": 593,
                                                                    "children": []
                                                                }
                                                            ]
                                                        },
                                                        {
                                                            "type": "dotted_name",
                                                            "label": "get_service_client",
                                                            "start_token": 595,
                                                            "end_token": 595,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "label": "get_service_client",
                                                                    "start_token": 595,
                                                                    "end_token": 595,
                                                                    "children": []
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                },
                                                {
                                                    "type": "return_statement",
                                                    "label": "return get_service_client(DatabaseManager)",
                                                    "start_token": 598,
                                                    "end_token": 602,
                                                    "children": [
                                                        {
                                                            "type": "call",
                                                            "label": "get_service_client(DatabaseManager)",
                                                            "start_token": 599,
                                                            "end_token": 602,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "label": "get_service_client",
                                                                    "start_token": 599,
                                                                    "end_token": 599,
                                                                    "children": []
                                                                },
                                                                {
                                                                    "type": "argument_list",
                                                                    "label": "(DatabaseManager)",
                                                                    "start_token": 600,
                                                                    "end_token": 602,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "DatabaseManager",
                                                                            "start_token": 601,
                                                                            "end_token": 601,
                                                                            "children": []
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                }
                                            ]
                                        }
                                    ]
                                }
                            ]
                        },
                        {
                            "type": "function_definition",
                            "label": "def add_creds(self, user_id: str, credentials: Credentials) -> None:\n        with self.locked_user_integrations(user_id):\n            if self.get_creds_by_id(user_id, credentials.id):\n                raise ValueError(\n                    f\"Can not re-create existing credentials #{credentials.id} \"\n                    f\"for user #{user_id}\"\n                )\n            self._set_user_integration_creds(\n                user_id, [*self.get_all_creds(user_id), credentials]\n            )",
                            "start_token": 605,
                            "end_token": 676,
                            "children": [
                                {
                                    "type": "identifier",
                                    "label": "add_creds",
                                    "start_token": 606,
                                    "end_token": 606,
                                    "children": []
                                },
                                {
                                    "type": "parameters",
                                    "label": "(self, user_id: str, credentials: Credentials)",
                                    "start_token": 607,
                                    "end_token": 617,
                                    "children": [
                                        {
                                            "type": "identifier",
                                            "label": "self",
                                            "start_token": 608,
                                            "end_token": 608,
                                            "children": []
                                        },
                                        {
                                            "type": "typed_parameter",
                                            "label": "user_id: str",
                                            "start_token": 610,
                                            "end_token": 612,
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "label": "user_id",
                                                    "start_token": 610,
                                                    "end_token": 610,
                                                    "children": []
                                                },
                                                {
                                                    "type": "type",
                                                    "label": "str",
                                                    "start_token": 612,
                                                    "end_token": 612,
                                                    "children": [
                                                        {
                                                            "type": "identifier",
                                                            "label": "str",
                                                            "start_token": 612,
                                                            "end_token": 612,
                                                            "children": []
                                                        }
                                                    ]
                                                }
                                            ]
                                        },
                                        {
                                            "type": "typed_parameter",
                                            "label": "credentials: Credentials",
                                            "start_token": 614,
                                            "end_token": 616,
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "label": "credentials",
                                                    "start_token": 614,
                                                    "end_token": 614,
                                                    "children": []
                                                },
                                                {
                                                    "type": "type",
                                                    "label": "Credentials",
                                                    "start_token": 616,
                                                    "end_token": 616,
                                                    "children": [
                                                        {
                                                            "type": "identifier",
                                                            "label": "Credentials",
                                                            "start_token": 616,
                                                            "end_token": 616,
                                                            "children": []
                                                        }
                                                    ]
                                                }
                                            ]
                                        }
                                    ]
                                },
                                {
                                    "type": "type",
                                    "label": "None",
                                    "start_token": 620,
                                    "end_token": 620,
                                    "children": [
                                        {
                                            "type": "none",
                                            "label": "None",
                                            "start_token": 620,
                                            "end_token": 620,
                                            "children": []
                                        }
                                    ]
                                },
                                {
                                    "type": "block",
                                    "label": "with self.locked_user_integrations(user_id):\n            if self.get_creds_by_id(user_id, credentials.id):\n                raise ValueError(\n                    f\"Can not re-create existing credentials #{credentials.id} \"\n                    f\"for user #{user_id}\"\n                )\n            self._set_user_integration_creds(\n                user_id, [*self.get_all_creds(user_id), credentials]\n            )",
                                    "start_token": 623,
                                    "end_token": 676,
                                    "children": [
                                        {
                                            "type": "with_statement",
                                            "label": "with self.locked_user_integrations(user_id):\n            if self.get_creds_by_id(user_id, credentials.id):\n                raise ValueError(\n                    f\"Can not re-create existing credentials #{credentials.id} \"\n                    f\"for user #{user_id}\"\n                )\n            self._set_user_integration_creds(\n                user_id, [*self.get_all_creds(user_id), credentials]\n            )",
                                            "start_token": 623,
                                            "end_token": 676,
                                            "children": [
                                                {
                                                    "type": "with_clause",
                                                    "label": "self.locked_user_integrations(user_id)",
                                                    "start_token": 624,
                                                    "end_token": 629,
                                                    "children": [
                                                        {
                                                            "type": "with_item",
                                                            "label": "self.locked_user_integrations(user_id)",
                                                            "start_token": 624,
                                                            "end_token": 629,
                                                            "children": [
                                                                {
                                                                    "type": "call",
                                                                    "label": "self.locked_user_integrations(user_id)",
                                                                    "start_token": 624,
                                                                    "end_token": 629,
                                                                    "children": [
                                                                        {
                                                                            "type": "attribute",
                                                                            "label": "self.locked_user_integrations",
                                                                            "start_token": 624,
                                                                            "end_token": 626,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "self",
                                                                                    "start_token": 624,
                                                                                    "end_token": 624,
                                                                                    "children": []
                                                                                },
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "locked_user_integrations",
                                                                                    "start_token": 626,
                                                                                    "end_token": 626,
                                                                                    "children": []
                                                                                }
                                                                            ]
                                                                        },
                                                                        {
                                                                            "type": "argument_list",
                                                                            "label": "(user_id)",
                                                                            "start_token": 627,
                                                                            "end_token": 629,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "user_id",
                                                                                    "start_token": 628,
                                                                                    "end_token": 628,
                                                                                    "children": []
                                                                                }
                                                                            ]
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                },
                                                {
                                                    "type": "block",
                                                    "label": "if self.get_creds_by_id(user_id, credentials.id):\n                raise ValueError(\n                    f\"Can not re-create existing credentials #{credentials.id} \"\n                    f\"for user #{user_id}\"\n                )\n            self._set_user_integration_creds(\n                user_id, [*self.get_all_creds(user_id), credentials]\n            )",
                                                    "start_token": 632,
                                                    "end_token": 676,
                                                    "children": [
                                                        {
                                                            "type": "if_statement",
                                                            "label": "if self.get_creds_by_id(user_id, credentials.id):\n                raise ValueError(\n                    f\"Can not re-create existing credentials #{credentials.id} \"\n                    f\"for user #{user_id}\"\n                )",
                                                            "start_token": 632,
                                                            "end_token": 655,
                                                            "children": [
                                                                {
                                                                    "type": "call",
                                                                    "label": "self.get_creds_by_id(user_id, credentials.id)",
                                                                    "start_token": 633,
                                                                    "end_token": 642,
                                                                    "children": [
                                                                        {
                                                                            "type": "attribute",
                                                                            "label": "self.get_creds_by_id",
                                                                            "start_token": 633,
                                                                            "end_token": 635,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "self",
                                                                                    "start_token": 633,
                                                                                    "end_token": 633,
                                                                                    "children": []
                                                                                },
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "get_creds_by_id",
                                                                                    "start_token": 635,
                                                                                    "end_token": 635,
                                                                                    "children": []
                                                                                }
                                                                            ]
                                                                        },
                                                                        {
                                                                            "type": "argument_list",
                                                                            "label": "(user_id, credentials.id)",
                                                                            "start_token": 636,
                                                                            "end_token": 642,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "user_id",
                                                                                    "start_token": 637,
                                                                                    "end_token": 637,
                                                                                    "children": []
                                                                                },
                                                                                {
                                                                                    "type": "attribute",
                                                                                    "label": "credentials.id",
                                                                                    "start_token": 639,
                                                                                    "end_token": 641,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "label": "credentials",
                                                                                            "start_token": 639,
                                                                                            "end_token": 639,
                                                                                            "children": []
                                                                                        },
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "label": "id",
                                                                                            "start_token": 641,
                                                                                            "end_token": 641,
                                                                                            "children": []
                                                                                        }
                                                                                    ]
                                                                                }
                                                                            ]
                                                                        }
                                                                    ]
                                                                },
                                                                {
                                                                    "type": "block",
                                                                    "label": "raise ValueError(\n                    f\"Can not re-create existing credentials #{credentials.id} \"\n                    f\"for user #{user_id}\"\n                )",
                                                                    "start_token": 645,
                                                                    "end_token": 655,
                                                                    "children": [
                                                                        {
                                                                            "type": "raise_statement",
                                                                            "label": "raise ValueError(\n                    f\"Can not re-create existing credentials #{credentials.id} \"\n                    f\"for user #{user_id}\"\n                )",
                                                                            "start_token": 645,
                                                                            "end_token": 655,
                                                                            "children": [
                                                                                {
                                                                                    "type": "call",
                                                                                    "label": "ValueError(\n                    f\"Can not re-create existing credentials #{credentials.id} \"\n                    f\"for user #{user_id}\"\n                )",
                                                                                    "start_token": 646,
                                                                                    "end_token": 655,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "label": "ValueError",
                                                                                            "start_token": 646,
                                                                                            "end_token": 646,
                                                                                            "children": []
                                                                                        },
                                                                                        {
                                                                                            "type": "argument_list",
                                                                                            "label": "(\n                    f\"Can not re-create existing credentials #{credentials.id} \"\n                    f\"for user #{user_id}\"\n                )",
                                                                                            "start_token": 647,
                                                                                            "end_token": 655,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "concatenated_string",
                                                                                                    "label": "f\"Can not re-create existing credentials #{credentials.id} \"\n                    f\"for user #{user_id}\"",
                                                                                                    "start_token": 649,
                                                                                                    "end_token": 653,
                                                                                                    "children": [
                                                                                                        {
                                                                                                            "type": "string",
                                                                                                            "label": "f\"Can not re-create existing credentials #{credentials.id} \"",
                                                                                                            "start_token": 649,
                                                                                                            "end_token": 650,
                                                                                                            "children": [
                                                                                                                {
                                                                                                                    "type": "string_start",
                                                                                                                    "label": "f\"",
                                                                                                                    "start_token": 649,
                                                                                                                    "end_token": 650,
                                                                                                                    "children": []
                                                                                                                },
                                                                                                                {
                                                                                                                    "type": "string_content",
                                                                                                                    "label": "Can not re-create existing credentials #",
                                                                                                                    "start_token": 650,
                                                                                                                    "end_token": 650,
                                                                                                                    "children": []
                                                                                                                },
                                                                                                                {
                                                                                                                    "type": "interpolation",
                                                                                                                    "label": "{credentials.id}",
                                                                                                                    "start_token": 650,
                                                                                                                    "end_token": 650,
                                                                                                                    "children": [
                                                                                                                        {
                                                                                                                            "type": "attribute",
                                                                                                                            "label": "credentials.id",
                                                                                                                            "start_token": 650,
                                                                                                                            "end_token": 650,
                                                                                                                            "children": [
                                                                                                                                {
                                                                                                                                    "type": "identifier",
                                                                                                                                    "label": "credentials",
                                                                                                                                    "start_token": 650,
                                                                                                                                    "end_token": 650,
                                                                                                                                    "children": []
                                                                                                                                },
                                                                                                                                {
                                                                                                                                    "type": "identifier",
                                                                                                                                    "label": "id",
                                                                                                                                    "start_token": 650,
                                                                                                                                    "end_token": 650,
                                                                                                                                    "children": []
                                                                                                                                }
                                                                                                                            ]
                                                                                                                        }
                                                                                                                    ]
                                                                                                                },
                                                                                                                {
                                                                                                                    "type": "string_content",
                                                                                                                    "label": " ",
                                                                                                                    "start_token": 650,
                                                                                                                    "end_token": 650,
                                                                                                                    "children": []
                                                                                                                },
                                                                                                                {
                                                                                                                    "type": "string_end",
                                                                                                                    "label": "\"",
                                                                                                                    "start_token": 650,
                                                                                                                    "end_token": 650,
                                                                                                                    "children": []
                                                                                                                }
                                                                                                            ]
                                                                                                        },
                                                                                                        {
                                                                                                            "type": "string",
                                                                                                            "label": "f\"for user #{user_id}\"",
                                                                                                            "start_token": 652,
                                                                                                            "end_token": 653,
                                                                                                            "children": [
                                                                                                                {
                                                                                                                    "type": "string_start",
                                                                                                                    "label": "f\"",
                                                                                                                    "start_token": 652,
                                                                                                                    "end_token": 653,
                                                                                                                    "children": []
                                                                                                                },
                                                                                                                {
                                                                                                                    "type": "string_content",
                                                                                                                    "label": "for user #",
                                                                                                                    "start_token": 653,
                                                                                                                    "end_token": 653,
                                                                                                                    "children": []
                                                                                                                },
                                                                                                                {
                                                                                                                    "type": "interpolation",
                                                                                                                    "label": "{user_id}",
                                                                                                                    "start_token": 653,
                                                                                                                    "end_token": 653,
                                                                                                                    "children": [
                                                                                                                        {
                                                                                                                            "type": "identifier",
                                                                                                                            "label": "user_id",
                                                                                                                            "start_token": 653,
                                                                                                                            "end_token": 653,
                                                                                                                            "children": []
                                                                                                                        }
                                                                                                                    ]
                                                                                                                },
                                                                                                                {
                                                                                                                    "type": "string_end",
                                                                                                                    "label": "\"",
                                                                                                                    "start_token": 653,
                                                                                                                    "end_token": 653,
                                                                                                                    "children": []
                                                                                                                }
                                                                                                            ]
                                                                                                        }
                                                                                                    ]
                                                                                                }
                                                                                            ]
                                                                                        }
                                                                                    ]
                                                                                }
                                                                            ]
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        },
                                                        {
                                                            "type": "expression_statement",
                                                            "label": "self._set_user_integration_creds(\n                user_id, [*self.get_all_creds(user_id), credentials]\n            )",
                                                            "start_token": 657,
                                                            "end_token": 676,
                                                            "children": [
                                                                {
                                                                    "type": "call",
                                                                    "label": "self._set_user_integration_creds(\n                user_id, [*self.get_all_creds(user_id), credentials]\n            )",
                                                                    "start_token": 657,
                                                                    "end_token": 676,
                                                                    "children": [
                                                                        {
                                                                            "type": "attribute",
                                                                            "label": "self._set_user_integration_creds",
                                                                            "start_token": 657,
                                                                            "end_token": 659,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "self",
                                                                                    "start_token": 657,
                                                                                    "end_token": 657,
                                                                                    "children": []
                                                                                },
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "_set_user_integration_creds",
                                                                                    "start_token": 659,
                                                                                    "end_token": 659,
                                                                                    "children": []
                                                                                }
                                                                            ]
                                                                        },
                                                                        {
                                                                            "type": "argument_list",
                                                                            "label": "(\n                user_id, [*self.get_all_creds(user_id), credentials]\n            )",
                                                                            "start_token": 660,
                                                                            "end_token": 676,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "user_id",
                                                                                    "start_token": 662,
                                                                                    "end_token": 662,
                                                                                    "children": []
                                                                                },
                                                                                {
                                                                                    "type": "list",
                                                                                    "label": "[*self.get_all_creds(user_id), credentials]",
                                                                                    "start_token": 664,
                                                                                    "end_token": 674,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "list_splat",
                                                                                            "label": "*self.get_all_creds(user_id)",
                                                                                            "start_token": 665,
                                                                                            "end_token": 671,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "call",
                                                                                                    "label": "self.get_all_creds(user_id)",
                                                                                                    "start_token": 666,
                                                                                                    "end_token": 671,
                                                                                                    "children": [
                                                                                                        {
                                                                                                            "type": "attribute",
                                                                                                            "label": "self.get_all_creds",
                                                                                                            "start_token": 666,
                                                                                                            "end_token": 668,
                                                                                                            "children": [
                                                                                                                {
                                                                                                                    "type": "identifier",
                                                                                                                    "label": "self",
                                                                                                                    "start_token": 666,
                                                                                                                    "end_token": 666,
                                                                                                                    "children": []
                                                                                                                },
                                                                                                                {
                                                                                                                    "type": "identifier",
                                                                                                                    "label": "get_all_creds",
                                                                                                                    "start_token": 668,
                                                                                                                    "end_token": 668,
                                                                                                                    "children": []
                                                                                                                }
                                                                                                            ]
                                                                                                        },
                                                                                                        {
                                                                                                            "type": "argument_list",
                                                                                                            "label": "(user_id)",
                                                                                                            "start_token": 669,
                                                                                                            "end_token": 671,
                                                                                                            "children": [
                                                                                                                {
                                                                                                                    "type": "identifier",
                                                                                                                    "label": "user_id",
                                                                                                                    "start_token": 670,
                                                                                                                    "end_token": 670,
                                                                                                                    "children": []
                                                                                                                }
                                                                                                            ]
                                                                                                        }
                                                                                                    ]
                                                                                                }
                                                                                            ]
                                                                                        },
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "label": "credentials",
                                                                                            "start_token": 673,
                                                                                            "end_token": 673,
                                                                                            "children": []
                                                                                        }
                                                                                    ]
                                                                                }
                                                                            ]
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                }
                                            ]
                                        }
                                    ]
                                }
                            ]
                        },
                        {
                            "type": "function_definition",
                            "label": "def get_all_creds(self, user_id: str) -> list[Credentials]:\n        users_credentials = self._get_user_integrations(user_id).credentials\n        all_credentials = users_credentials\n        if settings.secrets.revid_api_key:\n            all_credentials.append(revid_credentials)\n        if settings.secrets.ideogram_api_key:\n            all_credentials.append(ideogram_credentials)\n        if settings.secrets.groq_api_key:\n            all_credentials.append(groq_credentials)\n        if settings.secrets.replicate_api_key:\n            all_credentials.append(replicate_credentials)\n        if settings.secrets.openai_api_key:\n            all_credentials.append(openai_credentials)\n        if settings.secrets.anthropic_api_key:\n            all_credentials.append(anthropic_credentials)\n        if settings.secrets.did_api_key:\n            all_credentials.append(did_credentials)\n        if settings.secrets.jina_api_key:\n            all_credentials.append(jina_credentials)\n        if settings.secrets.unreal_speech_api_key:\n            all_credentials.append(unreal_credentials)\n        if settings.secrets.open_router_api_key:\n            all_credentials.append(open_router_credentials)\n        return all_credentials",
                            "start_token": 679,
                            "end_token": 862,
                            "children": [
                                {
                                    "type": "identifier",
                                    "label": "get_all_creds",
                                    "start_token": 680,
                                    "end_token": 680,
                                    "children": []
                                },
                                {
                                    "type": "parameters",
                                    "label": "(self, user_id: str)",
                                    "start_token": 681,
                                    "end_token": 687,
                                    "children": [
                                        {
                                            "type": "identifier",
                                            "label": "self",
                                            "start_token": 682,
                                            "end_token": 682,
                                            "children": []
                                        },
                                        {
                                            "type": "typed_parameter",
                                            "label": "user_id: str",
                                            "start_token": 684,
                                            "end_token": 686,
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "label": "user_id",
                                                    "start_token": 684,
                                                    "end_token": 684,
                                                    "children": []
                                                },
                                                {
                                                    "type": "type",
                                                    "label": "str",
                                                    "start_token": 686,
                                                    "end_token": 686,
                                                    "children": [
                                                        {
                                                            "type": "identifier",
                                                            "label": "str",
                                                            "start_token": 686,
                                                            "end_token": 686,
                                                            "children": []
                                                        }
                                                    ]
                                                }
                                            ]
                                        }
                                    ]
                                },
                                {
                                    "type": "type",
                                    "label": "list[Credentials]",
                                    "start_token": 690,
                                    "end_token": 693,
                                    "children": [
                                        {
                                            "type": "generic_type",
                                            "label": "list[Credentials]",
                                            "start_token": 690,
                                            "end_token": 693,
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "label": "list",
                                                    "start_token": 690,
                                                    "end_token": 690,
                                                    "children": []
                                                },
                                                {
                                                    "type": "type_parameter",
                                                    "label": "[Credentials]",
                                                    "start_token": 691,
                                                    "end_token": 693,
                                                    "children": [
                                                        {
                                                            "type": "type",
                                                            "label": "Credentials",
                                                            "start_token": 692,
                                                            "end_token": 692,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "label": "Credentials",
                                                                    "start_token": 692,
                                                                    "end_token": 692,
                                                                    "children": []
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                }
                                            ]
                                        }
                                    ]
                                },
                                {
                                    "type": "block",
                                    "label": "users_credentials = self._get_user_integrations(user_id).credentials\n        all_credentials = users_credentials\n        if settings.secrets.revid_api_key:\n            all_credentials.append(revid_credentials)\n        if settings.secrets.ideogram_api_key:\n            all_credentials.append(ideogram_credentials)\n        if settings.secrets.groq_api_key:\n            all_credentials.append(groq_credentials)\n        if settings.secrets.replicate_api_key:\n            all_credentials.append(replicate_credentials)\n        if settings.secrets.openai_api_key:\n            all_credentials.append(openai_credentials)\n        if settings.secrets.anthropic_api_key:\n            all_credentials.append(anthropic_credentials)\n        if settings.secrets.did_api_key:\n            all_credentials.append(did_credentials)\n        if settings.secrets.jina_api_key:\n            all_credentials.append(jina_credentials)\n        if settings.secrets.unreal_speech_api_key:\n            all_credentials.append(unreal_credentials)\n        if settings.secrets.open_router_api_key:\n            all_credentials.append(open_router_credentials)\n        return all_credentials",
                                    "start_token": 696,
                                    "end_token": 862,
                                    "children": [
                                        {
                                            "type": "expression_statement",
                                            "label": "users_credentials = self._get_user_integrations(user_id).credentials",
                                            "start_token": 696,
                                            "end_token": 705,
                                            "children": [
                                                {
                                                    "type": "assignment",
                                                    "label": "users_credentials = self._get_user_integrations(user_id).credentials",
                                                    "start_token": 696,
                                                    "end_token": 705,
                                                    "children": [
                                                        {
                                                            "type": "identifier",
                                                            "label": "users_credentials",
                                                            "start_token": 696,
                                                            "end_token": 696,
                                                            "children": []
                                                        },
                                                        {
                                                            "type": "attribute",
                                                            "label": "self._get_user_integrations(user_id).credentials",
                                                            "start_token": 698,
                                                            "end_token": 705,
                                                            "children": [
                                                                {
                                                                    "type": "call",
                                                                    "label": "self._get_user_integrations(user_id)",
                                                                    "start_token": 698,
                                                                    "end_token": 703,
                                                                    "children": [
                                                                        {
                                                                            "type": "attribute",
                                                                            "label": "self._get_user_integrations",
                                                                            "start_token": 698,
                                                                            "end_token": 700,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "self",
                                                                                    "start_token": 698,
                                                                                    "end_token": 698,
                                                                                    "children": []
                                                                                },
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "_get_user_integrations",
                                                                                    "start_token": 700,
                                                                                    "end_token": 700,
                                                                                    "children": []
                                                                                }
                                                                            ]
                                                                        },
                                                                        {
                                                                            "type": "argument_list",
                                                                            "label": "(user_id)",
                                                                            "start_token": 701,
                                                                            "end_token": 703,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "user_id",
                                                                                    "start_token": 702,
                                                                                    "end_token": 702,
                                                                                    "children": []
                                                                                }
                                                                            ]
                                                                        }
                                                                    ]
                                                                },
                                                                {
                                                                    "type": "identifier",
                                                                    "label": "credentials",
                                                                    "start_token": 705,
                                                                    "end_token": 705,
                                                                    "children": []
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                }
                                            ]
                                        },
                                        {
                                            "type": "expression_statement",
                                            "label": "all_credentials = users_credentials",
                                            "start_token": 707,
                                            "end_token": 709,
                                            "children": [
                                                {
                                                    "type": "assignment",
                                                    "label": "all_credentials = users_credentials",
                                                    "start_token": 707,
                                                    "end_token": 709,
                                                    "children": [
                                                        {
                                                            "type": "identifier",
                                                            "label": "all_credentials",
                                                            "start_token": 707,
                                                            "end_token": 707,
                                                            "children": []
                                                        },
                                                        {
                                                            "type": "identifier",
                                                            "label": "users_credentials",
                                                            "start_token": 709,
                                                            "end_token": 709,
                                                            "children": []
                                                        }
                                                    ]
                                                }
                                            ]
                                        },
                                        {
                                            "type": "if_statement",
                                            "label": "if settings.secrets.revid_api_key:\n            all_credentials.append(revid_credentials)",
                                            "start_token": 711,
                                            "end_token": 724,
                                            "children": [
                                                {
                                                    "type": "attribute",
                                                    "label": "settings.secrets.revid_api_key",
                                                    "start_token": 712,
                                                    "end_token": 716,
                                                    "children": [
                                                        {
                                                            "type": "attribute",
                                                            "label": "settings.secrets",
                                                            "start_token": 712,
                                                            "end_token": 714,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "label": "settings",
                                                                    "start_token": 712,
                                                                    "end_token": 712,
                                                                    "children": []
                                                                },
                                                                {
                                                                    "type": "identifier",
                                                                    "label": "secrets",
                                                                    "start_token": 714,
                                                                    "end_token": 714,
                                                                    "children": []
                                                                }
                                                            ]
                                                        },
                                                        {
                                                            "type": "identifier",
                                                            "label": "revid_api_key",
                                                            "start_token": 716,
                                                            "end_token": 716,
                                                            "children": []
                                                        }
                                                    ]
                                                },
                                                {
                                                    "type": "block",
                                                    "label": "all_credentials.append(revid_credentials)",
                                                    "start_token": 719,
                                                    "end_token": 724,
                                                    "children": [
                                                        {
                                                            "type": "expression_statement",
                                                            "label": "all_credentials.append(revid_credentials)",
                                                            "start_token": 719,
                                                            "end_token": 724,
                                                            "children": [
                                                                {
                                                                    "type": "call",
                                                                    "label": "all_credentials.append(revid_credentials)",
                                                                    "start_token": 719,
                                                                    "end_token": 724,
                                                                    "children": [
                                                                        {
                                                                            "type": "attribute",
                                                                            "label": "all_credentials.append",
                                                                            "start_token": 719,
                                                                            "end_token": 721,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "all_credentials",
                                                                                    "start_token": 719,
                                                                                    "end_token": 719,
                                                                                    "children": []
                                                                                },
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "append",
                                                                                    "start_token": 721,
                                                                                    "end_token": 721,
                                                                                    "children": []
                                                                                }
                                                                            ]
                                                                        },
                                                                        {
                                                                            "type": "argument_list",
                                                                            "label": "(revid_credentials)",
                                                                            "start_token": 722,
                                                                            "end_token": 724,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "revid_credentials",
                                                                                    "start_token": 723,
                                                                                    "end_token": 723,
                                                                                    "children": []
                                                                                }
                                                                            ]
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                }
                                            ]
                                        },
                                        {
                                            "type": "if_statement",
                                            "label": "if settings.secrets.ideogram_api_key:\n            all_credentials.append(ideogram_credentials)",
                                            "start_token": 726,
                                            "end_token": 739,
                                            "children": [
                                                {
                                                    "type": "attribute",
                                                    "label": "settings.secrets.ideogram_api_key",
                                                    "start_token": 727,
                                                    "end_token": 731,
                                                    "children": [
                                                        {
                                                            "type": "attribute",
                                                            "label": "settings.secrets",
                                                            "start_token": 727,
                                                            "end_token": 729,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "label": "settings",
                                                                    "start_token": 727,
                                                                    "end_token": 727,
                                                                    "children": []
                                                                },
                                                                {
                                                                    "type": "identifier",
                                                                    "label": "secrets",
                                                                    "start_token": 729,
                                                                    "end_token": 729,
                                                                    "children": []
                                                                }
                                                            ]
                                                        },
                                                        {
                                                            "type": "identifier",
                                                            "label": "ideogram_api_key",
                                                            "start_token": 731,
                                                            "end_token": 731,
                                                            "children": []
                                                        }
                                                    ]
                                                },
                                                {
                                                    "type": "block",
                                                    "label": "all_credentials.append(ideogram_credentials)",
                                                    "start_token": 734,
                                                    "end_token": 739,
                                                    "children": [
                                                        {
                                                            "type": "expression_statement",
                                                            "label": "all_credentials.append(ideogram_credentials)",
                                                            "start_token": 734,
                                                            "end_token": 739,
                                                            "children": [
                                                                {
                                                                    "type": "call",
                                                                    "label": "all_credentials.append(ideogram_credentials)",
                                                                    "start_token": 734,
                                                                    "end_token": 739,
                                                                    "children": [
                                                                        {
                                                                            "type": "attribute",
                                                                            "label": "all_credentials.append",
                                                                            "start_token": 734,
                                                                            "end_token": 736,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "all_credentials",
                                                                                    "start_token": 734,
                                                                                    "end_token": 734,
                                                                                    "children": []
                                                                                },
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "append",
                                                                                    "start_token": 736,
                                                                                    "end_token": 736,
                                                                                    "children": []
                                                                                }
                                                                            ]
                                                                        },
                                                                        {
                                                                            "type": "argument_list",
                                                                            "label": "(ideogram_credentials)",
                                                                            "start_token": 737,
                                                                            "end_token": 739,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "ideogram_credentials",
                                                                                    "start_token": 738,
                                                                                    "end_token": 738,
                                                                                    "children": []
                                                                                }
                                                                            ]
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                }
                                            ]
                                        },
                                        {
                                            "type": "if_statement",
                                            "label": "if settings.secrets.groq_api_key:\n            all_credentials.append(groq_credentials)",
                                            "start_token": 741,
                                            "end_token": 754,
                                            "children": [
                                                {
                                                    "type": "attribute",
                                                    "label": "settings.secrets.groq_api_key",
                                                    "start_token": 742,
                                                    "end_token": 746,
                                                    "children": [
                                                        {
                                                            "type": "attribute",
                                                            "label": "settings.secrets",
                                                            "start_token": 742,
                                                            "end_token": 744,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "label": "settings",
                                                                    "start_token": 742,
                                                                    "end_token": 742,
                                                                    "children": []
                                                                },
                                                                {
                                                                    "type": "identifier",
                                                                    "label": "secrets",
                                                                    "start_token": 744,
                                                                    "end_token": 744,
                                                                    "children": []
                                                                }
                                                            ]
                                                        },
                                                        {
                                                            "type": "identifier",
                                                            "label": "groq_api_key",
                                                            "start_token": 746,
                                                            "end_token": 746,
                                                            "children": []
                                                        }
                                                    ]
                                                },
                                                {
                                                    "type": "block",
                                                    "label": "all_credentials.append(groq_credentials)",
                                                    "start_token": 749,
                                                    "end_token": 754,
                                                    "children": [
                                                        {
                                                            "type": "expression_statement",
                                                            "label": "all_credentials.append(groq_credentials)",
                                                            "start_token": 749,
                                                            "end_token": 754,
                                                            "children": [
                                                                {
                                                                    "type": "call",
                                                                    "label": "all_credentials.append(groq_credentials)",
                                                                    "start_token": 749,
                                                                    "end_token": 754,
                                                                    "children": [
                                                                        {
                                                                            "type": "attribute",
                                                                            "label": "all_credentials.append",
                                                                            "start_token": 749,
                                                                            "end_token": 751,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "all_credentials",
                                                                                    "start_token": 749,
                                                                                    "end_token": 749,
                                                                                    "children": []
                                                                                },
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "append",
                                                                                    "start_token": 751,
                                                                                    "end_token": 751,
                                                                                    "children": []
                                                                                }
                                                                            ]
                                                                        },
                                                                        {
                                                                            "type": "argument_list",
                                                                            "label": "(groq_credentials)",
                                                                            "start_token": 752,
                                                                            "end_token": 754,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "groq_credentials",
                                                                                    "start_token": 753,
                                                                                    "end_token": 753,
                                                                                    "children": []
                                                                                }
                                                                            ]
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                }
                                            ]
                                        },
                                        {
                                            "type": "if_statement",
                                            "label": "if settings.secrets.replicate_api_key:\n            all_credentials.append(replicate_credentials)",
                                            "start_token": 756,
                                            "end_token": 769,
                                            "children": [
                                                {
                                                    "type": "attribute",
                                                    "label": "settings.secrets.replicate_api_key",
                                                    "start_token": 757,
                                                    "end_token": 761,
                                                    "children": [
                                                        {
                                                            "type": "attribute",
                                                            "label": "settings.secrets",
                                                            "start_token": 757,
                                                            "end_token": 759,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "label": "settings",
                                                                    "start_token": 757,
                                                                    "end_token": 757,
                                                                    "children": []
                                                                },
                                                                {
                                                                    "type": "identifier",
                                                                    "label": "secrets",
                                                                    "start_token": 759,
                                                                    "end_token": 759,
                                                                    "children": []
                                                                }
                                                            ]
                                                        },
                                                        {
                                                            "type": "identifier",
                                                            "label": "replicate_api_key",
                                                            "start_token": 761,
                                                            "end_token": 761,
                                                            "children": []
                                                        }
                                                    ]
                                                },
                                                {
                                                    "type": "block",
                                                    "label": "all_credentials.append(replicate_credentials)",
                                                    "start_token": 764,
                                                    "end_token": 769,
                                                    "children": [
                                                        {
                                                            "type": "expression_statement",
                                                            "label": "all_credentials.append(replicate_credentials)",
                                                            "start_token": 764,
                                                            "end_token": 769,
                                                            "children": [
                                                                {
                                                                    "type": "call",
                                                                    "label": "all_credentials.append(replicate_credentials)",
                                                                    "start_token": 764,
                                                                    "end_token": 769,
                                                                    "children": [
                                                                        {
                                                                            "type": "attribute",
                                                                            "label": "all_credentials.append",
                                                                            "start_token": 764,
                                                                            "end_token": 766,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "all_credentials",
                                                                                    "start_token": 764,
                                                                                    "end_token": 764,
                                                                                    "children": []
                                                                                },
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "append",
                                                                                    "start_token": 766,
                                                                                    "end_token": 766,
                                                                                    "children": []
                                                                                }
                                                                            ]
                                                                        },
                                                                        {
                                                                            "type": "argument_list",
                                                                            "label": "(replicate_credentials)",
                                                                            "start_token": 767,
                                                                            "end_token": 769,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "replicate_credentials",
                                                                                    "start_token": 768,
                                                                                    "end_token": 768,
                                                                                    "children": []
                                                                                }
                                                                            ]
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                }
                                            ]
                                        },
                                        {
                                            "type": "if_statement",
                                            "label": "if settings.secrets.openai_api_key:\n            all_credentials.append(openai_credentials)",
                                            "start_token": 771,
                                            "end_token": 784,
                                            "children": [
                                                {
                                                    "type": "attribute",
                                                    "label": "settings.secrets.openai_api_key",
                                                    "start_token": 772,
                                                    "end_token": 776,
                                                    "children": [
                                                        {
                                                            "type": "attribute",
                                                            "label": "settings.secrets",
                                                            "start_token": 772,
                                                            "end_token": 774,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "label": "settings",
                                                                    "start_token": 772,
                                                                    "end_token": 772,
                                                                    "children": []
                                                                },
                                                                {
                                                                    "type": "identifier",
                                                                    "label": "secrets",
                                                                    "start_token": 774,
                                                                    "end_token": 774,
                                                                    "children": []
                                                                }
                                                            ]
                                                        },
                                                        {
                                                            "type": "identifier",
                                                            "label": "openai_api_key",
                                                            "start_token": 776,
                                                            "end_token": 776,
                                                            "children": []
                                                        }
                                                    ]
                                                },
                                                {
                                                    "type": "block",
                                                    "label": "all_credentials.append(openai_credentials)",
                                                    "start_token": 779,
                                                    "end_token": 784,
                                                    "children": [
                                                        {
                                                            "type": "expression_statement",
                                                            "label": "all_credentials.append(openai_credentials)",
                                                            "start_token": 779,
                                                            "end_token": 784,
                                                            "children": [
                                                                {
                                                                    "type": "call",
                                                                    "label": "all_credentials.append(openai_credentials)",
                                                                    "start_token": 779,
                                                                    "end_token": 784,
                                                                    "children": [
                                                                        {
                                                                            "type": "attribute",
                                                                            "label": "all_credentials.append",
                                                                            "start_token": 779,
                                                                            "end_token": 781,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "all_credentials",
                                                                                    "start_token": 779,
                                                                                    "end_token": 779,
                                                                                    "children": []
                                                                                },
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "append",
                                                                                    "start_token": 781,
                                                                                    "end_token": 781,
                                                                                    "children": []
                                                                                }
                                                                            ]
                                                                        },
                                                                        {
                                                                            "type": "argument_list",
                                                                            "label": "(openai_credentials)",
                                                                            "start_token": 782,
                                                                            "end_token": 784,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "openai_credentials",
                                                                                    "start_token": 783,
                                                                                    "end_token": 783,
                                                                                    "children": []
                                                                                }
                                                                            ]
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                }
                                            ]
                                        },
                                        {
                                            "type": "if_statement",
                                            "label": "if settings.secrets.anthropic_api_key:\n            all_credentials.append(anthropic_credentials)",
                                            "start_token": 786,
                                            "end_token": 799,
                                            "children": [
                                                {
                                                    "type": "attribute",
                                                    "label": "settings.secrets.anthropic_api_key",
                                                    "start_token": 787,
                                                    "end_token": 791,
                                                    "children": [
                                                        {
                                                            "type": "attribute",
                                                            "label": "settings.secrets",
                                                            "start_token": 787,
                                                            "end_token": 789,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "label": "settings",
                                                                    "start_token": 787,
                                                                    "end_token": 787,
                                                                    "children": []
                                                                },
                                                                {
                                                                    "type": "identifier",
                                                                    "label": "secrets",
                                                                    "start_token": 789,
                                                                    "end_token": 789,
                                                                    "children": []
                                                                }
                                                            ]
                                                        },
                                                        {
                                                            "type": "identifier",
                                                            "label": "anthropic_api_key",
                                                            "start_token": 791,
                                                            "end_token": 791,
                                                            "children": []
                                                        }
                                                    ]
                                                },
                                                {
                                                    "type": "block",
                                                    "label": "all_credentials.append(anthropic_credentials)",
                                                    "start_token": 794,
                                                    "end_token": 799,
                                                    "children": [
                                                        {
                                                            "type": "expression_statement",
                                                            "label": "all_credentials.append(anthropic_credentials)",
                                                            "start_token": 794,
                                                            "end_token": 799,
                                                            "children": [
                                                                {
                                                                    "type": "call",
                                                                    "label": "all_credentials.append(anthropic_credentials)",
                                                                    "start_token": 794,
                                                                    "end_token": 799,
                                                                    "children": [
                                                                        {
                                                                            "type": "attribute",
                                                                            "label": "all_credentials.append",
                                                                            "start_token": 794,
                                                                            "end_token": 796,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "all_credentials",
                                                                                    "start_token": 794,
                                                                                    "end_token": 794,
                                                                                    "children": []
                                                                                },
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "append",
                                                                                    "start_token": 796,
                                                                                    "end_token": 796,
                                                                                    "children": []
                                                                                }
                                                                            ]
                                                                        },
                                                                        {
                                                                            "type": "argument_list",
                                                                            "label": "(anthropic_credentials)",
                                                                            "start_token": 797,
                                                                            "end_token": 799,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "anthropic_credentials",
                                                                                    "start_token": 798,
                                                                                    "end_token": 798,
                                                                                    "children": []
                                                                                }
                                                                            ]
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                }
                                            ]
                                        },
                                        {
                                            "type": "if_statement",
                                            "label": "if settings.secrets.did_api_key:\n            all_credentials.append(did_credentials)",
                                            "start_token": 801,
                                            "end_token": 814,
                                            "children": [
                                                {
                                                    "type": "attribute",
                                                    "label": "settings.secrets.did_api_key",
                                                    "start_token": 802,
                                                    "end_token": 806,
                                                    "children": [
                                                        {
                                                            "type": "attribute",
                                                            "label": "settings.secrets",
                                                            "start_token": 802,
                                                            "end_token": 804,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "label": "settings",
                                                                    "start_token": 802,
                                                                    "end_token": 802,
                                                                    "children": []
                                                                },
                                                                {
                                                                    "type": "identifier",
                                                                    "label": "secrets",
                                                                    "start_token": 804,
                                                                    "end_token": 804,
                                                                    "children": []
                                                                }
                                                            ]
                                                        },
                                                        {
                                                            "type": "identifier",
                                                            "label": "did_api_key",
                                                            "start_token": 806,
                                                            "end_token": 806,
                                                            "children": []
                                                        }
                                                    ]
                                                },
                                                {
                                                    "type": "block",
                                                    "label": "all_credentials.append(did_credentials)",
                                                    "start_token": 809,
                                                    "end_token": 814,
                                                    "children": [
                                                        {
                                                            "type": "expression_statement",
                                                            "label": "all_credentials.append(did_credentials)",
                                                            "start_token": 809,
                                                            "end_token": 814,
                                                            "children": [
                                                                {
                                                                    "type": "call",
                                                                    "label": "all_credentials.append(did_credentials)",
                                                                    "start_token": 809,
                                                                    "end_token": 814,
                                                                    "children": [
                                                                        {
                                                                            "type": "attribute",
                                                                            "label": "all_credentials.append",
                                                                            "start_token": 809,
                                                                            "end_token": 811,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "all_credentials",
                                                                                    "start_token": 809,
                                                                                    "end_token": 809,
                                                                                    "children": []
                                                                                },
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "append",
                                                                                    "start_token": 811,
                                                                                    "end_token": 811,
                                                                                    "children": []
                                                                                }
                                                                            ]
                                                                        },
                                                                        {
                                                                            "type": "argument_list",
                                                                            "label": "(did_credentials)",
                                                                            "start_token": 812,
                                                                            "end_token": 814,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "did_credentials",
                                                                                    "start_token": 813,
                                                                                    "end_token": 813,
                                                                                    "children": []
                                                                                }
                                                                            ]
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                }
                                            ]
                                        },
                                        {
                                            "type": "if_statement",
                                            "label": "if settings.secrets.jina_api_key:\n            all_credentials.append(jina_credentials)",
                                            "start_token": 816,
                                            "end_token": 829,
                                            "children": [
                                                {
                                                    "type": "attribute",
                                                    "label": "settings.secrets.jina_api_key",
                                                    "start_token": 817,
                                                    "end_token": 821,
                                                    "children": [
                                                        {
                                                            "type": "attribute",
                                                            "label": "settings.secrets",
                                                            "start_token": 817,
                                                            "end_token": 819,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "label": "settings",
                                                                    "start_token": 817,
                                                                    "end_token": 817,
                                                                    "children": []
                                                                },
                                                                {
                                                                    "type": "identifier",
                                                                    "label": "secrets",
                                                                    "start_token": 819,
                                                                    "end_token": 819,
                                                                    "children": []
                                                                }
                                                            ]
                                                        },
                                                        {
                                                            "type": "identifier",
                                                            "label": "jina_api_key",
                                                            "start_token": 821,
                                                            "end_token": 821,
                                                            "children": []
                                                        }
                                                    ]
                                                },
                                                {
                                                    "type": "block",
                                                    "label": "all_credentials.append(jina_credentials)",
                                                    "start_token": 824,
                                                    "end_token": 829,
                                                    "children": [
                                                        {
                                                            "type": "expression_statement",
                                                            "label": "all_credentials.append(jina_credentials)",
                                                            "start_token": 824,
                                                            "end_token": 829,
                                                            "children": [
                                                                {
                                                                    "type": "call",
                                                                    "label": "all_credentials.append(jina_credentials)",
                                                                    "start_token": 824,
                                                                    "end_token": 829,
                                                                    "children": [
                                                                        {
                                                                            "type": "attribute",
                                                                            "label": "all_credentials.append",
                                                                            "start_token": 824,
                                                                            "end_token": 826,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "all_credentials",
                                                                                    "start_token": 824,
                                                                                    "end_token": 824,
                                                                                    "children": []
                                                                                },
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "append",
                                                                                    "start_token": 826,
                                                                                    "end_token": 826,
                                                                                    "children": []
                                                                                }
                                                                            ]
                                                                        },
                                                                        {
                                                                            "type": "argument_list",
                                                                            "label": "(jina_credentials)",
                                                                            "start_token": 827,
                                                                            "end_token": 829,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "jina_credentials",
                                                                                    "start_token": 828,
                                                                                    "end_token": 828,
                                                                                    "children": []
                                                                                }
                                                                            ]
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                }
                                            ]
                                        },
                                        {
                                            "type": "if_statement",
                                            "label": "if settings.secrets.unreal_speech_api_key:\n            all_credentials.append(unreal_credentials)",
                                            "start_token": 831,
                                            "end_token": 844,
                                            "children": [
                                                {
                                                    "type": "attribute",
                                                    "label": "settings.secrets.unreal_speech_api_key",
                                                    "start_token": 832,
                                                    "end_token": 836,
                                                    "children": [
                                                        {
                                                            "type": "attribute",
                                                            "label": "settings.secrets",
                                                            "start_token": 832,
                                                            "end_token": 834,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "label": "settings",
                                                                    "start_token": 832,
                                                                    "end_token": 832,
                                                                    "children": []
                                                                },
                                                                {
                                                                    "type": "identifier",
                                                                    "label": "secrets",
                                                                    "start_token": 834,
                                                                    "end_token": 834,
                                                                    "children": []
                                                                }
                                                            ]
                                                        },
                                                        {
                                                            "type": "identifier",
                                                            "label": "unreal_speech_api_key",
                                                            "start_token": 836,
                                                            "end_token": 836,
                                                            "children": []
                                                        }
                                                    ]
                                                },
                                                {
                                                    "type": "block",
                                                    "label": "all_credentials.append(unreal_credentials)",
                                                    "start_token": 839,
                                                    "end_token": 844,
                                                    "children": [
                                                        {
                                                            "type": "expression_statement",
                                                            "label": "all_credentials.append(unreal_credentials)",
                                                            "start_token": 839,
                                                            "end_token": 844,
                                                            "children": [
                                                                {
                                                                    "type": "call",
                                                                    "label": "all_credentials.append(unreal_credentials)",
                                                                    "start_token": 839,
                                                                    "end_token": 844,
                                                                    "children": [
                                                                        {
                                                                            "type": "attribute",
                                                                            "label": "all_credentials.append",
                                                                            "start_token": 839,
                                                                            "end_token": 841,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "all_credentials",
                                                                                    "start_token": 839,
                                                                                    "end_token": 839,
                                                                                    "children": []
                                                                                },
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "append",
                                                                                    "start_token": 841,
                                                                                    "end_token": 841,
                                                                                    "children": []
                                                                                }
                                                                            ]
                                                                        },
                                                                        {
                                                                            "type": "argument_list",
                                                                            "label": "(unreal_credentials)",
                                                                            "start_token": 842,
                                                                            "end_token": 844,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "unreal_credentials",
                                                                                    "start_token": 843,
                                                                                    "end_token": 843,
                                                                                    "children": []
                                                                                }
                                                                            ]
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                }
                                            ]
                                        },
                                        {
                                            "type": "if_statement",
                                            "label": "if settings.secrets.open_router_api_key:\n            all_credentials.append(open_router_credentials)",
                                            "start_token": 846,
                                            "end_token": 859,
                                            "children": [
                                                {
                                                    "type": "attribute",
                                                    "label": "settings.secrets.open_router_api_key",
                                                    "start_token": 847,
                                                    "end_token": 851,
                                                    "children": [
                                                        {
                                                            "type": "attribute",
                                                            "label": "settings.secrets",
                                                            "start_token": 847,
                                                            "end_token": 849,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "label": "settings",
                                                                    "start_token": 847,
                                                                    "end_token": 847,
                                                                    "children": []
                                                                },
                                                                {
                                                                    "type": "identifier",
                                                                    "label": "secrets",
                                                                    "start_token": 849,
                                                                    "end_token": 849,
                                                                    "children": []
                                                                }
                                                            ]
                                                        },
                                                        {
                                                            "type": "identifier",
                                                            "label": "open_router_api_key",
                                                            "start_token": 851,
                                                            "end_token": 851,
                                                            "children": []
                                                        }
                                                    ]
                                                },
                                                {
                                                    "type": "block",
                                                    "label": "all_credentials.append(open_router_credentials)",
                                                    "start_token": 854,
                                                    "end_token": 859,
                                                    "children": [
                                                        {
                                                            "type": "expression_statement",
                                                            "label": "all_credentials.append(open_router_credentials)",
                                                            "start_token": 854,
                                                            "end_token": 859,
                                                            "children": [
                                                                {
                                                                    "type": "call",
                                                                    "label": "all_credentials.append(open_router_credentials)",
                                                                    "start_token": 854,
                                                                    "end_token": 859,
                                                                    "children": [
                                                                        {
                                                                            "type": "attribute",
                                                                            "label": "all_credentials.append",
                                                                            "start_token": 854,
                                                                            "end_token": 856,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "all_credentials",
                                                                                    "start_token": 854,
                                                                                    "end_token": 854,
                                                                                    "children": []
                                                                                },
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "append",
                                                                                    "start_token": 856,
                                                                                    "end_token": 856,
                                                                                    "children": []
                                                                                }
                                                                            ]
                                                                        },
                                                                        {
                                                                            "type": "argument_list",
                                                                            "label": "(open_router_credentials)",
                                                                            "start_token": 857,
                                                                            "end_token": 859,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "open_router_credentials",
                                                                                    "start_token": 858,
                                                                                    "end_token": 858,
                                                                                    "children": []
                                                                                }
                                                                            ]
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                }
                                            ]
                                        },
                                        {
                                            "type": "return_statement",
                                            "label": "return all_credentials",
                                            "start_token": 861,
                                            "end_token": 862,
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "label": "all_credentials",
                                                    "start_token": 862,
                                                    "end_token": 862,
                                                    "children": []
                                                }
                                            ]
                                        }
                                    ]
                                }
                            ]
                        },
                        {
                            "type": "function_definition",
                            "label": "def get_creds_by_id(self, user_id: str, credentials_id: str) -> Credentials | None:\n        all_credentials = self.get_all_creds(user_id)\n        return next((c for c in all_credentials if c.id == credentials_id), None)",
                            "start_token": 865,
                            "end_token": 913,
                            "children": [
                                {
                                    "type": "identifier",
                                    "label": "get_creds_by_id",
                                    "start_token": 866,
                                    "end_token": 866,
                                    "children": []
                                },
                                {
                                    "type": "parameters",
                                    "label": "(self, user_id: str, credentials_id: str)",
                                    "start_token": 867,
                                    "end_token": 877,
                                    "children": [
                                        {
                                            "type": "identifier",
                                            "label": "self",
                                            "start_token": 868,
                                            "end_token": 868,
                                            "children": []
                                        },
                                        {
                                            "type": "typed_parameter",
                                            "label": "user_id: str",
                                            "start_token": 870,
                                            "end_token": 872,
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "label": "user_id",
                                                    "start_token": 870,
                                                    "end_token": 870,
                                                    "children": []
                                                },
                                                {
                                                    "type": "type",
                                                    "label": "str",
                                                    "start_token": 872,
                                                    "end_token": 872,
                                                    "children": [
                                                        {
                                                            "type": "identifier",
                                                            "label": "str",
                                                            "start_token": 872,
                                                            "end_token": 872,
                                                            "children": []
                                                        }
                                                    ]
                                                }
                                            ]
                                        },
                                        {
                                            "type": "typed_parameter",
                                            "label": "credentials_id: str",
                                            "start_token": 874,
                                            "end_token": 876,
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "label": "credentials_id",
                                                    "start_token": 874,
                                                    "end_token": 874,
                                                    "children": []
                                                },
                                                {
                                                    "type": "type",
                                                    "label": "str",
                                                    "start_token": 876,
                                                    "end_token": 876,
                                                    "children": [
                                                        {
                                                            "type": "identifier",
                                                            "label": "str",
                                                            "start_token": 876,
                                                            "end_token": 876,
                                                            "children": []
                                                        }
                                                    ]
                                                }
                                            ]
                                        }
                                    ]
                                },
                                {
                                    "type": "type",
                                    "label": "Credentials | None",
                                    "start_token": 880,
                                    "end_token": 882,
                                    "children": [
                                        {
                                            "type": "binary_operator",
                                            "label": "Credentials | None",
                                            "start_token": 880,
                                            "end_token": 882,
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "label": "Credentials",
                                                    "start_token": 880,
                                                    "end_token": 880,
                                                    "children": []
                                                },
                                                {
                                                    "type": "none",
                                                    "label": "None",
                                                    "start_token": 882,
                                                    "end_token": 882,
                                                    "children": []
                                                }
                                            ]
                                        }
                                    ]
                                },
                                {
                                    "type": "block",
                                    "label": "all_credentials = self.get_all_creds(user_id)\n        return next((c for c in all_credentials if c.id == credentials_id), None)",
                                    "start_token": 885,
                                    "end_token": 913,
                                    "children": [
                                        {
                                            "type": "expression_statement",
                                            "label": "all_credentials = self.get_all_creds(user_id)",
                                            "start_token": 885,
                                            "end_token": 892,
                                            "children": [
                                                {
                                                    "type": "assignment",
                                                    "label": "all_credentials = self.get_all_creds(user_id)",
                                                    "start_token": 885,
                                                    "end_token": 892,
                                                    "children": [
                                                        {
                                                            "type": "identifier",
                                                            "label": "all_credentials",
                                                            "start_token": 885,
                                                            "end_token": 885,
                                                            "children": []
                                                        },
                                                        {
                                                            "type": "call",
                                                            "label": "self.get_all_creds(user_id)",
                                                            "start_token": 887,
                                                            "end_token": 892,
                                                            "children": [
                                                                {
                                                                    "type": "attribute",
                                                                    "label": "self.get_all_creds",
                                                                    "start_token": 887,
                                                                    "end_token": 889,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "self",
                                                                            "start_token": 887,
                                                                            "end_token": 887,
                                                                            "children": []
                                                                        },
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "get_all_creds",
                                                                            "start_token": 889,
                                                                            "end_token": 889,
                                                                            "children": []
                                                                        }
                                                                    ]
                                                                },
                                                                {
                                                                    "type": "argument_list",
                                                                    "label": "(user_id)",
                                                                    "start_token": 890,
                                                                    "end_token": 892,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "user_id",
                                                                            "start_token": 891,
                                                                            "end_token": 891,
                                                                            "children": []
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                }
                                            ]
                                        },
                                        {
                                            "type": "return_statement",
                                            "label": "return next((c for c in all_credentials if c.id == credentials_id), None)",
                                            "start_token": 894,
                                            "end_token": 913,
                                            "children": [
                                                {
                                                    "type": "call",
                                                    "label": "next((c for c in all_credentials if c.id == credentials_id), None)",
                                                    "start_token": 895,
                                                    "end_token": 913,
                                                    "children": [
                                                        {
                                                            "type": "identifier",
                                                            "label": "next",
                                                            "start_token": 895,
                                                            "end_token": 895,
                                                            "children": []
                                                        },
                                                        {
                                                            "type": "argument_list",
                                                            "label": "((c for c in all_credentials if c.id == credentials_id), None)",
                                                            "start_token": 896,
                                                            "end_token": 913,
                                                            "children": [
                                                                {
                                                                    "type": "generator_expression",
                                                                    "label": "(c for c in all_credentials if c.id == credentials_id)",
                                                                    "start_token": 897,
                                                                    "end_token": 910,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "c",
                                                                            "start_token": 898,
                                                                            "end_token": 898,
                                                                            "children": []
                                                                        },
                                                                        {
                                                                            "type": "for_in_clause",
                                                                            "label": "for c in all_credentials",
                                                                            "start_token": 899,
                                                                            "end_token": 902,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "c",
                                                                                    "start_token": 900,
                                                                                    "end_token": 900,
                                                                                    "children": []
                                                                                },
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "all_credentials",
                                                                                    "start_token": 902,
                                                                                    "end_token": 902,
                                                                                    "children": []
                                                                                }
                                                                            ]
                                                                        },
                                                                        {
                                                                            "type": "if_clause",
                                                                            "label": "if c.id == credentials_id",
                                                                            "start_token": 903,
                                                                            "end_token": 909,
                                                                            "children": [
                                                                                {
                                                                                    "type": "comparison_operator",
                                                                                    "label": "c.id == credentials_id",
                                                                                    "start_token": 904,
                                                                                    "end_token": 909,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "attribute",
                                                                                            "label": "c.id",
                                                                                            "start_token": 904,
                                                                                            "end_token": 906,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "label": "c",
                                                                                                    "start_token": 904,
                                                                                                    "end_token": 904,
                                                                                                    "children": []
                                                                                                },
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "label": "id",
                                                                                                    "start_token": 906,
                                                                                                    "end_token": 906,
                                                                                                    "children": []
                                                                                                }
                                                                                            ]
                                                                                        },
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "label": "credentials_id",
                                                                                            "start_token": 909,
                                                                                            "end_token": 909,
                                                                                            "children": []
                                                                                        }
                                                                                    ]
                                                                                }
                                                                            ]
                                                                        }
                                                                    ]
                                                                },
                                                                {
                                                                    "type": "none",
                                                                    "label": "None",
                                                                    "start_token": 912,
                                                                    "end_token": 912,
                                                                    "children": []
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                }
                                            ]
                                        }
                                    ]
                                }
                            ]
                        },
                        {
                            "type": "function_definition",
                            "label": "def get_creds_by_provider(self, user_id: str, provider: str) -> list[Credentials]:\n        credentials = self.get_all_creds(user_id)\n        return [c for c in credentials if c.provider == provider]",
                            "start_token": 916,
                            "end_token": 960,
                            "children": [
                                {
                                    "type": "identifier",
                                    "label": "get_creds_by_provider",
                                    "start_token": 917,
                                    "end_token": 917,
                                    "children": []
                                },
                                {
                                    "type": "parameters",
                                    "label": "(self, user_id: str, provider: str)",
                                    "start_token": 918,
                                    "end_token": 928,
                                    "children": [
                                        {
                                            "type": "identifier",
                                            "label": "self",
                                            "start_token": 919,
                                            "end_token": 919,
                                            "children": []
                                        },
                                        {
                                            "type": "typed_parameter",
                                            "label": "user_id: str",
                                            "start_token": 921,
                                            "end_token": 923,
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "label": "user_id",
                                                    "start_token": 921,
                                                    "end_token": 921,
                                                    "children": []
                                                },
                                                {
                                                    "type": "type",
                                                    "label": "str",
                                                    "start_token": 923,
                                                    "end_token": 923,
                                                    "children": [
                                                        {
                                                            "type": "identifier",
                                                            "label": "str",
                                                            "start_token": 923,
                                                            "end_token": 923,
                                                            "children": []
                                                        }
                                                    ]
                                                }
                                            ]
                                        },
                                        {
                                            "type": "typed_parameter",
                                            "label": "provider: str",
                                            "start_token": 925,
                                            "end_token": 927,
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "label": "provider",
                                                    "start_token": 925,
                                                    "end_token": 925,
                                                    "children": []
                                                },
                                                {
                                                    "type": "type",
                                                    "label": "str",
                                                    "start_token": 927,
                                                    "end_token": 927,
                                                    "children": [
                                                        {
                                                            "type": "identifier",
                                                            "label": "str",
                                                            "start_token": 927,
                                                            "end_token": 927,
                                                            "children": []
                                                        }
                                                    ]
                                                }
                                            ]
                                        }
                                    ]
                                },
                                {
                                    "type": "type",
                                    "label": "list[Credentials]",
                                    "start_token": 931,
                                    "end_token": 934,
                                    "children": [
                                        {
                                            "type": "generic_type",
                                            "label": "list[Credentials]",
                                            "start_token": 931,
                                            "end_token": 934,
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "label": "list",
                                                    "start_token": 931,
                                                    "end_token": 931,
                                                    "children": []
                                                },
                                                {
                                                    "type": "type_parameter",
                                                    "label": "[Credentials]",
                                                    "start_token": 932,
                                                    "end_token": 934,
                                                    "children": [
                                                        {
                                                            "type": "type",
                                                            "label": "Credentials",
                                                            "start_token": 933,
                                                            "end_token": 933,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "label": "Credentials",
                                                                    "start_token": 933,
                                                                    "end_token": 933,
                                                                    "children": []
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                }
                                            ]
                                        }
                                    ]
                                },
                                {
                                    "type": "block",
                                    "label": "credentials = self.get_all_creds(user_id)\n        return [c for c in credentials if c.provider == provider]",
                                    "start_token": 937,
                                    "end_token": 960,
                                    "children": [
                                        {
                                            "type": "expression_statement",
                                            "label": "credentials = self.get_all_creds(user_id)",
                                            "start_token": 937,
                                            "end_token": 944,
                                            "children": [
                                                {
                                                    "type": "assignment",
                                                    "label": "credentials = self.get_all_creds(user_id)",
                                                    "start_token": 937,
                                                    "end_token": 944,
                                                    "children": [
                                                        {
                                                            "type": "identifier",
                                                            "label": "credentials",
                                                            "start_token": 937,
                                                            "end_token": 937,
                                                            "children": []
                                                        },
                                                        {
                                                            "type": "call",
                                                            "label": "self.get_all_creds(user_id)",
                                                            "start_token": 939,
                                                            "end_token": 944,
                                                            "children": [
                                                                {
                                                                    "type": "attribute",
                                                                    "label": "self.get_all_creds",
                                                                    "start_token": 939,
                                                                    "end_token": 941,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "self",
                                                                            "start_token": 939,
                                                                            "end_token": 939,
                                                                            "children": []
                                                                        },
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "get_all_creds",
                                                                            "start_token": 941,
                                                                            "end_token": 941,
                                                                            "children": []
                                                                        }
                                                                    ]
                                                                },
                                                                {
                                                                    "type": "argument_list",
                                                                    "label": "(user_id)",
                                                                    "start_token": 942,
                                                                    "end_token": 944,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "user_id",
                                                                            "start_token": 943,
                                                                            "end_token": 943,
                                                                            "children": []
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                }
                                            ]
                                        },
                                        {
                                            "type": "return_statement",
                                            "label": "return [c for c in credentials if c.provider == provider]",
                                            "start_token": 946,
                                            "end_token": 960,
                                            "children": [
                                                {
                                                    "type": "list_comprehension",
                                                    "label": "[c for c in credentials if c.provider == provider]",
                                                    "start_token": 947,
                                                    "end_token": 960,
                                                    "children": [
                                                        {
                                                            "type": "identifier",
                                                            "label": "c",
                                                            "start_token": 948,
                                                            "end_token": 948,
                                                            "children": []
                                                        },
                                                        {
                                                            "type": "for_in_clause",
                                                            "label": "for c in credentials",
                                                            "start_token": 949,
                                                            "end_token": 952,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "label": "c",
                                                                    "start_token": 950,
                                                                    "end_token": 950,
                                                                    "children": []
                                                                },
                                                                {
                                                                    "type": "identifier",
                                                                    "label": "credentials",
                                                                    "start_token": 952,
                                                                    "end_token": 952,
                                                                    "children": []
                                                                }
                                                            ]
                                                        },
                                                        {
                                                            "type": "if_clause",
                                                            "label": "if c.provider == provider",
                                                            "start_token": 953,
                                                            "end_token": 959,
                                                            "children": [
                                                                {
                                                                    "type": "comparison_operator",
                                                                    "label": "c.provider == provider",
                                                                    "start_token": 954,
                                                                    "end_token": 959,
                                                                    "children": [
                                                                        {
                                                                            "type": "attribute",
                                                                            "label": "c.provider",
                                                                            "start_token": 954,
                                                                            "end_token": 956,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "c",
                                                                                    "start_token": 954,
                                                                                    "end_token": 954,
                                                                                    "children": []
                                                                                },
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "provider",
                                                                                    "start_token": 956,
                                                                                    "end_token": 956,
                                                                                    "children": []
                                                                                }
                                                                            ]
                                                                        },
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "provider",
                                                                            "start_token": 959,
                                                                            "end_token": 959,
                                                                            "children": []
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                }
                                            ]
                                        }
                                    ]
                                }
                            ]
                        },
                        {
                            "type": "function_definition",
                            "label": "def get_authorized_providers(self, user_id: str) -> list[str]:\n        credentials = self.get_all_creds(user_id)\n        return list(set(c.provider for c in credentials))",
                            "start_token": 963,
                            "end_token": 1002,
                            "children": [
                                {
                                    "type": "identifier",
                                    "label": "get_authorized_providers",
                                    "start_token": 964,
                                    "end_token": 964,
                                    "children": []
                                },
                                {
                                    "type": "parameters",
                                    "label": "(self, user_id: str)",
                                    "start_token": 965,
                                    "end_token": 971,
                                    "children": [
                                        {
                                            "type": "identifier",
                                            "label": "self",
                                            "start_token": 966,
                                            "end_token": 966,
                                            "children": []
                                        },
                                        {
                                            "type": "typed_parameter",
                                            "label": "user_id: str",
                                            "start_token": 968,
                                            "end_token": 970,
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "label": "user_id",
                                                    "start_token": 968,
                                                    "end_token": 968,
                                                    "children": []
                                                },
                                                {
                                                    "type": "type",
                                                    "label": "str",
                                                    "start_token": 970,
                                                    "end_token": 970,
                                                    "children": [
                                                        {
                                                            "type": "identifier",
                                                            "label": "str",
                                                            "start_token": 970,
                                                            "end_token": 970,
                                                            "children": []
                                                        }
                                                    ]
                                                }
                                            ]
                                        }
                                    ]
                                },
                                {
                                    "type": "type",
                                    "label": "list[str]",
                                    "start_token": 974,
                                    "end_token": 977,
                                    "children": [
                                        {
                                            "type": "generic_type",
                                            "label": "list[str]",
                                            "start_token": 974,
                                            "end_token": 977,
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "label": "list",
                                                    "start_token": 974,
                                                    "end_token": 974,
                                                    "children": []
                                                },
                                                {
                                                    "type": "type_parameter",
                                                    "label": "[str]",
                                                    "start_token": 975,
                                                    "end_token": 977,
                                                    "children": [
                                                        {
                                                            "type": "type",
                                                            "label": "str",
                                                            "start_token": 976,
                                                            "end_token": 976,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "label": "str",
                                                                    "start_token": 976,
                                                                    "end_token": 976,
                                                                    "children": []
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                }
                                            ]
                                        }
                                    ]
                                },
                                {
                                    "type": "block",
                                    "label": "credentials = self.get_all_creds(user_id)\n        return list(set(c.provider for c in credentials))",
                                    "start_token": 980,
                                    "end_token": 1002,
                                    "children": [
                                        {
                                            "type": "expression_statement",
                                            "label": "credentials = self.get_all_creds(user_id)",
                                            "start_token": 980,
                                            "end_token": 987,
                                            "children": [
                                                {
                                                    "type": "assignment",
                                                    "label": "credentials = self.get_all_creds(user_id)",
                                                    "start_token": 980,
                                                    "end_token": 987,
                                                    "children": [
                                                        {
                                                            "type": "identifier",
                                                            "label": "credentials",
                                                            "start_token": 980,
                                                            "end_token": 980,
                                                            "children": []
                                                        },
                                                        {
                                                            "type": "call",
                                                            "label": "self.get_all_creds(user_id)",
                                                            "start_token": 982,
                                                            "end_token": 987,
                                                            "children": [
                                                                {
                                                                    "type": "attribute",
                                                                    "label": "self.get_all_creds",
                                                                    "start_token": 982,
                                                                    "end_token": 984,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "self",
                                                                            "start_token": 982,
                                                                            "end_token": 982,
                                                                            "children": []
                                                                        },
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "get_all_creds",
                                                                            "start_token": 984,
                                                                            "end_token": 984,
                                                                            "children": []
                                                                        }
                                                                    ]
                                                                },
                                                                {
                                                                    "type": "argument_list",
                                                                    "label": "(user_id)",
                                                                    "start_token": 985,
                                                                    "end_token": 987,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "user_id",
                                                                            "start_token": 986,
                                                                            "end_token": 986,
                                                                            "children": []
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                }
                                            ]
                                        },
                                        {
                                            "type": "return_statement",
                                            "label": "return list(set(c.provider for c in credentials))",
                                            "start_token": 989,
                                            "end_token": 1002,
                                            "children": [
                                                {
                                                    "type": "call",
                                                    "label": "list(set(c.provider for c in credentials))",
                                                    "start_token": 990,
                                                    "end_token": 1002,
                                                    "children": [
                                                        {
                                                            "type": "identifier",
                                                            "label": "list",
                                                            "start_token": 990,
                                                            "end_token": 990,
                                                            "children": []
                                                        },
                                                        {
                                                            "type": "argument_list",
                                                            "label": "(set(c.provider for c in credentials))",
                                                            "start_token": 991,
                                                            "end_token": 1002,
                                                            "children": [
                                                                {
                                                                    "type": "call",
                                                                    "label": "set(c.provider for c in credentials)",
                                                                    "start_token": 992,
                                                                    "end_token": 1001,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "set",
                                                                            "start_token": 992,
                                                                            "end_token": 992,
                                                                            "children": []
                                                                        },
                                                                        {
                                                                            "type": "generator_expression",
                                                                            "label": "(c.provider for c in credentials)",
                                                                            "start_token": 993,
                                                                            "end_token": 1001,
                                                                            "children": [
                                                                                {
                                                                                    "type": "attribute",
                                                                                    "label": "c.provider",
                                                                                    "start_token": 994,
                                                                                    "end_token": 996,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "label": "c",
                                                                                            "start_token": 994,
                                                                                            "end_token": 994,
                                                                                            "children": []
                                                                                        },
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "label": "provider",
                                                                                            "start_token": 996,
                                                                                            "end_token": 996,
                                                                                            "children": []
                                                                                        }
                                                                                    ]
                                                                                },
                                                                                {
                                                                                    "type": "for_in_clause",
                                                                                    "label": "for c in credentials",
                                                                                    "start_token": 997,
                                                                                    "end_token": 1000,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "label": "c",
                                                                                            "start_token": 998,
                                                                                            "end_token": 998,
                                                                                            "children": []
                                                                                        },
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "label": "credentials",
                                                                                            "start_token": 1000,
                                                                                            "end_token": 1000,
                                                                                            "children": []
                                                                                        }
                                                                                    ]
                                                                                }
                                                                            ]
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                }
                                            ]
                                        }
                                    ]
                                }
                            ]
                        },
                        {
                            "type": "function_definition",
                            "label": "def update_creds(self, user_id: str, updated: Credentials) -> None:\n        with self.locked_user_integrations(user_id):\n            current = self.get_creds_by_id(user_id, updated.id)\n            if not current:\n                raise ValueError(\n                    f\"Credentials with ID {updated.id} \"\n                    f\"for user with ID {user_id} not found\"\n                )\n            if type(current) is not type(updated):\n                raise TypeError(\n                    f\"Can not update credentials with ID {updated.id} \"\n                    f\"from type {type(current)} \"\n                    f\"to type {type(updated)}\"\n                )\n\n            # Ensure no scopes are removed when updating credentials\n            if (\n                isinstance(updated, OAuth2Credentials)\n                and isinstance(current, OAuth2Credentials)\n                and not set(updated.scopes).issuperset(current.scopes)\n            ):\n                raise ValueError(\n                    f\"Can not update credentials with ID {updated.id} \"\n                    f\"and scopes {current.scopes} \"\n                    f\"to more restrictive set of scopes {updated.scopes}\"\n                )\n\n            # Update the credentials\n            updated_credentials_list = [\n                updated if c.id == updated.id else c\n                for c in self.get_all_creds(user_id)\n            ]\n            self._set_user_integration_creds(user_id, updated_credentials_list)",
                            "start_token": 1005,
                            "end_token": 1195,
                            "children": [
                                {
                                    "type": "identifier",
                                    "label": "update_creds",
                                    "start_token": 1006,
                                    "end_token": 1006,
                                    "children": []
                                },
                                {
                                    "type": "parameters",
                                    "label": "(self, user_id: str, updated: Credentials)",
                                    "start_token": 1007,
                                    "end_token": 1017,
                                    "children": [
                                        {
                                            "type": "identifier",
                                            "label": "self",
                                            "start_token": 1008,
                                            "end_token": 1008,
                                            "children": []
                                        },
                                        {
                                            "type": "typed_parameter",
                                            "label": "user_id: str",
                                            "start_token": 1010,
                                            "end_token": 1012,
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "label": "user_id",
                                                    "start_token": 1010,
                                                    "end_token": 1010,
                                                    "children": []
                                                },
                                                {
                                                    "type": "type",
                                                    "label": "str",
                                                    "start_token": 1012,
                                                    "end_token": 1012,
                                                    "children": [
                                                        {
                                                            "type": "identifier",
                                                            "label": "str",
                                                            "start_token": 1012,
                                                            "end_token": 1012,
                                                            "children": []
                                                        }
                                                    ]
                                                }
                                            ]
                                        },
                                        {
                                            "type": "typed_parameter",
                                            "label": "updated: Credentials",
                                            "start_token": 1014,
                                            "end_token": 1016,
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "label": "updated",
                                                    "start_token": 1014,
                                                    "end_token": 1014,
                                                    "children": []
                                                },
                                                {
                                                    "type": "type",
                                                    "label": "Credentials",
                                                    "start_token": 1016,
                                                    "end_token": 1016,
                                                    "children": [
                                                        {
                                                            "type": "identifier",
                                                            "label": "Credentials",
                                                            "start_token": 1016,
                                                            "end_token": 1016,
                                                            "children": []
                                                        }
                                                    ]
                                                }
                                            ]
                                        }
                                    ]
                                },
                                {
                                    "type": "type",
                                    "label": "None",
                                    "start_token": 1020,
                                    "end_token": 1020,
                                    "children": [
                                        {
                                            "type": "none",
                                            "label": "None",
                                            "start_token": 1020,
                                            "end_token": 1020,
                                            "children": []
                                        }
                                    ]
                                },
                                {
                                    "type": "block",
                                    "label": "with self.locked_user_integrations(user_id):\n            current = self.get_creds_by_id(user_id, updated.id)\n            if not current:\n                raise ValueError(\n                    f\"Credentials with ID {updated.id} \"\n                    f\"for user with ID {user_id} not found\"\n                )\n            if type(current) is not type(updated):\n                raise TypeError(\n                    f\"Can not update credentials with ID {updated.id} \"\n                    f\"from type {type(current)} \"\n                    f\"to type {type(updated)}\"\n                )\n\n            # Ensure no scopes are removed when updating credentials\n            if (\n                isinstance(updated, OAuth2Credentials)\n                and isinstance(current, OAuth2Credentials)\n                and not set(updated.scopes).issuperset(current.scopes)\n            ):\n                raise ValueError(\n                    f\"Can not update credentials with ID {updated.id} \"\n                    f\"and scopes {current.scopes} \"\n                    f\"to more restrictive set of scopes {updated.scopes}\"\n                )\n\n            # Update the credentials\n            updated_credentials_list = [\n                updated if c.id == updated.id else c\n                for c in self.get_all_creds(user_id)\n            ]\n            self._set_user_integration_creds(user_id, updated_credentials_list)",
                                    "start_token": 1023,
                                    "end_token": 1195,
                                    "children": [
                                        {
                                            "type": "with_statement",
                                            "label": "with self.locked_user_integrations(user_id):\n            current = self.get_creds_by_id(user_id, updated.id)\n            if not current:\n                raise ValueError(\n                    f\"Credentials with ID {updated.id} \"\n                    f\"for user with ID {user_id} not found\"\n                )\n            if type(current) is not type(updated):\n                raise TypeError(\n                    f\"Can not update credentials with ID {updated.id} \"\n                    f\"from type {type(current)} \"\n                    f\"to type {type(updated)}\"\n                )\n\n            # Ensure no scopes are removed when updating credentials\n            if (\n                isinstance(updated, OAuth2Credentials)\n                and isinstance(current, OAuth2Credentials)\n                and not set(updated.scopes).issuperset(current.scopes)\n            ):\n                raise ValueError(\n                    f\"Can not update credentials with ID {updated.id} \"\n                    f\"and scopes {current.scopes} \"\n                    f\"to more restrictive set of scopes {updated.scopes}\"\n                )\n\n            # Update the credentials\n            updated_credentials_list = [\n                updated if c.id == updated.id else c\n                for c in self.get_all_creds(user_id)\n            ]\n            self._set_user_integration_creds(user_id, updated_credentials_list)",
                                            "start_token": 1023,
                                            "end_token": 1195,
                                            "children": [
                                                {
                                                    "type": "with_clause",
                                                    "label": "self.locked_user_integrations(user_id)",
                                                    "start_token": 1024,
                                                    "end_token": 1029,
                                                    "children": [
                                                        {
                                                            "type": "with_item",
                                                            "label": "self.locked_user_integrations(user_id)",
                                                            "start_token": 1024,
                                                            "end_token": 1029,
                                                            "children": [
                                                                {
                                                                    "type": "call",
                                                                    "label": "self.locked_user_integrations(user_id)",
                                                                    "start_token": 1024,
                                                                    "end_token": 1029,
                                                                    "children": [
                                                                        {
                                                                            "type": "attribute",
                                                                            "label": "self.locked_user_integrations",
                                                                            "start_token": 1024,
                                                                            "end_token": 1026,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "self",
                                                                                    "start_token": 1024,
                                                                                    "end_token": 1024,
                                                                                    "children": []
                                                                                },
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "locked_user_integrations",
                                                                                    "start_token": 1026,
                                                                                    "end_token": 1026,
                                                                                    "children": []
                                                                                }
                                                                            ]
                                                                        },
                                                                        {
                                                                            "type": "argument_list",
                                                                            "label": "(user_id)",
                                                                            "start_token": 1027,
                                                                            "end_token": 1029,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "user_id",
                                                                                    "start_token": 1028,
                                                                                    "end_token": 1028,
                                                                                    "children": []
                                                                                }
                                                                            ]
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                },
                                                {
                                                    "type": "block",
                                                    "label": "current = self.get_creds_by_id(user_id, updated.id)\n            if not current:\n                raise ValueError(\n                    f\"Credentials with ID {updated.id} \"\n                    f\"for user with ID {user_id} not found\"\n                )\n            if type(current) is not type(updated):\n                raise TypeError(\n                    f\"Can not update credentials with ID {updated.id} \"\n                    f\"from type {type(current)} \"\n                    f\"to type {type(updated)}\"\n                )\n\n            # Ensure no scopes are removed when updating credentials\n            if (\n                isinstance(updated, OAuth2Credentials)\n                and isinstance(current, OAuth2Credentials)\n                and not set(updated.scopes).issuperset(current.scopes)\n            ):\n                raise ValueError(\n                    f\"Can not update credentials with ID {updated.id} \"\n                    f\"and scopes {current.scopes} \"\n                    f\"to more restrictive set of scopes {updated.scopes}\"\n                )\n\n            # Update the credentials\n            updated_credentials_list = [\n                updated if c.id == updated.id else c\n                for c in self.get_all_creds(user_id)\n            ]\n            self._set_user_integration_creds(user_id, updated_credentials_list)",
                                                    "start_token": 1032,
                                                    "end_token": 1195,
                                                    "children": [
                                                        {
                                                            "type": "expression_statement",
                                                            "label": "current = self.get_creds_by_id(user_id, updated.id)",
                                                            "start_token": 1032,
                                                            "end_token": 1043,
                                                            "children": [
                                                                {
                                                                    "type": "assignment",
                                                                    "label": "current = self.get_creds_by_id(user_id, updated.id)",
                                                                    "start_token": 1032,
                                                                    "end_token": 1043,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "current",
                                                                            "start_token": 1032,
                                                                            "end_token": 1032,
                                                                            "children": []
                                                                        },
                                                                        {
                                                                            "type": "call",
                                                                            "label": "self.get_creds_by_id(user_id, updated.id)",
                                                                            "start_token": 1034,
                                                                            "end_token": 1043,
                                                                            "children": [
                                                                                {
                                                                                    "type": "attribute",
                                                                                    "label": "self.get_creds_by_id",
                                                                                    "start_token": 1034,
                                                                                    "end_token": 1036,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "label": "self",
                                                                                            "start_token": 1034,
                                                                                            "end_token": 1034,
                                                                                            "children": []
                                                                                        },
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "label": "get_creds_by_id",
                                                                                            "start_token": 1036,
                                                                                            "end_token": 1036,
                                                                                            "children": []
                                                                                        }
                                                                                    ]
                                                                                },
                                                                                {
                                                                                    "type": "argument_list",
                                                                                    "label": "(user_id, updated.id)",
                                                                                    "start_token": 1037,
                                                                                    "end_token": 1043,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "label": "user_id",
                                                                                            "start_token": 1038,
                                                                                            "end_token": 1038,
                                                                                            "children": []
                                                                                        },
                                                                                        {
                                                                                            "type": "attribute",
                                                                                            "label": "updated.id",
                                                                                            "start_token": 1040,
                                                                                            "end_token": 1042,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "label": "updated",
                                                                                                    "start_token": 1040,
                                                                                                    "end_token": 1040,
                                                                                                    "children": []
                                                                                                },
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "label": "id",
                                                                                                    "start_token": 1042,
                                                                                                    "end_token": 1042,
                                                                                                    "children": []
                                                                                                }
                                                                                            ]
                                                                                        }
                                                                                    ]
                                                                                }
                                                                            ]
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        },
                                                        {
                                                            "type": "if_statement",
                                                            "label": "if not current:\n                raise ValueError(\n                    f\"Credentials with ID {updated.id} \"\n                    f\"for user with ID {user_id} not found\"\n                )",
                                                            "start_token": 1045,
                                                            "end_token": 1060,
                                                            "children": [
                                                                {
                                                                    "type": "not_operator",
                                                                    "label": "not current",
                                                                    "start_token": 1046,
                                                                    "end_token": 1047,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "current",
                                                                            "start_token": 1047,
                                                                            "end_token": 1047,
                                                                            "children": []
                                                                        }
                                                                    ]
                                                                },
                                                                {
                                                                    "type": "block",
                                                                    "label": "raise ValueError(\n                    f\"Credentials with ID {updated.id} \"\n                    f\"for user with ID {user_id} not found\"\n                )",
                                                                    "start_token": 1050,
                                                                    "end_token": 1060,
                                                                    "children": [
                                                                        {
                                                                            "type": "raise_statement",
                                                                            "label": "raise ValueError(\n                    f\"Credentials with ID {updated.id} \"\n                    f\"for user with ID {user_id} not found\"\n                )",
                                                                            "start_token": 1050,
                                                                            "end_token": 1060,
                                                                            "children": [
                                                                                {
                                                                                    "type": "call",
                                                                                    "label": "ValueError(\n                    f\"Credentials with ID {updated.id} \"\n                    f\"for user with ID {user_id} not found\"\n                )",
                                                                                    "start_token": 1051,
                                                                                    "end_token": 1060,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "label": "ValueError",
                                                                                            "start_token": 1051,
                                                                                            "end_token": 1051,
                                                                                            "children": []
                                                                                        },
                                                                                        {
                                                                                            "type": "argument_list",
                                                                                            "label": "(\n                    f\"Credentials with ID {updated.id} \"\n                    f\"for user with ID {user_id} not found\"\n                )",
                                                                                            "start_token": 1052,
                                                                                            "end_token": 1060,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "concatenated_string",
                                                                                                    "label": "f\"Credentials with ID {updated.id} \"\n                    f\"for user with ID {user_id} not found\"",
                                                                                                    "start_token": 1054,
                                                                                                    "end_token": 1058,
                                                                                                    "children": [
                                                                                                        {
                                                                                                            "type": "string",
                                                                                                            "label": "f\"Credentials with ID {updated.id} \"",
                                                                                                            "start_token": 1054,
                                                                                                            "end_token": 1055,
                                                                                                            "children": [
                                                                                                                {
                                                                                                                    "type": "string_start",
                                                                                                                    "label": "f\"",
                                                                                                                    "start_token": 1054,
                                                                                                                    "end_token": 1055,
                                                                                                                    "children": []
                                                                                                                },
                                                                                                                {
                                                                                                                    "type": "string_content",
                                                                                                                    "label": "Credentials with ID ",
                                                                                                                    "start_token": 1055,
                                                                                                                    "end_token": 1055,
                                                                                                                    "children": []
                                                                                                                },
                                                                                                                {
                                                                                                                    "type": "interpolation",
                                                                                                                    "label": "{updated.id}",
                                                                                                                    "start_token": 1055,
                                                                                                                    "end_token": 1055,
                                                                                                                    "children": [
                                                                                                                        {
                                                                                                                            "type": "attribute",
                                                                                                                            "label": "updated.id",
                                                                                                                            "start_token": 1055,
                                                                                                                            "end_token": 1055,
                                                                                                                            "children": [
                                                                                                                                {
                                                                                                                                    "type": "identifier",
                                                                                                                                    "label": "updated",
                                                                                                                                    "start_token": 1055,
                                                                                                                                    "end_token": 1055,
                                                                                                                                    "children": []
                                                                                                                                },
                                                                                                                                {
                                                                                                                                    "type": "identifier",
                                                                                                                                    "label": "id",
                                                                                                                                    "start_token": 1055,
                                                                                                                                    "end_token": 1055,
                                                                                                                                    "children": []
                                                                                                                                }
                                                                                                                            ]
                                                                                                                        }
                                                                                                                    ]
                                                                                                                },
                                                                                                                {
                                                                                                                    "type": "string_content",
                                                                                                                    "label": " ",
                                                                                                                    "start_token": 1055,
                                                                                                                    "end_token": 1055,
                                                                                                                    "children": []
                                                                                                                },
                                                                                                                {
                                                                                                                    "type": "string_end",
                                                                                                                    "label": "\"",
                                                                                                                    "start_token": 1055,
                                                                                                                    "end_token": 1055,
                                                                                                                    "children": []
                                                                                                                }
                                                                                                            ]
                                                                                                        },
                                                                                                        {
                                                                                                            "type": "string",
                                                                                                            "label": "f\"for user with ID {user_id} not found\"",
                                                                                                            "start_token": 1057,
                                                                                                            "end_token": 1058,
                                                                                                            "children": [
                                                                                                                {
                                                                                                                    "type": "string_start",
                                                                                                                    "label": "f\"",
                                                                                                                    "start_token": 1057,
                                                                                                                    "end_token": 1058,
                                                                                                                    "children": []
                                                                                                                },
                                                                                                                {
                                                                                                                    "type": "string_content",
                                                                                                                    "label": "for user with ID ",
                                                                                                                    "start_token": 1058,
                                                                                                                    "end_token": 1058,
                                                                                                                    "children": []
                                                                                                                },
                                                                                                                {
                                                                                                                    "type": "interpolation",
                                                                                                                    "label": "{user_id}",
                                                                                                                    "start_token": 1058,
                                                                                                                    "end_token": 1058,
                                                                                                                    "children": [
                                                                                                                        {
                                                                                                                            "type": "identifier",
                                                                                                                            "label": "user_id",
                                                                                                                            "start_token": 1058,
                                                                                                                            "end_token": 1058,
                                                                                                                            "children": []
                                                                                                                        }
                                                                                                                    ]
                                                                                                                },
                                                                                                                {
                                                                                                                    "type": "string_content",
                                                                                                                    "label": " not found",
                                                                                                                    "start_token": 1058,
                                                                                                                    "end_token": 1058,
                                                                                                                    "children": []
                                                                                                                },
                                                                                                                {
                                                                                                                    "type": "string_end",
                                                                                                                    "label": "\"",
                                                                                                                    "start_token": 1058,
                                                                                                                    "end_token": 1058,
                                                                                                                    "children": []
                                                                                                                }
                                                                                                            ]
                                                                                                        }
                                                                                                    ]
                                                                                                }
                                                                                            ]
                                                                                        }
                                                                                    ]
                                                                                }
                                                                            ]
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        },
                                                        {
                                                            "type": "if_statement",
                                                            "label": "if type(current) is not type(updated):\n                raise TypeError(\n                    f\"Can not update credentials with ID {updated.id} \"\n                    f\"from type {type(current)} \"\n                    f\"to type {type(updated)}\"\n                )",
                                                            "start_token": 1062,
                                                            "end_token": 1088,
                                                            "children": [
                                                                {
                                                                    "type": "comparison_operator",
                                                                    "label": "type(current) is not type(updated)",
                                                                    "start_token": 1063,
                                                                    "end_token": 1072,
                                                                    "children": [
                                                                        {
                                                                            "type": "call",
                                                                            "label": "type(current)",
                                                                            "start_token": 1063,
                                                                            "end_token": 1066,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "type",
                                                                                    "start_token": 1063,
                                                                                    "end_token": 1063,
                                                                                    "children": []
                                                                                },
                                                                                {
                                                                                    "type": "argument_list",
                                                                                    "label": "(current)",
                                                                                    "start_token": 1064,
                                                                                    "end_token": 1066,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "label": "current",
                                                                                            "start_token": 1065,
                                                                                            "end_token": 1065,
                                                                                            "children": []
                                                                                        }
                                                                                    ]
                                                                                }
                                                                            ]
                                                                        },
                                                                        {
                                                                            "type": "call",
                                                                            "label": "type(updated)",
                                                                            "start_token": 1069,
                                                                            "end_token": 1072,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "type",
                                                                                    "start_token": 1069,
                                                                                    "end_token": 1069,
                                                                                    "children": []
                                                                                },
                                                                                {
                                                                                    "type": "argument_list",
                                                                                    "label": "(updated)",
                                                                                    "start_token": 1070,
                                                                                    "end_token": 1072,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "label": "updated",
                                                                                            "start_token": 1071,
                                                                                            "end_token": 1071,
                                                                                            "children": []
                                                                                        }
                                                                                    ]
                                                                                }
                                                                            ]
                                                                        }
                                                                    ]
                                                                },
                                                                {
                                                                    "type": "block",
                                                                    "label": "raise TypeError(\n                    f\"Can not update credentials with ID {updated.id} \"\n                    f\"from type {type(current)} \"\n                    f\"to type {type(updated)}\"\n                )",
                                                                    "start_token": 1075,
                                                                    "end_token": 1088,
                                                                    "children": [
                                                                        {
                                                                            "type": "raise_statement",
                                                                            "label": "raise TypeError(\n                    f\"Can not update credentials with ID {updated.id} \"\n                    f\"from type {type(current)} \"\n                    f\"to type {type(updated)}\"\n                )",
                                                                            "start_token": 1075,
                                                                            "end_token": 1088,
                                                                            "children": [
                                                                                {
                                                                                    "type": "call",
                                                                                    "label": "TypeError(\n                    f\"Can not update credentials with ID {updated.id} \"\n                    f\"from type {type(current)} \"\n                    f\"to type {type(updated)}\"\n                )",
                                                                                    "start_token": 1076,
                                                                                    "end_token": 1088,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "label": "TypeError",
                                                                                            "start_token": 1076,
                                                                                            "end_token": 1076,
                                                                                            "children": []
                                                                                        },
                                                                                        {
                                                                                            "type": "argument_list",
                                                                                            "label": "(\n                    f\"Can not update credentials with ID {updated.id} \"\n                    f\"from type {type(current)} \"\n                    f\"to type {type(updated)}\"\n                )",
                                                                                            "start_token": 1077,
                                                                                            "end_token": 1088,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "concatenated_string",
                                                                                                    "label": "f\"Can not update credentials with ID {updated.id} \"\n                    f\"from type {type(current)} \"\n                    f\"to type {type(updated)}\"",
                                                                                                    "start_token": 1079,
                                                                                                    "end_token": 1086,
                                                                                                    "children": [
                                                                                                        {
                                                                                                            "type": "string",
                                                                                                            "label": "f\"Can not update credentials with ID {updated.id} \"",
                                                                                                            "start_token": 1079,
                                                                                                            "end_token": 1080,
                                                                                                            "children": [
                                                                                                                {
                                                                                                                    "type": "string_start",
                                                                                                                    "label": "f\"",
                                                                                                                    "start_token": 1079,
                                                                                                                    "end_token": 1080,
                                                                                                                    "children": []
                                                                                                                },
                                                                                                                {
                                                                                                                    "type": "string_content",
                                                                                                                    "label": "Can not update credentials with ID ",
                                                                                                                    "start_token": 1080,
                                                                                                                    "end_token": 1080,
                                                                                                                    "children": []
                                                                                                                },
                                                                                                                {
                                                                                                                    "type": "interpolation",
                                                                                                                    "label": "{updated.id}",
                                                                                                                    "start_token": 1080,
                                                                                                                    "end_token": 1080,
                                                                                                                    "children": [
                                                                                                                        {
                                                                                                                            "type": "attribute",
                                                                                                                            "label": "updated.id",
                                                                                                                            "start_token": 1080,
                                                                                                                            "end_token": 1080,
                                                                                                                            "children": [
                                                                                                                                {
                                                                                                                                    "type": "identifier",
                                                                                                                                    "label": "updated",
                                                                                                                                    "start_token": 1080,
                                                                                                                                    "end_token": 1080,
                                                                                                                                    "children": []
                                                                                                                                },
                                                                                                                                {
                                                                                                                                    "type": "identifier",
                                                                                                                                    "label": "id",
                                                                                                                                    "start_token": 1080,
                                                                                                                                    "end_token": 1080,
                                                                                                                                    "children": []
                                                                                                                                }
                                                                                                                            ]
                                                                                                                        }
                                                                                                                    ]
                                                                                                                },
                                                                                                                {
                                                                                                                    "type": "string_content",
                                                                                                                    "label": " ",
                                                                                                                    "start_token": 1080,
                                                                                                                    "end_token": 1080,
                                                                                                                    "children": []
                                                                                                                },
                                                                                                                {
                                                                                                                    "type": "string_end",
                                                                                                                    "label": "\"",
                                                                                                                    "start_token": 1080,
                                                                                                                    "end_token": 1080,
                                                                                                                    "children": []
                                                                                                                }
                                                                                                            ]
                                                                                                        },
                                                                                                        {
                                                                                                            "type": "string",
                                                                                                            "label": "f\"from type {type(current)} \"",
                                                                                                            "start_token": 1082,
                                                                                                            "end_token": 1083,
                                                                                                            "children": [
                                                                                                                {
                                                                                                                    "type": "string_start",
                                                                                                                    "label": "f\"",
                                                                                                                    "start_token": 1082,
                                                                                                                    "end_token": 1083,
                                                                                                                    "children": []
                                                                                                                },
                                                                                                                {
                                                                                                                    "type": "string_content",
                                                                                                                    "label": "from type ",
                                                                                                                    "start_token": 1083,
                                                                                                                    "end_token": 1083,
                                                                                                                    "children": []
                                                                                                                },
                                                                                                                {
                                                                                                                    "type": "interpolation",
                                                                                                                    "label": "{type(current)}",
                                                                                                                    "start_token": 1083,
                                                                                                                    "end_token": 1083,
                                                                                                                    "children": [
                                                                                                                        {
                                                                                                                            "type": "call",
                                                                                                                            "label": "type(current)",
                                                                                                                            "start_token": 1083,
                                                                                                                            "end_token": 1083,
                                                                                                                            "children": [
                                                                                                                                {
                                                                                                                                    "type": "identifier",
                                                                                                                                    "label": "type",
                                                                                                                                    "start_token": 1083,
                                                                                                                                    "end_token": 1083,
                                                                                                                                    "children": []
                                                                                                                                },
                                                                                                                                {
                                                                                                                                    "type": "argument_list",
                                                                                                                                    "label": "(current)",
                                                                                                                                    "start_token": 1083,
                                                                                                                                    "end_token": 1083,
                                                                                                                                    "children": [
                                                                                                                                        {
                                                                                                                                            "type": "identifier",
                                                                                                                                            "label": "current",
                                                                                                                                            "start_token": 1083,
                                                                                                                                            "end_token": 1083,
                                                                                                                                            "children": []
                                                                                                                                        }
                                                                                                                                    ]
                                                                                                                                }
                                                                                                                            ]
                                                                                                                        }
                                                                                                                    ]
                                                                                                                },
                                                                                                                {
                                                                                                                    "type": "string_content",
                                                                                                                    "label": " ",
                                                                                                                    "start_token": 1083,
                                                                                                                    "end_token": 1083,
                                                                                                                    "children": []
                                                                                                                },
                                                                                                                {
                                                                                                                    "type": "string_end",
                                                                                                                    "label": "\"",
                                                                                                                    "start_token": 1083,
                                                                                                                    "end_token": 1083,
                                                                                                                    "children": []
                                                                                                                }
                                                                                                            ]
                                                                                                        },
                                                                                                        {
                                                                                                            "type": "string",
                                                                                                            "label": "f\"to type {type(updated)}\"",
                                                                                                            "start_token": 1085,
                                                                                                            "end_token": 1086,
                                                                                                            "children": [
                                                                                                                {
                                                                                                                    "type": "string_start",
                                                                                                                    "label": "f\"",
                                                                                                                    "start_token": 1085,
                                                                                                                    "end_token": 1086,
                                                                                                                    "children": []
                                                                                                                },
                                                                                                                {
                                                                                                                    "type": "string_content",
                                                                                                                    "label": "to type ",
                                                                                                                    "start_token": 1086,
                                                                                                                    "end_token": 1086,
                                                                                                                    "children": []
                                                                                                                },
                                                                                                                {
                                                                                                                    "type": "interpolation",
                                                                                                                    "label": "{type(updated)}",
                                                                                                                    "start_token": 1086,
                                                                                                                    "end_token": 1086,
                                                                                                                    "children": [
                                                                                                                        {
                                                                                                                            "type": "call",
                                                                                                                            "label": "type(updated)",
                                                                                                                            "start_token": 1086,
                                                                                                                            "end_token": 1086,
                                                                                                                            "children": [
                                                                                                                                {
                                                                                                                                    "type": "identifier",
                                                                                                                                    "label": "type",
                                                                                                                                    "start_token": 1086,
                                                                                                                                    "end_token": 1086,
                                                                                                                                    "children": []
                                                                                                                                },
                                                                                                                                {
                                                                                                                                    "type": "argument_list",
                                                                                                                                    "label": "(updated)",
                                                                                                                                    "start_token": 1086,
                                                                                                                                    "end_token": 1086,
                                                                                                                                    "children": [
                                                                                                                                        {
                                                                                                                                            "type": "identifier",
                                                                                                                                            "label": "updated",
                                                                                                                                            "start_token": 1086,
                                                                                                                                            "end_token": 1086,
                                                                                                                                            "children": []
                                                                                                                                        }
                                                                                                                                    ]
                                                                                                                                }
                                                                                                                            ]
                                                                                                                        }
                                                                                                                    ]
                                                                                                                },
                                                                                                                {
                                                                                                                    "type": "string_end",
                                                                                                                    "label": "\"",
                                                                                                                    "start_token": 1086,
                                                                                                                    "end_token": 1086,
                                                                                                                    "children": []
                                                                                                                }
                                                                                                            ]
                                                                                                        }
                                                                                                    ]
                                                                                                }
                                                                                            ]
                                                                                        }
                                                                                    ]
                                                                                }
                                                                            ]
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        },
                                                        {
                                                            "type": "comment",
                                                            "label": "# Ensure no scopes are removed when updating credentials",
                                                            "start_token": 1091,
                                                            "end_token": 1099,
                                                            "children": []
                                                        },
                                                        {
                                                            "type": "if_statement",
                                                            "label": "if (\n                isinstance(updated, OAuth2Credentials)\n                and isinstance(current, OAuth2Credentials)\n                and not set(updated.scopes).issuperset(current.scopes)\n            ):\n                raise ValueError(\n                    f\"Can not update credentials with ID {updated.id} \"\n                    f\"and scopes {current.scopes} \"\n                    f\"to more restrictive set of scopes {updated.scopes}\"\n                )",
                                                            "start_token": 1101,
                                                            "end_token": 1151,
                                                            "children": [
                                                                {
                                                                    "type": "parenthesized_expression",
                                                                    "label": "(\n                isinstance(updated, OAuth2Credentials)\n                and isinstance(current, OAuth2Credentials)\n                and not set(updated.scopes).issuperset(current.scopes)\n            )",
                                                                    "start_token": 1102,
                                                                    "end_token": 1135,
                                                                    "children": [
                                                                        {
                                                                            "type": "boolean_operator",
                                                                            "label": "isinstance(updated, OAuth2Credentials)\n                and isinstance(current, OAuth2Credentials)\n                and not set(updated.scopes).issuperset(current.scopes)",
                                                                            "start_token": 1104,
                                                                            "end_token": 1133,
                                                                            "children": [
                                                                                {
                                                                                    "type": "boolean_operator",
                                                                                    "label": "isinstance(updated, OAuth2Credentials)\n                and isinstance(current, OAuth2Credentials)",
                                                                                    "start_token": 1104,
                                                                                    "end_token": 1117,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "call",
                                                                                            "label": "isinstance(updated, OAuth2Credentials)",
                                                                                            "start_token": 1104,
                                                                                            "end_token": 1109,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "label": "isinstance",
                                                                                                    "start_token": 1104,
                                                                                                    "end_token": 1104,
                                                                                                    "children": []
                                                                                                },
                                                                                                {
                                                                                                    "type": "argument_list",
                                                                                                    "label": "(updated, OAuth2Credentials)",
                                                                                                    "start_token": 1105,
                                                                                                    "end_token": 1109,
                                                                                                    "children": [
                                                                                                        {
                                                                                                            "type": "identifier",
                                                                                                            "label": "updated",
                                                                                                            "start_token": 1106,
                                                                                                            "end_token": 1106,
                                                                                                            "children": []
                                                                                                        },
                                                                                                        {
                                                                                                            "type": "identifier",
                                                                                                            "label": "OAuth2Credentials",
                                                                                                            "start_token": 1108,
                                                                                                            "end_token": 1108,
                                                                                                            "children": []
                                                                                                        }
                                                                                                    ]
                                                                                                }
                                                                                            ]
                                                                                        },
                                                                                        {
                                                                                            "type": "call",
                                                                                            "label": "isinstance(current, OAuth2Credentials)",
                                                                                            "start_token": 1112,
                                                                                            "end_token": 1117,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "label": "isinstance",
                                                                                                    "start_token": 1112,
                                                                                                    "end_token": 1112,
                                                                                                    "children": []
                                                                                                },
                                                                                                {
                                                                                                    "type": "argument_list",
                                                                                                    "label": "(current, OAuth2Credentials)",
                                                                                                    "start_token": 1113,
                                                                                                    "end_token": 1117,
                                                                                                    "children": [
                                                                                                        {
                                                                                                            "type": "identifier",
                                                                                                            "label": "current",
                                                                                                            "start_token": 1114,
                                                                                                            "end_token": 1114,
                                                                                                            "children": []
                                                                                                        },
                                                                                                        {
                                                                                                            "type": "identifier",
                                                                                                            "label": "OAuth2Credentials",
                                                                                                            "start_token": 1116,
                                                                                                            "end_token": 1116,
                                                                                                            "children": []
                                                                                                        }
                                                                                                    ]
                                                                                                }
                                                                                            ]
                                                                                        }
                                                                                    ]
                                                                                },
                                                                                {
                                                                                    "type": "not_operator",
                                                                                    "label": "not set(updated.scopes).issuperset(current.scopes)",
                                                                                    "start_token": 1120,
                                                                                    "end_token": 1133,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "call",
                                                                                            "label": "set(updated.scopes).issuperset(current.scopes)",
                                                                                            "start_token": 1121,
                                                                                            "end_token": 1133,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "attribute",
                                                                                                    "label": "set(updated.scopes).issuperset",
                                                                                                    "start_token": 1121,
                                                                                                    "end_token": 1128,
                                                                                                    "children": [
                                                                                                        {
                                                                                                            "type": "call",
                                                                                                            "label": "set(updated.scopes)",
                                                                                                            "start_token": 1121,
                                                                                                            "end_token": 1126,
                                                                                                            "children": [
                                                                                                                {
                                                                                                                    "type": "identifier",
                                                                                                                    "label": "set",
                                                                                                                    "start_token": 1121,
                                                                                                                    "end_token": 1121,
                                                                                                                    "children": []
                                                                                                                },
                                                                                                                {
                                                                                                                    "type": "argument_list",
                                                                                                                    "label": "(updated.scopes)",
                                                                                                                    "start_token": 1122,
                                                                                                                    "end_token": 1126,
                                                                                                                    "children": [
                                                                                                                        {
                                                                                                                            "type": "attribute",
                                                                                                                            "label": "updated.scopes",
                                                                                                                            "start_token": 1123,
                                                                                                                            "end_token": 1125,
                                                                                                                            "children": [
                                                                                                                                {
                                                                                                                                    "type": "identifier",
                                                                                                                                    "label": "updated",
                                                                                                                                    "start_token": 1123,
                                                                                                                                    "end_token": 1123,
                                                                                                                                    "children": []
                                                                                                                                },
                                                                                                                                {
                                                                                                                                    "type": "identifier",
                                                                                                                                    "label": "scopes",
                                                                                                                                    "start_token": 1125,
                                                                                                                                    "end_token": 1125,
                                                                                                                                    "children": []
                                                                                                                                }
                                                                                                                            ]
                                                                                                                        }
                                                                                                                    ]
                                                                                                                }
                                                                                                            ]
                                                                                                        },
                                                                                                        {
                                                                                                            "type": "identifier",
                                                                                                            "label": "issuperset",
                                                                                                            "start_token": 1128,
                                                                                                            "end_token": 1128,
                                                                                                            "children": []
                                                                                                        }
                                                                                                    ]
                                                                                                },
                                                                                                {
                                                                                                    "type": "argument_list",
                                                                                                    "label": "(current.scopes)",
                                                                                                    "start_token": 1129,
                                                                                                    "end_token": 1133,
                                                                                                    "children": [
                                                                                                        {
                                                                                                            "type": "attribute",
                                                                                                            "label": "current.scopes",
                                                                                                            "start_token": 1130,
                                                                                                            "end_token": 1132,
                                                                                                            "children": [
                                                                                                                {
                                                                                                                    "type": "identifier",
                                                                                                                    "label": "current",
                                                                                                                    "start_token": 1130,
                                                                                                                    "end_token": 1130,
                                                                                                                    "children": []
                                                                                                                },
                                                                                                                {
                                                                                                                    "type": "identifier",
                                                                                                                    "label": "scopes",
                                                                                                                    "start_token": 1132,
                                                                                                                    "end_token": 1132,
                                                                                                                    "children": []
                                                                                                                }
                                                                                                            ]
                                                                                                        }
                                                                                                    ]
                                                                                                }
                                                                                            ]
                                                                                        }
                                                                                    ]
                                                                                }
                                                                            ]
                                                                        }
                                                                    ]
                                                                },
                                                                {
                                                                    "type": "block",
                                                                    "label": "raise ValueError(\n                    f\"Can not update credentials with ID {updated.id} \"\n                    f\"and scopes {current.scopes} \"\n                    f\"to more restrictive set of scopes {updated.scopes}\"\n                )",
                                                                    "start_token": 1138,
                                                                    "end_token": 1151,
                                                                    "children": [
                                                                        {
                                                                            "type": "raise_statement",
                                                                            "label": "raise ValueError(\n                    f\"Can not update credentials with ID {updated.id} \"\n                    f\"and scopes {current.scopes} \"\n                    f\"to more restrictive set of scopes {updated.scopes}\"\n                )",
                                                                            "start_token": 1138,
                                                                            "end_token": 1151,
                                                                            "children": [
                                                                                {
                                                                                    "type": "call",
                                                                                    "label": "ValueError(\n                    f\"Can not update credentials with ID {updated.id} \"\n                    f\"and scopes {current.scopes} \"\n                    f\"to more restrictive set of scopes {updated.scopes}\"\n                )",
                                                                                    "start_token": 1139,
                                                                                    "end_token": 1151,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "label": "ValueError",
                                                                                            "start_token": 1139,
                                                                                            "end_token": 1139,
                                                                                            "children": []
                                                                                        },
                                                                                        {
                                                                                            "type": "argument_list",
                                                                                            "label": "(\n                    f\"Can not update credentials with ID {updated.id} \"\n                    f\"and scopes {current.scopes} \"\n                    f\"to more restrictive set of scopes {updated.scopes}\"\n                )",
                                                                                            "start_token": 1140,
                                                                                            "end_token": 1151,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "concatenated_string",
                                                                                                    "label": "f\"Can not update credentials with ID {updated.id} \"\n                    f\"and scopes {current.scopes} \"\n                    f\"to more restrictive set of scopes {updated.scopes}\"",
                                                                                                    "start_token": 1142,
                                                                                                    "end_token": 1149,
                                                                                                    "children": [
                                                                                                        {
                                                                                                            "type": "string",
                                                                                                            "label": "f\"Can not update credentials with ID {updated.id} \"",
                                                                                                            "start_token": 1142,
                                                                                                            "end_token": 1143,
                                                                                                            "children": [
                                                                                                                {
                                                                                                                    "type": "string_start",
                                                                                                                    "label": "f\"",
                                                                                                                    "start_token": 1142,
                                                                                                                    "end_token": 1143,
                                                                                                                    "children": []
                                                                                                                },
                                                                                                                {
                                                                                                                    "type": "string_content",
                                                                                                                    "label": "Can not update credentials with ID ",
                                                                                                                    "start_token": 1143,
                                                                                                                    "end_token": 1143,
                                                                                                                    "children": []
                                                                                                                },
                                                                                                                {
                                                                                                                    "type": "interpolation",
                                                                                                                    "label": "{updated.id}",
                                                                                                                    "start_token": 1143,
                                                                                                                    "end_token": 1143,
                                                                                                                    "children": [
                                                                                                                        {
                                                                                                                            "type": "attribute",
                                                                                                                            "label": "updated.id",
                                                                                                                            "start_token": 1143,
                                                                                                                            "end_token": 1143,
                                                                                                                            "children": [
                                                                                                                                {
                                                                                                                                    "type": "identifier",
                                                                                                                                    "label": "updated",
                                                                                                                                    "start_token": 1143,
                                                                                                                                    "end_token": 1143,
                                                                                                                                    "children": []
                                                                                                                                },
                                                                                                                                {
                                                                                                                                    "type": "identifier",
                                                                                                                                    "label": "id",
                                                                                                                                    "start_token": 1143,
                                                                                                                                    "end_token": 1143,
                                                                                                                                    "children": []
                                                                                                                                }
                                                                                                                            ]
                                                                                                                        }
                                                                                                                    ]
                                                                                                                },
                                                                                                                {
                                                                                                                    "type": "string_content",
                                                                                                                    "label": " ",
                                                                                                                    "start_token": 1143,
                                                                                                                    "end_token": 1143,
                                                                                                                    "children": []
                                                                                                                },
                                                                                                                {
                                                                                                                    "type": "string_end",
                                                                                                                    "label": "\"",
                                                                                                                    "start_token": 1143,
                                                                                                                    "end_token": 1143,
                                                                                                                    "children": []
                                                                                                                }
                                                                                                            ]
                                                                                                        },
                                                                                                        {
                                                                                                            "type": "string",
                                                                                                            "label": "f\"and scopes {current.scopes} \"",
                                                                                                            "start_token": 1145,
                                                                                                            "end_token": 1146,
                                                                                                            "children": [
                                                                                                                {
                                                                                                                    "type": "string_start",
                                                                                                                    "label": "f\"",
                                                                                                                    "start_token": 1145,
                                                                                                                    "end_token": 1146,
                                                                                                                    "children": []
                                                                                                                },
                                                                                                                {
                                                                                                                    "type": "string_content",
                                                                                                                    "label": "and scopes ",
                                                                                                                    "start_token": 1146,
                                                                                                                    "end_token": 1146,
                                                                                                                    "children": []
                                                                                                                },
                                                                                                                {
                                                                                                                    "type": "interpolation",
                                                                                                                    "label": "{current.scopes}",
                                                                                                                    "start_token": 1146,
                                                                                                                    "end_token": 1146,
                                                                                                                    "children": [
                                                                                                                        {
                                                                                                                            "type": "attribute",
                                                                                                                            "label": "current.scopes",
                                                                                                                            "start_token": 1146,
                                                                                                                            "end_token": 1146,
                                                                                                                            "children": [
                                                                                                                                {
                                                                                                                                    "type": "identifier",
                                                                                                                                    "label": "current",
                                                                                                                                    "start_token": 1146,
                                                                                                                                    "end_token": 1146,
                                                                                                                                    "children": []
                                                                                                                                },
                                                                                                                                {
                                                                                                                                    "type": "identifier",
                                                                                                                                    "label": "scopes",
                                                                                                                                    "start_token": 1146,
                                                                                                                                    "end_token": 1146,
                                                                                                                                    "children": []
                                                                                                                                }
                                                                                                                            ]
                                                                                                                        }
                                                                                                                    ]
                                                                                                                },
                                                                                                                {
                                                                                                                    "type": "string_content",
                                                                                                                    "label": " ",
                                                                                                                    "start_token": 1146,
                                                                                                                    "end_token": 1146,
                                                                                                                    "children": []
                                                                                                                },
                                                                                                                {
                                                                                                                    "type": "string_end",
                                                                                                                    "label": "\"",
                                                                                                                    "start_token": 1146,
                                                                                                                    "end_token": 1146,
                                                                                                                    "children": []
                                                                                                                }
                                                                                                            ]
                                                                                                        },
                                                                                                        {
                                                                                                            "type": "string",
                                                                                                            "label": "f\"to more restrictive set of scopes {updated.scopes}\"",
                                                                                                            "start_token": 1148,
                                                                                                            "end_token": 1149,
                                                                                                            "children": [
                                                                                                                {
                                                                                                                    "type": "string_start",
                                                                                                                    "label": "f\"",
                                                                                                                    "start_token": 1148,
                                                                                                                    "end_token": 1149,
                                                                                                                    "children": []
                                                                                                                },
                                                                                                                {
                                                                                                                    "type": "string_content",
                                                                                                                    "label": "to more restrictive set of scopes ",
                                                                                                                    "start_token": 1149,
                                                                                                                    "end_token": 1149,
                                                                                                                    "children": []
                                                                                                                },
                                                                                                                {
                                                                                                                    "type": "interpolation",
                                                                                                                    "label": "{updated.scopes}",
                                                                                                                    "start_token": 1149,
                                                                                                                    "end_token": 1149,
                                                                                                                    "children": [
                                                                                                                        {
                                                                                                                            "type": "attribute",
                                                                                                                            "label": "updated.scopes",
                                                                                                                            "start_token": 1149,
                                                                                                                            "end_token": 1149,
                                                                                                                            "children": [
                                                                                                                                {
                                                                                                                                    "type": "identifier",
                                                                                                                                    "label": "updated",
                                                                                                                                    "start_token": 1149,
                                                                                                                                    "end_token": 1149,
                                                                                                                                    "children": []
                                                                                                                                },
                                                                                                                                {
                                                                                                                                    "type": "identifier",
                                                                                                                                    "label": "scopes",
                                                                                                                                    "start_token": 1149,
                                                                                                                                    "end_token": 1149,
                                                                                                                                    "children": []
                                                                                                                                }
                                                                                                                            ]
                                                                                                                        }
                                                                                                                    ]
                                                                                                                },
                                                                                                                {
                                                                                                                    "type": "string_end",
                                                                                                                    "label": "\"",
                                                                                                                    "start_token": 1149,
                                                                                                                    "end_token": 1149,
                                                                                                                    "children": []
                                                                                                                }
                                                                                                            ]
                                                                                                        }
                                                                                                    ]
                                                                                                }
                                                                                            ]
                                                                                        }
                                                                                    ]
                                                                                }
                                                                            ]
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        },
                                                        {
                                                            "type": "comment",
                                                            "label": "# Update the credentials",
                                                            "start_token": 1154,
                                                            "end_token": 1157,
                                                            "children": []
                                                        },
                                                        {
                                                            "type": "expression_statement",
                                                            "label": "updated_credentials_list = [\n                updated if c.id == updated.id else c\n                for c in self.get_all_creds(user_id)\n            ]",
                                                            "start_token": 1159,
                                                            "end_token": 1186,
                                                            "children": [
                                                                {
                                                                    "type": "assignment",
                                                                    "label": "updated_credentials_list = [\n                updated if c.id == updated.id else c\n                for c in self.get_all_creds(user_id)\n            ]",
                                                                    "start_token": 1159,
                                                                    "end_token": 1186,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "updated_credentials_list",
                                                                            "start_token": 1159,
                                                                            "end_token": 1159,
                                                                            "children": []
                                                                        },
                                                                        {
                                                                            "type": "list_comprehension",
                                                                            "label": "[\n                updated if c.id == updated.id else c\n                for c in self.get_all_creds(user_id)\n            ]",
                                                                            "start_token": 1161,
                                                                            "end_token": 1186,
                                                                            "children": [
                                                                                {
                                                                                    "type": "conditional_expression",
                                                                                    "label": "updated if c.id == updated.id else c",
                                                                                    "start_token": 1163,
                                                                                    "end_token": 1174,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "label": "updated",
                                                                                            "start_token": 1163,
                                                                                            "end_token": 1163,
                                                                                            "children": []
                                                                                        },
                                                                                        {
                                                                                            "type": "comparison_operator",
                                                                                            "label": "c.id == updated.id",
                                                                                            "start_token": 1165,
                                                                                            "end_token": 1172,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "attribute",
                                                                                                    "label": "c.id",
                                                                                                    "start_token": 1165,
                                                                                                    "end_token": 1167,
                                                                                                    "children": [
                                                                                                        {
                                                                                                            "type": "identifier",
                                                                                                            "label": "c",
                                                                                                            "start_token": 1165,
                                                                                                            "end_token": 1165,
                                                                                                            "children": []
                                                                                                        },
                                                                                                        {
                                                                                                            "type": "identifier",
                                                                                                            "label": "id",
                                                                                                            "start_token": 1167,
                                                                                                            "end_token": 1167,
                                                                                                            "children": []
                                                                                                        }
                                                                                                    ]
                                                                                                },
                                                                                                {
                                                                                                    "type": "attribute",
                                                                                                    "label": "updated.id",
                                                                                                    "start_token": 1170,
                                                                                                    "end_token": 1172,
                                                                                                    "children": [
                                                                                                        {
                                                                                                            "type": "identifier",
                                                                                                            "label": "updated",
                                                                                                            "start_token": 1170,
                                                                                                            "end_token": 1170,
                                                                                                            "children": []
                                                                                                        },
                                                                                                        {
                                                                                                            "type": "identifier",
                                                                                                            "label": "id",
                                                                                                            "start_token": 1172,
                                                                                                            "end_token": 1172,
                                                                                                            "children": []
                                                                                                        }
                                                                                                    ]
                                                                                                }
                                                                                            ]
                                                                                        },
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "label": "c",
                                                                                            "start_token": 1174,
                                                                                            "end_token": 1174,
                                                                                            "children": []
                                                                                        }
                                                                                    ]
                                                                                },
                                                                                {
                                                                                    "type": "for_in_clause",
                                                                                    "label": "for c in self.get_all_creds(user_id)",
                                                                                    "start_token": 1176,
                                                                                    "end_token": 1184,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "label": "c",
                                                                                            "start_token": 1177,
                                                                                            "end_token": 1177,
                                                                                            "children": []
                                                                                        },
                                                                                        {
                                                                                            "type": "call",
                                                                                            "label": "self.get_all_creds(user_id)",
                                                                                            "start_token": 1179,
                                                                                            "end_token": 1184,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "attribute",
                                                                                                    "label": "self.get_all_creds",
                                                                                                    "start_token": 1179,
                                                                                                    "end_token": 1181,
                                                                                                    "children": [
                                                                                                        {
                                                                                                            "type": "identifier",
                                                                                                            "label": "self",
                                                                                                            "start_token": 1179,
                                                                                                            "end_token": 1179,
                                                                                                            "children": []
                                                                                                        },
                                                                                                        {
                                                                                                            "type": "identifier",
                                                                                                            "label": "get_all_creds",
                                                                                                            "start_token": 1181,
                                                                                                            "end_token": 1181,
                                                                                                            "children": []
                                                                                                        }
                                                                                                    ]
                                                                                                },
                                                                                                {
                                                                                                    "type": "argument_list",
                                                                                                    "label": "(user_id)",
                                                                                                    "start_token": 1182,
                                                                                                    "end_token": 1184,
                                                                                                    "children": [
                                                                                                        {
                                                                                                            "type": "identifier",
                                                                                                            "label": "user_id",
                                                                                                            "start_token": 1183,
                                                                                                            "end_token": 1183,
                                                                                                            "children": []
                                                                                                        }
                                                                                                    ]
                                                                                                }
                                                                                            ]
                                                                                        }
                                                                                    ]
                                                                                }
                                                                            ]
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        },
                                                        {
                                                            "type": "expression_statement",
                                                            "label": "self._set_user_integration_creds(user_id, updated_credentials_list)",
                                                            "start_token": 1188,
                                                            "end_token": 1195,
                                                            "children": [
                                                                {
                                                                    "type": "call",
                                                                    "label": "self._set_user_integration_creds(user_id, updated_credentials_list)",
                                                                    "start_token": 1188,
                                                                    "end_token": 1195,
                                                                    "children": [
                                                                        {
                                                                            "type": "attribute",
                                                                            "label": "self._set_user_integration_creds",
                                                                            "start_token": 1188,
                                                                            "end_token": 1190,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "self",
                                                                                    "start_token": 1188,
                                                                                    "end_token": 1188,
                                                                                    "children": []
                                                                                },
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "_set_user_integration_creds",
                                                                                    "start_token": 1190,
                                                                                    "end_token": 1190,
                                                                                    "children": []
                                                                                }
                                                                            ]
                                                                        },
                                                                        {
                                                                            "type": "argument_list",
                                                                            "label": "(user_id, updated_credentials_list)",
                                                                            "start_token": 1191,
                                                                            "end_token": 1195,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "user_id",
                                                                                    "start_token": 1192,
                                                                                    "end_token": 1192,
                                                                                    "children": []
                                                                                },
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "updated_credentials_list",
                                                                                    "start_token": 1194,
                                                                                    "end_token": 1194,
                                                                                    "children": []
                                                                                }
                                                                            ]
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                }
                                            ]
                                        }
                                    ]
                                }
                            ]
                        },
                        {
                            "type": "function_definition",
                            "label": "def delete_creds_by_id(self, user_id: str, credentials_id: str) -> None:\n        with self.locked_user_integrations(user_id):\n            filtered_credentials = [\n                c for c in self.get_all_creds(user_id) if c.id != credentials_id\n            ]\n            self._set_user_integration_creds(user_id, filtered_credentials)",
                            "start_token": 1198,
                            "end_token": 1256,
                            "children": [
                                {
                                    "type": "identifier",
                                    "label": "delete_creds_by_id",
                                    "start_token": 1199,
                                    "end_token": 1199,
                                    "children": []
                                },
                                {
                                    "type": "parameters",
                                    "label": "(self, user_id: str, credentials_id: str)",
                                    "start_token": 1200,
                                    "end_token": 1210,
                                    "children": [
                                        {
                                            "type": "identifier",
                                            "label": "self",
                                            "start_token": 1201,
                                            "end_token": 1201,
                                            "children": []
                                        },
                                        {
                                            "type": "typed_parameter",
                                            "label": "user_id: str",
                                            "start_token": 1203,
                                            "end_token": 1205,
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "label": "user_id",
                                                    "start_token": 1203,
                                                    "end_token": 1203,
                                                    "children": []
                                                },
                                                {
                                                    "type": "type",
                                                    "label": "str",
                                                    "start_token": 1205,
                                                    "end_token": 1205,
                                                    "children": [
                                                        {
                                                            "type": "identifier",
                                                            "label": "str",
                                                            "start_token": 1205,
                                                            "end_token": 1205,
                                                            "children": []
                                                        }
                                                    ]
                                                }
                                            ]
                                        },
                                        {
                                            "type": "typed_parameter",
                                            "label": "credentials_id: str",
                                            "start_token": 1207,
                                            "end_token": 1209,
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "label": "credentials_id",
                                                    "start_token": 1207,
                                                    "end_token": 1207,
                                                    "children": []
                                                },
                                                {
                                                    "type": "type",
                                                    "label": "str",
                                                    "start_token": 1209,
                                                    "end_token": 1209,
                                                    "children": [
                                                        {
                                                            "type": "identifier",
                                                            "label": "str",
                                                            "start_token": 1209,
                                                            "end_token": 1209,
                                                            "children": []
                                                        }
                                                    ]
                                                }
                                            ]
                                        }
                                    ]
                                },
                                {
                                    "type": "type",
                                    "label": "None",
                                    "start_token": 1213,
                                    "end_token": 1213,
                                    "children": [
                                        {
                                            "type": "none",
                                            "label": "None",
                                            "start_token": 1213,
                                            "end_token": 1213,
                                            "children": []
                                        }
                                    ]
                                },
                                {
                                    "type": "block",
                                    "label": "with self.locked_user_integrations(user_id):\n            filtered_credentials = [\n                c for c in self.get_all_creds(user_id) if c.id != credentials_id\n            ]\n            self._set_user_integration_creds(user_id, filtered_credentials)",
                                    "start_token": 1216,
                                    "end_token": 1256,
                                    "children": [
                                        {
                                            "type": "with_statement",
                                            "label": "with self.locked_user_integrations(user_id):\n            filtered_credentials = [\n                c for c in self.get_all_creds(user_id) if c.id != credentials_id\n            ]\n            self._set_user_integration_creds(user_id, filtered_credentials)",
                                            "start_token": 1216,
                                            "end_token": 1256,
                                            "children": [
                                                {
                                                    "type": "with_clause",
                                                    "label": "self.locked_user_integrations(user_id)",
                                                    "start_token": 1217,
                                                    "end_token": 1222,
                                                    "children": [
                                                        {
                                                            "type": "with_item",
                                                            "label": "self.locked_user_integrations(user_id)",
                                                            "start_token": 1217,
                                                            "end_token": 1222,
                                                            "children": [
                                                                {
                                                                    "type": "call",
                                                                    "label": "self.locked_user_integrations(user_id)",
                                                                    "start_token": 1217,
                                                                    "end_token": 1222,
                                                                    "children": [
                                                                        {
                                                                            "type": "attribute",
                                                                            "label": "self.locked_user_integrations",
                                                                            "start_token": 1217,
                                                                            "end_token": 1219,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "self",
                                                                                    "start_token": 1217,
                                                                                    "end_token": 1217,
                                                                                    "children": []
                                                                                },
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "locked_user_integrations",
                                                                                    "start_token": 1219,
                                                                                    "end_token": 1219,
                                                                                    "children": []
                                                                                }
                                                                            ]
                                                                        },
                                                                        {
                                                                            "type": "argument_list",
                                                                            "label": "(user_id)",
                                                                            "start_token": 1220,
                                                                            "end_token": 1222,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "user_id",
                                                                                    "start_token": 1221,
                                                                                    "end_token": 1221,
                                                                                    "children": []
                                                                                }
                                                                            ]
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                },
                                                {
                                                    "type": "block",
                                                    "label": "filtered_credentials = [\n                c for c in self.get_all_creds(user_id) if c.id != credentials_id\n            ]\n            self._set_user_integration_creds(user_id, filtered_credentials)",
                                                    "start_token": 1225,
                                                    "end_token": 1256,
                                                    "children": [
                                                        {
                                                            "type": "expression_statement",
                                                            "label": "filtered_credentials = [\n                c for c in self.get_all_creds(user_id) if c.id != credentials_id\n            ]",
                                                            "start_token": 1225,
                                                            "end_token": 1247,
                                                            "children": [
                                                                {
                                                                    "type": "assignment",
                                                                    "label": "filtered_credentials = [\n                c for c in self.get_all_creds(user_id) if c.id != credentials_id\n            ]",
                                                                    "start_token": 1225,
                                                                    "end_token": 1247,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "filtered_credentials",
                                                                            "start_token": 1225,
                                                                            "end_token": 1225,
                                                                            "children": []
                                                                        },
                                                                        {
                                                                            "type": "list_comprehension",
                                                                            "label": "[\n                c for c in self.get_all_creds(user_id) if c.id != credentials_id\n            ]",
                                                                            "start_token": 1227,
                                                                            "end_token": 1247,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "c",
                                                                                    "start_token": 1229,
                                                                                    "end_token": 1229,
                                                                                    "children": []
                                                                                },
                                                                                {
                                                                                    "type": "for_in_clause",
                                                                                    "label": "for c in self.get_all_creds(user_id)",
                                                                                    "start_token": 1230,
                                                                                    "end_token": 1238,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "label": "c",
                                                                                            "start_token": 1231,
                                                                                            "end_token": 1231,
                                                                                            "children": []
                                                                                        },
                                                                                        {
                                                                                            "type": "call",
                                                                                            "label": "self.get_all_creds(user_id)",
                                                                                            "start_token": 1233,
                                                                                            "end_token": 1238,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "attribute",
                                                                                                    "label": "self.get_all_creds",
                                                                                                    "start_token": 1233,
                                                                                                    "end_token": 1235,
                                                                                                    "children": [
                                                                                                        {
                                                                                                            "type": "identifier",
                                                                                                            "label": "self",
                                                                                                            "start_token": 1233,
                                                                                                            "end_token": 1233,
                                                                                                            "children": []
                                                                                                        },
                                                                                                        {
                                                                                                            "type": "identifier",
                                                                                                            "label": "get_all_creds",
                                                                                                            "start_token": 1235,
                                                                                                            "end_token": 1235,
                                                                                                            "children": []
                                                                                                        }
                                                                                                    ]
                                                                                                },
                                                                                                {
                                                                                                    "type": "argument_list",
                                                                                                    "label": "(user_id)",
                                                                                                    "start_token": 1236,
                                                                                                    "end_token": 1238,
                                                                                                    "children": [
                                                                                                        {
                                                                                                            "type": "identifier",
                                                                                                            "label": "user_id",
                                                                                                            "start_token": 1237,
                                                                                                            "end_token": 1237,
                                                                                                            "children": []
                                                                                                        }
                                                                                                    ]
                                                                                                }
                                                                                            ]
                                                                                        }
                                                                                    ]
                                                                                },
                                                                                {
                                                                                    "type": "if_clause",
                                                                                    "label": "if c.id != credentials_id",
                                                                                    "start_token": 1239,
                                                                                    "end_token": 1245,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "comparison_operator",
                                                                                            "label": "c.id != credentials_id",
                                                                                            "start_token": 1240,
                                                                                            "end_token": 1245,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "attribute",
                                                                                                    "label": "c.id",
                                                                                                    "start_token": 1240,
                                                                                                    "end_token": 1242,
                                                                                                    "children": [
                                                                                                        {
                                                                                                            "type": "identifier",
                                                                                                            "label": "c",
                                                                                                            "start_token": 1240,
                                                                                                            "end_token": 1240,
                                                                                                            "children": []
                                                                                                        },
                                                                                                        {
                                                                                                            "type": "identifier",
                                                                                                            "label": "id",
                                                                                                            "start_token": 1242,
                                                                                                            "end_token": 1242,
                                                                                                            "children": []
                                                                                                        }
                                                                                                    ]
                                                                                                },
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "label": "credentials_id",
                                                                                                    "start_token": 1245,
                                                                                                    "end_token": 1245,
                                                                                                    "children": []
                                                                                                }
                                                                                            ]
                                                                                        }
                                                                                    ]
                                                                                }
                                                                            ]
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        },
                                                        {
                                                            "type": "expression_statement",
                                                            "label": "self._set_user_integration_creds(user_id, filtered_credentials)",
                                                            "start_token": 1249,
                                                            "end_token": 1256,
                                                            "children": [
                                                                {
                                                                    "type": "call",
                                                                    "label": "self._set_user_integration_creds(user_id, filtered_credentials)",
                                                                    "start_token": 1249,
                                                                    "end_token": 1256,
                                                                    "children": [
                                                                        {
                                                                            "type": "attribute",
                                                                            "label": "self._set_user_integration_creds",
                                                                            "start_token": 1249,
                                                                            "end_token": 1251,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "self",
                                                                                    "start_token": 1249,
                                                                                    "end_token": 1249,
                                                                                    "children": []
                                                                                },
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "_set_user_integration_creds",
                                                                                    "start_token": 1251,
                                                                                    "end_token": 1251,
                                                                                    "children": []
                                                                                }
                                                                            ]
                                                                        },
                                                                        {
                                                                            "type": "argument_list",
                                                                            "label": "(user_id, filtered_credentials)",
                                                                            "start_token": 1252,
                                                                            "end_token": 1256,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "user_id",
                                                                                    "start_token": 1253,
                                                                                    "end_token": 1253,
                                                                                    "children": []
                                                                                },
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "filtered_credentials",
                                                                                    "start_token": 1255,
                                                                                    "end_token": 1255,
                                                                                    "children": []
                                                                                }
                                                                            ]
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                }
                                            ]
                                        }
                                    ]
                                }
                            ]
                        },
                        {
                            "type": "function_definition",
                            "label": "def store_state_token(self, user_id: str, provider: str, scopes: list[str]) -> str:\n        token = secrets.token_urlsafe(32)\n        expires_at = datetime.now(timezone.utc) + timedelta(minutes=10)\n\n        state = OAuthState(\n            token=token,\n            provider=provider,\n            expires_at=int(expires_at.timestamp()),\n            scopes=scopes,\n        )\n\n        with self.locked_user_integrations(user_id):\n            user_integrations = self._get_user_integrations(user_id)\n            oauth_states = user_integrations.oauth_states\n            oauth_states.append(state)\n            user_integrations.oauth_states = oauth_states\n\n            self.db_manager.update_user_integrations(\n                user_id=user_id, data=user_integrations\n            )\n\n        return token",
                            "start_token": 1259,
                            "end_token": 1404,
                            "children": [
                                {
                                    "type": "identifier",
                                    "label": "store_state_token",
                                    "start_token": 1260,
                                    "end_token": 1260,
                                    "children": []
                                },
                                {
                                    "type": "parameters",
                                    "label": "(self, user_id: str, provider: str, scopes: list[str])",
                                    "start_token": 1261,
                                    "end_token": 1278,
                                    "children": [
                                        {
                                            "type": "identifier",
                                            "label": "self",
                                            "start_token": 1262,
                                            "end_token": 1262,
                                            "children": []
                                        },
                                        {
                                            "type": "typed_parameter",
                                            "label": "user_id: str",
                                            "start_token": 1264,
                                            "end_token": 1266,
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "label": "user_id",
                                                    "start_token": 1264,
                                                    "end_token": 1264,
                                                    "children": []
                                                },
                                                {
                                                    "type": "type",
                                                    "label": "str",
                                                    "start_token": 1266,
                                                    "end_token": 1266,
                                                    "children": [
                                                        {
                                                            "type": "identifier",
                                                            "label": "str",
                                                            "start_token": 1266,
                                                            "end_token": 1266,
                                                            "children": []
                                                        }
                                                    ]
                                                }
                                            ]
                                        },
                                        {
                                            "type": "typed_parameter",
                                            "label": "provider: str",
                                            "start_token": 1268,
                                            "end_token": 1270,
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "label": "provider",
                                                    "start_token": 1268,
                                                    "end_token": 1268,
                                                    "children": []
                                                },
                                                {
                                                    "type": "type",
                                                    "label": "str",
                                                    "start_token": 1270,
                                                    "end_token": 1270,
                                                    "children": [
                                                        {
                                                            "type": "identifier",
                                                            "label": "str",
                                                            "start_token": 1270,
                                                            "end_token": 1270,
                                                            "children": []
                                                        }
                                                    ]
                                                }
                                            ]
                                        },
                                        {
                                            "type": "typed_parameter",
                                            "label": "scopes: list[str]",
                                            "start_token": 1272,
                                            "end_token": 1277,
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "label": "scopes",
                                                    "start_token": 1272,
                                                    "end_token": 1272,
                                                    "children": []
                                                },
                                                {
                                                    "type": "type",
                                                    "label": "list[str]",
                                                    "start_token": 1274,
                                                    "end_token": 1277,
                                                    "children": [
                                                        {
                                                            "type": "generic_type",
                                                            "label": "list[str]",
                                                            "start_token": 1274,
                                                            "end_token": 1277,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "label": "list",
                                                                    "start_token": 1274,
                                                                    "end_token": 1274,
                                                                    "children": []
                                                                },
                                                                {
                                                                    "type": "type_parameter",
                                                                    "label": "[str]",
                                                                    "start_token": 1275,
                                                                    "end_token": 1277,
                                                                    "children": [
                                                                        {
                                                                            "type": "type",
                                                                            "label": "str",
                                                                            "start_token": 1276,
                                                                            "end_token": 1276,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "str",
                                                                                    "start_token": 1276,
                                                                                    "end_token": 1276,
                                                                                    "children": []
                                                                                }
                                                                            ]
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                }
                                            ]
                                        }
                                    ]
                                },
                                {
                                    "type": "type",
                                    "label": "str",
                                    "start_token": 1281,
                                    "end_token": 1281,
                                    "children": [
                                        {
                                            "type": "identifier",
                                            "label": "str",
                                            "start_token": 1281,
                                            "end_token": 1281,
                                            "children": []
                                        }
                                    ]
                                },
                                {
                                    "type": "block",
                                    "label": "token = secrets.token_urlsafe(32)\n        expires_at = datetime.now(timezone.utc) + timedelta(minutes=10)\n\n        state = OAuthState(\n            token=token,\n            provider=provider,\n            expires_at=int(expires_at.timestamp()),\n            scopes=scopes,\n        )\n\n        with self.locked_user_integrations(user_id):\n            user_integrations = self._get_user_integrations(user_id)\n            oauth_states = user_integrations.oauth_states\n            oauth_states.append(state)\n            user_integrations.oauth_states = oauth_states\n\n            self.db_manager.update_user_integrations(\n                user_id=user_id, data=user_integrations\n            )\n\n        return token",
                                    "start_token": 1284,
                                    "end_token": 1404,
                                    "children": [
                                        {
                                            "type": "expression_statement",
                                            "label": "token = secrets.token_urlsafe(32)",
                                            "start_token": 1284,
                                            "end_token": 1291,
                                            "children": [
                                                {
                                                    "type": "assignment",
                                                    "label": "token = secrets.token_urlsafe(32)",
                                                    "start_token": 1284,
                                                    "end_token": 1291,
                                                    "children": [
                                                        {
                                                            "type": "identifier",
                                                            "label": "token",
                                                            "start_token": 1284,
                                                            "end_token": 1284,
                                                            "children": []
                                                        },
                                                        {
                                                            "type": "call",
                                                            "label": "secrets.token_urlsafe(32)",
                                                            "start_token": 1286,
                                                            "end_token": 1291,
                                                            "children": [
                                                                {
                                                                    "type": "attribute",
                                                                    "label": "secrets.token_urlsafe",
                                                                    "start_token": 1286,
                                                                    "end_token": 1288,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "secrets",
                                                                            "start_token": 1286,
                                                                            "end_token": 1286,
                                                                            "children": []
                                                                        },
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "token_urlsafe",
                                                                            "start_token": 1288,
                                                                            "end_token": 1288,
                                                                            "children": []
                                                                        }
                                                                    ]
                                                                },
                                                                {
                                                                    "type": "argument_list",
                                                                    "label": "(32)",
                                                                    "start_token": 1289,
                                                                    "end_token": 1291,
                                                                    "children": [
                                                                        {
                                                                            "type": "integer",
                                                                            "label": "32",
                                                                            "start_token": 1290,
                                                                            "end_token": 1290,
                                                                            "children": []
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                }
                                            ]
                                        },
                                        {
                                            "type": "expression_statement",
                                            "label": "expires_at = datetime.now(timezone.utc) + timedelta(minutes=10)",
                                            "start_token": 1293,
                                            "end_token": 1309,
                                            "children": [
                                                {
                                                    "type": "assignment",
                                                    "label": "expires_at = datetime.now(timezone.utc) + timedelta(minutes=10)",
                                                    "start_token": 1293,
                                                    "end_token": 1309,
                                                    "children": [
                                                        {
                                                            "type": "identifier",
                                                            "label": "expires_at",
                                                            "start_token": 1293,
                                                            "end_token": 1293,
                                                            "children": []
                                                        },
                                                        {
                                                            "type": "binary_operator",
                                                            "label": "datetime.now(timezone.utc) + timedelta(minutes=10)",
                                                            "start_token": 1295,
                                                            "end_token": 1309,
                                                            "children": [
                                                                {
                                                                    "type": "call",
                                                                    "label": "datetime.now(timezone.utc)",
                                                                    "start_token": 1295,
                                                                    "end_token": 1302,
                                                                    "children": [
                                                                        {
                                                                            "type": "attribute",
                                                                            "label": "datetime.now",
                                                                            "start_token": 1295,
                                                                            "end_token": 1297,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "datetime",
                                                                                    "start_token": 1295,
                                                                                    "end_token": 1295,
                                                                                    "children": []
                                                                                },
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "now",
                                                                                    "start_token": 1297,
                                                                                    "end_token": 1297,
                                                                                    "children": []
                                                                                }
                                                                            ]
                                                                        },
                                                                        {
                                                                            "type": "argument_list",
                                                                            "label": "(timezone.utc)",
                                                                            "start_token": 1298,
                                                                            "end_token": 1302,
                                                                            "children": [
                                                                                {
                                                                                    "type": "attribute",
                                                                                    "label": "timezone.utc",
                                                                                    "start_token": 1299,
                                                                                    "end_token": 1301,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "label": "timezone",
                                                                                            "start_token": 1299,
                                                                                            "end_token": 1299,
                                                                                            "children": []
                                                                                        },
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "label": "utc",
                                                                                            "start_token": 1301,
                                                                                            "end_token": 1301,
                                                                                            "children": []
                                                                                        }
                                                                                    ]
                                                                                }
                                                                            ]
                                                                        }
                                                                    ]
                                                                },
                                                                {
                                                                    "type": "call",
                                                                    "label": "timedelta(minutes=10)",
                                                                    "start_token": 1304,
                                                                    "end_token": 1309,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "timedelta",
                                                                            "start_token": 1304,
                                                                            "end_token": 1304,
                                                                            "children": []
                                                                        },
                                                                        {
                                                                            "type": "argument_list",
                                                                            "label": "(minutes=10)",
                                                                            "start_token": 1305,
                                                                            "end_token": 1309,
                                                                            "children": [
                                                                                {
                                                                                    "type": "keyword_argument",
                                                                                    "label": "minutes=10",
                                                                                    "start_token": 1306,
                                                                                    "end_token": 1308,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "label": "minutes",
                                                                                            "start_token": 1306,
                                                                                            "end_token": 1306,
                                                                                            "children": []
                                                                                        },
                                                                                        {
                                                                                            "type": "integer",
                                                                                            "label": "10",
                                                                                            "start_token": 1308,
                                                                                            "end_token": 1308,
                                                                                            "children": []
                                                                                        }
                                                                                    ]
                                                                                }
                                                                            ]
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                }
                                            ]
                                        },
                                        {
                                            "type": "expression_statement",
                                            "label": "state = OAuthState(\n            token=token,\n            provider=provider,\n            expires_at=int(expires_at.timestamp()),\n            scopes=scopes,\n        )",
                                            "start_token": 1312,
                                            "end_token": 1344,
                                            "children": [
                                                {
                                                    "type": "assignment",
                                                    "label": "state = OAuthState(\n            token=token,\n            provider=provider,\n            expires_at=int(expires_at.timestamp()),\n            scopes=scopes,\n        )",
                                                    "start_token": 1312,
                                                    "end_token": 1344,
                                                    "children": [
                                                        {
                                                            "type": "identifier",
                                                            "label": "state",
                                                            "start_token": 1312,
                                                            "end_token": 1312,
                                                            "children": []
                                                        },
                                                        {
                                                            "type": "call",
                                                            "label": "OAuthState(\n            token=token,\n            provider=provider,\n            expires_at=int(expires_at.timestamp()),\n            scopes=scopes,\n        )",
                                                            "start_token": 1314,
                                                            "end_token": 1344,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "label": "OAuthState",
                                                                    "start_token": 1314,
                                                                    "end_token": 1314,
                                                                    "children": []
                                                                },
                                                                {
                                                                    "type": "argument_list",
                                                                    "label": "(\n            token=token,\n            provider=provider,\n            expires_at=int(expires_at.timestamp()),\n            scopes=scopes,\n        )",
                                                                    "start_token": 1315,
                                                                    "end_token": 1344,
                                                                    "children": [
                                                                        {
                                                                            "type": "keyword_argument",
                                                                            "label": "token=token",
                                                                            "start_token": 1317,
                                                                            "end_token": 1319,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "token",
                                                                                    "start_token": 1317,
                                                                                    "end_token": 1317,
                                                                                    "children": []
                                                                                },
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "token",
                                                                                    "start_token": 1319,
                                                                                    "end_token": 1319,
                                                                                    "children": []
                                                                                }
                                                                            ]
                                                                        },
                                                                        {
                                                                            "type": "keyword_argument",
                                                                            "label": "provider=provider",
                                                                            "start_token": 1322,
                                                                            "end_token": 1324,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "provider",
                                                                                    "start_token": 1322,
                                                                                    "end_token": 1322,
                                                                                    "children": []
                                                                                },
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "provider",
                                                                                    "start_token": 1324,
                                                                                    "end_token": 1324,
                                                                                    "children": []
                                                                                }
                                                                            ]
                                                                        },
                                                                        {
                                                                            "type": "keyword_argument",
                                                                            "label": "expires_at=int(expires_at.timestamp())",
                                                                            "start_token": 1327,
                                                                            "end_token": 1336,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "expires_at",
                                                                                    "start_token": 1327,
                                                                                    "end_token": 1327,
                                                                                    "children": []
                                                                                },
                                                                                {
                                                                                    "type": "call",
                                                                                    "label": "int(expires_at.timestamp())",
                                                                                    "start_token": 1329,
                                                                                    "end_token": 1336,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "label": "int",
                                                                                            "start_token": 1329,
                                                                                            "end_token": 1329,
                                                                                            "children": []
                                                                                        },
                                                                                        {
                                                                                            "type": "argument_list",
                                                                                            "label": "(expires_at.timestamp())",
                                                                                            "start_token": 1330,
                                                                                            "end_token": 1336,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "call",
                                                                                                    "label": "expires_at.timestamp()",
                                                                                                    "start_token": 1331,
                                                                                                    "end_token": 1335,
                                                                                                    "children": [
                                                                                                        {
                                                                                                            "type": "attribute",
                                                                                                            "label": "expires_at.timestamp",
                                                                                                            "start_token": 1331,
                                                                                                            "end_token": 1333,
                                                                                                            "children": [
                                                                                                                {
                                                                                                                    "type": "identifier",
                                                                                                                    "label": "expires_at",
                                                                                                                    "start_token": 1331,
                                                                                                                    "end_token": 1331,
                                                                                                                    "children": []
                                                                                                                },
                                                                                                                {
                                                                                                                    "type": "identifier",
                                                                                                                    "label": "timestamp",
                                                                                                                    "start_token": 1333,
                                                                                                                    "end_token": 1333,
                                                                                                                    "children": []
                                                                                                                }
                                                                                                            ]
                                                                                                        },
                                                                                                        {
                                                                                                            "type": "argument_list",
                                                                                                            "label": "()",
                                                                                                            "start_token": 1334,
                                                                                                            "end_token": 1335,
                                                                                                            "children": []
                                                                                                        }
                                                                                                    ]
                                                                                                }
                                                                                            ]
                                                                                        }
                                                                                    ]
                                                                                }
                                                                            ]
                                                                        },
                                                                        {
                                                                            "type": "keyword_argument",
                                                                            "label": "scopes=scopes",
                                                                            "start_token": 1339,
                                                                            "end_token": 1341,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "scopes",
                                                                                    "start_token": 1339,
                                                                                    "end_token": 1339,
                                                                                    "children": []
                                                                                },
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "scopes",
                                                                                    "start_token": 1341,
                                                                                    "end_token": 1341,
                                                                                    "children": []
                                                                                }
                                                                            ]
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                }
                                            ]
                                        },
                                        {
                                            "type": "with_statement",
                                            "label": "with self.locked_user_integrations(user_id):\n            user_integrations = self._get_user_integrations(user_id)\n            oauth_states = user_integrations.oauth_states\n            oauth_states.append(state)\n            user_integrations.oauth_states = oauth_states\n\n            self.db_manager.update_user_integrations(\n                user_id=user_id, data=user_integrations\n            )",
                                            "start_token": 1347,
                                            "end_token": 1400,
                                            "children": [
                                                {
                                                    "type": "with_clause",
                                                    "label": "self.locked_user_integrations(user_id)",
                                                    "start_token": 1348,
                                                    "end_token": 1353,
                                                    "children": [
                                                        {
                                                            "type": "with_item",
                                                            "label": "self.locked_user_integrations(user_id)",
                                                            "start_token": 1348,
                                                            "end_token": 1353,
                                                            "children": [
                                                                {
                                                                    "type": "call",
                                                                    "label": "self.locked_user_integrations(user_id)",
                                                                    "start_token": 1348,
                                                                    "end_token": 1353,
                                                                    "children": [
                                                                        {
                                                                            "type": "attribute",
                                                                            "label": "self.locked_user_integrations",
                                                                            "start_token": 1348,
                                                                            "end_token": 1350,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "self",
                                                                                    "start_token": 1348,
                                                                                    "end_token": 1348,
                                                                                    "children": []
                                                                                },
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "locked_user_integrations",
                                                                                    "start_token": 1350,
                                                                                    "end_token": 1350,
                                                                                    "children": []
                                                                                }
                                                                            ]
                                                                        },
                                                                        {
                                                                            "type": "argument_list",
                                                                            "label": "(user_id)",
                                                                            "start_token": 1351,
                                                                            "end_token": 1353,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "user_id",
                                                                                    "start_token": 1352,
                                                                                    "end_token": 1352,
                                                                                    "children": []
                                                                                }
                                                                            ]
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                },
                                                {
                                                    "type": "block",
                                                    "label": "user_integrations = self._get_user_integrations(user_id)\n            oauth_states = user_integrations.oauth_states\n            oauth_states.append(state)\n            user_integrations.oauth_states = oauth_states\n\n            self.db_manager.update_user_integrations(\n                user_id=user_id, data=user_integrations\n            )",
                                                    "start_token": 1356,
                                                    "end_token": 1400,
                                                    "children": [
                                                        {
                                                            "type": "expression_statement",
                                                            "label": "user_integrations = self._get_user_integrations(user_id)",
                                                            "start_token": 1356,
                                                            "end_token": 1363,
                                                            "children": [
                                                                {
                                                                    "type": "assignment",
                                                                    "label": "user_integrations = self._get_user_integrations(user_id)",
                                                                    "start_token": 1356,
                                                                    "end_token": 1363,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "user_integrations",
                                                                            "start_token": 1356,
                                                                            "end_token": 1356,
                                                                            "children": []
                                                                        },
                                                                        {
                                                                            "type": "call",
                                                                            "label": "self._get_user_integrations(user_id)",
                                                                            "start_token": 1358,
                                                                            "end_token": 1363,
                                                                            "children": [
                                                                                {
                                                                                    "type": "attribute",
                                                                                    "label": "self._get_user_integrations",
                                                                                    "start_token": 1358,
                                                                                    "end_token": 1360,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "label": "self",
                                                                                            "start_token": 1358,
                                                                                            "end_token": 1358,
                                                                                            "children": []
                                                                                        },
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "label": "_get_user_integrations",
                                                                                            "start_token": 1360,
                                                                                            "end_token": 1360,
                                                                                            "children": []
                                                                                        }
                                                                                    ]
                                                                                },
                                                                                {
                                                                                    "type": "argument_list",
                                                                                    "label": "(user_id)",
                                                                                    "start_token": 1361,
                                                                                    "end_token": 1363,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "label": "user_id",
                                                                                            "start_token": 1362,
                                                                                            "end_token": 1362,
                                                                                            "children": []
                                                                                        }
                                                                                    ]
                                                                                }
                                                                            ]
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        },
                                                        {
                                                            "type": "expression_statement",
                                                            "label": "oauth_states = user_integrations.oauth_states",
                                                            "start_token": 1365,
                                                            "end_token": 1369,
                                                            "children": [
                                                                {
                                                                    "type": "assignment",
                                                                    "label": "oauth_states = user_integrations.oauth_states",
                                                                    "start_token": 1365,
                                                                    "end_token": 1369,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "oauth_states",
                                                                            "start_token": 1365,
                                                                            "end_token": 1365,
                                                                            "children": []
                                                                        },
                                                                        {
                                                                            "type": "attribute",
                                                                            "label": "user_integrations.oauth_states",
                                                                            "start_token": 1367,
                                                                            "end_token": 1369,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "user_integrations",
                                                                                    "start_token": 1367,
                                                                                    "end_token": 1367,
                                                                                    "children": []
                                                                                },
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "oauth_states",
                                                                                    "start_token": 1369,
                                                                                    "end_token": 1369,
                                                                                    "children": []
                                                                                }
                                                                            ]
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        },
                                                        {
                                                            "type": "expression_statement",
                                                            "label": "oauth_states.append(state)",
                                                            "start_token": 1371,
                                                            "end_token": 1376,
                                                            "children": [
                                                                {
                                                                    "type": "call",
                                                                    "label": "oauth_states.append(state)",
                                                                    "start_token": 1371,
                                                                    "end_token": 1376,
                                                                    "children": [
                                                                        {
                                                                            "type": "attribute",
                                                                            "label": "oauth_states.append",
                                                                            "start_token": 1371,
                                                                            "end_token": 1373,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "oauth_states",
                                                                                    "start_token": 1371,
                                                                                    "end_token": 1371,
                                                                                    "children": []
                                                                                },
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "append",
                                                                                    "start_token": 1373,
                                                                                    "end_token": 1373,
                                                                                    "children": []
                                                                                }
                                                                            ]
                                                                        },
                                                                        {
                                                                            "type": "argument_list",
                                                                            "label": "(state)",
                                                                            "start_token": 1374,
                                                                            "end_token": 1376,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "state",
                                                                                    "start_token": 1375,
                                                                                    "end_token": 1375,
                                                                                    "children": []
                                                                                }
                                                                            ]
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        },
                                                        {
                                                            "type": "expression_statement",
                                                            "label": "user_integrations.oauth_states = oauth_states",
                                                            "start_token": 1378,
                                                            "end_token": 1382,
                                                            "children": [
                                                                {
                                                                    "type": "assignment",
                                                                    "label": "user_integrations.oauth_states = oauth_states",
                                                                    "start_token": 1378,
                                                                    "end_token": 1382,
                                                                    "children": [
                                                                        {
                                                                            "type": "attribute",
                                                                            "label": "user_integrations.oauth_states",
                                                                            "start_token": 1378,
                                                                            "end_token": 1380,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "user_integrations",
                                                                                    "start_token": 1378,
                                                                                    "end_token": 1378,
                                                                                    "children": []
                                                                                },
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "oauth_states",
                                                                                    "start_token": 1380,
                                                                                    "end_token": 1380,
                                                                                    "children": []
                                                                                }
                                                                            ]
                                                                        },
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "oauth_states",
                                                                            "start_token": 1382,
                                                                            "end_token": 1382,
                                                                            "children": []
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        },
                                                        {
                                                            "type": "expression_statement",
                                                            "label": "self.db_manager.update_user_integrations(\n                user_id=user_id, data=user_integrations\n            )",
                                                            "start_token": 1385,
                                                            "end_token": 1400,
                                                            "children": [
                                                                {
                                                                    "type": "call",
                                                                    "label": "self.db_manager.update_user_integrations(\n                user_id=user_id, data=user_integrations\n            )",
                                                                    "start_token": 1385,
                                                                    "end_token": 1400,
                                                                    "children": [
                                                                        {
                                                                            "type": "attribute",
                                                                            "label": "self.db_manager.update_user_integrations",
                                                                            "start_token": 1385,
                                                                            "end_token": 1389,
                                                                            "children": [
                                                                                {
                                                                                    "type": "attribute",
                                                                                    "label": "self.db_manager",
                                                                                    "start_token": 1385,
                                                                                    "end_token": 1387,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "label": "self",
                                                                                            "start_token": 1385,
                                                                                            "end_token": 1385,
                                                                                            "children": []
                                                                                        },
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "label": "db_manager",
                                                                                            "start_token": 1387,
                                                                                            "end_token": 1387,
                                                                                            "children": []
                                                                                        }
                                                                                    ]
                                                                                },
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "update_user_integrations",
                                                                                    "start_token": 1389,
                                                                                    "end_token": 1389,
                                                                                    "children": []
                                                                                }
                                                                            ]
                                                                        },
                                                                        {
                                                                            "type": "argument_list",
                                                                            "label": "(\n                user_id=user_id, data=user_integrations\n            )",
                                                                            "start_token": 1390,
                                                                            "end_token": 1400,
                                                                            "children": [
                                                                                {
                                                                                    "type": "keyword_argument",
                                                                                    "label": "user_id=user_id",
                                                                                    "start_token": 1392,
                                                                                    "end_token": 1394,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "label": "user_id",
                                                                                            "start_token": 1392,
                                                                                            "end_token": 1392,
                                                                                            "children": []
                                                                                        },
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "label": "user_id",
                                                                                            "start_token": 1394,
                                                                                            "end_token": 1394,
                                                                                            "children": []
                                                                                        }
                                                                                    ]
                                                                                },
                                                                                {
                                                                                    "type": "keyword_argument",
                                                                                    "label": "data=user_integrations",
                                                                                    "start_token": 1396,
                                                                                    "end_token": 1398,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "label": "data",
                                                                                            "start_token": 1396,
                                                                                            "end_token": 1396,
                                                                                            "children": []
                                                                                        },
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "label": "user_integrations",
                                                                                            "start_token": 1398,
                                                                                            "end_token": 1398,
                                                                                            "children": []
                                                                                        }
                                                                                    ]
                                                                                }
                                                                            ]
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                }
                                            ]
                                        },
                                        {
                                            "type": "return_statement",
                                            "label": "return token",
                                            "start_token": 1403,
                                            "end_token": 1404,
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "label": "token",
                                                    "start_token": 1404,
                                                    "end_token": 1404,
                                                    "children": []
                                                }
                                            ]
                                        }
                                    ]
                                }
                            ]
                        },
                        {
                            "type": "function_definition",
                            "label": "def get_any_valid_scopes_from_state_token(\n        self, user_id: str, token: str, provider: str\n    ) -> list[str]:\n        \"\"\"\n        Get the valid scopes from the OAuth state token. This will return any valid scopes\n        from any OAuth state token for the given provider. If no valid scopes are found,\n        an empty list is returned. DO NOT RELY ON THIS TOKEN TO AUTHENTICATE A USER, AS IT\n        IS TO CHECK IF THE USER HAS GIVEN PERMISSIONS TO THE APPLICATION BEFORE EXCHANGING\n        THE CODE FOR TOKENS.\n        \"\"\"\n        user_integrations = self._get_user_integrations(user_id)\n        oauth_states = user_integrations.oauth_states\n\n        now = datetime.now(timezone.utc)\n        valid_state = next(\n            (\n                state\n                for state in oauth_states\n                if state.token == token\n                and state.provider == provider\n                and state.expires_at > now.timestamp()\n            ),\n            None,\n        )\n\n        if valid_state:\n            return valid_state.scopes\n\n        return []",
                            "start_token": 1407,
                            "end_token": 1527,
                            "children": [
                                {
                                    "type": "identifier",
                                    "label": "get_any_valid_scopes_from_state_token",
                                    "start_token": 1408,
                                    "end_token": 1408,
                                    "children": []
                                },
                                {
                                    "type": "parameters",
                                    "label": "(\n        self, user_id: str, token: str, provider: str\n    )",
                                    "start_token": 1409,
                                    "end_token": 1425,
                                    "children": [
                                        {
                                            "type": "identifier",
                                            "label": "self",
                                            "start_token": 1411,
                                            "end_token": 1411,
                                            "children": []
                                        },
                                        {
                                            "type": "typed_parameter",
                                            "label": "user_id: str",
                                            "start_token": 1413,
                                            "end_token": 1415,
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "label": "user_id",
                                                    "start_token": 1413,
                                                    "end_token": 1413,
                                                    "children": []
                                                },
                                                {
                                                    "type": "type",
                                                    "label": "str",
                                                    "start_token": 1415,
                                                    "end_token": 1415,
                                                    "children": [
                                                        {
                                                            "type": "identifier",
                                                            "label": "str",
                                                            "start_token": 1415,
                                                            "end_token": 1415,
                                                            "children": []
                                                        }
                                                    ]
                                                }
                                            ]
                                        },
                                        {
                                            "type": "typed_parameter",
                                            "label": "token: str",
                                            "start_token": 1417,
                                            "end_token": 1419,
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "label": "token",
                                                    "start_token": 1417,
                                                    "end_token": 1417,
                                                    "children": []
                                                },
                                                {
                                                    "type": "type",
                                                    "label": "str",
                                                    "start_token": 1419,
                                                    "end_token": 1419,
                                                    "children": [
                                                        {
                                                            "type": "identifier",
                                                            "label": "str",
                                                            "start_token": 1419,
                                                            "end_token": 1419,
                                                            "children": []
                                                        }
                                                    ]
                                                }
                                            ]
                                        },
                                        {
                                            "type": "typed_parameter",
                                            "label": "provider: str",
                                            "start_token": 1421,
                                            "end_token": 1423,
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "label": "provider",
                                                    "start_token": 1421,
                                                    "end_token": 1421,
                                                    "children": []
                                                },
                                                {
                                                    "type": "type",
                                                    "label": "str",
                                                    "start_token": 1423,
                                                    "end_token": 1423,
                                                    "children": [
                                                        {
                                                            "type": "identifier",
                                                            "label": "str",
                                                            "start_token": 1423,
                                                            "end_token": 1423,
                                                            "children": []
                                                        }
                                                    ]
                                                }
                                            ]
                                        }
                                    ]
                                },
                                {
                                    "type": "type",
                                    "label": "list[str]",
                                    "start_token": 1428,
                                    "end_token": 1431,
                                    "children": [
                                        {
                                            "type": "generic_type",
                                            "label": "list[str]",
                                            "start_token": 1428,
                                            "end_token": 1431,
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "label": "list",
                                                    "start_token": 1428,
                                                    "end_token": 1428,
                                                    "children": []
                                                },
                                                {
                                                    "type": "type_parameter",
                                                    "label": "[str]",
                                                    "start_token": 1429,
                                                    "end_token": 1431,
                                                    "children": [
                                                        {
                                                            "type": "type",
                                                            "label": "str",
                                                            "start_token": 1430,
                                                            "end_token": 1430,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "label": "str",
                                                                    "start_token": 1430,
                                                                    "end_token": 1430,
                                                                    "children": []
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                }
                                            ]
                                        }
                                    ]
                                },
                                {
                                    "type": "block",
                                    "label": "\"\"\"\n        Get the valid scopes from the OAuth state token. This will return any valid scopes\n        from any OAuth state token for the given provider. If no valid scopes are found,\n        an empty list is returned. DO NOT RELY ON THIS TOKEN TO AUTHENTICATE A USER, AS IT\n        IS TO CHECK IF THE USER HAS GIVEN PERMISSIONS TO THE APPLICATION BEFORE EXCHANGING\n        THE CODE FOR TOKENS.\n        \"\"\"\n        user_integrations = self._get_user_integrations(user_id)\n        oauth_states = user_integrations.oauth_states\n\n        now = datetime.now(timezone.utc)\n        valid_state = next(\n            (\n                state\n                for state in oauth_states\n                if state.token == token\n                and state.provider == provider\n                and state.expires_at > now.timestamp()\n            ),\n            None,\n        )\n\n        if valid_state:\n            return valid_state.scopes\n\n        return []",
                                    "start_token": 1434,
                                    "end_token": 1527,
                                    "children": [
                                        {
                                            "type": "expression_statement",
                                            "label": "\"\"\"\n        Get the valid scopes from the OAuth state token. This will return any valid scopes\n        from any OAuth state token for the given provider. If no valid scopes are found,\n        an empty list is returned. DO NOT RELY ON THIS TOKEN TO AUTHENTICATE A USER, AS IT\n        IS TO CHECK IF THE USER HAS GIVEN PERMISSIONS TO THE APPLICATION BEFORE EXCHANGING\n        THE CODE FOR TOKENS.\n        \"\"\"",
                                            "start_token": 1434,
                                            "end_token": 1436,
                                            "children": [
                                                {
                                                    "type": "string",
                                                    "label": "\"\"\"\n        Get the valid scopes from the OAuth state token. This will return any valid scopes\n        from any OAuth state token for the given provider. If no valid scopes are found,\n        an empty list is returned. DO NOT RELY ON THIS TOKEN TO AUTHENTICATE A USER, AS IT\n        IS TO CHECK IF THE USER HAS GIVEN PERMISSIONS TO THE APPLICATION BEFORE EXCHANGING\n        THE CODE FOR TOKENS.\n        \"\"\"",
                                                    "start_token": 1434,
                                                    "end_token": 1436,
                                                    "children": [
                                                        {
                                                            "type": "string_start",
                                                            "label": "\"\"\"",
                                                            "start_token": 1434,
                                                            "end_token": 1435,
                                                            "children": []
                                                        },
                                                        {
                                                            "type": "string_content",
                                                            "label": "\n        Get the valid scopes from the OAuth state token. This will return any valid scopes\n        from any OAuth state token for the given provider. If no valid scopes are found,\n        an empty list is returned. DO NOT RELY ON THIS TOKEN TO AUTHENTICATE A USER, AS IT\n        IS TO CHECK IF THE USER HAS GIVEN PERMISSIONS TO THE APPLICATION BEFORE EXCHANGING\n        THE CODE FOR TOKENS.\n        ",
                                                            "start_token": 1435,
                                                            "end_token": 1435,
                                                            "children": []
                                                        },
                                                        {
                                                            "type": "string_end",
                                                            "label": "\"\"\"",
                                                            "start_token": 1435,
                                                            "end_token": 1436,
                                                            "children": []
                                                        }
                                                    ]
                                                }
                                            ]
                                        },
                                        {
                                            "type": "expression_statement",
                                            "label": "user_integrations = self._get_user_integrations(user_id)",
                                            "start_token": 1438,
                                            "end_token": 1445,
                                            "children": [
                                                {
                                                    "type": "assignment",
                                                    "label": "user_integrations = self._get_user_integrations(user_id)",
                                                    "start_token": 1438,
                                                    "end_token": 1445,
                                                    "children": [
                                                        {
                                                            "type": "identifier",
                                                            "label": "user_integrations",
                                                            "start_token": 1438,
                                                            "end_token": 1438,
                                                            "children": []
                                                        },
                                                        {
                                                            "type": "call",
                                                            "label": "self._get_user_integrations(user_id)",
                                                            "start_token": 1440,
                                                            "end_token": 1445,
                                                            "children": [
                                                                {
                                                                    "type": "attribute",
                                                                    "label": "self._get_user_integrations",
                                                                    "start_token": 1440,
                                                                    "end_token": 1442,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "self",
                                                                            "start_token": 1440,
                                                                            "end_token": 1440,
                                                                            "children": []
                                                                        },
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "_get_user_integrations",
                                                                            "start_token": 1442,
                                                                            "end_token": 1442,
                                                                            "children": []
                                                                        }
                                                                    ]
                                                                },
                                                                {
                                                                    "type": "argument_list",
                                                                    "label": "(user_id)",
                                                                    "start_token": 1443,
                                                                    "end_token": 1445,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "user_id",
                                                                            "start_token": 1444,
                                                                            "end_token": 1444,
                                                                            "children": []
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                }
                                            ]
                                        },
                                        {
                                            "type": "expression_statement",
                                            "label": "oauth_states = user_integrations.oauth_states",
                                            "start_token": 1447,
                                            "end_token": 1451,
                                            "children": [
                                                {
                                                    "type": "assignment",
                                                    "label": "oauth_states = user_integrations.oauth_states",
                                                    "start_token": 1447,
                                                    "end_token": 1451,
                                                    "children": [
                                                        {
                                                            "type": "identifier",
                                                            "label": "oauth_states",
                                                            "start_token": 1447,
                                                            "end_token": 1447,
                                                            "children": []
                                                        },
                                                        {
                                                            "type": "attribute",
                                                            "label": "user_integrations.oauth_states",
                                                            "start_token": 1449,
                                                            "end_token": 1451,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "label": "user_integrations",
                                                                    "start_token": 1449,
                                                                    "end_token": 1449,
                                                                    "children": []
                                                                },
                                                                {
                                                                    "type": "identifier",
                                                                    "label": "oauth_states",
                                                                    "start_token": 1451,
                                                                    "end_token": 1451,
                                                                    "children": []
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                }
                                            ]
                                        },
                                        {
                                            "type": "expression_statement",
                                            "label": "now = datetime.now(timezone.utc)",
                                            "start_token": 1454,
                                            "end_token": 1463,
                                            "children": [
                                                {
                                                    "type": "assignment",
                                                    "label": "now = datetime.now(timezone.utc)",
                                                    "start_token": 1454,
                                                    "end_token": 1463,
                                                    "children": [
                                                        {
                                                            "type": "identifier",
                                                            "label": "now",
                                                            "start_token": 1454,
                                                            "end_token": 1454,
                                                            "children": []
                                                        },
                                                        {
                                                            "type": "call",
                                                            "label": "datetime.now(timezone.utc)",
                                                            "start_token": 1456,
                                                            "end_token": 1463,
                                                            "children": [
                                                                {
                                                                    "type": "attribute",
                                                                    "label": "datetime.now",
                                                                    "start_token": 1456,
                                                                    "end_token": 1458,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "datetime",
                                                                            "start_token": 1456,
                                                                            "end_token": 1456,
                                                                            "children": []
                                                                        },
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "now",
                                                                            "start_token": 1458,
                                                                            "end_token": 1458,
                                                                            "children": []
                                                                        }
                                                                    ]
                                                                },
                                                                {
                                                                    "type": "argument_list",
                                                                    "label": "(timezone.utc)",
                                                                    "start_token": 1459,
                                                                    "end_token": 1463,
                                                                    "children": [
                                                                        {
                                                                            "type": "attribute",
                                                                            "label": "timezone.utc",
                                                                            "start_token": 1460,
                                                                            "end_token": 1462,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "timezone",
                                                                                    "start_token": 1460,
                                                                                    "end_token": 1460,
                                                                                    "children": []
                                                                                },
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "utc",
                                                                                    "start_token": 1462,
                                                                                    "end_token": 1462,
                                                                                    "children": []
                                                                                }
                                                                            ]
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                }
                                            ]
                                        },
                                        {
                                            "type": "expression_statement",
                                            "label": "valid_state = next(\n            (\n                state\n                for state in oauth_states\n                if state.token == token\n                and state.provider == provider\n                and state.expires_at > now.timestamp()\n            ),\n            None,\n        )",
                                            "start_token": 1465,
                                            "end_token": 1512,
                                            "children": [
                                                {
                                                    "type": "assignment",
                                                    "label": "valid_state = next(\n            (\n                state\n                for state in oauth_states\n                if state.token == token\n                and state.provider == provider\n                and state.expires_at > now.timestamp()\n            ),\n            None,\n        )",
                                                    "start_token": 1465,
                                                    "end_token": 1512,
                                                    "children": [
                                                        {
                                                            "type": "identifier",
                                                            "label": "valid_state",
                                                            "start_token": 1465,
                                                            "end_token": 1465,
                                                            "children": []
                                                        },
                                                        {
                                                            "type": "call",
                                                            "label": "next(\n            (\n                state\n                for state in oauth_states\n                if state.token == token\n                and state.provider == provider\n                and state.expires_at > now.timestamp()\n            ),\n            None,\n        )",
                                                            "start_token": 1467,
                                                            "end_token": 1512,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "label": "next",
                                                                    "start_token": 1467,
                                                                    "end_token": 1467,
                                                                    "children": []
                                                                },
                                                                {
                                                                    "type": "argument_list",
                                                                    "label": "(\n            (\n                state\n                for state in oauth_states\n                if state.token == token\n                and state.provider == provider\n                and state.expires_at > now.timestamp()\n            ),\n            None,\n        )",
                                                                    "start_token": 1468,
                                                                    "end_token": 1512,
                                                                    "children": [
                                                                        {
                                                                            "type": "generator_expression",
                                                                            "label": "(\n                state\n                for state in oauth_states\n                if state.token == token\n                and state.provider == provider\n                and state.expires_at > now.timestamp()\n            )",
                                                                            "start_token": 1470,
                                                                            "end_token": 1506,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "state",
                                                                                    "start_token": 1472,
                                                                                    "end_token": 1472,
                                                                                    "children": []
                                                                                },
                                                                                {
                                                                                    "type": "for_in_clause",
                                                                                    "label": "for state in oauth_states",
                                                                                    "start_token": 1474,
                                                                                    "end_token": 1477,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "label": "state",
                                                                                            "start_token": 1475,
                                                                                            "end_token": 1475,
                                                                                            "children": []
                                                                                        },
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "label": "oauth_states",
                                                                                            "start_token": 1477,
                                                                                            "end_token": 1477,
                                                                                            "children": []
                                                                                        }
                                                                                    ]
                                                                                },
                                                                                {
                                                                                    "type": "if_clause",
                                                                                    "label": "if state.token == token\n                and state.provider == provider\n                and state.expires_at > now.timestamp()",
                                                                                    "start_token": 1479,
                                                                                    "end_token": 1504,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "boolean_operator",
                                                                                            "label": "state.token == token\n                and state.provider == provider\n                and state.expires_at > now.timestamp()",
                                                                                            "start_token": 1480,
                                                                                            "end_token": 1504,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "boolean_operator",
                                                                                                    "label": "state.token == token\n                and state.provider == provider",
                                                                                                    "start_token": 1480,
                                                                                                    "end_token": 1493,
                                                                                                    "children": [
                                                                                                        {
                                                                                                            "type": "comparison_operator",
                                                                                                            "label": "state.token == token",
                                                                                                            "start_token": 1480,
                                                                                                            "end_token": 1485,
                                                                                                            "children": [
                                                                                                                {
                                                                                                                    "type": "attribute",
                                                                                                                    "label": "state.token",
                                                                                                                    "start_token": 1480,
                                                                                                                    "end_token": 1482,
                                                                                                                    "children": [
                                                                                                                        {
                                                                                                                            "type": "identifier",
                                                                                                                            "label": "state",
                                                                                                                            "start_token": 1480,
                                                                                                                            "end_token": 1480,
                                                                                                                            "children": []
                                                                                                                        },
                                                                                                                        {
                                                                                                                            "type": "identifier",
                                                                                                                            "label": "token",
                                                                                                                            "start_token": 1482,
                                                                                                                            "end_token": 1482,
                                                                                                                            "children": []
                                                                                                                        }
                                                                                                                    ]
                                                                                                                },
                                                                                                                {
                                                                                                                    "type": "identifier",
                                                                                                                    "label": "token",
                                                                                                                    "start_token": 1485,
                                                                                                                    "end_token": 1485,
                                                                                                                    "children": []
                                                                                                                }
                                                                                                            ]
                                                                                                        },
                                                                                                        {
                                                                                                            "type": "comparison_operator",
                                                                                                            "label": "state.provider == provider",
                                                                                                            "start_token": 1488,
                                                                                                            "end_token": 1493,
                                                                                                            "children": [
                                                                                                                {
                                                                                                                    "type": "attribute",
                                                                                                                    "label": "state.provider",
                                                                                                                    "start_token": 1488,
                                                                                                                    "end_token": 1490,
                                                                                                                    "children": [
                                                                                                                        {
                                                                                                                            "type": "identifier",
                                                                                                                            "label": "state",
                                                                                                                            "start_token": 1488,
                                                                                                                            "end_token": 1488,
                                                                                                                            "children": []
                                                                                                                        },
                                                                                                                        {
                                                                                                                            "type": "identifier",
                                                                                                                            "label": "provider",
                                                                                                                            "start_token": 1490,
                                                                                                                            "end_token": 1490,
                                                                                                                            "children": []
                                                                                                                        }
                                                                                                                    ]
                                                                                                                },
                                                                                                                {
                                                                                                                    "type": "identifier",
                                                                                                                    "label": "provider",
                                                                                                                    "start_token": 1493,
                                                                                                                    "end_token": 1493,
                                                                                                                    "children": []
                                                                                                                }
                                                                                                            ]
                                                                                                        }
                                                                                                    ]
                                                                                                },
                                                                                                {
                                                                                                    "type": "comparison_operator",
                                                                                                    "label": "state.expires_at > now.timestamp()",
                                                                                                    "start_token": 1496,
                                                                                                    "end_token": 1504,
                                                                                                    "children": [
                                                                                                        {
                                                                                                            "type": "attribute",
                                                                                                            "label": "state.expires_at",
                                                                                                            "start_token": 1496,
                                                                                                            "end_token": 1498,
                                                                                                            "children": [
                                                                                                                {
                                                                                                                    "type": "identifier",
                                                                                                                    "label": "state",
                                                                                                                    "start_token": 1496,
                                                                                                                    "end_token": 1496,
                                                                                                                    "children": []
                                                                                                                },
                                                                                                                {
                                                                                                                    "type": "identifier",
                                                                                                                    "label": "expires_at",
                                                                                                                    "start_token": 1498,
                                                                                                                    "end_token": 1498,
                                                                                                                    "children": []
                                                                                                                }
                                                                                                            ]
                                                                                                        },
                                                                                                        {
                                                                                                            "type": "call",
                                                                                                            "label": "now.timestamp()",
                                                                                                            "start_token": 1500,
                                                                                                            "end_token": 1504,
                                                                                                            "children": [
                                                                                                                {
                                                                                                                    "type": "attribute",
                                                                                                                    "label": "now.timestamp",
                                                                                                                    "start_token": 1500,
                                                                                                                    "end_token": 1502,
                                                                                                                    "children": [
                                                                                                                        {
                                                                                                                            "type": "identifier",
                                                                                                                            "label": "now",
                                                                                                                            "start_token": 1500,
                                                                                                                            "end_token": 1500,
                                                                                                                            "children": []
                                                                                                                        },
                                                                                                                        {
                                                                                                                            "type": "identifier",
                                                                                                                            "label": "timestamp",
                                                                                                                            "start_token": 1502,
                                                                                                                            "end_token": 1502,
                                                                                                                            "children": []
                                                                                                                        }
                                                                                                                    ]
                                                                                                                },
                                                                                                                {
                                                                                                                    "type": "argument_list",
                                                                                                                    "label": "()",
                                                                                                                    "start_token": 1503,
                                                                                                                    "end_token": 1504,
                                                                                                                    "children": []
                                                                                                                }
                                                                                                            ]
                                                                                                        }
                                                                                                    ]
                                                                                                }
                                                                                            ]
                                                                                        }
                                                                                    ]
                                                                                }
                                                                            ]
                                                                        },
                                                                        {
                                                                            "type": "none",
                                                                            "label": "None",
                                                                            "start_token": 1509,
                                                                            "end_token": 1509,
                                                                            "children": []
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                }
                                            ]
                                        },
                                        {
                                            "type": "if_statement",
                                            "label": "if valid_state:\n            return valid_state.scopes",
                                            "start_token": 1515,
                                            "end_token": 1522,
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "label": "valid_state",
                                                    "start_token": 1516,
                                                    "end_token": 1516,
                                                    "children": []
                                                },
                                                {
                                                    "type": "block",
                                                    "label": "return valid_state.scopes",
                                                    "start_token": 1519,
                                                    "end_token": 1522,
                                                    "children": [
                                                        {
                                                            "type": "return_statement",
                                                            "label": "return valid_state.scopes",
                                                            "start_token": 1519,
                                                            "end_token": 1522,
                                                            "children": [
                                                                {
                                                                    "type": "attribute",
                                                                    "label": "valid_state.scopes",
                                                                    "start_token": 1520,
                                                                    "end_token": 1522,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "valid_state",
                                                                            "start_token": 1520,
                                                                            "end_token": 1520,
                                                                            "children": []
                                                                        },
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "scopes",
                                                                            "start_token": 1522,
                                                                            "end_token": 1522,
                                                                            "children": []
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                }
                                            ]
                                        },
                                        {
                                            "type": "return_statement",
                                            "label": "return []",
                                            "start_token": 1525,
                                            "end_token": 1527,
                                            "children": [
                                                {
                                                    "type": "list",
                                                    "label": "[]",
                                                    "start_token": 1526,
                                                    "end_token": 1527,
                                                    "children": []
                                                }
                                            ]
                                        }
                                    ]
                                }
                            ]
                        },
                        {
                            "type": "function_definition",
                            "label": "def verify_state_token(self, user_id: str, token: str, provider: str) -> bool:\n        with self.locked_user_integrations(user_id):\n            user_integrations = self._get_user_integrations(user_id)\n            oauth_states = user_integrations.oauth_states\n\n            now = datetime.now(timezone.utc)\n            valid_state = next(\n                (\n                    state\n                    for state in oauth_states\n                    if state.token == token\n                    and state.provider == provider\n                    and state.expires_at > now.timestamp()\n                ),\n                None,\n            )\n\n            if valid_state:\n                # Remove the used state\n                oauth_states.remove(valid_state)\n                user_integrations.oauth_states = oauth_states\n                self.db_manager.update_user_integrations(user_id, user_integrations)\n                return True\n\n        return False",
                            "start_token": 1530,
                            "end_token": 1677,
                            "children": [
                                {
                                    "type": "identifier",
                                    "label": "verify_state_token",
                                    "start_token": 1531,
                                    "end_token": 1531,
                                    "children": []
                                },
                                {
                                    "type": "parameters",
                                    "label": "(self, user_id: str, token: str, provider: str)",
                                    "start_token": 1532,
                                    "end_token": 1546,
                                    "children": [
                                        {
                                            "type": "identifier",
                                            "label": "self",
                                            "start_token": 1533,
                                            "end_token": 1533,
                                            "children": []
                                        },
                                        {
                                            "type": "typed_parameter",
                                            "label": "user_id: str",
                                            "start_token": 1535,
                                            "end_token": 1537,
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "label": "user_id",
                                                    "start_token": 1535,
                                                    "end_token": 1535,
                                                    "children": []
                                                },
                                                {
                                                    "type": "type",
                                                    "label": "str",
                                                    "start_token": 1537,
                                                    "end_token": 1537,
                                                    "children": [
                                                        {
                                                            "type": "identifier",
                                                            "label": "str",
                                                            "start_token": 1537,
                                                            "end_token": 1537,
                                                            "children": []
                                                        }
                                                    ]
                                                }
                                            ]
                                        },
                                        {
                                            "type": "typed_parameter",
                                            "label": "token: str",
                                            "start_token": 1539,
                                            "end_token": 1541,
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "label": "token",
                                                    "start_token": 1539,
                                                    "end_token": 1539,
                                                    "children": []
                                                },
                                                {
                                                    "type": "type",
                                                    "label": "str",
                                                    "start_token": 1541,
                                                    "end_token": 1541,
                                                    "children": [
                                                        {
                                                            "type": "identifier",
                                                            "label": "str",
                                                            "start_token": 1541,
                                                            "end_token": 1541,
                                                            "children": []
                                                        }
                                                    ]
                                                }
                                            ]
                                        },
                                        {
                                            "type": "typed_parameter",
                                            "label": "provider: str",
                                            "start_token": 1543,
                                            "end_token": 1545,
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "label": "provider",
                                                    "start_token": 1543,
                                                    "end_token": 1543,
                                                    "children": []
                                                },
                                                {
                                                    "type": "type",
                                                    "label": "str",
                                                    "start_token": 1545,
                                                    "end_token": 1545,
                                                    "children": [
                                                        {
                                                            "type": "identifier",
                                                            "label": "str",
                                                            "start_token": 1545,
                                                            "end_token": 1545,
                                                            "children": []
                                                        }
                                                    ]
                                                }
                                            ]
                                        }
                                    ]
                                },
                                {
                                    "type": "type",
                                    "label": "bool",
                                    "start_token": 1549,
                                    "end_token": 1549,
                                    "children": [
                                        {
                                            "type": "identifier",
                                            "label": "bool",
                                            "start_token": 1549,
                                            "end_token": 1549,
                                            "children": []
                                        }
                                    ]
                                },
                                {
                                    "type": "block",
                                    "label": "with self.locked_user_integrations(user_id):\n            user_integrations = self._get_user_integrations(user_id)\n            oauth_states = user_integrations.oauth_states\n\n            now = datetime.now(timezone.utc)\n            valid_state = next(\n                (\n                    state\n                    for state in oauth_states\n                    if state.token == token\n                    and state.provider == provider\n                    and state.expires_at > now.timestamp()\n                ),\n                None,\n            )\n\n            if valid_state:\n                # Remove the used state\n                oauth_states.remove(valid_state)\n                user_integrations.oauth_states = oauth_states\n                self.db_manager.update_user_integrations(user_id, user_integrations)\n                return True\n\n        return False",
                                    "start_token": 1552,
                                    "end_token": 1677,
                                    "children": [
                                        {
                                            "type": "with_statement",
                                            "label": "with self.locked_user_integrations(user_id):\n            user_integrations = self._get_user_integrations(user_id)\n            oauth_states = user_integrations.oauth_states\n\n            now = datetime.now(timezone.utc)\n            valid_state = next(\n                (\n                    state\n                    for state in oauth_states\n                    if state.token == token\n                    and state.provider == provider\n                    and state.expires_at > now.timestamp()\n                ),\n                None,\n            )\n\n            if valid_state:\n                # Remove the used state\n                oauth_states.remove(valid_state)\n                user_integrations.oauth_states = oauth_states\n                self.db_manager.update_user_integrations(user_id, user_integrations)\n                return True",
                                            "start_token": 1552,
                                            "end_token": 1673,
                                            "children": [
                                                {
                                                    "type": "with_clause",
                                                    "label": "self.locked_user_integrations(user_id)",
                                                    "start_token": 1553,
                                                    "end_token": 1558,
                                                    "children": [
                                                        {
                                                            "type": "with_item",
                                                            "label": "self.locked_user_integrations(user_id)",
                                                            "start_token": 1553,
                                                            "end_token": 1558,
                                                            "children": [
                                                                {
                                                                    "type": "call",
                                                                    "label": "self.locked_user_integrations(user_id)",
                                                                    "start_token": 1553,
                                                                    "end_token": 1558,
                                                                    "children": [
                                                                        {
                                                                            "type": "attribute",
                                                                            "label": "self.locked_user_integrations",
                                                                            "start_token": 1553,
                                                                            "end_token": 1555,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "self",
                                                                                    "start_token": 1553,
                                                                                    "end_token": 1553,
                                                                                    "children": []
                                                                                },
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "locked_user_integrations",
                                                                                    "start_token": 1555,
                                                                                    "end_token": 1555,
                                                                                    "children": []
                                                                                }
                                                                            ]
                                                                        },
                                                                        {
                                                                            "type": "argument_list",
                                                                            "label": "(user_id)",
                                                                            "start_token": 1556,
                                                                            "end_token": 1558,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "user_id",
                                                                                    "start_token": 1557,
                                                                                    "end_token": 1557,
                                                                                    "children": []
                                                                                }
                                                                            ]
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                },
                                                {
                                                    "type": "block",
                                                    "label": "user_integrations = self._get_user_integrations(user_id)\n            oauth_states = user_integrations.oauth_states\n\n            now = datetime.now(timezone.utc)\n            valid_state = next(\n                (\n                    state\n                    for state in oauth_states\n                    if state.token == token\n                    and state.provider == provider\n                    and state.expires_at > now.timestamp()\n                ),\n                None,\n            )\n\n            if valid_state:\n                # Remove the used state\n                oauth_states.remove(valid_state)\n                user_integrations.oauth_states = oauth_states\n                self.db_manager.update_user_integrations(user_id, user_integrations)\n                return True",
                                                    "start_token": 1561,
                                                    "end_token": 1673,
                                                    "children": [
                                                        {
                                                            "type": "expression_statement",
                                                            "label": "user_integrations = self._get_user_integrations(user_id)",
                                                            "start_token": 1561,
                                                            "end_token": 1568,
                                                            "children": [
                                                                {
                                                                    "type": "assignment",
                                                                    "label": "user_integrations = self._get_user_integrations(user_id)",
                                                                    "start_token": 1561,
                                                                    "end_token": 1568,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "user_integrations",
                                                                            "start_token": 1561,
                                                                            "end_token": 1561,
                                                                            "children": []
                                                                        },
                                                                        {
                                                                            "type": "call",
                                                                            "label": "self._get_user_integrations(user_id)",
                                                                            "start_token": 1563,
                                                                            "end_token": 1568,
                                                                            "children": [
                                                                                {
                                                                                    "type": "attribute",
                                                                                    "label": "self._get_user_integrations",
                                                                                    "start_token": 1563,
                                                                                    "end_token": 1565,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "label": "self",
                                                                                            "start_token": 1563,
                                                                                            "end_token": 1563,
                                                                                            "children": []
                                                                                        },
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "label": "_get_user_integrations",
                                                                                            "start_token": 1565,
                                                                                            "end_token": 1565,
                                                                                            "children": []
                                                                                        }
                                                                                    ]
                                                                                },
                                                                                {
                                                                                    "type": "argument_list",
                                                                                    "label": "(user_id)",
                                                                                    "start_token": 1566,
                                                                                    "end_token": 1568,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "label": "user_id",
                                                                                            "start_token": 1567,
                                                                                            "end_token": 1567,
                                                                                            "children": []
                                                                                        }
                                                                                    ]
                                                                                }
                                                                            ]
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        },
                                                        {
                                                            "type": "expression_statement",
                                                            "label": "oauth_states = user_integrations.oauth_states",
                                                            "start_token": 1570,
                                                            "end_token": 1574,
                                                            "children": [
                                                                {
                                                                    "type": "assignment",
                                                                    "label": "oauth_states = user_integrations.oauth_states",
                                                                    "start_token": 1570,
                                                                    "end_token": 1574,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "oauth_states",
                                                                            "start_token": 1570,
                                                                            "end_token": 1570,
                                                                            "children": []
                                                                        },
                                                                        {
                                                                            "type": "attribute",
                                                                            "label": "user_integrations.oauth_states",
                                                                            "start_token": 1572,
                                                                            "end_token": 1574,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "user_integrations",
                                                                                    "start_token": 1572,
                                                                                    "end_token": 1572,
                                                                                    "children": []
                                                                                },
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "oauth_states",
                                                                                    "start_token": 1574,
                                                                                    "end_token": 1574,
                                                                                    "children": []
                                                                                }
                                                                            ]
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        },
                                                        {
                                                            "type": "expression_statement",
                                                            "label": "now = datetime.now(timezone.utc)",
                                                            "start_token": 1577,
                                                            "end_token": 1586,
                                                            "children": [
                                                                {
                                                                    "type": "assignment",
                                                                    "label": "now = datetime.now(timezone.utc)",
                                                                    "start_token": 1577,
                                                                    "end_token": 1586,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "now",
                                                                            "start_token": 1577,
                                                                            "end_token": 1577,
                                                                            "children": []
                                                                        },
                                                                        {
                                                                            "type": "call",
                                                                            "label": "datetime.now(timezone.utc)",
                                                                            "start_token": 1579,
                                                                            "end_token": 1586,
                                                                            "children": [
                                                                                {
                                                                                    "type": "attribute",
                                                                                    "label": "datetime.now",
                                                                                    "start_token": 1579,
                                                                                    "end_token": 1581,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "label": "datetime",
                                                                                            "start_token": 1579,
                                                                                            "end_token": 1579,
                                                                                            "children": []
                                                                                        },
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "label": "now",
                                                                                            "start_token": 1581,
                                                                                            "end_token": 1581,
                                                                                            "children": []
                                                                                        }
                                                                                    ]
                                                                                },
                                                                                {
                                                                                    "type": "argument_list",
                                                                                    "label": "(timezone.utc)",
                                                                                    "start_token": 1582,
                                                                                    "end_token": 1586,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "attribute",
                                                                                            "label": "timezone.utc",
                                                                                            "start_token": 1583,
                                                                                            "end_token": 1585,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "label": "timezone",
                                                                                                    "start_token": 1583,
                                                                                                    "end_token": 1583,
                                                                                                    "children": []
                                                                                                },
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "label": "utc",
                                                                                                    "start_token": 1585,
                                                                                                    "end_token": 1585,
                                                                                                    "children": []
                                                                                                }
                                                                                            ]
                                                                                        }
                                                                                    ]
                                                                                }
                                                                            ]
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        },
                                                        {
                                                            "type": "expression_statement",
                                                            "label": "valid_state = next(\n                (\n                    state\n                    for state in oauth_states\n                    if state.token == token\n                    and state.provider == provider\n                    and state.expires_at > now.timestamp()\n                ),\n                None,\n            )",
                                                            "start_token": 1588,
                                                            "end_token": 1635,
                                                            "children": [
                                                                {
                                                                    "type": "assignment",
                                                                    "label": "valid_state = next(\n                (\n                    state\n                    for state in oauth_states\n                    if state.token == token\n                    and state.provider == provider\n                    and state.expires_at > now.timestamp()\n                ),\n                None,\n            )",
                                                                    "start_token": 1588,
                                                                    "end_token": 1635,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "valid_state",
                                                                            "start_token": 1588,
                                                                            "end_token": 1588,
                                                                            "children": []
                                                                        },
                                                                        {
                                                                            "type": "call",
                                                                            "label": "next(\n                (\n                    state\n                    for state in oauth_states\n                    if state.token == token\n                    and state.provider == provider\n                    and state.expires_at > now.timestamp()\n                ),\n                None,\n            )",
                                                                            "start_token": 1590,
                                                                            "end_token": 1635,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "next",
                                                                                    "start_token": 1590,
                                                                                    "end_token": 1590,
                                                                                    "children": []
                                                                                },
                                                                                {
                                                                                    "type": "argument_list",
                                                                                    "label": "(\n                (\n                    state\n                    for state in oauth_states\n                    if state.token == token\n                    and state.provider == provider\n                    and state.expires_at > now.timestamp()\n                ),\n                None,\n            )",
                                                                                    "start_token": 1591,
                                                                                    "end_token": 1635,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "generator_expression",
                                                                                            "label": "(\n                    state\n                    for state in oauth_states\n                    if state.token == token\n                    and state.provider == provider\n                    and state.expires_at > now.timestamp()\n                )",
                                                                                            "start_token": 1593,
                                                                                            "end_token": 1629,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "label": "state",
                                                                                                    "start_token": 1595,
                                                                                                    "end_token": 1595,
                                                                                                    "children": []
                                                                                                },
                                                                                                {
                                                                                                    "type": "for_in_clause",
                                                                                                    "label": "for state in oauth_states",
                                                                                                    "start_token": 1597,
                                                                                                    "end_token": 1600,
                                                                                                    "children": [
                                                                                                        {
                                                                                                            "type": "identifier",
                                                                                                            "label": "state",
                                                                                                            "start_token": 1598,
                                                                                                            "end_token": 1598,
                                                                                                            "children": []
                                                                                                        },
                                                                                                        {
                                                                                                            "type": "identifier",
                                                                                                            "label": "oauth_states",
                                                                                                            "start_token": 1600,
                                                                                                            "end_token": 1600,
                                                                                                            "children": []
                                                                                                        }
                                                                                                    ]
                                                                                                },
                                                                                                {
                                                                                                    "type": "if_clause",
                                                                                                    "label": "if state.token == token\n                    and state.provider == provider\n                    and state.expires_at > now.timestamp()",
                                                                                                    "start_token": 1602,
                                                                                                    "end_token": 1627,
                                                                                                    "children": [
                                                                                                        {
                                                                                                            "type": "boolean_operator",
                                                                                                            "label": "state.token == token\n                    and state.provider == provider\n                    and state.expires_at > now.timestamp()",
                                                                                                            "start_token": 1603,
                                                                                                            "end_token": 1627,
                                                                                                            "children": [
                                                                                                                {
                                                                                                                    "type": "boolean_operator",
                                                                                                                    "label": "state.token == token\n                    and state.provider == provider",
                                                                                                                    "start_token": 1603,
                                                                                                                    "end_token": 1616,
                                                                                                                    "children": [
                                                                                                                        {
                                                                                                                            "type": "comparison_operator",
                                                                                                                            "label": "state.token == token",
                                                                                                                            "start_token": 1603,
                                                                                                                            "end_token": 1608,
                                                                                                                            "children": [
                                                                                                                                {
                                                                                                                                    "type": "attribute",
                                                                                                                                    "label": "state.token",
                                                                                                                                    "start_token": 1603,
                                                                                                                                    "end_token": 1605,
                                                                                                                                    "children": [
                                                                                                                                        {
                                                                                                                                            "type": "identifier",
                                                                                                                                            "label": "state",
                                                                                                                                            "start_token": 1603,
                                                                                                                                            "end_token": 1603,
                                                                                                                                            "children": []
                                                                                                                                        },
                                                                                                                                        {
                                                                                                                                            "type": "identifier",
                                                                                                                                            "label": "token",
                                                                                                                                            "start_token": 1605,
                                                                                                                                            "end_token": 1605,
                                                                                                                                            "children": []
                                                                                                                                        }
                                                                                                                                    ]
                                                                                                                                },
                                                                                                                                {
                                                                                                                                    "type": "identifier",
                                                                                                                                    "label": "token",
                                                                                                                                    "start_token": 1608,
                                                                                                                                    "end_token": 1608,
                                                                                                                                    "children": []
                                                                                                                                }
                                                                                                                            ]
                                                                                                                        },
                                                                                                                        {
                                                                                                                            "type": "comparison_operator",
                                                                                                                            "label": "state.provider == provider",
                                                                                                                            "start_token": 1611,
                                                                                                                            "end_token": 1616,
                                                                                                                            "children": [
                                                                                                                                {
                                                                                                                                    "type": "attribute",
                                                                                                                                    "label": "state.provider",
                                                                                                                                    "start_token": 1611,
                                                                                                                                    "end_token": 1613,
                                                                                                                                    "children": [
                                                                                                                                        {
                                                                                                                                            "type": "identifier",
                                                                                                                                            "label": "state",
                                                                                                                                            "start_token": 1611,
                                                                                                                                            "end_token": 1611,
                                                                                                                                            "children": []
                                                                                                                                        },
                                                                                                                                        {
                                                                                                                                            "type": "identifier",
                                                                                                                                            "label": "provider",
                                                                                                                                            "start_token": 1613,
                                                                                                                                            "end_token": 1613,
                                                                                                                                            "children": []
                                                                                                                                        }
                                                                                                                                    ]
                                                                                                                                },
                                                                                                                                {
                                                                                                                                    "type": "identifier",
                                                                                                                                    "label": "provider",
                                                                                                                                    "start_token": 1616,
                                                                                                                                    "end_token": 1616,
                                                                                                                                    "children": []
                                                                                                                                }
                                                                                                                            ]
                                                                                                                        }
                                                                                                                    ]
                                                                                                                },
                                                                                                                {
                                                                                                                    "type": "comparison_operator",
                                                                                                                    "label": "state.expires_at > now.timestamp()",
                                                                                                                    "start_token": 1619,
                                                                                                                    "end_token": 1627,
                                                                                                                    "children": [
                                                                                                                        {
                                                                                                                            "type": "attribute",
                                                                                                                            "label": "state.expires_at",
                                                                                                                            "start_token": 1619,
                                                                                                                            "end_token": 1621,
                                                                                                                            "children": [
                                                                                                                                {
                                                                                                                                    "type": "identifier",
                                                                                                                                    "label": "state",
                                                                                                                                    "start_token": 1619,
                                                                                                                                    "end_token": 1619,
                                                                                                                                    "children": []
                                                                                                                                },
                                                                                                                                {
                                                                                                                                    "type": "identifier",
                                                                                                                                    "label": "expires_at",
                                                                                                                                    "start_token": 1621,
                                                                                                                                    "end_token": 1621,
                                                                                                                                    "children": []
                                                                                                                                }
                                                                                                                            ]
                                                                                                                        },
                                                                                                                        {
                                                                                                                            "type": "call",
                                                                                                                            "label": "now.timestamp()",
                                                                                                                            "start_token": 1623,
                                                                                                                            "end_token": 1627,
                                                                                                                            "children": [
                                                                                                                                {
                                                                                                                                    "type": "attribute",
                                                                                                                                    "label": "now.timestamp",
                                                                                                                                    "start_token": 1623,
                                                                                                                                    "end_token": 1625,
                                                                                                                                    "children": [
                                                                                                                                        {
                                                                                                                                            "type": "identifier",
                                                                                                                                            "label": "now",
                                                                                                                                            "start_token": 1623,
                                                                                                                                            "end_token": 1623,
                                                                                                                                            "children": []
                                                                                                                                        },
                                                                                                                                        {
                                                                                                                                            "type": "identifier",
                                                                                                                                            "label": "timestamp",
                                                                                                                                            "start_token": 1625,
                                                                                                                                            "end_token": 1625,
                                                                                                                                            "children": []
                                                                                                                                        }
                                                                                                                                    ]
                                                                                                                                },
                                                                                                                                {
                                                                                                                                    "type": "argument_list",
                                                                                                                                    "label": "()",
                                                                                                                                    "start_token": 1626,
                                                                                                                                    "end_token": 1627,
                                                                                                                                    "children": []
                                                                                                                                }
                                                                                                                            ]
                                                                                                                        }
                                                                                                                    ]
                                                                                                                }
                                                                                                            ]
                                                                                                        }
                                                                                                    ]
                                                                                                }
                                                                                            ]
                                                                                        },
                                                                                        {
                                                                                            "type": "none",
                                                                                            "label": "None",
                                                                                            "start_token": 1632,
                                                                                            "end_token": 1632,
                                                                                            "children": []
                                                                                        }
                                                                                    ]
                                                                                }
                                                                            ]
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        },
                                                        {
                                                            "type": "if_statement",
                                                            "label": "if valid_state:\n                # Remove the used state\n                oauth_states.remove(valid_state)\n                user_integrations.oauth_states = oauth_states\n                self.db_manager.update_user_integrations(user_id, user_integrations)\n                return True",
                                                            "start_token": 1638,
                                                            "end_token": 1673,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "label": "valid_state",
                                                                    "start_token": 1639,
                                                                    "end_token": 1639,
                                                                    "children": []
                                                                },
                                                                {
                                                                    "type": "comment",
                                                                    "label": "# Remove the used state",
                                                                    "start_token": 1642,
                                                                    "end_token": 1646,
                                                                    "children": []
                                                                },
                                                                {
                                                                    "type": "block",
                                                                    "label": "oauth_states.remove(valid_state)\n                user_integrations.oauth_states = oauth_states\n                self.db_manager.update_user_integrations(user_id, user_integrations)\n                return True",
                                                                    "start_token": 1648,
                                                                    "end_token": 1673,
                                                                    "children": [
                                                                        {
                                                                            "type": "expression_statement",
                                                                            "label": "oauth_states.remove(valid_state)",
                                                                            "start_token": 1648,
                                                                            "end_token": 1653,
                                                                            "children": [
                                                                                {
                                                                                    "type": "call",
                                                                                    "label": "oauth_states.remove(valid_state)",
                                                                                    "start_token": 1648,
                                                                                    "end_token": 1653,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "attribute",
                                                                                            "label": "oauth_states.remove",
                                                                                            "start_token": 1648,
                                                                                            "end_token": 1650,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "label": "oauth_states",
                                                                                                    "start_token": 1648,
                                                                                                    "end_token": 1648,
                                                                                                    "children": []
                                                                                                },
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "label": "remove",
                                                                                                    "start_token": 1650,
                                                                                                    "end_token": 1650,
                                                                                                    "children": []
                                                                                                }
                                                                                            ]
                                                                                        },
                                                                                        {
                                                                                            "type": "argument_list",
                                                                                            "label": "(valid_state)",
                                                                                            "start_token": 1651,
                                                                                            "end_token": 1653,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "label": "valid_state",
                                                                                                    "start_token": 1652,
                                                                                                    "end_token": 1652,
                                                                                                    "children": []
                                                                                                }
                                                                                            ]
                                                                                        }
                                                                                    ]
                                                                                }
                                                                            ]
                                                                        },
                                                                        {
                                                                            "type": "expression_statement",
                                                                            "label": "user_integrations.oauth_states = oauth_states",
                                                                            "start_token": 1655,
                                                                            "end_token": 1659,
                                                                            "children": [
                                                                                {
                                                                                    "type": "assignment",
                                                                                    "label": "user_integrations.oauth_states = oauth_states",
                                                                                    "start_token": 1655,
                                                                                    "end_token": 1659,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "attribute",
                                                                                            "label": "user_integrations.oauth_states",
                                                                                            "start_token": 1655,
                                                                                            "end_token": 1657,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "label": "user_integrations",
                                                                                                    "start_token": 1655,
                                                                                                    "end_token": 1655,
                                                                                                    "children": []
                                                                                                },
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "label": "oauth_states",
                                                                                                    "start_token": 1657,
                                                                                                    "end_token": 1657,
                                                                                                    "children": []
                                                                                                }
                                                                                            ]
                                                                                        },
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "label": "oauth_states",
                                                                                            "start_token": 1659,
                                                                                            "end_token": 1659,
                                                                                            "children": []
                                                                                        }
                                                                                    ]
                                                                                }
                                                                            ]
                                                                        },
                                                                        {
                                                                            "type": "expression_statement",
                                                                            "label": "self.db_manager.update_user_integrations(user_id, user_integrations)",
                                                                            "start_token": 1661,
                                                                            "end_token": 1670,
                                                                            "children": [
                                                                                {
                                                                                    "type": "call",
                                                                                    "label": "self.db_manager.update_user_integrations(user_id, user_integrations)",
                                                                                    "start_token": 1661,
                                                                                    "end_token": 1670,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "attribute",
                                                                                            "label": "self.db_manager.update_user_integrations",
                                                                                            "start_token": 1661,
                                                                                            "end_token": 1665,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "attribute",
                                                                                                    "label": "self.db_manager",
                                                                                                    "start_token": 1661,
                                                                                                    "end_token": 1663,
                                                                                                    "children": [
                                                                                                        {
                                                                                                            "type": "identifier",
                                                                                                            "label": "self",
                                                                                                            "start_token": 1661,
                                                                                                            "end_token": 1661,
                                                                                                            "children": []
                                                                                                        },
                                                                                                        {
                                                                                                            "type": "identifier",
                                                                                                            "label": "db_manager",
                                                                                                            "start_token": 1663,
                                                                                                            "end_token": 1663,
                                                                                                            "children": []
                                                                                                        }
                                                                                                    ]
                                                                                                },
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "label": "update_user_integrations",
                                                                                                    "start_token": 1665,
                                                                                                    "end_token": 1665,
                                                                                                    "children": []
                                                                                                }
                                                                                            ]
                                                                                        },
                                                                                        {
                                                                                            "type": "argument_list",
                                                                                            "label": "(user_id, user_integrations)",
                                                                                            "start_token": 1666,
                                                                                            "end_token": 1670,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "label": "user_id",
                                                                                                    "start_token": 1667,
                                                                                                    "end_token": 1667,
                                                                                                    "children": []
                                                                                                },
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "label": "user_integrations",
                                                                                                    "start_token": 1669,
                                                                                                    "end_token": 1669,
                                                                                                    "children": []
                                                                                                }
                                                                                            ]
                                                                                        }
                                                                                    ]
                                                                                }
                                                                            ]
                                                                        },
                                                                        {
                                                                            "type": "return_statement",
                                                                            "label": "return True",
                                                                            "start_token": 1672,
                                                                            "end_token": 1673,
                                                                            "children": [
                                                                                {
                                                                                    "type": "true",
                                                                                    "label": "True",
                                                                                    "start_token": 1673,
                                                                                    "end_token": 1673,
                                                                                    "children": []
                                                                                }
                                                                            ]
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                }
                                            ]
                                        },
                                        {
                                            "type": "return_statement",
                                            "label": "return False",
                                            "start_token": 1676,
                                            "end_token": 1677,
                                            "children": [
                                                {
                                                    "type": "false",
                                                    "label": "False",
                                                    "start_token": 1677,
                                                    "end_token": 1677,
                                                    "children": []
                                                }
                                            ]
                                        }
                                    ]
                                }
                            ]
                        },
                        {
                            "type": "function_definition",
                            "label": "def _set_user_integration_creds(\n        self, user_id: str, credentials: list[Credentials]\n    ) -> None:\n        integrations = self._get_user_integrations(user_id)\n        # Remove default credentials from the list\n        credentials = [c for c in credentials if c not in DEFAULT_CREDENTIALS]\n        integrations.credentials = credentials\n        self.db_manager.update_user_integrations(user_id, integrations)",
                            "start_token": 1680,
                            "end_token": 1750,
                            "children": [
                                {
                                    "type": "identifier",
                                    "label": "_set_user_integration_creds",
                                    "start_token": 1681,
                                    "end_token": 1681,
                                    "children": []
                                },
                                {
                                    "type": "parameters",
                                    "label": "(\n        self, user_id: str, credentials: list[Credentials]\n    )",
                                    "start_token": 1682,
                                    "end_token": 1697,
                                    "children": [
                                        {
                                            "type": "identifier",
                                            "label": "self",
                                            "start_token": 1684,
                                            "end_token": 1684,
                                            "children": []
                                        },
                                        {
                                            "type": "typed_parameter",
                                            "label": "user_id: str",
                                            "start_token": 1686,
                                            "end_token": 1688,
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "label": "user_id",
                                                    "start_token": 1686,
                                                    "end_token": 1686,
                                                    "children": []
                                                },
                                                {
                                                    "type": "type",
                                                    "label": "str",
                                                    "start_token": 1688,
                                                    "end_token": 1688,
                                                    "children": [
                                                        {
                                                            "type": "identifier",
                                                            "label": "str",
                                                            "start_token": 1688,
                                                            "end_token": 1688,
                                                            "children": []
                                                        }
                                                    ]
                                                }
                                            ]
                                        },
                                        {
                                            "type": "typed_parameter",
                                            "label": "credentials: list[Credentials]",
                                            "start_token": 1690,
                                            "end_token": 1695,
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "label": "credentials",
                                                    "start_token": 1690,
                                                    "end_token": 1690,
                                                    "children": []
                                                },
                                                {
                                                    "type": "type",
                                                    "label": "list[Credentials]",
                                                    "start_token": 1692,
                                                    "end_token": 1695,
                                                    "children": [
                                                        {
                                                            "type": "generic_type",
                                                            "label": "list[Credentials]",
                                                            "start_token": 1692,
                                                            "end_token": 1695,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "label": "list",
                                                                    "start_token": 1692,
                                                                    "end_token": 1692,
                                                                    "children": []
                                                                },
                                                                {
                                                                    "type": "type_parameter",
                                                                    "label": "[Credentials]",
                                                                    "start_token": 1693,
                                                                    "end_token": 1695,
                                                                    "children": [
                                                                        {
                                                                            "type": "type",
                                                                            "label": "Credentials",
                                                                            "start_token": 1694,
                                                                            "end_token": 1694,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "Credentials",
                                                                                    "start_token": 1694,
                                                                                    "end_token": 1694,
                                                                                    "children": []
                                                                                }
                                                                            ]
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                }
                                            ]
                                        }
                                    ]
                                },
                                {
                                    "type": "type",
                                    "label": "None",
                                    "start_token": 1700,
                                    "end_token": 1700,
                                    "children": [
                                        {
                                            "type": "none",
                                            "label": "None",
                                            "start_token": 1700,
                                            "end_token": 1700,
                                            "children": []
                                        }
                                    ]
                                },
                                {
                                    "type": "block",
                                    "label": "integrations = self._get_user_integrations(user_id)\n        # Remove default credentials from the list\n        credentials = [c for c in credentials if c not in DEFAULT_CREDENTIALS]\n        integrations.credentials = credentials\n        self.db_manager.update_user_integrations(user_id, integrations)",
                                    "start_token": 1703,
                                    "end_token": 1750,
                                    "children": [
                                        {
                                            "type": "expression_statement",
                                            "label": "integrations = self._get_user_integrations(user_id)",
                                            "start_token": 1703,
                                            "end_token": 1710,
                                            "children": [
                                                {
                                                    "type": "assignment",
                                                    "label": "integrations = self._get_user_integrations(user_id)",
                                                    "start_token": 1703,
                                                    "end_token": 1710,
                                                    "children": [
                                                        {
                                                            "type": "identifier",
                                                            "label": "integrations",
                                                            "start_token": 1703,
                                                            "end_token": 1703,
                                                            "children": []
                                                        },
                                                        {
                                                            "type": "call",
                                                            "label": "self._get_user_integrations(user_id)",
                                                            "start_token": 1705,
                                                            "end_token": 1710,
                                                            "children": [
                                                                {
                                                                    "type": "attribute",
                                                                    "label": "self._get_user_integrations",
                                                                    "start_token": 1705,
                                                                    "end_token": 1707,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "self",
                                                                            "start_token": 1705,
                                                                            "end_token": 1705,
                                                                            "children": []
                                                                        },
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "_get_user_integrations",
                                                                            "start_token": 1707,
                                                                            "end_token": 1707,
                                                                            "children": []
                                                                        }
                                                                    ]
                                                                },
                                                                {
                                                                    "type": "argument_list",
                                                                    "label": "(user_id)",
                                                                    "start_token": 1708,
                                                                    "end_token": 1710,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "user_id",
                                                                            "start_token": 1709,
                                                                            "end_token": 1709,
                                                                            "children": []
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                }
                                            ]
                                        },
                                        {
                                            "type": "comment",
                                            "label": "# Remove default credentials from the list",
                                            "start_token": 1712,
                                            "end_token": 1718,
                                            "children": []
                                        },
                                        {
                                            "type": "expression_statement",
                                            "label": "credentials = [c for c in credentials if c not in DEFAULT_CREDENTIALS]",
                                            "start_token": 1720,
                                            "end_token": 1733,
                                            "children": [
                                                {
                                                    "type": "assignment",
                                                    "label": "credentials = [c for c in credentials if c not in DEFAULT_CREDENTIALS]",
                                                    "start_token": 1720,
                                                    "end_token": 1733,
                                                    "children": [
                                                        {
                                                            "type": "identifier",
                                                            "label": "credentials",
                                                            "start_token": 1720,
                                                            "end_token": 1720,
                                                            "children": []
                                                        },
                                                        {
                                                            "type": "list_comprehension",
                                                            "label": "[c for c in credentials if c not in DEFAULT_CREDENTIALS]",
                                                            "start_token": 1722,
                                                            "end_token": 1733,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "label": "c",
                                                                    "start_token": 1723,
                                                                    "end_token": 1723,
                                                                    "children": []
                                                                },
                                                                {
                                                                    "type": "for_in_clause",
                                                                    "label": "for c in credentials",
                                                                    "start_token": 1724,
                                                                    "end_token": 1727,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "c",
                                                                            "start_token": 1725,
                                                                            "end_token": 1725,
                                                                            "children": []
                                                                        },
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "credentials",
                                                                            "start_token": 1727,
                                                                            "end_token": 1727,
                                                                            "children": []
                                                                        }
                                                                    ]
                                                                },
                                                                {
                                                                    "type": "if_clause",
                                                                    "label": "if c not in DEFAULT_CREDENTIALS",
                                                                    "start_token": 1728,
                                                                    "end_token": 1732,
                                                                    "children": [
                                                                        {
                                                                            "type": "comparison_operator",
                                                                            "label": "c not in DEFAULT_CREDENTIALS",
                                                                            "start_token": 1729,
                                                                            "end_token": 1732,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "c",
                                                                                    "start_token": 1729,
                                                                                    "end_token": 1729,
                                                                                    "children": []
                                                                                },
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "DEFAULT_CREDENTIALS",
                                                                                    "start_token": 1732,
                                                                                    "end_token": 1732,
                                                                                    "children": []
                                                                                }
                                                                            ]
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                }
                                            ]
                                        },
                                        {
                                            "type": "expression_statement",
                                            "label": "integrations.credentials = credentials",
                                            "start_token": 1735,
                                            "end_token": 1739,
                                            "children": [
                                                {
                                                    "type": "assignment",
                                                    "label": "integrations.credentials = credentials",
                                                    "start_token": 1735,
                                                    "end_token": 1739,
                                                    "children": [
                                                        {
                                                            "type": "attribute",
                                                            "label": "integrations.credentials",
                                                            "start_token": 1735,
                                                            "end_token": 1737,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "label": "integrations",
                                                                    "start_token": 1735,
                                                                    "end_token": 1735,
                                                                    "children": []
                                                                },
                                                                {
                                                                    "type": "identifier",
                                                                    "label": "credentials",
                                                                    "start_token": 1737,
                                                                    "end_token": 1737,
                                                                    "children": []
                                                                }
                                                            ]
                                                        },
                                                        {
                                                            "type": "identifier",
                                                            "label": "credentials",
                                                            "start_token": 1739,
                                                            "end_token": 1739,
                                                            "children": []
                                                        }
                                                    ]
                                                }
                                            ]
                                        },
                                        {
                                            "type": "expression_statement",
                                            "label": "self.db_manager.update_user_integrations(user_id, integrations)",
                                            "start_token": 1741,
                                            "end_token": 1750,
                                            "children": [
                                                {
                                                    "type": "call",
                                                    "label": "self.db_manager.update_user_integrations(user_id, integrations)",
                                                    "start_token": 1741,
                                                    "end_token": 1750,
                                                    "children": [
                                                        {
                                                            "type": "attribute",
                                                            "label": "self.db_manager.update_user_integrations",
                                                            "start_token": 1741,
                                                            "end_token": 1745,
                                                            "children": [
                                                                {
                                                                    "type": "attribute",
                                                                    "label": "self.db_manager",
                                                                    "start_token": 1741,
                                                                    "end_token": 1743,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "self",
                                                                            "start_token": 1741,
                                                                            "end_token": 1741,
                                                                            "children": []
                                                                        },
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "db_manager",
                                                                            "start_token": 1743,
                                                                            "end_token": 1743,
                                                                            "children": []
                                                                        }
                                                                    ]
                                                                },
                                                                {
                                                                    "type": "identifier",
                                                                    "label": "update_user_integrations",
                                                                    "start_token": 1745,
                                                                    "end_token": 1745,
                                                                    "children": []
                                                                }
                                                            ]
                                                        },
                                                        {
                                                            "type": "argument_list",
                                                            "label": "(user_id, integrations)",
                                                            "start_token": 1746,
                                                            "end_token": 1750,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "label": "user_id",
                                                                    "start_token": 1747,
                                                                    "end_token": 1747,
                                                                    "children": []
                                                                },
                                                                {
                                                                    "type": "identifier",
                                                                    "label": "integrations",
                                                                    "start_token": 1749,
                                                                    "end_token": 1749,
                                                                    "children": []
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                }
                                            ]
                                        }
                                    ]
                                }
                            ]
                        },
                        {
                            "type": "function_definition",
                            "label": "def _get_user_integrations(self, user_id: str) -> UserIntegrations:\n        integrations: UserIntegrations = self.db_manager.get_user_integrations(\n            user_id=user_id\n        )\n        return integrations",
                            "start_token": 1753,
                            "end_token": 1785,
                            "children": [
                                {
                                    "type": "identifier",
                                    "label": "_get_user_integrations",
                                    "start_token": 1754,
                                    "end_token": 1754,
                                    "children": []
                                },
                                {
                                    "type": "parameters",
                                    "label": "(self, user_id: str)",
                                    "start_token": 1755,
                                    "end_token": 1761,
                                    "children": [
                                        {
                                            "type": "identifier",
                                            "label": "self",
                                            "start_token": 1756,
                                            "end_token": 1756,
                                            "children": []
                                        },
                                        {
                                            "type": "typed_parameter",
                                            "label": "user_id: str",
                                            "start_token": 1758,
                                            "end_token": 1760,
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "label": "user_id",
                                                    "start_token": 1758,
                                                    "end_token": 1758,
                                                    "children": []
                                                },
                                                {
                                                    "type": "type",
                                                    "label": "str",
                                                    "start_token": 1760,
                                                    "end_token": 1760,
                                                    "children": [
                                                        {
                                                            "type": "identifier",
                                                            "label": "str",
                                                            "start_token": 1760,
                                                            "end_token": 1760,
                                                            "children": []
                                                        }
                                                    ]
                                                }
                                            ]
                                        }
                                    ]
                                },
                                {
                                    "type": "type",
                                    "label": "UserIntegrations",
                                    "start_token": 1764,
                                    "end_token": 1764,
                                    "children": [
                                        {
                                            "type": "identifier",
                                            "label": "UserIntegrations",
                                            "start_token": 1764,
                                            "end_token": 1764,
                                            "children": []
                                        }
                                    ]
                                },
                                {
                                    "type": "block",
                                    "label": "integrations: UserIntegrations = self.db_manager.get_user_integrations(\n            user_id=user_id\n        )\n        return integrations",
                                    "start_token": 1767,
                                    "end_token": 1785,
                                    "children": [
                                        {
                                            "type": "expression_statement",
                                            "label": "integrations: UserIntegrations = self.db_manager.get_user_integrations(\n            user_id=user_id\n        )",
                                            "start_token": 1767,
                                            "end_token": 1782,
                                            "children": [
                                                {
                                                    "type": "assignment",
                                                    "label": "integrations: UserIntegrations = self.db_manager.get_user_integrations(\n            user_id=user_id\n        )",
                                                    "start_token": 1767,
                                                    "end_token": 1782,
                                                    "children": [
                                                        {
                                                            "type": "identifier",
                                                            "label": "integrations",
                                                            "start_token": 1767,
                                                            "end_token": 1767,
                                                            "children": []
                                                        },
                                                        {
                                                            "type": "type",
                                                            "label": "UserIntegrations",
                                                            "start_token": 1769,
                                                            "end_token": 1769,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "label": "UserIntegrations",
                                                                    "start_token": 1769,
                                                                    "end_token": 1769,
                                                                    "children": []
                                                                }
                                                            ]
                                                        },
                                                        {
                                                            "type": "call",
                                                            "label": "self.db_manager.get_user_integrations(\n            user_id=user_id\n        )",
                                                            "start_token": 1771,
                                                            "end_token": 1782,
                                                            "children": [
                                                                {
                                                                    "type": "attribute",
                                                                    "label": "self.db_manager.get_user_integrations",
                                                                    "start_token": 1771,
                                                                    "end_token": 1775,
                                                                    "children": [
                                                                        {
                                                                            "type": "attribute",
                                                                            "label": "self.db_manager",
                                                                            "start_token": 1771,
                                                                            "end_token": 1773,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "self",
                                                                                    "start_token": 1771,
                                                                                    "end_token": 1771,
                                                                                    "children": []
                                                                                },
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "db_manager",
                                                                                    "start_token": 1773,
                                                                                    "end_token": 1773,
                                                                                    "children": []
                                                                                }
                                                                            ]
                                                                        },
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "get_user_integrations",
                                                                            "start_token": 1775,
                                                                            "end_token": 1775,
                                                                            "children": []
                                                                        }
                                                                    ]
                                                                },
                                                                {
                                                                    "type": "argument_list",
                                                                    "label": "(\n            user_id=user_id\n        )",
                                                                    "start_token": 1776,
                                                                    "end_token": 1782,
                                                                    "children": [
                                                                        {
                                                                            "type": "keyword_argument",
                                                                            "label": "user_id=user_id",
                                                                            "start_token": 1778,
                                                                            "end_token": 1780,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "user_id",
                                                                                    "start_token": 1778,
                                                                                    "end_token": 1778,
                                                                                    "children": []
                                                                                },
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "user_id",
                                                                                    "start_token": 1780,
                                                                                    "end_token": 1780,
                                                                                    "children": []
                                                                                }
                                                                            ]
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                }
                                            ]
                                        },
                                        {
                                            "type": "return_statement",
                                            "label": "return integrations",
                                            "start_token": 1784,
                                            "end_token": 1785,
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "label": "integrations",
                                                    "start_token": 1785,
                                                    "end_token": 1785,
                                                    "children": []
                                                }
                                            ]
                                        }
                                    ]
                                }
                            ]
                        },
                        {
                            "type": "function_definition",
                            "label": "def locked_user_integrations(self, user_id: str):\n        key = (f\"user:{user_id}\", \"integrations\")\n        return self.locks.locked(key)",
                            "start_token": 1788,
                            "end_token": 1816,
                            "children": [
                                {
                                    "type": "identifier",
                                    "label": "locked_user_integrations",
                                    "start_token": 1789,
                                    "end_token": 1789,
                                    "children": []
                                },
                                {
                                    "type": "parameters",
                                    "label": "(self, user_id: str)",
                                    "start_token": 1790,
                                    "end_token": 1796,
                                    "children": [
                                        {
                                            "type": "identifier",
                                            "label": "self",
                                            "start_token": 1791,
                                            "end_token": 1791,
                                            "children": []
                                        },
                                        {
                                            "type": "typed_parameter",
                                            "label": "user_id: str",
                                            "start_token": 1793,
                                            "end_token": 1795,
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "label": "user_id",
                                                    "start_token": 1793,
                                                    "end_token": 1793,
                                                    "children": []
                                                },
                                                {
                                                    "type": "type",
                                                    "label": "str",
                                                    "start_token": 1795,
                                                    "end_token": 1795,
                                                    "children": [
                                                        {
                                                            "type": "identifier",
                                                            "label": "str",
                                                            "start_token": 1795,
                                                            "end_token": 1795,
                                                            "children": []
                                                        }
                                                    ]
                                                }
                                            ]
                                        }
                                    ]
                                },
                                {
                                    "type": "block",
                                    "label": "key = (f\"user:{user_id}\", \"integrations\")\n        return self.locks.locked(key)",
                                    "start_token": 1799,
                                    "end_token": 1816,
                                    "children": [
                                        {
                                            "type": "expression_statement",
                                            "label": "key = (f\"user:{user_id}\", \"integrations\")",
                                            "start_token": 1799,
                                            "end_token": 1806,
                                            "children": [
                                                {
                                                    "type": "assignment",
                                                    "label": "key = (f\"user:{user_id}\", \"integrations\")",
                                                    "start_token": 1799,
                                                    "end_token": 1806,
                                                    "children": [
                                                        {
                                                            "type": "identifier",
                                                            "label": "key",
                                                            "start_token": 1799,
                                                            "end_token": 1799,
                                                            "children": []
                                                        },
                                                        {
                                                            "type": "tuple",
                                                            "label": "(f\"user:{user_id}\", \"integrations\")",
                                                            "start_token": 1801,
                                                            "end_token": 1806,
                                                            "children": [
                                                                {
                                                                    "type": "string",
                                                                    "label": "f\"user:{user_id}\"",
                                                                    "start_token": 1802,
                                                                    "end_token": 1803,
                                                                    "children": [
                                                                        {
                                                                            "type": "string_start",
                                                                            "label": "f\"",
                                                                            "start_token": 1802,
                                                                            "end_token": 1803,
                                                                            "children": []
                                                                        },
                                                                        {
                                                                            "type": "string_content",
                                                                            "label": "user:",
                                                                            "start_token": 1803,
                                                                            "end_token": 1803,
                                                                            "children": []
                                                                        },
                                                                        {
                                                                            "type": "interpolation",
                                                                            "label": "{user_id}",
                                                                            "start_token": 1803,
                                                                            "end_token": 1803,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "user_id",
                                                                                    "start_token": 1803,
                                                                                    "end_token": 1803,
                                                                                    "children": []
                                                                                }
                                                                            ]
                                                                        },
                                                                        {
                                                                            "type": "string_end",
                                                                            "label": "\"",
                                                                            "start_token": 1803,
                                                                            "end_token": 1803,
                                                                            "children": []
                                                                        }
                                                                    ]
                                                                },
                                                                {
                                                                    "type": "string",
                                                                    "label": "\"integrations\"",
                                                                    "start_token": 1805,
                                                                    "end_token": 1805,
                                                                    "children": [
                                                                        {
                                                                            "type": "string_start",
                                                                            "label": "\"",
                                                                            "start_token": 1805,
                                                                            "end_token": 1805,
                                                                            "children": []
                                                                        },
                                                                        {
                                                                            "type": "string_content",
                                                                            "label": "integrations",
                                                                            "start_token": 1805,
                                                                            "end_token": 1805,
                                                                            "children": []
                                                                        },
                                                                        {
                                                                            "type": "string_end",
                                                                            "label": "\"",
                                                                            "start_token": 1805,
                                                                            "end_token": 1805,
                                                                            "children": []
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                }
                                            ]
                                        },
                                        {
                                            "type": "return_statement",
                                            "label": "return self.locks.locked(key)",
                                            "start_token": 1808,
                                            "end_token": 1816,
                                            "children": [
                                                {
                                                    "type": "call",
                                                    "label": "self.locks.locked(key)",
                                                    "start_token": 1809,
                                                    "end_token": 1816,
                                                    "children": [
                                                        {
                                                            "type": "attribute",
                                                            "label": "self.locks.locked",
                                                            "start_token": 1809,
                                                            "end_token": 1813,
                                                            "children": [
                                                                {
                                                                    "type": "attribute",
                                                                    "label": "self.locks",
                                                                    "start_token": 1809,
                                                                    "end_token": 1811,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "self",
                                                                            "start_token": 1809,
                                                                            "end_token": 1809,
                                                                            "children": []
                                                                        },
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "locks",
                                                                            "start_token": 1811,
                                                                            "end_token": 1811,
                                                                            "children": []
                                                                        }
                                                                    ]
                                                                },
                                                                {
                                                                    "type": "identifier",
                                                                    "label": "locked",
                                                                    "start_token": 1813,
                                                                    "end_token": 1813,
                                                                    "children": []
                                                                }
                                                            ]
                                                        },
                                                        {
                                                            "type": "argument_list",
                                                            "label": "(key)",
                                                            "start_token": 1814,
                                                            "end_token": 1816,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "label": "key",
                                                                    "start_token": 1815,
                                                                    "end_token": 1815,
                                                                    "children": []
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                }
                                            ]
                                        }
                                    ]
                                }
                            ]
                        }
                    ]
                }
            ]
        }
    ]
}
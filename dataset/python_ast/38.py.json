{
    "type": "module",
    "label": "import asyncio\nimport logging\nimport uuid\nfrom collections import defaultdict\nfrom datetime import datetime, timezone\nfrom typing import Any, Literal, Optional, Type\n\nimport prisma\nfrom prisma.models import AgentGraph, AgentGraphExecution, AgentNode, AgentNodeLink\nfrom prisma.types import AgentGraphWhereInput\nfrom pydantic.fields import computed_field\n\nfrom backend.blocks.agent import AgentExecutorBlock\nfrom backend.blocks.basic import AgentInputBlock, AgentOutputBlock\nfrom backend.util import json\n\nfrom .block import BlockInput, BlockType, get_block, get_blocks\nfrom .db import BaseDbModel, transaction\nfrom .execution import ExecutionStatus\nfrom .includes import AGENT_GRAPH_INCLUDE, AGENT_NODE_INCLUDE\nfrom .integrations import Webhook\n\nlogger = logging.getLogger(__name__)\n\n\nclass Link(BaseDbModel):\n    source_id: str\n    sink_id: str\n    source_name: str\n    sink_name: str\n    is_static: bool = False\n\n    @staticmethod\n    def from_db(link: AgentNodeLink):\n        return Link(\n            id=link.id,\n            source_name=link.sourceName,\n            source_id=link.agentNodeSourceId,\n            sink_name=link.sinkName,\n            sink_id=link.agentNodeSinkId,\n            is_static=link.isStatic,\n        )\n\n    def __hash__(self):\n        return hash((self.source_id, self.sink_id, self.source_name, self.sink_name))\n\n\nclass Node(BaseDbModel):\n    block_id: str\n    input_default: BlockInput = {}  # dict[input_name, default_value]\n    metadata: dict[str, Any] = {}\n    input_links: list[Link] = []\n    output_links: list[Link] = []\n\n    webhook_id: Optional[str] = None\n\n\nclass NodeModel(Node):\n    graph_id: str\n    graph_version: int\n\n    webhook: Optional[Webhook] = None\n\n    @staticmethod\n    def from_db(node: AgentNode):\n        if not node.AgentBlock:\n            raise ValueError(f\"Invalid node {node.id}, invalid AgentBlock.\")\n        obj = NodeModel(\n            id=node.id,\n            block_id=node.AgentBlock.id,\n            input_default=json.loads(node.constantInput, target_type=dict[str, Any]),\n            metadata=json.loads(node.metadata, target_type=dict[str, Any]),\n            graph_id=node.agentGraphId,\n            graph_version=node.agentGraphVersion,\n            webhook_id=node.webhookId,\n            webhook=Webhook.from_db(node.Webhook) if node.Webhook else None,\n        )\n        obj.input_links = [Link.from_db(link) for link in node.Input or []]\n        obj.output_links = [Link.from_db(link) for link in node.Output or []]\n        return obj\n\n    def is_triggered_by_event_type(self, event_type: str) -> bool:\n        if not (block := get_block(self.block_id)):\n            raise ValueError(f\"Block #{self.block_id} not found for node #{self.id}\")\n        if not block.webhook_config:\n            raise TypeError(\"This method can't be used on non-webhook blocks\")\n        if not block.webhook_config.event_filter_input:\n            return True\n        event_filter = self.input_default.get(block.webhook_config.event_filter_input)\n        if not event_filter:\n            raise ValueError(f\"Event filter is not configured on node #{self.id}\")\n        return event_type in [\n            block.webhook_config.event_format.format(event=k)\n            for k in event_filter\n            if event_filter[k] is True\n        ]\n\n\n# Fix 2-way reference Node <-> Webhook\nWebhook.model_rebuild()\n\n\nclass GraphExecution(BaseDbModel):\n    execution_id: str\n    started_at: datetime\n    ended_at: datetime\n    duration: float\n    total_run_time: float\n    status: ExecutionStatus\n    graph_id: str\n    graph_version: int\n\n    @staticmethod\n    def from_db(execution: AgentGraphExecution):\n        now = datetime.now(timezone.utc)\n        start_time = execution.startedAt or execution.createdAt\n        end_time = execution.updatedAt or now\n        duration = (end_time - start_time).total_seconds()\n        total_run_time = duration\n\n        try:\n            stats = json.loads(execution.stats or \"{}\", target_type=dict[str, Any])\n        except ValueError:\n            stats = {}\n\n        duration = stats.get(\"walltime\", duration)\n        total_run_time = stats.get(\"nodes_walltime\", total_run_time)\n\n        return GraphExecution(\n            id=execution.id,\n            execution_id=execution.id,\n            started_at=start_time,\n            ended_at=end_time,\n            duration=duration,\n            total_run_time=total_run_time,\n            status=ExecutionStatus(execution.executionStatus),\n            graph_id=execution.agentGraphId,\n            graph_version=execution.agentGraphVersion,\n        )\n\n\nclass Graph(BaseDbModel):\n    version: int = 1\n    is_active: bool = True\n    is_template: bool = False\n    name: str\n    description: str\n    nodes: list[Node] = []\n    links: list[Link] = []\n\n    @computed_field\n    @property\n    def input_schema(self) -> dict[str, Any]:\n        return self._generate_schema(\n            AgentInputBlock.Input,\n            [\n                node.input_default\n                for node in self.nodes\n                if (b := get_block(node.block_id))\n                and b.block_type == BlockType.INPUT\n                and \"name\" in node.input_default\n            ],\n        )\n\n    @computed_field\n    @property\n    def output_schema(self) -> dict[str, Any]:\n        return self._generate_schema(\n            AgentOutputBlock.Input,\n            [\n                node.input_default\n                for node in self.nodes\n                if (b := get_block(node.block_id))\n                and b.block_type == BlockType.OUTPUT\n                and \"name\" in node.input_default\n            ],\n        )\n\n    @staticmethod\n    def _generate_schema(\n        type_class: Type[AgentInputBlock.Input] | Type[AgentOutputBlock.Input],\n        data: list[dict],\n    ) -> dict[str, Any]:\n        props = []\n        for p in data:\n            try:\n                props.append(type_class(**p))\n            except Exception as e:\n                logger.warning(f\"Invalid {type_class}: {p}, {e}\")\n\n        return {\n            \"type\": \"object\",\n            \"properties\": {\n                p.name: {\n                    \"secret\": p.secret,\n                    \"advanced\": p.advanced,\n                    \"title\": p.title or p.name,\n                    **({\"description\": p.description} if p.description else {}),\n                    **({\"default\": p.value} if p.value is not None else {}),\n                }\n                for p in props\n            },\n            \"required\": [p.name for p in props if p.value is None],\n        }\n\n\nclass GraphModel(Graph):\n    user_id: str\n    nodes: list[NodeModel] = []  # type: ignore\n\n    @property\n    def starting_nodes(self) -> list[Node]:\n        outbound_nodes = {link.sink_id for link in self.links}\n        input_nodes = {\n            v.id\n            for v in self.nodes\n            if (b := get_block(v.block_id)) and b.block_type == BlockType.INPUT\n        }\n        return [\n            node\n            for node in self.nodes\n            if node.id not in outbound_nodes or node.id in input_nodes\n        ]\n\n    def reassign_ids(self, user_id: str, reassign_graph_id: bool = False):\n        \"\"\"\n        Reassigns all IDs in the graph to new UUIDs.\n        This method can be used before storing a new graph to the database.\n        \"\"\"\n\n        # Reassign Graph ID\n        id_map = {node.id: str(uuid.uuid4()) for node in self.nodes}\n        if reassign_graph_id:\n            self.id = str(uuid.uuid4())\n\n        # Reassign Node IDs\n        for node in self.nodes:\n            node.id = id_map[node.id]\n\n        # Reassign Link IDs\n        for link in self.links:\n            link.source_id = id_map[link.source_id]\n            link.sink_id = id_map[link.sink_id]\n\n        # Reassign User IDs for agent blocks\n        for node in self.nodes:\n            if node.block_id != AgentExecutorBlock().id:\n                continue\n            node.input_default[\"user_id\"] = user_id\n            node.input_default.setdefault(\"data\", {})\n\n        self.validate_graph()\n\n    def validate_graph(self, for_run: bool = False):\n        def sanitize(name):\n            return name.split(\"_#_\")[0].split(\"_@_\")[0].split(\"_$_\")[0]\n\n        input_links = defaultdict(list)\n        for link in self.links:\n            input_links[link.sink_id].append(link)\n\n        # Nodes: required fields are filled or connected and dependencies are satisfied\n        for node in self.nodes:\n            block = get_block(node.block_id)\n            if block is None:\n                raise ValueError(f\"Invalid block {node.block_id} for node #{node.id}\")\n\n            provided_inputs = set(\n                [sanitize(name) for name in node.input_default]\n                + [sanitize(link.sink_name) for link in input_links.get(node.id, [])]\n            )\n            for name in block.input_schema.get_required_fields():\n                if (\n                    name not in provided_inputs\n                    and not (\n                        name == \"payload\"\n                        and block.block_type\n                        in (BlockType.WEBHOOK, BlockType.WEBHOOK_MANUAL)\n                    )\n                    and (\n                        for_run  # Skip input completion validation, unless when executing.\n                        or block.block_type == BlockType.INPUT\n                        or block.block_type == BlockType.OUTPUT\n                        or block.block_type == BlockType.AGENT\n                    )\n                ):\n                    raise ValueError(\n                        f\"Node {block.name} #{node.id} required input missing: `{name}`\"\n                    )\n\n            # Get input schema properties and check dependencies\n            input_schema = block.input_schema.model_fields\n            required_fields = block.input_schema.get_required_fields()\n\n            def has_value(name):\n                return (\n                    node is not None\n                    and name in node.input_default\n                    and node.input_default[name] is not None\n                    and str(node.input_default[name]).strip() != \"\"\n                ) or (name in input_schema and input_schema[name].default is not None)\n\n            # Validate dependencies between fields\n            for field_name, field_info in input_schema.items():\n                # Apply input dependency validation only on run & field with depends_on\n                json_schema_extra = field_info.json_schema_extra or {}\n                dependencies = json_schema_extra.get(\"depends_on\", [])\n                if not for_run or not dependencies:\n                    continue\n\n                # Check if dependent field has value in input_default\n                field_has_value = has_value(field_name)\n                field_is_required = field_name in required_fields\n\n                # Check for missing dependencies when dependent field is present\n                missing_deps = [dep for dep in dependencies if not has_value(dep)]\n                if missing_deps and (field_has_value or field_is_required):\n                    raise ValueError(\n                        f\"Node {block.name} #{node.id}: Field `{field_name}` requires [{', '.join(missing_deps)}] to be set\"\n                    )\n\n        node_map = {v.id: v for v in self.nodes}\n\n        def is_static_output_block(nid: str) -> bool:\n            bid = node_map[nid].block_id\n            b = get_block(bid)\n            return b.static_output if b else False\n\n        # Links: links are connected and the connected pin data type are compatible.\n        for link in self.links:\n            source = (link.source_id, link.source_name)\n            sink = (link.sink_id, link.sink_name)\n            suffix = f\"Link {source} <-> {sink}\"\n\n            for i, (node_id, name) in enumerate([source, sink]):\n                node = node_map.get(node_id)\n                if not node:\n                    raise ValueError(\n                        f\"{suffix}, {node_id} is invalid node id, available nodes: {node_map.keys()}\"\n                    )\n\n                block = get_block(node.block_id)\n                if not block:\n                    blocks = {v().id: v().name for v in get_blocks().values()}\n                    raise ValueError(\n                        f\"{suffix}, {node.block_id} is invalid block id, available blocks: {blocks}\"\n                    )\n\n                sanitized_name = sanitize(name)\n                vals = node.input_default\n                if i == 0:\n                    fields = (\n                        block.output_schema.get_fields()\n                        if block.block_type != BlockType.AGENT\n                        else vals.get(\"output_schema\", {}).get(\"properties\", {}).keys()\n                    )\n                else:\n                    fields = (\n                        block.input_schema.get_fields()\n                        if block.block_type != BlockType.AGENT\n                        else vals.get(\"input_schema\", {}).get(\"properties\", {}).keys()\n                    )\n                if sanitized_name not in fields:\n                    fields_msg = f\"Allowed fields: {fields}\"\n                    raise ValueError(f\"{suffix}, `{name}` invalid, {fields_msg}\")\n\n            if is_static_output_block(link.source_id):\n                link.is_static = True  # Each value block output should be static.\n\n    @staticmethod\n    def from_db(graph: AgentGraph, for_export: bool = False):\n        return GraphModel(\n            id=graph.id,\n            user_id=graph.userId,\n            version=graph.version,\n            is_active=graph.isActive,\n            is_template=graph.isTemplate,\n            name=graph.name or \"\",\n            description=graph.description or \"\",\n            nodes=[\n                NodeModel.from_db(GraphModel._process_node(node, for_export))\n                for node in graph.AgentNodes or []\n            ],\n            links=list(\n                {\n                    Link.from_db(link)\n                    for node in graph.AgentNodes or []\n                    for link in (node.Input or []) + (node.Output or [])\n                }\n            ),\n        )\n\n    @staticmethod\n    def _process_node(node: AgentNode, for_export: bool) -> AgentNode:\n        if for_export:\n            # Remove credentials from node input\n            if node.constantInput:\n                constant_input = json.loads(\n                    node.constantInput, target_type=dict[str, Any]\n                )\n                constant_input = GraphModel._hide_node_input_credentials(constant_input)\n                node.constantInput = json.dumps(constant_input)\n\n            # Remove webhook info\n            node.webhookId = None\n            node.Webhook = None\n\n        return node\n\n    @staticmethod\n    def _hide_node_input_credentials(input_data: dict[str, Any]) -> dict[str, Any]:\n        sensitive_keys = [\"credentials\", \"api_key\", \"password\", \"token\", \"secret\"]\n        result = {}\n        for key, value in input_data.items():\n            if isinstance(value, dict):\n                result[key] = GraphModel._hide_node_input_credentials(value)\n            elif isinstance(value, str) and any(\n                sensitive_key in key.lower() for sensitive_key in sensitive_keys\n            ):\n                # Skip this key-value pair in the result\n                continue\n            else:\n                result[key] = value\n        return result\n\n\n# --------------------- CRUD functions --------------------- #\n\n\nasync def get_node(node_id: str) -> NodeModel:\n    node = await AgentNode.prisma().find_unique_or_raise(\n        where={\"id\": node_id},\n        include=AGENT_NODE_INCLUDE,\n    )\n    return NodeModel.from_db(node)\n\n\nasync def set_node_webhook(node_id: str, webhook_id: str | None) -> NodeModel:\n    node = await AgentNode.prisma().update(\n        where={\"id\": node_id},\n        data=(\n            {\"Webhook\": {\"connect\": {\"id\": webhook_id}}}\n            if webhook_id\n            else {\"Webhook\": {\"disconnect\": True}}\n        ),\n        include=AGENT_NODE_INCLUDE,\n    )\n    if not node:\n        raise ValueError(f\"Node #{node_id} not found\")\n    return NodeModel.from_db(node)\n\n\nasync def get_graphs(\n    user_id: str,\n    filter_by: Literal[\"active\", \"template\"] | None = \"active\",\n) -> list[GraphModel]:\n    \"\"\"\n    Retrieves graph metadata objects.\n    Default behaviour is to get all currently active graphs.\n\n    Args:\n        filter_by: An optional filter to either select templates or active graphs.\n        user_id: The ID of the user that owns the graph.\n\n    Returns:\n        list[GraphModel]: A list of objects representing the retrieved graphs.\n    \"\"\"\n    where_clause: AgentGraphWhereInput = {\"userId\": user_id}\n\n    if filter_by == \"active\":\n        where_clause[\"isActive\"] = True\n    elif filter_by == \"template\":\n        where_clause[\"isTemplate\"] = True\n\n    graphs = await AgentGraph.prisma().find_many(\n        where=where_clause,\n        distinct=[\"id\"],\n        order={\"version\": \"desc\"},\n        include=AGENT_GRAPH_INCLUDE,\n    )\n\n    graph_models = []\n    for graph in graphs:\n        try:\n            graph_models.append(GraphModel.from_db(graph))\n        except Exception as e:\n            logger.error(f\"Error processing graph {graph.id}: {e}\")\n            continue\n\n    return graph_models\n\n\nasync def get_executions(user_id: str) -> list[GraphExecution]:\n    executions = await AgentGraphExecution.prisma().find_many(\n        where={\"userId\": user_id},\n        order={\"createdAt\": \"desc\"},\n    )\n    return [GraphExecution.from_db(execution) for execution in executions]\n\n\nasync def get_execution(user_id: str, execution_id: str) -> GraphExecution | None:\n    execution = await AgentGraphExecution.prisma().find_first(\n        where={\"id\": execution_id, \"userId\": user_id}\n    )\n    return GraphExecution.from_db(execution) if execution else None\n\n\nasync def get_graph(\n    graph_id: str,\n    version: int | None = None,\n    template: bool = False,\n    user_id: str | None = None,\n    for_export: bool = False,\n) -> GraphModel | None:\n    \"\"\"\n    Retrieves a graph from the DB.\n    Defaults to the version with `is_active` if `version` is not passed,\n    or the latest version with `is_template` if `template=True`.\n\n    Returns `None` if the record is not found.\n    \"\"\"\n    where_clause: AgentGraphWhereInput = {\n        \"id\": graph_id,\n    }\n    if version is not None:\n        where_clause[\"version\"] = version\n    elif not template:\n        where_clause[\"isActive\"] = True\n\n    # TODO: Fix hack workaround to get adding store agents to work\n    if user_id is not None and not template:\n        where_clause[\"userId\"] = user_id\n\n    graph = await AgentGraph.prisma().find_first(\n        where=where_clause,\n        include=AGENT_GRAPH_INCLUDE,\n        order={\"version\": \"desc\"},\n    )\n    return GraphModel.from_db(graph, for_export) if graph else None\n\n\nasync def set_graph_active_version(graph_id: str, version: int, user_id: str) -> None:\n    # Activate the requested version if it exists and is owned by the user.\n    updated_count = await AgentGraph.prisma().update_many(\n        data={\"isActive\": True},\n        where={\n            \"id\": graph_id,\n            \"version\": version,\n            \"userId\": user_id,\n        },\n    )\n    if updated_count == 0:\n        raise Exception(f\"Graph #{graph_id} v{version} not found or not owned by user\")\n\n    # Deactivate all other versions.\n    await AgentGraph.prisma().update_many(\n        data={\"isActive\": False},\n        where={\n            \"id\": graph_id,\n            \"version\": {\"not\": version},\n            \"userId\": user_id,\n            \"isActive\": True,\n        },\n    )\n\n\nasync def get_graph_all_versions(graph_id: str, user_id: str) -> list[GraphModel]:\n    graph_versions = await AgentGraph.prisma().find_many(\n        where={\"id\": graph_id, \"userId\": user_id},\n        order={\"version\": \"desc\"},\n        include=AGENT_GRAPH_INCLUDE,\n    )\n\n    if not graph_versions:\n        return []\n\n    return [GraphModel.from_db(graph) for graph in graph_versions]\n\n\nasync def delete_graph(graph_id: str, user_id: str) -> int:\n    entries_count = await AgentGraph.prisma().delete_many(\n        where={\"id\": graph_id, \"userId\": user_id}\n    )\n    if entries_count:\n        logger.info(f\"Deleted {entries_count} graph entries for Graph #{graph_id}\")\n    return entries_count\n\n\nasync def create_graph(graph: Graph, user_id: str) -> GraphModel:\n    async with transaction() as tx:\n        await __create_graph(tx, graph, user_id)\n\n    if created_graph := await get_graph(\n        graph.id, graph.version, graph.is_template, user_id=user_id\n    ):\n        return created_graph\n\n    raise ValueError(f\"Created graph {graph.id} v{graph.version} is not in DB\")\n\n\nasync def __create_graph(tx, graph: Graph, user_id: str):\n    await AgentGraph.prisma(tx).create(\n        data={\n            \"id\": graph.id,\n            \"version\": graph.version,\n            \"name\": graph.name,\n            \"description\": graph.description,\n            \"isTemplate\": graph.is_template,\n            \"isActive\": graph.is_active,\n            \"userId\": user_id,\n        }\n    )\n\n    await asyncio.gather(\n        *[\n            AgentNode.prisma(tx).create(\n                {\n                    \"id\": node.id,\n                    \"agentBlockId\": node.block_id,\n                    \"agentGraphId\": graph.id,\n                    \"agentGraphVersion\": graph.version,\n                    \"constantInput\": json.dumps(node.input_default),\n                    \"metadata\": json.dumps(node.metadata),\n                }\n            )\n            for node in graph.nodes\n        ]\n    )\n\n    await asyncio.gather(\n        *[\n            AgentNodeLink.prisma(tx).create(\n                {\n                    \"id\": str(uuid.uuid4()),\n                    \"sourceName\": link.source_name,\n                    \"sinkName\": link.sink_name,\n                    \"agentNodeSourceId\": link.source_id,\n                    \"agentNodeSinkId\": link.sink_id,\n                    \"isStatic\": link.is_static,\n                }\n            )\n            for link in graph.links\n        ]\n    )\n\n\n# ------------------------ UTILITIES ------------------------ #\n\n\ndef make_graph_model(creatable_graph: Graph, user_id: str) -> GraphModel:\n    \"\"\"\n    Convert a Graph to a GraphModel, setting graph_id and graph_version on all nodes.\n\n    Args:\n        creatable_graph (Graph): The creatable graph to convert.\n        user_id (str): The ID of the user creating the graph.\n\n    Returns:\n        GraphModel: The converted Graph object.\n    \"\"\"\n    # Create a new Graph object, inheriting properties from CreatableGraph\n    return GraphModel(\n        **creatable_graph.model_dump(exclude={\"nodes\"}),\n        user_id=user_id,\n        nodes=[\n            NodeModel(\n                **creatable_node.model_dump(),\n                graph_id=creatable_graph.id,\n                graph_version=creatable_graph.version,\n            )\n            for creatable_node in creatable_graph.nodes\n        ],\n    )\n\n\nasync def fix_llm_provider_credentials():\n    \"\"\"Fix node credentials with provider `llm`\"\"\"\n    from backend.integrations.credentials_store import IntegrationCredentialsStore\n\n    from .user import get_user_integrations\n\n    store = IntegrationCredentialsStore()\n\n    broken_nodes = await prisma.get_client().query_raw(\n        \"\"\"\n        SELECT    graph.\"userId\"       user_id,\n                  node.id              node_id,\n                  node.\"constantInput\" node_preset_input\n        FROM      platform.\"AgentNode\"  node\n        LEFT JOIN platform.\"AgentGraph\" graph\n        ON        node.\"agentGraphId\" = graph.id\n        WHERE     node.\"constantInput\"::jsonb->'credentials'->>'provider' = 'llm'\n        ORDER BY  graph.\"userId\";\n        \"\"\"\n    )\n    logger.info(f\"Fixing LLM credential inputs on {len(broken_nodes)} nodes\")\n\n    user_id: str = \"\"\n    user_integrations = None\n    for node in broken_nodes:\n        if node[\"user_id\"] != user_id:\n            # Save queries by only fetching once per user\n            user_id = node[\"user_id\"]\n            user_integrations = await get_user_integrations(user_id)\n        elif not user_integrations:\n            raise RuntimeError(f\"Impossible state while processing node {node}\")\n\n        node_id: str = node[\"node_id\"]\n        node_preset_input: dict = json.loads(node[\"node_preset_input\"])\n        credentials_meta: dict = node_preset_input[\"credentials\"]\n\n        credentials = next(\n            (\n                c\n                for c in user_integrations.credentials\n                if c.id == credentials_meta[\"id\"]\n            ),\n            None,\n        )\n        if not credentials:\n            continue\n        if credentials.type != \"api_key\":\n            logger.warning(\n                f\"User {user_id} credentials {credentials.id} with provider 'llm' \"\n                f\"has invalid type '{credentials.type}'\"\n            )\n            continue\n\n        api_key = credentials.api_key.get_secret_value()\n        if api_key.startswith(\"sk-ant-api03-\"):\n            credentials.provider = credentials_meta[\"provider\"] = \"anthropic\"\n        elif api_key.startswith(\"sk-\"):\n            credentials.provider = credentials_meta[\"provider\"] = \"openai\"\n        elif api_key.startswith(\"gsk_\"):\n            credentials.provider = credentials_meta[\"provider\"] = \"groq\"\n        else:\n            logger.warning(\n                f\"Could not identify provider from key prefix {api_key[:13]}*****\"\n            )\n            continue\n\n        store.update_creds(user_id, credentials)\n        await AgentNode.prisma().update(\n            where={\"id\": node_id},\n            data={\"constantInput\": json.dumps(node_preset_input)},\n        )\n",
    "start_token": 0,
    "end_token": 4727,
    "children": [
        {
            "type": "import_statement",
            "label": "import asyncio",
            "start_token": 0,
            "end_token": 1,
            "children": [
                {
                    "type": "dotted_name",
                    "label": "asyncio",
                    "start_token": 1,
                    "end_token": 1,
                    "children": [
                        {
                            "type": "identifier",
                            "label": "asyncio",
                            "start_token": 1,
                            "end_token": 1,
                            "children": []
                        }
                    ]
                }
            ]
        },
        {
            "type": "import_statement",
            "label": "import logging",
            "start_token": 3,
            "end_token": 4,
            "children": [
                {
                    "type": "dotted_name",
                    "label": "logging",
                    "start_token": 4,
                    "end_token": 4,
                    "children": [
                        {
                            "type": "identifier",
                            "label": "logging",
                            "start_token": 4,
                            "end_token": 4,
                            "children": []
                        }
                    ]
                }
            ]
        },
        {
            "type": "import_statement",
            "label": "import uuid",
            "start_token": 6,
            "end_token": 7,
            "children": [
                {
                    "type": "dotted_name",
                    "label": "uuid",
                    "start_token": 7,
                    "end_token": 7,
                    "children": [
                        {
                            "type": "identifier",
                            "label": "uuid",
                            "start_token": 7,
                            "end_token": 7,
                            "children": []
                        }
                    ]
                }
            ]
        },
        {
            "type": "import_from_statement",
            "label": "from collections import defaultdict",
            "start_token": 9,
            "end_token": 12,
            "children": [
                {
                    "type": "dotted_name",
                    "label": "collections",
                    "start_token": 10,
                    "end_token": 10,
                    "children": [
                        {
                            "type": "identifier",
                            "label": "collections",
                            "start_token": 10,
                            "end_token": 10,
                            "children": []
                        }
                    ]
                },
                {
                    "type": "dotted_name",
                    "label": "defaultdict",
                    "start_token": 12,
                    "end_token": 12,
                    "children": [
                        {
                            "type": "identifier",
                            "label": "defaultdict",
                            "start_token": 12,
                            "end_token": 12,
                            "children": []
                        }
                    ]
                }
            ]
        },
        {
            "type": "import_from_statement",
            "label": "from datetime import datetime, timezone",
            "start_token": 14,
            "end_token": 19,
            "children": [
                {
                    "type": "dotted_name",
                    "label": "datetime",
                    "start_token": 15,
                    "end_token": 15,
                    "children": [
                        {
                            "type": "identifier",
                            "label": "datetime",
                            "start_token": 15,
                            "end_token": 15,
                            "children": []
                        }
                    ]
                },
                {
                    "type": "dotted_name",
                    "label": "datetime",
                    "start_token": 17,
                    "end_token": 17,
                    "children": [
                        {
                            "type": "identifier",
                            "label": "datetime",
                            "start_token": 17,
                            "end_token": 17,
                            "children": []
                        }
                    ]
                },
                {
                    "type": "dotted_name",
                    "label": "timezone",
                    "start_token": 19,
                    "end_token": 19,
                    "children": [
                        {
                            "type": "identifier",
                            "label": "timezone",
                            "start_token": 19,
                            "end_token": 19,
                            "children": []
                        }
                    ]
                }
            ]
        },
        {
            "type": "import_from_statement",
            "label": "from typing import Any, Literal, Optional, Type",
            "start_token": 21,
            "end_token": 30,
            "children": [
                {
                    "type": "dotted_name",
                    "label": "typing",
                    "start_token": 22,
                    "end_token": 22,
                    "children": [
                        {
                            "type": "identifier",
                            "label": "typing",
                            "start_token": 22,
                            "end_token": 22,
                            "children": []
                        }
                    ]
                },
                {
                    "type": "dotted_name",
                    "label": "Any",
                    "start_token": 24,
                    "end_token": 24,
                    "children": [
                        {
                            "type": "identifier",
                            "label": "Any",
                            "start_token": 24,
                            "end_token": 24,
                            "children": []
                        }
                    ]
                },
                {
                    "type": "dotted_name",
                    "label": "Literal",
                    "start_token": 26,
                    "end_token": 26,
                    "children": [
                        {
                            "type": "identifier",
                            "label": "Literal",
                            "start_token": 26,
                            "end_token": 26,
                            "children": []
                        }
                    ]
                },
                {
                    "type": "dotted_name",
                    "label": "Optional",
                    "start_token": 28,
                    "end_token": 28,
                    "children": [
                        {
                            "type": "identifier",
                            "label": "Optional",
                            "start_token": 28,
                            "end_token": 28,
                            "children": []
                        }
                    ]
                },
                {
                    "type": "dotted_name",
                    "label": "Type",
                    "start_token": 30,
                    "end_token": 30,
                    "children": [
                        {
                            "type": "identifier",
                            "label": "Type",
                            "start_token": 30,
                            "end_token": 30,
                            "children": []
                        }
                    ]
                }
            ]
        },
        {
            "type": "import_statement",
            "label": "import prisma",
            "start_token": 33,
            "end_token": 34,
            "children": [
                {
                    "type": "dotted_name",
                    "label": "prisma",
                    "start_token": 34,
                    "end_token": 34,
                    "children": [
                        {
                            "type": "identifier",
                            "label": "prisma",
                            "start_token": 34,
                            "end_token": 34,
                            "children": []
                        }
                    ]
                }
            ]
        },
        {
            "type": "import_from_statement",
            "label": "from prisma.models import AgentGraph, AgentGraphExecution, AgentNode, AgentNodeLink",
            "start_token": 36,
            "end_token": 47,
            "children": [
                {
                    "type": "dotted_name",
                    "label": "prisma.models",
                    "start_token": 37,
                    "end_token": 39,
                    "children": [
                        {
                            "type": "identifier",
                            "label": "prisma",
                            "start_token": 37,
                            "end_token": 37,
                            "children": []
                        },
                        {
                            "type": "identifier",
                            "label": "models",
                            "start_token": 39,
                            "end_token": 39,
                            "children": []
                        }
                    ]
                },
                {
                    "type": "dotted_name",
                    "label": "AgentGraph",
                    "start_token": 41,
                    "end_token": 41,
                    "children": [
                        {
                            "type": "identifier",
                            "label": "AgentGraph",
                            "start_token": 41,
                            "end_token": 41,
                            "children": []
                        }
                    ]
                },
                {
                    "type": "dotted_name",
                    "label": "AgentGraphExecution",
                    "start_token": 43,
                    "end_token": 43,
                    "children": [
                        {
                            "type": "identifier",
                            "label": "AgentGraphExecution",
                            "start_token": 43,
                            "end_token": 43,
                            "children": []
                        }
                    ]
                },
                {
                    "type": "dotted_name",
                    "label": "AgentNode",
                    "start_token": 45,
                    "end_token": 45,
                    "children": [
                        {
                            "type": "identifier",
                            "label": "AgentNode",
                            "start_token": 45,
                            "end_token": 45,
                            "children": []
                        }
                    ]
                },
                {
                    "type": "dotted_name",
                    "label": "AgentNodeLink",
                    "start_token": 47,
                    "end_token": 47,
                    "children": [
                        {
                            "type": "identifier",
                            "label": "AgentNodeLink",
                            "start_token": 47,
                            "end_token": 47,
                            "children": []
                        }
                    ]
                }
            ]
        },
        {
            "type": "import_from_statement",
            "label": "from prisma.types import AgentGraphWhereInput",
            "start_token": 49,
            "end_token": 54,
            "children": [
                {
                    "type": "dotted_name",
                    "label": "prisma.types",
                    "start_token": 50,
                    "end_token": 52,
                    "children": [
                        {
                            "type": "identifier",
                            "label": "prisma",
                            "start_token": 50,
                            "end_token": 50,
                            "children": []
                        },
                        {
                            "type": "identifier",
                            "label": "types",
                            "start_token": 52,
                            "end_token": 52,
                            "children": []
                        }
                    ]
                },
                {
                    "type": "dotted_name",
                    "label": "AgentGraphWhereInput",
                    "start_token": 54,
                    "end_token": 54,
                    "children": [
                        {
                            "type": "identifier",
                            "label": "AgentGraphWhereInput",
                            "start_token": 54,
                            "end_token": 54,
                            "children": []
                        }
                    ]
                }
            ]
        },
        {
            "type": "import_from_statement",
            "label": "from pydantic.fields import computed_field",
            "start_token": 56,
            "end_token": 61,
            "children": [
                {
                    "type": "dotted_name",
                    "label": "pydantic.fields",
                    "start_token": 57,
                    "end_token": 59,
                    "children": [
                        {
                            "type": "identifier",
                            "label": "pydantic",
                            "start_token": 57,
                            "end_token": 57,
                            "children": []
                        },
                        {
                            "type": "identifier",
                            "label": "fields",
                            "start_token": 59,
                            "end_token": 59,
                            "children": []
                        }
                    ]
                },
                {
                    "type": "dotted_name",
                    "label": "computed_field",
                    "start_token": 61,
                    "end_token": 61,
                    "children": [
                        {
                            "type": "identifier",
                            "label": "computed_field",
                            "start_token": 61,
                            "end_token": 61,
                            "children": []
                        }
                    ]
                }
            ]
        },
        {
            "type": "import_from_statement",
            "label": "from backend.blocks.agent import AgentExecutorBlock",
            "start_token": 64,
            "end_token": 71,
            "children": [
                {
                    "type": "dotted_name",
                    "label": "backend.blocks.agent",
                    "start_token": 65,
                    "end_token": 69,
                    "children": [
                        {
                            "type": "identifier",
                            "label": "backend",
                            "start_token": 65,
                            "end_token": 65,
                            "children": []
                        },
                        {
                            "type": "identifier",
                            "label": "blocks",
                            "start_token": 67,
                            "end_token": 67,
                            "children": []
                        },
                        {
                            "type": "identifier",
                            "label": "agent",
                            "start_token": 69,
                            "end_token": 69,
                            "children": []
                        }
                    ]
                },
                {
                    "type": "dotted_name",
                    "label": "AgentExecutorBlock",
                    "start_token": 71,
                    "end_token": 71,
                    "children": [
                        {
                            "type": "identifier",
                            "label": "AgentExecutorBlock",
                            "start_token": 71,
                            "end_token": 71,
                            "children": []
                        }
                    ]
                }
            ]
        },
        {
            "type": "import_from_statement",
            "label": "from backend.blocks.basic import AgentInputBlock, AgentOutputBlock",
            "start_token": 73,
            "end_token": 82,
            "children": [
                {
                    "type": "dotted_name",
                    "label": "backend.blocks.basic",
                    "start_token": 74,
                    "end_token": 78,
                    "children": [
                        {
                            "type": "identifier",
                            "label": "backend",
                            "start_token": 74,
                            "end_token": 74,
                            "children": []
                        },
                        {
                            "type": "identifier",
                            "label": "blocks",
                            "start_token": 76,
                            "end_token": 76,
                            "children": []
                        },
                        {
                            "type": "identifier",
                            "label": "basic",
                            "start_token": 78,
                            "end_token": 78,
                            "children": []
                        }
                    ]
                },
                {
                    "type": "dotted_name",
                    "label": "AgentInputBlock",
                    "start_token": 80,
                    "end_token": 80,
                    "children": [
                        {
                            "type": "identifier",
                            "label": "AgentInputBlock",
                            "start_token": 80,
                            "end_token": 80,
                            "children": []
                        }
                    ]
                },
                {
                    "type": "dotted_name",
                    "label": "AgentOutputBlock",
                    "start_token": 82,
                    "end_token": 82,
                    "children": [
                        {
                            "type": "identifier",
                            "label": "AgentOutputBlock",
                            "start_token": 82,
                            "end_token": 82,
                            "children": []
                        }
                    ]
                }
            ]
        },
        {
            "type": "import_from_statement",
            "label": "from backend.util import json",
            "start_token": 84,
            "end_token": 89,
            "children": [
                {
                    "type": "dotted_name",
                    "label": "backend.util",
                    "start_token": 85,
                    "end_token": 87,
                    "children": [
                        {
                            "type": "identifier",
                            "label": "backend",
                            "start_token": 85,
                            "end_token": 85,
                            "children": []
                        },
                        {
                            "type": "identifier",
                            "label": "util",
                            "start_token": 87,
                            "end_token": 87,
                            "children": []
                        }
                    ]
                },
                {
                    "type": "dotted_name",
                    "label": "json",
                    "start_token": 89,
                    "end_token": 89,
                    "children": [
                        {
                            "type": "identifier",
                            "label": "json",
                            "start_token": 89,
                            "end_token": 89,
                            "children": []
                        }
                    ]
                }
            ]
        },
        {
            "type": "import_from_statement",
            "label": "from .block import BlockInput, BlockType, get_block, get_blocks",
            "start_token": 92,
            "end_token": 102,
            "children": [
                {
                    "type": "relative_import",
                    "label": ".block",
                    "start_token": 93,
                    "end_token": 94,
                    "children": [
                        {
                            "type": "import_prefix",
                            "label": ".",
                            "start_token": 93,
                            "end_token": 93,
                            "children": []
                        },
                        {
                            "type": "dotted_name",
                            "label": "block",
                            "start_token": 94,
                            "end_token": 94,
                            "children": [
                                {
                                    "type": "identifier",
                                    "label": "block",
                                    "start_token": 94,
                                    "end_token": 94,
                                    "children": []
                                }
                            ]
                        }
                    ]
                },
                {
                    "type": "dotted_name",
                    "label": "BlockInput",
                    "start_token": 96,
                    "end_token": 96,
                    "children": [
                        {
                            "type": "identifier",
                            "label": "BlockInput",
                            "start_token": 96,
                            "end_token": 96,
                            "children": []
                        }
                    ]
                },
                {
                    "type": "dotted_name",
                    "label": "BlockType",
                    "start_token": 98,
                    "end_token": 98,
                    "children": [
                        {
                            "type": "identifier",
                            "label": "BlockType",
                            "start_token": 98,
                            "end_token": 98,
                            "children": []
                        }
                    ]
                },
                {
                    "type": "dotted_name",
                    "label": "get_block",
                    "start_token": 100,
                    "end_token": 100,
                    "children": [
                        {
                            "type": "identifier",
                            "label": "get_block",
                            "start_token": 100,
                            "end_token": 100,
                            "children": []
                        }
                    ]
                },
                {
                    "type": "dotted_name",
                    "label": "get_blocks",
                    "start_token": 102,
                    "end_token": 102,
                    "children": [
                        {
                            "type": "identifier",
                            "label": "get_blocks",
                            "start_token": 102,
                            "end_token": 102,
                            "children": []
                        }
                    ]
                }
            ]
        },
        {
            "type": "import_from_statement",
            "label": "from .db import BaseDbModel, transaction",
            "start_token": 104,
            "end_token": 110,
            "children": [
                {
                    "type": "relative_import",
                    "label": ".db",
                    "start_token": 105,
                    "end_token": 106,
                    "children": [
                        {
                            "type": "import_prefix",
                            "label": ".",
                            "start_token": 105,
                            "end_token": 105,
                            "children": []
                        },
                        {
                            "type": "dotted_name",
                            "label": "db",
                            "start_token": 106,
                            "end_token": 106,
                            "children": [
                                {
                                    "type": "identifier",
                                    "label": "db",
                                    "start_token": 106,
                                    "end_token": 106,
                                    "children": []
                                }
                            ]
                        }
                    ]
                },
                {
                    "type": "dotted_name",
                    "label": "BaseDbModel",
                    "start_token": 108,
                    "end_token": 108,
                    "children": [
                        {
                            "type": "identifier",
                            "label": "BaseDbModel",
                            "start_token": 108,
                            "end_token": 108,
                            "children": []
                        }
                    ]
                },
                {
                    "type": "dotted_name",
                    "label": "transaction",
                    "start_token": 110,
                    "end_token": 110,
                    "children": [
                        {
                            "type": "identifier",
                            "label": "transaction",
                            "start_token": 110,
                            "end_token": 110,
                            "children": []
                        }
                    ]
                }
            ]
        },
        {
            "type": "import_from_statement",
            "label": "from .execution import ExecutionStatus",
            "start_token": 112,
            "end_token": 116,
            "children": [
                {
                    "type": "relative_import",
                    "label": ".execution",
                    "start_token": 113,
                    "end_token": 114,
                    "children": [
                        {
                            "type": "import_prefix",
                            "label": ".",
                            "start_token": 113,
                            "end_token": 113,
                            "children": []
                        },
                        {
                            "type": "dotted_name",
                            "label": "execution",
                            "start_token": 114,
                            "end_token": 114,
                            "children": [
                                {
                                    "type": "identifier",
                                    "label": "execution",
                                    "start_token": 114,
                                    "end_token": 114,
                                    "children": []
                                }
                            ]
                        }
                    ]
                },
                {
                    "type": "dotted_name",
                    "label": "ExecutionStatus",
                    "start_token": 116,
                    "end_token": 116,
                    "children": [
                        {
                            "type": "identifier",
                            "label": "ExecutionStatus",
                            "start_token": 116,
                            "end_token": 116,
                            "children": []
                        }
                    ]
                }
            ]
        },
        {
            "type": "import_from_statement",
            "label": "from .includes import AGENT_GRAPH_INCLUDE, AGENT_NODE_INCLUDE",
            "start_token": 118,
            "end_token": 124,
            "children": [
                {
                    "type": "relative_import",
                    "label": ".includes",
                    "start_token": 119,
                    "end_token": 120,
                    "children": [
                        {
                            "type": "import_prefix",
                            "label": ".",
                            "start_token": 119,
                            "end_token": 119,
                            "children": []
                        },
                        {
                            "type": "dotted_name",
                            "label": "includes",
                            "start_token": 120,
                            "end_token": 120,
                            "children": [
                                {
                                    "type": "identifier",
                                    "label": "includes",
                                    "start_token": 120,
                                    "end_token": 120,
                                    "children": []
                                }
                            ]
                        }
                    ]
                },
                {
                    "type": "dotted_name",
                    "label": "AGENT_GRAPH_INCLUDE",
                    "start_token": 122,
                    "end_token": 122,
                    "children": [
                        {
                            "type": "identifier",
                            "label": "AGENT_GRAPH_INCLUDE",
                            "start_token": 122,
                            "end_token": 122,
                            "children": []
                        }
                    ]
                },
                {
                    "type": "dotted_name",
                    "label": "AGENT_NODE_INCLUDE",
                    "start_token": 124,
                    "end_token": 124,
                    "children": [
                        {
                            "type": "identifier",
                            "label": "AGENT_NODE_INCLUDE",
                            "start_token": 124,
                            "end_token": 124,
                            "children": []
                        }
                    ]
                }
            ]
        },
        {
            "type": "import_from_statement",
            "label": "from .integrations import Webhook",
            "start_token": 126,
            "end_token": 130,
            "children": [
                {
                    "type": "relative_import",
                    "label": ".integrations",
                    "start_token": 127,
                    "end_token": 128,
                    "children": [
                        {
                            "type": "import_prefix",
                            "label": ".",
                            "start_token": 127,
                            "end_token": 127,
                            "children": []
                        },
                        {
                            "type": "dotted_name",
                            "label": "integrations",
                            "start_token": 128,
                            "end_token": 128,
                            "children": [
                                {
                                    "type": "identifier",
                                    "label": "integrations",
                                    "start_token": 128,
                                    "end_token": 128,
                                    "children": []
                                }
                            ]
                        }
                    ]
                },
                {
                    "type": "dotted_name",
                    "label": "Webhook",
                    "start_token": 130,
                    "end_token": 130,
                    "children": [
                        {
                            "type": "identifier",
                            "label": "Webhook",
                            "start_token": 130,
                            "end_token": 130,
                            "children": []
                        }
                    ]
                }
            ]
        },
        {
            "type": "expression_statement",
            "label": "logger = logging.getLogger(__name__)",
            "start_token": 133,
            "end_token": 140,
            "children": [
                {
                    "type": "assignment",
                    "label": "logger = logging.getLogger(__name__)",
                    "start_token": 133,
                    "end_token": 140,
                    "children": [
                        {
                            "type": "identifier",
                            "label": "logger",
                            "start_token": 133,
                            "end_token": 133,
                            "children": []
                        },
                        {
                            "type": "call",
                            "label": "logging.getLogger(__name__)",
                            "start_token": 135,
                            "end_token": 140,
                            "children": [
                                {
                                    "type": "attribute",
                                    "label": "logging.getLogger",
                                    "start_token": 135,
                                    "end_token": 137,
                                    "children": [
                                        {
                                            "type": "identifier",
                                            "label": "logging",
                                            "start_token": 135,
                                            "end_token": 135,
                                            "children": []
                                        },
                                        {
                                            "type": "identifier",
                                            "label": "getLogger",
                                            "start_token": 137,
                                            "end_token": 137,
                                            "children": []
                                        }
                                    ]
                                },
                                {
                                    "type": "argument_list",
                                    "label": "(__name__)",
                                    "start_token": 138,
                                    "end_token": 140,
                                    "children": [
                                        {
                                            "type": "identifier",
                                            "label": "__name__",
                                            "start_token": 139,
                                            "end_token": 139,
                                            "children": []
                                        }
                                    ]
                                }
                            ]
                        }
                    ]
                }
            ]
        },
        {
            "type": "class_definition",
            "label": "class Link(BaseDbModel):\n    source_id: str\n    sink_id: str\n    source_name: str\n    sink_name: str\n    is_static: bool = False\n\n    @staticmethod\n    def from_db(link: AgentNodeLink):\n        return Link(\n            id=link.id,\n            source_name=link.sourceName,\n            source_id=link.agentNodeSourceId,\n            sink_name=link.sinkName,\n            sink_id=link.agentNodeSinkId,\n            is_static=link.isStatic,\n        )\n\n    def __hash__(self):\n        return hash((self.source_id, self.sink_id, self.source_name, self.sink_name))",
            "start_token": 144,
            "end_token": 262,
            "children": [
                {
                    "type": "identifier",
                    "label": "Link",
                    "start_token": 145,
                    "end_token": 145,
                    "children": []
                },
                {
                    "type": "argument_list",
                    "label": "(BaseDbModel)",
                    "start_token": 146,
                    "end_token": 148,
                    "children": [
                        {
                            "type": "identifier",
                            "label": "BaseDbModel",
                            "start_token": 147,
                            "end_token": 147,
                            "children": []
                        }
                    ]
                },
                {
                    "type": "block",
                    "label": "source_id: str\n    sink_id: str\n    source_name: str\n    sink_name: str\n    is_static: bool = False\n\n    @staticmethod\n    def from_db(link: AgentNodeLink):\n        return Link(\n            id=link.id,\n            source_name=link.sourceName,\n            source_id=link.agentNodeSourceId,\n            sink_name=link.sinkName,\n            sink_id=link.agentNodeSinkId,\n            is_static=link.isStatic,\n        )\n\n    def __hash__(self):\n        return hash((self.source_id, self.sink_id, self.source_name, self.sink_name))",
                    "start_token": 151,
                    "end_token": 262,
                    "children": [
                        {
                            "type": "expression_statement",
                            "label": "source_id: str",
                            "start_token": 151,
                            "end_token": 153,
                            "children": [
                                {
                                    "type": "assignment",
                                    "label": "source_id: str",
                                    "start_token": 151,
                                    "end_token": 153,
                                    "children": [
                                        {
                                            "type": "identifier",
                                            "label": "source_id",
                                            "start_token": 151,
                                            "end_token": 151,
                                            "children": []
                                        },
                                        {
                                            "type": "type",
                                            "label": "str",
                                            "start_token": 153,
                                            "end_token": 153,
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "label": "str",
                                                    "start_token": 153,
                                                    "end_token": 153,
                                                    "children": []
                                                }
                                            ]
                                        }
                                    ]
                                }
                            ]
                        },
                        {
                            "type": "expression_statement",
                            "label": "sink_id: str",
                            "start_token": 155,
                            "end_token": 157,
                            "children": [
                                {
                                    "type": "assignment",
                                    "label": "sink_id: str",
                                    "start_token": 155,
                                    "end_token": 157,
                                    "children": [
                                        {
                                            "type": "identifier",
                                            "label": "sink_id",
                                            "start_token": 155,
                                            "end_token": 155,
                                            "children": []
                                        },
                                        {
                                            "type": "type",
                                            "label": "str",
                                            "start_token": 157,
                                            "end_token": 157,
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "label": "str",
                                                    "start_token": 157,
                                                    "end_token": 157,
                                                    "children": []
                                                }
                                            ]
                                        }
                                    ]
                                }
                            ]
                        },
                        {
                            "type": "expression_statement",
                            "label": "source_name: str",
                            "start_token": 159,
                            "end_token": 161,
                            "children": [
                                {
                                    "type": "assignment",
                                    "label": "source_name: str",
                                    "start_token": 159,
                                    "end_token": 161,
                                    "children": [
                                        {
                                            "type": "identifier",
                                            "label": "source_name",
                                            "start_token": 159,
                                            "end_token": 159,
                                            "children": []
                                        },
                                        {
                                            "type": "type",
                                            "label": "str",
                                            "start_token": 161,
                                            "end_token": 161,
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "label": "str",
                                                    "start_token": 161,
                                                    "end_token": 161,
                                                    "children": []
                                                }
                                            ]
                                        }
                                    ]
                                }
                            ]
                        },
                        {
                            "type": "expression_statement",
                            "label": "sink_name: str",
                            "start_token": 163,
                            "end_token": 165,
                            "children": [
                                {
                                    "type": "assignment",
                                    "label": "sink_name: str",
                                    "start_token": 163,
                                    "end_token": 165,
                                    "children": [
                                        {
                                            "type": "identifier",
                                            "label": "sink_name",
                                            "start_token": 163,
                                            "end_token": 163,
                                            "children": []
                                        },
                                        {
                                            "type": "type",
                                            "label": "str",
                                            "start_token": 165,
                                            "end_token": 165,
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "label": "str",
                                                    "start_token": 165,
                                                    "end_token": 165,
                                                    "children": []
                                                }
                                            ]
                                        }
                                    ]
                                }
                            ]
                        },
                        {
                            "type": "expression_statement",
                            "label": "is_static: bool = False",
                            "start_token": 167,
                            "end_token": 171,
                            "children": [
                                {
                                    "type": "assignment",
                                    "label": "is_static: bool = False",
                                    "start_token": 167,
                                    "end_token": 171,
                                    "children": [
                                        {
                                            "type": "identifier",
                                            "label": "is_static",
                                            "start_token": 167,
                                            "end_token": 167,
                                            "children": []
                                        },
                                        {
                                            "type": "type",
                                            "label": "bool",
                                            "start_token": 169,
                                            "end_token": 169,
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "label": "bool",
                                                    "start_token": 169,
                                                    "end_token": 169,
                                                    "children": []
                                                }
                                            ]
                                        },
                                        {
                                            "type": "false",
                                            "label": "False",
                                            "start_token": 171,
                                            "end_token": 171,
                                            "children": []
                                        }
                                    ]
                                }
                            ]
                        },
                        {
                            "type": "decorated_definition",
                            "label": "@staticmethod\n    def from_db(link: AgentNodeLink):\n        return Link(\n            id=link.id,\n            source_name=link.sourceName,\n            source_id=link.agentNodeSourceId,\n            sink_name=link.sinkName,\n            sink_id=link.agentNodeSinkId,\n            is_static=link.isStatic,\n        )",
                            "start_token": 174,
                            "end_token": 232,
                            "children": [
                                {
                                    "type": "decorator",
                                    "label": "@staticmethod",
                                    "start_token": 174,
                                    "end_token": 175,
                                    "children": [
                                        {
                                            "type": "identifier",
                                            "label": "staticmethod",
                                            "start_token": 175,
                                            "end_token": 175,
                                            "children": []
                                        }
                                    ]
                                },
                                {
                                    "type": "function_definition",
                                    "label": "def from_db(link: AgentNodeLink):\n        return Link(\n            id=link.id,\n            source_name=link.sourceName,\n            source_id=link.agentNodeSourceId,\n            sink_name=link.sinkName,\n            sink_id=link.agentNodeSinkId,\n            is_static=link.isStatic,\n        )",
                                    "start_token": 177,
                                    "end_token": 232,
                                    "children": [
                                        {
                                            "type": "identifier",
                                            "label": "from_db",
                                            "start_token": 178,
                                            "end_token": 178,
                                            "children": []
                                        },
                                        {
                                            "type": "parameters",
                                            "label": "(link: AgentNodeLink)",
                                            "start_token": 179,
                                            "end_token": 183,
                                            "children": [
                                                {
                                                    "type": "typed_parameter",
                                                    "label": "link: AgentNodeLink",
                                                    "start_token": 180,
                                                    "end_token": 182,
                                                    "children": [
                                                        {
                                                            "type": "identifier",
                                                            "label": "link",
                                                            "start_token": 180,
                                                            "end_token": 180,
                                                            "children": []
                                                        },
                                                        {
                                                            "type": "type",
                                                            "label": "AgentNodeLink",
                                                            "start_token": 182,
                                                            "end_token": 182,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "label": "AgentNodeLink",
                                                                    "start_token": 182,
                                                                    "end_token": 182,
                                                                    "children": []
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                }
                                            ]
                                        },
                                        {
                                            "type": "block",
                                            "label": "return Link(\n            id=link.id,\n            source_name=link.sourceName,\n            source_id=link.agentNodeSourceId,\n            sink_name=link.sinkName,\n            sink_id=link.agentNodeSinkId,\n            is_static=link.isStatic,\n        )",
                                            "start_token": 186,
                                            "end_token": 232,
                                            "children": [
                                                {
                                                    "type": "return_statement",
                                                    "label": "return Link(\n            id=link.id,\n            source_name=link.sourceName,\n            source_id=link.agentNodeSourceId,\n            sink_name=link.sinkName,\n            sink_id=link.agentNodeSinkId,\n            is_static=link.isStatic,\n        )",
                                                    "start_token": 186,
                                                    "end_token": 232,
                                                    "children": [
                                                        {
                                                            "type": "call",
                                                            "label": "Link(\n            id=link.id,\n            source_name=link.sourceName,\n            source_id=link.agentNodeSourceId,\n            sink_name=link.sinkName,\n            sink_id=link.agentNodeSinkId,\n            is_static=link.isStatic,\n        )",
                                                            "start_token": 187,
                                                            "end_token": 232,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "label": "Link",
                                                                    "start_token": 187,
                                                                    "end_token": 187,
                                                                    "children": []
                                                                },
                                                                {
                                                                    "type": "argument_list",
                                                                    "label": "(\n            id=link.id,\n            source_name=link.sourceName,\n            source_id=link.agentNodeSourceId,\n            sink_name=link.sinkName,\n            sink_id=link.agentNodeSinkId,\n            is_static=link.isStatic,\n        )",
                                                                    "start_token": 188,
                                                                    "end_token": 232,
                                                                    "children": [
                                                                        {
                                                                            "type": "keyword_argument",
                                                                            "label": "id=link.id",
                                                                            "start_token": 190,
                                                                            "end_token": 194,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "id",
                                                                                    "start_token": 190,
                                                                                    "end_token": 190,
                                                                                    "children": []
                                                                                },
                                                                                {
                                                                                    "type": "attribute",
                                                                                    "label": "link.id",
                                                                                    "start_token": 192,
                                                                                    "end_token": 194,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "label": "link",
                                                                                            "start_token": 192,
                                                                                            "end_token": 192,
                                                                                            "children": []
                                                                                        },
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "label": "id",
                                                                                            "start_token": 194,
                                                                                            "end_token": 194,
                                                                                            "children": []
                                                                                        }
                                                                                    ]
                                                                                }
                                                                            ]
                                                                        },
                                                                        {
                                                                            "type": "keyword_argument",
                                                                            "label": "source_name=link.sourceName",
                                                                            "start_token": 197,
                                                                            "end_token": 201,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "source_name",
                                                                                    "start_token": 197,
                                                                                    "end_token": 197,
                                                                                    "children": []
                                                                                },
                                                                                {
                                                                                    "type": "attribute",
                                                                                    "label": "link.sourceName",
                                                                                    "start_token": 199,
                                                                                    "end_token": 201,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "label": "link",
                                                                                            "start_token": 199,
                                                                                            "end_token": 199,
                                                                                            "children": []
                                                                                        },
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "label": "sourceName",
                                                                                            "start_token": 201,
                                                                                            "end_token": 201,
                                                                                            "children": []
                                                                                        }
                                                                                    ]
                                                                                }
                                                                            ]
                                                                        },
                                                                        {
                                                                            "type": "keyword_argument",
                                                                            "label": "source_id=link.agentNodeSourceId",
                                                                            "start_token": 204,
                                                                            "end_token": 208,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "source_id",
                                                                                    "start_token": 204,
                                                                                    "end_token": 204,
                                                                                    "children": []
                                                                                },
                                                                                {
                                                                                    "type": "attribute",
                                                                                    "label": "link.agentNodeSourceId",
                                                                                    "start_token": 206,
                                                                                    "end_token": 208,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "label": "link",
                                                                                            "start_token": 206,
                                                                                            "end_token": 206,
                                                                                            "children": []
                                                                                        },
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "label": "agentNodeSourceId",
                                                                                            "start_token": 208,
                                                                                            "end_token": 208,
                                                                                            "children": []
                                                                                        }
                                                                                    ]
                                                                                }
                                                                            ]
                                                                        },
                                                                        {
                                                                            "type": "keyword_argument",
                                                                            "label": "sink_name=link.sinkName",
                                                                            "start_token": 211,
                                                                            "end_token": 215,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "sink_name",
                                                                                    "start_token": 211,
                                                                                    "end_token": 211,
                                                                                    "children": []
                                                                                },
                                                                                {
                                                                                    "type": "attribute",
                                                                                    "label": "link.sinkName",
                                                                                    "start_token": 213,
                                                                                    "end_token": 215,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "label": "link",
                                                                                            "start_token": 213,
                                                                                            "end_token": 213,
                                                                                            "children": []
                                                                                        },
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "label": "sinkName",
                                                                                            "start_token": 215,
                                                                                            "end_token": 215,
                                                                                            "children": []
                                                                                        }
                                                                                    ]
                                                                                }
                                                                            ]
                                                                        },
                                                                        {
                                                                            "type": "keyword_argument",
                                                                            "label": "sink_id=link.agentNodeSinkId",
                                                                            "start_token": 218,
                                                                            "end_token": 222,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "sink_id",
                                                                                    "start_token": 218,
                                                                                    "end_token": 218,
                                                                                    "children": []
                                                                                },
                                                                                {
                                                                                    "type": "attribute",
                                                                                    "label": "link.agentNodeSinkId",
                                                                                    "start_token": 220,
                                                                                    "end_token": 222,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "label": "link",
                                                                                            "start_token": 220,
                                                                                            "end_token": 220,
                                                                                            "children": []
                                                                                        },
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "label": "agentNodeSinkId",
                                                                                            "start_token": 222,
                                                                                            "end_token": 222,
                                                                                            "children": []
                                                                                        }
                                                                                    ]
                                                                                }
                                                                            ]
                                                                        },
                                                                        {
                                                                            "type": "keyword_argument",
                                                                            "label": "is_static=link.isStatic",
                                                                            "start_token": 225,
                                                                            "end_token": 229,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "is_static",
                                                                                    "start_token": 225,
                                                                                    "end_token": 225,
                                                                                    "children": []
                                                                                },
                                                                                {
                                                                                    "type": "attribute",
                                                                                    "label": "link.isStatic",
                                                                                    "start_token": 227,
                                                                                    "end_token": 229,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "label": "link",
                                                                                            "start_token": 227,
                                                                                            "end_token": 227,
                                                                                            "children": []
                                                                                        },
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "label": "isStatic",
                                                                                            "start_token": 229,
                                                                                            "end_token": 229,
                                                                                            "children": []
                                                                                        }
                                                                                    ]
                                                                                }
                                                                            ]
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                }
                                            ]
                                        }
                                    ]
                                }
                            ]
                        },
                        {
                            "type": "function_definition",
                            "label": "def __hash__(self):\n        return hash((self.source_id, self.sink_id, self.source_name, self.sink_name))",
                            "start_token": 235,
                            "end_token": 262,
                            "children": [
                                {
                                    "type": "identifier",
                                    "label": "__hash__",
                                    "start_token": 236,
                                    "end_token": 236,
                                    "children": []
                                },
                                {
                                    "type": "parameters",
                                    "label": "(self)",
                                    "start_token": 237,
                                    "end_token": 239,
                                    "children": [
                                        {
                                            "type": "identifier",
                                            "label": "self",
                                            "start_token": 238,
                                            "end_token": 238,
                                            "children": []
                                        }
                                    ]
                                },
                                {
                                    "type": "block",
                                    "label": "return hash((self.source_id, self.sink_id, self.source_name, self.sink_name))",
                                    "start_token": 242,
                                    "end_token": 262,
                                    "children": [
                                        {
                                            "type": "return_statement",
                                            "label": "return hash((self.source_id, self.sink_id, self.source_name, self.sink_name))",
                                            "start_token": 242,
                                            "end_token": 262,
                                            "children": [
                                                {
                                                    "type": "call",
                                                    "label": "hash((self.source_id, self.sink_id, self.source_name, self.sink_name))",
                                                    "start_token": 243,
                                                    "end_token": 262,
                                                    "children": [
                                                        {
                                                            "type": "identifier",
                                                            "label": "hash",
                                                            "start_token": 243,
                                                            "end_token": 243,
                                                            "children": []
                                                        },
                                                        {
                                                            "type": "argument_list",
                                                            "label": "((self.source_id, self.sink_id, self.source_name, self.sink_name))",
                                                            "start_token": 244,
                                                            "end_token": 262,
                                                            "children": [
                                                                {
                                                                    "type": "tuple",
                                                                    "label": "(self.source_id, self.sink_id, self.source_name, self.sink_name)",
                                                                    "start_token": 245,
                                                                    "end_token": 261,
                                                                    "children": [
                                                                        {
                                                                            "type": "attribute",
                                                                            "label": "self.source_id",
                                                                            "start_token": 246,
                                                                            "end_token": 248,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "self",
                                                                                    "start_token": 246,
                                                                                    "end_token": 246,
                                                                                    "children": []
                                                                                },
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "source_id",
                                                                                    "start_token": 248,
                                                                                    "end_token": 248,
                                                                                    "children": []
                                                                                }
                                                                            ]
                                                                        },
                                                                        {
                                                                            "type": "attribute",
                                                                            "label": "self.sink_id",
                                                                            "start_token": 250,
                                                                            "end_token": 252,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "self",
                                                                                    "start_token": 250,
                                                                                    "end_token": 250,
                                                                                    "children": []
                                                                                },
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "sink_id",
                                                                                    "start_token": 252,
                                                                                    "end_token": 252,
                                                                                    "children": []
                                                                                }
                                                                            ]
                                                                        },
                                                                        {
                                                                            "type": "attribute",
                                                                            "label": "self.source_name",
                                                                            "start_token": 254,
                                                                            "end_token": 256,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "self",
                                                                                    "start_token": 254,
                                                                                    "end_token": 254,
                                                                                    "children": []
                                                                                },
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "source_name",
                                                                                    "start_token": 256,
                                                                                    "end_token": 256,
                                                                                    "children": []
                                                                                }
                                                                            ]
                                                                        },
                                                                        {
                                                                            "type": "attribute",
                                                                            "label": "self.sink_name",
                                                                            "start_token": 258,
                                                                            "end_token": 260,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "self",
                                                                                    "start_token": 258,
                                                                                    "end_token": 258,
                                                                                    "children": []
                                                                                },
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "sink_name",
                                                                                    "start_token": 260,
                                                                                    "end_token": 260,
                                                                                    "children": []
                                                                                }
                                                                            ]
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                }
                                            ]
                                        }
                                    ]
                                }
                            ]
                        }
                    ]
                }
            ]
        },
        {
            "type": "class_definition",
            "label": "class Node(BaseDbModel):\n    block_id: str\n    input_default: BlockInput = {}  # dict[input_name, default_value]\n    metadata: dict[str, Any] = {}\n    input_links: list[Link] = []\n    output_links: list[Link] = []\n\n    webhook_id: Optional[str] = None",
            "start_token": 266,
            "end_token": 331,
            "children": [
                {
                    "type": "identifier",
                    "label": "Node",
                    "start_token": 267,
                    "end_token": 267,
                    "children": []
                },
                {
                    "type": "argument_list",
                    "label": "(BaseDbModel)",
                    "start_token": 268,
                    "end_token": 270,
                    "children": [
                        {
                            "type": "identifier",
                            "label": "BaseDbModel",
                            "start_token": 269,
                            "end_token": 269,
                            "children": []
                        }
                    ]
                },
                {
                    "type": "block",
                    "label": "block_id: str\n    input_default: BlockInput = {}  # dict[input_name, default_value]\n    metadata: dict[str, Any] = {}\n    input_links: list[Link] = []\n    output_links: list[Link] = []\n\n    webhook_id: Optional[str] = None",
                    "start_token": 273,
                    "end_token": 331,
                    "children": [
                        {
                            "type": "expression_statement",
                            "label": "block_id: str",
                            "start_token": 273,
                            "end_token": 275,
                            "children": [
                                {
                                    "type": "assignment",
                                    "label": "block_id: str",
                                    "start_token": 273,
                                    "end_token": 275,
                                    "children": [
                                        {
                                            "type": "identifier",
                                            "label": "block_id",
                                            "start_token": 273,
                                            "end_token": 273,
                                            "children": []
                                        },
                                        {
                                            "type": "type",
                                            "label": "str",
                                            "start_token": 275,
                                            "end_token": 275,
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "label": "str",
                                                    "start_token": 275,
                                                    "end_token": 275,
                                                    "children": []
                                                }
                                            ]
                                        }
                                    ]
                                }
                            ]
                        },
                        {
                            "type": "expression_statement",
                            "label": "input_default: BlockInput = {}",
                            "start_token": 277,
                            "end_token": 282,
                            "children": [
                                {
                                    "type": "assignment",
                                    "label": "input_default: BlockInput = {}",
                                    "start_token": 277,
                                    "end_token": 282,
                                    "children": [
                                        {
                                            "type": "identifier",
                                            "label": "input_default",
                                            "start_token": 277,
                                            "end_token": 277,
                                            "children": []
                                        },
                                        {
                                            "type": "type",
                                            "label": "BlockInput",
                                            "start_token": 279,
                                            "end_token": 279,
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "label": "BlockInput",
                                                    "start_token": 279,
                                                    "end_token": 279,
                                                    "children": []
                                                }
                                            ]
                                        },
                                        {
                                            "type": "dictionary",
                                            "label": "{}",
                                            "start_token": 281,
                                            "end_token": 282,
                                            "children": []
                                        }
                                    ]
                                }
                            ]
                        },
                        {
                            "type": "comment",
                            "label": "# dict[input_name, default_value]",
                            "start_token": 283,
                            "end_token": 289,
                            "children": []
                        },
                        {
                            "type": "expression_statement",
                            "label": "metadata: dict[str, Any] = {}",
                            "start_token": 291,
                            "end_token": 301,
                            "children": [
                                {
                                    "type": "assignment",
                                    "label": "metadata: dict[str, Any] = {}",
                                    "start_token": 291,
                                    "end_token": 301,
                                    "children": [
                                        {
                                            "type": "identifier",
                                            "label": "metadata",
                                            "start_token": 291,
                                            "end_token": 291,
                                            "children": []
                                        },
                                        {
                                            "type": "type",
                                            "label": "dict[str, Any]",
                                            "start_token": 293,
                                            "end_token": 298,
                                            "children": [
                                                {
                                                    "type": "generic_type",
                                                    "label": "dict[str, Any]",
                                                    "start_token": 293,
                                                    "end_token": 298,
                                                    "children": [
                                                        {
                                                            "type": "identifier",
                                                            "label": "dict",
                                                            "start_token": 293,
                                                            "end_token": 293,
                                                            "children": []
                                                        },
                                                        {
                                                            "type": "type_parameter",
                                                            "label": "[str, Any]",
                                                            "start_token": 294,
                                                            "end_token": 298,
                                                            "children": [
                                                                {
                                                                    "type": "type",
                                                                    "label": "str",
                                                                    "start_token": 295,
                                                                    "end_token": 295,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "str",
                                                                            "start_token": 295,
                                                                            "end_token": 295,
                                                                            "children": []
                                                                        }
                                                                    ]
                                                                },
                                                                {
                                                                    "type": "type",
                                                                    "label": "Any",
                                                                    "start_token": 297,
                                                                    "end_token": 297,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "Any",
                                                                            "start_token": 297,
                                                                            "end_token": 297,
                                                                            "children": []
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                }
                                            ]
                                        },
                                        {
                                            "type": "dictionary",
                                            "label": "{}",
                                            "start_token": 300,
                                            "end_token": 301,
                                            "children": []
                                        }
                                    ]
                                }
                            ]
                        },
                        {
                            "type": "expression_statement",
                            "label": "input_links: list[Link] = []",
                            "start_token": 303,
                            "end_token": 311,
                            "children": [
                                {
                                    "type": "assignment",
                                    "label": "input_links: list[Link] = []",
                                    "start_token": 303,
                                    "end_token": 311,
                                    "children": [
                                        {
                                            "type": "identifier",
                                            "label": "input_links",
                                            "start_token": 303,
                                            "end_token": 303,
                                            "children": []
                                        },
                                        {
                                            "type": "type",
                                            "label": "list[Link]",
                                            "start_token": 305,
                                            "end_token": 308,
                                            "children": [
                                                {
                                                    "type": "generic_type",
                                                    "label": "list[Link]",
                                                    "start_token": 305,
                                                    "end_token": 308,
                                                    "children": [
                                                        {
                                                            "type": "identifier",
                                                            "label": "list",
                                                            "start_token": 305,
                                                            "end_token": 305,
                                                            "children": []
                                                        },
                                                        {
                                                            "type": "type_parameter",
                                                            "label": "[Link]",
                                                            "start_token": 306,
                                                            "end_token": 308,
                                                            "children": [
                                                                {
                                                                    "type": "type",
                                                                    "label": "Link",
                                                                    "start_token": 307,
                                                                    "end_token": 307,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "Link",
                                                                            "start_token": 307,
                                                                            "end_token": 307,
                                                                            "children": []
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                }
                                            ]
                                        },
                                        {
                                            "type": "list",
                                            "label": "[]",
                                            "start_token": 310,
                                            "end_token": 311,
                                            "children": []
                                        }
                                    ]
                                }
                            ]
                        },
                        {
                            "type": "expression_statement",
                            "label": "output_links: list[Link] = []",
                            "start_token": 313,
                            "end_token": 321,
                            "children": [
                                {
                                    "type": "assignment",
                                    "label": "output_links: list[Link] = []",
                                    "start_token": 313,
                                    "end_token": 321,
                                    "children": [
                                        {
                                            "type": "identifier",
                                            "label": "output_links",
                                            "start_token": 313,
                                            "end_token": 313,
                                            "children": []
                                        },
                                        {
                                            "type": "type",
                                            "label": "list[Link]",
                                            "start_token": 315,
                                            "end_token": 318,
                                            "children": [
                                                {
                                                    "type": "generic_type",
                                                    "label": "list[Link]",
                                                    "start_token": 315,
                                                    "end_token": 318,
                                                    "children": [
                                                        {
                                                            "type": "identifier",
                                                            "label": "list",
                                                            "start_token": 315,
                                                            "end_token": 315,
                                                            "children": []
                                                        },
                                                        {
                                                            "type": "type_parameter",
                                                            "label": "[Link]",
                                                            "start_token": 316,
                                                            "end_token": 318,
                                                            "children": [
                                                                {
                                                                    "type": "type",
                                                                    "label": "Link",
                                                                    "start_token": 317,
                                                                    "end_token": 317,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "Link",
                                                                            "start_token": 317,
                                                                            "end_token": 317,
                                                                            "children": []
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                }
                                            ]
                                        },
                                        {
                                            "type": "list",
                                            "label": "[]",
                                            "start_token": 320,
                                            "end_token": 321,
                                            "children": []
                                        }
                                    ]
                                }
                            ]
                        },
                        {
                            "type": "expression_statement",
                            "label": "webhook_id: Optional[str] = None",
                            "start_token": 324,
                            "end_token": 331,
                            "children": [
                                {
                                    "type": "assignment",
                                    "label": "webhook_id: Optional[str] = None",
                                    "start_token": 324,
                                    "end_token": 331,
                                    "children": [
                                        {
                                            "type": "identifier",
                                            "label": "webhook_id",
                                            "start_token": 324,
                                            "end_token": 324,
                                            "children": []
                                        },
                                        {
                                            "type": "type",
                                            "label": "Optional[str]",
                                            "start_token": 326,
                                            "end_token": 329,
                                            "children": [
                                                {
                                                    "type": "generic_type",
                                                    "label": "Optional[str]",
                                                    "start_token": 326,
                                                    "end_token": 329,
                                                    "children": [
                                                        {
                                                            "type": "identifier",
                                                            "label": "Optional",
                                                            "start_token": 326,
                                                            "end_token": 326,
                                                            "children": []
                                                        },
                                                        {
                                                            "type": "type_parameter",
                                                            "label": "[str]",
                                                            "start_token": 327,
                                                            "end_token": 329,
                                                            "children": [
                                                                {
                                                                    "type": "type",
                                                                    "label": "str",
                                                                    "start_token": 328,
                                                                    "end_token": 328,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "str",
                                                                            "start_token": 328,
                                                                            "end_token": 328,
                                                                            "children": []
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                }
                                            ]
                                        },
                                        {
                                            "type": "none",
                                            "label": "None",
                                            "start_token": 331,
                                            "end_token": 331,
                                            "children": []
                                        }
                                    ]
                                }
                            ]
                        }
                    ]
                }
            ]
        },
        {
            "type": "class_definition",
            "label": "class NodeModel(Node):\n    graph_id: str\n    graph_version: int\n\n    webhook: Optional[Webhook] = None\n\n    @staticmethod\n    def from_db(node: AgentNode):\n        if not node.AgentBlock:\n            raise ValueError(f\"Invalid node {node.id}, invalid AgentBlock.\")\n        obj = NodeModel(\n            id=node.id,\n            block_id=node.AgentBlock.id,\n            input_default=json.loads(node.constantInput, target_type=dict[str, Any]),\n            metadata=json.loads(node.metadata, target_type=dict[str, Any]),\n            graph_id=node.agentGraphId,\n            graph_version=node.agentGraphVersion,\n            webhook_id=node.webhookId,\n            webhook=Webhook.from_db(node.Webhook) if node.Webhook else None,\n        )\n        obj.input_links = [Link.from_db(link) for link in node.Input or []]\n        obj.output_links = [Link.from_db(link) for link in node.Output or []]\n        return obj\n\n    def is_triggered_by_event_type(self, event_type: str) -> bool:\n        if not (block := get_block(self.block_id)):\n            raise ValueError(f\"Block #{self.block_id} not found for node #{self.id}\")\n        if not block.webhook_config:\n            raise TypeError(\"This method can't be used on non-webhook blocks\")\n        if not block.webhook_config.event_filter_input:\n            return True\n        event_filter = self.input_default.get(block.webhook_config.event_filter_input)\n        if not event_filter:\n            raise ValueError(f\"Event filter is not configured on node #{self.id}\")\n        return event_type in [\n            block.webhook_config.event_format.format(event=k)\n            for k in event_filter\n            if event_filter[k] is True\n        ]",
            "start_token": 335,
            "end_token": 658,
            "children": [
                {
                    "type": "identifier",
                    "label": "NodeModel",
                    "start_token": 336,
                    "end_token": 336,
                    "children": []
                },
                {
                    "type": "argument_list",
                    "label": "(Node)",
                    "start_token": 337,
                    "end_token": 339,
                    "children": [
                        {
                            "type": "identifier",
                            "label": "Node",
                            "start_token": 338,
                            "end_token": 338,
                            "children": []
                        }
                    ]
                },
                {
                    "type": "block",
                    "label": "graph_id: str\n    graph_version: int\n\n    webhook: Optional[Webhook] = None\n\n    @staticmethod\n    def from_db(node: AgentNode):\n        if not node.AgentBlock:\n            raise ValueError(f\"Invalid node {node.id}, invalid AgentBlock.\")\n        obj = NodeModel(\n            id=node.id,\n            block_id=node.AgentBlock.id,\n            input_default=json.loads(node.constantInput, target_type=dict[str, Any]),\n            metadata=json.loads(node.metadata, target_type=dict[str, Any]),\n            graph_id=node.agentGraphId,\n            graph_version=node.agentGraphVersion,\n            webhook_id=node.webhookId,\n            webhook=Webhook.from_db(node.Webhook) if node.Webhook else None,\n        )\n        obj.input_links = [Link.from_db(link) for link in node.Input or []]\n        obj.output_links = [Link.from_db(link) for link in node.Output or []]\n        return obj\n\n    def is_triggered_by_event_type(self, event_type: str) -> bool:\n        if not (block := get_block(self.block_id)):\n            raise ValueError(f\"Block #{self.block_id} not found for node #{self.id}\")\n        if not block.webhook_config:\n            raise TypeError(\"This method can't be used on non-webhook blocks\")\n        if not block.webhook_config.event_filter_input:\n            return True\n        event_filter = self.input_default.get(block.webhook_config.event_filter_input)\n        if not event_filter:\n            raise ValueError(f\"Event filter is not configured on node #{self.id}\")\n        return event_type in [\n            block.webhook_config.event_format.format(event=k)\n            for k in event_filter\n            if event_filter[k] is True\n        ]",
                    "start_token": 342,
                    "end_token": 658,
                    "children": [
                        {
                            "type": "expression_statement",
                            "label": "graph_id: str",
                            "start_token": 342,
                            "end_token": 344,
                            "children": [
                                {
                                    "type": "assignment",
                                    "label": "graph_id: str",
                                    "start_token": 342,
                                    "end_token": 344,
                                    "children": [
                                        {
                                            "type": "identifier",
                                            "label": "graph_id",
                                            "start_token": 342,
                                            "end_token": 342,
                                            "children": []
                                        },
                                        {
                                            "type": "type",
                                            "label": "str",
                                            "start_token": 344,
                                            "end_token": 344,
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "label": "str",
                                                    "start_token": 344,
                                                    "end_token": 344,
                                                    "children": []
                                                }
                                            ]
                                        }
                                    ]
                                }
                            ]
                        },
                        {
                            "type": "expression_statement",
                            "label": "graph_version: int",
                            "start_token": 346,
                            "end_token": 348,
                            "children": [
                                {
                                    "type": "assignment",
                                    "label": "graph_version: int",
                                    "start_token": 346,
                                    "end_token": 348,
                                    "children": [
                                        {
                                            "type": "identifier",
                                            "label": "graph_version",
                                            "start_token": 346,
                                            "end_token": 346,
                                            "children": []
                                        },
                                        {
                                            "type": "type",
                                            "label": "int",
                                            "start_token": 348,
                                            "end_token": 348,
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "label": "int",
                                                    "start_token": 348,
                                                    "end_token": 348,
                                                    "children": []
                                                }
                                            ]
                                        }
                                    ]
                                }
                            ]
                        },
                        {
                            "type": "expression_statement",
                            "label": "webhook: Optional[Webhook] = None",
                            "start_token": 351,
                            "end_token": 358,
                            "children": [
                                {
                                    "type": "assignment",
                                    "label": "webhook: Optional[Webhook] = None",
                                    "start_token": 351,
                                    "end_token": 358,
                                    "children": [
                                        {
                                            "type": "identifier",
                                            "label": "webhook",
                                            "start_token": 351,
                                            "end_token": 351,
                                            "children": []
                                        },
                                        {
                                            "type": "type",
                                            "label": "Optional[Webhook]",
                                            "start_token": 353,
                                            "end_token": 356,
                                            "children": [
                                                {
                                                    "type": "generic_type",
                                                    "label": "Optional[Webhook]",
                                                    "start_token": 353,
                                                    "end_token": 356,
                                                    "children": [
                                                        {
                                                            "type": "identifier",
                                                            "label": "Optional",
                                                            "start_token": 353,
                                                            "end_token": 353,
                                                            "children": []
                                                        },
                                                        {
                                                            "type": "type_parameter",
                                                            "label": "[Webhook]",
                                                            "start_token": 354,
                                                            "end_token": 356,
                                                            "children": [
                                                                {
                                                                    "type": "type",
                                                                    "label": "Webhook",
                                                                    "start_token": 355,
                                                                    "end_token": 355,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "Webhook",
                                                                            "start_token": 355,
                                                                            "end_token": 355,
                                                                            "children": []
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                }
                                            ]
                                        },
                                        {
                                            "type": "none",
                                            "label": "None",
                                            "start_token": 358,
                                            "end_token": 358,
                                            "children": []
                                        }
                                    ]
                                }
                            ]
                        },
                        {
                            "type": "decorated_definition",
                            "label": "@staticmethod\n    def from_db(node: AgentNode):\n        if not node.AgentBlock:\n            raise ValueError(f\"Invalid node {node.id}, invalid AgentBlock.\")\n        obj = NodeModel(\n            id=node.id,\n            block_id=node.AgentBlock.id,\n            input_default=json.loads(node.constantInput, target_type=dict[str, Any]),\n            metadata=json.loads(node.metadata, target_type=dict[str, Any]),\n            graph_id=node.agentGraphId,\n            graph_version=node.agentGraphVersion,\n            webhook_id=node.webhookId,\n            webhook=Webhook.from_db(node.Webhook) if node.Webhook else None,\n        )\n        obj.input_links = [Link.from_db(link) for link in node.Input or []]\n        obj.output_links = [Link.from_db(link) for link in node.Output or []]\n        return obj",
                            "start_token": 361,
                            "end_token": 536,
                            "children": [
                                {
                                    "type": "decorator",
                                    "label": "@staticmethod",
                                    "start_token": 361,
                                    "end_token": 362,
                                    "children": [
                                        {
                                            "type": "identifier",
                                            "label": "staticmethod",
                                            "start_token": 362,
                                            "end_token": 362,
                                            "children": []
                                        }
                                    ]
                                },
                                {
                                    "type": "function_definition",
                                    "label": "def from_db(node: AgentNode):\n        if not node.AgentBlock:\n            raise ValueError(f\"Invalid node {node.id}, invalid AgentBlock.\")\n        obj = NodeModel(\n            id=node.id,\n            block_id=node.AgentBlock.id,\n            input_default=json.loads(node.constantInput, target_type=dict[str, Any]),\n            metadata=json.loads(node.metadata, target_type=dict[str, Any]),\n            graph_id=node.agentGraphId,\n            graph_version=node.agentGraphVersion,\n            webhook_id=node.webhookId,\n            webhook=Webhook.from_db(node.Webhook) if node.Webhook else None,\n        )\n        obj.input_links = [Link.from_db(link) for link in node.Input or []]\n        obj.output_links = [Link.from_db(link) for link in node.Output or []]\n        return obj",
                                    "start_token": 364,
                                    "end_token": 536,
                                    "children": [
                                        {
                                            "type": "identifier",
                                            "label": "from_db",
                                            "start_token": 365,
                                            "end_token": 365,
                                            "children": []
                                        },
                                        {
                                            "type": "parameters",
                                            "label": "(node: AgentNode)",
                                            "start_token": 366,
                                            "end_token": 370,
                                            "children": [
                                                {
                                                    "type": "typed_parameter",
                                                    "label": "node: AgentNode",
                                                    "start_token": 367,
                                                    "end_token": 369,
                                                    "children": [
                                                        {
                                                            "type": "identifier",
                                                            "label": "node",
                                                            "start_token": 367,
                                                            "end_token": 367,
                                                            "children": []
                                                        },
                                                        {
                                                            "type": "type",
                                                            "label": "AgentNode",
                                                            "start_token": 369,
                                                            "end_token": 369,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "label": "AgentNode",
                                                                    "start_token": 369,
                                                                    "end_token": 369,
                                                                    "children": []
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                }
                                            ]
                                        },
                                        {
                                            "type": "block",
                                            "label": "if not node.AgentBlock:\n            raise ValueError(f\"Invalid node {node.id}, invalid AgentBlock.\")\n        obj = NodeModel(\n            id=node.id,\n            block_id=node.AgentBlock.id,\n            input_default=json.loads(node.constantInput, target_type=dict[str, Any]),\n            metadata=json.loads(node.metadata, target_type=dict[str, Any]),\n            graph_id=node.agentGraphId,\n            graph_version=node.agentGraphVersion,\n            webhook_id=node.webhookId,\n            webhook=Webhook.from_db(node.Webhook) if node.Webhook else None,\n        )\n        obj.input_links = [Link.from_db(link) for link in node.Input or []]\n        obj.output_links = [Link.from_db(link) for link in node.Output or []]\n        return obj",
                                            "start_token": 373,
                                            "end_token": 536,
                                            "children": [
                                                {
                                                    "type": "if_statement",
                                                    "label": "if not node.AgentBlock:\n            raise ValueError(f\"Invalid node {node.id}, invalid AgentBlock.\")",
                                                    "start_token": 373,
                                                    "end_token": 385,
                                                    "children": [
                                                        {
                                                            "type": "not_operator",
                                                            "label": "not node.AgentBlock",
                                                            "start_token": 374,
                                                            "end_token": 377,
                                                            "children": [
                                                                {
                                                                    "type": "attribute",
                                                                    "label": "node.AgentBlock",
                                                                    "start_token": 375,
                                                                    "end_token": 377,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "node",
                                                                            "start_token": 375,
                                                                            "end_token": 375,
                                                                            "children": []
                                                                        },
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "AgentBlock",
                                                                            "start_token": 377,
                                                                            "end_token": 377,
                                                                            "children": []
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        },
                                                        {
                                                            "type": "block",
                                                            "label": "raise ValueError(f\"Invalid node {node.id}, invalid AgentBlock.\")",
                                                            "start_token": 380,
                                                            "end_token": 385,
                                                            "children": [
                                                                {
                                                                    "type": "raise_statement",
                                                                    "label": "raise ValueError(f\"Invalid node {node.id}, invalid AgentBlock.\")",
                                                                    "start_token": 380,
                                                                    "end_token": 385,
                                                                    "children": [
                                                                        {
                                                                            "type": "call",
                                                                            "label": "ValueError(f\"Invalid node {node.id}, invalid AgentBlock.\")",
                                                                            "start_token": 381,
                                                                            "end_token": 385,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "ValueError",
                                                                                    "start_token": 381,
                                                                                    "end_token": 381,
                                                                                    "children": []
                                                                                },
                                                                                {
                                                                                    "type": "argument_list",
                                                                                    "label": "(f\"Invalid node {node.id}, invalid AgentBlock.\")",
                                                                                    "start_token": 382,
                                                                                    "end_token": 385,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "string",
                                                                                            "label": "f\"Invalid node {node.id}, invalid AgentBlock.\"",
                                                                                            "start_token": 383,
                                                                                            "end_token": 384,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "string_start",
                                                                                                    "label": "f\"",
                                                                                                    "start_token": 383,
                                                                                                    "end_token": 384,
                                                                                                    "children": []
                                                                                                },
                                                                                                {
                                                                                                    "type": "string_content",
                                                                                                    "label": "Invalid node ",
                                                                                                    "start_token": 384,
                                                                                                    "end_token": 384,
                                                                                                    "children": []
                                                                                                },
                                                                                                {
                                                                                                    "type": "interpolation",
                                                                                                    "label": "{node.id}",
                                                                                                    "start_token": 384,
                                                                                                    "end_token": 384,
                                                                                                    "children": [
                                                                                                        {
                                                                                                            "type": "attribute",
                                                                                                            "label": "node.id",
                                                                                                            "start_token": 384,
                                                                                                            "end_token": 384,
                                                                                                            "children": [
                                                                                                                {
                                                                                                                    "type": "identifier",
                                                                                                                    "label": "node",
                                                                                                                    "start_token": 384,
                                                                                                                    "end_token": 384,
                                                                                                                    "children": []
                                                                                                                },
                                                                                                                {
                                                                                                                    "type": "identifier",
                                                                                                                    "label": "id",
                                                                                                                    "start_token": 384,
                                                                                                                    "end_token": 384,
                                                                                                                    "children": []
                                                                                                                }
                                                                                                            ]
                                                                                                        }
                                                                                                    ]
                                                                                                },
                                                                                                {
                                                                                                    "type": "string_content",
                                                                                                    "label": ", invalid AgentBlock.",
                                                                                                    "start_token": 384,
                                                                                                    "end_token": 384,
                                                                                                    "children": []
                                                                                                },
                                                                                                {
                                                                                                    "type": "string_end",
                                                                                                    "label": "\"",
                                                                                                    "start_token": 384,
                                                                                                    "end_token": 384,
                                                                                                    "children": []
                                                                                                }
                                                                                            ]
                                                                                        }
                                                                                    ]
                                                                                }
                                                                            ]
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                },
                                                {
                                                    "type": "expression_statement",
                                                    "label": "obj = NodeModel(\n            id=node.id,\n            block_id=node.AgentBlock.id,\n            input_default=json.loads(node.constantInput, target_type=dict[str, Any]),\n            metadata=json.loads(node.metadata, target_type=dict[str, Any]),\n            graph_id=node.agentGraphId,\n            graph_version=node.agentGraphVersion,\n            webhook_id=node.webhookId,\n            webhook=Webhook.from_db(node.Webhook) if node.Webhook else None,\n        )",
                                                    "start_token": 387,
                                                    "end_token": 489,
                                                    "children": [
                                                        {
                                                            "type": "assignment",
                                                            "label": "obj = NodeModel(\n            id=node.id,\n            block_id=node.AgentBlock.id,\n            input_default=json.loads(node.constantInput, target_type=dict[str, Any]),\n            metadata=json.loads(node.metadata, target_type=dict[str, Any]),\n            graph_id=node.agentGraphId,\n            graph_version=node.agentGraphVersion,\n            webhook_id=node.webhookId,\n            webhook=Webhook.from_db(node.Webhook) if node.Webhook else None,\n        )",
                                                            "start_token": 387,
                                                            "end_token": 489,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "label": "obj",
                                                                    "start_token": 387,
                                                                    "end_token": 387,
                                                                    "children": []
                                                                },
                                                                {
                                                                    "type": "call",
                                                                    "label": "NodeModel(\n            id=node.id,\n            block_id=node.AgentBlock.id,\n            input_default=json.loads(node.constantInput, target_type=dict[str, Any]),\n            metadata=json.loads(node.metadata, target_type=dict[str, Any]),\n            graph_id=node.agentGraphId,\n            graph_version=node.agentGraphVersion,\n            webhook_id=node.webhookId,\n            webhook=Webhook.from_db(node.Webhook) if node.Webhook else None,\n        )",
                                                                    "start_token": 389,
                                                                    "end_token": 489,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "NodeModel",
                                                                            "start_token": 389,
                                                                            "end_token": 389,
                                                                            "children": []
                                                                        },
                                                                        {
                                                                            "type": "argument_list",
                                                                            "label": "(\n            id=node.id,\n            block_id=node.AgentBlock.id,\n            input_default=json.loads(node.constantInput, target_type=dict[str, Any]),\n            metadata=json.loads(node.metadata, target_type=dict[str, Any]),\n            graph_id=node.agentGraphId,\n            graph_version=node.agentGraphVersion,\n            webhook_id=node.webhookId,\n            webhook=Webhook.from_db(node.Webhook) if node.Webhook else None,\n        )",
                                                                            "start_token": 390,
                                                                            "end_token": 489,
                                                                            "children": [
                                                                                {
                                                                                    "type": "keyword_argument",
                                                                                    "label": "id=node.id",
                                                                                    "start_token": 392,
                                                                                    "end_token": 396,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "label": "id",
                                                                                            "start_token": 392,
                                                                                            "end_token": 392,
                                                                                            "children": []
                                                                                        },
                                                                                        {
                                                                                            "type": "attribute",
                                                                                            "label": "node.id",
                                                                                            "start_token": 394,
                                                                                            "end_token": 396,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "label": "node",
                                                                                                    "start_token": 394,
                                                                                                    "end_token": 394,
                                                                                                    "children": []
                                                                                                },
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "label": "id",
                                                                                                    "start_token": 396,
                                                                                                    "end_token": 396,
                                                                                                    "children": []
                                                                                                }
                                                                                            ]
                                                                                        }
                                                                                    ]
                                                                                },
                                                                                {
                                                                                    "type": "keyword_argument",
                                                                                    "label": "block_id=node.AgentBlock.id",
                                                                                    "start_token": 399,
                                                                                    "end_token": 405,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "label": "block_id",
                                                                                            "start_token": 399,
                                                                                            "end_token": 399,
                                                                                            "children": []
                                                                                        },
                                                                                        {
                                                                                            "type": "attribute",
                                                                                            "label": "node.AgentBlock.id",
                                                                                            "start_token": 401,
                                                                                            "end_token": 405,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "attribute",
                                                                                                    "label": "node.AgentBlock",
                                                                                                    "start_token": 401,
                                                                                                    "end_token": 403,
                                                                                                    "children": [
                                                                                                        {
                                                                                                            "type": "identifier",
                                                                                                            "label": "node",
                                                                                                            "start_token": 401,
                                                                                                            "end_token": 401,
                                                                                                            "children": []
                                                                                                        },
                                                                                                        {
                                                                                                            "type": "identifier",
                                                                                                            "label": "AgentBlock",
                                                                                                            "start_token": 403,
                                                                                                            "end_token": 403,
                                                                                                            "children": []
                                                                                                        }
                                                                                                    ]
                                                                                                },
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "label": "id",
                                                                                                    "start_token": 405,
                                                                                                    "end_token": 405,
                                                                                                    "children": []
                                                                                                }
                                                                                            ]
                                                                                        }
                                                                                    ]
                                                                                },
                                                                                {
                                                                                    "type": "keyword_argument",
                                                                                    "label": "input_default=json.loads(node.constantInput, target_type=dict[str, Any])",
                                                                                    "start_token": 408,
                                                                                    "end_token": 426,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "label": "input_default",
                                                                                            "start_token": 408,
                                                                                            "end_token": 408,
                                                                                            "children": []
                                                                                        },
                                                                                        {
                                                                                            "type": "call",
                                                                                            "label": "json.loads(node.constantInput, target_type=dict[str, Any])",
                                                                                            "start_token": 410,
                                                                                            "end_token": 426,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "attribute",
                                                                                                    "label": "json.loads",
                                                                                                    "start_token": 410,
                                                                                                    "end_token": 412,
                                                                                                    "children": [
                                                                                                        {
                                                                                                            "type": "identifier",
                                                                                                            "label": "json",
                                                                                                            "start_token": 410,
                                                                                                            "end_token": 410,
                                                                                                            "children": []
                                                                                                        },
                                                                                                        {
                                                                                                            "type": "identifier",
                                                                                                            "label": "loads",
                                                                                                            "start_token": 412,
                                                                                                            "end_token": 412,
                                                                                                            "children": []
                                                                                                        }
                                                                                                    ]
                                                                                                },
                                                                                                {
                                                                                                    "type": "argument_list",
                                                                                                    "label": "(node.constantInput, target_type=dict[str, Any])",
                                                                                                    "start_token": 413,
                                                                                                    "end_token": 426,
                                                                                                    "children": [
                                                                                                        {
                                                                                                            "type": "attribute",
                                                                                                            "label": "node.constantInput",
                                                                                                            "start_token": 414,
                                                                                                            "end_token": 416,
                                                                                                            "children": [
                                                                                                                {
                                                                                                                    "type": "identifier",
                                                                                                                    "label": "node",
                                                                                                                    "start_token": 414,
                                                                                                                    "end_token": 414,
                                                                                                                    "children": []
                                                                                                                },
                                                                                                                {
                                                                                                                    "type": "identifier",
                                                                                                                    "label": "constantInput",
                                                                                                                    "start_token": 416,
                                                                                                                    "end_token": 416,
                                                                                                                    "children": []
                                                                                                                }
                                                                                                            ]
                                                                                                        },
                                                                                                        {
                                                                                                            "type": "keyword_argument",
                                                                                                            "label": "target_type=dict[str, Any]",
                                                                                                            "start_token": 418,
                                                                                                            "end_token": 425,
                                                                                                            "children": [
                                                                                                                {
                                                                                                                    "type": "identifier",
                                                                                                                    "label": "target_type",
                                                                                                                    "start_token": 418,
                                                                                                                    "end_token": 418,
                                                                                                                    "children": []
                                                                                                                },
                                                                                                                {
                                                                                                                    "type": "subscript",
                                                                                                                    "label": "dict[str, Any]",
                                                                                                                    "start_token": 420,
                                                                                                                    "end_token": 425,
                                                                                                                    "children": [
                                                                                                                        {
                                                                                                                            "type": "identifier",
                                                                                                                            "label": "dict",
                                                                                                                            "start_token": 420,
                                                                                                                            "end_token": 420,
                                                                                                                            "children": []
                                                                                                                        },
                                                                                                                        {
                                                                                                                            "type": "identifier",
                                                                                                                            "label": "str",
                                                                                                                            "start_token": 422,
                                                                                                                            "end_token": 422,
                                                                                                                            "children": []
                                                                                                                        },
                                                                                                                        {
                                                                                                                            "type": "identifier",
                                                                                                                            "label": "Any",
                                                                                                                            "start_token": 424,
                                                                                                                            "end_token": 424,
                                                                                                                            "children": []
                                                                                                                        }
                                                                                                                    ]
                                                                                                                }
                                                                                                            ]
                                                                                                        }
                                                                                                    ]
                                                                                                }
                                                                                            ]
                                                                                        }
                                                                                    ]
                                                                                },
                                                                                {
                                                                                    "type": "keyword_argument",
                                                                                    "label": "metadata=json.loads(node.metadata, target_type=dict[str, Any])",
                                                                                    "start_token": 429,
                                                                                    "end_token": 447,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "label": "metadata",
                                                                                            "start_token": 429,
                                                                                            "end_token": 429,
                                                                                            "children": []
                                                                                        },
                                                                                        {
                                                                                            "type": "call",
                                                                                            "label": "json.loads(node.metadata, target_type=dict[str, Any])",
                                                                                            "start_token": 431,
                                                                                            "end_token": 447,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "attribute",
                                                                                                    "label": "json.loads",
                                                                                                    "start_token": 431,
                                                                                                    "end_token": 433,
                                                                                                    "children": [
                                                                                                        {
                                                                                                            "type": "identifier",
                                                                                                            "label": "json",
                                                                                                            "start_token": 431,
                                                                                                            "end_token": 431,
                                                                                                            "children": []
                                                                                                        },
                                                                                                        {
                                                                                                            "type": "identifier",
                                                                                                            "label": "loads",
                                                                                                            "start_token": 433,
                                                                                                            "end_token": 433,
                                                                                                            "children": []
                                                                                                        }
                                                                                                    ]
                                                                                                },
                                                                                                {
                                                                                                    "type": "argument_list",
                                                                                                    "label": "(node.metadata, target_type=dict[str, Any])",
                                                                                                    "start_token": 434,
                                                                                                    "end_token": 447,
                                                                                                    "children": [
                                                                                                        {
                                                                                                            "type": "attribute",
                                                                                                            "label": "node.metadata",
                                                                                                            "start_token": 435,
                                                                                                            "end_token": 437,
                                                                                                            "children": [
                                                                                                                {
                                                                                                                    "type": "identifier",
                                                                                                                    "label": "node",
                                                                                                                    "start_token": 435,
                                                                                                                    "end_token": 435,
                                                                                                                    "children": []
                                                                                                                },
                                                                                                                {
                                                                                                                    "type": "identifier",
                                                                                                                    "label": "metadata",
                                                                                                                    "start_token": 437,
                                                                                                                    "end_token": 437,
                                                                                                                    "children": []
                                                                                                                }
                                                                                                            ]
                                                                                                        },
                                                                                                        {
                                                                                                            "type": "keyword_argument",
                                                                                                            "label": "target_type=dict[str, Any]",
                                                                                                            "start_token": 439,
                                                                                                            "end_token": 446,
                                                                                                            "children": [
                                                                                                                {
                                                                                                                    "type": "identifier",
                                                                                                                    "label": "target_type",
                                                                                                                    "start_token": 439,
                                                                                                                    "end_token": 439,
                                                                                                                    "children": []
                                                                                                                },
                                                                                                                {
                                                                                                                    "type": "subscript",
                                                                                                                    "label": "dict[str, Any]",
                                                                                                                    "start_token": 441,
                                                                                                                    "end_token": 446,
                                                                                                                    "children": [
                                                                                                                        {
                                                                                                                            "type": "identifier",
                                                                                                                            "label": "dict",
                                                                                                                            "start_token": 441,
                                                                                                                            "end_token": 441,
                                                                                                                            "children": []
                                                                                                                        },
                                                                                                                        {
                                                                                                                            "type": "identifier",
                                                                                                                            "label": "str",
                                                                                                                            "start_token": 443,
                                                                                                                            "end_token": 443,
                                                                                                                            "children": []
                                                                                                                        },
                                                                                                                        {
                                                                                                                            "type": "identifier",
                                                                                                                            "label": "Any",
                                                                                                                            "start_token": 445,
                                                                                                                            "end_token": 445,
                                                                                                                            "children": []
                                                                                                                        }
                                                                                                                    ]
                                                                                                                }
                                                                                                            ]
                                                                                                        }
                                                                                                    ]
                                                                                                }
                                                                                            ]
                                                                                        }
                                                                                    ]
                                                                                },
                                                                                {
                                                                                    "type": "keyword_argument",
                                                                                    "label": "graph_id=node.agentGraphId",
                                                                                    "start_token": 450,
                                                                                    "end_token": 454,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "label": "graph_id",
                                                                                            "start_token": 450,
                                                                                            "end_token": 450,
                                                                                            "children": []
                                                                                        },
                                                                                        {
                                                                                            "type": "attribute",
                                                                                            "label": "node.agentGraphId",
                                                                                            "start_token": 452,
                                                                                            "end_token": 454,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "label": "node",
                                                                                                    "start_token": 452,
                                                                                                    "end_token": 452,
                                                                                                    "children": []
                                                                                                },
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "label": "agentGraphId",
                                                                                                    "start_token": 454,
                                                                                                    "end_token": 454,
                                                                                                    "children": []
                                                                                                }
                                                                                            ]
                                                                                        }
                                                                                    ]
                                                                                },
                                                                                {
                                                                                    "type": "keyword_argument",
                                                                                    "label": "graph_version=node.agentGraphVersion",
                                                                                    "start_token": 457,
                                                                                    "end_token": 461,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "label": "graph_version",
                                                                                            "start_token": 457,
                                                                                            "end_token": 457,
                                                                                            "children": []
                                                                                        },
                                                                                        {
                                                                                            "type": "attribute",
                                                                                            "label": "node.agentGraphVersion",
                                                                                            "start_token": 459,
                                                                                            "end_token": 461,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "label": "node",
                                                                                                    "start_token": 459,
                                                                                                    "end_token": 459,
                                                                                                    "children": []
                                                                                                },
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "label": "agentGraphVersion",
                                                                                                    "start_token": 461,
                                                                                                    "end_token": 461,
                                                                                                    "children": []
                                                                                                }
                                                                                            ]
                                                                                        }
                                                                                    ]
                                                                                },
                                                                                {
                                                                                    "type": "keyword_argument",
                                                                                    "label": "webhook_id=node.webhookId",
                                                                                    "start_token": 464,
                                                                                    "end_token": 468,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "label": "webhook_id",
                                                                                            "start_token": 464,
                                                                                            "end_token": 464,
                                                                                            "children": []
                                                                                        },
                                                                                        {
                                                                                            "type": "attribute",
                                                                                            "label": "node.webhookId",
                                                                                            "start_token": 466,
                                                                                            "end_token": 468,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "label": "node",
                                                                                                    "start_token": 466,
                                                                                                    "end_token": 466,
                                                                                                    "children": []
                                                                                                },
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "label": "webhookId",
                                                                                                    "start_token": 468,
                                                                                                    "end_token": 468,
                                                                                                    "children": []
                                                                                                }
                                                                                            ]
                                                                                        }
                                                                                    ]
                                                                                },
                                                                                {
                                                                                    "type": "keyword_argument",
                                                                                    "label": "webhook=Webhook.from_db(node.Webhook) if node.Webhook else None",
                                                                                    "start_token": 471,
                                                                                    "end_token": 486,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "label": "webhook",
                                                                                            "start_token": 471,
                                                                                            "end_token": 471,
                                                                                            "children": []
                                                                                        },
                                                                                        {
                                                                                            "type": "conditional_expression",
                                                                                            "label": "Webhook.from_db(node.Webhook) if node.Webhook else None",
                                                                                            "start_token": 473,
                                                                                            "end_token": 486,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "call",
                                                                                                    "label": "Webhook.from_db(node.Webhook)",
                                                                                                    "start_token": 473,
                                                                                                    "end_token": 480,
                                                                                                    "children": [
                                                                                                        {
                                                                                                            "type": "attribute",
                                                                                                            "label": "Webhook.from_db",
                                                                                                            "start_token": 473,
                                                                                                            "end_token": 475,
                                                                                                            "children": [
                                                                                                                {
                                                                                                                    "type": "identifier",
                                                                                                                    "label": "Webhook",
                                                                                                                    "start_token": 473,
                                                                                                                    "end_token": 473,
                                                                                                                    "children": []
                                                                                                                },
                                                                                                                {
                                                                                                                    "type": "identifier",
                                                                                                                    "label": "from_db",
                                                                                                                    "start_token": 475,
                                                                                                                    "end_token": 475,
                                                                                                                    "children": []
                                                                                                                }
                                                                                                            ]
                                                                                                        },
                                                                                                        {
                                                                                                            "type": "argument_list",
                                                                                                            "label": "(node.Webhook)",
                                                                                                            "start_token": 476,
                                                                                                            "end_token": 480,
                                                                                                            "children": [
                                                                                                                {
                                                                                                                    "type": "attribute",
                                                                                                                    "label": "node.Webhook",
                                                                                                                    "start_token": 477,
                                                                                                                    "end_token": 479,
                                                                                                                    "children": [
                                                                                                                        {
                                                                                                                            "type": "identifier",
                                                                                                                            "label": "node",
                                                                                                                            "start_token": 477,
                                                                                                                            "end_token": 477,
                                                                                                                            "children": []
                                                                                                                        },
                                                                                                                        {
                                                                                                                            "type": "identifier",
                                                                                                                            "label": "Webhook",
                                                                                                                            "start_token": 479,
                                                                                                                            "end_token": 479,
                                                                                                                            "children": []
                                                                                                                        }
                                                                                                                    ]
                                                                                                                }
                                                                                                            ]
                                                                                                        }
                                                                                                    ]
                                                                                                },
                                                                                                {
                                                                                                    "type": "attribute",
                                                                                                    "label": "node.Webhook",
                                                                                                    "start_token": 482,
                                                                                                    "end_token": 484,
                                                                                                    "children": [
                                                                                                        {
                                                                                                            "type": "identifier",
                                                                                                            "label": "node",
                                                                                                            "start_token": 482,
                                                                                                            "end_token": 482,
                                                                                                            "children": []
                                                                                                        },
                                                                                                        {
                                                                                                            "type": "identifier",
                                                                                                            "label": "Webhook",
                                                                                                            "start_token": 484,
                                                                                                            "end_token": 484,
                                                                                                            "children": []
                                                                                                        }
                                                                                                    ]
                                                                                                },
                                                                                                {
                                                                                                    "type": "none",
                                                                                                    "label": "None",
                                                                                                    "start_token": 486,
                                                                                                    "end_token": 486,
                                                                                                    "children": []
                                                                                                }
                                                                                            ]
                                                                                        }
                                                                                    ]
                                                                                }
                                                                            ]
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                },
                                                {
                                                    "type": "expression_statement",
                                                    "label": "obj.input_links = [Link.from_db(link) for link in node.Input or []]",
                                                    "start_token": 491,
                                                    "end_token": 511,
                                                    "children": [
                                                        {
                                                            "type": "assignment",
                                                            "label": "obj.input_links = [Link.from_db(link) for link in node.Input or []]",
                                                            "start_token": 491,
                                                            "end_token": 511,
                                                            "children": [
                                                                {
                                                                    "type": "attribute",
                                                                    "label": "obj.input_links",
                                                                    "start_token": 491,
                                                                    "end_token": 493,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "obj",
                                                                            "start_token": 491,
                                                                            "end_token": 491,
                                                                            "children": []
                                                                        },
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "input_links",
                                                                            "start_token": 493,
                                                                            "end_token": 493,
                                                                            "children": []
                                                                        }
                                                                    ]
                                                                },
                                                                {
                                                                    "type": "list_comprehension",
                                                                    "label": "[Link.from_db(link) for link in node.Input or []]",
                                                                    "start_token": 495,
                                                                    "end_token": 511,
                                                                    "children": [
                                                                        {
                                                                            "type": "call",
                                                                            "label": "Link.from_db(link)",
                                                                            "start_token": 496,
                                                                            "end_token": 501,
                                                                            "children": [
                                                                                {
                                                                                    "type": "attribute",
                                                                                    "label": "Link.from_db",
                                                                                    "start_token": 496,
                                                                                    "end_token": 498,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "label": "Link",
                                                                                            "start_token": 496,
                                                                                            "end_token": 496,
                                                                                            "children": []
                                                                                        },
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "label": "from_db",
                                                                                            "start_token": 498,
                                                                                            "end_token": 498,
                                                                                            "children": []
                                                                                        }
                                                                                    ]
                                                                                },
                                                                                {
                                                                                    "type": "argument_list",
                                                                                    "label": "(link)",
                                                                                    "start_token": 499,
                                                                                    "end_token": 501,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "label": "link",
                                                                                            "start_token": 500,
                                                                                            "end_token": 500,
                                                                                            "children": []
                                                                                        }
                                                                                    ]
                                                                                }
                                                                            ]
                                                                        },
                                                                        {
                                                                            "type": "for_in_clause",
                                                                            "label": "for link in node.Input or []",
                                                                            "start_token": 502,
                                                                            "end_token": 510,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "link",
                                                                                    "start_token": 503,
                                                                                    "end_token": 503,
                                                                                    "children": []
                                                                                },
                                                                                {
                                                                                    "type": "boolean_operator",
                                                                                    "label": "node.Input or []",
                                                                                    "start_token": 505,
                                                                                    "end_token": 510,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "attribute",
                                                                                            "label": "node.Input",
                                                                                            "start_token": 505,
                                                                                            "end_token": 507,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "label": "node",
                                                                                                    "start_token": 505,
                                                                                                    "end_token": 505,
                                                                                                    "children": []
                                                                                                },
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "label": "Input",
                                                                                                    "start_token": 507,
                                                                                                    "end_token": 507,
                                                                                                    "children": []
                                                                                                }
                                                                                            ]
                                                                                        },
                                                                                        {
                                                                                            "type": "list",
                                                                                            "label": "[]",
                                                                                            "start_token": 509,
                                                                                            "end_token": 510,
                                                                                            "children": []
                                                                                        }
                                                                                    ]
                                                                                }
                                                                            ]
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                },
                                                {
                                                    "type": "expression_statement",
                                                    "label": "obj.output_links = [Link.from_db(link) for link in node.Output or []]",
                                                    "start_token": 513,
                                                    "end_token": 533,
                                                    "children": [
                                                        {
                                                            "type": "assignment",
                                                            "label": "obj.output_links = [Link.from_db(link) for link in node.Output or []]",
                                                            "start_token": 513,
                                                            "end_token": 533,
                                                            "children": [
                                                                {
                                                                    "type": "attribute",
                                                                    "label": "obj.output_links",
                                                                    "start_token": 513,
                                                                    "end_token": 515,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "obj",
                                                                            "start_token": 513,
                                                                            "end_token": 513,
                                                                            "children": []
                                                                        },
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "output_links",
                                                                            "start_token": 515,
                                                                            "end_token": 515,
                                                                            "children": []
                                                                        }
                                                                    ]
                                                                },
                                                                {
                                                                    "type": "list_comprehension",
                                                                    "label": "[Link.from_db(link) for link in node.Output or []]",
                                                                    "start_token": 517,
                                                                    "end_token": 533,
                                                                    "children": [
                                                                        {
                                                                            "type": "call",
                                                                            "label": "Link.from_db(link)",
                                                                            "start_token": 518,
                                                                            "end_token": 523,
                                                                            "children": [
                                                                                {
                                                                                    "type": "attribute",
                                                                                    "label": "Link.from_db",
                                                                                    "start_token": 518,
                                                                                    "end_token": 520,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "label": "Link",
                                                                                            "start_token": 518,
                                                                                            "end_token": 518,
                                                                                            "children": []
                                                                                        },
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "label": "from_db",
                                                                                            "start_token": 520,
                                                                                            "end_token": 520,
                                                                                            "children": []
                                                                                        }
                                                                                    ]
                                                                                },
                                                                                {
                                                                                    "type": "argument_list",
                                                                                    "label": "(link)",
                                                                                    "start_token": 521,
                                                                                    "end_token": 523,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "label": "link",
                                                                                            "start_token": 522,
                                                                                            "end_token": 522,
                                                                                            "children": []
                                                                                        }
                                                                                    ]
                                                                                }
                                                                            ]
                                                                        },
                                                                        {
                                                                            "type": "for_in_clause",
                                                                            "label": "for link in node.Output or []",
                                                                            "start_token": 524,
                                                                            "end_token": 532,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "link",
                                                                                    "start_token": 525,
                                                                                    "end_token": 525,
                                                                                    "children": []
                                                                                },
                                                                                {
                                                                                    "type": "boolean_operator",
                                                                                    "label": "node.Output or []",
                                                                                    "start_token": 527,
                                                                                    "end_token": 532,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "attribute",
                                                                                            "label": "node.Output",
                                                                                            "start_token": 527,
                                                                                            "end_token": 529,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "label": "node",
                                                                                                    "start_token": 527,
                                                                                                    "end_token": 527,
                                                                                                    "children": []
                                                                                                },
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "label": "Output",
                                                                                                    "start_token": 529,
                                                                                                    "end_token": 529,
                                                                                                    "children": []
                                                                                                }
                                                                                            ]
                                                                                        },
                                                                                        {
                                                                                            "type": "list",
                                                                                            "label": "[]",
                                                                                            "start_token": 531,
                                                                                            "end_token": 532,
                                                                                            "children": []
                                                                                        }
                                                                                    ]
                                                                                }
                                                                            ]
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                },
                                                {
                                                    "type": "return_statement",
                                                    "label": "return obj",
                                                    "start_token": 535,
                                                    "end_token": 536,
                                                    "children": [
                                                        {
                                                            "type": "identifier",
                                                            "label": "obj",
                                                            "start_token": 536,
                                                            "end_token": 536,
                                                            "children": []
                                                        }
                                                    ]
                                                }
                                            ]
                                        }
                                    ]
                                }
                            ]
                        },
                        {
                            "type": "function_definition",
                            "label": "def is_triggered_by_event_type(self, event_type: str) -> bool:\n        if not (block := get_block(self.block_id)):\n            raise ValueError(f\"Block #{self.block_id} not found for node #{self.id}\")\n        if not block.webhook_config:\n            raise TypeError(\"This method can't be used on non-webhook blocks\")\n        if not block.webhook_config.event_filter_input:\n            return True\n        event_filter = self.input_default.get(block.webhook_config.event_filter_input)\n        if not event_filter:\n            raise ValueError(f\"Event filter is not configured on node #{self.id}\")\n        return event_type in [\n            block.webhook_config.event_format.format(event=k)\n            for k in event_filter\n            if event_filter[k] is True\n        ]",
                            "start_token": 539,
                            "end_token": 658,
                            "children": [
                                {
                                    "type": "identifier",
                                    "label": "is_triggered_by_event_type",
                                    "start_token": 540,
                                    "end_token": 540,
                                    "children": []
                                },
                                {
                                    "type": "parameters",
                                    "label": "(self, event_type: str)",
                                    "start_token": 541,
                                    "end_token": 547,
                                    "children": [
                                        {
                                            "type": "identifier",
                                            "label": "self",
                                            "start_token": 542,
                                            "end_token": 542,
                                            "children": []
                                        },
                                        {
                                            "type": "typed_parameter",
                                            "label": "event_type: str",
                                            "start_token": 544,
                                            "end_token": 546,
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "label": "event_type",
                                                    "start_token": 544,
                                                    "end_token": 544,
                                                    "children": []
                                                },
                                                {
                                                    "type": "type",
                                                    "label": "str",
                                                    "start_token": 546,
                                                    "end_token": 546,
                                                    "children": [
                                                        {
                                                            "type": "identifier",
                                                            "label": "str",
                                                            "start_token": 546,
                                                            "end_token": 546,
                                                            "children": []
                                                        }
                                                    ]
                                                }
                                            ]
                                        }
                                    ]
                                },
                                {
                                    "type": "type",
                                    "label": "bool",
                                    "start_token": 550,
                                    "end_token": 550,
                                    "children": [
                                        {
                                            "type": "identifier",
                                            "label": "bool",
                                            "start_token": 550,
                                            "end_token": 550,
                                            "children": []
                                        }
                                    ]
                                },
                                {
                                    "type": "block",
                                    "label": "if not (block := get_block(self.block_id)):\n            raise ValueError(f\"Block #{self.block_id} not found for node #{self.id}\")\n        if not block.webhook_config:\n            raise TypeError(\"This method can't be used on non-webhook blocks\")\n        if not block.webhook_config.event_filter_input:\n            return True\n        event_filter = self.input_default.get(block.webhook_config.event_filter_input)\n        if not event_filter:\n            raise ValueError(f\"Event filter is not configured on node #{self.id}\")\n        return event_type in [\n            block.webhook_config.event_format.format(event=k)\n            for k in event_filter\n            if event_filter[k] is True\n        ]",
                                    "start_token": 553,
                                    "end_token": 658,
                                    "children": [
                                        {
                                            "type": "if_statement",
                                            "label": "if not (block := get_block(self.block_id)):\n            raise ValueError(f\"Block #{self.block_id} not found for node #{self.id}\")",
                                            "start_token": 553,
                                            "end_token": 573,
                                            "children": [
                                                {
                                                    "type": "not_operator",
                                                    "label": "not (block := get_block(self.block_id))",
                                                    "start_token": 554,
                                                    "end_token": 565,
                                                    "children": [
                                                        {
                                                            "type": "parenthesized_expression",
                                                            "label": "(block := get_block(self.block_id))",
                                                            "start_token": 555,
                                                            "end_token": 565,
                                                            "children": [
                                                                {
                                                                    "type": "named_expression",
                                                                    "label": "block := get_block(self.block_id)",
                                                                    "start_token": 556,
                                                                    "end_token": 564,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "block",
                                                                            "start_token": 556,
                                                                            "end_token": 556,
                                                                            "children": []
                                                                        },
                                                                        {
                                                                            "type": "call",
                                                                            "label": "get_block(self.block_id)",
                                                                            "start_token": 559,
                                                                            "end_token": 564,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "get_block",
                                                                                    "start_token": 559,
                                                                                    "end_token": 559,
                                                                                    "children": []
                                                                                },
                                                                                {
                                                                                    "type": "argument_list",
                                                                                    "label": "(self.block_id)",
                                                                                    "start_token": 560,
                                                                                    "end_token": 564,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "attribute",
                                                                                            "label": "self.block_id",
                                                                                            "start_token": 561,
                                                                                            "end_token": 563,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "label": "self",
                                                                                                    "start_token": 561,
                                                                                                    "end_token": 561,
                                                                                                    "children": []
                                                                                                },
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "label": "block_id",
                                                                                                    "start_token": 563,
                                                                                                    "end_token": 563,
                                                                                                    "children": []
                                                                                                }
                                                                                            ]
                                                                                        }
                                                                                    ]
                                                                                }
                                                                            ]
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                },
                                                {
                                                    "type": "block",
                                                    "label": "raise ValueError(f\"Block #{self.block_id} not found for node #{self.id}\")",
                                                    "start_token": 568,
                                                    "end_token": 573,
                                                    "children": [
                                                        {
                                                            "type": "raise_statement",
                                                            "label": "raise ValueError(f\"Block #{self.block_id} not found for node #{self.id}\")",
                                                            "start_token": 568,
                                                            "end_token": 573,
                                                            "children": [
                                                                {
                                                                    "type": "call",
                                                                    "label": "ValueError(f\"Block #{self.block_id} not found for node #{self.id}\")",
                                                                    "start_token": 569,
                                                                    "end_token": 573,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "ValueError",
                                                                            "start_token": 569,
                                                                            "end_token": 569,
                                                                            "children": []
                                                                        },
                                                                        {
                                                                            "type": "argument_list",
                                                                            "label": "(f\"Block #{self.block_id} not found for node #{self.id}\")",
                                                                            "start_token": 570,
                                                                            "end_token": 573,
                                                                            "children": [
                                                                                {
                                                                                    "type": "string",
                                                                                    "label": "f\"Block #{self.block_id} not found for node #{self.id}\"",
                                                                                    "start_token": 571,
                                                                                    "end_token": 572,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "string_start",
                                                                                            "label": "f\"",
                                                                                            "start_token": 571,
                                                                                            "end_token": 572,
                                                                                            "children": []
                                                                                        },
                                                                                        {
                                                                                            "type": "string_content",
                                                                                            "label": "Block #",
                                                                                            "start_token": 572,
                                                                                            "end_token": 572,
                                                                                            "children": []
                                                                                        },
                                                                                        {
                                                                                            "type": "interpolation",
                                                                                            "label": "{self.block_id}",
                                                                                            "start_token": 572,
                                                                                            "end_token": 572,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "attribute",
                                                                                                    "label": "self.block_id",
                                                                                                    "start_token": 572,
                                                                                                    "end_token": 572,
                                                                                                    "children": [
                                                                                                        {
                                                                                                            "type": "identifier",
                                                                                                            "label": "self",
                                                                                                            "start_token": 572,
                                                                                                            "end_token": 572,
                                                                                                            "children": []
                                                                                                        },
                                                                                                        {
                                                                                                            "type": "identifier",
                                                                                                            "label": "block_id",
                                                                                                            "start_token": 572,
                                                                                                            "end_token": 572,
                                                                                                            "children": []
                                                                                                        }
                                                                                                    ]
                                                                                                }
                                                                                            ]
                                                                                        },
                                                                                        {
                                                                                            "type": "string_content",
                                                                                            "label": " not found for node #",
                                                                                            "start_token": 572,
                                                                                            "end_token": 572,
                                                                                            "children": []
                                                                                        },
                                                                                        {
                                                                                            "type": "interpolation",
                                                                                            "label": "{self.id}",
                                                                                            "start_token": 572,
                                                                                            "end_token": 572,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "attribute",
                                                                                                    "label": "self.id",
                                                                                                    "start_token": 572,
                                                                                                    "end_token": 572,
                                                                                                    "children": [
                                                                                                        {
                                                                                                            "type": "identifier",
                                                                                                            "label": "self",
                                                                                                            "start_token": 572,
                                                                                                            "end_token": 572,
                                                                                                            "children": []
                                                                                                        },
                                                                                                        {
                                                                                                            "type": "identifier",
                                                                                                            "label": "id",
                                                                                                            "start_token": 572,
                                                                                                            "end_token": 572,
                                                                                                            "children": []
                                                                                                        }
                                                                                                    ]
                                                                                                }
                                                                                            ]
                                                                                        },
                                                                                        {
                                                                                            "type": "string_end",
                                                                                            "label": "\"",
                                                                                            "start_token": 572,
                                                                                            "end_token": 572,
                                                                                            "children": []
                                                                                        }
                                                                                    ]
                                                                                }
                                                                            ]
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                }
                                            ]
                                        },
                                        {
                                            "type": "if_statement",
                                            "label": "if not block.webhook_config:\n            raise TypeError(\"This method can't be used on non-webhook blocks\")",
                                            "start_token": 575,
                                            "end_token": 586,
                                            "children": [
                                                {
                                                    "type": "not_operator",
                                                    "label": "not block.webhook_config",
                                                    "start_token": 576,
                                                    "end_token": 579,
                                                    "children": [
                                                        {
                                                            "type": "attribute",
                                                            "label": "block.webhook_config",
                                                            "start_token": 577,
                                                            "end_token": 579,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "label": "block",
                                                                    "start_token": 577,
                                                                    "end_token": 577,
                                                                    "children": []
                                                                },
                                                                {
                                                                    "type": "identifier",
                                                                    "label": "webhook_config",
                                                                    "start_token": 579,
                                                                    "end_token": 579,
                                                                    "children": []
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                },
                                                {
                                                    "type": "block",
                                                    "label": "raise TypeError(\"This method can't be used on non-webhook blocks\")",
                                                    "start_token": 582,
                                                    "end_token": 586,
                                                    "children": [
                                                        {
                                                            "type": "raise_statement",
                                                            "label": "raise TypeError(\"This method can't be used on non-webhook blocks\")",
                                                            "start_token": 582,
                                                            "end_token": 586,
                                                            "children": [
                                                                {
                                                                    "type": "call",
                                                                    "label": "TypeError(\"This method can't be used on non-webhook blocks\")",
                                                                    "start_token": 583,
                                                                    "end_token": 586,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "TypeError",
                                                                            "start_token": 583,
                                                                            "end_token": 583,
                                                                            "children": []
                                                                        },
                                                                        {
                                                                            "type": "argument_list",
                                                                            "label": "(\"This method can't be used on non-webhook blocks\")",
                                                                            "start_token": 584,
                                                                            "end_token": 586,
                                                                            "children": [
                                                                                {
                                                                                    "type": "string",
                                                                                    "label": "\"This method can't be used on non-webhook blocks\"",
                                                                                    "start_token": 585,
                                                                                    "end_token": 585,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "string_start",
                                                                                            "label": "\"",
                                                                                            "start_token": 585,
                                                                                            "end_token": 585,
                                                                                            "children": []
                                                                                        },
                                                                                        {
                                                                                            "type": "string_content",
                                                                                            "label": "This method can't be used on non-webhook blocks",
                                                                                            "start_token": 585,
                                                                                            "end_token": 585,
                                                                                            "children": []
                                                                                        },
                                                                                        {
                                                                                            "type": "string_end",
                                                                                            "label": "\"",
                                                                                            "start_token": 585,
                                                                                            "end_token": 585,
                                                                                            "children": []
                                                                                        }
                                                                                    ]
                                                                                }
                                                                            ]
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                }
                                            ]
                                        },
                                        {
                                            "type": "if_statement",
                                            "label": "if not block.webhook_config.event_filter_input:\n            return True",
                                            "start_token": 588,
                                            "end_token": 598,
                                            "children": [
                                                {
                                                    "type": "not_operator",
                                                    "label": "not block.webhook_config.event_filter_input",
                                                    "start_token": 589,
                                                    "end_token": 594,
                                                    "children": [
                                                        {
                                                            "type": "attribute",
                                                            "label": "block.webhook_config.event_filter_input",
                                                            "start_token": 590,
                                                            "end_token": 594,
                                                            "children": [
                                                                {
                                                                    "type": "attribute",
                                                                    "label": "block.webhook_config",
                                                                    "start_token": 590,
                                                                    "end_token": 592,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "block",
                                                                            "start_token": 590,
                                                                            "end_token": 590,
                                                                            "children": []
                                                                        },
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "webhook_config",
                                                                            "start_token": 592,
                                                                            "end_token": 592,
                                                                            "children": []
                                                                        }
                                                                    ]
                                                                },
                                                                {
                                                                    "type": "identifier",
                                                                    "label": "event_filter_input",
                                                                    "start_token": 594,
                                                                    "end_token": 594,
                                                                    "children": []
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                },
                                                {
                                                    "type": "block",
                                                    "label": "return True",
                                                    "start_token": 597,
                                                    "end_token": 598,
                                                    "children": [
                                                        {
                                                            "type": "return_statement",
                                                            "label": "return True",
                                                            "start_token": 597,
                                                            "end_token": 598,
                                                            "children": [
                                                                {
                                                                    "type": "true",
                                                                    "label": "True",
                                                                    "start_token": 598,
                                                                    "end_token": 598,
                                                                    "children": []
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                }
                                            ]
                                        },
                                        {
                                            "type": "expression_statement",
                                            "label": "event_filter = self.input_default.get(block.webhook_config.event_filter_input)",
                                            "start_token": 600,
                                            "end_token": 613,
                                            "children": [
                                                {
                                                    "type": "assignment",
                                                    "label": "event_filter = self.input_default.get(block.webhook_config.event_filter_input)",
                                                    "start_token": 600,
                                                    "end_token": 613,
                                                    "children": [
                                                        {
                                                            "type": "identifier",
                                                            "label": "event_filter",
                                                            "start_token": 600,
                                                            "end_token": 600,
                                                            "children": []
                                                        },
                                                        {
                                                            "type": "call",
                                                            "label": "self.input_default.get(block.webhook_config.event_filter_input)",
                                                            "start_token": 602,
                                                            "end_token": 613,
                                                            "children": [
                                                                {
                                                                    "type": "attribute",
                                                                    "label": "self.input_default.get",
                                                                    "start_token": 602,
                                                                    "end_token": 606,
                                                                    "children": [
                                                                        {
                                                                            "type": "attribute",
                                                                            "label": "self.input_default",
                                                                            "start_token": 602,
                                                                            "end_token": 604,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "self",
                                                                                    "start_token": 602,
                                                                                    "end_token": 602,
                                                                                    "children": []
                                                                                },
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "input_default",
                                                                                    "start_token": 604,
                                                                                    "end_token": 604,
                                                                                    "children": []
                                                                                }
                                                                            ]
                                                                        },
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "get",
                                                                            "start_token": 606,
                                                                            "end_token": 606,
                                                                            "children": []
                                                                        }
                                                                    ]
                                                                },
                                                                {
                                                                    "type": "argument_list",
                                                                    "label": "(block.webhook_config.event_filter_input)",
                                                                    "start_token": 607,
                                                                    "end_token": 613,
                                                                    "children": [
                                                                        {
                                                                            "type": "attribute",
                                                                            "label": "block.webhook_config.event_filter_input",
                                                                            "start_token": 608,
                                                                            "end_token": 612,
                                                                            "children": [
                                                                                {
                                                                                    "type": "attribute",
                                                                                    "label": "block.webhook_config",
                                                                                    "start_token": 608,
                                                                                    "end_token": 610,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "label": "block",
                                                                                            "start_token": 608,
                                                                                            "end_token": 608,
                                                                                            "children": []
                                                                                        },
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "label": "webhook_config",
                                                                                            "start_token": 610,
                                                                                            "end_token": 610,
                                                                                            "children": []
                                                                                        }
                                                                                    ]
                                                                                },
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "event_filter_input",
                                                                                    "start_token": 612,
                                                                                    "end_token": 612,
                                                                                    "children": []
                                                                                }
                                                                            ]
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                }
                                            ]
                                        },
                                        {
                                            "type": "if_statement",
                                            "label": "if not event_filter:\n            raise ValueError(f\"Event filter is not configured on node #{self.id}\")",
                                            "start_token": 615,
                                            "end_token": 625,
                                            "children": [
                                                {
                                                    "type": "not_operator",
                                                    "label": "not event_filter",
                                                    "start_token": 616,
                                                    "end_token": 617,
                                                    "children": [
                                                        {
                                                            "type": "identifier",
                                                            "label": "event_filter",
                                                            "start_token": 617,
                                                            "end_token": 617,
                                                            "children": []
                                                        }
                                                    ]
                                                },
                                                {
                                                    "type": "block",
                                                    "label": "raise ValueError(f\"Event filter is not configured on node #{self.id}\")",
                                                    "start_token": 620,
                                                    "end_token": 625,
                                                    "children": [
                                                        {
                                                            "type": "raise_statement",
                                                            "label": "raise ValueError(f\"Event filter is not configured on node #{self.id}\")",
                                                            "start_token": 620,
                                                            "end_token": 625,
                                                            "children": [
                                                                {
                                                                    "type": "call",
                                                                    "label": "ValueError(f\"Event filter is not configured on node #{self.id}\")",
                                                                    "start_token": 621,
                                                                    "end_token": 625,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "ValueError",
                                                                            "start_token": 621,
                                                                            "end_token": 621,
                                                                            "children": []
                                                                        },
                                                                        {
                                                                            "type": "argument_list",
                                                                            "label": "(f\"Event filter is not configured on node #{self.id}\")",
                                                                            "start_token": 622,
                                                                            "end_token": 625,
                                                                            "children": [
                                                                                {
                                                                                    "type": "string",
                                                                                    "label": "f\"Event filter is not configured on node #{self.id}\"",
                                                                                    "start_token": 623,
                                                                                    "end_token": 624,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "string_start",
                                                                                            "label": "f\"",
                                                                                            "start_token": 623,
                                                                                            "end_token": 624,
                                                                                            "children": []
                                                                                        },
                                                                                        {
                                                                                            "type": "string_content",
                                                                                            "label": "Event filter is not configured on node #",
                                                                                            "start_token": 624,
                                                                                            "end_token": 624,
                                                                                            "children": []
                                                                                        },
                                                                                        {
                                                                                            "type": "interpolation",
                                                                                            "label": "{self.id}",
                                                                                            "start_token": 624,
                                                                                            "end_token": 624,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "attribute",
                                                                                                    "label": "self.id",
                                                                                                    "start_token": 624,
                                                                                                    "end_token": 624,
                                                                                                    "children": [
                                                                                                        {
                                                                                                            "type": "identifier",
                                                                                                            "label": "self",
                                                                                                            "start_token": 624,
                                                                                                            "end_token": 624,
                                                                                                            "children": []
                                                                                                        },
                                                                                                        {
                                                                                                            "type": "identifier",
                                                                                                            "label": "id",
                                                                                                            "start_token": 624,
                                                                                                            "end_token": 624,
                                                                                                            "children": []
                                                                                                        }
                                                                                                    ]
                                                                                                }
                                                                                            ]
                                                                                        },
                                                                                        {
                                                                                            "type": "string_end",
                                                                                            "label": "\"",
                                                                                            "start_token": 624,
                                                                                            "end_token": 624,
                                                                                            "children": []
                                                                                        }
                                                                                    ]
                                                                                }
                                                                            ]
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                }
                                            ]
                                        },
                                        {
                                            "type": "return_statement",
                                            "label": "return event_type in [\n            block.webhook_config.event_format.format(event=k)\n            for k in event_filter\n            if event_filter[k] is True\n        ]",
                                            "start_token": 627,
                                            "end_token": 658,
                                            "children": [
                                                {
                                                    "type": "comparison_operator",
                                                    "label": "event_type in [\n            block.webhook_config.event_format.format(event=k)\n            for k in event_filter\n            if event_filter[k] is True\n        ]",
                                                    "start_token": 628,
                                                    "end_token": 658,
                                                    "children": [
                                                        {
                                                            "type": "identifier",
                                                            "label": "event_type",
                                                            "start_token": 628,
                                                            "end_token": 628,
                                                            "children": []
                                                        },
                                                        {
                                                            "type": "list_comprehension",
                                                            "label": "[\n            block.webhook_config.event_format.format(event=k)\n            for k in event_filter\n            if event_filter[k] is True\n        ]",
                                                            "start_token": 630,
                                                            "end_token": 658,
                                                            "children": [
                                                                {
                                                                    "type": "call",
                                                                    "label": "block.webhook_config.event_format.format(event=k)",
                                                                    "start_token": 632,
                                                                    "end_token": 643,
                                                                    "children": [
                                                                        {
                                                                            "type": "attribute",
                                                                            "label": "block.webhook_config.event_format.format",
                                                                            "start_token": 632,
                                                                            "end_token": 638,
                                                                            "children": [
                                                                                {
                                                                                    "type": "attribute",
                                                                                    "label": "block.webhook_config.event_format",
                                                                                    "start_token": 632,
                                                                                    "end_token": 636,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "attribute",
                                                                                            "label": "block.webhook_config",
                                                                                            "start_token": 632,
                                                                                            "end_token": 634,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "label": "block",
                                                                                                    "start_token": 632,
                                                                                                    "end_token": 632,
                                                                                                    "children": []
                                                                                                },
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "label": "webhook_config",
                                                                                                    "start_token": 634,
                                                                                                    "end_token": 634,
                                                                                                    "children": []
                                                                                                }
                                                                                            ]
                                                                                        },
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "label": "event_format",
                                                                                            "start_token": 636,
                                                                                            "end_token": 636,
                                                                                            "children": []
                                                                                        }
                                                                                    ]
                                                                                },
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "format",
                                                                                    "start_token": 638,
                                                                                    "end_token": 638,
                                                                                    "children": []
                                                                                }
                                                                            ]
                                                                        },
                                                                        {
                                                                            "type": "argument_list",
                                                                            "label": "(event=k)",
                                                                            "start_token": 639,
                                                                            "end_token": 643,
                                                                            "children": [
                                                                                {
                                                                                    "type": "keyword_argument",
                                                                                    "label": "event=k",
                                                                                    "start_token": 640,
                                                                                    "end_token": 642,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "label": "event",
                                                                                            "start_token": 640,
                                                                                            "end_token": 640,
                                                                                            "children": []
                                                                                        },
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "label": "k",
                                                                                            "start_token": 642,
                                                                                            "end_token": 642,
                                                                                            "children": []
                                                                                        }
                                                                                    ]
                                                                                }
                                                                            ]
                                                                        }
                                                                    ]
                                                                },
                                                                {
                                                                    "type": "for_in_clause",
                                                                    "label": "for k in event_filter",
                                                                    "start_token": 645,
                                                                    "end_token": 648,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "k",
                                                                            "start_token": 646,
                                                                            "end_token": 646,
                                                                            "children": []
                                                                        },
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "event_filter",
                                                                            "start_token": 648,
                                                                            "end_token": 648,
                                                                            "children": []
                                                                        }
                                                                    ]
                                                                },
                                                                {
                                                                    "type": "if_clause",
                                                                    "label": "if event_filter[k] is True",
                                                                    "start_token": 650,
                                                                    "end_token": 656,
                                                                    "children": [
                                                                        {
                                                                            "type": "comparison_operator",
                                                                            "label": "event_filter[k] is True",
                                                                            "start_token": 651,
                                                                            "end_token": 656,
                                                                            "children": [
                                                                                {
                                                                                    "type": "subscript",
                                                                                    "label": "event_filter[k]",
                                                                                    "start_token": 651,
                                                                                    "end_token": 654,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "label": "event_filter",
                                                                                            "start_token": 651,
                                                                                            "end_token": 651,
                                                                                            "children": []
                                                                                        },
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "label": "k",
                                                                                            "start_token": 653,
                                                                                            "end_token": 653,
                                                                                            "children": []
                                                                                        }
                                                                                    ]
                                                                                },
                                                                                {
                                                                                    "type": "true",
                                                                                    "label": "True",
                                                                                    "start_token": 656,
                                                                                    "end_token": 656,
                                                                                    "children": []
                                                                                }
                                                                            ]
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                }
                                            ]
                                        }
                                    ]
                                }
                            ]
                        }
                    ]
                }
            ]
        },
        {
            "type": "comment",
            "label": "# Fix 2-way reference Node <-> Webhook",
            "start_token": 662,
            "end_token": 672,
            "children": []
        },
        {
            "type": "expression_statement",
            "label": "Webhook.model_rebuild()",
            "start_token": 674,
            "end_token": 678,
            "children": [
                {
                    "type": "call",
                    "label": "Webhook.model_rebuild()",
                    "start_token": 674,
                    "end_token": 678,
                    "children": [
                        {
                            "type": "attribute",
                            "label": "Webhook.model_rebuild",
                            "start_token": 674,
                            "end_token": 676,
                            "children": [
                                {
                                    "type": "identifier",
                                    "label": "Webhook",
                                    "start_token": 674,
                                    "end_token": 674,
                                    "children": []
                                },
                                {
                                    "type": "identifier",
                                    "label": "model_rebuild",
                                    "start_token": 676,
                                    "end_token": 676,
                                    "children": []
                                }
                            ]
                        },
                        {
                            "type": "argument_list",
                            "label": "()",
                            "start_token": 677,
                            "end_token": 678,
                            "children": []
                        }
                    ]
                }
            ]
        },
        {
            "type": "class_definition",
            "label": "class GraphExecution(BaseDbModel):\n    execution_id: str\n    started_at: datetime\n    ended_at: datetime\n    duration: float\n    total_run_time: float\n    status: ExecutionStatus\n    graph_id: str\n    graph_version: int\n\n    @staticmethod\n    def from_db(execution: AgentGraphExecution):\n        now = datetime.now(timezone.utc)\n        start_time = execution.startedAt or execution.createdAt\n        end_time = execution.updatedAt or now\n        duration = (end_time - start_time).total_seconds()\n        total_run_time = duration\n\n        try:\n            stats = json.loads(execution.stats or \"{}\", target_type=dict[str, Any])\n        except ValueError:\n            stats = {}\n\n        duration = stats.get(\"walltime\", duration)\n        total_run_time = stats.get(\"nodes_walltime\", total_run_time)\n\n        return GraphExecution(\n            id=execution.id,\n            execution_id=execution.id,\n            started_at=start_time,\n            ended_at=end_time,\n            duration=duration,\n            total_run_time=total_run_time,\n            status=ExecutionStatus(execution.executionStatus),\n            graph_id=execution.agentGraphId,\n            graph_version=execution.agentGraphVersion,\n        )",
            "start_token": 682,
            "end_token": 900,
            "children": [
                {
                    "type": "identifier",
                    "label": "GraphExecution",
                    "start_token": 683,
                    "end_token": 683,
                    "children": []
                },
                {
                    "type": "argument_list",
                    "label": "(BaseDbModel)",
                    "start_token": 684,
                    "end_token": 686,
                    "children": [
                        {
                            "type": "identifier",
                            "label": "BaseDbModel",
                            "start_token": 685,
                            "end_token": 685,
                            "children": []
                        }
                    ]
                },
                {
                    "type": "block",
                    "label": "execution_id: str\n    started_at: datetime\n    ended_at: datetime\n    duration: float\n    total_run_time: float\n    status: ExecutionStatus\n    graph_id: str\n    graph_version: int\n\n    @staticmethod\n    def from_db(execution: AgentGraphExecution):\n        now = datetime.now(timezone.utc)\n        start_time = execution.startedAt or execution.createdAt\n        end_time = execution.updatedAt or now\n        duration = (end_time - start_time).total_seconds()\n        total_run_time = duration\n\n        try:\n            stats = json.loads(execution.stats or \"{}\", target_type=dict[str, Any])\n        except ValueError:\n            stats = {}\n\n        duration = stats.get(\"walltime\", duration)\n        total_run_time = stats.get(\"nodes_walltime\", total_run_time)\n\n        return GraphExecution(\n            id=execution.id,\n            execution_id=execution.id,\n            started_at=start_time,\n            ended_at=end_time,\n            duration=duration,\n            total_run_time=total_run_time,\n            status=ExecutionStatus(execution.executionStatus),\n            graph_id=execution.agentGraphId,\n            graph_version=execution.agentGraphVersion,\n        )",
                    "start_token": 689,
                    "end_token": 900,
                    "children": [
                        {
                            "type": "expression_statement",
                            "label": "execution_id: str",
                            "start_token": 689,
                            "end_token": 691,
                            "children": [
                                {
                                    "type": "assignment",
                                    "label": "execution_id: str",
                                    "start_token": 689,
                                    "end_token": 691,
                                    "children": [
                                        {
                                            "type": "identifier",
                                            "label": "execution_id",
                                            "start_token": 689,
                                            "end_token": 689,
                                            "children": []
                                        },
                                        {
                                            "type": "type",
                                            "label": "str",
                                            "start_token": 691,
                                            "end_token": 691,
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "label": "str",
                                                    "start_token": 691,
                                                    "end_token": 691,
                                                    "children": []
                                                }
                                            ]
                                        }
                                    ]
                                }
                            ]
                        },
                        {
                            "type": "expression_statement",
                            "label": "started_at: datetime",
                            "start_token": 693,
                            "end_token": 695,
                            "children": [
                                {
                                    "type": "assignment",
                                    "label": "started_at: datetime",
                                    "start_token": 693,
                                    "end_token": 695,
                                    "children": [
                                        {
                                            "type": "identifier",
                                            "label": "started_at",
                                            "start_token": 693,
                                            "end_token": 693,
                                            "children": []
                                        },
                                        {
                                            "type": "type",
                                            "label": "datetime",
                                            "start_token": 695,
                                            "end_token": 695,
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "label": "datetime",
                                                    "start_token": 695,
                                                    "end_token": 695,
                                                    "children": []
                                                }
                                            ]
                                        }
                                    ]
                                }
                            ]
                        },
                        {
                            "type": "expression_statement",
                            "label": "ended_at: datetime",
                            "start_token": 697,
                            "end_token": 699,
                            "children": [
                                {
                                    "type": "assignment",
                                    "label": "ended_at: datetime",
                                    "start_token": 697,
                                    "end_token": 699,
                                    "children": [
                                        {
                                            "type": "identifier",
                                            "label": "ended_at",
                                            "start_token": 697,
                                            "end_token": 697,
                                            "children": []
                                        },
                                        {
                                            "type": "type",
                                            "label": "datetime",
                                            "start_token": 699,
                                            "end_token": 699,
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "label": "datetime",
                                                    "start_token": 699,
                                                    "end_token": 699,
                                                    "children": []
                                                }
                                            ]
                                        }
                                    ]
                                }
                            ]
                        },
                        {
                            "type": "expression_statement",
                            "label": "duration: float",
                            "start_token": 701,
                            "end_token": 703,
                            "children": [
                                {
                                    "type": "assignment",
                                    "label": "duration: float",
                                    "start_token": 701,
                                    "end_token": 703,
                                    "children": [
                                        {
                                            "type": "identifier",
                                            "label": "duration",
                                            "start_token": 701,
                                            "end_token": 701,
                                            "children": []
                                        },
                                        {
                                            "type": "type",
                                            "label": "float",
                                            "start_token": 703,
                                            "end_token": 703,
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "label": "float",
                                                    "start_token": 703,
                                                    "end_token": 703,
                                                    "children": []
                                                }
                                            ]
                                        }
                                    ]
                                }
                            ]
                        },
                        {
                            "type": "expression_statement",
                            "label": "total_run_time: float",
                            "start_token": 705,
                            "end_token": 707,
                            "children": [
                                {
                                    "type": "assignment",
                                    "label": "total_run_time: float",
                                    "start_token": 705,
                                    "end_token": 707,
                                    "children": [
                                        {
                                            "type": "identifier",
                                            "label": "total_run_time",
                                            "start_token": 705,
                                            "end_token": 705,
                                            "children": []
                                        },
                                        {
                                            "type": "type",
                                            "label": "float",
                                            "start_token": 707,
                                            "end_token": 707,
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "label": "float",
                                                    "start_token": 707,
                                                    "end_token": 707,
                                                    "children": []
                                                }
                                            ]
                                        }
                                    ]
                                }
                            ]
                        },
                        {
                            "type": "expression_statement",
                            "label": "status: ExecutionStatus",
                            "start_token": 709,
                            "end_token": 711,
                            "children": [
                                {
                                    "type": "assignment",
                                    "label": "status: ExecutionStatus",
                                    "start_token": 709,
                                    "end_token": 711,
                                    "children": [
                                        {
                                            "type": "identifier",
                                            "label": "status",
                                            "start_token": 709,
                                            "end_token": 709,
                                            "children": []
                                        },
                                        {
                                            "type": "type",
                                            "label": "ExecutionStatus",
                                            "start_token": 711,
                                            "end_token": 711,
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "label": "ExecutionStatus",
                                                    "start_token": 711,
                                                    "end_token": 711,
                                                    "children": []
                                                }
                                            ]
                                        }
                                    ]
                                }
                            ]
                        },
                        {
                            "type": "expression_statement",
                            "label": "graph_id: str",
                            "start_token": 713,
                            "end_token": 715,
                            "children": [
                                {
                                    "type": "assignment",
                                    "label": "graph_id: str",
                                    "start_token": 713,
                                    "end_token": 715,
                                    "children": [
                                        {
                                            "type": "identifier",
                                            "label": "graph_id",
                                            "start_token": 713,
                                            "end_token": 713,
                                            "children": []
                                        },
                                        {
                                            "type": "type",
                                            "label": "str",
                                            "start_token": 715,
                                            "end_token": 715,
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "label": "str",
                                                    "start_token": 715,
                                                    "end_token": 715,
                                                    "children": []
                                                }
                                            ]
                                        }
                                    ]
                                }
                            ]
                        },
                        {
                            "type": "expression_statement",
                            "label": "graph_version: int",
                            "start_token": 717,
                            "end_token": 719,
                            "children": [
                                {
                                    "type": "assignment",
                                    "label": "graph_version: int",
                                    "start_token": 717,
                                    "end_token": 719,
                                    "children": [
                                        {
                                            "type": "identifier",
                                            "label": "graph_version",
                                            "start_token": 717,
                                            "end_token": 717,
                                            "children": []
                                        },
                                        {
                                            "type": "type",
                                            "label": "int",
                                            "start_token": 719,
                                            "end_token": 719,
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "label": "int",
                                                    "start_token": 719,
                                                    "end_token": 719,
                                                    "children": []
                                                }
                                            ]
                                        }
                                    ]
                                }
                            ]
                        },
                        {
                            "type": "decorated_definition",
                            "label": "@staticmethod\n    def from_db(execution: AgentGraphExecution):\n        now = datetime.now(timezone.utc)\n        start_time = execution.startedAt or execution.createdAt\n        end_time = execution.updatedAt or now\n        duration = (end_time - start_time).total_seconds()\n        total_run_time = duration\n\n        try:\n            stats = json.loads(execution.stats or \"{}\", target_type=dict[str, Any])\n        except ValueError:\n            stats = {}\n\n        duration = stats.get(\"walltime\", duration)\n        total_run_time = stats.get(\"nodes_walltime\", total_run_time)\n\n        return GraphExecution(\n            id=execution.id,\n            execution_id=execution.id,\n            started_at=start_time,\n            ended_at=end_time,\n            duration=duration,\n            total_run_time=total_run_time,\n            status=ExecutionStatus(execution.executionStatus),\n            graph_id=execution.agentGraphId,\n            graph_version=execution.agentGraphVersion,\n        )",
                            "start_token": 722,
                            "end_token": 900,
                            "children": [
                                {
                                    "type": "decorator",
                                    "label": "@staticmethod",
                                    "start_token": 722,
                                    "end_token": 723,
                                    "children": [
                                        {
                                            "type": "identifier",
                                            "label": "staticmethod",
                                            "start_token": 723,
                                            "end_token": 723,
                                            "children": []
                                        }
                                    ]
                                },
                                {
                                    "type": "function_definition",
                                    "label": "def from_db(execution: AgentGraphExecution):\n        now = datetime.now(timezone.utc)\n        start_time = execution.startedAt or execution.createdAt\n        end_time = execution.updatedAt or now\n        duration = (end_time - start_time).total_seconds()\n        total_run_time = duration\n\n        try:\n            stats = json.loads(execution.stats or \"{}\", target_type=dict[str, Any])\n        except ValueError:\n            stats = {}\n\n        duration = stats.get(\"walltime\", duration)\n        total_run_time = stats.get(\"nodes_walltime\", total_run_time)\n\n        return GraphExecution(\n            id=execution.id,\n            execution_id=execution.id,\n            started_at=start_time,\n            ended_at=end_time,\n            duration=duration,\n            total_run_time=total_run_time,\n            status=ExecutionStatus(execution.executionStatus),\n            graph_id=execution.agentGraphId,\n            graph_version=execution.agentGraphVersion,\n        )",
                                    "start_token": 725,
                                    "end_token": 900,
                                    "children": [
                                        {
                                            "type": "identifier",
                                            "label": "from_db",
                                            "start_token": 726,
                                            "end_token": 726,
                                            "children": []
                                        },
                                        {
                                            "type": "parameters",
                                            "label": "(execution: AgentGraphExecution)",
                                            "start_token": 727,
                                            "end_token": 731,
                                            "children": [
                                                {
                                                    "type": "typed_parameter",
                                                    "label": "execution: AgentGraphExecution",
                                                    "start_token": 728,
                                                    "end_token": 730,
                                                    "children": [
                                                        {
                                                            "type": "identifier",
                                                            "label": "execution",
                                                            "start_token": 728,
                                                            "end_token": 728,
                                                            "children": []
                                                        },
                                                        {
                                                            "type": "type",
                                                            "label": "AgentGraphExecution",
                                                            "start_token": 730,
                                                            "end_token": 730,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "label": "AgentGraphExecution",
                                                                    "start_token": 730,
                                                                    "end_token": 730,
                                                                    "children": []
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                }
                                            ]
                                        },
                                        {
                                            "type": "block",
                                            "label": "now = datetime.now(timezone.utc)\n        start_time = execution.startedAt or execution.createdAt\n        end_time = execution.updatedAt or now\n        duration = (end_time - start_time).total_seconds()\n        total_run_time = duration\n\n        try:\n            stats = json.loads(execution.stats or \"{}\", target_type=dict[str, Any])\n        except ValueError:\n            stats = {}\n\n        duration = stats.get(\"walltime\", duration)\n        total_run_time = stats.get(\"nodes_walltime\", total_run_time)\n\n        return GraphExecution(\n            id=execution.id,\n            execution_id=execution.id,\n            started_at=start_time,\n            ended_at=end_time,\n            duration=duration,\n            total_run_time=total_run_time,\n            status=ExecutionStatus(execution.executionStatus),\n            graph_id=execution.agentGraphId,\n            graph_version=execution.agentGraphVersion,\n        )",
                                            "start_token": 734,
                                            "end_token": 900,
                                            "children": [
                                                {
                                                    "type": "expression_statement",
                                                    "label": "now = datetime.now(timezone.utc)",
                                                    "start_token": 734,
                                                    "end_token": 743,
                                                    "children": [
                                                        {
                                                            "type": "assignment",
                                                            "label": "now = datetime.now(timezone.utc)",
                                                            "start_token": 734,
                                                            "end_token": 743,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "label": "now",
                                                                    "start_token": 734,
                                                                    "end_token": 734,
                                                                    "children": []
                                                                },
                                                                {
                                                                    "type": "call",
                                                                    "label": "datetime.now(timezone.utc)",
                                                                    "start_token": 736,
                                                                    "end_token": 743,
                                                                    "children": [
                                                                        {
                                                                            "type": "attribute",
                                                                            "label": "datetime.now",
                                                                            "start_token": 736,
                                                                            "end_token": 738,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "datetime",
                                                                                    "start_token": 736,
                                                                                    "end_token": 736,
                                                                                    "children": []
                                                                                },
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "now",
                                                                                    "start_token": 738,
                                                                                    "end_token": 738,
                                                                                    "children": []
                                                                                }
                                                                            ]
                                                                        },
                                                                        {
                                                                            "type": "argument_list",
                                                                            "label": "(timezone.utc)",
                                                                            "start_token": 739,
                                                                            "end_token": 743,
                                                                            "children": [
                                                                                {
                                                                                    "type": "attribute",
                                                                                    "label": "timezone.utc",
                                                                                    "start_token": 740,
                                                                                    "end_token": 742,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "label": "timezone",
                                                                                            "start_token": 740,
                                                                                            "end_token": 740,
                                                                                            "children": []
                                                                                        },
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "label": "utc",
                                                                                            "start_token": 742,
                                                                                            "end_token": 742,
                                                                                            "children": []
                                                                                        }
                                                                                    ]
                                                                                }
                                                                            ]
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                },
                                                {
                                                    "type": "expression_statement",
                                                    "label": "start_time = execution.startedAt or execution.createdAt",
                                                    "start_token": 745,
                                                    "end_token": 753,
                                                    "children": [
                                                        {
                                                            "type": "assignment",
                                                            "label": "start_time = execution.startedAt or execution.createdAt",
                                                            "start_token": 745,
                                                            "end_token": 753,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "label": "start_time",
                                                                    "start_token": 745,
                                                                    "end_token": 745,
                                                                    "children": []
                                                                },
                                                                {
                                                                    "type": "boolean_operator",
                                                                    "label": "execution.startedAt or execution.createdAt",
                                                                    "start_token": 747,
                                                                    "end_token": 753,
                                                                    "children": [
                                                                        {
                                                                            "type": "attribute",
                                                                            "label": "execution.startedAt",
                                                                            "start_token": 747,
                                                                            "end_token": 749,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "execution",
                                                                                    "start_token": 747,
                                                                                    "end_token": 747,
                                                                                    "children": []
                                                                                },
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "startedAt",
                                                                                    "start_token": 749,
                                                                                    "end_token": 749,
                                                                                    "children": []
                                                                                }
                                                                            ]
                                                                        },
                                                                        {
                                                                            "type": "attribute",
                                                                            "label": "execution.createdAt",
                                                                            "start_token": 751,
                                                                            "end_token": 753,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "execution",
                                                                                    "start_token": 751,
                                                                                    "end_token": 751,
                                                                                    "children": []
                                                                                },
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "createdAt",
                                                                                    "start_token": 753,
                                                                                    "end_token": 753,
                                                                                    "children": []
                                                                                }
                                                                            ]
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                },
                                                {
                                                    "type": "expression_statement",
                                                    "label": "end_time = execution.updatedAt or now",
                                                    "start_token": 755,
                                                    "end_token": 761,
                                                    "children": [
                                                        {
                                                            "type": "assignment",
                                                            "label": "end_time = execution.updatedAt or now",
                                                            "start_token": 755,
                                                            "end_token": 761,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "label": "end_time",
                                                                    "start_token": 755,
                                                                    "end_token": 755,
                                                                    "children": []
                                                                },
                                                                {
                                                                    "type": "boolean_operator",
                                                                    "label": "execution.updatedAt or now",
                                                                    "start_token": 757,
                                                                    "end_token": 761,
                                                                    "children": [
                                                                        {
                                                                            "type": "attribute",
                                                                            "label": "execution.updatedAt",
                                                                            "start_token": 757,
                                                                            "end_token": 759,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "execution",
                                                                                    "start_token": 757,
                                                                                    "end_token": 757,
                                                                                    "children": []
                                                                                },
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "updatedAt",
                                                                                    "start_token": 759,
                                                                                    "end_token": 759,
                                                                                    "children": []
                                                                                }
                                                                            ]
                                                                        },
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "now",
                                                                            "start_token": 761,
                                                                            "end_token": 761,
                                                                            "children": []
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                },
                                                {
                                                    "type": "expression_statement",
                                                    "label": "duration = (end_time - start_time).total_seconds()",
                                                    "start_token": 763,
                                                    "end_token": 773,
                                                    "children": [
                                                        {
                                                            "type": "assignment",
                                                            "label": "duration = (end_time - start_time).total_seconds()",
                                                            "start_token": 763,
                                                            "end_token": 773,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "label": "duration",
                                                                    "start_token": 763,
                                                                    "end_token": 763,
                                                                    "children": []
                                                                },
                                                                {
                                                                    "type": "call",
                                                                    "label": "(end_time - start_time).total_seconds()",
                                                                    "start_token": 765,
                                                                    "end_token": 773,
                                                                    "children": [
                                                                        {
                                                                            "type": "attribute",
                                                                            "label": "(end_time - start_time).total_seconds",
                                                                            "start_token": 765,
                                                                            "end_token": 771,
                                                                            "children": [
                                                                                {
                                                                                    "type": "parenthesized_expression",
                                                                                    "label": "(end_time - start_time)",
                                                                                    "start_token": 765,
                                                                                    "end_token": 769,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "binary_operator",
                                                                                            "label": "end_time - start_time",
                                                                                            "start_token": 766,
                                                                                            "end_token": 768,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "label": "end_time",
                                                                                                    "start_token": 766,
                                                                                                    "end_token": 766,
                                                                                                    "children": []
                                                                                                },
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "label": "start_time",
                                                                                                    "start_token": 768,
                                                                                                    "end_token": 768,
                                                                                                    "children": []
                                                                                                }
                                                                                            ]
                                                                                        }
                                                                                    ]
                                                                                },
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "total_seconds",
                                                                                    "start_token": 771,
                                                                                    "end_token": 771,
                                                                                    "children": []
                                                                                }
                                                                            ]
                                                                        },
                                                                        {
                                                                            "type": "argument_list",
                                                                            "label": "()",
                                                                            "start_token": 772,
                                                                            "end_token": 773,
                                                                            "children": []
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                },
                                                {
                                                    "type": "expression_statement",
                                                    "label": "total_run_time = duration",
                                                    "start_token": 775,
                                                    "end_token": 777,
                                                    "children": [
                                                        {
                                                            "type": "assignment",
                                                            "label": "total_run_time = duration",
                                                            "start_token": 775,
                                                            "end_token": 777,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "label": "total_run_time",
                                                                    "start_token": 775,
                                                                    "end_token": 775,
                                                                    "children": []
                                                                },
                                                                {
                                                                    "type": "identifier",
                                                                    "label": "duration",
                                                                    "start_token": 777,
                                                                    "end_token": 777,
                                                                    "children": []
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                },
                                                {
                                                    "type": "try_statement",
                                                    "label": "try:\n            stats = json.loads(execution.stats or \"{}\", target_type=dict[str, Any])\n        except ValueError:\n            stats = {}",
                                                    "start_token": 780,
                                                    "end_token": 812,
                                                    "children": [
                                                        {
                                                            "type": "block",
                                                            "label": "stats = json.loads(execution.stats or \"{}\", target_type=dict[str, Any])",
                                                            "start_token": 783,
                                                            "end_token": 803,
                                                            "children": [
                                                                {
                                                                    "type": "expression_statement",
                                                                    "label": "stats = json.loads(execution.stats or \"{}\", target_type=dict[str, Any])",
                                                                    "start_token": 783,
                                                                    "end_token": 803,
                                                                    "children": [
                                                                        {
                                                                            "type": "assignment",
                                                                            "label": "stats = json.loads(execution.stats or \"{}\", target_type=dict[str, Any])",
                                                                            "start_token": 783,
                                                                            "end_token": 803,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "stats",
                                                                                    "start_token": 783,
                                                                                    "end_token": 783,
                                                                                    "children": []
                                                                                },
                                                                                {
                                                                                    "type": "call",
                                                                                    "label": "json.loads(execution.stats or \"{}\", target_type=dict[str, Any])",
                                                                                    "start_token": 785,
                                                                                    "end_token": 803,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "attribute",
                                                                                            "label": "json.loads",
                                                                                            "start_token": 785,
                                                                                            "end_token": 787,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "label": "json",
                                                                                                    "start_token": 785,
                                                                                                    "end_token": 785,
                                                                                                    "children": []
                                                                                                },
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "label": "loads",
                                                                                                    "start_token": 787,
                                                                                                    "end_token": 787,
                                                                                                    "children": []
                                                                                                }
                                                                                            ]
                                                                                        },
                                                                                        {
                                                                                            "type": "argument_list",
                                                                                            "label": "(execution.stats or \"{}\", target_type=dict[str, Any])",
                                                                                            "start_token": 788,
                                                                                            "end_token": 803,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "boolean_operator",
                                                                                                    "label": "execution.stats or \"{}\"",
                                                                                                    "start_token": 789,
                                                                                                    "end_token": 793,
                                                                                                    "children": [
                                                                                                        {
                                                                                                            "type": "attribute",
                                                                                                            "label": "execution.stats",
                                                                                                            "start_token": 789,
                                                                                                            "end_token": 791,
                                                                                                            "children": [
                                                                                                                {
                                                                                                                    "type": "identifier",
                                                                                                                    "label": "execution",
                                                                                                                    "start_token": 789,
                                                                                                                    "end_token": 789,
                                                                                                                    "children": []
                                                                                                                },
                                                                                                                {
                                                                                                                    "type": "identifier",
                                                                                                                    "label": "stats",
                                                                                                                    "start_token": 791,
                                                                                                                    "end_token": 791,
                                                                                                                    "children": []
                                                                                                                }
                                                                                                            ]
                                                                                                        },
                                                                                                        {
                                                                                                            "type": "string",
                                                                                                            "label": "\"{}\"",
                                                                                                            "start_token": 793,
                                                                                                            "end_token": 793,
                                                                                                            "children": [
                                                                                                                {
                                                                                                                    "type": "string_start",
                                                                                                                    "label": "\"",
                                                                                                                    "start_token": 793,
                                                                                                                    "end_token": 793,
                                                                                                                    "children": []
                                                                                                                },
                                                                                                                {
                                                                                                                    "type": "string_content",
                                                                                                                    "label": "{}",
                                                                                                                    "start_token": 793,
                                                                                                                    "end_token": 793,
                                                                                                                    "children": []
                                                                                                                },
                                                                                                                {
                                                                                                                    "type": "string_end",
                                                                                                                    "label": "\"",
                                                                                                                    "start_token": 793,
                                                                                                                    "end_token": 793,
                                                                                                                    "children": []
                                                                                                                }
                                                                                                            ]
                                                                                                        }
                                                                                                    ]
                                                                                                },
                                                                                                {
                                                                                                    "type": "keyword_argument",
                                                                                                    "label": "target_type=dict[str, Any]",
                                                                                                    "start_token": 795,
                                                                                                    "end_token": 802,
                                                                                                    "children": [
                                                                                                        {
                                                                                                            "type": "identifier",
                                                                                                            "label": "target_type",
                                                                                                            "start_token": 795,
                                                                                                            "end_token": 795,
                                                                                                            "children": []
                                                                                                        },
                                                                                                        {
                                                                                                            "type": "subscript",
                                                                                                            "label": "dict[str, Any]",
                                                                                                            "start_token": 797,
                                                                                                            "end_token": 802,
                                                                                                            "children": [
                                                                                                                {
                                                                                                                    "type": "identifier",
                                                                                                                    "label": "dict",
                                                                                                                    "start_token": 797,
                                                                                                                    "end_token": 797,
                                                                                                                    "children": []
                                                                                                                },
                                                                                                                {
                                                                                                                    "type": "identifier",
                                                                                                                    "label": "str",
                                                                                                                    "start_token": 799,
                                                                                                                    "end_token": 799,
                                                                                                                    "children": []
                                                                                                                },
                                                                                                                {
                                                                                                                    "type": "identifier",
                                                                                                                    "label": "Any",
                                                                                                                    "start_token": 801,
                                                                                                                    "end_token": 801,
                                                                                                                    "children": []
                                                                                                                }
                                                                                                            ]
                                                                                                        }
                                                                                                    ]
                                                                                                }
                                                                                            ]
                                                                                        }
                                                                                    ]
                                                                                }
                                                                            ]
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        },
                                                        {
                                                            "type": "except_clause",
                                                            "label": "except ValueError:\n            stats = {}",
                                                            "start_token": 805,
                                                            "end_token": 812,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "label": "ValueError",
                                                                    "start_token": 806,
                                                                    "end_token": 806,
                                                                    "children": []
                                                                },
                                                                {
                                                                    "type": "block",
                                                                    "label": "stats = {}",
                                                                    "start_token": 809,
                                                                    "end_token": 812,
                                                                    "children": [
                                                                        {
                                                                            "type": "expression_statement",
                                                                            "label": "stats = {}",
                                                                            "start_token": 809,
                                                                            "end_token": 812,
                                                                            "children": [
                                                                                {
                                                                                    "type": "assignment",
                                                                                    "label": "stats = {}",
                                                                                    "start_token": 809,
                                                                                    "end_token": 812,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "label": "stats",
                                                                                            "start_token": 809,
                                                                                            "end_token": 809,
                                                                                            "children": []
                                                                                        },
                                                                                        {
                                                                                            "type": "dictionary",
                                                                                            "label": "{}",
                                                                                            "start_token": 811,
                                                                                            "end_token": 812,
                                                                                            "children": []
                                                                                        }
                                                                                    ]
                                                                                }
                                                                            ]
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                },
                                                {
                                                    "type": "expression_statement",
                                                    "label": "duration = stats.get(\"walltime\", duration)",
                                                    "start_token": 815,
                                                    "end_token": 824,
                                                    "children": [
                                                        {
                                                            "type": "assignment",
                                                            "label": "duration = stats.get(\"walltime\", duration)",
                                                            "start_token": 815,
                                                            "end_token": 824,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "label": "duration",
                                                                    "start_token": 815,
                                                                    "end_token": 815,
                                                                    "children": []
                                                                },
                                                                {
                                                                    "type": "call",
                                                                    "label": "stats.get(\"walltime\", duration)",
                                                                    "start_token": 817,
                                                                    "end_token": 824,
                                                                    "children": [
                                                                        {
                                                                            "type": "attribute",
                                                                            "label": "stats.get",
                                                                            "start_token": 817,
                                                                            "end_token": 819,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "stats",
                                                                                    "start_token": 817,
                                                                                    "end_token": 817,
                                                                                    "children": []
                                                                                },
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "get",
                                                                                    "start_token": 819,
                                                                                    "end_token": 819,
                                                                                    "children": []
                                                                                }
                                                                            ]
                                                                        },
                                                                        {
                                                                            "type": "argument_list",
                                                                            "label": "(\"walltime\", duration)",
                                                                            "start_token": 820,
                                                                            "end_token": 824,
                                                                            "children": [
                                                                                {
                                                                                    "type": "string",
                                                                                    "label": "\"walltime\"",
                                                                                    "start_token": 821,
                                                                                    "end_token": 821,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "string_start",
                                                                                            "label": "\"",
                                                                                            "start_token": 821,
                                                                                            "end_token": 821,
                                                                                            "children": []
                                                                                        },
                                                                                        {
                                                                                            "type": "string_content",
                                                                                            "label": "walltime",
                                                                                            "start_token": 821,
                                                                                            "end_token": 821,
                                                                                            "children": []
                                                                                        },
                                                                                        {
                                                                                            "type": "string_end",
                                                                                            "label": "\"",
                                                                                            "start_token": 821,
                                                                                            "end_token": 821,
                                                                                            "children": []
                                                                                        }
                                                                                    ]
                                                                                },
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "duration",
                                                                                    "start_token": 823,
                                                                                    "end_token": 823,
                                                                                    "children": []
                                                                                }
                                                                            ]
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                },
                                                {
                                                    "type": "expression_statement",
                                                    "label": "total_run_time = stats.get(\"nodes_walltime\", total_run_time)",
                                                    "start_token": 826,
                                                    "end_token": 835,
                                                    "children": [
                                                        {
                                                            "type": "assignment",
                                                            "label": "total_run_time = stats.get(\"nodes_walltime\", total_run_time)",
                                                            "start_token": 826,
                                                            "end_token": 835,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "label": "total_run_time",
                                                                    "start_token": 826,
                                                                    "end_token": 826,
                                                                    "children": []
                                                                },
                                                                {
                                                                    "type": "call",
                                                                    "label": "stats.get(\"nodes_walltime\", total_run_time)",
                                                                    "start_token": 828,
                                                                    "end_token": 835,
                                                                    "children": [
                                                                        {
                                                                            "type": "attribute",
                                                                            "label": "stats.get",
                                                                            "start_token": 828,
                                                                            "end_token": 830,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "stats",
                                                                                    "start_token": 828,
                                                                                    "end_token": 828,
                                                                                    "children": []
                                                                                },
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "get",
                                                                                    "start_token": 830,
                                                                                    "end_token": 830,
                                                                                    "children": []
                                                                                }
                                                                            ]
                                                                        },
                                                                        {
                                                                            "type": "argument_list",
                                                                            "label": "(\"nodes_walltime\", total_run_time)",
                                                                            "start_token": 831,
                                                                            "end_token": 835,
                                                                            "children": [
                                                                                {
                                                                                    "type": "string",
                                                                                    "label": "\"nodes_walltime\"",
                                                                                    "start_token": 832,
                                                                                    "end_token": 832,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "string_start",
                                                                                            "label": "\"",
                                                                                            "start_token": 832,
                                                                                            "end_token": 832,
                                                                                            "children": []
                                                                                        },
                                                                                        {
                                                                                            "type": "string_content",
                                                                                            "label": "nodes_walltime",
                                                                                            "start_token": 832,
                                                                                            "end_token": 832,
                                                                                            "children": []
                                                                                        },
                                                                                        {
                                                                                            "type": "string_end",
                                                                                            "label": "\"",
                                                                                            "start_token": 832,
                                                                                            "end_token": 832,
                                                                                            "children": []
                                                                                        }
                                                                                    ]
                                                                                },
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "total_run_time",
                                                                                    "start_token": 834,
                                                                                    "end_token": 834,
                                                                                    "children": []
                                                                                }
                                                                            ]
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                },
                                                {
                                                    "type": "return_statement",
                                                    "label": "return GraphExecution(\n            id=execution.id,\n            execution_id=execution.id,\n            started_at=start_time,\n            ended_at=end_time,\n            duration=duration,\n            total_run_time=total_run_time,\n            status=ExecutionStatus(execution.executionStatus),\n            graph_id=execution.agentGraphId,\n            graph_version=execution.agentGraphVersion,\n        )",
                                                    "start_token": 838,
                                                    "end_token": 900,
                                                    "children": [
                                                        {
                                                            "type": "call",
                                                            "label": "GraphExecution(\n            id=execution.id,\n            execution_id=execution.id,\n            started_at=start_time,\n            ended_at=end_time,\n            duration=duration,\n            total_run_time=total_run_time,\n            status=ExecutionStatus(execution.executionStatus),\n            graph_id=execution.agentGraphId,\n            graph_version=execution.agentGraphVersion,\n        )",
                                                            "start_token": 839,
                                                            "end_token": 900,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "label": "GraphExecution",
                                                                    "start_token": 839,
                                                                    "end_token": 839,
                                                                    "children": []
                                                                },
                                                                {
                                                                    "type": "argument_list",
                                                                    "label": "(\n            id=execution.id,\n            execution_id=execution.id,\n            started_at=start_time,\n            ended_at=end_time,\n            duration=duration,\n            total_run_time=total_run_time,\n            status=ExecutionStatus(execution.executionStatus),\n            graph_id=execution.agentGraphId,\n            graph_version=execution.agentGraphVersion,\n        )",
                                                                    "start_token": 840,
                                                                    "end_token": 900,
                                                                    "children": [
                                                                        {
                                                                            "type": "keyword_argument",
                                                                            "label": "id=execution.id",
                                                                            "start_token": 842,
                                                                            "end_token": 846,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "id",
                                                                                    "start_token": 842,
                                                                                    "end_token": 842,
                                                                                    "children": []
                                                                                },
                                                                                {
                                                                                    "type": "attribute",
                                                                                    "label": "execution.id",
                                                                                    "start_token": 844,
                                                                                    "end_token": 846,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "label": "execution",
                                                                                            "start_token": 844,
                                                                                            "end_token": 844,
                                                                                            "children": []
                                                                                        },
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "label": "id",
                                                                                            "start_token": 846,
                                                                                            "end_token": 846,
                                                                                            "children": []
                                                                                        }
                                                                                    ]
                                                                                }
                                                                            ]
                                                                        },
                                                                        {
                                                                            "type": "keyword_argument",
                                                                            "label": "execution_id=execution.id",
                                                                            "start_token": 849,
                                                                            "end_token": 853,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "execution_id",
                                                                                    "start_token": 849,
                                                                                    "end_token": 849,
                                                                                    "children": []
                                                                                },
                                                                                {
                                                                                    "type": "attribute",
                                                                                    "label": "execution.id",
                                                                                    "start_token": 851,
                                                                                    "end_token": 853,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "label": "execution",
                                                                                            "start_token": 851,
                                                                                            "end_token": 851,
                                                                                            "children": []
                                                                                        },
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "label": "id",
                                                                                            "start_token": 853,
                                                                                            "end_token": 853,
                                                                                            "children": []
                                                                                        }
                                                                                    ]
                                                                                }
                                                                            ]
                                                                        },
                                                                        {
                                                                            "type": "keyword_argument",
                                                                            "label": "started_at=start_time",
                                                                            "start_token": 856,
                                                                            "end_token": 858,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "started_at",
                                                                                    "start_token": 856,
                                                                                    "end_token": 856,
                                                                                    "children": []
                                                                                },
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "start_time",
                                                                                    "start_token": 858,
                                                                                    "end_token": 858,
                                                                                    "children": []
                                                                                }
                                                                            ]
                                                                        },
                                                                        {
                                                                            "type": "keyword_argument",
                                                                            "label": "ended_at=end_time",
                                                                            "start_token": 861,
                                                                            "end_token": 863,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "ended_at",
                                                                                    "start_token": 861,
                                                                                    "end_token": 861,
                                                                                    "children": []
                                                                                },
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "end_time",
                                                                                    "start_token": 863,
                                                                                    "end_token": 863,
                                                                                    "children": []
                                                                                }
                                                                            ]
                                                                        },
                                                                        {
                                                                            "type": "keyword_argument",
                                                                            "label": "duration=duration",
                                                                            "start_token": 866,
                                                                            "end_token": 868,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "duration",
                                                                                    "start_token": 866,
                                                                                    "end_token": 866,
                                                                                    "children": []
                                                                                },
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "duration",
                                                                                    "start_token": 868,
                                                                                    "end_token": 868,
                                                                                    "children": []
                                                                                }
                                                                            ]
                                                                        },
                                                                        {
                                                                            "type": "keyword_argument",
                                                                            "label": "total_run_time=total_run_time",
                                                                            "start_token": 871,
                                                                            "end_token": 873,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "total_run_time",
                                                                                    "start_token": 871,
                                                                                    "end_token": 871,
                                                                                    "children": []
                                                                                },
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "total_run_time",
                                                                                    "start_token": 873,
                                                                                    "end_token": 873,
                                                                                    "children": []
                                                                                }
                                                                            ]
                                                                        },
                                                                        {
                                                                            "type": "keyword_argument",
                                                                            "label": "status=ExecutionStatus(execution.executionStatus)",
                                                                            "start_token": 876,
                                                                            "end_token": 883,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "status",
                                                                                    "start_token": 876,
                                                                                    "end_token": 876,
                                                                                    "children": []
                                                                                },
                                                                                {
                                                                                    "type": "call",
                                                                                    "label": "ExecutionStatus(execution.executionStatus)",
                                                                                    "start_token": 878,
                                                                                    "end_token": 883,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "label": "ExecutionStatus",
                                                                                            "start_token": 878,
                                                                                            "end_token": 878,
                                                                                            "children": []
                                                                                        },
                                                                                        {
                                                                                            "type": "argument_list",
                                                                                            "label": "(execution.executionStatus)",
                                                                                            "start_token": 879,
                                                                                            "end_token": 883,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "attribute",
                                                                                                    "label": "execution.executionStatus",
                                                                                                    "start_token": 880,
                                                                                                    "end_token": 882,
                                                                                                    "children": [
                                                                                                        {
                                                                                                            "type": "identifier",
                                                                                                            "label": "execution",
                                                                                                            "start_token": 880,
                                                                                                            "end_token": 880,
                                                                                                            "children": []
                                                                                                        },
                                                                                                        {
                                                                                                            "type": "identifier",
                                                                                                            "label": "executionStatus",
                                                                                                            "start_token": 882,
                                                                                                            "end_token": 882,
                                                                                                            "children": []
                                                                                                        }
                                                                                                    ]
                                                                                                }
                                                                                            ]
                                                                                        }
                                                                                    ]
                                                                                }
                                                                            ]
                                                                        },
                                                                        {
                                                                            "type": "keyword_argument",
                                                                            "label": "graph_id=execution.agentGraphId",
                                                                            "start_token": 886,
                                                                            "end_token": 890,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "graph_id",
                                                                                    "start_token": 886,
                                                                                    "end_token": 886,
                                                                                    "children": []
                                                                                },
                                                                                {
                                                                                    "type": "attribute",
                                                                                    "label": "execution.agentGraphId",
                                                                                    "start_token": 888,
                                                                                    "end_token": 890,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "label": "execution",
                                                                                            "start_token": 888,
                                                                                            "end_token": 888,
                                                                                            "children": []
                                                                                        },
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "label": "agentGraphId",
                                                                                            "start_token": 890,
                                                                                            "end_token": 890,
                                                                                            "children": []
                                                                                        }
                                                                                    ]
                                                                                }
                                                                            ]
                                                                        },
                                                                        {
                                                                            "type": "keyword_argument",
                                                                            "label": "graph_version=execution.agentGraphVersion",
                                                                            "start_token": 893,
                                                                            "end_token": 897,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "graph_version",
                                                                                    "start_token": 893,
                                                                                    "end_token": 893,
                                                                                    "children": []
                                                                                },
                                                                                {
                                                                                    "type": "attribute",
                                                                                    "label": "execution.agentGraphVersion",
                                                                                    "start_token": 895,
                                                                                    "end_token": 897,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "label": "execution",
                                                                                            "start_token": 895,
                                                                                            "end_token": 895,
                                                                                            "children": []
                                                                                        },
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "label": "agentGraphVersion",
                                                                                            "start_token": 897,
                                                                                            "end_token": 897,
                                                                                            "children": []
                                                                                        }
                                                                                    ]
                                                                                }
                                                                            ]
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                }
                                            ]
                                        }
                                    ]
                                }
                            ]
                        }
                    ]
                }
            ]
        },
        {
            "type": "class_definition",
            "label": "class Graph(BaseDbModel):\n    version: int = 1\n    is_active: bool = True\n    is_template: bool = False\n    name: str\n    description: str\n    nodes: list[Node] = []\n    links: list[Link] = []\n\n    @computed_field\n    @property\n    def input_schema(self) -> dict[str, Any]:\n        return self._generate_schema(\n            AgentInputBlock.Input,\n            [\n                node.input_default\n                for node in self.nodes\n                if (b := get_block(node.block_id))\n                and b.block_type == BlockType.INPUT\n                and \"name\" in node.input_default\n            ],\n        )\n\n    @computed_field\n    @property\n    def output_schema(self) -> dict[str, Any]:\n        return self._generate_schema(\n            AgentOutputBlock.Input,\n            [\n                node.input_default\n                for node in self.nodes\n                if (b := get_block(node.block_id))\n                and b.block_type == BlockType.OUTPUT\n                and \"name\" in node.input_default\n            ],\n        )\n\n    @staticmethod\n    def _generate_schema(\n        type_class: Type[AgentInputBlock.Input] | Type[AgentOutputBlock.Input],\n        data: list[dict],\n    ) -> dict[str, Any]:\n        props = []\n        for p in data:\n            try:\n                props.append(type_class(**p))\n            except Exception as e:\n                logger.warning(f\"Invalid {type_class}: {p}, {e}\")\n\n        return {\n            \"type\": \"object\",\n            \"properties\": {\n                p.name: {\n                    \"secret\": p.secret,\n                    \"advanced\": p.advanced,\n                    \"title\": p.title or p.name,\n                    **({\"description\": p.description} if p.description else {}),\n                    **({\"default\": p.value} if p.value is not None else {}),\n                }\n                for p in props\n            },\n            \"required\": [p.name for p in props if p.value is None],\n        }",
            "start_token": 904,
            "end_token": 1319,
            "children": [
                {
                    "type": "identifier",
                    "label": "Graph",
                    "start_token": 905,
                    "end_token": 905,
                    "children": []
                },
                {
                    "type": "argument_list",
                    "label": "(BaseDbModel)",
                    "start_token": 906,
                    "end_token": 908,
                    "children": [
                        {
                            "type": "identifier",
                            "label": "BaseDbModel",
                            "start_token": 907,
                            "end_token": 907,
                            "children": []
                        }
                    ]
                },
                {
                    "type": "block",
                    "label": "version: int = 1\n    is_active: bool = True\n    is_template: bool = False\n    name: str\n    description: str\n    nodes: list[Node] = []\n    links: list[Link] = []\n\n    @computed_field\n    @property\n    def input_schema(self) -> dict[str, Any]:\n        return self._generate_schema(\n            AgentInputBlock.Input,\n            [\n                node.input_default\n                for node in self.nodes\n                if (b := get_block(node.block_id))\n                and b.block_type == BlockType.INPUT\n                and \"name\" in node.input_default\n            ],\n        )\n\n    @computed_field\n    @property\n    def output_schema(self) -> dict[str, Any]:\n        return self._generate_schema(\n            AgentOutputBlock.Input,\n            [\n                node.input_default\n                for node in self.nodes\n                if (b := get_block(node.block_id))\n                and b.block_type == BlockType.OUTPUT\n                and \"name\" in node.input_default\n            ],\n        )\n\n    @staticmethod\n    def _generate_schema(\n        type_class: Type[AgentInputBlock.Input] | Type[AgentOutputBlock.Input],\n        data: list[dict],\n    ) -> dict[str, Any]:\n        props = []\n        for p in data:\n            try:\n                props.append(type_class(**p))\n            except Exception as e:\n                logger.warning(f\"Invalid {type_class}: {p}, {e}\")\n\n        return {\n            \"type\": \"object\",\n            \"properties\": {\n                p.name: {\n                    \"secret\": p.secret,\n                    \"advanced\": p.advanced,\n                    \"title\": p.title or p.name,\n                    **({\"description\": p.description} if p.description else {}),\n                    **({\"default\": p.value} if p.value is not None else {}),\n                }\n                for p in props\n            },\n            \"required\": [p.name for p in props if p.value is None],\n        }",
                    "start_token": 911,
                    "end_token": 1319,
                    "children": [
                        {
                            "type": "expression_statement",
                            "label": "version: int = 1",
                            "start_token": 911,
                            "end_token": 915,
                            "children": [
                                {
                                    "type": "assignment",
                                    "label": "version: int = 1",
                                    "start_token": 911,
                                    "end_token": 915,
                                    "children": [
                                        {
                                            "type": "identifier",
                                            "label": "version",
                                            "start_token": 911,
                                            "end_token": 911,
                                            "children": []
                                        },
                                        {
                                            "type": "type",
                                            "label": "int",
                                            "start_token": 913,
                                            "end_token": 913,
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "label": "int",
                                                    "start_token": 913,
                                                    "end_token": 913,
                                                    "children": []
                                                }
                                            ]
                                        },
                                        {
                                            "type": "integer",
                                            "label": "1",
                                            "start_token": 915,
                                            "end_token": 915,
                                            "children": []
                                        }
                                    ]
                                }
                            ]
                        },
                        {
                            "type": "expression_statement",
                            "label": "is_active: bool = True",
                            "start_token": 917,
                            "end_token": 921,
                            "children": [
                                {
                                    "type": "assignment",
                                    "label": "is_active: bool = True",
                                    "start_token": 917,
                                    "end_token": 921,
                                    "children": [
                                        {
                                            "type": "identifier",
                                            "label": "is_active",
                                            "start_token": 917,
                                            "end_token": 917,
                                            "children": []
                                        },
                                        {
                                            "type": "type",
                                            "label": "bool",
                                            "start_token": 919,
                                            "end_token": 919,
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "label": "bool",
                                                    "start_token": 919,
                                                    "end_token": 919,
                                                    "children": []
                                                }
                                            ]
                                        },
                                        {
                                            "type": "true",
                                            "label": "True",
                                            "start_token": 921,
                                            "end_token": 921,
                                            "children": []
                                        }
                                    ]
                                }
                            ]
                        },
                        {
                            "type": "expression_statement",
                            "label": "is_template: bool = False",
                            "start_token": 923,
                            "end_token": 927,
                            "children": [
                                {
                                    "type": "assignment",
                                    "label": "is_template: bool = False",
                                    "start_token": 923,
                                    "end_token": 927,
                                    "children": [
                                        {
                                            "type": "identifier",
                                            "label": "is_template",
                                            "start_token": 923,
                                            "end_token": 923,
                                            "children": []
                                        },
                                        {
                                            "type": "type",
                                            "label": "bool",
                                            "start_token": 925,
                                            "end_token": 925,
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "label": "bool",
                                                    "start_token": 925,
                                                    "end_token": 925,
                                                    "children": []
                                                }
                                            ]
                                        },
                                        {
                                            "type": "false",
                                            "label": "False",
                                            "start_token": 927,
                                            "end_token": 927,
                                            "children": []
                                        }
                                    ]
                                }
                            ]
                        },
                        {
                            "type": "expression_statement",
                            "label": "name: str",
                            "start_token": 929,
                            "end_token": 931,
                            "children": [
                                {
                                    "type": "assignment",
                                    "label": "name: str",
                                    "start_token": 929,
                                    "end_token": 931,
                                    "children": [
                                        {
                                            "type": "identifier",
                                            "label": "name",
                                            "start_token": 929,
                                            "end_token": 929,
                                            "children": []
                                        },
                                        {
                                            "type": "type",
                                            "label": "str",
                                            "start_token": 931,
                                            "end_token": 931,
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "label": "str",
                                                    "start_token": 931,
                                                    "end_token": 931,
                                                    "children": []
                                                }
                                            ]
                                        }
                                    ]
                                }
                            ]
                        },
                        {
                            "type": "expression_statement",
                            "label": "description: str",
                            "start_token": 933,
                            "end_token": 935,
                            "children": [
                                {
                                    "type": "assignment",
                                    "label": "description: str",
                                    "start_token": 933,
                                    "end_token": 935,
                                    "children": [
                                        {
                                            "type": "identifier",
                                            "label": "description",
                                            "start_token": 933,
                                            "end_token": 933,
                                            "children": []
                                        },
                                        {
                                            "type": "type",
                                            "label": "str",
                                            "start_token": 935,
                                            "end_token": 935,
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "label": "str",
                                                    "start_token": 935,
                                                    "end_token": 935,
                                                    "children": []
                                                }
                                            ]
                                        }
                                    ]
                                }
                            ]
                        },
                        {
                            "type": "expression_statement",
                            "label": "nodes: list[Node] = []",
                            "start_token": 937,
                            "end_token": 945,
                            "children": [
                                {
                                    "type": "assignment",
                                    "label": "nodes: list[Node] = []",
                                    "start_token": 937,
                                    "end_token": 945,
                                    "children": [
                                        {
                                            "type": "identifier",
                                            "label": "nodes",
                                            "start_token": 937,
                                            "end_token": 937,
                                            "children": []
                                        },
                                        {
                                            "type": "type",
                                            "label": "list[Node]",
                                            "start_token": 939,
                                            "end_token": 942,
                                            "children": [
                                                {
                                                    "type": "generic_type",
                                                    "label": "list[Node]",
                                                    "start_token": 939,
                                                    "end_token": 942,
                                                    "children": [
                                                        {
                                                            "type": "identifier",
                                                            "label": "list",
                                                            "start_token": 939,
                                                            "end_token": 939,
                                                            "children": []
                                                        },
                                                        {
                                                            "type": "type_parameter",
                                                            "label": "[Node]",
                                                            "start_token": 940,
                                                            "end_token": 942,
                                                            "children": [
                                                                {
                                                                    "type": "type",
                                                                    "label": "Node",
                                                                    "start_token": 941,
                                                                    "end_token": 941,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "Node",
                                                                            "start_token": 941,
                                                                            "end_token": 941,
                                                                            "children": []
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                }
                                            ]
                                        },
                                        {
                                            "type": "list",
                                            "label": "[]",
                                            "start_token": 944,
                                            "end_token": 945,
                                            "children": []
                                        }
                                    ]
                                }
                            ]
                        },
                        {
                            "type": "expression_statement",
                            "label": "links: list[Link] = []",
                            "start_token": 947,
                            "end_token": 955,
                            "children": [
                                {
                                    "type": "assignment",
                                    "label": "links: list[Link] = []",
                                    "start_token": 947,
                                    "end_token": 955,
                                    "children": [
                                        {
                                            "type": "identifier",
                                            "label": "links",
                                            "start_token": 947,
                                            "end_token": 947,
                                            "children": []
                                        },
                                        {
                                            "type": "type",
                                            "label": "list[Link]",
                                            "start_token": 949,
                                            "end_token": 952,
                                            "children": [
                                                {
                                                    "type": "generic_type",
                                                    "label": "list[Link]",
                                                    "start_token": 949,
                                                    "end_token": 952,
                                                    "children": [
                                                        {
                                                            "type": "identifier",
                                                            "label": "list",
                                                            "start_token": 949,
                                                            "end_token": 949,
                                                            "children": []
                                                        },
                                                        {
                                                            "type": "type_parameter",
                                                            "label": "[Link]",
                                                            "start_token": 950,
                                                            "end_token": 952,
                                                            "children": [
                                                                {
                                                                    "type": "type",
                                                                    "label": "Link",
                                                                    "start_token": 951,
                                                                    "end_token": 951,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "Link",
                                                                            "start_token": 951,
                                                                            "end_token": 951,
                                                                            "children": []
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                }
                                            ]
                                        },
                                        {
                                            "type": "list",
                                            "label": "[]",
                                            "start_token": 954,
                                            "end_token": 955,
                                            "children": []
                                        }
                                    ]
                                }
                            ]
                        },
                        {
                            "type": "decorated_definition",
                            "label": "@computed_field\n    @property\n    def input_schema(self) -> dict[str, Any]:\n        return self._generate_schema(\n            AgentInputBlock.Input,\n            [\n                node.input_default\n                for node in self.nodes\n                if (b := get_block(node.block_id))\n                and b.block_type == BlockType.INPUT\n                and \"name\" in node.input_default\n            ],\n        )",
                            "start_token": 958,
                            "end_token": 1036,
                            "children": [
                                {
                                    "type": "decorator",
                                    "label": "@computed_field",
                                    "start_token": 958,
                                    "end_token": 959,
                                    "children": [
                                        {
                                            "type": "identifier",
                                            "label": "computed_field",
                                            "start_token": 959,
                                            "end_token": 959,
                                            "children": []
                                        }
                                    ]
                                },
                                {
                                    "type": "decorator",
                                    "label": "@property",
                                    "start_token": 961,
                                    "end_token": 962,
                                    "children": [
                                        {
                                            "type": "identifier",
                                            "label": "property",
                                            "start_token": 962,
                                            "end_token": 962,
                                            "children": []
                                        }
                                    ]
                                },
                                {
                                    "type": "function_definition",
                                    "label": "def input_schema(self) -> dict[str, Any]:\n        return self._generate_schema(\n            AgentInputBlock.Input,\n            [\n                node.input_default\n                for node in self.nodes\n                if (b := get_block(node.block_id))\n                and b.block_type == BlockType.INPUT\n                and \"name\" in node.input_default\n            ],\n        )",
                                    "start_token": 964,
                                    "end_token": 1036,
                                    "children": [
                                        {
                                            "type": "identifier",
                                            "label": "input_schema",
                                            "start_token": 965,
                                            "end_token": 965,
                                            "children": []
                                        },
                                        {
                                            "type": "parameters",
                                            "label": "(self)",
                                            "start_token": 966,
                                            "end_token": 968,
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "label": "self",
                                                    "start_token": 967,
                                                    "end_token": 967,
                                                    "children": []
                                                }
                                            ]
                                        },
                                        {
                                            "type": "type",
                                            "label": "dict[str, Any]",
                                            "start_token": 971,
                                            "end_token": 976,
                                            "children": [
                                                {
                                                    "type": "generic_type",
                                                    "label": "dict[str, Any]",
                                                    "start_token": 971,
                                                    "end_token": 976,
                                                    "children": [
                                                        {
                                                            "type": "identifier",
                                                            "label": "dict",
                                                            "start_token": 971,
                                                            "end_token": 971,
                                                            "children": []
                                                        },
                                                        {
                                                            "type": "type_parameter",
                                                            "label": "[str, Any]",
                                                            "start_token": 972,
                                                            "end_token": 976,
                                                            "children": [
                                                                {
                                                                    "type": "type",
                                                                    "label": "str",
                                                                    "start_token": 973,
                                                                    "end_token": 973,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "str",
                                                                            "start_token": 973,
                                                                            "end_token": 973,
                                                                            "children": []
                                                                        }
                                                                    ]
                                                                },
                                                                {
                                                                    "type": "type",
                                                                    "label": "Any",
                                                                    "start_token": 975,
                                                                    "end_token": 975,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "Any",
                                                                            "start_token": 975,
                                                                            "end_token": 975,
                                                                            "children": []
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                }
                                            ]
                                        },
                                        {
                                            "type": "block",
                                            "label": "return self._generate_schema(\n            AgentInputBlock.Input,\n            [\n                node.input_default\n                for node in self.nodes\n                if (b := get_block(node.block_id))\n                and b.block_type == BlockType.INPUT\n                and \"name\" in node.input_default\n            ],\n        )",
                                            "start_token": 979,
                                            "end_token": 1036,
                                            "children": [
                                                {
                                                    "type": "return_statement",
                                                    "label": "return self._generate_schema(\n            AgentInputBlock.Input,\n            [\n                node.input_default\n                for node in self.nodes\n                if (b := get_block(node.block_id))\n                and b.block_type == BlockType.INPUT\n                and \"name\" in node.input_default\n            ],\n        )",
                                                    "start_token": 979,
                                                    "end_token": 1036,
                                                    "children": [
                                                        {
                                                            "type": "call",
                                                            "label": "self._generate_schema(\n            AgentInputBlock.Input,\n            [\n                node.input_default\n                for node in self.nodes\n                if (b := get_block(node.block_id))\n                and b.block_type == BlockType.INPUT\n                and \"name\" in node.input_default\n            ],\n        )",
                                                            "start_token": 980,
                                                            "end_token": 1036,
                                                            "children": [
                                                                {
                                                                    "type": "attribute",
                                                                    "label": "self._generate_schema",
                                                                    "start_token": 980,
                                                                    "end_token": 982,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "self",
                                                                            "start_token": 980,
                                                                            "end_token": 980,
                                                                            "children": []
                                                                        },
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "_generate_schema",
                                                                            "start_token": 982,
                                                                            "end_token": 982,
                                                                            "children": []
                                                                        }
                                                                    ]
                                                                },
                                                                {
                                                                    "type": "argument_list",
                                                                    "label": "(\n            AgentInputBlock.Input,\n            [\n                node.input_default\n                for node in self.nodes\n                if (b := get_block(node.block_id))\n                and b.block_type == BlockType.INPUT\n                and \"name\" in node.input_default\n            ],\n        )",
                                                                    "start_token": 983,
                                                                    "end_token": 1036,
                                                                    "children": [
                                                                        {
                                                                            "type": "attribute",
                                                                            "label": "AgentInputBlock.Input",
                                                                            "start_token": 985,
                                                                            "end_token": 987,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "AgentInputBlock",
                                                                                    "start_token": 985,
                                                                                    "end_token": 985,
                                                                                    "children": []
                                                                                },
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "Input",
                                                                                    "start_token": 987,
                                                                                    "end_token": 987,
                                                                                    "children": []
                                                                                }
                                                                            ]
                                                                        },
                                                                        {
                                                                            "type": "list_comprehension",
                                                                            "label": "[\n                node.input_default\n                for node in self.nodes\n                if (b := get_block(node.block_id))\n                and b.block_type == BlockType.INPUT\n                and \"name\" in node.input_default\n            ]",
                                                                            "start_token": 990,
                                                                            "end_token": 1033,
                                                                            "children": [
                                                                                {
                                                                                    "type": "attribute",
                                                                                    "label": "node.input_default",
                                                                                    "start_token": 992,
                                                                                    "end_token": 994,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "label": "node",
                                                                                            "start_token": 992,
                                                                                            "end_token": 992,
                                                                                            "children": []
                                                                                        },
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "label": "input_default",
                                                                                            "start_token": 994,
                                                                                            "end_token": 994,
                                                                                            "children": []
                                                                                        }
                                                                                    ]
                                                                                },
                                                                                {
                                                                                    "type": "for_in_clause",
                                                                                    "label": "for node in self.nodes",
                                                                                    "start_token": 996,
                                                                                    "end_token": 1001,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "label": "node",
                                                                                            "start_token": 997,
                                                                                            "end_token": 997,
                                                                                            "children": []
                                                                                        },
                                                                                        {
                                                                                            "type": "attribute",
                                                                                            "label": "self.nodes",
                                                                                            "start_token": 999,
                                                                                            "end_token": 1001,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "label": "self",
                                                                                                    "start_token": 999,
                                                                                                    "end_token": 999,
                                                                                                    "children": []
                                                                                                },
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "label": "nodes",
                                                                                                    "start_token": 1001,
                                                                                                    "end_token": 1001,
                                                                                                    "children": []
                                                                                                }
                                                                                            ]
                                                                                        }
                                                                                    ]
                                                                                },
                                                                                {
                                                                                    "type": "if_clause",
                                                                                    "label": "if (b := get_block(node.block_id))\n                and b.block_type == BlockType.INPUT\n                and \"name\" in node.input_default",
                                                                                    "start_token": 1003,
                                                                                    "end_token": 1031,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "boolean_operator",
                                                                                            "label": "(b := get_block(node.block_id))\n                and b.block_type == BlockType.INPUT\n                and \"name\" in node.input_default",
                                                                                            "start_token": 1004,
                                                                                            "end_token": 1031,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "boolean_operator",
                                                                                                    "label": "(b := get_block(node.block_id))\n                and b.block_type == BlockType.INPUT",
                                                                                                    "start_token": 1004,
                                                                                                    "end_token": 1024,
                                                                                                    "children": [
                                                                                                        {
                                                                                                            "type": "parenthesized_expression",
                                                                                                            "label": "(b := get_block(node.block_id))",
                                                                                                            "start_token": 1004,
                                                                                                            "end_token": 1014,
                                                                                                            "children": [
                                                                                                                {
                                                                                                                    "type": "named_expression",
                                                                                                                    "label": "b := get_block(node.block_id)",
                                                                                                                    "start_token": 1005,
                                                                                                                    "end_token": 1013,
                                                                                                                    "children": [
                                                                                                                        {
                                                                                                                            "type": "identifier",
                                                                                                                            "label": "b",
                                                                                                                            "start_token": 1005,
                                                                                                                            "end_token": 1005,
                                                                                                                            "children": []
                                                                                                                        },
                                                                                                                        {
                                                                                                                            "type": "call",
                                                                                                                            "label": "get_block(node.block_id)",
                                                                                                                            "start_token": 1008,
                                                                                                                            "end_token": 1013,
                                                                                                                            "children": [
                                                                                                                                {
                                                                                                                                    "type": "identifier",
                                                                                                                                    "label": "get_block",
                                                                                                                                    "start_token": 1008,
                                                                                                                                    "end_token": 1008,
                                                                                                                                    "children": []
                                                                                                                                },
                                                                                                                                {
                                                                                                                                    "type": "argument_list",
                                                                                                                                    "label": "(node.block_id)",
                                                                                                                                    "start_token": 1009,
                                                                                                                                    "end_token": 1013,
                                                                                                                                    "children": [
                                                                                                                                        {
                                                                                                                                            "type": "attribute",
                                                                                                                                            "label": "node.block_id",
                                                                                                                                            "start_token": 1010,
                                                                                                                                            "end_token": 1012,
                                                                                                                                            "children": [
                                                                                                                                                {
                                                                                                                                                    "type": "identifier",
                                                                                                                                                    "label": "node",
                                                                                                                                                    "start_token": 1010,
                                                                                                                                                    "end_token": 1010,
                                                                                                                                                    "children": []
                                                                                                                                                },
                                                                                                                                                {
                                                                                                                                                    "type": "identifier",
                                                                                                                                                    "label": "block_id",
                                                                                                                                                    "start_token": 1012,
                                                                                                                                                    "end_token": 1012,
                                                                                                                                                    "children": []
                                                                                                                                                }
                                                                                                                                            ]
                                                                                                                                        }
                                                                                                                                    ]
                                                                                                                                }
                                                                                                                            ]
                                                                                                                        }
                                                                                                                    ]
                                                                                                                }
                                                                                                            ]
                                                                                                        },
                                                                                                        {
                                                                                                            "type": "comparison_operator",
                                                                                                            "label": "b.block_type == BlockType.INPUT",
                                                                                                            "start_token": 1017,
                                                                                                            "end_token": 1024,
                                                                                                            "children": [
                                                                                                                {
                                                                                                                    "type": "attribute",
                                                                                                                    "label": "b.block_type",
                                                                                                                    "start_token": 1017,
                                                                                                                    "end_token": 1019,
                                                                                                                    "children": [
                                                                                                                        {
                                                                                                                            "type": "identifier",
                                                                                                                            "label": "b",
                                                                                                                            "start_token": 1017,
                                                                                                                            "end_token": 1017,
                                                                                                                            "children": []
                                                                                                                        },
                                                                                                                        {
                                                                                                                            "type": "identifier",
                                                                                                                            "label": "block_type",
                                                                                                                            "start_token": 1019,
                                                                                                                            "end_token": 1019,
                                                                                                                            "children": []
                                                                                                                        }
                                                                                                                    ]
                                                                                                                },
                                                                                                                {
                                                                                                                    "type": "attribute",
                                                                                                                    "label": "BlockType.INPUT",
                                                                                                                    "start_token": 1022,
                                                                                                                    "end_token": 1024,
                                                                                                                    "children": [
                                                                                                                        {
                                                                                                                            "type": "identifier",
                                                                                                                            "label": "BlockType",
                                                                                                                            "start_token": 1022,
                                                                                                                            "end_token": 1022,
                                                                                                                            "children": []
                                                                                                                        },
                                                                                                                        {
                                                                                                                            "type": "identifier",
                                                                                                                            "label": "INPUT",
                                                                                                                            "start_token": 1024,
                                                                                                                            "end_token": 1024,
                                                                                                                            "children": []
                                                                                                                        }
                                                                                                                    ]
                                                                                                                }
                                                                                                            ]
                                                                                                        }
                                                                                                    ]
                                                                                                },
                                                                                                {
                                                                                                    "type": "comparison_operator",
                                                                                                    "label": "\"name\" in node.input_default",
                                                                                                    "start_token": 1027,
                                                                                                    "end_token": 1031,
                                                                                                    "children": [
                                                                                                        {
                                                                                                            "type": "string",
                                                                                                            "label": "\"name\"",
                                                                                                            "start_token": 1027,
                                                                                                            "end_token": 1027,
                                                                                                            "children": [
                                                                                                                {
                                                                                                                    "type": "string_start",
                                                                                                                    "label": "\"",
                                                                                                                    "start_token": 1027,
                                                                                                                    "end_token": 1027,
                                                                                                                    "children": []
                                                                                                                },
                                                                                                                {
                                                                                                                    "type": "string_content",
                                                                                                                    "label": "name",
                                                                                                                    "start_token": 1027,
                                                                                                                    "end_token": 1027,
                                                                                                                    "children": []
                                                                                                                },
                                                                                                                {
                                                                                                                    "type": "string_end",
                                                                                                                    "label": "\"",
                                                                                                                    "start_token": 1027,
                                                                                                                    "end_token": 1027,
                                                                                                                    "children": []
                                                                                                                }
                                                                                                            ]
                                                                                                        },
                                                                                                        {
                                                                                                            "type": "attribute",
                                                                                                            "label": "node.input_default",
                                                                                                            "start_token": 1029,
                                                                                                            "end_token": 1031,
                                                                                                            "children": [
                                                                                                                {
                                                                                                                    "type": "identifier",
                                                                                                                    "label": "node",
                                                                                                                    "start_token": 1029,
                                                                                                                    "end_token": 1029,
                                                                                                                    "children": []
                                                                                                                },
                                                                                                                {
                                                                                                                    "type": "identifier",
                                                                                                                    "label": "input_default",
                                                                                                                    "start_token": 1031,
                                                                                                                    "end_token": 1031,
                                                                                                                    "children": []
                                                                                                                }
                                                                                                            ]
                                                                                                        }
                                                                                                    ]
                                                                                                }
                                                                                            ]
                                                                                        }
                                                                                    ]
                                                                                }
                                                                            ]
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                }
                                            ]
                                        }
                                    ]
                                }
                            ]
                        },
                        {
                            "type": "decorated_definition",
                            "label": "@computed_field\n    @property\n    def output_schema(self) -> dict[str, Any]:\n        return self._generate_schema(\n            AgentOutputBlock.Input,\n            [\n                node.input_default\n                for node in self.nodes\n                if (b := get_block(node.block_id))\n                and b.block_type == BlockType.OUTPUT\n                and \"name\" in node.input_default\n            ],\n        )",
                            "start_token": 1039,
                            "end_token": 1117,
                            "children": [
                                {
                                    "type": "decorator",
                                    "label": "@computed_field",
                                    "start_token": 1039,
                                    "end_token": 1040,
                                    "children": [
                                        {
                                            "type": "identifier",
                                            "label": "computed_field",
                                            "start_token": 1040,
                                            "end_token": 1040,
                                            "children": []
                                        }
                                    ]
                                },
                                {
                                    "type": "decorator",
                                    "label": "@property",
                                    "start_token": 1042,
                                    "end_token": 1043,
                                    "children": [
                                        {
                                            "type": "identifier",
                                            "label": "property",
                                            "start_token": 1043,
                                            "end_token": 1043,
                                            "children": []
                                        }
                                    ]
                                },
                                {
                                    "type": "function_definition",
                                    "label": "def output_schema(self) -> dict[str, Any]:\n        return self._generate_schema(\n            AgentOutputBlock.Input,\n            [\n                node.input_default\n                for node in self.nodes\n                if (b := get_block(node.block_id))\n                and b.block_type == BlockType.OUTPUT\n                and \"name\" in node.input_default\n            ],\n        )",
                                    "start_token": 1045,
                                    "end_token": 1117,
                                    "children": [
                                        {
                                            "type": "identifier",
                                            "label": "output_schema",
                                            "start_token": 1046,
                                            "end_token": 1046,
                                            "children": []
                                        },
                                        {
                                            "type": "parameters",
                                            "label": "(self)",
                                            "start_token": 1047,
                                            "end_token": 1049,
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "label": "self",
                                                    "start_token": 1048,
                                                    "end_token": 1048,
                                                    "children": []
                                                }
                                            ]
                                        },
                                        {
                                            "type": "type",
                                            "label": "dict[str, Any]",
                                            "start_token": 1052,
                                            "end_token": 1057,
                                            "children": [
                                                {
                                                    "type": "generic_type",
                                                    "label": "dict[str, Any]",
                                                    "start_token": 1052,
                                                    "end_token": 1057,
                                                    "children": [
                                                        {
                                                            "type": "identifier",
                                                            "label": "dict",
                                                            "start_token": 1052,
                                                            "end_token": 1052,
                                                            "children": []
                                                        },
                                                        {
                                                            "type": "type_parameter",
                                                            "label": "[str, Any]",
                                                            "start_token": 1053,
                                                            "end_token": 1057,
                                                            "children": [
                                                                {
                                                                    "type": "type",
                                                                    "label": "str",
                                                                    "start_token": 1054,
                                                                    "end_token": 1054,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "str",
                                                                            "start_token": 1054,
                                                                            "end_token": 1054,
                                                                            "children": []
                                                                        }
                                                                    ]
                                                                },
                                                                {
                                                                    "type": "type",
                                                                    "label": "Any",
                                                                    "start_token": 1056,
                                                                    "end_token": 1056,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "Any",
                                                                            "start_token": 1056,
                                                                            "end_token": 1056,
                                                                            "children": []
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                }
                                            ]
                                        },
                                        {
                                            "type": "block",
                                            "label": "return self._generate_schema(\n            AgentOutputBlock.Input,\n            [\n                node.input_default\n                for node in self.nodes\n                if (b := get_block(node.block_id))\n                and b.block_type == BlockType.OUTPUT\n                and \"name\" in node.input_default\n            ],\n        )",
                                            "start_token": 1060,
                                            "end_token": 1117,
                                            "children": [
                                                {
                                                    "type": "return_statement",
                                                    "label": "return self._generate_schema(\n            AgentOutputBlock.Input,\n            [\n                node.input_default\n                for node in self.nodes\n                if (b := get_block(node.block_id))\n                and b.block_type == BlockType.OUTPUT\n                and \"name\" in node.input_default\n            ],\n        )",
                                                    "start_token": 1060,
                                                    "end_token": 1117,
                                                    "children": [
                                                        {
                                                            "type": "call",
                                                            "label": "self._generate_schema(\n            AgentOutputBlock.Input,\n            [\n                node.input_default\n                for node in self.nodes\n                if (b := get_block(node.block_id))\n                and b.block_type == BlockType.OUTPUT\n                and \"name\" in node.input_default\n            ],\n        )",
                                                            "start_token": 1061,
                                                            "end_token": 1117,
                                                            "children": [
                                                                {
                                                                    "type": "attribute",
                                                                    "label": "self._generate_schema",
                                                                    "start_token": 1061,
                                                                    "end_token": 1063,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "self",
                                                                            "start_token": 1061,
                                                                            "end_token": 1061,
                                                                            "children": []
                                                                        },
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "_generate_schema",
                                                                            "start_token": 1063,
                                                                            "end_token": 1063,
                                                                            "children": []
                                                                        }
                                                                    ]
                                                                },
                                                                {
                                                                    "type": "argument_list",
                                                                    "label": "(\n            AgentOutputBlock.Input,\n            [\n                node.input_default\n                for node in self.nodes\n                if (b := get_block(node.block_id))\n                and b.block_type == BlockType.OUTPUT\n                and \"name\" in node.input_default\n            ],\n        )",
                                                                    "start_token": 1064,
                                                                    "end_token": 1117,
                                                                    "children": [
                                                                        {
                                                                            "type": "attribute",
                                                                            "label": "AgentOutputBlock.Input",
                                                                            "start_token": 1066,
                                                                            "end_token": 1068,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "AgentOutputBlock",
                                                                                    "start_token": 1066,
                                                                                    "end_token": 1066,
                                                                                    "children": []
                                                                                },
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "Input",
                                                                                    "start_token": 1068,
                                                                                    "end_token": 1068,
                                                                                    "children": []
                                                                                }
                                                                            ]
                                                                        },
                                                                        {
                                                                            "type": "list_comprehension",
                                                                            "label": "[\n                node.input_default\n                for node in self.nodes\n                if (b := get_block(node.block_id))\n                and b.block_type == BlockType.OUTPUT\n                and \"name\" in node.input_default\n            ]",
                                                                            "start_token": 1071,
                                                                            "end_token": 1114,
                                                                            "children": [
                                                                                {
                                                                                    "type": "attribute",
                                                                                    "label": "node.input_default",
                                                                                    "start_token": 1073,
                                                                                    "end_token": 1075,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "label": "node",
                                                                                            "start_token": 1073,
                                                                                            "end_token": 1073,
                                                                                            "children": []
                                                                                        },
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "label": "input_default",
                                                                                            "start_token": 1075,
                                                                                            "end_token": 1075,
                                                                                            "children": []
                                                                                        }
                                                                                    ]
                                                                                },
                                                                                {
                                                                                    "type": "for_in_clause",
                                                                                    "label": "for node in self.nodes",
                                                                                    "start_token": 1077,
                                                                                    "end_token": 1082,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "label": "node",
                                                                                            "start_token": 1078,
                                                                                            "end_token": 1078,
                                                                                            "children": []
                                                                                        },
                                                                                        {
                                                                                            "type": "attribute",
                                                                                            "label": "self.nodes",
                                                                                            "start_token": 1080,
                                                                                            "end_token": 1082,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "label": "self",
                                                                                                    "start_token": 1080,
                                                                                                    "end_token": 1080,
                                                                                                    "children": []
                                                                                                },
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "label": "nodes",
                                                                                                    "start_token": 1082,
                                                                                                    "end_token": 1082,
                                                                                                    "children": []
                                                                                                }
                                                                                            ]
                                                                                        }
                                                                                    ]
                                                                                },
                                                                                {
                                                                                    "type": "if_clause",
                                                                                    "label": "if (b := get_block(node.block_id))\n                and b.block_type == BlockType.OUTPUT\n                and \"name\" in node.input_default",
                                                                                    "start_token": 1084,
                                                                                    "end_token": 1112,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "boolean_operator",
                                                                                            "label": "(b := get_block(node.block_id))\n                and b.block_type == BlockType.OUTPUT\n                and \"name\" in node.input_default",
                                                                                            "start_token": 1085,
                                                                                            "end_token": 1112,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "boolean_operator",
                                                                                                    "label": "(b := get_block(node.block_id))\n                and b.block_type == BlockType.OUTPUT",
                                                                                                    "start_token": 1085,
                                                                                                    "end_token": 1105,
                                                                                                    "children": [
                                                                                                        {
                                                                                                            "type": "parenthesized_expression",
                                                                                                            "label": "(b := get_block(node.block_id))",
                                                                                                            "start_token": 1085,
                                                                                                            "end_token": 1095,
                                                                                                            "children": [
                                                                                                                {
                                                                                                                    "type": "named_expression",
                                                                                                                    "label": "b := get_block(node.block_id)",
                                                                                                                    "start_token": 1086,
                                                                                                                    "end_token": 1094,
                                                                                                                    "children": [
                                                                                                                        {
                                                                                                                            "type": "identifier",
                                                                                                                            "label": "b",
                                                                                                                            "start_token": 1086,
                                                                                                                            "end_token": 1086,
                                                                                                                            "children": []
                                                                                                                        },
                                                                                                                        {
                                                                                                                            "type": "call",
                                                                                                                            "label": "get_block(node.block_id)",
                                                                                                                            "start_token": 1089,
                                                                                                                            "end_token": 1094,
                                                                                                                            "children": [
                                                                                                                                {
                                                                                                                                    "type": "identifier",
                                                                                                                                    "label": "get_block",
                                                                                                                                    "start_token": 1089,
                                                                                                                                    "end_token": 1089,
                                                                                                                                    "children": []
                                                                                                                                },
                                                                                                                                {
                                                                                                                                    "type": "argument_list",
                                                                                                                                    "label": "(node.block_id)",
                                                                                                                                    "start_token": 1090,
                                                                                                                                    "end_token": 1094,
                                                                                                                                    "children": [
                                                                                                                                        {
                                                                                                                                            "type": "attribute",
                                                                                                                                            "label": "node.block_id",
                                                                                                                                            "start_token": 1091,
                                                                                                                                            "end_token": 1093,
                                                                                                                                            "children": [
                                                                                                                                                {
                                                                                                                                                    "type": "identifier",
                                                                                                                                                    "label": "node",
                                                                                                                                                    "start_token": 1091,
                                                                                                                                                    "end_token": 1091,
                                                                                                                                                    "children": []
                                                                                                                                                },
                                                                                                                                                {
                                                                                                                                                    "type": "identifier",
                                                                                                                                                    "label": "block_id",
                                                                                                                                                    "start_token": 1093,
                                                                                                                                                    "end_token": 1093,
                                                                                                                                                    "children": []
                                                                                                                                                }
                                                                                                                                            ]
                                                                                                                                        }
                                                                                                                                    ]
                                                                                                                                }
                                                                                                                            ]
                                                                                                                        }
                                                                                                                    ]
                                                                                                                }
                                                                                                            ]
                                                                                                        },
                                                                                                        {
                                                                                                            "type": "comparison_operator",
                                                                                                            "label": "b.block_type == BlockType.OUTPUT",
                                                                                                            "start_token": 1098,
                                                                                                            "end_token": 1105,
                                                                                                            "children": [
                                                                                                                {
                                                                                                                    "type": "attribute",
                                                                                                                    "label": "b.block_type",
                                                                                                                    "start_token": 1098,
                                                                                                                    "end_token": 1100,
                                                                                                                    "children": [
                                                                                                                        {
                                                                                                                            "type": "identifier",
                                                                                                                            "label": "b",
                                                                                                                            "start_token": 1098,
                                                                                                                            "end_token": 1098,
                                                                                                                            "children": []
                                                                                                                        },
                                                                                                                        {
                                                                                                                            "type": "identifier",
                                                                                                                            "label": "block_type",
                                                                                                                            "start_token": 1100,
                                                                                                                            "end_token": 1100,
                                                                                                                            "children": []
                                                                                                                        }
                                                                                                                    ]
                                                                                                                },
                                                                                                                {
                                                                                                                    "type": "attribute",
                                                                                                                    "label": "BlockType.OUTPUT",
                                                                                                                    "start_token": 1103,
                                                                                                                    "end_token": 1105,
                                                                                                                    "children": [
                                                                                                                        {
                                                                                                                            "type": "identifier",
                                                                                                                            "label": "BlockType",
                                                                                                                            "start_token": 1103,
                                                                                                                            "end_token": 1103,
                                                                                                                            "children": []
                                                                                                                        },
                                                                                                                        {
                                                                                                                            "type": "identifier",
                                                                                                                            "label": "OUTPUT",
                                                                                                                            "start_token": 1105,
                                                                                                                            "end_token": 1105,
                                                                                                                            "children": []
                                                                                                                        }
                                                                                                                    ]
                                                                                                                }
                                                                                                            ]
                                                                                                        }
                                                                                                    ]
                                                                                                },
                                                                                                {
                                                                                                    "type": "comparison_operator",
                                                                                                    "label": "\"name\" in node.input_default",
                                                                                                    "start_token": 1108,
                                                                                                    "end_token": 1112,
                                                                                                    "children": [
                                                                                                        {
                                                                                                            "type": "string",
                                                                                                            "label": "\"name\"",
                                                                                                            "start_token": 1108,
                                                                                                            "end_token": 1108,
                                                                                                            "children": [
                                                                                                                {
                                                                                                                    "type": "string_start",
                                                                                                                    "label": "\"",
                                                                                                                    "start_token": 1108,
                                                                                                                    "end_token": 1108,
                                                                                                                    "children": []
                                                                                                                },
                                                                                                                {
                                                                                                                    "type": "string_content",
                                                                                                                    "label": "name",
                                                                                                                    "start_token": 1108,
                                                                                                                    "end_token": 1108,
                                                                                                                    "children": []
                                                                                                                },
                                                                                                                {
                                                                                                                    "type": "string_end",
                                                                                                                    "label": "\"",
                                                                                                                    "start_token": 1108,
                                                                                                                    "end_token": 1108,
                                                                                                                    "children": []
                                                                                                                }
                                                                                                            ]
                                                                                                        },
                                                                                                        {
                                                                                                            "type": "attribute",
                                                                                                            "label": "node.input_default",
                                                                                                            "start_token": 1110,
                                                                                                            "end_token": 1112,
                                                                                                            "children": [
                                                                                                                {
                                                                                                                    "type": "identifier",
                                                                                                                    "label": "node",
                                                                                                                    "start_token": 1110,
                                                                                                                    "end_token": 1110,
                                                                                                                    "children": []
                                                                                                                },
                                                                                                                {
                                                                                                                    "type": "identifier",
                                                                                                                    "label": "input_default",
                                                                                                                    "start_token": 1112,
                                                                                                                    "end_token": 1112,
                                                                                                                    "children": []
                                                                                                                }
                                                                                                            ]
                                                                                                        }
                                                                                                    ]
                                                                                                }
                                                                                            ]
                                                                                        }
                                                                                    ]
                                                                                }
                                                                            ]
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                }
                                            ]
                                        }
                                    ]
                                }
                            ]
                        },
                        {
                            "type": "decorated_definition",
                            "label": "@staticmethod\n    def _generate_schema(\n        type_class: Type[AgentInputBlock.Input] | Type[AgentOutputBlock.Input],\n        data: list[dict],\n    ) -> dict[str, Any]:\n        props = []\n        for p in data:\n            try:\n                props.append(type_class(**p))\n            except Exception as e:\n                logger.warning(f\"Invalid {type_class}: {p}, {e}\")\n\n        return {\n            \"type\": \"object\",\n            \"properties\": {\n                p.name: {\n                    \"secret\": p.secret,\n                    \"advanced\": p.advanced,\n                    \"title\": p.title or p.name,\n                    **({\"description\": p.description} if p.description else {}),\n                    **({\"default\": p.value} if p.value is not None else {}),\n                }\n                for p in props\n            },\n            \"required\": [p.name for p in props if p.value is None],\n        }",
                            "start_token": 1120,
                            "end_token": 1319,
                            "children": [
                                {
                                    "type": "decorator",
                                    "label": "@staticmethod",
                                    "start_token": 1120,
                                    "end_token": 1121,
                                    "children": [
                                        {
                                            "type": "identifier",
                                            "label": "staticmethod",
                                            "start_token": 1121,
                                            "end_token": 1121,
                                            "children": []
                                        }
                                    ]
                                },
                                {
                                    "type": "function_definition",
                                    "label": "def _generate_schema(\n        type_class: Type[AgentInputBlock.Input] | Type[AgentOutputBlock.Input],\n        data: list[dict],\n    ) -> dict[str, Any]:\n        props = []\n        for p in data:\n            try:\n                props.append(type_class(**p))\n            except Exception as e:\n                logger.warning(f\"Invalid {type_class}: {p}, {e}\")\n\n        return {\n            \"type\": \"object\",\n            \"properties\": {\n                p.name: {\n                    \"secret\": p.secret,\n                    \"advanced\": p.advanced,\n                    \"title\": p.title or p.name,\n                    **({\"description\": p.description} if p.description else {}),\n                    **({\"default\": p.value} if p.value is not None else {}),\n                }\n                for p in props\n            },\n            \"required\": [p.name for p in props if p.value is None],\n        }",
                                    "start_token": 1123,
                                    "end_token": 1319,
                                    "children": [
                                        {
                                            "type": "identifier",
                                            "label": "_generate_schema",
                                            "start_token": 1124,
                                            "end_token": 1124,
                                            "children": []
                                        },
                                        {
                                            "type": "parameters",
                                            "label": "(\n        type_class: Type[AgentInputBlock.Input] | Type[AgentOutputBlock.Input],\n        data: list[dict],\n    )",
                                            "start_token": 1125,
                                            "end_token": 1152,
                                            "children": [
                                                {
                                                    "type": "typed_parameter",
                                                    "label": "type_class: Type[AgentInputBlock.Input] | Type[AgentOutputBlock.Input]",
                                                    "start_token": 1127,
                                                    "end_token": 1141,
                                                    "children": [
                                                        {
                                                            "type": "identifier",
                                                            "label": "type_class",
                                                            "start_token": 1127,
                                                            "end_token": 1127,
                                                            "children": []
                                                        },
                                                        {
                                                            "type": "type",
                                                            "label": "Type[AgentInputBlock.Input] | Type[AgentOutputBlock.Input]",
                                                            "start_token": 1129,
                                                            "end_token": 1141,
                                                            "children": [
                                                                {
                                                                    "type": "union_type",
                                                                    "label": "Type[AgentInputBlock.Input] | Type[AgentOutputBlock.Input]",
                                                                    "start_token": 1129,
                                                                    "end_token": 1141,
                                                                    "children": [
                                                                        {
                                                                            "type": "type",
                                                                            "label": "Type[AgentInputBlock.Input]",
                                                                            "start_token": 1129,
                                                                            "end_token": 1134,
                                                                            "children": [
                                                                                {
                                                                                    "type": "generic_type",
                                                                                    "label": "Type[AgentInputBlock.Input]",
                                                                                    "start_token": 1129,
                                                                                    "end_token": 1134,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "label": "Type",
                                                                                            "start_token": 1129,
                                                                                            "end_token": 1129,
                                                                                            "children": []
                                                                                        },
                                                                                        {
                                                                                            "type": "type_parameter",
                                                                                            "label": "[AgentInputBlock.Input]",
                                                                                            "start_token": 1130,
                                                                                            "end_token": 1134,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "type",
                                                                                                    "label": "AgentInputBlock.Input",
                                                                                                    "start_token": 1131,
                                                                                                    "end_token": 1133,
                                                                                                    "children": [
                                                                                                        {
                                                                                                            "type": "attribute",
                                                                                                            "label": "AgentInputBlock.Input",
                                                                                                            "start_token": 1131,
                                                                                                            "end_token": 1133,
                                                                                                            "children": [
                                                                                                                {
                                                                                                                    "type": "identifier",
                                                                                                                    "label": "AgentInputBlock",
                                                                                                                    "start_token": 1131,
                                                                                                                    "end_token": 1131,
                                                                                                                    "children": []
                                                                                                                },
                                                                                                                {
                                                                                                                    "type": "identifier",
                                                                                                                    "label": "Input",
                                                                                                                    "start_token": 1133,
                                                                                                                    "end_token": 1133,
                                                                                                                    "children": []
                                                                                                                }
                                                                                                            ]
                                                                                                        }
                                                                                                    ]
                                                                                                }
                                                                                            ]
                                                                                        }
                                                                                    ]
                                                                                }
                                                                            ]
                                                                        },
                                                                        {
                                                                            "type": "type",
                                                                            "label": "Type[AgentOutputBlock.Input]",
                                                                            "start_token": 1136,
                                                                            "end_token": 1141,
                                                                            "children": [
                                                                                {
                                                                                    "type": "generic_type",
                                                                                    "label": "Type[AgentOutputBlock.Input]",
                                                                                    "start_token": 1136,
                                                                                    "end_token": 1141,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "label": "Type",
                                                                                            "start_token": 1136,
                                                                                            "end_token": 1136,
                                                                                            "children": []
                                                                                        },
                                                                                        {
                                                                                            "type": "type_parameter",
                                                                                            "label": "[AgentOutputBlock.Input]",
                                                                                            "start_token": 1137,
                                                                                            "end_token": 1141,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "type",
                                                                                                    "label": "AgentOutputBlock.Input",
                                                                                                    "start_token": 1138,
                                                                                                    "end_token": 1140,
                                                                                                    "children": [
                                                                                                        {
                                                                                                            "type": "attribute",
                                                                                                            "label": "AgentOutputBlock.Input",
                                                                                                            "start_token": 1138,
                                                                                                            "end_token": 1140,
                                                                                                            "children": [
                                                                                                                {
                                                                                                                    "type": "identifier",
                                                                                                                    "label": "AgentOutputBlock",
                                                                                                                    "start_token": 1138,
                                                                                                                    "end_token": 1138,
                                                                                                                    "children": []
                                                                                                                },
                                                                                                                {
                                                                                                                    "type": "identifier",
                                                                                                                    "label": "Input",
                                                                                                                    "start_token": 1140,
                                                                                                                    "end_token": 1140,
                                                                                                                    "children": []
                                                                                                                }
                                                                                                            ]
                                                                                                        }
                                                                                                    ]
                                                                                                }
                                                                                            ]
                                                                                        }
                                                                                    ]
                                                                                }
                                                                            ]
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                },
                                                {
                                                    "type": "typed_parameter",
                                                    "label": "data: list[dict]",
                                                    "start_token": 1144,
                                                    "end_token": 1149,
                                                    "children": [
                                                        {
                                                            "type": "identifier",
                                                            "label": "data",
                                                            "start_token": 1144,
                                                            "end_token": 1144,
                                                            "children": []
                                                        },
                                                        {
                                                            "type": "type",
                                                            "label": "list[dict]",
                                                            "start_token": 1146,
                                                            "end_token": 1149,
                                                            "children": [
                                                                {
                                                                    "type": "generic_type",
                                                                    "label": "list[dict]",
                                                                    "start_token": 1146,
                                                                    "end_token": 1149,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "list",
                                                                            "start_token": 1146,
                                                                            "end_token": 1146,
                                                                            "children": []
                                                                        },
                                                                        {
                                                                            "type": "type_parameter",
                                                                            "label": "[dict]",
                                                                            "start_token": 1147,
                                                                            "end_token": 1149,
                                                                            "children": [
                                                                                {
                                                                                    "type": "type",
                                                                                    "label": "dict",
                                                                                    "start_token": 1148,
                                                                                    "end_token": 1148,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "label": "dict",
                                                                                            "start_token": 1148,
                                                                                            "end_token": 1148,
                                                                                            "children": []
                                                                                        }
                                                                                    ]
                                                                                }
                                                                            ]
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                }
                                            ]
                                        },
                                        {
                                            "type": "type",
                                            "label": "dict[str, Any]",
                                            "start_token": 1155,
                                            "end_token": 1160,
                                            "children": [
                                                {
                                                    "type": "generic_type",
                                                    "label": "dict[str, Any]",
                                                    "start_token": 1155,
                                                    "end_token": 1160,
                                                    "children": [
                                                        {
                                                            "type": "identifier",
                                                            "label": "dict",
                                                            "start_token": 1155,
                                                            "end_token": 1155,
                                                            "children": []
                                                        },
                                                        {
                                                            "type": "type_parameter",
                                                            "label": "[str, Any]",
                                                            "start_token": 1156,
                                                            "end_token": 1160,
                                                            "children": [
                                                                {
                                                                    "type": "type",
                                                                    "label": "str",
                                                                    "start_token": 1157,
                                                                    "end_token": 1157,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "str",
                                                                            "start_token": 1157,
                                                                            "end_token": 1157,
                                                                            "children": []
                                                                        }
                                                                    ]
                                                                },
                                                                {
                                                                    "type": "type",
                                                                    "label": "Any",
                                                                    "start_token": 1159,
                                                                    "end_token": 1159,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "Any",
                                                                            "start_token": 1159,
                                                                            "end_token": 1159,
                                                                            "children": []
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                }
                                            ]
                                        },
                                        {
                                            "type": "block",
                                            "label": "props = []\n        for p in data:\n            try:\n                props.append(type_class(**p))\n            except Exception as e:\n                logger.warning(f\"Invalid {type_class}: {p}, {e}\")\n\n        return {\n            \"type\": \"object\",\n            \"properties\": {\n                p.name: {\n                    \"secret\": p.secret,\n                    \"advanced\": p.advanced,\n                    \"title\": p.title or p.name,\n                    **({\"description\": p.description} if p.description else {}),\n                    **({\"default\": p.value} if p.value is not None else {}),\n                }\n                for p in props\n            },\n            \"required\": [p.name for p in props if p.value is None],\n        }",
                                            "start_token": 1163,
                                            "end_token": 1319,
                                            "children": [
                                                {
                                                    "type": "expression_statement",
                                                    "label": "props = []",
                                                    "start_token": 1163,
                                                    "end_token": 1166,
                                                    "children": [
                                                        {
                                                            "type": "assignment",
                                                            "label": "props = []",
                                                            "start_token": 1163,
                                                            "end_token": 1166,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "label": "props",
                                                                    "start_token": 1163,
                                                                    "end_token": 1163,
                                                                    "children": []
                                                                },
                                                                {
                                                                    "type": "list",
                                                                    "label": "[]",
                                                                    "start_token": 1165,
                                                                    "end_token": 1166,
                                                                    "children": []
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                },
                                                {
                                                    "type": "for_statement",
                                                    "label": "for p in data:\n            try:\n                props.append(type_class(**p))\n            except Exception as e:\n                logger.warning(f\"Invalid {type_class}: {p}, {e}\")",
                                                    "start_token": 1168,
                                                    "end_token": 1201,
                                                    "children": [
                                                        {
                                                            "type": "identifier",
                                                            "label": "p",
                                                            "start_token": 1169,
                                                            "end_token": 1169,
                                                            "children": []
                                                        },
                                                        {
                                                            "type": "identifier",
                                                            "label": "data",
                                                            "start_token": 1171,
                                                            "end_token": 1171,
                                                            "children": []
                                                        },
                                                        {
                                                            "type": "block",
                                                            "label": "try:\n                props.append(type_class(**p))\n            except Exception as e:\n                logger.warning(f\"Invalid {type_class}: {p}, {e}\")",
                                                            "start_token": 1174,
                                                            "end_token": 1201,
                                                            "children": [
                                                                {
                                                                    "type": "try_statement",
                                                                    "label": "try:\n                props.append(type_class(**p))\n            except Exception as e:\n                logger.warning(f\"Invalid {type_class}: {p}, {e}\")",
                                                                    "start_token": 1174,
                                                                    "end_token": 1201,
                                                                    "children": [
                                                                        {
                                                                            "type": "block",
                                                                            "label": "props.append(type_class(**p))",
                                                                            "start_token": 1177,
                                                                            "end_token": 1187,
                                                                            "children": [
                                                                                {
                                                                                    "type": "expression_statement",
                                                                                    "label": "props.append(type_class(**p))",
                                                                                    "start_token": 1177,
                                                                                    "end_token": 1187,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "call",
                                                                                            "label": "props.append(type_class(**p))",
                                                                                            "start_token": 1177,
                                                                                            "end_token": 1187,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "attribute",
                                                                                                    "label": "props.append",
                                                                                                    "start_token": 1177,
                                                                                                    "end_token": 1179,
                                                                                                    "children": [
                                                                                                        {
                                                                                                            "type": "identifier",
                                                                                                            "label": "props",
                                                                                                            "start_token": 1177,
                                                                                                            "end_token": 1177,
                                                                                                            "children": []
                                                                                                        },
                                                                                                        {
                                                                                                            "type": "identifier",
                                                                                                            "label": "append",
                                                                                                            "start_token": 1179,
                                                                                                            "end_token": 1179,
                                                                                                            "children": []
                                                                                                        }
                                                                                                    ]
                                                                                                },
                                                                                                {
                                                                                                    "type": "argument_list",
                                                                                                    "label": "(type_class(**p))",
                                                                                                    "start_token": 1180,
                                                                                                    "end_token": 1187,
                                                                                                    "children": [
                                                                                                        {
                                                                                                            "type": "call",
                                                                                                            "label": "type_class(**p)",
                                                                                                            "start_token": 1181,
                                                                                                            "end_token": 1186,
                                                                                                            "children": [
                                                                                                                {
                                                                                                                    "type": "identifier",
                                                                                                                    "label": "type_class",
                                                                                                                    "start_token": 1181,
                                                                                                                    "end_token": 1181,
                                                                                                                    "children": []
                                                                                                                },
                                                                                                                {
                                                                                                                    "type": "argument_list",
                                                                                                                    "label": "(**p)",
                                                                                                                    "start_token": 1182,
                                                                                                                    "end_token": 1186,
                                                                                                                    "children": [
                                                                                                                        {
                                                                                                                            "type": "dictionary_splat",
                                                                                                                            "label": "**p",
                                                                                                                            "start_token": 1183,
                                                                                                                            "end_token": 1185,
                                                                                                                            "children": [
                                                                                                                                {
                                                                                                                                    "type": "identifier",
                                                                                                                                    "label": "p",
                                                                                                                                    "start_token": 1185,
                                                                                                                                    "end_token": 1185,
                                                                                                                                    "children": []
                                                                                                                                }
                                                                                                                            ]
                                                                                                                        }
                                                                                                                    ]
                                                                                                                }
                                                                                                            ]
                                                                                                        }
                                                                                                    ]
                                                                                                }
                                                                                            ]
                                                                                        }
                                                                                    ]
                                                                                }
                                                                            ]
                                                                        },
                                                                        {
                                                                            "type": "except_clause",
                                                                            "label": "except Exception as e:\n                logger.warning(f\"Invalid {type_class}: {p}, {e}\")",
                                                                            "start_token": 1189,
                                                                            "end_token": 1201,
                                                                            "children": [
                                                                                {
                                                                                    "type": "as_pattern",
                                                                                    "label": "Exception as e",
                                                                                    "start_token": 1190,
                                                                                    "end_token": 1192,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "label": "Exception",
                                                                                            "start_token": 1190,
                                                                                            "end_token": 1190,
                                                                                            "children": []
                                                                                        },
                                                                                        {
                                                                                            "type": "as_pattern_target",
                                                                                            "label": "e",
                                                                                            "start_token": 1192,
                                                                                            "end_token": 1192,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "label": "e",
                                                                                                    "start_token": 1192,
                                                                                                    "end_token": 1192,
                                                                                                    "children": []
                                                                                                }
                                                                                            ]
                                                                                        }
                                                                                    ]
                                                                                },
                                                                                {
                                                                                    "type": "block",
                                                                                    "label": "logger.warning(f\"Invalid {type_class}: {p}, {e}\")",
                                                                                    "start_token": 1195,
                                                                                    "end_token": 1201,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "expression_statement",
                                                                                            "label": "logger.warning(f\"Invalid {type_class}: {p}, {e}\")",
                                                                                            "start_token": 1195,
                                                                                            "end_token": 1201,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "call",
                                                                                                    "label": "logger.warning(f\"Invalid {type_class}: {p}, {e}\")",
                                                                                                    "start_token": 1195,
                                                                                                    "end_token": 1201,
                                                                                                    "children": [
                                                                                                        {
                                                                                                            "type": "attribute",
                                                                                                            "label": "logger.warning",
                                                                                                            "start_token": 1195,
                                                                                                            "end_token": 1197,
                                                                                                            "children": [
                                                                                                                {
                                                                                                                    "type": "identifier",
                                                                                                                    "label": "logger",
                                                                                                                    "start_token": 1195,
                                                                                                                    "end_token": 1195,
                                                                                                                    "children": []
                                                                                                                },
                                                                                                                {
                                                                                                                    "type": "identifier",
                                                                                                                    "label": "warning",
                                                                                                                    "start_token": 1197,
                                                                                                                    "end_token": 1197,
                                                                                                                    "children": []
                                                                                                                }
                                                                                                            ]
                                                                                                        },
                                                                                                        {
                                                                                                            "type": "argument_list",
                                                                                                            "label": "(f\"Invalid {type_class}: {p}, {e}\")",
                                                                                                            "start_token": 1198,
                                                                                                            "end_token": 1201,
                                                                                                            "children": [
                                                                                                                {
                                                                                                                    "type": "string",
                                                                                                                    "label": "f\"Invalid {type_class}: {p}, {e}\"",
                                                                                                                    "start_token": 1199,
                                                                                                                    "end_token": 1200,
                                                                                                                    "children": [
                                                                                                                        {
                                                                                                                            "type": "string_start",
                                                                                                                            "label": "f\"",
                                                                                                                            "start_token": 1199,
                                                                                                                            "end_token": 1200,
                                                                                                                            "children": []
                                                                                                                        },
                                                                                                                        {
                                                                                                                            "type": "string_content",
                                                                                                                            "label": "Invalid ",
                                                                                                                            "start_token": 1200,
                                                                                                                            "end_token": 1200,
                                                                                                                            "children": []
                                                                                                                        },
                                                                                                                        {
                                                                                                                            "type": "interpolation",
                                                                                                                            "label": "{type_class}",
                                                                                                                            "start_token": 1200,
                                                                                                                            "end_token": 1200,
                                                                                                                            "children": [
                                                                                                                                {
                                                                                                                                    "type": "identifier",
                                                                                                                                    "label": "type_class",
                                                                                                                                    "start_token": 1200,
                                                                                                                                    "end_token": 1200,
                                                                                                                                    "children": []
                                                                                                                                }
                                                                                                                            ]
                                                                                                                        },
                                                                                                                        {
                                                                                                                            "type": "string_content",
                                                                                                                            "label": ": ",
                                                                                                                            "start_token": 1200,
                                                                                                                            "end_token": 1200,
                                                                                                                            "children": []
                                                                                                                        },
                                                                                                                        {
                                                                                                                            "type": "interpolation",
                                                                                                                            "label": "{p}",
                                                                                                                            "start_token": 1200,
                                                                                                                            "end_token": 1200,
                                                                                                                            "children": [
                                                                                                                                {
                                                                                                                                    "type": "identifier",
                                                                                                                                    "label": "p",
                                                                                                                                    "start_token": 1200,
                                                                                                                                    "end_token": 1200,
                                                                                                                                    "children": []
                                                                                                                                }
                                                                                                                            ]
                                                                                                                        },
                                                                                                                        {
                                                                                                                            "type": "string_content",
                                                                                                                            "label": ", ",
                                                                                                                            "start_token": 1200,
                                                                                                                            "end_token": 1200,
                                                                                                                            "children": []
                                                                                                                        },
                                                                                                                        {
                                                                                                                            "type": "interpolation",
                                                                                                                            "label": "{e}",
                                                                                                                            "start_token": 1200,
                                                                                                                            "end_token": 1200,
                                                                                                                            "children": [
                                                                                                                                {
                                                                                                                                    "type": "identifier",
                                                                                                                                    "label": "e",
                                                                                                                                    "start_token": 1200,
                                                                                                                                    "end_token": 1200,
                                                                                                                                    "children": []
                                                                                                                                }
                                                                                                                            ]
                                                                                                                        },
                                                                                                                        {
                                                                                                                            "type": "string_end",
                                                                                                                            "label": "\"",
                                                                                                                            "start_token": 1200,
                                                                                                                            "end_token": 1200,
                                                                                                                            "children": []
                                                                                                                        }
                                                                                                                    ]
                                                                                                                }
                                                                                                            ]
                                                                                                        }
                                                                                                    ]
                                                                                                }
                                                                                            ]
                                                                                        }
                                                                                    ]
                                                                                }
                                                                            ]
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                },
                                                {
                                                    "type": "return_statement",
                                                    "label": "return {\n            \"type\": \"object\",\n            \"properties\": {\n                p.name: {\n                    \"secret\": p.secret,\n                    \"advanced\": p.advanced,\n                    \"title\": p.title or p.name,\n                    **({\"description\": p.description} if p.description else {}),\n                    **({\"default\": p.value} if p.value is not None else {}),\n                }\n                for p in props\n            },\n            \"required\": [p.name for p in props if p.value is None],\n        }",
                                                    "start_token": 1204,
                                                    "end_token": 1319,
                                                    "children": [
                                                        {
                                                            "type": "dictionary",
                                                            "label": "{\n            \"type\": \"object\",\n            \"properties\": {\n                p.name: {\n                    \"secret\": p.secret,\n                    \"advanced\": p.advanced,\n                    \"title\": p.title or p.name,\n                    **({\"description\": p.description} if p.description else {}),\n                    **({\"default\": p.value} if p.value is not None else {}),\n                }\n                for p in props\n            },\n            \"required\": [p.name for p in props if p.value is None],\n        }",
                                                            "start_token": 1205,
                                                            "end_token": 1319,
                                                            "children": [
                                                                {
                                                                    "type": "pair",
                                                                    "label": "\"type\": \"object\"",
                                                                    "start_token": 1207,
                                                                    "end_token": 1209,
                                                                    "children": [
                                                                        {
                                                                            "type": "string",
                                                                            "label": "\"type\"",
                                                                            "start_token": 1207,
                                                                            "end_token": 1207,
                                                                            "children": [
                                                                                {
                                                                                    "type": "string_start",
                                                                                    "label": "\"",
                                                                                    "start_token": 1207,
                                                                                    "end_token": 1207,
                                                                                    "children": []
                                                                                },
                                                                                {
                                                                                    "type": "string_content",
                                                                                    "label": "type",
                                                                                    "start_token": 1207,
                                                                                    "end_token": 1207,
                                                                                    "children": []
                                                                                },
                                                                                {
                                                                                    "type": "string_end",
                                                                                    "label": "\"",
                                                                                    "start_token": 1207,
                                                                                    "end_token": 1207,
                                                                                    "children": []
                                                                                }
                                                                            ]
                                                                        },
                                                                        {
                                                                            "type": "string",
                                                                            "label": "\"object\"",
                                                                            "start_token": 1209,
                                                                            "end_token": 1209,
                                                                            "children": [
                                                                                {
                                                                                    "type": "string_start",
                                                                                    "label": "\"",
                                                                                    "start_token": 1209,
                                                                                    "end_token": 1209,
                                                                                    "children": []
                                                                                },
                                                                                {
                                                                                    "type": "string_content",
                                                                                    "label": "object",
                                                                                    "start_token": 1209,
                                                                                    "end_token": 1209,
                                                                                    "children": []
                                                                                },
                                                                                {
                                                                                    "type": "string_end",
                                                                                    "label": "\"",
                                                                                    "start_token": 1209,
                                                                                    "end_token": 1209,
                                                                                    "children": []
                                                                                }
                                                                            ]
                                                                        }
                                                                    ]
                                                                },
                                                                {
                                                                    "type": "pair",
                                                                    "label": "\"properties\": {\n                p.name: {\n                    \"secret\": p.secret,\n                    \"advanced\": p.advanced,\n                    \"title\": p.title or p.name,\n                    **({\"description\": p.description} if p.description else {}),\n                    **({\"default\": p.value} if p.value is not None else {}),\n                }\n                for p in props\n            }",
                                                                    "start_token": 1212,
                                                                    "end_token": 1297,
                                                                    "children": [
                                                                        {
                                                                            "type": "string",
                                                                            "label": "\"properties\"",
                                                                            "start_token": 1212,
                                                                            "end_token": 1212,
                                                                            "children": [
                                                                                {
                                                                                    "type": "string_start",
                                                                                    "label": "\"",
                                                                                    "start_token": 1212,
                                                                                    "end_token": 1212,
                                                                                    "children": []
                                                                                },
                                                                                {
                                                                                    "type": "string_content",
                                                                                    "label": "properties",
                                                                                    "start_token": 1212,
                                                                                    "end_token": 1212,
                                                                                    "children": []
                                                                                },
                                                                                {
                                                                                    "type": "string_end",
                                                                                    "label": "\"",
                                                                                    "start_token": 1212,
                                                                                    "end_token": 1212,
                                                                                    "children": []
                                                                                }
                                                                            ]
                                                                        },
                                                                        {
                                                                            "type": "dictionary_comprehension",
                                                                            "label": "{\n                p.name: {\n                    \"secret\": p.secret,\n                    \"advanced\": p.advanced,\n                    \"title\": p.title or p.name,\n                    **({\"description\": p.description} if p.description else {}),\n                    **({\"default\": p.value} if p.value is not None else {}),\n                }\n                for p in props\n            }",
                                                                            "start_token": 1214,
                                                                            "end_token": 1297,
                                                                            "children": [
                                                                                {
                                                                                    "type": "pair",
                                                                                    "label": "p.name: {\n                    \"secret\": p.secret,\n                    \"advanced\": p.advanced,\n                    \"title\": p.title or p.name,\n                    **({\"description\": p.description} if p.description else {}),\n                    **({\"default\": p.value} if p.value is not None else {}),\n                }",
                                                                                    "start_token": 1216,
                                                                                    "end_token": 1290,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "attribute",
                                                                                            "label": "p.name",
                                                                                            "start_token": 1216,
                                                                                            "end_token": 1218,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "label": "p",
                                                                                                    "start_token": 1216,
                                                                                                    "end_token": 1216,
                                                                                                    "children": []
                                                                                                },
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "label": "name",
                                                                                                    "start_token": 1218,
                                                                                                    "end_token": 1218,
                                                                                                    "children": []
                                                                                                }
                                                                                            ]
                                                                                        },
                                                                                        {
                                                                                            "type": "dictionary",
                                                                                            "label": "{\n                    \"secret\": p.secret,\n                    \"advanced\": p.advanced,\n                    \"title\": p.title or p.name,\n                    **({\"description\": p.description} if p.description else {}),\n                    **({\"default\": p.value} if p.value is not None else {}),\n                }",
                                                                                            "start_token": 1220,
                                                                                            "end_token": 1290,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "pair",
                                                                                                    "label": "\"secret\": p.secret",
                                                                                                    "start_token": 1222,
                                                                                                    "end_token": 1226,
                                                                                                    "children": [
                                                                                                        {
                                                                                                            "type": "string",
                                                                                                            "label": "\"secret\"",
                                                                                                            "start_token": 1222,
                                                                                                            "end_token": 1222,
                                                                                                            "children": [
                                                                                                                {
                                                                                                                    "type": "string_start",
                                                                                                                    "label": "\"",
                                                                                                                    "start_token": 1222,
                                                                                                                    "end_token": 1222,
                                                                                                                    "children": []
                                                                                                                },
                                                                                                                {
                                                                                                                    "type": "string_content",
                                                                                                                    "label": "secret",
                                                                                                                    "start_token": 1222,
                                                                                                                    "end_token": 1222,
                                                                                                                    "children": []
                                                                                                                },
                                                                                                                {
                                                                                                                    "type": "string_end",
                                                                                                                    "label": "\"",
                                                                                                                    "start_token": 1222,
                                                                                                                    "end_token": 1222,
                                                                                                                    "children": []
                                                                                                                }
                                                                                                            ]
                                                                                                        },
                                                                                                        {
                                                                                                            "type": "attribute",
                                                                                                            "label": "p.secret",
                                                                                                            "start_token": 1224,
                                                                                                            "end_token": 1226,
                                                                                                            "children": [
                                                                                                                {
                                                                                                                    "type": "identifier",
                                                                                                                    "label": "p",
                                                                                                                    "start_token": 1224,
                                                                                                                    "end_token": 1224,
                                                                                                                    "children": []
                                                                                                                },
                                                                                                                {
                                                                                                                    "type": "identifier",
                                                                                                                    "label": "secret",
                                                                                                                    "start_token": 1226,
                                                                                                                    "end_token": 1226,
                                                                                                                    "children": []
                                                                                                                }
                                                                                                            ]
                                                                                                        }
                                                                                                    ]
                                                                                                },
                                                                                                {
                                                                                                    "type": "pair",
                                                                                                    "label": "\"advanced\": p.advanced",
                                                                                                    "start_token": 1229,
                                                                                                    "end_token": 1233,
                                                                                                    "children": [
                                                                                                        {
                                                                                                            "type": "string",
                                                                                                            "label": "\"advanced\"",
                                                                                                            "start_token": 1229,
                                                                                                            "end_token": 1229,
                                                                                                            "children": [
                                                                                                                {
                                                                                                                    "type": "string_start",
                                                                                                                    "label": "\"",
                                                                                                                    "start_token": 1229,
                                                                                                                    "end_token": 1229,
                                                                                                                    "children": []
                                                                                                                },
                                                                                                                {
                                                                                                                    "type": "string_content",
                                                                                                                    "label": "advanced",
                                                                                                                    "start_token": 1229,
                                                                                                                    "end_token": 1229,
                                                                                                                    "children": []
                                                                                                                },
                                                                                                                {
                                                                                                                    "type": "string_end",
                                                                                                                    "label": "\"",
                                                                                                                    "start_token": 1229,
                                                                                                                    "end_token": 1229,
                                                                                                                    "children": []
                                                                                                                }
                                                                                                            ]
                                                                                                        },
                                                                                                        {
                                                                                                            "type": "attribute",
                                                                                                            "label": "p.advanced",
                                                                                                            "start_token": 1231,
                                                                                                            "end_token": 1233,
                                                                                                            "children": [
                                                                                                                {
                                                                                                                    "type": "identifier",
                                                                                                                    "label": "p",
                                                                                                                    "start_token": 1231,
                                                                                                                    "end_token": 1231,
                                                                                                                    "children": []
                                                                                                                },
                                                                                                                {
                                                                                                                    "type": "identifier",
                                                                                                                    "label": "advanced",
                                                                                                                    "start_token": 1233,
                                                                                                                    "end_token": 1233,
                                                                                                                    "children": []
                                                                                                                }
                                                                                                            ]
                                                                                                        }
                                                                                                    ]
                                                                                                },
                                                                                                {
                                                                                                    "type": "pair",
                                                                                                    "label": "\"title\": p.title or p.name",
                                                                                                    "start_token": 1236,
                                                                                                    "end_token": 1244,
                                                                                                    "children": [
                                                                                                        {
                                                                                                            "type": "string",
                                                                                                            "label": "\"title\"",
                                                                                                            "start_token": 1236,
                                                                                                            "end_token": 1236,
                                                                                                            "children": [
                                                                                                                {
                                                                                                                    "type": "string_start",
                                                                                                                    "label": "\"",
                                                                                                                    "start_token": 1236,
                                                                                                                    "end_token": 1236,
                                                                                                                    "children": []
                                                                                                                },
                                                                                                                {
                                                                                                                    "type": "string_content",
                                                                                                                    "label": "title",
                                                                                                                    "start_token": 1236,
                                                                                                                    "end_token": 1236,
                                                                                                                    "children": []
                                                                                                                },
                                                                                                                {
                                                                                                                    "type": "string_end",
                                                                                                                    "label": "\"",
                                                                                                                    "start_token": 1236,
                                                                                                                    "end_token": 1236,
                                                                                                                    "children": []
                                                                                                                }
                                                                                                            ]
                                                                                                        },
                                                                                                        {
                                                                                                            "type": "boolean_operator",
                                                                                                            "label": "p.title or p.name",
                                                                                                            "start_token": 1238,
                                                                                                            "end_token": 1244,
                                                                                                            "children": [
                                                                                                                {
                                                                                                                    "type": "attribute",
                                                                                                                    "label": "p.title",
                                                                                                                    "start_token": 1238,
                                                                                                                    "end_token": 1240,
                                                                                                                    "children": [
                                                                                                                        {
                                                                                                                            "type": "identifier",
                                                                                                                            "label": "p",
                                                                                                                            "start_token": 1238,
                                                                                                                            "end_token": 1238,
                                                                                                                            "children": []
                                                                                                                        },
                                                                                                                        {
                                                                                                                            "type": "identifier",
                                                                                                                            "label": "title",
                                                                                                                            "start_token": 1240,
                                                                                                                            "end_token": 1240,
                                                                                                                            "children": []
                                                                                                                        }
                                                                                                                    ]
                                                                                                                },
                                                                                                                {
                                                                                                                    "type": "attribute",
                                                                                                                    "label": "p.name",
                                                                                                                    "start_token": 1242,
                                                                                                                    "end_token": 1244,
                                                                                                                    "children": [
                                                                                                                        {
                                                                                                                            "type": "identifier",
                                                                                                                            "label": "p",
                                                                                                                            "start_token": 1242,
                                                                                                                            "end_token": 1242,
                                                                                                                            "children": []
                                                                                                                        },
                                                                                                                        {
                                                                                                                            "type": "identifier",
                                                                                                                            "label": "name",
                                                                                                                            "start_token": 1244,
                                                                                                                            "end_token": 1244,
                                                                                                                            "children": []
                                                                                                                        }
                                                                                                                    ]
                                                                                                                }
                                                                                                            ]
                                                                                                        }
                                                                                                    ]
                                                                                                },
                                                                                                {
                                                                                                    "type": "dictionary_splat",
                                                                                                    "label": "**({\"description\": p.description} if p.description else {})",
                                                                                                    "start_token": 1247,
                                                                                                    "end_token": 1264,
                                                                                                    "children": [
                                                                                                        {
                                                                                                            "type": "parenthesized_expression",
                                                                                                            "label": "({\"description\": p.description} if p.description else {})",
                                                                                                            "start_token": 1249,
                                                                                                            "end_token": 1264,
                                                                                                            "children": [
                                                                                                                {
                                                                                                                    "type": "conditional_expression",
                                                                                                                    "label": "{\"description\": p.description} if p.description else {}",
                                                                                                                    "start_token": 1250,
                                                                                                                    "end_token": 1263,
                                                                                                                    "children": [
                                                                                                                        {
                                                                                                                            "type": "dictionary",
                                                                                                                            "label": "{\"description\": p.description}",
                                                                                                                            "start_token": 1250,
                                                                                                                            "end_token": 1256,
                                                                                                                            "children": [
                                                                                                                                {
                                                                                                                                    "type": "pair",
                                                                                                                                    "label": "\"description\": p.description",
                                                                                                                                    "start_token": 1251,
                                                                                                                                    "end_token": 1255,
                                                                                                                                    "children": [
                                                                                                                                        {
                                                                                                                                            "type": "string",
                                                                                                                                            "label": "\"description\"",
                                                                                                                                            "start_token": 1251,
                                                                                                                                            "end_token": 1251,
                                                                                                                                            "children": [
                                                                                                                                                {
                                                                                                                                                    "type": "string_start",
                                                                                                                                                    "label": "\"",
                                                                                                                                                    "start_token": 1251,
                                                                                                                                                    "end_token": 1251,
                                                                                                                                                    "children": []
                                                                                                                                                },
                                                                                                                                                {
                                                                                                                                                    "type": "string_content",
                                                                                                                                                    "label": "description",
                                                                                                                                                    "start_token": 1251,
                                                                                                                                                    "end_token": 1251,
                                                                                                                                                    "children": []
                                                                                                                                                },
                                                                                                                                                {
                                                                                                                                                    "type": "string_end",
                                                                                                                                                    "label": "\"",
                                                                                                                                                    "start_token": 1251,
                                                                                                                                                    "end_token": 1251,
                                                                                                                                                    "children": []
                                                                                                                                                }
                                                                                                                                            ]
                                                                                                                                        },
                                                                                                                                        {
                                                                                                                                            "type": "attribute",
                                                                                                                                            "label": "p.description",
                                                                                                                                            "start_token": 1253,
                                                                                                                                            "end_token": 1255,
                                                                                                                                            "children": [
                                                                                                                                                {
                                                                                                                                                    "type": "identifier",
                                                                                                                                                    "label": "p",
                                                                                                                                                    "start_token": 1253,
                                                                                                                                                    "end_token": 1253,
                                                                                                                                                    "children": []
                                                                                                                                                },
                                                                                                                                                {
                                                                                                                                                    "type": "identifier",
                                                                                                                                                    "label": "description",
                                                                                                                                                    "start_token": 1255,
                                                                                                                                                    "end_token": 1255,
                                                                                                                                                    "children": []
                                                                                                                                                }
                                                                                                                                            ]
                                                                                                                                        }
                                                                                                                                    ]
                                                                                                                                }
                                                                                                                            ]
                                                                                                                        },
                                                                                                                        {
                                                                                                                            "type": "attribute",
                                                                                                                            "label": "p.description",
                                                                                                                            "start_token": 1258,
                                                                                                                            "end_token": 1260,
                                                                                                                            "children": [
                                                                                                                                {
                                                                                                                                    "type": "identifier",
                                                                                                                                    "label": "p",
                                                                                                                                    "start_token": 1258,
                                                                                                                                    "end_token": 1258,
                                                                                                                                    "children": []
                                                                                                                                },
                                                                                                                                {
                                                                                                                                    "type": "identifier",
                                                                                                                                    "label": "description",
                                                                                                                                    "start_token": 1260,
                                                                                                                                    "end_token": 1260,
                                                                                                                                    "children": []
                                                                                                                                }
                                                                                                                            ]
                                                                                                                        },
                                                                                                                        {
                                                                                                                            "type": "dictionary",
                                                                                                                            "label": "{}",
                                                                                                                            "start_token": 1262,
                                                                                                                            "end_token": 1263,
                                                                                                                            "children": []
                                                                                                                        }
                                                                                                                    ]
                                                                                                                }
                                                                                                            ]
                                                                                                        }
                                                                                                    ]
                                                                                                },
                                                                                                {
                                                                                                    "type": "dictionary_splat",
                                                                                                    "label": "**({\"default\": p.value} if p.value is not None else {})",
                                                                                                    "start_token": 1267,
                                                                                                    "end_token": 1287,
                                                                                                    "children": [
                                                                                                        {
                                                                                                            "type": "parenthesized_expression",
                                                                                                            "label": "({\"default\": p.value} if p.value is not None else {})",
                                                                                                            "start_token": 1269,
                                                                                                            "end_token": 1287,
                                                                                                            "children": [
                                                                                                                {
                                                                                                                    "type": "conditional_expression",
                                                                                                                    "label": "{\"default\": p.value} if p.value is not None else {}",
                                                                                                                    "start_token": 1270,
                                                                                                                    "end_token": 1286,
                                                                                                                    "children": [
                                                                                                                        {
                                                                                                                            "type": "dictionary",
                                                                                                                            "label": "{\"default\": p.value}",
                                                                                                                            "start_token": 1270,
                                                                                                                            "end_token": 1276,
                                                                                                                            "children": [
                                                                                                                                {
                                                                                                                                    "type": "pair",
                                                                                                                                    "label": "\"default\": p.value",
                                                                                                                                    "start_token": 1271,
                                                                                                                                    "end_token": 1275,
                                                                                                                                    "children": [
                                                                                                                                        {
                                                                                                                                            "type": "string",
                                                                                                                                            "label": "\"default\"",
                                                                                                                                            "start_token": 1271,
                                                                                                                                            "end_token": 1271,
                                                                                                                                            "children": [
                                                                                                                                                {
                                                                                                                                                    "type": "string_start",
                                                                                                                                                    "label": "\"",
                                                                                                                                                    "start_token": 1271,
                                                                                                                                                    "end_token": 1271,
                                                                                                                                                    "children": []
                                                                                                                                                },
                                                                                                                                                {
                                                                                                                                                    "type": "string_content",
                                                                                                                                                    "label": "default",
                                                                                                                                                    "start_token": 1271,
                                                                                                                                                    "end_token": 1271,
                                                                                                                                                    "children": []
                                                                                                                                                },
                                                                                                                                                {
                                                                                                                                                    "type": "string_end",
                                                                                                                                                    "label": "\"",
                                                                                                                                                    "start_token": 1271,
                                                                                                                                                    "end_token": 1271,
                                                                                                                                                    "children": []
                                                                                                                                                }
                                                                                                                                            ]
                                                                                                                                        },
                                                                                                                                        {
                                                                                                                                            "type": "attribute",
                                                                                                                                            "label": "p.value",
                                                                                                                                            "start_token": 1273,
                                                                                                                                            "end_token": 1275,
                                                                                                                                            "children": [
                                                                                                                                                {
                                                                                                                                                    "type": "identifier",
                                                                                                                                                    "label": "p",
                                                                                                                                                    "start_token": 1273,
                                                                                                                                                    "end_token": 1273,
                                                                                                                                                    "children": []
                                                                                                                                                },
                                                                                                                                                {
                                                                                                                                                    "type": "identifier",
                                                                                                                                                    "label": "value",
                                                                                                                                                    "start_token": 1275,
                                                                                                                                                    "end_token": 1275,
                                                                                                                                                    "children": []
                                                                                                                                                }
                                                                                                                                            ]
                                                                                                                                        }
                                                                                                                                    ]
                                                                                                                                }
                                                                                                                            ]
                                                                                                                        },
                                                                                                                        {
                                                                                                                            "type": "comparison_operator",
                                                                                                                            "label": "p.value is not None",
                                                                                                                            "start_token": 1278,
                                                                                                                            "end_token": 1283,
                                                                                                                            "children": [
                                                                                                                                {
                                                                                                                                    "type": "attribute",
                                                                                                                                    "label": "p.value",
                                                                                                                                    "start_token": 1278,
                                                                                                                                    "end_token": 1280,
                                                                                                                                    "children": [
                                                                                                                                        {
                                                                                                                                            "type": "identifier",
                                                                                                                                            "label": "p",
                                                                                                                                            "start_token": 1278,
                                                                                                                                            "end_token": 1278,
                                                                                                                                            "children": []
                                                                                                                                        },
                                                                                                                                        {
                                                                                                                                            "type": "identifier",
                                                                                                                                            "label": "value",
                                                                                                                                            "start_token": 1280,
                                                                                                                                            "end_token": 1280,
                                                                                                                                            "children": []
                                                                                                                                        }
                                                                                                                                    ]
                                                                                                                                },
                                                                                                                                {
                                                                                                                                    "type": "none",
                                                                                                                                    "label": "None",
                                                                                                                                    "start_token": 1283,
                                                                                                                                    "end_token": 1283,
                                                                                                                                    "children": []
                                                                                                                                }
                                                                                                                            ]
                                                                                                                        },
                                                                                                                        {
                                                                                                                            "type": "dictionary",
                                                                                                                            "label": "{}",
                                                                                                                            "start_token": 1285,
                                                                                                                            "end_token": 1286,
                                                                                                                            "children": []
                                                                                                                        }
                                                                                                                    ]
                                                                                                                }
                                                                                                            ]
                                                                                                        }
                                                                                                    ]
                                                                                                }
                                                                                            ]
                                                                                        }
                                                                                    ]
                                                                                },
                                                                                {
                                                                                    "type": "for_in_clause",
                                                                                    "label": "for p in props",
                                                                                    "start_token": 1292,
                                                                                    "end_token": 1295,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "label": "p",
                                                                                            "start_token": 1293,
                                                                                            "end_token": 1293,
                                                                                            "children": []
                                                                                        },
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "label": "props",
                                                                                            "start_token": 1295,
                                                                                            "end_token": 1295,
                                                                                            "children": []
                                                                                        }
                                                                                    ]
                                                                                }
                                                                            ]
                                                                        }
                                                                    ]
                                                                },
                                                                {
                                                                    "type": "pair",
                                                                    "label": "\"required\": [p.name for p in props if p.value is None]",
                                                                    "start_token": 1300,
                                                                    "end_token": 1316,
                                                                    "children": [
                                                                        {
                                                                            "type": "string",
                                                                            "label": "\"required\"",
                                                                            "start_token": 1300,
                                                                            "end_token": 1300,
                                                                            "children": [
                                                                                {
                                                                                    "type": "string_start",
                                                                                    "label": "\"",
                                                                                    "start_token": 1300,
                                                                                    "end_token": 1300,
                                                                                    "children": []
                                                                                },
                                                                                {
                                                                                    "type": "string_content",
                                                                                    "label": "required",
                                                                                    "start_token": 1300,
                                                                                    "end_token": 1300,
                                                                                    "children": []
                                                                                },
                                                                                {
                                                                                    "type": "string_end",
                                                                                    "label": "\"",
                                                                                    "start_token": 1300,
                                                                                    "end_token": 1300,
                                                                                    "children": []
                                                                                }
                                                                            ]
                                                                        },
                                                                        {
                                                                            "type": "list_comprehension",
                                                                            "label": "[p.name for p in props if p.value is None]",
                                                                            "start_token": 1302,
                                                                            "end_token": 1316,
                                                                            "children": [
                                                                                {
                                                                                    "type": "attribute",
                                                                                    "label": "p.name",
                                                                                    "start_token": 1303,
                                                                                    "end_token": 1305,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "label": "p",
                                                                                            "start_token": 1303,
                                                                                            "end_token": 1303,
                                                                                            "children": []
                                                                                        },
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "label": "name",
                                                                                            "start_token": 1305,
                                                                                            "end_token": 1305,
                                                                                            "children": []
                                                                                        }
                                                                                    ]
                                                                                },
                                                                                {
                                                                                    "type": "for_in_clause",
                                                                                    "label": "for p in props",
                                                                                    "start_token": 1306,
                                                                                    "end_token": 1309,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "label": "p",
                                                                                            "start_token": 1307,
                                                                                            "end_token": 1307,
                                                                                            "children": []
                                                                                        },
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "label": "props",
                                                                                            "start_token": 1309,
                                                                                            "end_token": 1309,
                                                                                            "children": []
                                                                                        }
                                                                                    ]
                                                                                },
                                                                                {
                                                                                    "type": "if_clause",
                                                                                    "label": "if p.value is None",
                                                                                    "start_token": 1310,
                                                                                    "end_token": 1315,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "comparison_operator",
                                                                                            "label": "p.value is None",
                                                                                            "start_token": 1311,
                                                                                            "end_token": 1315,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "attribute",
                                                                                                    "label": "p.value",
                                                                                                    "start_token": 1311,
                                                                                                    "end_token": 1313,
                                                                                                    "children": [
                                                                                                        {
                                                                                                            "type": "identifier",
                                                                                                            "label": "p",
                                                                                                            "start_token": 1311,
                                                                                                            "end_token": 1311,
                                                                                                            "children": []
                                                                                                        },
                                                                                                        {
                                                                                                            "type": "identifier",
                                                                                                            "label": "value",
                                                                                                            "start_token": 1313,
                                                                                                            "end_token": 1313,
                                                                                                            "children": []
                                                                                                        }
                                                                                                    ]
                                                                                                },
                                                                                                {
                                                                                                    "type": "none",
                                                                                                    "label": "None",
                                                                                                    "start_token": 1315,
                                                                                                    "end_token": 1315,
                                                                                                    "children": []
                                                                                                }
                                                                                            ]
                                                                                        }
                                                                                    ]
                                                                                }
                                                                            ]
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                }
                                            ]
                                        }
                                    ]
                                }
                            ]
                        }
                    ]
                }
            ]
        },
        {
            "type": "class_definition",
            "label": "class GraphModel(Graph):\n    user_id: str\n    nodes: list[NodeModel] = []  # type: ignore\n\n    @property\n    def starting_nodes(self) -> list[Node]:\n        outbound_nodes = {link.sink_id for link in self.links}\n        input_nodes = {\n            v.id\n            for v in self.nodes\n            if (b := get_block(v.block_id)) and b.block_type == BlockType.INPUT\n        }\n        return [\n            node\n            for node in self.nodes\n            if node.id not in outbound_nodes or node.id in input_nodes\n        ]\n\n    def reassign_ids(self, user_id: str, reassign_graph_id: bool = False):\n        \"\"\"\n        Reassigns all IDs in the graph to new UUIDs.\n        This method can be used before storing a new graph to the database.\n        \"\"\"\n\n        # Reassign Graph ID\n        id_map = {node.id: str(uuid.uuid4()) for node in self.nodes}\n        if reassign_graph_id:\n            self.id = str(uuid.uuid4())\n\n        # Reassign Node IDs\n        for node in self.nodes:\n            node.id = id_map[node.id]\n\n        # Reassign Link IDs\n        for link in self.links:\n            link.source_id = id_map[link.source_id]\n            link.sink_id = id_map[link.sink_id]\n\n        # Reassign User IDs for agent blocks\n        for node in self.nodes:\n            if node.block_id != AgentExecutorBlock().id:\n                continue\n            node.input_default[\"user_id\"] = user_id\n            node.input_default.setdefault(\"data\", {})\n\n        self.validate_graph()\n\n    def validate_graph(self, for_run: bool = False):\n        def sanitize(name):\n            return name.split(\"_#_\")[0].split(\"_@_\")[0].split(\"_$_\")[0]\n\n        input_links = defaultdict(list)\n        for link in self.links:\n            input_links[link.sink_id].append(link)\n\n        # Nodes: required fields are filled or connected and dependencies are satisfied\n        for node in self.nodes:\n            block = get_block(node.block_id)\n            if block is None:\n                raise ValueError(f\"Invalid block {node.block_id} for node #{node.id}\")\n\n            provided_inputs = set(\n                [sanitize(name) for name in node.input_default]\n                + [sanitize(link.sink_name) for link in input_links.get(node.id, [])]\n            )\n            for name in block.input_schema.get_required_fields():\n                if (\n                    name not in provided_inputs\n                    and not (\n                        name == \"payload\"\n                        and block.block_type\n                        in (BlockType.WEBHOOK, BlockType.WEBHOOK_MANUAL)\n                    )\n                    and (\n                        for_run  # Skip input completion validation, unless when executing.\n                        or block.block_type == BlockType.INPUT\n                        or block.block_type == BlockType.OUTPUT\n                        or block.block_type == BlockType.AGENT\n                    )\n                ):\n                    raise ValueError(\n                        f\"Node {block.name} #{node.id} required input missing: `{name}`\"\n                    )\n\n            # Get input schema properties and check dependencies\n            input_schema = block.input_schema.model_fields\n            required_fields = block.input_schema.get_required_fields()\n\n            def has_value(name):\n                return (\n                    node is not None\n                    and name in node.input_default\n                    and node.input_default[name] is not None\n                    and str(node.input_default[name]).strip() != \"\"\n                ) or (name in input_schema and input_schema[name].default is not None)\n\n            # Validate dependencies between fields\n            for field_name, field_info in input_schema.items():\n                # Apply input dependency validation only on run & field with depends_on\n                json_schema_extra = field_info.json_schema_extra or {}\n                dependencies = json_schema_extra.get(\"depends_on\", [])\n                if not for_run or not dependencies:\n                    continue\n\n                # Check if dependent field has value in input_default\n                field_has_value = has_value(field_name)\n                field_is_required = field_name in required_fields\n\n                # Check for missing dependencies when dependent field is present\n                missing_deps = [dep for dep in dependencies if not has_value(dep)]\n                if missing_deps and (field_has_value or field_is_required):\n                    raise ValueError(\n                        f\"Node {block.name} #{node.id}: Field `{field_name}` requires [{', '.join(missing_deps)}] to be set\"\n                    )\n\n        node_map = {v.id: v for v in self.nodes}\n\n        def is_static_output_block(nid: str) -> bool:\n            bid = node_map[nid].block_id\n            b = get_block(bid)\n            return b.static_output if b else False\n\n        # Links: links are connected and the connected pin data type are compatible.\n        for link in self.links:\n            source = (link.source_id, link.source_name)\n            sink = (link.sink_id, link.sink_name)\n            suffix = f\"Link {source} <-> {sink}\"\n\n            for i, (node_id, name) in enumerate([source, sink]):\n                node = node_map.get(node_id)\n                if not node:\n                    raise ValueError(\n                        f\"{suffix}, {node_id} is invalid node id, available nodes: {node_map.keys()}\"\n                    )\n\n                block = get_block(node.block_id)\n                if not block:\n                    blocks = {v().id: v().name for v in get_blocks().values()}\n                    raise ValueError(\n                        f\"{suffix}, {node.block_id} is invalid block id, available blocks: {blocks}\"\n                    )\n\n                sanitized_name = sanitize(name)\n                vals = node.input_default\n                if i == 0:\n                    fields = (\n                        block.output_schema.get_fields()\n                        if block.block_type != BlockType.AGENT\n                        else vals.get(\"output_schema\", {}).get(\"properties\", {}).keys()\n                    )\n                else:\n                    fields = (\n                        block.input_schema.get_fields()\n                        if block.block_type != BlockType.AGENT\n                        else vals.get(\"input_schema\", {}).get(\"properties\", {}).keys()\n                    )\n                if sanitized_name not in fields:\n                    fields_msg = f\"Allowed fields: {fields}\"\n                    raise ValueError(f\"{suffix}, `{name}` invalid, {fields_msg}\")\n\n            if is_static_output_block(link.source_id):\n                link.is_static = True  # Each value block output should be static.\n\n    @staticmethod\n    def from_db(graph: AgentGraph, for_export: bool = False):\n        return GraphModel(\n            id=graph.id,\n            user_id=graph.userId,\n            version=graph.version,\n            is_active=graph.isActive,\n            is_template=graph.isTemplate,\n            name=graph.name or \"\",\n            description=graph.description or \"\",\n            nodes=[\n                NodeModel.from_db(GraphModel._process_node(node, for_export))\n                for node in graph.AgentNodes or []\n            ],\n            links=list(\n                {\n                    Link.from_db(link)\n                    for node in graph.AgentNodes or []\n                    for link in (node.Input or []) + (node.Output or [])\n                }\n            ),\n        )\n\n    @staticmethod\n    def _process_node(node: AgentNode, for_export: bool) -> AgentNode:\n        if for_export:\n            # Remove credentials from node input\n            if node.constantInput:\n                constant_input = json.loads(\n                    node.constantInput, target_type=dict[str, Any]\n                )\n                constant_input = GraphModel._hide_node_input_credentials(constant_input)\n                node.constantInput = json.dumps(constant_input)\n\n            # Remove webhook info\n            node.webhookId = None\n            node.Webhook = None\n\n        return node\n\n    @staticmethod\n    def _hide_node_input_credentials(input_data: dict[str, Any]) -> dict[str, Any]:\n        sensitive_keys = [\"credentials\", \"api_key\", \"password\", \"token\", \"secret\"]\n        result = {}\n        for key, value in input_data.items():\n            if isinstance(value, dict):\n                result[key] = GraphModel._hide_node_input_credentials(value)\n            elif isinstance(value, str) and any(\n                sensitive_key in key.lower() for sensitive_key in sensitive_keys\n            ):\n                # Skip this key-value pair in the result\n                continue\n            else:\n                result[key] = value\n        return result",
            "start_token": 1323,
            "end_token": 2891,
            "children": [
                {
                    "type": "identifier",
                    "label": "GraphModel",
                    "start_token": 1324,
                    "end_token": 1324,
                    "children": []
                },
                {
                    "type": "argument_list",
                    "label": "(Graph)",
                    "start_token": 1325,
                    "end_token": 1327,
                    "children": [
                        {
                            "type": "identifier",
                            "label": "Graph",
                            "start_token": 1326,
                            "end_token": 1326,
                            "children": []
                        }
                    ]
                },
                {
                    "type": "block",
                    "label": "user_id: str\n    nodes: list[NodeModel] = []  # type: ignore\n\n    @property\n    def starting_nodes(self) -> list[Node]:\n        outbound_nodes = {link.sink_id for link in self.links}\n        input_nodes = {\n            v.id\n            for v in self.nodes\n            if (b := get_block(v.block_id)) and b.block_type == BlockType.INPUT\n        }\n        return [\n            node\n            for node in self.nodes\n            if node.id not in outbound_nodes or node.id in input_nodes\n        ]\n\n    def reassign_ids(self, user_id: str, reassign_graph_id: bool = False):\n        \"\"\"\n        Reassigns all IDs in the graph to new UUIDs.\n        This method can be used before storing a new graph to the database.\n        \"\"\"\n\n        # Reassign Graph ID\n        id_map = {node.id: str(uuid.uuid4()) for node in self.nodes}\n        if reassign_graph_id:\n            self.id = str(uuid.uuid4())\n\n        # Reassign Node IDs\n        for node in self.nodes:\n            node.id = id_map[node.id]\n\n        # Reassign Link IDs\n        for link in self.links:\n            link.source_id = id_map[link.source_id]\n            link.sink_id = id_map[link.sink_id]\n\n        # Reassign User IDs for agent blocks\n        for node in self.nodes:\n            if node.block_id != AgentExecutorBlock().id:\n                continue\n            node.input_default[\"user_id\"] = user_id\n            node.input_default.setdefault(\"data\", {})\n\n        self.validate_graph()\n\n    def validate_graph(self, for_run: bool = False):\n        def sanitize(name):\n            return name.split(\"_#_\")[0].split(\"_@_\")[0].split(\"_$_\")[0]\n\n        input_links = defaultdict(list)\n        for link in self.links:\n            input_links[link.sink_id].append(link)\n\n        # Nodes: required fields are filled or connected and dependencies are satisfied\n        for node in self.nodes:\n            block = get_block(node.block_id)\n            if block is None:\n                raise ValueError(f\"Invalid block {node.block_id} for node #{node.id}\")\n\n            provided_inputs = set(\n                [sanitize(name) for name in node.input_default]\n                + [sanitize(link.sink_name) for link in input_links.get(node.id, [])]\n            )\n            for name in block.input_schema.get_required_fields():\n                if (\n                    name not in provided_inputs\n                    and not (\n                        name == \"payload\"\n                        and block.block_type\n                        in (BlockType.WEBHOOK, BlockType.WEBHOOK_MANUAL)\n                    )\n                    and (\n                        for_run  # Skip input completion validation, unless when executing.\n                        or block.block_type == BlockType.INPUT\n                        or block.block_type == BlockType.OUTPUT\n                        or block.block_type == BlockType.AGENT\n                    )\n                ):\n                    raise ValueError(\n                        f\"Node {block.name} #{node.id} required input missing: `{name}`\"\n                    )\n\n            # Get input schema properties and check dependencies\n            input_schema = block.input_schema.model_fields\n            required_fields = block.input_schema.get_required_fields()\n\n            def has_value(name):\n                return (\n                    node is not None\n                    and name in node.input_default\n                    and node.input_default[name] is not None\n                    and str(node.input_default[name]).strip() != \"\"\n                ) or (name in input_schema and input_schema[name].default is not None)\n\n            # Validate dependencies between fields\n            for field_name, field_info in input_schema.items():\n                # Apply input dependency validation only on run & field with depends_on\n                json_schema_extra = field_info.json_schema_extra or {}\n                dependencies = json_schema_extra.get(\"depends_on\", [])\n                if not for_run or not dependencies:\n                    continue\n\n                # Check if dependent field has value in input_default\n                field_has_value = has_value(field_name)\n                field_is_required = field_name in required_fields\n\n                # Check for missing dependencies when dependent field is present\n                missing_deps = [dep for dep in dependencies if not has_value(dep)]\n                if missing_deps and (field_has_value or field_is_required):\n                    raise ValueError(\n                        f\"Node {block.name} #{node.id}: Field `{field_name}` requires [{', '.join(missing_deps)}] to be set\"\n                    )\n\n        node_map = {v.id: v for v in self.nodes}\n\n        def is_static_output_block(nid: str) -> bool:\n            bid = node_map[nid].block_id\n            b = get_block(bid)\n            return b.static_output if b else False\n\n        # Links: links are connected and the connected pin data type are compatible.\n        for link in self.links:\n            source = (link.source_id, link.source_name)\n            sink = (link.sink_id, link.sink_name)\n            suffix = f\"Link {source} <-> {sink}\"\n\n            for i, (node_id, name) in enumerate([source, sink]):\n                node = node_map.get(node_id)\n                if not node:\n                    raise ValueError(\n                        f\"{suffix}, {node_id} is invalid node id, available nodes: {node_map.keys()}\"\n                    )\n\n                block = get_block(node.block_id)\n                if not block:\n                    blocks = {v().id: v().name for v in get_blocks().values()}\n                    raise ValueError(\n                        f\"{suffix}, {node.block_id} is invalid block id, available blocks: {blocks}\"\n                    )\n\n                sanitized_name = sanitize(name)\n                vals = node.input_default\n                if i == 0:\n                    fields = (\n                        block.output_schema.get_fields()\n                        if block.block_type != BlockType.AGENT\n                        else vals.get(\"output_schema\", {}).get(\"properties\", {}).keys()\n                    )\n                else:\n                    fields = (\n                        block.input_schema.get_fields()\n                        if block.block_type != BlockType.AGENT\n                        else vals.get(\"input_schema\", {}).get(\"properties\", {}).keys()\n                    )\n                if sanitized_name not in fields:\n                    fields_msg = f\"Allowed fields: {fields}\"\n                    raise ValueError(f\"{suffix}, `{name}` invalid, {fields_msg}\")\n\n            if is_static_output_block(link.source_id):\n                link.is_static = True  # Each value block output should be static.\n\n    @staticmethod\n    def from_db(graph: AgentGraph, for_export: bool = False):\n        return GraphModel(\n            id=graph.id,\n            user_id=graph.userId,\n            version=graph.version,\n            is_active=graph.isActive,\n            is_template=graph.isTemplate,\n            name=graph.name or \"\",\n            description=graph.description or \"\",\n            nodes=[\n                NodeModel.from_db(GraphModel._process_node(node, for_export))\n                for node in graph.AgentNodes or []\n            ],\n            links=list(\n                {\n                    Link.from_db(link)\n                    for node in graph.AgentNodes or []\n                    for link in (node.Input or []) + (node.Output or [])\n                }\n            ),\n        )\n\n    @staticmethod\n    def _process_node(node: AgentNode, for_export: bool) -> AgentNode:\n        if for_export:\n            # Remove credentials from node input\n            if node.constantInput:\n                constant_input = json.loads(\n                    node.constantInput, target_type=dict[str, Any]\n                )\n                constant_input = GraphModel._hide_node_input_credentials(constant_input)\n                node.constantInput = json.dumps(constant_input)\n\n            # Remove webhook info\n            node.webhookId = None\n            node.Webhook = None\n\n        return node\n\n    @staticmethod\n    def _hide_node_input_credentials(input_data: dict[str, Any]) -> dict[str, Any]:\n        sensitive_keys = [\"credentials\", \"api_key\", \"password\", \"token\", \"secret\"]\n        result = {}\n        for key, value in input_data.items():\n            if isinstance(value, dict):\n                result[key] = GraphModel._hide_node_input_credentials(value)\n            elif isinstance(value, str) and any(\n                sensitive_key in key.lower() for sensitive_key in sensitive_keys\n            ):\n                # Skip this key-value pair in the result\n                continue\n            else:\n                result[key] = value\n        return result",
                    "start_token": 1330,
                    "end_token": 2891,
                    "children": [
                        {
                            "type": "expression_statement",
                            "label": "user_id: str",
                            "start_token": 1330,
                            "end_token": 1332,
                            "children": [
                                {
                                    "type": "assignment",
                                    "label": "user_id: str",
                                    "start_token": 1330,
                                    "end_token": 1332,
                                    "children": [
                                        {
                                            "type": "identifier",
                                            "label": "user_id",
                                            "start_token": 1330,
                                            "end_token": 1330,
                                            "children": []
                                        },
                                        {
                                            "type": "type",
                                            "label": "str",
                                            "start_token": 1332,
                                            "end_token": 1332,
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "label": "str",
                                                    "start_token": 1332,
                                                    "end_token": 1332,
                                                    "children": []
                                                }
                                            ]
                                        }
                                    ]
                                }
                            ]
                        },
                        {
                            "type": "expression_statement",
                            "label": "nodes: list[NodeModel] = []",
                            "start_token": 1334,
                            "end_token": 1342,
                            "children": [
                                {
                                    "type": "assignment",
                                    "label": "nodes: list[NodeModel] = []",
                                    "start_token": 1334,
                                    "end_token": 1342,
                                    "children": [
                                        {
                                            "type": "identifier",
                                            "label": "nodes",
                                            "start_token": 1334,
                                            "end_token": 1334,
                                            "children": []
                                        },
                                        {
                                            "type": "type",
                                            "label": "list[NodeModel]",
                                            "start_token": 1336,
                                            "end_token": 1339,
                                            "children": [
                                                {
                                                    "type": "generic_type",
                                                    "label": "list[NodeModel]",
                                                    "start_token": 1336,
                                                    "end_token": 1339,
                                                    "children": [
                                                        {
                                                            "type": "identifier",
                                                            "label": "list",
                                                            "start_token": 1336,
                                                            "end_token": 1336,
                                                            "children": []
                                                        },
                                                        {
                                                            "type": "type_parameter",
                                                            "label": "[NodeModel]",
                                                            "start_token": 1337,
                                                            "end_token": 1339,
                                                            "children": [
                                                                {
                                                                    "type": "type",
                                                                    "label": "NodeModel",
                                                                    "start_token": 1338,
                                                                    "end_token": 1338,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "NodeModel",
                                                                            "start_token": 1338,
                                                                            "end_token": 1338,
                                                                            "children": []
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                }
                                            ]
                                        },
                                        {
                                            "type": "list",
                                            "label": "[]",
                                            "start_token": 1341,
                                            "end_token": 1342,
                                            "children": []
                                        }
                                    ]
                                }
                            ]
                        },
                        {
                            "type": "comment",
                            "label": "# type: ignore",
                            "start_token": 1343,
                            "end_token": 1346,
                            "children": []
                        },
                        {
                            "type": "decorated_definition",
                            "label": "@property\n    def starting_nodes(self) -> list[Node]:\n        outbound_nodes = {link.sink_id for link in self.links}\n        input_nodes = {\n            v.id\n            for v in self.nodes\n            if (b := get_block(v.block_id)) and b.block_type == BlockType.INPUT\n        }\n        return [\n            node\n            for node in self.nodes\n            if node.id not in outbound_nodes or node.id in input_nodes\n        ]",
                            "start_token": 1349,
                            "end_token": 1444,
                            "children": [
                                {
                                    "type": "decorator",
                                    "label": "@property",
                                    "start_token": 1349,
                                    "end_token": 1350,
                                    "children": [
                                        {
                                            "type": "identifier",
                                            "label": "property",
                                            "start_token": 1350,
                                            "end_token": 1350,
                                            "children": []
                                        }
                                    ]
                                },
                                {
                                    "type": "function_definition",
                                    "label": "def starting_nodes(self) -> list[Node]:\n        outbound_nodes = {link.sink_id for link in self.links}\n        input_nodes = {\n            v.id\n            for v in self.nodes\n            if (b := get_block(v.block_id)) and b.block_type == BlockType.INPUT\n        }\n        return [\n            node\n            for node in self.nodes\n            if node.id not in outbound_nodes or node.id in input_nodes\n        ]",
                                    "start_token": 1352,
                                    "end_token": 1444,
                                    "children": [
                                        {
                                            "type": "identifier",
                                            "label": "starting_nodes",
                                            "start_token": 1353,
                                            "end_token": 1353,
                                            "children": []
                                        },
                                        {
                                            "type": "parameters",
                                            "label": "(self)",
                                            "start_token": 1354,
                                            "end_token": 1356,
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "label": "self",
                                                    "start_token": 1355,
                                                    "end_token": 1355,
                                                    "children": []
                                                }
                                            ]
                                        },
                                        {
                                            "type": "type",
                                            "label": "list[Node]",
                                            "start_token": 1359,
                                            "end_token": 1362,
                                            "children": [
                                                {
                                                    "type": "generic_type",
                                                    "label": "list[Node]",
                                                    "start_token": 1359,
                                                    "end_token": 1362,
                                                    "children": [
                                                        {
                                                            "type": "identifier",
                                                            "label": "list",
                                                            "start_token": 1359,
                                                            "end_token": 1359,
                                                            "children": []
                                                        },
                                                        {
                                                            "type": "type_parameter",
                                                            "label": "[Node]",
                                                            "start_token": 1360,
                                                            "end_token": 1362,
                                                            "children": [
                                                                {
                                                                    "type": "type",
                                                                    "label": "Node",
                                                                    "start_token": 1361,
                                                                    "end_token": 1361,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "Node",
                                                                            "start_token": 1361,
                                                                            "end_token": 1361,
                                                                            "children": []
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                }
                                            ]
                                        },
                                        {
                                            "type": "block",
                                            "label": "outbound_nodes = {link.sink_id for link in self.links}\n        input_nodes = {\n            v.id\n            for v in self.nodes\n            if (b := get_block(v.block_id)) and b.block_type == BlockType.INPUT\n        }\n        return [\n            node\n            for node in self.nodes\n            if node.id not in outbound_nodes or node.id in input_nodes\n        ]",
                                            "start_token": 1365,
                                            "end_token": 1444,
                                            "children": [
                                                {
                                                    "type": "expression_statement",
                                                    "label": "outbound_nodes = {link.sink_id for link in self.links}",
                                                    "start_token": 1365,
                                                    "end_token": 1377,
                                                    "children": [
                                                        {
                                                            "type": "assignment",
                                                            "label": "outbound_nodes = {link.sink_id for link in self.links}",
                                                            "start_token": 1365,
                                                            "end_token": 1377,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "label": "outbound_nodes",
                                                                    "start_token": 1365,
                                                                    "end_token": 1365,
                                                                    "children": []
                                                                },
                                                                {
                                                                    "type": "set_comprehension",
                                                                    "label": "{link.sink_id for link in self.links}",
                                                                    "start_token": 1367,
                                                                    "end_token": 1377,
                                                                    "children": [
                                                                        {
                                                                            "type": "attribute",
                                                                            "label": "link.sink_id",
                                                                            "start_token": 1368,
                                                                            "end_token": 1370,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "link",
                                                                                    "start_token": 1368,
                                                                                    "end_token": 1368,
                                                                                    "children": []
                                                                                },
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "sink_id",
                                                                                    "start_token": 1370,
                                                                                    "end_token": 1370,
                                                                                    "children": []
                                                                                }
                                                                            ]
                                                                        },
                                                                        {
                                                                            "type": "for_in_clause",
                                                                            "label": "for link in self.links",
                                                                            "start_token": 1371,
                                                                            "end_token": 1376,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "link",
                                                                                    "start_token": 1372,
                                                                                    "end_token": 1372,
                                                                                    "children": []
                                                                                },
                                                                                {
                                                                                    "type": "attribute",
                                                                                    "label": "self.links",
                                                                                    "start_token": 1374,
                                                                                    "end_token": 1376,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "label": "self",
                                                                                            "start_token": 1374,
                                                                                            "end_token": 1374,
                                                                                            "children": []
                                                                                        },
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "label": "links",
                                                                                            "start_token": 1376,
                                                                                            "end_token": 1376,
                                                                                            "children": []
                                                                                        }
                                                                                    ]
                                                                                }
                                                                            ]
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                },
                                                {
                                                    "type": "expression_statement",
                                                    "label": "input_nodes = {\n            v.id\n            for v in self.nodes\n            if (b := get_block(v.block_id)) and b.block_type == BlockType.INPUT\n        }",
                                                    "start_token": 1379,
                                                    "end_token": 1416,
                                                    "children": [
                                                        {
                                                            "type": "assignment",
                                                            "label": "input_nodes = {\n            v.id\n            for v in self.nodes\n            if (b := get_block(v.block_id)) and b.block_type == BlockType.INPUT\n        }",
                                                            "start_token": 1379,
                                                            "end_token": 1416,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "label": "input_nodes",
                                                                    "start_token": 1379,
                                                                    "end_token": 1379,
                                                                    "children": []
                                                                },
                                                                {
                                                                    "type": "set_comprehension",
                                                                    "label": "{\n            v.id\n            for v in self.nodes\n            if (b := get_block(v.block_id)) and b.block_type == BlockType.INPUT\n        }",
                                                                    "start_token": 1381,
                                                                    "end_token": 1416,
                                                                    "children": [
                                                                        {
                                                                            "type": "attribute",
                                                                            "label": "v.id",
                                                                            "start_token": 1383,
                                                                            "end_token": 1385,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "v",
                                                                                    "start_token": 1383,
                                                                                    "end_token": 1383,
                                                                                    "children": []
                                                                                },
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "id",
                                                                                    "start_token": 1385,
                                                                                    "end_token": 1385,
                                                                                    "children": []
                                                                                }
                                                                            ]
                                                                        },
                                                                        {
                                                                            "type": "for_in_clause",
                                                                            "label": "for v in self.nodes",
                                                                            "start_token": 1387,
                                                                            "end_token": 1392,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "v",
                                                                                    "start_token": 1388,
                                                                                    "end_token": 1388,
                                                                                    "children": []
                                                                                },
                                                                                {
                                                                                    "type": "attribute",
                                                                                    "label": "self.nodes",
                                                                                    "start_token": 1390,
                                                                                    "end_token": 1392,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "label": "self",
                                                                                            "start_token": 1390,
                                                                                            "end_token": 1390,
                                                                                            "children": []
                                                                                        },
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "label": "nodes",
                                                                                            "start_token": 1392,
                                                                                            "end_token": 1392,
                                                                                            "children": []
                                                                                        }
                                                                                    ]
                                                                                }
                                                                            ]
                                                                        },
                                                                        {
                                                                            "type": "if_clause",
                                                                            "label": "if (b := get_block(v.block_id)) and b.block_type == BlockType.INPUT",
                                                                            "start_token": 1394,
                                                                            "end_token": 1414,
                                                                            "children": [
                                                                                {
                                                                                    "type": "boolean_operator",
                                                                                    "label": "(b := get_block(v.block_id)) and b.block_type == BlockType.INPUT",
                                                                                    "start_token": 1395,
                                                                                    "end_token": 1414,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "parenthesized_expression",
                                                                                            "label": "(b := get_block(v.block_id))",
                                                                                            "start_token": 1395,
                                                                                            "end_token": 1405,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "named_expression",
                                                                                                    "label": "b := get_block(v.block_id)",
                                                                                                    "start_token": 1396,
                                                                                                    "end_token": 1404,
                                                                                                    "children": [
                                                                                                        {
                                                                                                            "type": "identifier",
                                                                                                            "label": "b",
                                                                                                            "start_token": 1396,
                                                                                                            "end_token": 1396,
                                                                                                            "children": []
                                                                                                        },
                                                                                                        {
                                                                                                            "type": "call",
                                                                                                            "label": "get_block(v.block_id)",
                                                                                                            "start_token": 1399,
                                                                                                            "end_token": 1404,
                                                                                                            "children": [
                                                                                                                {
                                                                                                                    "type": "identifier",
                                                                                                                    "label": "get_block",
                                                                                                                    "start_token": 1399,
                                                                                                                    "end_token": 1399,
                                                                                                                    "children": []
                                                                                                                },
                                                                                                                {
                                                                                                                    "type": "argument_list",
                                                                                                                    "label": "(v.block_id)",
                                                                                                                    "start_token": 1400,
                                                                                                                    "end_token": 1404,
                                                                                                                    "children": [
                                                                                                                        {
                                                                                                                            "type": "attribute",
                                                                                                                            "label": "v.block_id",
                                                                                                                            "start_token": 1401,
                                                                                                                            "end_token": 1403,
                                                                                                                            "children": [
                                                                                                                                {
                                                                                                                                    "type": "identifier",
                                                                                                                                    "label": "v",
                                                                                                                                    "start_token": 1401,
                                                                                                                                    "end_token": 1401,
                                                                                                                                    "children": []
                                                                                                                                },
                                                                                                                                {
                                                                                                                                    "type": "identifier",
                                                                                                                                    "label": "block_id",
                                                                                                                                    "start_token": 1403,
                                                                                                                                    "end_token": 1403,
                                                                                                                                    "children": []
                                                                                                                                }
                                                                                                                            ]
                                                                                                                        }
                                                                                                                    ]
                                                                                                                }
                                                                                                            ]
                                                                                                        }
                                                                                                    ]
                                                                                                }
                                                                                            ]
                                                                                        },
                                                                                        {
                                                                                            "type": "comparison_operator",
                                                                                            "label": "b.block_type == BlockType.INPUT",
                                                                                            "start_token": 1407,
                                                                                            "end_token": 1414,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "attribute",
                                                                                                    "label": "b.block_type",
                                                                                                    "start_token": 1407,
                                                                                                    "end_token": 1409,
                                                                                                    "children": [
                                                                                                        {
                                                                                                            "type": "identifier",
                                                                                                            "label": "b",
                                                                                                            "start_token": 1407,
                                                                                                            "end_token": 1407,
                                                                                                            "children": []
                                                                                                        },
                                                                                                        {
                                                                                                            "type": "identifier",
                                                                                                            "label": "block_type",
                                                                                                            "start_token": 1409,
                                                                                                            "end_token": 1409,
                                                                                                            "children": []
                                                                                                        }
                                                                                                    ]
                                                                                                },
                                                                                                {
                                                                                                    "type": "attribute",
                                                                                                    "label": "BlockType.INPUT",
                                                                                                    "start_token": 1412,
                                                                                                    "end_token": 1414,
                                                                                                    "children": [
                                                                                                        {
                                                                                                            "type": "identifier",
                                                                                                            "label": "BlockType",
                                                                                                            "start_token": 1412,
                                                                                                            "end_token": 1412,
                                                                                                            "children": []
                                                                                                        },
                                                                                                        {
                                                                                                            "type": "identifier",
                                                                                                            "label": "INPUT",
                                                                                                            "start_token": 1414,
                                                                                                            "end_token": 1414,
                                                                                                            "children": []
                                                                                                        }
                                                                                                    ]
                                                                                                }
                                                                                            ]
                                                                                        }
                                                                                    ]
                                                                                }
                                                                            ]
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                },
                                                {
                                                    "type": "return_statement",
                                                    "label": "return [\n            node\n            for node in self.nodes\n            if node.id not in outbound_nodes or node.id in input_nodes\n        ]",
                                                    "start_token": 1418,
                                                    "end_token": 1444,
                                                    "children": [
                                                        {
                                                            "type": "list_comprehension",
                                                            "label": "[\n            node\n            for node in self.nodes\n            if node.id not in outbound_nodes or node.id in input_nodes\n        ]",
                                                            "start_token": 1419,
                                                            "end_token": 1444,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "label": "node",
                                                                    "start_token": 1421,
                                                                    "end_token": 1421,
                                                                    "children": []
                                                                },
                                                                {
                                                                    "type": "for_in_clause",
                                                                    "label": "for node in self.nodes",
                                                                    "start_token": 1423,
                                                                    "end_token": 1428,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "node",
                                                                            "start_token": 1424,
                                                                            "end_token": 1424,
                                                                            "children": []
                                                                        },
                                                                        {
                                                                            "type": "attribute",
                                                                            "label": "self.nodes",
                                                                            "start_token": 1426,
                                                                            "end_token": 1428,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "self",
                                                                                    "start_token": 1426,
                                                                                    "end_token": 1426,
                                                                                    "children": []
                                                                                },
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "nodes",
                                                                                    "start_token": 1428,
                                                                                    "end_token": 1428,
                                                                                    "children": []
                                                                                }
                                                                            ]
                                                                        }
                                                                    ]
                                                                },
                                                                {
                                                                    "type": "if_clause",
                                                                    "label": "if node.id not in outbound_nodes or node.id in input_nodes",
                                                                    "start_token": 1430,
                                                                    "end_token": 1442,
                                                                    "children": [
                                                                        {
                                                                            "type": "boolean_operator",
                                                                            "label": "node.id not in outbound_nodes or node.id in input_nodes",
                                                                            "start_token": 1431,
                                                                            "end_token": 1442,
                                                                            "children": [
                                                                                {
                                                                                    "type": "comparison_operator",
                                                                                    "label": "node.id not in outbound_nodes",
                                                                                    "start_token": 1431,
                                                                                    "end_token": 1436,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "attribute",
                                                                                            "label": "node.id",
                                                                                            "start_token": 1431,
                                                                                            "end_token": 1433,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "label": "node",
                                                                                                    "start_token": 1431,
                                                                                                    "end_token": 1431,
                                                                                                    "children": []
                                                                                                },
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "label": "id",
                                                                                                    "start_token": 1433,
                                                                                                    "end_token": 1433,
                                                                                                    "children": []
                                                                                                }
                                                                                            ]
                                                                                        },
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "label": "outbound_nodes",
                                                                                            "start_token": 1436,
                                                                                            "end_token": 1436,
                                                                                            "children": []
                                                                                        }
                                                                                    ]
                                                                                },
                                                                                {
                                                                                    "type": "comparison_operator",
                                                                                    "label": "node.id in input_nodes",
                                                                                    "start_token": 1438,
                                                                                    "end_token": 1442,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "attribute",
                                                                                            "label": "node.id",
                                                                                            "start_token": 1438,
                                                                                            "end_token": 1440,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "label": "node",
                                                                                                    "start_token": 1438,
                                                                                                    "end_token": 1438,
                                                                                                    "children": []
                                                                                                },
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "label": "id",
                                                                                                    "start_token": 1440,
                                                                                                    "end_token": 1440,
                                                                                                    "children": []
                                                                                                }
                                                                                            ]
                                                                                        },
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "label": "input_nodes",
                                                                                            "start_token": 1442,
                                                                                            "end_token": 1442,
                                                                                            "children": []
                                                                                        }
                                                                                    ]
                                                                                }
                                                                            ]
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                }
                                            ]
                                        }
                                    ]
                                }
                            ]
                        },
                        {
                            "type": "function_definition",
                            "label": "def reassign_ids(self, user_id: str, reassign_graph_id: bool = False):\n        \"\"\"\n        Reassigns all IDs in the graph to new UUIDs.\n        This method can be used before storing a new graph to the database.\n        \"\"\"\n\n        # Reassign Graph ID\n        id_map = {node.id: str(uuid.uuid4()) for node in self.nodes}\n        if reassign_graph_id:\n            self.id = str(uuid.uuid4())\n\n        # Reassign Node IDs\n        for node in self.nodes:\n            node.id = id_map[node.id]\n\n        # Reassign Link IDs\n        for link in self.links:\n            link.source_id = id_map[link.source_id]\n            link.sink_id = id_map[link.sink_id]\n\n        # Reassign User IDs for agent blocks\n        for node in self.nodes:\n            if node.block_id != AgentExecutorBlock().id:\n                continue\n            node.input_default[\"user_id\"] = user_id\n            node.input_default.setdefault(\"data\", {})\n\n        self.validate_graph()",
                            "start_token": 1447,
                            "end_token": 1633,
                            "children": [
                                {
                                    "type": "identifier",
                                    "label": "reassign_ids",
                                    "start_token": 1448,
                                    "end_token": 1448,
                                    "children": []
                                },
                                {
                                    "type": "parameters",
                                    "label": "(self, user_id: str, reassign_graph_id: bool = False)",
                                    "start_token": 1449,
                                    "end_token": 1461,
                                    "children": [
                                        {
                                            "type": "identifier",
                                            "label": "self",
                                            "start_token": 1450,
                                            "end_token": 1450,
                                            "children": []
                                        },
                                        {
                                            "type": "typed_parameter",
                                            "label": "user_id: str",
                                            "start_token": 1452,
                                            "end_token": 1454,
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "label": "user_id",
                                                    "start_token": 1452,
                                                    "end_token": 1452,
                                                    "children": []
                                                },
                                                {
                                                    "type": "type",
                                                    "label": "str",
                                                    "start_token": 1454,
                                                    "end_token": 1454,
                                                    "children": [
                                                        {
                                                            "type": "identifier",
                                                            "label": "str",
                                                            "start_token": 1454,
                                                            "end_token": 1454,
                                                            "children": []
                                                        }
                                                    ]
                                                }
                                            ]
                                        },
                                        {
                                            "type": "typed_default_parameter",
                                            "label": "reassign_graph_id: bool = False",
                                            "start_token": 1456,
                                            "end_token": 1460,
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "label": "reassign_graph_id",
                                                    "start_token": 1456,
                                                    "end_token": 1456,
                                                    "children": []
                                                },
                                                {
                                                    "type": "type",
                                                    "label": "bool",
                                                    "start_token": 1458,
                                                    "end_token": 1458,
                                                    "children": [
                                                        {
                                                            "type": "identifier",
                                                            "label": "bool",
                                                            "start_token": 1458,
                                                            "end_token": 1458,
                                                            "children": []
                                                        }
                                                    ]
                                                },
                                                {
                                                    "type": "false",
                                                    "label": "False",
                                                    "start_token": 1460,
                                                    "end_token": 1460,
                                                    "children": []
                                                }
                                            ]
                                        }
                                    ]
                                },
                                {
                                    "type": "block",
                                    "label": "\"\"\"\n        Reassigns all IDs in the graph to new UUIDs.\n        This method can be used before storing a new graph to the database.\n        \"\"\"\n\n        # Reassign Graph ID\n        id_map = {node.id: str(uuid.uuid4()) for node in self.nodes}\n        if reassign_graph_id:\n            self.id = str(uuid.uuid4())\n\n        # Reassign Node IDs\n        for node in self.nodes:\n            node.id = id_map[node.id]\n\n        # Reassign Link IDs\n        for link in self.links:\n            link.source_id = id_map[link.source_id]\n            link.sink_id = id_map[link.sink_id]\n\n        # Reassign User IDs for agent blocks\n        for node in self.nodes:\n            if node.block_id != AgentExecutorBlock().id:\n                continue\n            node.input_default[\"user_id\"] = user_id\n            node.input_default.setdefault(\"data\", {})\n\n        self.validate_graph()",
                                    "start_token": 1464,
                                    "end_token": 1633,
                                    "children": [
                                        {
                                            "type": "expression_statement",
                                            "label": "\"\"\"\n        Reassigns all IDs in the graph to new UUIDs.\n        This method can be used before storing a new graph to the database.\n        \"\"\"",
                                            "start_token": 1464,
                                            "end_token": 1466,
                                            "children": [
                                                {
                                                    "type": "string",
                                                    "label": "\"\"\"\n        Reassigns all IDs in the graph to new UUIDs.\n        This method can be used before storing a new graph to the database.\n        \"\"\"",
                                                    "start_token": 1464,
                                                    "end_token": 1466,
                                                    "children": [
                                                        {
                                                            "type": "string_start",
                                                            "label": "\"\"\"",
                                                            "start_token": 1464,
                                                            "end_token": 1465,
                                                            "children": []
                                                        },
                                                        {
                                                            "type": "string_content",
                                                            "label": "\n        Reassigns all IDs in the graph to new UUIDs.\n        This method can be used before storing a new graph to the database.\n        ",
                                                            "start_token": 1465,
                                                            "end_token": 1465,
                                                            "children": []
                                                        },
                                                        {
                                                            "type": "string_end",
                                                            "label": "\"\"\"",
                                                            "start_token": 1465,
                                                            "end_token": 1466,
                                                            "children": []
                                                        }
                                                    ]
                                                }
                                            ]
                                        },
                                        {
                                            "type": "comment",
                                            "label": "# Reassign Graph ID",
                                            "start_token": 1469,
                                            "end_token": 1472,
                                            "children": []
                                        },
                                        {
                                            "type": "expression_statement",
                                            "label": "id_map = {node.id: str(uuid.uuid4()) for node in self.nodes}",
                                            "start_token": 1474,
                                            "end_token": 1495,
                                            "children": [
                                                {
                                                    "type": "assignment",
                                                    "label": "id_map = {node.id: str(uuid.uuid4()) for node in self.nodes}",
                                                    "start_token": 1474,
                                                    "end_token": 1495,
                                                    "children": [
                                                        {
                                                            "type": "identifier",
                                                            "label": "id_map",
                                                            "start_token": 1474,
                                                            "end_token": 1474,
                                                            "children": []
                                                        },
                                                        {
                                                            "type": "dictionary_comprehension",
                                                            "label": "{node.id: str(uuid.uuid4()) for node in self.nodes}",
                                                            "start_token": 1476,
                                                            "end_token": 1495,
                                                            "children": [
                                                                {
                                                                    "type": "pair",
                                                                    "label": "node.id: str(uuid.uuid4())",
                                                                    "start_token": 1477,
                                                                    "end_token": 1488,
                                                                    "children": [
                                                                        {
                                                                            "type": "attribute",
                                                                            "label": "node.id",
                                                                            "start_token": 1477,
                                                                            "end_token": 1479,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "node",
                                                                                    "start_token": 1477,
                                                                                    "end_token": 1477,
                                                                                    "children": []
                                                                                },
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "id",
                                                                                    "start_token": 1479,
                                                                                    "end_token": 1479,
                                                                                    "children": []
                                                                                }
                                                                            ]
                                                                        },
                                                                        {
                                                                            "type": "call",
                                                                            "label": "str(uuid.uuid4())",
                                                                            "start_token": 1481,
                                                                            "end_token": 1488,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "str",
                                                                                    "start_token": 1481,
                                                                                    "end_token": 1481,
                                                                                    "children": []
                                                                                },
                                                                                {
                                                                                    "type": "argument_list",
                                                                                    "label": "(uuid.uuid4())",
                                                                                    "start_token": 1482,
                                                                                    "end_token": 1488,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "call",
                                                                                            "label": "uuid.uuid4()",
                                                                                            "start_token": 1483,
                                                                                            "end_token": 1487,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "attribute",
                                                                                                    "label": "uuid.uuid4",
                                                                                                    "start_token": 1483,
                                                                                                    "end_token": 1485,
                                                                                                    "children": [
                                                                                                        {
                                                                                                            "type": "identifier",
                                                                                                            "label": "uuid",
                                                                                                            "start_token": 1483,
                                                                                                            "end_token": 1483,
                                                                                                            "children": []
                                                                                                        },
                                                                                                        {
                                                                                                            "type": "identifier",
                                                                                                            "label": "uuid4",
                                                                                                            "start_token": 1485,
                                                                                                            "end_token": 1485,
                                                                                                            "children": []
                                                                                                        }
                                                                                                    ]
                                                                                                },
                                                                                                {
                                                                                                    "type": "argument_list",
                                                                                                    "label": "()",
                                                                                                    "start_token": 1486,
                                                                                                    "end_token": 1487,
                                                                                                    "children": []
                                                                                                }
                                                                                            ]
                                                                                        }
                                                                                    ]
                                                                                }
                                                                            ]
                                                                        }
                                                                    ]
                                                                },
                                                                {
                                                                    "type": "for_in_clause",
                                                                    "label": "for node in self.nodes",
                                                                    "start_token": 1489,
                                                                    "end_token": 1494,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "node",
                                                                            "start_token": 1490,
                                                                            "end_token": 1490,
                                                                            "children": []
                                                                        },
                                                                        {
                                                                            "type": "attribute",
                                                                            "label": "self.nodes",
                                                                            "start_token": 1492,
                                                                            "end_token": 1494,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "self",
                                                                                    "start_token": 1492,
                                                                                    "end_token": 1492,
                                                                                    "children": []
                                                                                },
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "nodes",
                                                                                    "start_token": 1494,
                                                                                    "end_token": 1494,
                                                                                    "children": []
                                                                                }
                                                                            ]
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                }
                                            ]
                                        },
                                        {
                                            "type": "if_statement",
                                            "label": "if reassign_graph_id:\n            self.id = str(uuid.uuid4())",
                                            "start_token": 1497,
                                            "end_token": 1512,
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "label": "reassign_graph_id",
                                                    "start_token": 1498,
                                                    "end_token": 1498,
                                                    "children": []
                                                },
                                                {
                                                    "type": "block",
                                                    "label": "self.id = str(uuid.uuid4())",
                                                    "start_token": 1501,
                                                    "end_token": 1512,
                                                    "children": [
                                                        {
                                                            "type": "expression_statement",
                                                            "label": "self.id = str(uuid.uuid4())",
                                                            "start_token": 1501,
                                                            "end_token": 1512,
                                                            "children": [
                                                                {
                                                                    "type": "assignment",
                                                                    "label": "self.id = str(uuid.uuid4())",
                                                                    "start_token": 1501,
                                                                    "end_token": 1512,
                                                                    "children": [
                                                                        {
                                                                            "type": "attribute",
                                                                            "label": "self.id",
                                                                            "start_token": 1501,
                                                                            "end_token": 1503,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "self",
                                                                                    "start_token": 1501,
                                                                                    "end_token": 1501,
                                                                                    "children": []
                                                                                },
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "id",
                                                                                    "start_token": 1503,
                                                                                    "end_token": 1503,
                                                                                    "children": []
                                                                                }
                                                                            ]
                                                                        },
                                                                        {
                                                                            "type": "call",
                                                                            "label": "str(uuid.uuid4())",
                                                                            "start_token": 1505,
                                                                            "end_token": 1512,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "str",
                                                                                    "start_token": 1505,
                                                                                    "end_token": 1505,
                                                                                    "children": []
                                                                                },
                                                                                {
                                                                                    "type": "argument_list",
                                                                                    "label": "(uuid.uuid4())",
                                                                                    "start_token": 1506,
                                                                                    "end_token": 1512,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "call",
                                                                                            "label": "uuid.uuid4()",
                                                                                            "start_token": 1507,
                                                                                            "end_token": 1511,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "attribute",
                                                                                                    "label": "uuid.uuid4",
                                                                                                    "start_token": 1507,
                                                                                                    "end_token": 1509,
                                                                                                    "children": [
                                                                                                        {
                                                                                                            "type": "identifier",
                                                                                                            "label": "uuid",
                                                                                                            "start_token": 1507,
                                                                                                            "end_token": 1507,
                                                                                                            "children": []
                                                                                                        },
                                                                                                        {
                                                                                                            "type": "identifier",
                                                                                                            "label": "uuid4",
                                                                                                            "start_token": 1509,
                                                                                                            "end_token": 1509,
                                                                                                            "children": []
                                                                                                        }
                                                                                                    ]
                                                                                                },
                                                                                                {
                                                                                                    "type": "argument_list",
                                                                                                    "label": "()",
                                                                                                    "start_token": 1510,
                                                                                                    "end_token": 1511,
                                                                                                    "children": []
                                                                                                }
                                                                                            ]
                                                                                        }
                                                                                    ]
                                                                                }
                                                                            ]
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                }
                                            ]
                                        },
                                        {
                                            "type": "comment",
                                            "label": "# Reassign Node IDs",
                                            "start_token": 1515,
                                            "end_token": 1518,
                                            "children": []
                                        },
                                        {
                                            "type": "for_statement",
                                            "label": "for node in self.nodes:\n            node.id = id_map[node.id]",
                                            "start_token": 1520,
                                            "end_token": 1537,
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "label": "node",
                                                    "start_token": 1521,
                                                    "end_token": 1521,
                                                    "children": []
                                                },
                                                {
                                                    "type": "attribute",
                                                    "label": "self.nodes",
                                                    "start_token": 1523,
                                                    "end_token": 1525,
                                                    "children": [
                                                        {
                                                            "type": "identifier",
                                                            "label": "self",
                                                            "start_token": 1523,
                                                            "end_token": 1523,
                                                            "children": []
                                                        },
                                                        {
                                                            "type": "identifier",
                                                            "label": "nodes",
                                                            "start_token": 1525,
                                                            "end_token": 1525,
                                                            "children": []
                                                        }
                                                    ]
                                                },
                                                {
                                                    "type": "block",
                                                    "label": "node.id = id_map[node.id]",
                                                    "start_token": 1528,
                                                    "end_token": 1537,
                                                    "children": [
                                                        {
                                                            "type": "expression_statement",
                                                            "label": "node.id = id_map[node.id]",
                                                            "start_token": 1528,
                                                            "end_token": 1537,
                                                            "children": [
                                                                {
                                                                    "type": "assignment",
                                                                    "label": "node.id = id_map[node.id]",
                                                                    "start_token": 1528,
                                                                    "end_token": 1537,
                                                                    "children": [
                                                                        {
                                                                            "type": "attribute",
                                                                            "label": "node.id",
                                                                            "start_token": 1528,
                                                                            "end_token": 1530,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "node",
                                                                                    "start_token": 1528,
                                                                                    "end_token": 1528,
                                                                                    "children": []
                                                                                },
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "id",
                                                                                    "start_token": 1530,
                                                                                    "end_token": 1530,
                                                                                    "children": []
                                                                                }
                                                                            ]
                                                                        },
                                                                        {
                                                                            "type": "subscript",
                                                                            "label": "id_map[node.id]",
                                                                            "start_token": 1532,
                                                                            "end_token": 1537,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "id_map",
                                                                                    "start_token": 1532,
                                                                                    "end_token": 1532,
                                                                                    "children": []
                                                                                },
                                                                                {
                                                                                    "type": "attribute",
                                                                                    "label": "node.id",
                                                                                    "start_token": 1534,
                                                                                    "end_token": 1536,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "label": "node",
                                                                                            "start_token": 1534,
                                                                                            "end_token": 1534,
                                                                                            "children": []
                                                                                        },
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "label": "id",
                                                                                            "start_token": 1536,
                                                                                            "end_token": 1536,
                                                                                            "children": []
                                                                                        }
                                                                                    ]
                                                                                }
                                                                            ]
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                }
                                            ]
                                        },
                                        {
                                            "type": "comment",
                                            "label": "# Reassign Link IDs",
                                            "start_token": 1540,
                                            "end_token": 1543,
                                            "children": []
                                        },
                                        {
                                            "type": "for_statement",
                                            "label": "for link in self.links:\n            link.source_id = id_map[link.source_id]\n            link.sink_id = id_map[link.sink_id]",
                                            "start_token": 1545,
                                            "end_token": 1573,
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "label": "link",
                                                    "start_token": 1546,
                                                    "end_token": 1546,
                                                    "children": []
                                                },
                                                {
                                                    "type": "attribute",
                                                    "label": "self.links",
                                                    "start_token": 1548,
                                                    "end_token": 1550,
                                                    "children": [
                                                        {
                                                            "type": "identifier",
                                                            "label": "self",
                                                            "start_token": 1548,
                                                            "end_token": 1548,
                                                            "children": []
                                                        },
                                                        {
                                                            "type": "identifier",
                                                            "label": "links",
                                                            "start_token": 1550,
                                                            "end_token": 1550,
                                                            "children": []
                                                        }
                                                    ]
                                                },
                                                {
                                                    "type": "block",
                                                    "label": "link.source_id = id_map[link.source_id]\n            link.sink_id = id_map[link.sink_id]",
                                                    "start_token": 1553,
                                                    "end_token": 1573,
                                                    "children": [
                                                        {
                                                            "type": "expression_statement",
                                                            "label": "link.source_id = id_map[link.source_id]",
                                                            "start_token": 1553,
                                                            "end_token": 1562,
                                                            "children": [
                                                                {
                                                                    "type": "assignment",
                                                                    "label": "link.source_id = id_map[link.source_id]",
                                                                    "start_token": 1553,
                                                                    "end_token": 1562,
                                                                    "children": [
                                                                        {
                                                                            "type": "attribute",
                                                                            "label": "link.source_id",
                                                                            "start_token": 1553,
                                                                            "end_token": 1555,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "link",
                                                                                    "start_token": 1553,
                                                                                    "end_token": 1553,
                                                                                    "children": []
                                                                                },
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "source_id",
                                                                                    "start_token": 1555,
                                                                                    "end_token": 1555,
                                                                                    "children": []
                                                                                }
                                                                            ]
                                                                        },
                                                                        {
                                                                            "type": "subscript",
                                                                            "label": "id_map[link.source_id]",
                                                                            "start_token": 1557,
                                                                            "end_token": 1562,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "id_map",
                                                                                    "start_token": 1557,
                                                                                    "end_token": 1557,
                                                                                    "children": []
                                                                                },
                                                                                {
                                                                                    "type": "attribute",
                                                                                    "label": "link.source_id",
                                                                                    "start_token": 1559,
                                                                                    "end_token": 1561,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "label": "link",
                                                                                            "start_token": 1559,
                                                                                            "end_token": 1559,
                                                                                            "children": []
                                                                                        },
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "label": "source_id",
                                                                                            "start_token": 1561,
                                                                                            "end_token": 1561,
                                                                                            "children": []
                                                                                        }
                                                                                    ]
                                                                                }
                                                                            ]
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        },
                                                        {
                                                            "type": "expression_statement",
                                                            "label": "link.sink_id = id_map[link.sink_id]",
                                                            "start_token": 1564,
                                                            "end_token": 1573,
                                                            "children": [
                                                                {
                                                                    "type": "assignment",
                                                                    "label": "link.sink_id = id_map[link.sink_id]",
                                                                    "start_token": 1564,
                                                                    "end_token": 1573,
                                                                    "children": [
                                                                        {
                                                                            "type": "attribute",
                                                                            "label": "link.sink_id",
                                                                            "start_token": 1564,
                                                                            "end_token": 1566,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "link",
                                                                                    "start_token": 1564,
                                                                                    "end_token": 1564,
                                                                                    "children": []
                                                                                },
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "sink_id",
                                                                                    "start_token": 1566,
                                                                                    "end_token": 1566,
                                                                                    "children": []
                                                                                }
                                                                            ]
                                                                        },
                                                                        {
                                                                            "type": "subscript",
                                                                            "label": "id_map[link.sink_id]",
                                                                            "start_token": 1568,
                                                                            "end_token": 1573,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "id_map",
                                                                                    "start_token": 1568,
                                                                                    "end_token": 1568,
                                                                                    "children": []
                                                                                },
                                                                                {
                                                                                    "type": "attribute",
                                                                                    "label": "link.sink_id",
                                                                                    "start_token": 1570,
                                                                                    "end_token": 1572,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "label": "link",
                                                                                            "start_token": 1570,
                                                                                            "end_token": 1570,
                                                                                            "children": []
                                                                                        },
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "label": "sink_id",
                                                                                            "start_token": 1572,
                                                                                            "end_token": 1572,
                                                                                            "children": []
                                                                                        }
                                                                                    ]
                                                                                }
                                                                            ]
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                }
                                            ]
                                        },
                                        {
                                            "type": "comment",
                                            "label": "# Reassign User IDs for agent blocks",
                                            "start_token": 1576,
                                            "end_token": 1582,
                                            "children": []
                                        },
                                        {
                                            "type": "for_statement",
                                            "label": "for node in self.nodes:\n            if node.block_id != AgentExecutorBlock().id:\n                continue\n            node.input_default[\"user_id\"] = user_id\n            node.input_default.setdefault(\"data\", {})",
                                            "start_token": 1584,
                                            "end_token": 1626,
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "label": "node",
                                                    "start_token": 1585,
                                                    "end_token": 1585,
                                                    "children": []
                                                },
                                                {
                                                    "type": "attribute",
                                                    "label": "self.nodes",
                                                    "start_token": 1587,
                                                    "end_token": 1589,
                                                    "children": [
                                                        {
                                                            "type": "identifier",
                                                            "label": "self",
                                                            "start_token": 1587,
                                                            "end_token": 1587,
                                                            "children": []
                                                        },
                                                        {
                                                            "type": "identifier",
                                                            "label": "nodes",
                                                            "start_token": 1589,
                                                            "end_token": 1589,
                                                            "children": []
                                                        }
                                                    ]
                                                },
                                                {
                                                    "type": "block",
                                                    "label": "if node.block_id != AgentExecutorBlock().id:\n                continue\n            node.input_default[\"user_id\"] = user_id\n            node.input_default.setdefault(\"data\", {})",
                                                    "start_token": 1592,
                                                    "end_token": 1626,
                                                    "children": [
                                                        {
                                                            "type": "if_statement",
                                                            "label": "if node.block_id != AgentExecutorBlock().id:\n                continue",
                                                            "start_token": 1592,
                                                            "end_token": 1605,
                                                            "children": [
                                                                {
                                                                    "type": "comparison_operator",
                                                                    "label": "node.block_id != AgentExecutorBlock().id",
                                                                    "start_token": 1593,
                                                                    "end_token": 1602,
                                                                    "children": [
                                                                        {
                                                                            "type": "attribute",
                                                                            "label": "node.block_id",
                                                                            "start_token": 1593,
                                                                            "end_token": 1595,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "node",
                                                                                    "start_token": 1593,
                                                                                    "end_token": 1593,
                                                                                    "children": []
                                                                                },
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "block_id",
                                                                                    "start_token": 1595,
                                                                                    "end_token": 1595,
                                                                                    "children": []
                                                                                }
                                                                            ]
                                                                        },
                                                                        {
                                                                            "type": "attribute",
                                                                            "label": "AgentExecutorBlock().id",
                                                                            "start_token": 1598,
                                                                            "end_token": 1602,
                                                                            "children": [
                                                                                {
                                                                                    "type": "call",
                                                                                    "label": "AgentExecutorBlock()",
                                                                                    "start_token": 1598,
                                                                                    "end_token": 1600,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "label": "AgentExecutorBlock",
                                                                                            "start_token": 1598,
                                                                                            "end_token": 1598,
                                                                                            "children": []
                                                                                        },
                                                                                        {
                                                                                            "type": "argument_list",
                                                                                            "label": "()",
                                                                                            "start_token": 1599,
                                                                                            "end_token": 1600,
                                                                                            "children": []
                                                                                        }
                                                                                    ]
                                                                                },
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "id",
                                                                                    "start_token": 1602,
                                                                                    "end_token": 1602,
                                                                                    "children": []
                                                                                }
                                                                            ]
                                                                        }
                                                                    ]
                                                                },
                                                                {
                                                                    "type": "block",
                                                                    "label": "continue",
                                                                    "start_token": 1605,
                                                                    "end_token": 1605,
                                                                    "children": [
                                                                        {
                                                                            "type": "continue_statement",
                                                                            "label": "continue",
                                                                            "start_token": 1605,
                                                                            "end_token": 1605,
                                                                            "children": []
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        },
                                                        {
                                                            "type": "expression_statement",
                                                            "label": "node.input_default[\"user_id\"] = user_id",
                                                            "start_token": 1607,
                                                            "end_token": 1614,
                                                            "children": [
                                                                {
                                                                    "type": "assignment",
                                                                    "label": "node.input_default[\"user_id\"] = user_id",
                                                                    "start_token": 1607,
                                                                    "end_token": 1614,
                                                                    "children": [
                                                                        {
                                                                            "type": "subscript",
                                                                            "label": "node.input_default[\"user_id\"]",
                                                                            "start_token": 1607,
                                                                            "end_token": 1612,
                                                                            "children": [
                                                                                {
                                                                                    "type": "attribute",
                                                                                    "label": "node.input_default",
                                                                                    "start_token": 1607,
                                                                                    "end_token": 1609,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "label": "node",
                                                                                            "start_token": 1607,
                                                                                            "end_token": 1607,
                                                                                            "children": []
                                                                                        },
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "label": "input_default",
                                                                                            "start_token": 1609,
                                                                                            "end_token": 1609,
                                                                                            "children": []
                                                                                        }
                                                                                    ]
                                                                                },
                                                                                {
                                                                                    "type": "string",
                                                                                    "label": "\"user_id\"",
                                                                                    "start_token": 1611,
                                                                                    "end_token": 1611,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "string_start",
                                                                                            "label": "\"",
                                                                                            "start_token": 1611,
                                                                                            "end_token": 1611,
                                                                                            "children": []
                                                                                        },
                                                                                        {
                                                                                            "type": "string_content",
                                                                                            "label": "user_id",
                                                                                            "start_token": 1611,
                                                                                            "end_token": 1611,
                                                                                            "children": []
                                                                                        },
                                                                                        {
                                                                                            "type": "string_end",
                                                                                            "label": "\"",
                                                                                            "start_token": 1611,
                                                                                            "end_token": 1611,
                                                                                            "children": []
                                                                                        }
                                                                                    ]
                                                                                }
                                                                            ]
                                                                        },
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "user_id",
                                                                            "start_token": 1614,
                                                                            "end_token": 1614,
                                                                            "children": []
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        },
                                                        {
                                                            "type": "expression_statement",
                                                            "label": "node.input_default.setdefault(\"data\", {})",
                                                            "start_token": 1616,
                                                            "end_token": 1626,
                                                            "children": [
                                                                {
                                                                    "type": "call",
                                                                    "label": "node.input_default.setdefault(\"data\", {})",
                                                                    "start_token": 1616,
                                                                    "end_token": 1626,
                                                                    "children": [
                                                                        {
                                                                            "type": "attribute",
                                                                            "label": "node.input_default.setdefault",
                                                                            "start_token": 1616,
                                                                            "end_token": 1620,
                                                                            "children": [
                                                                                {
                                                                                    "type": "attribute",
                                                                                    "label": "node.input_default",
                                                                                    "start_token": 1616,
                                                                                    "end_token": 1618,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "label": "node",
                                                                                            "start_token": 1616,
                                                                                            "end_token": 1616,
                                                                                            "children": []
                                                                                        },
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "label": "input_default",
                                                                                            "start_token": 1618,
                                                                                            "end_token": 1618,
                                                                                            "children": []
                                                                                        }
                                                                                    ]
                                                                                },
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "setdefault",
                                                                                    "start_token": 1620,
                                                                                    "end_token": 1620,
                                                                                    "children": []
                                                                                }
                                                                            ]
                                                                        },
                                                                        {
                                                                            "type": "argument_list",
                                                                            "label": "(\"data\", {})",
                                                                            "start_token": 1621,
                                                                            "end_token": 1626,
                                                                            "children": [
                                                                                {
                                                                                    "type": "string",
                                                                                    "label": "\"data\"",
                                                                                    "start_token": 1622,
                                                                                    "end_token": 1622,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "string_start",
                                                                                            "label": "\"",
                                                                                            "start_token": 1622,
                                                                                            "end_token": 1622,
                                                                                            "children": []
                                                                                        },
                                                                                        {
                                                                                            "type": "string_content",
                                                                                            "label": "data",
                                                                                            "start_token": 1622,
                                                                                            "end_token": 1622,
                                                                                            "children": []
                                                                                        },
                                                                                        {
                                                                                            "type": "string_end",
                                                                                            "label": "\"",
                                                                                            "start_token": 1622,
                                                                                            "end_token": 1622,
                                                                                            "children": []
                                                                                        }
                                                                                    ]
                                                                                },
                                                                                {
                                                                                    "type": "dictionary",
                                                                                    "label": "{}",
                                                                                    "start_token": 1624,
                                                                                    "end_token": 1625,
                                                                                    "children": []
                                                                                }
                                                                            ]
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                }
                                            ]
                                        },
                                        {
                                            "type": "expression_statement",
                                            "label": "self.validate_graph()",
                                            "start_token": 1629,
                                            "end_token": 1633,
                                            "children": [
                                                {
                                                    "type": "call",
                                                    "label": "self.validate_graph()",
                                                    "start_token": 1629,
                                                    "end_token": 1633,
                                                    "children": [
                                                        {
                                                            "type": "attribute",
                                                            "label": "self.validate_graph",
                                                            "start_token": 1629,
                                                            "end_token": 1631,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "label": "self",
                                                                    "start_token": 1629,
                                                                    "end_token": 1629,
                                                                    "children": []
                                                                },
                                                                {
                                                                    "type": "identifier",
                                                                    "label": "validate_graph",
                                                                    "start_token": 1631,
                                                                    "end_token": 1631,
                                                                    "children": []
                                                                }
                                                            ]
                                                        },
                                                        {
                                                            "type": "argument_list",
                                                            "label": "()",
                                                            "start_token": 1632,
                                                            "end_token": 1633,
                                                            "children": []
                                                        }
                                                    ]
                                                }
                                            ]
                                        }
                                    ]
                                }
                            ]
                        },
                        {
                            "type": "function_definition",
                            "label": "def validate_graph(self, for_run: bool = False):\n        def sanitize(name):\n            return name.split(\"_#_\")[0].split(\"_@_\")[0].split(\"_$_\")[0]\n\n        input_links = defaultdict(list)\n        for link in self.links:\n            input_links[link.sink_id].append(link)\n\n        # Nodes: required fields are filled or connected and dependencies are satisfied\n        for node in self.nodes:\n            block = get_block(node.block_id)\n            if block is None:\n                raise ValueError(f\"Invalid block {node.block_id} for node #{node.id}\")\n\n            provided_inputs = set(\n                [sanitize(name) for name in node.input_default]\n                + [sanitize(link.sink_name) for link in input_links.get(node.id, [])]\n            )\n            for name in block.input_schema.get_required_fields():\n                if (\n                    name not in provided_inputs\n                    and not (\n                        name == \"payload\"\n                        and block.block_type\n                        in (BlockType.WEBHOOK, BlockType.WEBHOOK_MANUAL)\n                    )\n                    and (\n                        for_run  # Skip input completion validation, unless when executing.\n                        or block.block_type == BlockType.INPUT\n                        or block.block_type == BlockType.OUTPUT\n                        or block.block_type == BlockType.AGENT\n                    )\n                ):\n                    raise ValueError(\n                        f\"Node {block.name} #{node.id} required input missing: `{name}`\"\n                    )\n\n            # Get input schema properties and check dependencies\n            input_schema = block.input_schema.model_fields\n            required_fields = block.input_schema.get_required_fields()\n\n            def has_value(name):\n                return (\n                    node is not None\n                    and name in node.input_default\n                    and node.input_default[name] is not None\n                    and str(node.input_default[name]).strip() != \"\"\n                ) or (name in input_schema and input_schema[name].default is not None)\n\n            # Validate dependencies between fields\n            for field_name, field_info in input_schema.items():\n                # Apply input dependency validation only on run & field with depends_on\n                json_schema_extra = field_info.json_schema_extra or {}\n                dependencies = json_schema_extra.get(\"depends_on\", [])\n                if not for_run or not dependencies:\n                    continue\n\n                # Check if dependent field has value in input_default\n                field_has_value = has_value(field_name)\n                field_is_required = field_name in required_fields\n\n                # Check for missing dependencies when dependent field is present\n                missing_deps = [dep for dep in dependencies if not has_value(dep)]\n                if missing_deps and (field_has_value or field_is_required):\n                    raise ValueError(\n                        f\"Node {block.name} #{node.id}: Field `{field_name}` requires [{', '.join(missing_deps)}] to be set\"\n                    )\n\n        node_map = {v.id: v for v in self.nodes}\n\n        def is_static_output_block(nid: str) -> bool:\n            bid = node_map[nid].block_id\n            b = get_block(bid)\n            return b.static_output if b else False\n\n        # Links: links are connected and the connected pin data type are compatible.\n        for link in self.links:\n            source = (link.source_id, link.source_name)\n            sink = (link.sink_id, link.sink_name)\n            suffix = f\"Link {source} <-> {sink}\"\n\n            for i, (node_id, name) in enumerate([source, sink]):\n                node = node_map.get(node_id)\n                if not node:\n                    raise ValueError(\n                        f\"{suffix}, {node_id} is invalid node id, available nodes: {node_map.keys()}\"\n                    )\n\n                block = get_block(node.block_id)\n                if not block:\n                    blocks = {v().id: v().name for v in get_blocks().values()}\n                    raise ValueError(\n                        f\"{suffix}, {node.block_id} is invalid block id, available blocks: {blocks}\"\n                    )\n\n                sanitized_name = sanitize(name)\n                vals = node.input_default\n                if i == 0:\n                    fields = (\n                        block.output_schema.get_fields()\n                        if block.block_type != BlockType.AGENT\n                        else vals.get(\"output_schema\", {}).get(\"properties\", {}).keys()\n                    )\n                else:\n                    fields = (\n                        block.input_schema.get_fields()\n                        if block.block_type != BlockType.AGENT\n                        else vals.get(\"input_schema\", {}).get(\"properties\", {}).keys()\n                    )\n                if sanitized_name not in fields:\n                    fields_msg = f\"Allowed fields: {fields}\"\n                    raise ValueError(f\"{suffix}, `{name}` invalid, {fields_msg}\")\n\n            if is_static_output_block(link.source_id):\n                link.is_static = True  # Each value block output should be static.",
                            "start_token": 1636,
                            "end_token": 2501,
                            "children": [
                                {
                                    "type": "identifier",
                                    "label": "validate_graph",
                                    "start_token": 1637,
                                    "end_token": 1637,
                                    "children": []
                                },
                                {
                                    "type": "parameters",
                                    "label": "(self, for_run: bool = False)",
                                    "start_token": 1638,
                                    "end_token": 1646,
                                    "children": [
                                        {
                                            "type": "identifier",
                                            "label": "self",
                                            "start_token": 1639,
                                            "end_token": 1639,
                                            "children": []
                                        },
                                        {
                                            "type": "typed_default_parameter",
                                            "label": "for_run: bool = False",
                                            "start_token": 1641,
                                            "end_token": 1645,
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "label": "for_run",
                                                    "start_token": 1641,
                                                    "end_token": 1641,
                                                    "children": []
                                                },
                                                {
                                                    "type": "type",
                                                    "label": "bool",
                                                    "start_token": 1643,
                                                    "end_token": 1643,
                                                    "children": [
                                                        {
                                                            "type": "identifier",
                                                            "label": "bool",
                                                            "start_token": 1643,
                                                            "end_token": 1643,
                                                            "children": []
                                                        }
                                                    ]
                                                },
                                                {
                                                    "type": "false",
                                                    "label": "False",
                                                    "start_token": 1645,
                                                    "end_token": 1645,
                                                    "children": []
                                                }
                                            ]
                                        }
                                    ]
                                },
                                {
                                    "type": "block",
                                    "label": "def sanitize(name):\n            return name.split(\"_#_\")[0].split(\"_@_\")[0].split(\"_$_\")[0]\n\n        input_links = defaultdict(list)\n        for link in self.links:\n            input_links[link.sink_id].append(link)\n\n        # Nodes: required fields are filled or connected and dependencies are satisfied\n        for node in self.nodes:\n            block = get_block(node.block_id)\n            if block is None:\n                raise ValueError(f\"Invalid block {node.block_id} for node #{node.id}\")\n\n            provided_inputs = set(\n                [sanitize(name) for name in node.input_default]\n                + [sanitize(link.sink_name) for link in input_links.get(node.id, [])]\n            )\n            for name in block.input_schema.get_required_fields():\n                if (\n                    name not in provided_inputs\n                    and not (\n                        name == \"payload\"\n                        and block.block_type\n                        in (BlockType.WEBHOOK, BlockType.WEBHOOK_MANUAL)\n                    )\n                    and (\n                        for_run  # Skip input completion validation, unless when executing.\n                        or block.block_type == BlockType.INPUT\n                        or block.block_type == BlockType.OUTPUT\n                        or block.block_type == BlockType.AGENT\n                    )\n                ):\n                    raise ValueError(\n                        f\"Node {block.name} #{node.id} required input missing: `{name}`\"\n                    )\n\n            # Get input schema properties and check dependencies\n            input_schema = block.input_schema.model_fields\n            required_fields = block.input_schema.get_required_fields()\n\n            def has_value(name):\n                return (\n                    node is not None\n                    and name in node.input_default\n                    and node.input_default[name] is not None\n                    and str(node.input_default[name]).strip() != \"\"\n                ) or (name in input_schema and input_schema[name].default is not None)\n\n            # Validate dependencies between fields\n            for field_name, field_info in input_schema.items():\n                # Apply input dependency validation only on run & field with depends_on\n                json_schema_extra = field_info.json_schema_extra or {}\n                dependencies = json_schema_extra.get(\"depends_on\", [])\n                if not for_run or not dependencies:\n                    continue\n\n                # Check if dependent field has value in input_default\n                field_has_value = has_value(field_name)\n                field_is_required = field_name in required_fields\n\n                # Check for missing dependencies when dependent field is present\n                missing_deps = [dep for dep in dependencies if not has_value(dep)]\n                if missing_deps and (field_has_value or field_is_required):\n                    raise ValueError(\n                        f\"Node {block.name} #{node.id}: Field `{field_name}` requires [{', '.join(missing_deps)}] to be set\"\n                    )\n\n        node_map = {v.id: v for v in self.nodes}\n\n        def is_static_output_block(nid: str) -> bool:\n            bid = node_map[nid].block_id\n            b = get_block(bid)\n            return b.static_output if b else False\n\n        # Links: links are connected and the connected pin data type are compatible.\n        for link in self.links:\n            source = (link.source_id, link.source_name)\n            sink = (link.sink_id, link.sink_name)\n            suffix = f\"Link {source} <-> {sink}\"\n\n            for i, (node_id, name) in enumerate([source, sink]):\n                node = node_map.get(node_id)\n                if not node:\n                    raise ValueError(\n                        f\"{suffix}, {node_id} is invalid node id, available nodes: {node_map.keys()}\"\n                    )\n\n                block = get_block(node.block_id)\n                if not block:\n                    blocks = {v().id: v().name for v in get_blocks().values()}\n                    raise ValueError(\n                        f\"{suffix}, {node.block_id} is invalid block id, available blocks: {blocks}\"\n                    )\n\n                sanitized_name = sanitize(name)\n                vals = node.input_default\n                if i == 0:\n                    fields = (\n                        block.output_schema.get_fields()\n                        if block.block_type != BlockType.AGENT\n                        else vals.get(\"output_schema\", {}).get(\"properties\", {}).keys()\n                    )\n                else:\n                    fields = (\n                        block.input_schema.get_fields()\n                        if block.block_type != BlockType.AGENT\n                        else vals.get(\"input_schema\", {}).get(\"properties\", {}).keys()\n                    )\n                if sanitized_name not in fields:\n                    fields_msg = f\"Allowed fields: {fields}\"\n                    raise ValueError(f\"{suffix}, `{name}` invalid, {fields_msg}\")\n\n            if is_static_output_block(link.source_id):\n                link.is_static = True  # Each value block output should be static.",
                                    "start_token": 1649,
                                    "end_token": 2501,
                                    "children": [
                                        {
                                            "type": "function_definition",
                                            "label": "def sanitize(name):\n            return name.split(\"_#_\")[0].split(\"_@_\")[0].split(\"_$_\")[0]",
                                            "start_token": 1649,
                                            "end_token": 1681,
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "label": "sanitize",
                                                    "start_token": 1650,
                                                    "end_token": 1650,
                                                    "children": []
                                                },
                                                {
                                                    "type": "parameters",
                                                    "label": "(name)",
                                                    "start_token": 1651,
                                                    "end_token": 1653,
                                                    "children": [
                                                        {
                                                            "type": "identifier",
                                                            "label": "name",
                                                            "start_token": 1652,
                                                            "end_token": 1652,
                                                            "children": []
                                                        }
                                                    ]
                                                },
                                                {
                                                    "type": "block",
                                                    "label": "return name.split(\"_#_\")[0].split(\"_@_\")[0].split(\"_$_\")[0]",
                                                    "start_token": 1656,
                                                    "end_token": 1681,
                                                    "children": [
                                                        {
                                                            "type": "return_statement",
                                                            "label": "return name.split(\"_#_\")[0].split(\"_@_\")[0].split(\"_$_\")[0]",
                                                            "start_token": 1656,
                                                            "end_token": 1681,
                                                            "children": [
                                                                {
                                                                    "type": "subscript",
                                                                    "label": "name.split(\"_#_\")[0].split(\"_@_\")[0].split(\"_$_\")[0]",
                                                                    "start_token": 1657,
                                                                    "end_token": 1681,
                                                                    "children": [
                                                                        {
                                                                            "type": "call",
                                                                            "label": "name.split(\"_#_\")[0].split(\"_@_\")[0].split(\"_$_\")",
                                                                            "start_token": 1657,
                                                                            "end_token": 1678,
                                                                            "children": [
                                                                                {
                                                                                    "type": "attribute",
                                                                                    "label": "name.split(\"_#_\")[0].split(\"_@_\")[0].split",
                                                                                    "start_token": 1657,
                                                                                    "end_token": 1675,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "subscript",
                                                                                            "label": "name.split(\"_#_\")[0].split(\"_@_\")[0]",
                                                                                            "start_token": 1657,
                                                                                            "end_token": 1673,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "call",
                                                                                                    "label": "name.split(\"_#_\")[0].split(\"_@_\")",
                                                                                                    "start_token": 1657,
                                                                                                    "end_token": 1670,
                                                                                                    "children": [
                                                                                                        {
                                                                                                            "type": "attribute",
                                                                                                            "label": "name.split(\"_#_\")[0].split",
                                                                                                            "start_token": 1657,
                                                                                                            "end_token": 1667,
                                                                                                            "children": [
                                                                                                                {
                                                                                                                    "type": "subscript",
                                                                                                                    "label": "name.split(\"_#_\")[0]",
                                                                                                                    "start_token": 1657,
                                                                                                                    "end_token": 1665,
                                                                                                                    "children": [
                                                                                                                        {
                                                                                                                            "type": "call",
                                                                                                                            "label": "name.split(\"_#_\")",
                                                                                                                            "start_token": 1657,
                                                                                                                            "end_token": 1662,
                                                                                                                            "children": [
                                                                                                                                {
                                                                                                                                    "type": "attribute",
                                                                                                                                    "label": "name.split",
                                                                                                                                    "start_token": 1657,
                                                                                                                                    "end_token": 1659,
                                                                                                                                    "children": [
                                                                                                                                        {
                                                                                                                                            "type": "identifier",
                                                                                                                                            "label": "name",
                                                                                                                                            "start_token": 1657,
                                                                                                                                            "end_token": 1657,
                                                                                                                                            "children": []
                                                                                                                                        },
                                                                                                                                        {
                                                                                                                                            "type": "identifier",
                                                                                                                                            "label": "split",
                                                                                                                                            "start_token": 1659,
                                                                                                                                            "end_token": 1659,
                                                                                                                                            "children": []
                                                                                                                                        }
                                                                                                                                    ]
                                                                                                                                },
                                                                                                                                {
                                                                                                                                    "type": "argument_list",
                                                                                                                                    "label": "(\"_#_\")",
                                                                                                                                    "start_token": 1660,
                                                                                                                                    "end_token": 1662,
                                                                                                                                    "children": [
                                                                                                                                        {
                                                                                                                                            "type": "string",
                                                                                                                                            "label": "\"_#_\"",
                                                                                                                                            "start_token": 1661,
                                                                                                                                            "end_token": 1661,
                                                                                                                                            "children": [
                                                                                                                                                {
                                                                                                                                                    "type": "string_start",
                                                                                                                                                    "label": "\"",
                                                                                                                                                    "start_token": 1661,
                                                                                                                                                    "end_token": 1661,
                                                                                                                                                    "children": []
                                                                                                                                                },
                                                                                                                                                {
                                                                                                                                                    "type": "string_content",
                                                                                                                                                    "label": "_#_",
                                                                                                                                                    "start_token": 1661,
                                                                                                                                                    "end_token": 1661,
                                                                                                                                                    "children": []
                                                                                                                                                },
                                                                                                                                                {
                                                                                                                                                    "type": "string_end",
                                                                                                                                                    "label": "\"",
                                                                                                                                                    "start_token": 1661,
                                                                                                                                                    "end_token": 1661,
                                                                                                                                                    "children": []
                                                                                                                                                }
                                                                                                                                            ]
                                                                                                                                        }
                                                                                                                                    ]
                                                                                                                                }
                                                                                                                            ]
                                                                                                                        },
                                                                                                                        {
                                                                                                                            "type": "integer",
                                                                                                                            "label": "0",
                                                                                                                            "start_token": 1664,
                                                                                                                            "end_token": 1664,
                                                                                                                            "children": []
                                                                                                                        }
                                                                                                                    ]
                                                                                                                },
                                                                                                                {
                                                                                                                    "type": "identifier",
                                                                                                                    "label": "split",
                                                                                                                    "start_token": 1667,
                                                                                                                    "end_token": 1667,
                                                                                                                    "children": []
                                                                                                                }
                                                                                                            ]
                                                                                                        },
                                                                                                        {
                                                                                                            "type": "argument_list",
                                                                                                            "label": "(\"_@_\")",
                                                                                                            "start_token": 1668,
                                                                                                            "end_token": 1670,
                                                                                                            "children": [
                                                                                                                {
                                                                                                                    "type": "string",
                                                                                                                    "label": "\"_@_\"",
                                                                                                                    "start_token": 1669,
                                                                                                                    "end_token": 1669,
                                                                                                                    "children": [
                                                                                                                        {
                                                                                                                            "type": "string_start",
                                                                                                                            "label": "\"",
                                                                                                                            "start_token": 1669,
                                                                                                                            "end_token": 1669,
                                                                                                                            "children": []
                                                                                                                        },
                                                                                                                        {
                                                                                                                            "type": "string_content",
                                                                                                                            "label": "_@_",
                                                                                                                            "start_token": 1669,
                                                                                                                            "end_token": 1669,
                                                                                                                            "children": []
                                                                                                                        },
                                                                                                                        {
                                                                                                                            "type": "string_end",
                                                                                                                            "label": "\"",
                                                                                                                            "start_token": 1669,
                                                                                                                            "end_token": 1669,
                                                                                                                            "children": []
                                                                                                                        }
                                                                                                                    ]
                                                                                                                }
                                                                                                            ]
                                                                                                        }
                                                                                                    ]
                                                                                                },
                                                                                                {
                                                                                                    "type": "integer",
                                                                                                    "label": "0",
                                                                                                    "start_token": 1672,
                                                                                                    "end_token": 1672,
                                                                                                    "children": []
                                                                                                }
                                                                                            ]
                                                                                        },
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "label": "split",
                                                                                            "start_token": 1675,
                                                                                            "end_token": 1675,
                                                                                            "children": []
                                                                                        }
                                                                                    ]
                                                                                },
                                                                                {
                                                                                    "type": "argument_list",
                                                                                    "label": "(\"_$_\")",
                                                                                    "start_token": 1676,
                                                                                    "end_token": 1678,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "string",
                                                                                            "label": "\"_$_\"",
                                                                                            "start_token": 1677,
                                                                                            "end_token": 1677,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "string_start",
                                                                                                    "label": "\"",
                                                                                                    "start_token": 1677,
                                                                                                    "end_token": 1677,
                                                                                                    "children": []
                                                                                                },
                                                                                                {
                                                                                                    "type": "string_content",
                                                                                                    "label": "_$_",
                                                                                                    "start_token": 1677,
                                                                                                    "end_token": 1677,
                                                                                                    "children": []
                                                                                                },
                                                                                                {
                                                                                                    "type": "string_end",
                                                                                                    "label": "\"",
                                                                                                    "start_token": 1677,
                                                                                                    "end_token": 1677,
                                                                                                    "children": []
                                                                                                }
                                                                                            ]
                                                                                        }
                                                                                    ]
                                                                                }
                                                                            ]
                                                                        },
                                                                        {
                                                                            "type": "integer",
                                                                            "label": "0",
                                                                            "start_token": 1680,
                                                                            "end_token": 1680,
                                                                            "children": []
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                }
                                            ]
                                        },
                                        {
                                            "type": "expression_statement",
                                            "label": "input_links = defaultdict(list)",
                                            "start_token": 1684,
                                            "end_token": 1689,
                                            "children": [
                                                {
                                                    "type": "assignment",
                                                    "label": "input_links = defaultdict(list)",
                                                    "start_token": 1684,
                                                    "end_token": 1689,
                                                    "children": [
                                                        {
                                                            "type": "identifier",
                                                            "label": "input_links",
                                                            "start_token": 1684,
                                                            "end_token": 1684,
                                                            "children": []
                                                        },
                                                        {
                                                            "type": "call",
                                                            "label": "defaultdict(list)",
                                                            "start_token": 1686,
                                                            "end_token": 1689,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "label": "defaultdict",
                                                                    "start_token": 1686,
                                                                    "end_token": 1686,
                                                                    "children": []
                                                                },
                                                                {
                                                                    "type": "argument_list",
                                                                    "label": "(list)",
                                                                    "start_token": 1687,
                                                                    "end_token": 1689,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "list",
                                                                            "start_token": 1688,
                                                                            "end_token": 1688,
                                                                            "children": []
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                }
                                            ]
                                        },
                                        {
                                            "type": "for_statement",
                                            "label": "for link in self.links:\n            input_links[link.sink_id].append(link)",
                                            "start_token": 1691,
                                            "end_token": 1709,
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "label": "link",
                                                    "start_token": 1692,
                                                    "end_token": 1692,
                                                    "children": []
                                                },
                                                {
                                                    "type": "attribute",
                                                    "label": "self.links",
                                                    "start_token": 1694,
                                                    "end_token": 1696,
                                                    "children": [
                                                        {
                                                            "type": "identifier",
                                                            "label": "self",
                                                            "start_token": 1694,
                                                            "end_token": 1694,
                                                            "children": []
                                                        },
                                                        {
                                                            "type": "identifier",
                                                            "label": "links",
                                                            "start_token": 1696,
                                                            "end_token": 1696,
                                                            "children": []
                                                        }
                                                    ]
                                                },
                                                {
                                                    "type": "block",
                                                    "label": "input_links[link.sink_id].append(link)",
                                                    "start_token": 1699,
                                                    "end_token": 1709,
                                                    "children": [
                                                        {
                                                            "type": "expression_statement",
                                                            "label": "input_links[link.sink_id].append(link)",
                                                            "start_token": 1699,
                                                            "end_token": 1709,
                                                            "children": [
                                                                {
                                                                    "type": "call",
                                                                    "label": "input_links[link.sink_id].append(link)",
                                                                    "start_token": 1699,
                                                                    "end_token": 1709,
                                                                    "children": [
                                                                        {
                                                                            "type": "attribute",
                                                                            "label": "input_links[link.sink_id].append",
                                                                            "start_token": 1699,
                                                                            "end_token": 1706,
                                                                            "children": [
                                                                                {
                                                                                    "type": "subscript",
                                                                                    "label": "input_links[link.sink_id]",
                                                                                    "start_token": 1699,
                                                                                    "end_token": 1704,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "label": "input_links",
                                                                                            "start_token": 1699,
                                                                                            "end_token": 1699,
                                                                                            "children": []
                                                                                        },
                                                                                        {
                                                                                            "type": "attribute",
                                                                                            "label": "link.sink_id",
                                                                                            "start_token": 1701,
                                                                                            "end_token": 1703,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "label": "link",
                                                                                                    "start_token": 1701,
                                                                                                    "end_token": 1701,
                                                                                                    "children": []
                                                                                                },
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "label": "sink_id",
                                                                                                    "start_token": 1703,
                                                                                                    "end_token": 1703,
                                                                                                    "children": []
                                                                                                }
                                                                                            ]
                                                                                        }
                                                                                    ]
                                                                                },
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "append",
                                                                                    "start_token": 1706,
                                                                                    "end_token": 1706,
                                                                                    "children": []
                                                                                }
                                                                            ]
                                                                        },
                                                                        {
                                                                            "type": "argument_list",
                                                                            "label": "(link)",
                                                                            "start_token": 1707,
                                                                            "end_token": 1709,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "link",
                                                                                    "start_token": 1708,
                                                                                    "end_token": 1708,
                                                                                    "children": []
                                                                                }
                                                                            ]
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                }
                                            ]
                                        },
                                        {
                                            "type": "comment",
                                            "label": "# Nodes: required fields are filled or connected and dependencies are satisfied",
                                            "start_token": 1712,
                                            "end_token": 1724,
                                            "children": []
                                        },
                                        {
                                            "type": "for_statement",
                                            "label": "for node in self.nodes:\n            block = get_block(node.block_id)\n            if block is None:\n                raise ValueError(f\"Invalid block {node.block_id} for node #{node.id}\")\n\n            provided_inputs = set(\n                [sanitize(name) for name in node.input_default]\n                + [sanitize(link.sink_name) for link in input_links.get(node.id, [])]\n            )\n            for name in block.input_schema.get_required_fields():\n                if (\n                    name not in provided_inputs\n                    and not (\n                        name == \"payload\"\n                        and block.block_type\n                        in (BlockType.WEBHOOK, BlockType.WEBHOOK_MANUAL)\n                    )\n                    and (\n                        for_run  # Skip input completion validation, unless when executing.\n                        or block.block_type == BlockType.INPUT\n                        or block.block_type == BlockType.OUTPUT\n                        or block.block_type == BlockType.AGENT\n                    )\n                ):\n                    raise ValueError(\n                        f\"Node {block.name} #{node.id} required input missing: `{name}`\"\n                    )\n\n            # Get input schema properties and check dependencies\n            input_schema = block.input_schema.model_fields\n            required_fields = block.input_schema.get_required_fields()\n\n            def has_value(name):\n                return (\n                    node is not None\n                    and name in node.input_default\n                    and node.input_default[name] is not None\n                    and str(node.input_default[name]).strip() != \"\"\n                ) or (name in input_schema and input_schema[name].default is not None)\n\n            # Validate dependencies between fields\n            for field_name, field_info in input_schema.items():\n                # Apply input dependency validation only on run & field with depends_on\n                json_schema_extra = field_info.json_schema_extra or {}\n                dependencies = json_schema_extra.get(\"depends_on\", [])\n                if not for_run or not dependencies:\n                    continue\n\n                # Check if dependent field has value in input_default\n                field_has_value = has_value(field_name)\n                field_is_required = field_name in required_fields\n\n                # Check for missing dependencies when dependent field is present\n                missing_deps = [dep for dep in dependencies if not has_value(dep)]\n                if missing_deps and (field_has_value or field_is_required):\n                    raise ValueError(\n                        f\"Node {block.name} #{node.id}: Field `{field_name}` requires [{', '.join(missing_deps)}] to be set\"\n                    )",
                                            "start_token": 1726,
                                            "end_token": 2137,
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "label": "node",
                                                    "start_token": 1727,
                                                    "end_token": 1727,
                                                    "children": []
                                                },
                                                {
                                                    "type": "attribute",
                                                    "label": "self.nodes",
                                                    "start_token": 1729,
                                                    "end_token": 1731,
                                                    "children": [
                                                        {
                                                            "type": "identifier",
                                                            "label": "self",
                                                            "start_token": 1729,
                                                            "end_token": 1729,
                                                            "children": []
                                                        },
                                                        {
                                                            "type": "identifier",
                                                            "label": "nodes",
                                                            "start_token": 1731,
                                                            "end_token": 1731,
                                                            "children": []
                                                        }
                                                    ]
                                                },
                                                {
                                                    "type": "block",
                                                    "label": "block = get_block(node.block_id)\n            if block is None:\n                raise ValueError(f\"Invalid block {node.block_id} for node #{node.id}\")\n\n            provided_inputs = set(\n                [sanitize(name) for name in node.input_default]\n                + [sanitize(link.sink_name) for link in input_links.get(node.id, [])]\n            )\n            for name in block.input_schema.get_required_fields():\n                if (\n                    name not in provided_inputs\n                    and not (\n                        name == \"payload\"\n                        and block.block_type\n                        in (BlockType.WEBHOOK, BlockType.WEBHOOK_MANUAL)\n                    )\n                    and (\n                        for_run  # Skip input completion validation, unless when executing.\n                        or block.block_type == BlockType.INPUT\n                        or block.block_type == BlockType.OUTPUT\n                        or block.block_type == BlockType.AGENT\n                    )\n                ):\n                    raise ValueError(\n                        f\"Node {block.name} #{node.id} required input missing: `{name}`\"\n                    )\n\n            # Get input schema properties and check dependencies\n            input_schema = block.input_schema.model_fields\n            required_fields = block.input_schema.get_required_fields()\n\n            def has_value(name):\n                return (\n                    node is not None\n                    and name in node.input_default\n                    and node.input_default[name] is not None\n                    and str(node.input_default[name]).strip() != \"\"\n                ) or (name in input_schema and input_schema[name].default is not None)\n\n            # Validate dependencies between fields\n            for field_name, field_info in input_schema.items():\n                # Apply input dependency validation only on run & field with depends_on\n                json_schema_extra = field_info.json_schema_extra or {}\n                dependencies = json_schema_extra.get(\"depends_on\", [])\n                if not for_run or not dependencies:\n                    continue\n\n                # Check if dependent field has value in input_default\n                field_has_value = has_value(field_name)\n                field_is_required = field_name in required_fields\n\n                # Check for missing dependencies when dependent field is present\n                missing_deps = [dep for dep in dependencies if not has_value(dep)]\n                if missing_deps and (field_has_value or field_is_required):\n                    raise ValueError(\n                        f\"Node {block.name} #{node.id}: Field `{field_name}` requires [{', '.join(missing_deps)}] to be set\"\n                    )",
                                                    "start_token": 1734,
                                                    "end_token": 2137,
                                                    "children": [
                                                        {
                                                            "type": "expression_statement",
                                                            "label": "block = get_block(node.block_id)",
                                                            "start_token": 1734,
                                                            "end_token": 1741,
                                                            "children": [
                                                                {
                                                                    "type": "assignment",
                                                                    "label": "block = get_block(node.block_id)",
                                                                    "start_token": 1734,
                                                                    "end_token": 1741,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "block",
                                                                            "start_token": 1734,
                                                                            "end_token": 1734,
                                                                            "children": []
                                                                        },
                                                                        {
                                                                            "type": "call",
                                                                            "label": "get_block(node.block_id)",
                                                                            "start_token": 1736,
                                                                            "end_token": 1741,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "get_block",
                                                                                    "start_token": 1736,
                                                                                    "end_token": 1736,
                                                                                    "children": []
                                                                                },
                                                                                {
                                                                                    "type": "argument_list",
                                                                                    "label": "(node.block_id)",
                                                                                    "start_token": 1737,
                                                                                    "end_token": 1741,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "attribute",
                                                                                            "label": "node.block_id",
                                                                                            "start_token": 1738,
                                                                                            "end_token": 1740,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "label": "node",
                                                                                                    "start_token": 1738,
                                                                                                    "end_token": 1738,
                                                                                                    "children": []
                                                                                                },
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "label": "block_id",
                                                                                                    "start_token": 1740,
                                                                                                    "end_token": 1740,
                                                                                                    "children": []
                                                                                                }
                                                                                            ]
                                                                                        }
                                                                                    ]
                                                                                }
                                                                            ]
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        },
                                                        {
                                                            "type": "if_statement",
                                                            "label": "if block is None:\n                raise ValueError(f\"Invalid block {node.block_id} for node #{node.id}\")",
                                                            "start_token": 1743,
                                                            "end_token": 1754,
                                                            "children": [
                                                                {
                                                                    "type": "comparison_operator",
                                                                    "label": "block is None",
                                                                    "start_token": 1744,
                                                                    "end_token": 1746,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "block",
                                                                            "start_token": 1744,
                                                                            "end_token": 1744,
                                                                            "children": []
                                                                        },
                                                                        {
                                                                            "type": "none",
                                                                            "label": "None",
                                                                            "start_token": 1746,
                                                                            "end_token": 1746,
                                                                            "children": []
                                                                        }
                                                                    ]
                                                                },
                                                                {
                                                                    "type": "block",
                                                                    "label": "raise ValueError(f\"Invalid block {node.block_id} for node #{node.id}\")",
                                                                    "start_token": 1749,
                                                                    "end_token": 1754,
                                                                    "children": [
                                                                        {
                                                                            "type": "raise_statement",
                                                                            "label": "raise ValueError(f\"Invalid block {node.block_id} for node #{node.id}\")",
                                                                            "start_token": 1749,
                                                                            "end_token": 1754,
                                                                            "children": [
                                                                                {
                                                                                    "type": "call",
                                                                                    "label": "ValueError(f\"Invalid block {node.block_id} for node #{node.id}\")",
                                                                                    "start_token": 1750,
                                                                                    "end_token": 1754,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "label": "ValueError",
                                                                                            "start_token": 1750,
                                                                                            "end_token": 1750,
                                                                                            "children": []
                                                                                        },
                                                                                        {
                                                                                            "type": "argument_list",
                                                                                            "label": "(f\"Invalid block {node.block_id} for node #{node.id}\")",
                                                                                            "start_token": 1751,
                                                                                            "end_token": 1754,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "string",
                                                                                                    "label": "f\"Invalid block {node.block_id} for node #{node.id}\"",
                                                                                                    "start_token": 1752,
                                                                                                    "end_token": 1753,
                                                                                                    "children": [
                                                                                                        {
                                                                                                            "type": "string_start",
                                                                                                            "label": "f\"",
                                                                                                            "start_token": 1752,
                                                                                                            "end_token": 1753,
                                                                                                            "children": []
                                                                                                        },
                                                                                                        {
                                                                                                            "type": "string_content",
                                                                                                            "label": "Invalid block ",
                                                                                                            "start_token": 1753,
                                                                                                            "end_token": 1753,
                                                                                                            "children": []
                                                                                                        },
                                                                                                        {
                                                                                                            "type": "interpolation",
                                                                                                            "label": "{node.block_id}",
                                                                                                            "start_token": 1753,
                                                                                                            "end_token": 1753,
                                                                                                            "children": [
                                                                                                                {
                                                                                                                    "type": "attribute",
                                                                                                                    "label": "node.block_id",
                                                                                                                    "start_token": 1753,
                                                                                                                    "end_token": 1753,
                                                                                                                    "children": [
                                                                                                                        {
                                                                                                                            "type": "identifier",
                                                                                                                            "label": "node",
                                                                                                                            "start_token": 1753,
                                                                                                                            "end_token": 1753,
                                                                                                                            "children": []
                                                                                                                        },
                                                                                                                        {
                                                                                                                            "type": "identifier",
                                                                                                                            "label": "block_id",
                                                                                                                            "start_token": 1753,
                                                                                                                            "end_token": 1753,
                                                                                                                            "children": []
                                                                                                                        }
                                                                                                                    ]
                                                                                                                }
                                                                                                            ]
                                                                                                        },
                                                                                                        {
                                                                                                            "type": "string_content",
                                                                                                            "label": " for node #",
                                                                                                            "start_token": 1753,
                                                                                                            "end_token": 1753,
                                                                                                            "children": []
                                                                                                        },
                                                                                                        {
                                                                                                            "type": "interpolation",
                                                                                                            "label": "{node.id}",
                                                                                                            "start_token": 1753,
                                                                                                            "end_token": 1753,
                                                                                                            "children": [
                                                                                                                {
                                                                                                                    "type": "attribute",
                                                                                                                    "label": "node.id",
                                                                                                                    "start_token": 1753,
                                                                                                                    "end_token": 1753,
                                                                                                                    "children": [
                                                                                                                        {
                                                                                                                            "type": "identifier",
                                                                                                                            "label": "node",
                                                                                                                            "start_token": 1753,
                                                                                                                            "end_token": 1753,
                                                                                                                            "children": []
                                                                                                                        },
                                                                                                                        {
                                                                                                                            "type": "identifier",
                                                                                                                            "label": "id",
                                                                                                                            "start_token": 1753,
                                                                                                                            "end_token": 1753,
                                                                                                                            "children": []
                                                                                                                        }
                                                                                                                    ]
                                                                                                                }
                                                                                                            ]
                                                                                                        },
                                                                                                        {
                                                                                                            "type": "string_end",
                                                                                                            "label": "\"",
                                                                                                            "start_token": 1753,
                                                                                                            "end_token": 1753,
                                                                                                            "children": []
                                                                                                        }
                                                                                                    ]
                                                                                                }
                                                                                            ]
                                                                                        }
                                                                                    ]
                                                                                }
                                                                            ]
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        },
                                                        {
                                                            "type": "expression_statement",
                                                            "label": "provided_inputs = set(\n                [sanitize(name) for name in node.input_default]\n                + [sanitize(link.sink_name) for link in input_links.get(node.id, [])]\n            )",
                                                            "start_token": 1757,
                                                            "end_token": 1799,
                                                            "children": [
                                                                {
                                                                    "type": "assignment",
                                                                    "label": "provided_inputs = set(\n                [sanitize(name) for name in node.input_default]\n                + [sanitize(link.sink_name) for link in input_links.get(node.id, [])]\n            )",
                                                                    "start_token": 1757,
                                                                    "end_token": 1799,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "provided_inputs",
                                                                            "start_token": 1757,
                                                                            "end_token": 1757,
                                                                            "children": []
                                                                        },
                                                                        {
                                                                            "type": "call",
                                                                            "label": "set(\n                [sanitize(name) for name in node.input_default]\n                + [sanitize(link.sink_name) for link in input_links.get(node.id, [])]\n            )",
                                                                            "start_token": 1759,
                                                                            "end_token": 1799,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "set",
                                                                                    "start_token": 1759,
                                                                                    "end_token": 1759,
                                                                                    "children": []
                                                                                },
                                                                                {
                                                                                    "type": "argument_list",
                                                                                    "label": "(\n                [sanitize(name) for name in node.input_default]\n                + [sanitize(link.sink_name) for link in input_links.get(node.id, [])]\n            )",
                                                                                    "start_token": 1760,
                                                                                    "end_token": 1799,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "binary_operator",
                                                                                            "label": "[sanitize(name) for name in node.input_default]\n                + [sanitize(link.sink_name) for link in input_links.get(node.id, [])]",
                                                                                            "start_token": 1762,
                                                                                            "end_token": 1797,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "list_comprehension",
                                                                                                    "label": "[sanitize(name) for name in node.input_default]",
                                                                                                    "start_token": 1762,
                                                                                                    "end_token": 1773,
                                                                                                    "children": [
                                                                                                        {
                                                                                                            "type": "call",
                                                                                                            "label": "sanitize(name)",
                                                                                                            "start_token": 1763,
                                                                                                            "end_token": 1766,
                                                                                                            "children": [
                                                                                                                {
                                                                                                                    "type": "identifier",
                                                                                                                    "label": "sanitize",
                                                                                                                    "start_token": 1763,
                                                                                                                    "end_token": 1763,
                                                                                                                    "children": []
                                                                                                                },
                                                                                                                {
                                                                                                                    "type": "argument_list",
                                                                                                                    "label": "(name)",
                                                                                                                    "start_token": 1764,
                                                                                                                    "end_token": 1766,
                                                                                                                    "children": [
                                                                                                                        {
                                                                                                                            "type": "identifier",
                                                                                                                            "label": "name",
                                                                                                                            "start_token": 1765,
                                                                                                                            "end_token": 1765,
                                                                                                                            "children": []
                                                                                                                        }
                                                                                                                    ]
                                                                                                                }
                                                                                                            ]
                                                                                                        },
                                                                                                        {
                                                                                                            "type": "for_in_clause",
                                                                                                            "label": "for name in node.input_default",
                                                                                                            "start_token": 1767,
                                                                                                            "end_token": 1772,
                                                                                                            "children": [
                                                                                                                {
                                                                                                                    "type": "identifier",
                                                                                                                    "label": "name",
                                                                                                                    "start_token": 1768,
                                                                                                                    "end_token": 1768,
                                                                                                                    "children": []
                                                                                                                },
                                                                                                                {
                                                                                                                    "type": "attribute",
                                                                                                                    "label": "node.input_default",
                                                                                                                    "start_token": 1770,
                                                                                                                    "end_token": 1772,
                                                                                                                    "children": [
                                                                                                                        {
                                                                                                                            "type": "identifier",
                                                                                                                            "label": "node",
                                                                                                                            "start_token": 1770,
                                                                                                                            "end_token": 1770,
                                                                                                                            "children": []
                                                                                                                        },
                                                                                                                        {
                                                                                                                            "type": "identifier",
                                                                                                                            "label": "input_default",
                                                                                                                            "start_token": 1772,
                                                                                                                            "end_token": 1772,
                                                                                                                            "children": []
                                                                                                                        }
                                                                                                                    ]
                                                                                                                }
                                                                                                            ]
                                                                                                        }
                                                                                                    ]
                                                                                                },
                                                                                                {
                                                                                                    "type": "list_comprehension",
                                                                                                    "label": "[sanitize(link.sink_name) for link in input_links.get(node.id, [])]",
                                                                                                    "start_token": 1776,
                                                                                                    "end_token": 1797,
                                                                                                    "children": [
                                                                                                        {
                                                                                                            "type": "call",
                                                                                                            "label": "sanitize(link.sink_name)",
                                                                                                            "start_token": 1777,
                                                                                                            "end_token": 1782,
                                                                                                            "children": [
                                                                                                                {
                                                                                                                    "type": "identifier",
                                                                                                                    "label": "sanitize",
                                                                                                                    "start_token": 1777,
                                                                                                                    "end_token": 1777,
                                                                                                                    "children": []
                                                                                                                },
                                                                                                                {
                                                                                                                    "type": "argument_list",
                                                                                                                    "label": "(link.sink_name)",
                                                                                                                    "start_token": 1778,
                                                                                                                    "end_token": 1782,
                                                                                                                    "children": [
                                                                                                                        {
                                                                                                                            "type": "attribute",
                                                                                                                            "label": "link.sink_name",
                                                                                                                            "start_token": 1779,
                                                                                                                            "end_token": 1781,
                                                                                                                            "children": [
                                                                                                                                {
                                                                                                                                    "type": "identifier",
                                                                                                                                    "label": "link",
                                                                                                                                    "start_token": 1779,
                                                                                                                                    "end_token": 1779,
                                                                                                                                    "children": []
                                                                                                                                },
                                                                                                                                {
                                                                                                                                    "type": "identifier",
                                                                                                                                    "label": "sink_name",
                                                                                                                                    "start_token": 1781,
                                                                                                                                    "end_token": 1781,
                                                                                                                                    "children": []
                                                                                                                                }
                                                                                                                            ]
                                                                                                                        }
                                                                                                                    ]
                                                                                                                }
                                                                                                            ]
                                                                                                        },
                                                                                                        {
                                                                                                            "type": "for_in_clause",
                                                                                                            "label": "for link in input_links.get(node.id, [])",
                                                                                                            "start_token": 1783,
                                                                                                            "end_token": 1796,
                                                                                                            "children": [
                                                                                                                {
                                                                                                                    "type": "identifier",
                                                                                                                    "label": "link",
                                                                                                                    "start_token": 1784,
                                                                                                                    "end_token": 1784,
                                                                                                                    "children": []
                                                                                                                },
                                                                                                                {
                                                                                                                    "type": "call",
                                                                                                                    "label": "input_links.get(node.id, [])",
                                                                                                                    "start_token": 1786,
                                                                                                                    "end_token": 1796,
                                                                                                                    "children": [
                                                                                                                        {
                                                                                                                            "type": "attribute",
                                                                                                                            "label": "input_links.get",
                                                                                                                            "start_token": 1786,
                                                                                                                            "end_token": 1788,
                                                                                                                            "children": [
                                                                                                                                {
                                                                                                                                    "type": "identifier",
                                                                                                                                    "label": "input_links",
                                                                                                                                    "start_token": 1786,
                                                                                                                                    "end_token": 1786,
                                                                                                                                    "children": []
                                                                                                                                },
                                                                                                                                {
                                                                                                                                    "type": "identifier",
                                                                                                                                    "label": "get",
                                                                                                                                    "start_token": 1788,
                                                                                                                                    "end_token": 1788,
                                                                                                                                    "children": []
                                                                                                                                }
                                                                                                                            ]
                                                                                                                        },
                                                                                                                        {
                                                                                                                            "type": "argument_list",
                                                                                                                            "label": "(node.id, [])",
                                                                                                                            "start_token": 1789,
                                                                                                                            "end_token": 1796,
                                                                                                                            "children": [
                                                                                                                                {
                                                                                                                                    "type": "attribute",
                                                                                                                                    "label": "node.id",
                                                                                                                                    "start_token": 1790,
                                                                                                                                    "end_token": 1792,
                                                                                                                                    "children": [
                                                                                                                                        {
                                                                                                                                            "type": "identifier",
                                                                                                                                            "label": "node",
                                                                                                                                            "start_token": 1790,
                                                                                                                                            "end_token": 1790,
                                                                                                                                            "children": []
                                                                                                                                        },
                                                                                                                                        {
                                                                                                                                            "type": "identifier",
                                                                                                                                            "label": "id",
                                                                                                                                            "start_token": 1792,
                                                                                                                                            "end_token": 1792,
                                                                                                                                            "children": []
                                                                                                                                        }
                                                                                                                                    ]
                                                                                                                                },
                                                                                                                                {
                                                                                                                                    "type": "list",
                                                                                                                                    "label": "[]",
                                                                                                                                    "start_token": 1794,
                                                                                                                                    "end_token": 1795,
                                                                                                                                    "children": []
                                                                                                                                }
                                                                                                                            ]
                                                                                                                        }
                                                                                                                    ]
                                                                                                                }
                                                                                                            ]
                                                                                                        }
                                                                                                    ]
                                                                                                }
                                                                                            ]
                                                                                        }
                                                                                    ]
                                                                                }
                                                                            ]
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        },
                                                        {
                                                            "type": "for_statement",
                                                            "label": "for name in block.input_schema.get_required_fields():\n                if (\n                    name not in provided_inputs\n                    and not (\n                        name == \"payload\"\n                        and block.block_type\n                        in (BlockType.WEBHOOK, BlockType.WEBHOOK_MANUAL)\n                    )\n                    and (\n                        for_run  # Skip input completion validation, unless when executing.\n                        or block.block_type == BlockType.INPUT\n                        or block.block_type == BlockType.OUTPUT\n                        or block.block_type == BlockType.AGENT\n                    )\n                ):\n                    raise ValueError(\n                        f\"Node {block.name} #{node.id} required input missing: `{name}`\"\n                    )",
                                                            "start_token": 1801,
                                                            "end_token": 1905,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "label": "name",
                                                                    "start_token": 1802,
                                                                    "end_token": 1802,
                                                                    "children": []
                                                                },
                                                                {
                                                                    "type": "call",
                                                                    "label": "block.input_schema.get_required_fields()",
                                                                    "start_token": 1804,
                                                                    "end_token": 1810,
                                                                    "children": [
                                                                        {
                                                                            "type": "attribute",
                                                                            "label": "block.input_schema.get_required_fields",
                                                                            "start_token": 1804,
                                                                            "end_token": 1808,
                                                                            "children": [
                                                                                {
                                                                                    "type": "attribute",
                                                                                    "label": "block.input_schema",
                                                                                    "start_token": 1804,
                                                                                    "end_token": 1806,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "label": "block",
                                                                                            "start_token": 1804,
                                                                                            "end_token": 1804,
                                                                                            "children": []
                                                                                        },
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "label": "input_schema",
                                                                                            "start_token": 1806,
                                                                                            "end_token": 1806,
                                                                                            "children": []
                                                                                        }
                                                                                    ]
                                                                                },
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "get_required_fields",
                                                                                    "start_token": 1808,
                                                                                    "end_token": 1808,
                                                                                    "children": []
                                                                                }
                                                                            ]
                                                                        },
                                                                        {
                                                                            "type": "argument_list",
                                                                            "label": "()",
                                                                            "start_token": 1809,
                                                                            "end_token": 1810,
                                                                            "children": []
                                                                        }
                                                                    ]
                                                                },
                                                                {
                                                                    "type": "block",
                                                                    "label": "if (\n                    name not in provided_inputs\n                    and not (\n                        name == \"payload\"\n                        and block.block_type\n                        in (BlockType.WEBHOOK, BlockType.WEBHOOK_MANUAL)\n                    )\n                    and (\n                        for_run  # Skip input completion validation, unless when executing.\n                        or block.block_type == BlockType.INPUT\n                        or block.block_type == BlockType.OUTPUT\n                        or block.block_type == BlockType.AGENT\n                    )\n                ):\n                    raise ValueError(\n                        f\"Node {block.name} #{node.id} required input missing: `{name}`\"\n                    )",
                                                                    "start_token": 1813,
                                                                    "end_token": 1905,
                                                                    "children": [
                                                                        {
                                                                            "type": "if_statement",
                                                                            "label": "if (\n                    name not in provided_inputs\n                    and not (\n                        name == \"payload\"\n                        and block.block_type\n                        in (BlockType.WEBHOOK, BlockType.WEBHOOK_MANUAL)\n                    )\n                    and (\n                        for_run  # Skip input completion validation, unless when executing.\n                        or block.block_type == BlockType.INPUT\n                        or block.block_type == BlockType.OUTPUT\n                        or block.block_type == BlockType.AGENT\n                    )\n                ):\n                    raise ValueError(\n                        f\"Node {block.name} #{node.id} required input missing: `{name}`\"\n                    )",
                                                                            "start_token": 1813,
                                                                            "end_token": 1905,
                                                                            "children": [
                                                                                {
                                                                                    "type": "parenthesized_expression",
                                                                                    "label": "(\n                    name not in provided_inputs\n                    and not (\n                        name == \"payload\"\n                        and block.block_type\n                        in (BlockType.WEBHOOK, BlockType.WEBHOOK_MANUAL)\n                    )\n                    and (\n                        for_run  # Skip input completion validation, unless when executing.\n                        or block.block_type == BlockType.INPUT\n                        or block.block_type == BlockType.OUTPUT\n                        or block.block_type == BlockType.AGENT\n                    )\n                )",
                                                                                    "start_token": 1814,
                                                                                    "end_token": 1895,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "boolean_operator",
                                                                                            "label": "name not in provided_inputs\n                    and not (\n                        name == \"payload\"\n                        and block.block_type\n                        in (BlockType.WEBHOOK, BlockType.WEBHOOK_MANUAL)\n                    )\n                    and (\n                        for_run  # Skip input completion validation, unless when executing.\n                        or block.block_type == BlockType.INPUT\n                        or block.block_type == BlockType.OUTPUT\n                        or block.block_type == BlockType.AGENT\n                    )",
                                                                                            "start_token": 1816,
                                                                                            "end_token": 1893,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "boolean_operator",
                                                                                                    "label": "name not in provided_inputs\n                    and not (\n                        name == \"payload\"\n                        and block.block_type\n                        in (BlockType.WEBHOOK, BlockType.WEBHOOK_MANUAL)\n                    )",
                                                                                                    "start_token": 1816,
                                                                                                    "end_token": 1846,
                                                                                                    "children": [
                                                                                                        {
                                                                                                            "type": "comparison_operator",
                                                                                                            "label": "name not in provided_inputs",
                                                                                                            "start_token": 1816,
                                                                                                            "end_token": 1819,
                                                                                                            "children": [
                                                                                                                {
                                                                                                                    "type": "identifier",
                                                                                                                    "label": "name",
                                                                                                                    "start_token": 1816,
                                                                                                                    "end_token": 1816,
                                                                                                                    "children": []
                                                                                                                },
                                                                                                                {
                                                                                                                    "type": "identifier",
                                                                                                                    "label": "provided_inputs",
                                                                                                                    "start_token": 1819,
                                                                                                                    "end_token": 1819,
                                                                                                                    "children": []
                                                                                                                }
                                                                                                            ]
                                                                                                        },
                                                                                                        {
                                                                                                            "type": "not_operator",
                                                                                                            "label": "not (\n                        name == \"payload\"\n                        and block.block_type\n                        in (BlockType.WEBHOOK, BlockType.WEBHOOK_MANUAL)\n                    )",
                                                                                                            "start_token": 1822,
                                                                                                            "end_token": 1846,
                                                                                                            "children": [
                                                                                                                {
                                                                                                                    "type": "parenthesized_expression",
                                                                                                                    "label": "(\n                        name == \"payload\"\n                        and block.block_type\n                        in (BlockType.WEBHOOK, BlockType.WEBHOOK_MANUAL)\n                    )",
                                                                                                                    "start_token": 1823,
                                                                                                                    "end_token": 1846,
                                                                                                                    "children": [
                                                                                                                        {
                                                                                                                            "type": "boolean_operator",
                                                                                                                            "label": "name == \"payload\"\n                        and block.block_type\n                        in (BlockType.WEBHOOK, BlockType.WEBHOOK_MANUAL)",
                                                                                                                            "start_token": 1825,
                                                                                                                            "end_token": 1844,
                                                                                                                            "children": [
                                                                                                                                {
                                                                                                                                    "type": "comparison_operator",
                                                                                                                                    "label": "name == \"payload\"",
                                                                                                                                    "start_token": 1825,
                                                                                                                                    "end_token": 1828,
                                                                                                                                    "children": [
                                                                                                                                        {
                                                                                                                                            "type": "identifier",
                                                                                                                                            "label": "name",
                                                                                                                                            "start_token": 1825,
                                                                                                                                            "end_token": 1825,
                                                                                                                                            "children": []
                                                                                                                                        },
                                                                                                                                        {
                                                                                                                                            "type": "string",
                                                                                                                                            "label": "\"payload\"",
                                                                                                                                            "start_token": 1828,
                                                                                                                                            "end_token": 1828,
                                                                                                                                            "children": [
                                                                                                                                                {
                                                                                                                                                    "type": "string_start",
                                                                                                                                                    "label": "\"",
                                                                                                                                                    "start_token": 1828,
                                                                                                                                                    "end_token": 1828,
                                                                                                                                                    "children": []
                                                                                                                                                },
                                                                                                                                                {
                                                                                                                                                    "type": "string_content",
                                                                                                                                                    "label": "payload",
                                                                                                                                                    "start_token": 1828,
                                                                                                                                                    "end_token": 1828,
                                                                                                                                                    "children": []
                                                                                                                                                },
                                                                                                                                                {
                                                                                                                                                    "type": "string_end",
                                                                                                                                                    "label": "\"",
                                                                                                                                                    "start_token": 1828,
                                                                                                                                                    "end_token": 1828,
                                                                                                                                                    "children": []
                                                                                                                                                }
                                                                                                                                            ]
                                                                                                                                        }
                                                                                                                                    ]
                                                                                                                                },
                                                                                                                                {
                                                                                                                                    "type": "comparison_operator",
                                                                                                                                    "label": "block.block_type\n                        in (BlockType.WEBHOOK, BlockType.WEBHOOK_MANUAL)",
                                                                                                                                    "start_token": 1831,
                                                                                                                                    "end_token": 1844,
                                                                                                                                    "children": [
                                                                                                                                        {
                                                                                                                                            "type": "attribute",
                                                                                                                                            "label": "block.block_type",
                                                                                                                                            "start_token": 1831,
                                                                                                                                            "end_token": 1833,
                                                                                                                                            "children": [
                                                                                                                                                {
                                                                                                                                                    "type": "identifier",
                                                                                                                                                    "label": "block",
                                                                                                                                                    "start_token": 1831,
                                                                                                                                                    "end_token": 1831,
                                                                                                                                                    "children": []
                                                                                                                                                },
                                                                                                                                                {
                                                                                                                                                    "type": "identifier",
                                                                                                                                                    "label": "block_type",
                                                                                                                                                    "start_token": 1833,
                                                                                                                                                    "end_token": 1833,
                                                                                                                                                    "children": []
                                                                                                                                                }
                                                                                                                                            ]
                                                                                                                                        },
                                                                                                                                        {
                                                                                                                                            "type": "tuple",
                                                                                                                                            "label": "(BlockType.WEBHOOK, BlockType.WEBHOOK_MANUAL)",
                                                                                                                                            "start_token": 1836,
                                                                                                                                            "end_token": 1844,
                                                                                                                                            "children": [
                                                                                                                                                {
                                                                                                                                                    "type": "attribute",
                                                                                                                                                    "label": "BlockType.WEBHOOK",
                                                                                                                                                    "start_token": 1837,
                                                                                                                                                    "end_token": 1839,
                                                                                                                                                    "children": [
                                                                                                                                                        {
                                                                                                                                                            "type": "identifier",
                                                                                                                                                            "label": "BlockType",
                                                                                                                                                            "start_token": 1837,
                                                                                                                                                            "end_token": 1837,
                                                                                                                                                            "children": []
                                                                                                                                                        },
                                                                                                                                                        {
                                                                                                                                                            "type": "identifier",
                                                                                                                                                            "label": "WEBHOOK",
                                                                                                                                                            "start_token": 1839,
                                                                                                                                                            "end_token": 1839,
                                                                                                                                                            "children": []
                                                                                                                                                        }
                                                                                                                                                    ]
                                                                                                                                                },
                                                                                                                                                {
                                                                                                                                                    "type": "attribute",
                                                                                                                                                    "label": "BlockType.WEBHOOK_MANUAL",
                                                                                                                                                    "start_token": 1841,
                                                                                                                                                    "end_token": 1843,
                                                                                                                                                    "children": [
                                                                                                                                                        {
                                                                                                                                                            "type": "identifier",
                                                                                                                                                            "label": "BlockType",
                                                                                                                                                            "start_token": 1841,
                                                                                                                                                            "end_token": 1841,
                                                                                                                                                            "children": []
                                                                                                                                                        },
                                                                                                                                                        {
                                                                                                                                                            "type": "identifier",
                                                                                                                                                            "label": "WEBHOOK_MANUAL",
                                                                                                                                                            "start_token": 1843,
                                                                                                                                                            "end_token": 1843,
                                                                                                                                                            "children": []
                                                                                                                                                        }
                                                                                                                                                    ]
                                                                                                                                                }
                                                                                                                                            ]
                                                                                                                                        }
                                                                                                                                    ]
                                                                                                                                }
                                                                                                                            ]
                                                                                                                        }
                                                                                                                    ]
                                                                                                                }
                                                                                                            ]
                                                                                                        }
                                                                                                    ]
                                                                                                },
                                                                                                {
                                                                                                    "type": "parenthesized_expression",
                                                                                                    "label": "(\n                        for_run  # Skip input completion validation, unless when executing.\n                        or block.block_type == BlockType.INPUT\n                        or block.block_type == BlockType.OUTPUT\n                        or block.block_type == BlockType.AGENT\n                    )",
                                                                                                    "start_token": 1849,
                                                                                                    "end_token": 1893,
                                                                                                    "children": [
                                                                                                        {
                                                                                                            "type": "boolean_operator",
                                                                                                            "label": "for_run  # Skip input completion validation, unless when executing.\n                        or block.block_type == BlockType.INPUT\n                        or block.block_type == BlockType.OUTPUT\n                        or block.block_type == BlockType.AGENT",
                                                                                                            "start_token": 1851,
                                                                                                            "end_token": 1891,
                                                                                                            "children": [
                                                                                                                {
                                                                                                                    "type": "boolean_operator",
                                                                                                                    "label": "for_run  # Skip input completion validation, unless when executing.\n                        or block.block_type == BlockType.INPUT\n                        or block.block_type == BlockType.OUTPUT",
                                                                                                                    "start_token": 1851,
                                                                                                                    "end_token": 1881,
                                                                                                                    "children": [
                                                                                                                        {
                                                                                                                            "type": "boolean_operator",
                                                                                                                            "label": "for_run  # Skip input completion validation, unless when executing.\n                        or block.block_type == BlockType.INPUT",
                                                                                                                            "start_token": 1851,
                                                                                                                            "end_token": 1871,
                                                                                                                            "children": [
                                                                                                                                {
                                                                                                                                    "type": "identifier",
                                                                                                                                    "label": "for_run",
                                                                                                                                    "start_token": 1851,
                                                                                                                                    "end_token": 1851,
                                                                                                                                    "children": []
                                                                                                                                },
                                                                                                                                {
                                                                                                                                    "type": "comment",
                                                                                                                                    "label": "# Skip input completion validation, unless when executing.",
                                                                                                                                    "start_token": 1852,
                                                                                                                                    "end_token": 1861,
                                                                                                                                    "children": []
                                                                                                                                },
                                                                                                                                {
                                                                                                                                    "type": "comparison_operator",
                                                                                                                                    "label": "block.block_type == BlockType.INPUT",
                                                                                                                                    "start_token": 1864,
                                                                                                                                    "end_token": 1871,
                                                                                                                                    "children": [
                                                                                                                                        {
                                                                                                                                            "type": "attribute",
                                                                                                                                            "label": "block.block_type",
                                                                                                                                            "start_token": 1864,
                                                                                                                                            "end_token": 1866,
                                                                                                                                            "children": [
                                                                                                                                                {
                                                                                                                                                    "type": "identifier",
                                                                                                                                                    "label": "block",
                                                                                                                                                    "start_token": 1864,
                                                                                                                                                    "end_token": 1864,
                                                                                                                                                    "children": []
                                                                                                                                                },
                                                                                                                                                {
                                                                                                                                                    "type": "identifier",
                                                                                                                                                    "label": "block_type",
                                                                                                                                                    "start_token": 1866,
                                                                                                                                                    "end_token": 1866,
                                                                                                                                                    "children": []
                                                                                                                                                }
                                                                                                                                            ]
                                                                                                                                        },
                                                                                                                                        {
                                                                                                                                            "type": "attribute",
                                                                                                                                            "label": "BlockType.INPUT",
                                                                                                                                            "start_token": 1869,
                                                                                                                                            "end_token": 1871,
                                                                                                                                            "children": [
                                                                                                                                                {
                                                                                                                                                    "type": "identifier",
                                                                                                                                                    "label": "BlockType",
                                                                                                                                                    "start_token": 1869,
                                                                                                                                                    "end_token": 1869,
                                                                                                                                                    "children": []
                                                                                                                                                },
                                                                                                                                                {
                                                                                                                                                    "type": "identifier",
                                                                                                                                                    "label": "INPUT",
                                                                                                                                                    "start_token": 1871,
                                                                                                                                                    "end_token": 1871,
                                                                                                                                                    "children": []
                                                                                                                                                }
                                                                                                                                            ]
                                                                                                                                        }
                                                                                                                                    ]
                                                                                                                                }
                                                                                                                            ]
                                                                                                                        },
                                                                                                                        {
                                                                                                                            "type": "comparison_operator",
                                                                                                                            "label": "block.block_type == BlockType.OUTPUT",
                                                                                                                            "start_token": 1874,
                                                                                                                            "end_token": 1881,
                                                                                                                            "children": [
                                                                                                                                {
                                                                                                                                    "type": "attribute",
                                                                                                                                    "label": "block.block_type",
                                                                                                                                    "start_token": 1874,
                                                                                                                                    "end_token": 1876,
                                                                                                                                    "children": [
                                                                                                                                        {
                                                                                                                                            "type": "identifier",
                                                                                                                                            "label": "block",
                                                                                                                                            "start_token": 1874,
                                                                                                                                            "end_token": 1874,
                                                                                                                                            "children": []
                                                                                                                                        },
                                                                                                                                        {
                                                                                                                                            "type": "identifier",
                                                                                                                                            "label": "block_type",
                                                                                                                                            "start_token": 1876,
                                                                                                                                            "end_token": 1876,
                                                                                                                                            "children": []
                                                                                                                                        }
                                                                                                                                    ]
                                                                                                                                },
                                                                                                                                {
                                                                                                                                    "type": "attribute",
                                                                                                                                    "label": "BlockType.OUTPUT",
                                                                                                                                    "start_token": 1879,
                                                                                                                                    "end_token": 1881,
                                                                                                                                    "children": [
                                                                                                                                        {
                                                                                                                                            "type": "identifier",
                                                                                                                                            "label": "BlockType",
                                                                                                                                            "start_token": 1879,
                                                                                                                                            "end_token": 1879,
                                                                                                                                            "children": []
                                                                                                                                        },
                                                                                                                                        {
                                                                                                                                            "type": "identifier",
                                                                                                                                            "label": "OUTPUT",
                                                                                                                                            "start_token": 1881,
                                                                                                                                            "end_token": 1881,
                                                                                                                                            "children": []
                                                                                                                                        }
                                                                                                                                    ]
                                                                                                                                }
                                                                                                                            ]
                                                                                                                        }
                                                                                                                    ]
                                                                                                                },
                                                                                                                {
                                                                                                                    "type": "comparison_operator",
                                                                                                                    "label": "block.block_type == BlockType.AGENT",
                                                                                                                    "start_token": 1884,
                                                                                                                    "end_token": 1891,
                                                                                                                    "children": [
                                                                                                                        {
                                                                                                                            "type": "attribute",
                                                                                                                            "label": "block.block_type",
                                                                                                                            "start_token": 1884,
                                                                                                                            "end_token": 1886,
                                                                                                                            "children": [
                                                                                                                                {
                                                                                                                                    "type": "identifier",
                                                                                                                                    "label": "block",
                                                                                                                                    "start_token": 1884,
                                                                                                                                    "end_token": 1884,
                                                                                                                                    "children": []
                                                                                                                                },
                                                                                                                                {
                                                                                                                                    "type": "identifier",
                                                                                                                                    "label": "block_type",
                                                                                                                                    "start_token": 1886,
                                                                                                                                    "end_token": 1886,
                                                                                                                                    "children": []
                                                                                                                                }
                                                                                                                            ]
                                                                                                                        },
                                                                                                                        {
                                                                                                                            "type": "attribute",
                                                                                                                            "label": "BlockType.AGENT",
                                                                                                                            "start_token": 1889,
                                                                                                                            "end_token": 1891,
                                                                                                                            "children": [
                                                                                                                                {
                                                                                                                                    "type": "identifier",
                                                                                                                                    "label": "BlockType",
                                                                                                                                    "start_token": 1889,
                                                                                                                                    "end_token": 1889,
                                                                                                                                    "children": []
                                                                                                                                },
                                                                                                                                {
                                                                                                                                    "type": "identifier",
                                                                                                                                    "label": "AGENT",
                                                                                                                                    "start_token": 1891,
                                                                                                                                    "end_token": 1891,
                                                                                                                                    "children": []
                                                                                                                                }
                                                                                                                            ]
                                                                                                                        }
                                                                                                                    ]
                                                                                                                }
                                                                                                            ]
                                                                                                        }
                                                                                                    ]
                                                                                                }
                                                                                            ]
                                                                                        }
                                                                                    ]
                                                                                },
                                                                                {
                                                                                    "type": "block",
                                                                                    "label": "raise ValueError(\n                        f\"Node {block.name} #{node.id} required input missing: `{name}`\"\n                    )",
                                                                                    "start_token": 1898,
                                                                                    "end_token": 1905,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "raise_statement",
                                                                                            "label": "raise ValueError(\n                        f\"Node {block.name} #{node.id} required input missing: `{name}`\"\n                    )",
                                                                                            "start_token": 1898,
                                                                                            "end_token": 1905,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "call",
                                                                                                    "label": "ValueError(\n                        f\"Node {block.name} #{node.id} required input missing: `{name}`\"\n                    )",
                                                                                                    "start_token": 1899,
                                                                                                    "end_token": 1905,
                                                                                                    "children": [
                                                                                                        {
                                                                                                            "type": "identifier",
                                                                                                            "label": "ValueError",
                                                                                                            "start_token": 1899,
                                                                                                            "end_token": 1899,
                                                                                                            "children": []
                                                                                                        },
                                                                                                        {
                                                                                                            "type": "argument_list",
                                                                                                            "label": "(\n                        f\"Node {block.name} #{node.id} required input missing: `{name}`\"\n                    )",
                                                                                                            "start_token": 1900,
                                                                                                            "end_token": 1905,
                                                                                                            "children": [
                                                                                                                {
                                                                                                                    "type": "string",
                                                                                                                    "label": "f\"Node {block.name} #{node.id} required input missing: `{name}`\"",
                                                                                                                    "start_token": 1902,
                                                                                                                    "end_token": 1903,
                                                                                                                    "children": [
                                                                                                                        {
                                                                                                                            "type": "string_start",
                                                                                                                            "label": "f\"",
                                                                                                                            "start_token": 1902,
                                                                                                                            "end_token": 1903,
                                                                                                                            "children": []
                                                                                                                        },
                                                                                                                        {
                                                                                                                            "type": "string_content",
                                                                                                                            "label": "Node ",
                                                                                                                            "start_token": 1903,
                                                                                                                            "end_token": 1903,
                                                                                                                            "children": []
                                                                                                                        },
                                                                                                                        {
                                                                                                                            "type": "interpolation",
                                                                                                                            "label": "{block.name}",
                                                                                                                            "start_token": 1903,
                                                                                                                            "end_token": 1903,
                                                                                                                            "children": [
                                                                                                                                {
                                                                                                                                    "type": "attribute",
                                                                                                                                    "label": "block.name",
                                                                                                                                    "start_token": 1903,
                                                                                                                                    "end_token": 1903,
                                                                                                                                    "children": [
                                                                                                                                        {
                                                                                                                                            "type": "identifier",
                                                                                                                                            "label": "block",
                                                                                                                                            "start_token": 1903,
                                                                                                                                            "end_token": 1903,
                                                                                                                                            "children": []
                                                                                                                                        },
                                                                                                                                        {
                                                                                                                                            "type": "identifier",
                                                                                                                                            "label": "name",
                                                                                                                                            "start_token": 1903,
                                                                                                                                            "end_token": 1903,
                                                                                                                                            "children": []
                                                                                                                                        }
                                                                                                                                    ]
                                                                                                                                }
                                                                                                                            ]
                                                                                                                        },
                                                                                                                        {
                                                                                                                            "type": "string_content",
                                                                                                                            "label": " #",
                                                                                                                            "start_token": 1903,
                                                                                                                            "end_token": 1903,
                                                                                                                            "children": []
                                                                                                                        },
                                                                                                                        {
                                                                                                                            "type": "interpolation",
                                                                                                                            "label": "{node.id}",
                                                                                                                            "start_token": 1903,
                                                                                                                            "end_token": 1903,
                                                                                                                            "children": [
                                                                                                                                {
                                                                                                                                    "type": "attribute",
                                                                                                                                    "label": "node.id",
                                                                                                                                    "start_token": 1903,
                                                                                                                                    "end_token": 1903,
                                                                                                                                    "children": [
                                                                                                                                        {
                                                                                                                                            "type": "identifier",
                                                                                                                                            "label": "node",
                                                                                                                                            "start_token": 1903,
                                                                                                                                            "end_token": 1903,
                                                                                                                                            "children": []
                                                                                                                                        },
                                                                                                                                        {
                                                                                                                                            "type": "identifier",
                                                                                                                                            "label": "id",
                                                                                                                                            "start_token": 1903,
                                                                                                                                            "end_token": 1903,
                                                                                                                                            "children": []
                                                                                                                                        }
                                                                                                                                    ]
                                                                                                                                }
                                                                                                                            ]
                                                                                                                        },
                                                                                                                        {
                                                                                                                            "type": "string_content",
                                                                                                                            "label": " required input missing: `",
                                                                                                                            "start_token": 1903,
                                                                                                                            "end_token": 1903,
                                                                                                                            "children": []
                                                                                                                        },
                                                                                                                        {
                                                                                                                            "type": "interpolation",
                                                                                                                            "label": "{name}",
                                                                                                                            "start_token": 1903,
                                                                                                                            "end_token": 1903,
                                                                                                                            "children": [
                                                                                                                                {
                                                                                                                                    "type": "identifier",
                                                                                                                                    "label": "name",
                                                                                                                                    "start_token": 1903,
                                                                                                                                    "end_token": 1903,
                                                                                                                                    "children": []
                                                                                                                                }
                                                                                                                            ]
                                                                                                                        },
                                                                                                                        {
                                                                                                                            "type": "string_content",
                                                                                                                            "label": "`",
                                                                                                                            "start_token": 1903,
                                                                                                                            "end_token": 1903,
                                                                                                                            "children": []
                                                                                                                        },
                                                                                                                        {
                                                                                                                            "type": "string_end",
                                                                                                                            "label": "\"",
                                                                                                                            "start_token": 1903,
                                                                                                                            "end_token": 1903,
                                                                                                                            "children": []
                                                                                                                        }
                                                                                                                    ]
                                                                                                                }
                                                                                                            ]
                                                                                                        }
                                                                                                    ]
                                                                                                }
                                                                                            ]
                                                                                        }
                                                                                    ]
                                                                                }
                                                                            ]
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        },
                                                        {
                                                            "type": "comment",
                                                            "label": "# Get input schema properties and check dependencies",
                                                            "start_token": 1908,
                                                            "end_token": 1915,
                                                            "children": []
                                                        },
                                                        {
                                                            "type": "expression_statement",
                                                            "label": "input_schema = block.input_schema.model_fields",
                                                            "start_token": 1917,
                                                            "end_token": 1923,
                                                            "children": [
                                                                {
                                                                    "type": "assignment",
                                                                    "label": "input_schema = block.input_schema.model_fields",
                                                                    "start_token": 1917,
                                                                    "end_token": 1923,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "input_schema",
                                                                            "start_token": 1917,
                                                                            "end_token": 1917,
                                                                            "children": []
                                                                        },
                                                                        {
                                                                            "type": "attribute",
                                                                            "label": "block.input_schema.model_fields",
                                                                            "start_token": 1919,
                                                                            "end_token": 1923,
                                                                            "children": [
                                                                                {
                                                                                    "type": "attribute",
                                                                                    "label": "block.input_schema",
                                                                                    "start_token": 1919,
                                                                                    "end_token": 1921,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "label": "block",
                                                                                            "start_token": 1919,
                                                                                            "end_token": 1919,
                                                                                            "children": []
                                                                                        },
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "label": "input_schema",
                                                                                            "start_token": 1921,
                                                                                            "end_token": 1921,
                                                                                            "children": []
                                                                                        }
                                                                                    ]
                                                                                },
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "model_fields",
                                                                                    "start_token": 1923,
                                                                                    "end_token": 1923,
                                                                                    "children": []
                                                                                }
                                                                            ]
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        },
                                                        {
                                                            "type": "expression_statement",
                                                            "label": "required_fields = block.input_schema.get_required_fields()",
                                                            "start_token": 1925,
                                                            "end_token": 1933,
                                                            "children": [
                                                                {
                                                                    "type": "assignment",
                                                                    "label": "required_fields = block.input_schema.get_required_fields()",
                                                                    "start_token": 1925,
                                                                    "end_token": 1933,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "required_fields",
                                                                            "start_token": 1925,
                                                                            "end_token": 1925,
                                                                            "children": []
                                                                        },
                                                                        {
                                                                            "type": "call",
                                                                            "label": "block.input_schema.get_required_fields()",
                                                                            "start_token": 1927,
                                                                            "end_token": 1933,
                                                                            "children": [
                                                                                {
                                                                                    "type": "attribute",
                                                                                    "label": "block.input_schema.get_required_fields",
                                                                                    "start_token": 1927,
                                                                                    "end_token": 1931,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "attribute",
                                                                                            "label": "block.input_schema",
                                                                                            "start_token": 1927,
                                                                                            "end_token": 1929,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "label": "block",
                                                                                                    "start_token": 1927,
                                                                                                    "end_token": 1927,
                                                                                                    "children": []
                                                                                                },
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "label": "input_schema",
                                                                                                    "start_token": 1929,
                                                                                                    "end_token": 1929,
                                                                                                    "children": []
                                                                                                }
                                                                                            ]
                                                                                        },
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "label": "get_required_fields",
                                                                                            "start_token": 1931,
                                                                                            "end_token": 1931,
                                                                                            "children": []
                                                                                        }
                                                                                    ]
                                                                                },
                                                                                {
                                                                                    "type": "argument_list",
                                                                                    "label": "()",
                                                                                    "start_token": 1932,
                                                                                    "end_token": 1933,
                                                                                    "children": []
                                                                                }
                                                                            ]
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        },
                                                        {
                                                            "type": "function_definition",
                                                            "label": "def has_value(name):\n                return (\n                    node is not None\n                    and name in node.input_default\n                    and node.input_default[name] is not None\n                    and str(node.input_default[name]).strip() != \"\"\n                ) or (name in input_schema and input_schema[name].default is not None)",
                                                            "start_token": 1936,
                                                            "end_token": 2003,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "label": "has_value",
                                                                    "start_token": 1937,
                                                                    "end_token": 1937,
                                                                    "children": []
                                                                },
                                                                {
                                                                    "type": "parameters",
                                                                    "label": "(name)",
                                                                    "start_token": 1938,
                                                                    "end_token": 1940,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "name",
                                                                            "start_token": 1939,
                                                                            "end_token": 1939,
                                                                            "children": []
                                                                        }
                                                                    ]
                                                                },
                                                                {
                                                                    "type": "block",
                                                                    "label": "return (\n                    node is not None\n                    and name in node.input_default\n                    and node.input_default[name] is not None\n                    and str(node.input_default[name]).strip() != \"\"\n                ) or (name in input_schema and input_schema[name].default is not None)",
                                                                    "start_token": 1943,
                                                                    "end_token": 2003,
                                                                    "children": [
                                                                        {
                                                                            "type": "return_statement",
                                                                            "label": "return (\n                    node is not None\n                    and name in node.input_default\n                    and node.input_default[name] is not None\n                    and str(node.input_default[name]).strip() != \"\"\n                ) or (name in input_schema and input_schema[name].default is not None)",
                                                                            "start_token": 1943,
                                                                            "end_token": 2003,
                                                                            "children": [
                                                                                {
                                                                                    "type": "boolean_operator",
                                                                                    "label": "(\n                    node is not None\n                    and name in node.input_default\n                    and node.input_default[name] is not None\n                    and str(node.input_default[name]).strip() != \"\"\n                ) or (name in input_schema and input_schema[name].default is not None)",
                                                                                    "start_token": 1944,
                                                                                    "end_token": 2003,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "parenthesized_expression",
                                                                                            "label": "(\n                    node is not None\n                    and name in node.input_default\n                    and node.input_default[name] is not None\n                    and str(node.input_default[name]).strip() != \"\"\n                )",
                                                                                            "start_token": 1944,
                                                                                            "end_token": 1987,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "boolean_operator",
                                                                                                    "label": "node is not None\n                    and name in node.input_default\n                    and node.input_default[name] is not None\n                    and str(node.input_default[name]).strip() != \"\"",
                                                                                                    "start_token": 1946,
                                                                                                    "end_token": 1985,
                                                                                                    "children": [
                                                                                                        {
                                                                                                            "type": "boolean_operator",
                                                                                                            "label": "node is not None\n                    and name in node.input_default\n                    and node.input_default[name] is not None",
                                                                                                            "start_token": 1946,
                                                                                                            "end_token": 1967,
                                                                                                            "children": [
                                                                                                                {
                                                                                                                    "type": "boolean_operator",
                                                                                                                    "label": "node is not None\n                    and name in node.input_default",
                                                                                                                    "start_token": 1946,
                                                                                                                    "end_token": 1956,
                                                                                                                    "children": [
                                                                                                                        {
                                                                                                                            "type": "comparison_operator",
                                                                                                                            "label": "node is not None",
                                                                                                                            "start_token": 1946,
                                                                                                                            "end_token": 1949,
                                                                                                                            "children": [
                                                                                                                                {
                                                                                                                                    "type": "identifier",
                                                                                                                                    "label": "node",
                                                                                                                                    "start_token": 1946,
                                                                                                                                    "end_token": 1946,
                                                                                                                                    "children": []
                                                                                                                                },
                                                                                                                                {
                                                                                                                                    "type": "none",
                                                                                                                                    "label": "None",
                                                                                                                                    "start_token": 1949,
                                                                                                                                    "end_token": 1949,
                                                                                                                                    "children": []
                                                                                                                                }
                                                                                                                            ]
                                                                                                                        },
                                                                                                                        {
                                                                                                                            "type": "comparison_operator",
                                                                                                                            "label": "name in node.input_default",
                                                                                                                            "start_token": 1952,
                                                                                                                            "end_token": 1956,
                                                                                                                            "children": [
                                                                                                                                {
                                                                                                                                    "type": "identifier",
                                                                                                                                    "label": "name",
                                                                                                                                    "start_token": 1952,
                                                                                                                                    "end_token": 1952,
                                                                                                                                    "children": []
                                                                                                                                },
                                                                                                                                {
                                                                                                                                    "type": "attribute",
                                                                                                                                    "label": "node.input_default",
                                                                                                                                    "start_token": 1954,
                                                                                                                                    "end_token": 1956,
                                                                                                                                    "children": [
                                                                                                                                        {
                                                                                                                                            "type": "identifier",
                                                                                                                                            "label": "node",
                                                                                                                                            "start_token": 1954,
                                                                                                                                            "end_token": 1954,
                                                                                                                                            "children": []
                                                                                                                                        },
                                                                                                                                        {
                                                                                                                                            "type": "identifier",
                                                                                                                                            "label": "input_default",
                                                                                                                                            "start_token": 1956,
                                                                                                                                            "end_token": 1956,
                                                                                                                                            "children": []
                                                                                                                                        }
                                                                                                                                    ]
                                                                                                                                }
                                                                                                                            ]
                                                                                                                        }
                                                                                                                    ]
                                                                                                                },
                                                                                                                {
                                                                                                                    "type": "comparison_operator",
                                                                                                                    "label": "node.input_default[name] is not None",
                                                                                                                    "start_token": 1959,
                                                                                                                    "end_token": 1967,
                                                                                                                    "children": [
                                                                                                                        {
                                                                                                                            "type": "subscript",
                                                                                                                            "label": "node.input_default[name]",
                                                                                                                            "start_token": 1959,
                                                                                                                            "end_token": 1964,
                                                                                                                            "children": [
                                                                                                                                {
                                                                                                                                    "type": "attribute",
                                                                                                                                    "label": "node.input_default",
                                                                                                                                    "start_token": 1959,
                                                                                                                                    "end_token": 1961,
                                                                                                                                    "children": [
                                                                                                                                        {
                                                                                                                                            "type": "identifier",
                                                                                                                                            "label": "node",
                                                                                                                                            "start_token": 1959,
                                                                                                                                            "end_token": 1959,
                                                                                                                                            "children": []
                                                                                                                                        },
                                                                                                                                        {
                                                                                                                                            "type": "identifier",
                                                                                                                                            "label": "input_default",
                                                                                                                                            "start_token": 1961,
                                                                                                                                            "end_token": 1961,
                                                                                                                                            "children": []
                                                                                                                                        }
                                                                                                                                    ]
                                                                                                                                },
                                                                                                                                {
                                                                                                                                    "type": "identifier",
                                                                                                                                    "label": "name",
                                                                                                                                    "start_token": 1963,
                                                                                                                                    "end_token": 1963,
                                                                                                                                    "children": []
                                                                                                                                }
                                                                                                                            ]
                                                                                                                        },
                                                                                                                        {
                                                                                                                            "type": "none",
                                                                                                                            "label": "None",
                                                                                                                            "start_token": 1967,
                                                                                                                            "end_token": 1967,
                                                                                                                            "children": []
                                                                                                                        }
                                                                                                                    ]
                                                                                                                }
                                                                                                            ]
                                                                                                        },
                                                                                                        {
                                                                                                            "type": "comparison_operator",
                                                                                                            "label": "str(node.input_default[name]).strip() != \"\"",
                                                                                                            "start_token": 1970,
                                                                                                            "end_token": 1985,
                                                                                                            "children": [
                                                                                                                {
                                                                                                                    "type": "call",
                                                                                                                    "label": "str(node.input_default[name]).strip()",
                                                                                                                    "start_token": 1970,
                                                                                                                    "end_token": 1982,
                                                                                                                    "children": [
                                                                                                                        {
                                                                                                                            "type": "attribute",
                                                                                                                            "label": "str(node.input_default[name]).strip",
                                                                                                                            "start_token": 1970,
                                                                                                                            "end_token": 1980,
                                                                                                                            "children": [
                                                                                                                                {
                                                                                                                                    "type": "call",
                                                                                                                                    "label": "str(node.input_default[name])",
                                                                                                                                    "start_token": 1970,
                                                                                                                                    "end_token": 1978,
                                                                                                                                    "children": [
                                                                                                                                        {
                                                                                                                                            "type": "identifier",
                                                                                                                                            "label": "str",
                                                                                                                                            "start_token": 1970,
                                                                                                                                            "end_token": 1970,
                                                                                                                                            "children": []
                                                                                                                                        },
                                                                                                                                        {
                                                                                                                                            "type": "argument_list",
                                                                                                                                            "label": "(node.input_default[name])",
                                                                                                                                            "start_token": 1971,
                                                                                                                                            "end_token": 1978,
                                                                                                                                            "children": [
                                                                                                                                                {
                                                                                                                                                    "type": "subscript",
                                                                                                                                                    "label": "node.input_default[name]",
                                                                                                                                                    "start_token": 1972,
                                                                                                                                                    "end_token": 1977,
                                                                                                                                                    "children": [
                                                                                                                                                        {
                                                                                                                                                            "type": "attribute",
                                                                                                                                                            "label": "node.input_default",
                                                                                                                                                            "start_token": 1972,
                                                                                                                                                            "end_token": 1974,
                                                                                                                                                            "children": [
                                                                                                                                                                {
                                                                                                                                                                    "type": "identifier",
                                                                                                                                                                    "label": "node",
                                                                                                                                                                    "start_token": 1972,
                                                                                                                                                                    "end_token": 1972,
                                                                                                                                                                    "children": []
                                                                                                                                                                },
                                                                                                                                                                {
                                                                                                                                                                    "type": "identifier",
                                                                                                                                                                    "label": "input_default",
                                                                                                                                                                    "start_token": 1974,
                                                                                                                                                                    "end_token": 1974,
                                                                                                                                                                    "children": []
                                                                                                                                                                }
                                                                                                                                                            ]
                                                                                                                                                        },
                                                                                                                                                        {
                                                                                                                                                            "type": "identifier",
                                                                                                                                                            "label": "name",
                                                                                                                                                            "start_token": 1976,
                                                                                                                                                            "end_token": 1976,
                                                                                                                                                            "children": []
                                                                                                                                                        }
                                                                                                                                                    ]
                                                                                                                                                }
                                                                                                                                            ]
                                                                                                                                        }
                                                                                                                                    ]
                                                                                                                                },
                                                                                                                                {
                                                                                                                                    "type": "identifier",
                                                                                                                                    "label": "strip",
                                                                                                                                    "start_token": 1980,
                                                                                                                                    "end_token": 1980,
                                                                                                                                    "children": []
                                                                                                                                }
                                                                                                                            ]
                                                                                                                        },
                                                                                                                        {
                                                                                                                            "type": "argument_list",
                                                                                                                            "label": "()",
                                                                                                                            "start_token": 1981,
                                                                                                                            "end_token": 1982,
                                                                                                                            "children": []
                                                                                                                        }
                                                                                                                    ]
                                                                                                                },
                                                                                                                {
                                                                                                                    "type": "string",
                                                                                                                    "label": "\"\"",
                                                                                                                    "start_token": 1985,
                                                                                                                    "end_token": 1985,
                                                                                                                    "children": [
                                                                                                                        {
                                                                                                                            "type": "string_start",
                                                                                                                            "label": "\"",
                                                                                                                            "start_token": 1985,
                                                                                                                            "end_token": 1985,
                                                                                                                            "children": []
                                                                                                                        },
                                                                                                                        {
                                                                                                                            "type": "string_end",
                                                                                                                            "label": "\"",
                                                                                                                            "start_token": 1985,
                                                                                                                            "end_token": 1985,
                                                                                                                            "children": []
                                                                                                                        }
                                                                                                                    ]
                                                                                                                }
                                                                                                            ]
                                                                                                        }
                                                                                                    ]
                                                                                                }
                                                                                            ]
                                                                                        },
                                                                                        {
                                                                                            "type": "parenthesized_expression",
                                                                                            "label": "(name in input_schema and input_schema[name].default is not None)",
                                                                                            "start_token": 1989,
                                                                                            "end_token": 2003,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "boolean_operator",
                                                                                                    "label": "name in input_schema and input_schema[name].default is not None",
                                                                                                    "start_token": 1990,
                                                                                                    "end_token": 2002,
                                                                                                    "children": [
                                                                                                        {
                                                                                                            "type": "comparison_operator",
                                                                                                            "label": "name in input_schema",
                                                                                                            "start_token": 1990,
                                                                                                            "end_token": 1992,
                                                                                                            "children": [
                                                                                                                {
                                                                                                                    "type": "identifier",
                                                                                                                    "label": "name",
                                                                                                                    "start_token": 1990,
                                                                                                                    "end_token": 1990,
                                                                                                                    "children": []
                                                                                                                },
                                                                                                                {
                                                                                                                    "type": "identifier",
                                                                                                                    "label": "input_schema",
                                                                                                                    "start_token": 1992,
                                                                                                                    "end_token": 1992,
                                                                                                                    "children": []
                                                                                                                }
                                                                                                            ]
                                                                                                        },
                                                                                                        {
                                                                                                            "type": "comparison_operator",
                                                                                                            "label": "input_schema[name].default is not None",
                                                                                                            "start_token": 1994,
                                                                                                            "end_token": 2002,
                                                                                                            "children": [
                                                                                                                {
                                                                                                                    "type": "attribute",
                                                                                                                    "label": "input_schema[name].default",
                                                                                                                    "start_token": 1994,
                                                                                                                    "end_token": 1999,
                                                                                                                    "children": [
                                                                                                                        {
                                                                                                                            "type": "subscript",
                                                                                                                            "label": "input_schema[name]",
                                                                                                                            "start_token": 1994,
                                                                                                                            "end_token": 1997,
                                                                                                                            "children": [
                                                                                                                                {
                                                                                                                                    "type": "identifier",
                                                                                                                                    "label": "input_schema",
                                                                                                                                    "start_token": 1994,
                                                                                                                                    "end_token": 1994,
                                                                                                                                    "children": []
                                                                                                                                },
                                                                                                                                {
                                                                                                                                    "type": "identifier",
                                                                                                                                    "label": "name",
                                                                                                                                    "start_token": 1996,
                                                                                                                                    "end_token": 1996,
                                                                                                                                    "children": []
                                                                                                                                }
                                                                                                                            ]
                                                                                                                        },
                                                                                                                        {
                                                                                                                            "type": "identifier",
                                                                                                                            "label": "default",
                                                                                                                            "start_token": 1999,
                                                                                                                            "end_token": 1999,
                                                                                                                            "children": []
                                                                                                                        }
                                                                                                                    ]
                                                                                                                },
                                                                                                                {
                                                                                                                    "type": "none",
                                                                                                                    "label": "None",
                                                                                                                    "start_token": 2002,
                                                                                                                    "end_token": 2002,
                                                                                                                    "children": []
                                                                                                                }
                                                                                                            ]
                                                                                                        }
                                                                                                    ]
                                                                                                }
                                                                                            ]
                                                                                        }
                                                                                    ]
                                                                                }
                                                                            ]
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        },
                                                        {
                                                            "type": "comment",
                                                            "label": "# Validate dependencies between fields",
                                                            "start_token": 2006,
                                                            "end_token": 2010,
                                                            "children": []
                                                        },
                                                        {
                                                            "type": "for_statement",
                                                            "label": "for field_name, field_info in input_schema.items():\n                # Apply input dependency validation only on run & field with depends_on\n                json_schema_extra = field_info.json_schema_extra or {}\n                dependencies = json_schema_extra.get(\"depends_on\", [])\n                if not for_run or not dependencies:\n                    continue\n\n                # Check if dependent field has value in input_default\n                field_has_value = has_value(field_name)\n                field_is_required = field_name in required_fields\n\n                # Check for missing dependencies when dependent field is present\n                missing_deps = [dep for dep in dependencies if not has_value(dep)]\n                if missing_deps and (field_has_value or field_is_required):\n                    raise ValueError(\n                        f\"Node {block.name} #{node.id}: Field `{field_name}` requires [{', '.join(missing_deps)}] to be set\"\n                    )",
                                                            "start_token": 2012,
                                                            "end_token": 2137,
                                                            "children": [
                                                                {
                                                                    "type": "pattern_list",
                                                                    "label": "field_name, field_info",
                                                                    "start_token": 2013,
                                                                    "end_token": 2015,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "field_name",
                                                                            "start_token": 2013,
                                                                            "end_token": 2013,
                                                                            "children": []
                                                                        },
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "field_info",
                                                                            "start_token": 2015,
                                                                            "end_token": 2015,
                                                                            "children": []
                                                                        }
                                                                    ]
                                                                },
                                                                {
                                                                    "type": "call",
                                                                    "label": "input_schema.items()",
                                                                    "start_token": 2017,
                                                                    "end_token": 2021,
                                                                    "children": [
                                                                        {
                                                                            "type": "attribute",
                                                                            "label": "input_schema.items",
                                                                            "start_token": 2017,
                                                                            "end_token": 2019,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "input_schema",
                                                                                    "start_token": 2017,
                                                                                    "end_token": 2017,
                                                                                    "children": []
                                                                                },
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "items",
                                                                                    "start_token": 2019,
                                                                                    "end_token": 2019,
                                                                                    "children": []
                                                                                }
                                                                            ]
                                                                        },
                                                                        {
                                                                            "type": "argument_list",
                                                                            "label": "()",
                                                                            "start_token": 2020,
                                                                            "end_token": 2021,
                                                                            "children": []
                                                                        }
                                                                    ]
                                                                },
                                                                {
                                                                    "type": "comment",
                                                                    "label": "# Apply input dependency validation only on run & field with depends_on",
                                                                    "start_token": 2024,
                                                                    "end_token": 2035,
                                                                    "children": []
                                                                },
                                                                {
                                                                    "type": "block",
                                                                    "label": "json_schema_extra = field_info.json_schema_extra or {}\n                dependencies = json_schema_extra.get(\"depends_on\", [])\n                if not for_run or not dependencies:\n                    continue\n\n                # Check if dependent field has value in input_default\n                field_has_value = has_value(field_name)\n                field_is_required = field_name in required_fields\n\n                # Check for missing dependencies when dependent field is present\n                missing_deps = [dep for dep in dependencies if not has_value(dep)]\n                if missing_deps and (field_has_value or field_is_required):\n                    raise ValueError(\n                        f\"Node {block.name} #{node.id}: Field `{field_name}` requires [{', '.join(missing_deps)}] to be set\"\n                    )",
                                                                    "start_token": 2037,
                                                                    "end_token": 2137,
                                                                    "children": [
                                                                        {
                                                                            "type": "expression_statement",
                                                                            "label": "json_schema_extra = field_info.json_schema_extra or {}",
                                                                            "start_token": 2037,
                                                                            "end_token": 2044,
                                                                            "children": [
                                                                                {
                                                                                    "type": "assignment",
                                                                                    "label": "json_schema_extra = field_info.json_schema_extra or {}",
                                                                                    "start_token": 2037,
                                                                                    "end_token": 2044,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "label": "json_schema_extra",
                                                                                            "start_token": 2037,
                                                                                            "end_token": 2037,
                                                                                            "children": []
                                                                                        },
                                                                                        {
                                                                                            "type": "boolean_operator",
                                                                                            "label": "field_info.json_schema_extra or {}",
                                                                                            "start_token": 2039,
                                                                                            "end_token": 2044,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "attribute",
                                                                                                    "label": "field_info.json_schema_extra",
                                                                                                    "start_token": 2039,
                                                                                                    "end_token": 2041,
                                                                                                    "children": [
                                                                                                        {
                                                                                                            "type": "identifier",
                                                                                                            "label": "field_info",
                                                                                                            "start_token": 2039,
                                                                                                            "end_token": 2039,
                                                                                                            "children": []
                                                                                                        },
                                                                                                        {
                                                                                                            "type": "identifier",
                                                                                                            "label": "json_schema_extra",
                                                                                                            "start_token": 2041,
                                                                                                            "end_token": 2041,
                                                                                                            "children": []
                                                                                                        }
                                                                                                    ]
                                                                                                },
                                                                                                {
                                                                                                    "type": "dictionary",
                                                                                                    "label": "{}",
                                                                                                    "start_token": 2043,
                                                                                                    "end_token": 2044,
                                                                                                    "children": []
                                                                                                }
                                                                                            ]
                                                                                        }
                                                                                    ]
                                                                                }
                                                                            ]
                                                                        },
                                                                        {
                                                                            "type": "expression_statement",
                                                                            "label": "dependencies = json_schema_extra.get(\"depends_on\", [])",
                                                                            "start_token": 2046,
                                                                            "end_token": 2056,
                                                                            "children": [
                                                                                {
                                                                                    "type": "assignment",
                                                                                    "label": "dependencies = json_schema_extra.get(\"depends_on\", [])",
                                                                                    "start_token": 2046,
                                                                                    "end_token": 2056,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "label": "dependencies",
                                                                                            "start_token": 2046,
                                                                                            "end_token": 2046,
                                                                                            "children": []
                                                                                        },
                                                                                        {
                                                                                            "type": "call",
                                                                                            "label": "json_schema_extra.get(\"depends_on\", [])",
                                                                                            "start_token": 2048,
                                                                                            "end_token": 2056,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "attribute",
                                                                                                    "label": "json_schema_extra.get",
                                                                                                    "start_token": 2048,
                                                                                                    "end_token": 2050,
                                                                                                    "children": [
                                                                                                        {
                                                                                                            "type": "identifier",
                                                                                                            "label": "json_schema_extra",
                                                                                                            "start_token": 2048,
                                                                                                            "end_token": 2048,
                                                                                                            "children": []
                                                                                                        },
                                                                                                        {
                                                                                                            "type": "identifier",
                                                                                                            "label": "get",
                                                                                                            "start_token": 2050,
                                                                                                            "end_token": 2050,
                                                                                                            "children": []
                                                                                                        }
                                                                                                    ]
                                                                                                },
                                                                                                {
                                                                                                    "type": "argument_list",
                                                                                                    "label": "(\"depends_on\", [])",
                                                                                                    "start_token": 2051,
                                                                                                    "end_token": 2056,
                                                                                                    "children": [
                                                                                                        {
                                                                                                            "type": "string",
                                                                                                            "label": "\"depends_on\"",
                                                                                                            "start_token": 2052,
                                                                                                            "end_token": 2052,
                                                                                                            "children": [
                                                                                                                {
                                                                                                                    "type": "string_start",
                                                                                                                    "label": "\"",
                                                                                                                    "start_token": 2052,
                                                                                                                    "end_token": 2052,
                                                                                                                    "children": []
                                                                                                                },
                                                                                                                {
                                                                                                                    "type": "string_content",
                                                                                                                    "label": "depends_on",
                                                                                                                    "start_token": 2052,
                                                                                                                    "end_token": 2052,
                                                                                                                    "children": []
                                                                                                                },
                                                                                                                {
                                                                                                                    "type": "string_end",
                                                                                                                    "label": "\"",
                                                                                                                    "start_token": 2052,
                                                                                                                    "end_token": 2052,
                                                                                                                    "children": []
                                                                                                                }
                                                                                                            ]
                                                                                                        },
                                                                                                        {
                                                                                                            "type": "list",
                                                                                                            "label": "[]",
                                                                                                            "start_token": 2054,
                                                                                                            "end_token": 2055,
                                                                                                            "children": []
                                                                                                        }
                                                                                                    ]
                                                                                                }
                                                                                            ]
                                                                                        }
                                                                                    ]
                                                                                }
                                                                            ]
                                                                        },
                                                                        {
                                                                            "type": "if_statement",
                                                                            "label": "if not for_run or not dependencies:\n                    continue",
                                                                            "start_token": 2058,
                                                                            "end_token": 2066,
                                                                            "children": [
                                                                                {
                                                                                    "type": "boolean_operator",
                                                                                    "label": "not for_run or not dependencies",
                                                                                    "start_token": 2059,
                                                                                    "end_token": 2063,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "not_operator",
                                                                                            "label": "not for_run",
                                                                                            "start_token": 2059,
                                                                                            "end_token": 2060,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "label": "for_run",
                                                                                                    "start_token": 2060,
                                                                                                    "end_token": 2060,
                                                                                                    "children": []
                                                                                                }
                                                                                            ]
                                                                                        },
                                                                                        {
                                                                                            "type": "not_operator",
                                                                                            "label": "not dependencies",
                                                                                            "start_token": 2062,
                                                                                            "end_token": 2063,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "label": "dependencies",
                                                                                                    "start_token": 2063,
                                                                                                    "end_token": 2063,
                                                                                                    "children": []
                                                                                                }
                                                                                            ]
                                                                                        }
                                                                                    ]
                                                                                },
                                                                                {
                                                                                    "type": "block",
                                                                                    "label": "continue",
                                                                                    "start_token": 2066,
                                                                                    "end_token": 2066,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "continue_statement",
                                                                                            "label": "continue",
                                                                                            "start_token": 2066,
                                                                                            "end_token": 2066,
                                                                                            "children": []
                                                                                        }
                                                                                    ]
                                                                                }
                                                                            ]
                                                                        },
                                                                        {
                                                                            "type": "comment",
                                                                            "label": "# Check if dependent field has value in input_default",
                                                                            "start_token": 2069,
                                                                            "end_token": 2077,
                                                                            "children": []
                                                                        },
                                                                        {
                                                                            "type": "expression_statement",
                                                                            "label": "field_has_value = has_value(field_name)",
                                                                            "start_token": 2079,
                                                                            "end_token": 2084,
                                                                            "children": [
                                                                                {
                                                                                    "type": "assignment",
                                                                                    "label": "field_has_value = has_value(field_name)",
                                                                                    "start_token": 2079,
                                                                                    "end_token": 2084,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "label": "field_has_value",
                                                                                            "start_token": 2079,
                                                                                            "end_token": 2079,
                                                                                            "children": []
                                                                                        },
                                                                                        {
                                                                                            "type": "call",
                                                                                            "label": "has_value(field_name)",
                                                                                            "start_token": 2081,
                                                                                            "end_token": 2084,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "label": "has_value",
                                                                                                    "start_token": 2081,
                                                                                                    "end_token": 2081,
                                                                                                    "children": []
                                                                                                },
                                                                                                {
                                                                                                    "type": "argument_list",
                                                                                                    "label": "(field_name)",
                                                                                                    "start_token": 2082,
                                                                                                    "end_token": 2084,
                                                                                                    "children": [
                                                                                                        {
                                                                                                            "type": "identifier",
                                                                                                            "label": "field_name",
                                                                                                            "start_token": 2083,
                                                                                                            "end_token": 2083,
                                                                                                            "children": []
                                                                                                        }
                                                                                                    ]
                                                                                                }
                                                                                            ]
                                                                                        }
                                                                                    ]
                                                                                }
                                                                            ]
                                                                        },
                                                                        {
                                                                            "type": "expression_statement",
                                                                            "label": "field_is_required = field_name in required_fields",
                                                                            "start_token": 2086,
                                                                            "end_token": 2090,
                                                                            "children": [
                                                                                {
                                                                                    "type": "assignment",
                                                                                    "label": "field_is_required = field_name in required_fields",
                                                                                    "start_token": 2086,
                                                                                    "end_token": 2090,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "label": "field_is_required",
                                                                                            "start_token": 2086,
                                                                                            "end_token": 2086,
                                                                                            "children": []
                                                                                        },
                                                                                        {
                                                                                            "type": "comparison_operator",
                                                                                            "label": "field_name in required_fields",
                                                                                            "start_token": 2088,
                                                                                            "end_token": 2090,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "label": "field_name",
                                                                                                    "start_token": 2088,
                                                                                                    "end_token": 2088,
                                                                                                    "children": []
                                                                                                },
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "label": "required_fields",
                                                                                                    "start_token": 2090,
                                                                                                    "end_token": 2090,
                                                                                                    "children": []
                                                                                                }
                                                                                            ]
                                                                                        }
                                                                                    ]
                                                                                }
                                                                            ]
                                                                        },
                                                                        {
                                                                            "type": "comment",
                                                                            "label": "# Check for missing dependencies when dependent field is present",
                                                                            "start_token": 2093,
                                                                            "end_token": 2102,
                                                                            "children": []
                                                                        },
                                                                        {
                                                                            "type": "expression_statement",
                                                                            "label": "missing_deps = [dep for dep in dependencies if not has_value(dep)]",
                                                                            "start_token": 2104,
                                                                            "end_token": 2118,
                                                                            "children": [
                                                                                {
                                                                                    "type": "assignment",
                                                                                    "label": "missing_deps = [dep for dep in dependencies if not has_value(dep)]",
                                                                                    "start_token": 2104,
                                                                                    "end_token": 2118,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "label": "missing_deps",
                                                                                            "start_token": 2104,
                                                                                            "end_token": 2104,
                                                                                            "children": []
                                                                                        },
                                                                                        {
                                                                                            "type": "list_comprehension",
                                                                                            "label": "[dep for dep in dependencies if not has_value(dep)]",
                                                                                            "start_token": 2106,
                                                                                            "end_token": 2118,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "label": "dep",
                                                                                                    "start_token": 2107,
                                                                                                    "end_token": 2107,
                                                                                                    "children": []
                                                                                                },
                                                                                                {
                                                                                                    "type": "for_in_clause",
                                                                                                    "label": "for dep in dependencies",
                                                                                                    "start_token": 2108,
                                                                                                    "end_token": 2111,
                                                                                                    "children": [
                                                                                                        {
                                                                                                            "type": "identifier",
                                                                                                            "label": "dep",
                                                                                                            "start_token": 2109,
                                                                                                            "end_token": 2109,
                                                                                                            "children": []
                                                                                                        },
                                                                                                        {
                                                                                                            "type": "identifier",
                                                                                                            "label": "dependencies",
                                                                                                            "start_token": 2111,
                                                                                                            "end_token": 2111,
                                                                                                            "children": []
                                                                                                        }
                                                                                                    ]
                                                                                                },
                                                                                                {
                                                                                                    "type": "if_clause",
                                                                                                    "label": "if not has_value(dep)",
                                                                                                    "start_token": 2112,
                                                                                                    "end_token": 2117,
                                                                                                    "children": [
                                                                                                        {
                                                                                                            "type": "not_operator",
                                                                                                            "label": "not has_value(dep)",
                                                                                                            "start_token": 2113,
                                                                                                            "end_token": 2117,
                                                                                                            "children": [
                                                                                                                {
                                                                                                                    "type": "call",
                                                                                                                    "label": "has_value(dep)",
                                                                                                                    "start_token": 2114,
                                                                                                                    "end_token": 2117,
                                                                                                                    "children": [
                                                                                                                        {
                                                                                                                            "type": "identifier",
                                                                                                                            "label": "has_value",
                                                                                                                            "start_token": 2114,
                                                                                                                            "end_token": 2114,
                                                                                                                            "children": []
                                                                                                                        },
                                                                                                                        {
                                                                                                                            "type": "argument_list",
                                                                                                                            "label": "(dep)",
                                                                                                                            "start_token": 2115,
                                                                                                                            "end_token": 2117,
                                                                                                                            "children": [
                                                                                                                                {
                                                                                                                                    "type": "identifier",
                                                                                                                                    "label": "dep",
                                                                                                                                    "start_token": 2116,
                                                                                                                                    "end_token": 2116,
                                                                                                                                    "children": []
                                                                                                                                }
                                                                                                                            ]
                                                                                                                        }
                                                                                                                    ]
                                                                                                                }
                                                                                                            ]
                                                                                                        }
                                                                                                    ]
                                                                                                }
                                                                                            ]
                                                                                        }
                                                                                    ]
                                                                                }
                                                                            ]
                                                                        },
                                                                        {
                                                                            "type": "if_statement",
                                                                            "label": "if missing_deps and (field_has_value or field_is_required):\n                    raise ValueError(\n                        f\"Node {block.name} #{node.id}: Field `{field_name}` requires [{', '.join(missing_deps)}] to be set\"\n                    )",
                                                                            "start_token": 2120,
                                                                            "end_token": 2137,
                                                                            "children": [
                                                                                {
                                                                                    "type": "boolean_operator",
                                                                                    "label": "missing_deps and (field_has_value or field_is_required)",
                                                                                    "start_token": 2121,
                                                                                    "end_token": 2127,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "label": "missing_deps",
                                                                                            "start_token": 2121,
                                                                                            "end_token": 2121,
                                                                                            "children": []
                                                                                        },
                                                                                        {
                                                                                            "type": "parenthesized_expression",
                                                                                            "label": "(field_has_value or field_is_required)",
                                                                                            "start_token": 2123,
                                                                                            "end_token": 2127,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "boolean_operator",
                                                                                                    "label": "field_has_value or field_is_required",
                                                                                                    "start_token": 2124,
                                                                                                    "end_token": 2126,
                                                                                                    "children": [
                                                                                                        {
                                                                                                            "type": "identifier",
                                                                                                            "label": "field_has_value",
                                                                                                            "start_token": 2124,
                                                                                                            "end_token": 2124,
                                                                                                            "children": []
                                                                                                        },
                                                                                                        {
                                                                                                            "type": "identifier",
                                                                                                            "label": "field_is_required",
                                                                                                            "start_token": 2126,
                                                                                                            "end_token": 2126,
                                                                                                            "children": []
                                                                                                        }
                                                                                                    ]
                                                                                                }
                                                                                            ]
                                                                                        }
                                                                                    ]
                                                                                },
                                                                                {
                                                                                    "type": "block",
                                                                                    "label": "raise ValueError(\n                        f\"Node {block.name} #{node.id}: Field `{field_name}` requires [{', '.join(missing_deps)}] to be set\"\n                    )",
                                                                                    "start_token": 2130,
                                                                                    "end_token": 2137,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "raise_statement",
                                                                                            "label": "raise ValueError(\n                        f\"Node {block.name} #{node.id}: Field `{field_name}` requires [{', '.join(missing_deps)}] to be set\"\n                    )",
                                                                                            "start_token": 2130,
                                                                                            "end_token": 2137,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "call",
                                                                                                    "label": "ValueError(\n                        f\"Node {block.name} #{node.id}: Field `{field_name}` requires [{', '.join(missing_deps)}] to be set\"\n                    )",
                                                                                                    "start_token": 2131,
                                                                                                    "end_token": 2137,
                                                                                                    "children": [
                                                                                                        {
                                                                                                            "type": "identifier",
                                                                                                            "label": "ValueError",
                                                                                                            "start_token": 2131,
                                                                                                            "end_token": 2131,
                                                                                                            "children": []
                                                                                                        },
                                                                                                        {
                                                                                                            "type": "argument_list",
                                                                                                            "label": "(\n                        f\"Node {block.name} #{node.id}: Field `{field_name}` requires [{', '.join(missing_deps)}] to be set\"\n                    )",
                                                                                                            "start_token": 2132,
                                                                                                            "end_token": 2137,
                                                                                                            "children": [
                                                                                                                {
                                                                                                                    "type": "string",
                                                                                                                    "label": "f\"Node {block.name} #{node.id}: Field `{field_name}` requires [{', '.join(missing_deps)}] to be set\"",
                                                                                                                    "start_token": 2134,
                                                                                                                    "end_token": 2135,
                                                                                                                    "children": [
                                                                                                                        {
                                                                                                                            "type": "string_start",
                                                                                                                            "label": "f\"",
                                                                                                                            "start_token": 2134,
                                                                                                                            "end_token": 2135,
                                                                                                                            "children": []
                                                                                                                        },
                                                                                                                        {
                                                                                                                            "type": "string_content",
                                                                                                                            "label": "Node ",
                                                                                                                            "start_token": 2135,
                                                                                                                            "end_token": 2135,
                                                                                                                            "children": []
                                                                                                                        },
                                                                                                                        {
                                                                                                                            "type": "interpolation",
                                                                                                                            "label": "{block.name}",
                                                                                                                            "start_token": 2135,
                                                                                                                            "end_token": 2135,
                                                                                                                            "children": [
                                                                                                                                {
                                                                                                                                    "type": "attribute",
                                                                                                                                    "label": "block.name",
                                                                                                                                    "start_token": 2135,
                                                                                                                                    "end_token": 2135,
                                                                                                                                    "children": [
                                                                                                                                        {
                                                                                                                                            "type": "identifier",
                                                                                                                                            "label": "block",
                                                                                                                                            "start_token": 2135,
                                                                                                                                            "end_token": 2135,
                                                                                                                                            "children": []
                                                                                                                                        },
                                                                                                                                        {
                                                                                                                                            "type": "identifier",
                                                                                                                                            "label": "name",
                                                                                                                                            "start_token": 2135,
                                                                                                                                            "end_token": 2135,
                                                                                                                                            "children": []
                                                                                                                                        }
                                                                                                                                    ]
                                                                                                                                }
                                                                                                                            ]
                                                                                                                        },
                                                                                                                        {
                                                                                                                            "type": "string_content",
                                                                                                                            "label": " #",
                                                                                                                            "start_token": 2135,
                                                                                                                            "end_token": 2135,
                                                                                                                            "children": []
                                                                                                                        },
                                                                                                                        {
                                                                                                                            "type": "interpolation",
                                                                                                                            "label": "{node.id}",
                                                                                                                            "start_token": 2135,
                                                                                                                            "end_token": 2135,
                                                                                                                            "children": [
                                                                                                                                {
                                                                                                                                    "type": "attribute",
                                                                                                                                    "label": "node.id",
                                                                                                                                    "start_token": 2135,
                                                                                                                                    "end_token": 2135,
                                                                                                                                    "children": [
                                                                                                                                        {
                                                                                                                                            "type": "identifier",
                                                                                                                                            "label": "node",
                                                                                                                                            "start_token": 2135,
                                                                                                                                            "end_token": 2135,
                                                                                                                                            "children": []
                                                                                                                                        },
                                                                                                                                        {
                                                                                                                                            "type": "identifier",
                                                                                                                                            "label": "id",
                                                                                                                                            "start_token": 2135,
                                                                                                                                            "end_token": 2135,
                                                                                                                                            "children": []
                                                                                                                                        }
                                                                                                                                    ]
                                                                                                                                }
                                                                                                                            ]
                                                                                                                        },
                                                                                                                        {
                                                                                                                            "type": "string_content",
                                                                                                                            "label": ": Field `",
                                                                                                                            "start_token": 2135,
                                                                                                                            "end_token": 2135,
                                                                                                                            "children": []
                                                                                                                        },
                                                                                                                        {
                                                                                                                            "type": "interpolation",
                                                                                                                            "label": "{field_name}",
                                                                                                                            "start_token": 2135,
                                                                                                                            "end_token": 2135,
                                                                                                                            "children": [
                                                                                                                                {
                                                                                                                                    "type": "identifier",
                                                                                                                                    "label": "field_name",
                                                                                                                                    "start_token": 2135,
                                                                                                                                    "end_token": 2135,
                                                                                                                                    "children": []
                                                                                                                                }
                                                                                                                            ]
                                                                                                                        },
                                                                                                                        {
                                                                                                                            "type": "string_content",
                                                                                                                            "label": "` requires [",
                                                                                                                            "start_token": 2135,
                                                                                                                            "end_token": 2135,
                                                                                                                            "children": []
                                                                                                                        },
                                                                                                                        {
                                                                                                                            "type": "interpolation",
                                                                                                                            "label": "{', '.join(missing_deps)}",
                                                                                                                            "start_token": 2135,
                                                                                                                            "end_token": 2135,
                                                                                                                            "children": [
                                                                                                                                {
                                                                                                                                    "type": "call",
                                                                                                                                    "label": "', '.join(missing_deps)",
                                                                                                                                    "start_token": 2135,
                                                                                                                                    "end_token": 2135,
                                                                                                                                    "children": [
                                                                                                                                        {
                                                                                                                                            "type": "attribute",
                                                                                                                                            "label": "', '.join",
                                                                                                                                            "start_token": 2135,
                                                                                                                                            "end_token": 2135,
                                                                                                                                            "children": [
                                                                                                                                                {
                                                                                                                                                    "type": "string",
                                                                                                                                                    "label": "', '",
                                                                                                                                                    "start_token": 2135,
                                                                                                                                                    "end_token": 2135,
                                                                                                                                                    "children": [
                                                                                                                                                        {
                                                                                                                                                            "type": "string_start",
                                                                                                                                                            "label": "'",
                                                                                                                                                            "start_token": 2135,
                                                                                                                                                            "end_token": 2135,
                                                                                                                                                            "children": []
                                                                                                                                                        },
                                                                                                                                                        {
                                                                                                                                                            "type": "string_content",
                                                                                                                                                            "label": ", ",
                                                                                                                                                            "start_token": 2135,
                                                                                                                                                            "end_token": 2135,
                                                                                                                                                            "children": []
                                                                                                                                                        },
                                                                                                                                                        {
                                                                                                                                                            "type": "string_end",
                                                                                                                                                            "label": "'",
                                                                                                                                                            "start_token": 2135,
                                                                                                                                                            "end_token": 2135,
                                                                                                                                                            "children": []
                                                                                                                                                        }
                                                                                                                                                    ]
                                                                                                                                                },
                                                                                                                                                {
                                                                                                                                                    "type": "identifier",
                                                                                                                                                    "label": "join",
                                                                                                                                                    "start_token": 2135,
                                                                                                                                                    "end_token": 2135,
                                                                                                                                                    "children": []
                                                                                                                                                }
                                                                                                                                            ]
                                                                                                                                        },
                                                                                                                                        {
                                                                                                                                            "type": "argument_list",
                                                                                                                                            "label": "(missing_deps)",
                                                                                                                                            "start_token": 2135,
                                                                                                                                            "end_token": 2135,
                                                                                                                                            "children": [
                                                                                                                                                {
                                                                                                                                                    "type": "identifier",
                                                                                                                                                    "label": "missing_deps",
                                                                                                                                                    "start_token": 2135,
                                                                                                                                                    "end_token": 2135,
                                                                                                                                                    "children": []
                                                                                                                                                }
                                                                                                                                            ]
                                                                                                                                        }
                                                                                                                                    ]
                                                                                                                                }
                                                                                                                            ]
                                                                                                                        },
                                                                                                                        {
                                                                                                                            "type": "string_content",
                                                                                                                            "label": "] to be set",
                                                                                                                            "start_token": 2135,
                                                                                                                            "end_token": 2135,
                                                                                                                            "children": []
                                                                                                                        },
                                                                                                                        {
                                                                                                                            "type": "string_end",
                                                                                                                            "label": "\"",
                                                                                                                            "start_token": 2135,
                                                                                                                            "end_token": 2135,
                                                                                                                            "children": []
                                                                                                                        }
                                                                                                                    ]
                                                                                                                }
                                                                                                            ]
                                                                                                        }
                                                                                                    ]
                                                                                                }
                                                                                            ]
                                                                                        }
                                                                                    ]
                                                                                }
                                                                            ]
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                }
                                            ]
                                        },
                                        {
                                            "type": "expression_statement",
                                            "label": "node_map = {v.id: v for v in self.nodes}",
                                            "start_token": 2140,
                                            "end_token": 2154,
                                            "children": [
                                                {
                                                    "type": "assignment",
                                                    "label": "node_map = {v.id: v for v in self.nodes}",
                                                    "start_token": 2140,
                                                    "end_token": 2154,
                                                    "children": [
                                                        {
                                                            "type": "identifier",
                                                            "label": "node_map",
                                                            "start_token": 2140,
                                                            "end_token": 2140,
                                                            "children": []
                                                        },
                                                        {
                                                            "type": "dictionary_comprehension",
                                                            "label": "{v.id: v for v in self.nodes}",
                                                            "start_token": 2142,
                                                            "end_token": 2154,
                                                            "children": [
                                                                {
                                                                    "type": "pair",
                                                                    "label": "v.id: v",
                                                                    "start_token": 2143,
                                                                    "end_token": 2147,
                                                                    "children": [
                                                                        {
                                                                            "type": "attribute",
                                                                            "label": "v.id",
                                                                            "start_token": 2143,
                                                                            "end_token": 2145,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "v",
                                                                                    "start_token": 2143,
                                                                                    "end_token": 2143,
                                                                                    "children": []
                                                                                },
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "id",
                                                                                    "start_token": 2145,
                                                                                    "end_token": 2145,
                                                                                    "children": []
                                                                                }
                                                                            ]
                                                                        },
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "v",
                                                                            "start_token": 2147,
                                                                            "end_token": 2147,
                                                                            "children": []
                                                                        }
                                                                    ]
                                                                },
                                                                {
                                                                    "type": "for_in_clause",
                                                                    "label": "for v in self.nodes",
                                                                    "start_token": 2148,
                                                                    "end_token": 2153,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "v",
                                                                            "start_token": 2149,
                                                                            "end_token": 2149,
                                                                            "children": []
                                                                        },
                                                                        {
                                                                            "type": "attribute",
                                                                            "label": "self.nodes",
                                                                            "start_token": 2151,
                                                                            "end_token": 2153,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "self",
                                                                                    "start_token": 2151,
                                                                                    "end_token": 2151,
                                                                                    "children": []
                                                                                },
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "nodes",
                                                                                    "start_token": 2153,
                                                                                    "end_token": 2153,
                                                                                    "children": []
                                                                                }
                                                                            ]
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                }
                                            ]
                                        },
                                        {
                                            "type": "function_definition",
                                            "label": "def is_static_output_block(nid: str) -> bool:\n            bid = node_map[nid].block_id\n            b = get_block(bid)\n            return b.static_output if b else False",
                                            "start_token": 2157,
                                            "end_token": 2192,
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "label": "is_static_output_block",
                                                    "start_token": 2158,
                                                    "end_token": 2158,
                                                    "children": []
                                                },
                                                {
                                                    "type": "parameters",
                                                    "label": "(nid: str)",
                                                    "start_token": 2159,
                                                    "end_token": 2163,
                                                    "children": [
                                                        {
                                                            "type": "typed_parameter",
                                                            "label": "nid: str",
                                                            "start_token": 2160,
                                                            "end_token": 2162,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "label": "nid",
                                                                    "start_token": 2160,
                                                                    "end_token": 2160,
                                                                    "children": []
                                                                },
                                                                {
                                                                    "type": "type",
                                                                    "label": "str",
                                                                    "start_token": 2162,
                                                                    "end_token": 2162,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "str",
                                                                            "start_token": 2162,
                                                                            "end_token": 2162,
                                                                            "children": []
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                },
                                                {
                                                    "type": "type",
                                                    "label": "bool",
                                                    "start_token": 2166,
                                                    "end_token": 2166,
                                                    "children": [
                                                        {
                                                            "type": "identifier",
                                                            "label": "bool",
                                                            "start_token": 2166,
                                                            "end_token": 2166,
                                                            "children": []
                                                        }
                                                    ]
                                                },
                                                {
                                                    "type": "block",
                                                    "label": "bid = node_map[nid].block_id\n            b = get_block(bid)\n            return b.static_output if b else False",
                                                    "start_token": 2169,
                                                    "end_token": 2192,
                                                    "children": [
                                                        {
                                                            "type": "expression_statement",
                                                            "label": "bid = node_map[nid].block_id",
                                                            "start_token": 2169,
                                                            "end_token": 2176,
                                                            "children": [
                                                                {
                                                                    "type": "assignment",
                                                                    "label": "bid = node_map[nid].block_id",
                                                                    "start_token": 2169,
                                                                    "end_token": 2176,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "bid",
                                                                            "start_token": 2169,
                                                                            "end_token": 2169,
                                                                            "children": []
                                                                        },
                                                                        {
                                                                            "type": "attribute",
                                                                            "label": "node_map[nid].block_id",
                                                                            "start_token": 2171,
                                                                            "end_token": 2176,
                                                                            "children": [
                                                                                {
                                                                                    "type": "subscript",
                                                                                    "label": "node_map[nid]",
                                                                                    "start_token": 2171,
                                                                                    "end_token": 2174,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "label": "node_map",
                                                                                            "start_token": 2171,
                                                                                            "end_token": 2171,
                                                                                            "children": []
                                                                                        },
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "label": "nid",
                                                                                            "start_token": 2173,
                                                                                            "end_token": 2173,
                                                                                            "children": []
                                                                                        }
                                                                                    ]
                                                                                },
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "block_id",
                                                                                    "start_token": 2176,
                                                                                    "end_token": 2176,
                                                                                    "children": []
                                                                                }
                                                                            ]
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        },
                                                        {
                                                            "type": "expression_statement",
                                                            "label": "b = get_block(bid)",
                                                            "start_token": 2178,
                                                            "end_token": 2183,
                                                            "children": [
                                                                {
                                                                    "type": "assignment",
                                                                    "label": "b = get_block(bid)",
                                                                    "start_token": 2178,
                                                                    "end_token": 2183,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "b",
                                                                            "start_token": 2178,
                                                                            "end_token": 2178,
                                                                            "children": []
                                                                        },
                                                                        {
                                                                            "type": "call",
                                                                            "label": "get_block(bid)",
                                                                            "start_token": 2180,
                                                                            "end_token": 2183,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "get_block",
                                                                                    "start_token": 2180,
                                                                                    "end_token": 2180,
                                                                                    "children": []
                                                                                },
                                                                                {
                                                                                    "type": "argument_list",
                                                                                    "label": "(bid)",
                                                                                    "start_token": 2181,
                                                                                    "end_token": 2183,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "label": "bid",
                                                                                            "start_token": 2182,
                                                                                            "end_token": 2182,
                                                                                            "children": []
                                                                                        }
                                                                                    ]
                                                                                }
                                                                            ]
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        },
                                                        {
                                                            "type": "return_statement",
                                                            "label": "return b.static_output if b else False",
                                                            "start_token": 2185,
                                                            "end_token": 2192,
                                                            "children": [
                                                                {
                                                                    "type": "conditional_expression",
                                                                    "label": "b.static_output if b else False",
                                                                    "start_token": 2186,
                                                                    "end_token": 2192,
                                                                    "children": [
                                                                        {
                                                                            "type": "attribute",
                                                                            "label": "b.static_output",
                                                                            "start_token": 2186,
                                                                            "end_token": 2188,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "b",
                                                                                    "start_token": 2186,
                                                                                    "end_token": 2186,
                                                                                    "children": []
                                                                                },
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "static_output",
                                                                                    "start_token": 2188,
                                                                                    "end_token": 2188,
                                                                                    "children": []
                                                                                }
                                                                            ]
                                                                        },
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "b",
                                                                            "start_token": 2190,
                                                                            "end_token": 2190,
                                                                            "children": []
                                                                        },
                                                                        {
                                                                            "type": "false",
                                                                            "label": "False",
                                                                            "start_token": 2192,
                                                                            "end_token": 2192,
                                                                            "children": []
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                }
                                            ]
                                        },
                                        {
                                            "type": "comment",
                                            "label": "# Links: links are connected and the connected pin data type are compatible.",
                                            "start_token": 2195,
                                            "end_token": 2209,
                                            "children": []
                                        },
                                        {
                                            "type": "for_statement",
                                            "label": "for link in self.links:\n            source = (link.source_id, link.source_name)\n            sink = (link.sink_id, link.sink_name)\n            suffix = f\"Link {source} <-> {sink}\"\n\n            for i, (node_id, name) in enumerate([source, sink]):\n                node = node_map.get(node_id)\n                if not node:\n                    raise ValueError(\n                        f\"{suffix}, {node_id} is invalid node id, available nodes: {node_map.keys()}\"\n                    )\n\n                block = get_block(node.block_id)\n                if not block:\n                    blocks = {v().id: v().name for v in get_blocks().values()}\n                    raise ValueError(\n                        f\"{suffix}, {node.block_id} is invalid block id, available blocks: {blocks}\"\n                    )\n\n                sanitized_name = sanitize(name)\n                vals = node.input_default\n                if i == 0:\n                    fields = (\n                        block.output_schema.get_fields()\n                        if block.block_type != BlockType.AGENT\n                        else vals.get(\"output_schema\", {}).get(\"properties\", {}).keys()\n                    )\n                else:\n                    fields = (\n                        block.input_schema.get_fields()\n                        if block.block_type != BlockType.AGENT\n                        else vals.get(\"input_schema\", {}).get(\"properties\", {}).keys()\n                    )\n                if sanitized_name not in fields:\n                    fields_msg = f\"Allowed fields: {fields}\"\n                    raise ValueError(f\"{suffix}, `{name}` invalid, {fields_msg}\")\n\n            if is_static_output_block(link.source_id):\n                link.is_static = True  # Each value block output should be static.",
                                            "start_token": 2211,
                                            "end_token": 2501,
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "label": "link",
                                                    "start_token": 2212,
                                                    "end_token": 2212,
                                                    "children": []
                                                },
                                                {
                                                    "type": "attribute",
                                                    "label": "self.links",
                                                    "start_token": 2214,
                                                    "end_token": 2216,
                                                    "children": [
                                                        {
                                                            "type": "identifier",
                                                            "label": "self",
                                                            "start_token": 2214,
                                                            "end_token": 2214,
                                                            "children": []
                                                        },
                                                        {
                                                            "type": "identifier",
                                                            "label": "links",
                                                            "start_token": 2216,
                                                            "end_token": 2216,
                                                            "children": []
                                                        }
                                                    ]
                                                },
                                                {
                                                    "type": "block",
                                                    "label": "source = (link.source_id, link.source_name)\n            sink = (link.sink_id, link.sink_name)\n            suffix = f\"Link {source} <-> {sink}\"\n\n            for i, (node_id, name) in enumerate([source, sink]):\n                node = node_map.get(node_id)\n                if not node:\n                    raise ValueError(\n                        f\"{suffix}, {node_id} is invalid node id, available nodes: {node_map.keys()}\"\n                    )\n\n                block = get_block(node.block_id)\n                if not block:\n                    blocks = {v().id: v().name for v in get_blocks().values()}\n                    raise ValueError(\n                        f\"{suffix}, {node.block_id} is invalid block id, available blocks: {blocks}\"\n                    )\n\n                sanitized_name = sanitize(name)\n                vals = node.input_default\n                if i == 0:\n                    fields = (\n                        block.output_schema.get_fields()\n                        if block.block_type != BlockType.AGENT\n                        else vals.get(\"output_schema\", {}).get(\"properties\", {}).keys()\n                    )\n                else:\n                    fields = (\n                        block.input_schema.get_fields()\n                        if block.block_type != BlockType.AGENT\n                        else vals.get(\"input_schema\", {}).get(\"properties\", {}).keys()\n                    )\n                if sanitized_name not in fields:\n                    fields_msg = f\"Allowed fields: {fields}\"\n                    raise ValueError(f\"{suffix}, `{name}` invalid, {fields_msg}\")\n\n            if is_static_output_block(link.source_id):\n                link.is_static = True  # Each value block output should be static.",
                                                    "start_token": 2219,
                                                    "end_token": 2501,
                                                    "children": [
                                                        {
                                                            "type": "expression_statement",
                                                            "label": "source = (link.source_id, link.source_name)",
                                                            "start_token": 2219,
                                                            "end_token": 2229,
                                                            "children": [
                                                                {
                                                                    "type": "assignment",
                                                                    "label": "source = (link.source_id, link.source_name)",
                                                                    "start_token": 2219,
                                                                    "end_token": 2229,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "source",
                                                                            "start_token": 2219,
                                                                            "end_token": 2219,
                                                                            "children": []
                                                                        },
                                                                        {
                                                                            "type": "tuple",
                                                                            "label": "(link.source_id, link.source_name)",
                                                                            "start_token": 2221,
                                                                            "end_token": 2229,
                                                                            "children": [
                                                                                {
                                                                                    "type": "attribute",
                                                                                    "label": "link.source_id",
                                                                                    "start_token": 2222,
                                                                                    "end_token": 2224,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "label": "link",
                                                                                            "start_token": 2222,
                                                                                            "end_token": 2222,
                                                                                            "children": []
                                                                                        },
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "label": "source_id",
                                                                                            "start_token": 2224,
                                                                                            "end_token": 2224,
                                                                                            "children": []
                                                                                        }
                                                                                    ]
                                                                                },
                                                                                {
                                                                                    "type": "attribute",
                                                                                    "label": "link.source_name",
                                                                                    "start_token": 2226,
                                                                                    "end_token": 2228,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "label": "link",
                                                                                            "start_token": 2226,
                                                                                            "end_token": 2226,
                                                                                            "children": []
                                                                                        },
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "label": "source_name",
                                                                                            "start_token": 2228,
                                                                                            "end_token": 2228,
                                                                                            "children": []
                                                                                        }
                                                                                    ]
                                                                                }
                                                                            ]
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        },
                                                        {
                                                            "type": "expression_statement",
                                                            "label": "sink = (link.sink_id, link.sink_name)",
                                                            "start_token": 2231,
                                                            "end_token": 2241,
                                                            "children": [
                                                                {
                                                                    "type": "assignment",
                                                                    "label": "sink = (link.sink_id, link.sink_name)",
                                                                    "start_token": 2231,
                                                                    "end_token": 2241,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "sink",
                                                                            "start_token": 2231,
                                                                            "end_token": 2231,
                                                                            "children": []
                                                                        },
                                                                        {
                                                                            "type": "tuple",
                                                                            "label": "(link.sink_id, link.sink_name)",
                                                                            "start_token": 2233,
                                                                            "end_token": 2241,
                                                                            "children": [
                                                                                {
                                                                                    "type": "attribute",
                                                                                    "label": "link.sink_id",
                                                                                    "start_token": 2234,
                                                                                    "end_token": 2236,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "label": "link",
                                                                                            "start_token": 2234,
                                                                                            "end_token": 2234,
                                                                                            "children": []
                                                                                        },
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "label": "sink_id",
                                                                                            "start_token": 2236,
                                                                                            "end_token": 2236,
                                                                                            "children": []
                                                                                        }
                                                                                    ]
                                                                                },
                                                                                {
                                                                                    "type": "attribute",
                                                                                    "label": "link.sink_name",
                                                                                    "start_token": 2238,
                                                                                    "end_token": 2240,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "label": "link",
                                                                                            "start_token": 2238,
                                                                                            "end_token": 2238,
                                                                                            "children": []
                                                                                        },
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "label": "sink_name",
                                                                                            "start_token": 2240,
                                                                                            "end_token": 2240,
                                                                                            "children": []
                                                                                        }
                                                                                    ]
                                                                                }
                                                                            ]
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        },
                                                        {
                                                            "type": "expression_statement",
                                                            "label": "suffix = f\"Link {source} <-> {sink}\"",
                                                            "start_token": 2243,
                                                            "end_token": 2246,
                                                            "children": [
                                                                {
                                                                    "type": "assignment",
                                                                    "label": "suffix = f\"Link {source} <-> {sink}\"",
                                                                    "start_token": 2243,
                                                                    "end_token": 2246,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "suffix",
                                                                            "start_token": 2243,
                                                                            "end_token": 2243,
                                                                            "children": []
                                                                        },
                                                                        {
                                                                            "type": "string",
                                                                            "label": "f\"Link {source} <-> {sink}\"",
                                                                            "start_token": 2245,
                                                                            "end_token": 2246,
                                                                            "children": [
                                                                                {
                                                                                    "type": "string_start",
                                                                                    "label": "f\"",
                                                                                    "start_token": 2245,
                                                                                    "end_token": 2246,
                                                                                    "children": []
                                                                                },
                                                                                {
                                                                                    "type": "string_content",
                                                                                    "label": "Link ",
                                                                                    "start_token": 2246,
                                                                                    "end_token": 2246,
                                                                                    "children": []
                                                                                },
                                                                                {
                                                                                    "type": "interpolation",
                                                                                    "label": "{source}",
                                                                                    "start_token": 2246,
                                                                                    "end_token": 2246,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "label": "source",
                                                                                            "start_token": 2246,
                                                                                            "end_token": 2246,
                                                                                            "children": []
                                                                                        }
                                                                                    ]
                                                                                },
                                                                                {
                                                                                    "type": "string_content",
                                                                                    "label": " <-> ",
                                                                                    "start_token": 2246,
                                                                                    "end_token": 2246,
                                                                                    "children": []
                                                                                },
                                                                                {
                                                                                    "type": "interpolation",
                                                                                    "label": "{sink}",
                                                                                    "start_token": 2246,
                                                                                    "end_token": 2246,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "label": "sink",
                                                                                            "start_token": 2246,
                                                                                            "end_token": 2246,
                                                                                            "children": []
                                                                                        }
                                                                                    ]
                                                                                },
                                                                                {
                                                                                    "type": "string_end",
                                                                                    "label": "\"",
                                                                                    "start_token": 2246,
                                                                                    "end_token": 2246,
                                                                                    "children": []
                                                                                }
                                                                            ]
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        },
                                                        {
                                                            "type": "for_statement",
                                                            "label": "for i, (node_id, name) in enumerate([source, sink]):\n                node = node_map.get(node_id)\n                if not node:\n                    raise ValueError(\n                        f\"{suffix}, {node_id} is invalid node id, available nodes: {node_map.keys()}\"\n                    )\n\n                block = get_block(node.block_id)\n                if not block:\n                    blocks = {v().id: v().name for v in get_blocks().values()}\n                    raise ValueError(\n                        f\"{suffix}, {node.block_id} is invalid block id, available blocks: {blocks}\"\n                    )\n\n                sanitized_name = sanitize(name)\n                vals = node.input_default\n                if i == 0:\n                    fields = (\n                        block.output_schema.get_fields()\n                        if block.block_type != BlockType.AGENT\n                        else vals.get(\"output_schema\", {}).get(\"properties\", {}).keys()\n                    )\n                else:\n                    fields = (\n                        block.input_schema.get_fields()\n                        if block.block_type != BlockType.AGENT\n                        else vals.get(\"input_schema\", {}).get(\"properties\", {}).keys()\n                    )\n                if sanitized_name not in fields:\n                    fields_msg = f\"Allowed fields: {fields}\"\n                    raise ValueError(f\"{suffix}, `{name}` invalid, {fields_msg}\")",
                                                            "start_token": 2249,
                                                            "end_token": 2476,
                                                            "children": [
                                                                {
                                                                    "type": "pattern_list",
                                                                    "label": "i, (node_id, name)",
                                                                    "start_token": 2250,
                                                                    "end_token": 2256,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "i",
                                                                            "start_token": 2250,
                                                                            "end_token": 2250,
                                                                            "children": []
                                                                        },
                                                                        {
                                                                            "type": "tuple_pattern",
                                                                            "label": "(node_id, name)",
                                                                            "start_token": 2252,
                                                                            "end_token": 2256,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "node_id",
                                                                                    "start_token": 2253,
                                                                                    "end_token": 2253,
                                                                                    "children": []
                                                                                },
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "name",
                                                                                    "start_token": 2255,
                                                                                    "end_token": 2255,
                                                                                    "children": []
                                                                                }
                                                                            ]
                                                                        }
                                                                    ]
                                                                },
                                                                {
                                                                    "type": "call",
                                                                    "label": "enumerate([source, sink])",
                                                                    "start_token": 2258,
                                                                    "end_token": 2265,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "enumerate",
                                                                            "start_token": 2258,
                                                                            "end_token": 2258,
                                                                            "children": []
                                                                        },
                                                                        {
                                                                            "type": "argument_list",
                                                                            "label": "([source, sink])",
                                                                            "start_token": 2259,
                                                                            "end_token": 2265,
                                                                            "children": [
                                                                                {
                                                                                    "type": "list",
                                                                                    "label": "[source, sink]",
                                                                                    "start_token": 2260,
                                                                                    "end_token": 2264,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "label": "source",
                                                                                            "start_token": 2261,
                                                                                            "end_token": 2261,
                                                                                            "children": []
                                                                                        },
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "label": "sink",
                                                                                            "start_token": 2263,
                                                                                            "end_token": 2263,
                                                                                            "children": []
                                                                                        }
                                                                                    ]
                                                                                }
                                                                            ]
                                                                        }
                                                                    ]
                                                                },
                                                                {
                                                                    "type": "block",
                                                                    "label": "node = node_map.get(node_id)\n                if not node:\n                    raise ValueError(\n                        f\"{suffix}, {node_id} is invalid node id, available nodes: {node_map.keys()}\"\n                    )\n\n                block = get_block(node.block_id)\n                if not block:\n                    blocks = {v().id: v().name for v in get_blocks().values()}\n                    raise ValueError(\n                        f\"{suffix}, {node.block_id} is invalid block id, available blocks: {blocks}\"\n                    )\n\n                sanitized_name = sanitize(name)\n                vals = node.input_default\n                if i == 0:\n                    fields = (\n                        block.output_schema.get_fields()\n                        if block.block_type != BlockType.AGENT\n                        else vals.get(\"output_schema\", {}).get(\"properties\", {}).keys()\n                    )\n                else:\n                    fields = (\n                        block.input_schema.get_fields()\n                        if block.block_type != BlockType.AGENT\n                        else vals.get(\"input_schema\", {}).get(\"properties\", {}).keys()\n                    )\n                if sanitized_name not in fields:\n                    fields_msg = f\"Allowed fields: {fields}\"\n                    raise ValueError(f\"{suffix}, `{name}` invalid, {fields_msg}\")",
                                                                    "start_token": 2268,
                                                                    "end_token": 2476,
                                                                    "children": [
                                                                        {
                                                                            "type": "expression_statement",
                                                                            "label": "node = node_map.get(node_id)",
                                                                            "start_token": 2268,
                                                                            "end_token": 2275,
                                                                            "children": [
                                                                                {
                                                                                    "type": "assignment",
                                                                                    "label": "node = node_map.get(node_id)",
                                                                                    "start_token": 2268,
                                                                                    "end_token": 2275,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "label": "node",
                                                                                            "start_token": 2268,
                                                                                            "end_token": 2268,
                                                                                            "children": []
                                                                                        },
                                                                                        {
                                                                                            "type": "call",
                                                                                            "label": "node_map.get(node_id)",
                                                                                            "start_token": 2270,
                                                                                            "end_token": 2275,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "attribute",
                                                                                                    "label": "node_map.get",
                                                                                                    "start_token": 2270,
                                                                                                    "end_token": 2272,
                                                                                                    "children": [
                                                                                                        {
                                                                                                            "type": "identifier",
                                                                                                            "label": "node_map",
                                                                                                            "start_token": 2270,
                                                                                                            "end_token": 2270,
                                                                                                            "children": []
                                                                                                        },
                                                                                                        {
                                                                                                            "type": "identifier",
                                                                                                            "label": "get",
                                                                                                            "start_token": 2272,
                                                                                                            "end_token": 2272,
                                                                                                            "children": []
                                                                                                        }
                                                                                                    ]
                                                                                                },
                                                                                                {
                                                                                                    "type": "argument_list",
                                                                                                    "label": "(node_id)",
                                                                                                    "start_token": 2273,
                                                                                                    "end_token": 2275,
                                                                                                    "children": [
                                                                                                        {
                                                                                                            "type": "identifier",
                                                                                                            "label": "node_id",
                                                                                                            "start_token": 2274,
                                                                                                            "end_token": 2274,
                                                                                                            "children": []
                                                                                                        }
                                                                                                    ]
                                                                                                }
                                                                                            ]
                                                                                        }
                                                                                    ]
                                                                                }
                                                                            ]
                                                                        },
                                                                        {
                                                                            "type": "if_statement",
                                                                            "label": "if not node:\n                    raise ValueError(\n                        f\"{suffix}, {node_id} is invalid node id, available nodes: {node_map.keys()}\"\n                    )",
                                                                            "start_token": 2277,
                                                                            "end_token": 2289,
                                                                            "children": [
                                                                                {
                                                                                    "type": "not_operator",
                                                                                    "label": "not node",
                                                                                    "start_token": 2278,
                                                                                    "end_token": 2279,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "label": "node",
                                                                                            "start_token": 2279,
                                                                                            "end_token": 2279,
                                                                                            "children": []
                                                                                        }
                                                                                    ]
                                                                                },
                                                                                {
                                                                                    "type": "block",
                                                                                    "label": "raise ValueError(\n                        f\"{suffix}, {node_id} is invalid node id, available nodes: {node_map.keys()}\"\n                    )",
                                                                                    "start_token": 2282,
                                                                                    "end_token": 2289,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "raise_statement",
                                                                                            "label": "raise ValueError(\n                        f\"{suffix}, {node_id} is invalid node id, available nodes: {node_map.keys()}\"\n                    )",
                                                                                            "start_token": 2282,
                                                                                            "end_token": 2289,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "call",
                                                                                                    "label": "ValueError(\n                        f\"{suffix}, {node_id} is invalid node id, available nodes: {node_map.keys()}\"\n                    )",
                                                                                                    "start_token": 2283,
                                                                                                    "end_token": 2289,
                                                                                                    "children": [
                                                                                                        {
                                                                                                            "type": "identifier",
                                                                                                            "label": "ValueError",
                                                                                                            "start_token": 2283,
                                                                                                            "end_token": 2283,
                                                                                                            "children": []
                                                                                                        },
                                                                                                        {
                                                                                                            "type": "argument_list",
                                                                                                            "label": "(\n                        f\"{suffix}, {node_id} is invalid node id, available nodes: {node_map.keys()}\"\n                    )",
                                                                                                            "start_token": 2284,
                                                                                                            "end_token": 2289,
                                                                                                            "children": [
                                                                                                                {
                                                                                                                    "type": "string",
                                                                                                                    "label": "f\"{suffix}, {node_id} is invalid node id, available nodes: {node_map.keys()}\"",
                                                                                                                    "start_token": 2286,
                                                                                                                    "end_token": 2287,
                                                                                                                    "children": [
                                                                                                                        {
                                                                                                                            "type": "string_start",
                                                                                                                            "label": "f\"",
                                                                                                                            "start_token": 2286,
                                                                                                                            "end_token": 2287,
                                                                                                                            "children": []
                                                                                                                        },
                                                                                                                        {
                                                                                                                            "type": "interpolation",
                                                                                                                            "label": "{suffix}",
                                                                                                                            "start_token": 2287,
                                                                                                                            "end_token": 2287,
                                                                                                                            "children": [
                                                                                                                                {
                                                                                                                                    "type": "identifier",
                                                                                                                                    "label": "suffix",
                                                                                                                                    "start_token": 2287,
                                                                                                                                    "end_token": 2287,
                                                                                                                                    "children": []
                                                                                                                                }
                                                                                                                            ]
                                                                                                                        },
                                                                                                                        {
                                                                                                                            "type": "string_content",
                                                                                                                            "label": ", ",
                                                                                                                            "start_token": 2287,
                                                                                                                            "end_token": 2287,
                                                                                                                            "children": []
                                                                                                                        },
                                                                                                                        {
                                                                                                                            "type": "interpolation",
                                                                                                                            "label": "{node_id}",
                                                                                                                            "start_token": 2287,
                                                                                                                            "end_token": 2287,
                                                                                                                            "children": [
                                                                                                                                {
                                                                                                                                    "type": "identifier",
                                                                                                                                    "label": "node_id",
                                                                                                                                    "start_token": 2287,
                                                                                                                                    "end_token": 2287,
                                                                                                                                    "children": []
                                                                                                                                }
                                                                                                                            ]
                                                                                                                        },
                                                                                                                        {
                                                                                                                            "type": "string_content",
                                                                                                                            "label": " is invalid node id, available nodes: ",
                                                                                                                            "start_token": 2287,
                                                                                                                            "end_token": 2287,
                                                                                                                            "children": []
                                                                                                                        },
                                                                                                                        {
                                                                                                                            "type": "interpolation",
                                                                                                                            "label": "{node_map.keys()}",
                                                                                                                            "start_token": 2287,
                                                                                                                            "end_token": 2287,
                                                                                                                            "children": [
                                                                                                                                {
                                                                                                                                    "type": "call",
                                                                                                                                    "label": "node_map.keys()",
                                                                                                                                    "start_token": 2287,
                                                                                                                                    "end_token": 2287,
                                                                                                                                    "children": [
                                                                                                                                        {
                                                                                                                                            "type": "attribute",
                                                                                                                                            "label": "node_map.keys",
                                                                                                                                            "start_token": 2287,
                                                                                                                                            "end_token": 2287,
                                                                                                                                            "children": [
                                                                                                                                                {
                                                                                                                                                    "type": "identifier",
                                                                                                                                                    "label": "node_map",
                                                                                                                                                    "start_token": 2287,
                                                                                                                                                    "end_token": 2287,
                                                                                                                                                    "children": []
                                                                                                                                                },
                                                                                                                                                {
                                                                                                                                                    "type": "identifier",
                                                                                                                                                    "label": "keys",
                                                                                                                                                    "start_token": 2287,
                                                                                                                                                    "end_token": 2287,
                                                                                                                                                    "children": []
                                                                                                                                                }
                                                                                                                                            ]
                                                                                                                                        },
                                                                                                                                        {
                                                                                                                                            "type": "argument_list",
                                                                                                                                            "label": "()",
                                                                                                                                            "start_token": 2287,
                                                                                                                                            "end_token": 2287,
                                                                                                                                            "children": []
                                                                                                                                        }
                                                                                                                                    ]
                                                                                                                                }
                                                                                                                            ]
                                                                                                                        },
                                                                                                                        {
                                                                                                                            "type": "string_end",
                                                                                                                            "label": "\"",
                                                                                                                            "start_token": 2287,
                                                                                                                            "end_token": 2287,
                                                                                                                            "children": []
                                                                                                                        }
                                                                                                                    ]
                                                                                                                }
                                                                                                            ]
                                                                                                        }
                                                                                                    ]
                                                                                                }
                                                                                            ]
                                                                                        }
                                                                                    ]
                                                                                }
                                                                            ]
                                                                        },
                                                                        {
                                                                            "type": "expression_statement",
                                                                            "label": "block = get_block(node.block_id)",
                                                                            "start_token": 2292,
                                                                            "end_token": 2299,
                                                                            "children": [
                                                                                {
                                                                                    "type": "assignment",
                                                                                    "label": "block = get_block(node.block_id)",
                                                                                    "start_token": 2292,
                                                                                    "end_token": 2299,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "label": "block",
                                                                                            "start_token": 2292,
                                                                                            "end_token": 2292,
                                                                                            "children": []
                                                                                        },
                                                                                        {
                                                                                            "type": "call",
                                                                                            "label": "get_block(node.block_id)",
                                                                                            "start_token": 2294,
                                                                                            "end_token": 2299,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "label": "get_block",
                                                                                                    "start_token": 2294,
                                                                                                    "end_token": 2294,
                                                                                                    "children": []
                                                                                                },
                                                                                                {
                                                                                                    "type": "argument_list",
                                                                                                    "label": "(node.block_id)",
                                                                                                    "start_token": 2295,
                                                                                                    "end_token": 2299,
                                                                                                    "children": [
                                                                                                        {
                                                                                                            "type": "attribute",
                                                                                                            "label": "node.block_id",
                                                                                                            "start_token": 2296,
                                                                                                            "end_token": 2298,
                                                                                                            "children": [
                                                                                                                {
                                                                                                                    "type": "identifier",
                                                                                                                    "label": "node",
                                                                                                                    "start_token": 2296,
                                                                                                                    "end_token": 2296,
                                                                                                                    "children": []
                                                                                                                },
                                                                                                                {
                                                                                                                    "type": "identifier",
                                                                                                                    "label": "block_id",
                                                                                                                    "start_token": 2298,
                                                                                                                    "end_token": 2298,
                                                                                                                    "children": []
                                                                                                                }
                                                                                                            ]
                                                                                                        }
                                                                                                    ]
                                                                                                }
                                                                                            ]
                                                                                        }
                                                                                    ]
                                                                                }
                                                                            ]
                                                                        },
                                                                        {
                                                                            "type": "if_statement",
                                                                            "label": "if not block:\n                    blocks = {v().id: v().name for v in get_blocks().values()}\n                    raise ValueError(\n                        f\"{suffix}, {node.block_id} is invalid block id, available blocks: {blocks}\"\n                    )",
                                                                            "start_token": 2301,
                                                                            "end_token": 2339,
                                                                            "children": [
                                                                                {
                                                                                    "type": "not_operator",
                                                                                    "label": "not block",
                                                                                    "start_token": 2302,
                                                                                    "end_token": 2303,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "label": "block",
                                                                                            "start_token": 2303,
                                                                                            "end_token": 2303,
                                                                                            "children": []
                                                                                        }
                                                                                    ]
                                                                                },
                                                                                {
                                                                                    "type": "block",
                                                                                    "label": "blocks = {v().id: v().name for v in get_blocks().values()}\n                    raise ValueError(\n                        f\"{suffix}, {node.block_id} is invalid block id, available blocks: {blocks}\"\n                    )",
                                                                                    "start_token": 2306,
                                                                                    "end_token": 2339,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "expression_statement",
                                                                                            "label": "blocks = {v().id: v().name for v in get_blocks().values()}",
                                                                                            "start_token": 2306,
                                                                                            "end_token": 2330,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "assignment",
                                                                                                    "label": "blocks = {v().id: v().name for v in get_blocks().values()}",
                                                                                                    "start_token": 2306,
                                                                                                    "end_token": 2330,
                                                                                                    "children": [
                                                                                                        {
                                                                                                            "type": "identifier",
                                                                                                            "label": "blocks",
                                                                                                            "start_token": 2306,
                                                                                                            "end_token": 2306,
                                                                                                            "children": []
                                                                                                        },
                                                                                                        {
                                                                                                            "type": "dictionary_comprehension",
                                                                                                            "label": "{v().id: v().name for v in get_blocks().values()}",
                                                                                                            "start_token": 2308,
                                                                                                            "end_token": 2330,
                                                                                                            "children": [
                                                                                                                {
                                                                                                                    "type": "pair",
                                                                                                                    "label": "v().id: v().name",
                                                                                                                    "start_token": 2309,
                                                                                                                    "end_token": 2319,
                                                                                                                    "children": [
                                                                                                                        {
                                                                                                                            "type": "attribute",
                                                                                                                            "label": "v().id",
                                                                                                                            "start_token": 2309,
                                                                                                                            "end_token": 2313,
                                                                                                                            "children": [
                                                                                                                                {
                                                                                                                                    "type": "call",
                                                                                                                                    "label": "v()",
                                                                                                                                    "start_token": 2309,
                                                                                                                                    "end_token": 2311,
                                                                                                                                    "children": [
                                                                                                                                        {
                                                                                                                                            "type": "identifier",
                                                                                                                                            "label": "v",
                                                                                                                                            "start_token": 2309,
                                                                                                                                            "end_token": 2309,
                                                                                                                                            "children": []
                                                                                                                                        },
                                                                                                                                        {
                                                                                                                                            "type": "argument_list",
                                                                                                                                            "label": "()",
                                                                                                                                            "start_token": 2310,
                                                                                                                                            "end_token": 2311,
                                                                                                                                            "children": []
                                                                                                                                        }
                                                                                                                                    ]
                                                                                                                                },
                                                                                                                                {
                                                                                                                                    "type": "identifier",
                                                                                                                                    "label": "id",
                                                                                                                                    "start_token": 2313,
                                                                                                                                    "end_token": 2313,
                                                                                                                                    "children": []
                                                                                                                                }
                                                                                                                            ]
                                                                                                                        },
                                                                                                                        {
                                                                                                                            "type": "attribute",
                                                                                                                            "label": "v().name",
                                                                                                                            "start_token": 2315,
                                                                                                                            "end_token": 2319,
                                                                                                                            "children": [
                                                                                                                                {
                                                                                                                                    "type": "call",
                                                                                                                                    "label": "v()",
                                                                                                                                    "start_token": 2315,
                                                                                                                                    "end_token": 2317,
                                                                                                                                    "children": [
                                                                                                                                        {
                                                                                                                                            "type": "identifier",
                                                                                                                                            "label": "v",
                                                                                                                                            "start_token": 2315,
                                                                                                                                            "end_token": 2315,
                                                                                                                                            "children": []
                                                                                                                                        },
                                                                                                                                        {
                                                                                                                                            "type": "argument_list",
                                                                                                                                            "label": "()",
                                                                                                                                            "start_token": 2316,
                                                                                                                                            "end_token": 2317,
                                                                                                                                            "children": []
                                                                                                                                        }
                                                                                                                                    ]
                                                                                                                                },
                                                                                                                                {
                                                                                                                                    "type": "identifier",
                                                                                                                                    "label": "name",
                                                                                                                                    "start_token": 2319,
                                                                                                                                    "end_token": 2319,
                                                                                                                                    "children": []
                                                                                                                                }
                                                                                                                            ]
                                                                                                                        }
                                                                                                                    ]
                                                                                                                },
                                                                                                                {
                                                                                                                    "type": "for_in_clause",
                                                                                                                    "label": "for v in get_blocks().values()",
                                                                                                                    "start_token": 2320,
                                                                                                                    "end_token": 2329,
                                                                                                                    "children": [
                                                                                                                        {
                                                                                                                            "type": "identifier",
                                                                                                                            "label": "v",
                                                                                                                            "start_token": 2321,
                                                                                                                            "end_token": 2321,
                                                                                                                            "children": []
                                                                                                                        },
                                                                                                                        {
                                                                                                                            "type": "call",
                                                                                                                            "label": "get_blocks().values()",
                                                                                                                            "start_token": 2323,
                                                                                                                            "end_token": 2329,
                                                                                                                            "children": [
                                                                                                                                {
                                                                                                                                    "type": "attribute",
                                                                                                                                    "label": "get_blocks().values",
                                                                                                                                    "start_token": 2323,
                                                                                                                                    "end_token": 2327,
                                                                                                                                    "children": [
                                                                                                                                        {
                                                                                                                                            "type": "call",
                                                                                                                                            "label": "get_blocks()",
                                                                                                                                            "start_token": 2323,
                                                                                                                                            "end_token": 2325,
                                                                                                                                            "children": [
                                                                                                                                                {
                                                                                                                                                    "type": "identifier",
                                                                                                                                                    "label": "get_blocks",
                                                                                                                                                    "start_token": 2323,
                                                                                                                                                    "end_token": 2323,
                                                                                                                                                    "children": []
                                                                                                                                                },
                                                                                                                                                {
                                                                                                                                                    "type": "argument_list",
                                                                                                                                                    "label": "()",
                                                                                                                                                    "start_token": 2324,
                                                                                                                                                    "end_token": 2325,
                                                                                                                                                    "children": []
                                                                                                                                                }
                                                                                                                                            ]
                                                                                                                                        },
                                                                                                                                        {
                                                                                                                                            "type": "identifier",
                                                                                                                                            "label": "values",
                                                                                                                                            "start_token": 2327,
                                                                                                                                            "end_token": 2327,
                                                                                                                                            "children": []
                                                                                                                                        }
                                                                                                                                    ]
                                                                                                                                },
                                                                                                                                {
                                                                                                                                    "type": "argument_list",
                                                                                                                                    "label": "()",
                                                                                                                                    "start_token": 2328,
                                                                                                                                    "end_token": 2329,
                                                                                                                                    "children": []
                                                                                                                                }
                                                                                                                            ]
                                                                                                                        }
                                                                                                                    ]
                                                                                                                }
                                                                                                            ]
                                                                                                        }
                                                                                                    ]
                                                                                                }
                                                                                            ]
                                                                                        },
                                                                                        {
                                                                                            "type": "raise_statement",
                                                                                            "label": "raise ValueError(\n                        f\"{suffix}, {node.block_id} is invalid block id, available blocks: {blocks}\"\n                    )",
                                                                                            "start_token": 2332,
                                                                                            "end_token": 2339,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "call",
                                                                                                    "label": "ValueError(\n                        f\"{suffix}, {node.block_id} is invalid block id, available blocks: {blocks}\"\n                    )",
                                                                                                    "start_token": 2333,
                                                                                                    "end_token": 2339,
                                                                                                    "children": [
                                                                                                        {
                                                                                                            "type": "identifier",
                                                                                                            "label": "ValueError",
                                                                                                            "start_token": 2333,
                                                                                                            "end_token": 2333,
                                                                                                            "children": []
                                                                                                        },
                                                                                                        {
                                                                                                            "type": "argument_list",
                                                                                                            "label": "(\n                        f\"{suffix}, {node.block_id} is invalid block id, available blocks: {blocks}\"\n                    )",
                                                                                                            "start_token": 2334,
                                                                                                            "end_token": 2339,
                                                                                                            "children": [
                                                                                                                {
                                                                                                                    "type": "string",
                                                                                                                    "label": "f\"{suffix}, {node.block_id} is invalid block id, available blocks: {blocks}\"",
                                                                                                                    "start_token": 2336,
                                                                                                                    "end_token": 2337,
                                                                                                                    "children": [
                                                                                                                        {
                                                                                                                            "type": "string_start",
                                                                                                                            "label": "f\"",
                                                                                                                            "start_token": 2336,
                                                                                                                            "end_token": 2337,
                                                                                                                            "children": []
                                                                                                                        },
                                                                                                                        {
                                                                                                                            "type": "interpolation",
                                                                                                                            "label": "{suffix}",
                                                                                                                            "start_token": 2337,
                                                                                                                            "end_token": 2337,
                                                                                                                            "children": [
                                                                                                                                {
                                                                                                                                    "type": "identifier",
                                                                                                                                    "label": "suffix",
                                                                                                                                    "start_token": 2337,
                                                                                                                                    "end_token": 2337,
                                                                                                                                    "children": []
                                                                                                                                }
                                                                                                                            ]
                                                                                                                        },
                                                                                                                        {
                                                                                                                            "type": "string_content",
                                                                                                                            "label": ", ",
                                                                                                                            "start_token": 2337,
                                                                                                                            "end_token": 2337,
                                                                                                                            "children": []
                                                                                                                        },
                                                                                                                        {
                                                                                                                            "type": "interpolation",
                                                                                                                            "label": "{node.block_id}",
                                                                                                                            "start_token": 2337,
                                                                                                                            "end_token": 2337,
                                                                                                                            "children": [
                                                                                                                                {
                                                                                                                                    "type": "attribute",
                                                                                                                                    "label": "node.block_id",
                                                                                                                                    "start_token": 2337,
                                                                                                                                    "end_token": 2337,
                                                                                                                                    "children": [
                                                                                                                                        {
                                                                                                                                            "type": "identifier",
                                                                                                                                            "label": "node",
                                                                                                                                            "start_token": 2337,
                                                                                                                                            "end_token": 2337,
                                                                                                                                            "children": []
                                                                                                                                        },
                                                                                                                                        {
                                                                                                                                            "type": "identifier",
                                                                                                                                            "label": "block_id",
                                                                                                                                            "start_token": 2337,
                                                                                                                                            "end_token": 2337,
                                                                                                                                            "children": []
                                                                                                                                        }
                                                                                                                                    ]
                                                                                                                                }
                                                                                                                            ]
                                                                                                                        },
                                                                                                                        {
                                                                                                                            "type": "string_content",
                                                                                                                            "label": " is invalid block id, available blocks: ",
                                                                                                                            "start_token": 2337,
                                                                                                                            "end_token": 2337,
                                                                                                                            "children": []
                                                                                                                        },
                                                                                                                        {
                                                                                                                            "type": "interpolation",
                                                                                                                            "label": "{blocks}",
                                                                                                                            "start_token": 2337,
                                                                                                                            "end_token": 2337,
                                                                                                                            "children": [
                                                                                                                                {
                                                                                                                                    "type": "identifier",
                                                                                                                                    "label": "blocks",
                                                                                                                                    "start_token": 2337,
                                                                                                                                    "end_token": 2337,
                                                                                                                                    "children": []
                                                                                                                                }
                                                                                                                            ]
                                                                                                                        },
                                                                                                                        {
                                                                                                                            "type": "string_end",
                                                                                                                            "label": "\"",
                                                                                                                            "start_token": 2337,
                                                                                                                            "end_token": 2337,
                                                                                                                            "children": []
                                                                                                                        }
                                                                                                                    ]
                                                                                                                }
                                                                                                            ]
                                                                                                        }
                                                                                                    ]
                                                                                                }
                                                                                            ]
                                                                                        }
                                                                                    ]
                                                                                }
                                                                            ]
                                                                        },
                                                                        {
                                                                            "type": "expression_statement",
                                                                            "label": "sanitized_name = sanitize(name)",
                                                                            "start_token": 2342,
                                                                            "end_token": 2347,
                                                                            "children": [
                                                                                {
                                                                                    "type": "assignment",
                                                                                    "label": "sanitized_name = sanitize(name)",
                                                                                    "start_token": 2342,
                                                                                    "end_token": 2347,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "label": "sanitized_name",
                                                                                            "start_token": 2342,
                                                                                            "end_token": 2342,
                                                                                            "children": []
                                                                                        },
                                                                                        {
                                                                                            "type": "call",
                                                                                            "label": "sanitize(name)",
                                                                                            "start_token": 2344,
                                                                                            "end_token": 2347,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "label": "sanitize",
                                                                                                    "start_token": 2344,
                                                                                                    "end_token": 2344,
                                                                                                    "children": []
                                                                                                },
                                                                                                {
                                                                                                    "type": "argument_list",
                                                                                                    "label": "(name)",
                                                                                                    "start_token": 2345,
                                                                                                    "end_token": 2347,
                                                                                                    "children": [
                                                                                                        {
                                                                                                            "type": "identifier",
                                                                                                            "label": "name",
                                                                                                            "start_token": 2346,
                                                                                                            "end_token": 2346,
                                                                                                            "children": []
                                                                                                        }
                                                                                                    ]
                                                                                                }
                                                                                            ]
                                                                                        }
                                                                                    ]
                                                                                }
                                                                            ]
                                                                        },
                                                                        {
                                                                            "type": "expression_statement",
                                                                            "label": "vals = node.input_default",
                                                                            "start_token": 2349,
                                                                            "end_token": 2353,
                                                                            "children": [
                                                                                {
                                                                                    "type": "assignment",
                                                                                    "label": "vals = node.input_default",
                                                                                    "start_token": 2349,
                                                                                    "end_token": 2353,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "label": "vals",
                                                                                            "start_token": 2349,
                                                                                            "end_token": 2349,
                                                                                            "children": []
                                                                                        },
                                                                                        {
                                                                                            "type": "attribute",
                                                                                            "label": "node.input_default",
                                                                                            "start_token": 2351,
                                                                                            "end_token": 2353,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "label": "node",
                                                                                                    "start_token": 2351,
                                                                                                    "end_token": 2351,
                                                                                                    "children": []
                                                                                                },
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "label": "input_default",
                                                                                                    "start_token": 2353,
                                                                                                    "end_token": 2353,
                                                                                                    "children": []
                                                                                                }
                                                                                            ]
                                                                                        }
                                                                                    ]
                                                                                }
                                                                            ]
                                                                        },
                                                                        {
                                                                            "type": "if_statement",
                                                                            "label": "if i == 0:\n                    fields = (\n                        block.output_schema.get_fields()\n                        if block.block_type != BlockType.AGENT\n                        else vals.get(\"output_schema\", {}).get(\"properties\", {}).keys()\n                    )\n                else:\n                    fields = (\n                        block.input_schema.get_fields()\n                        if block.block_type != BlockType.AGENT\n                        else vals.get(\"input_schema\", {}).get(\"properties\", {}).keys()\n                    )",
                                                                            "start_token": 2355,
                                                                            "end_token": 2457,
                                                                            "children": [
                                                                                {
                                                                                    "type": "comparison_operator",
                                                                                    "label": "i == 0",
                                                                                    "start_token": 2356,
                                                                                    "end_token": 2359,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "label": "i",
                                                                                            "start_token": 2356,
                                                                                            "end_token": 2356,
                                                                                            "children": []
                                                                                        },
                                                                                        {
                                                                                            "type": "integer",
                                                                                            "label": "0",
                                                                                            "start_token": 2359,
                                                                                            "end_token": 2359,
                                                                                            "children": []
                                                                                        }
                                                                                    ]
                                                                                },
                                                                                {
                                                                                    "type": "block",
                                                                                    "label": "fields = (\n                        block.output_schema.get_fields()\n                        if block.block_type != BlockType.AGENT\n                        else vals.get(\"output_schema\", {}).get(\"properties\", {}).keys()\n                    )",
                                                                                    "start_token": 2362,
                                                                                    "end_token": 2407,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "expression_statement",
                                                                                            "label": "fields = (\n                        block.output_schema.get_fields()\n                        if block.block_type != BlockType.AGENT\n                        else vals.get(\"output_schema\", {}).get(\"properties\", {}).keys()\n                    )",
                                                                                            "start_token": 2362,
                                                                                            "end_token": 2407,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "assignment",
                                                                                                    "label": "fields = (\n                        block.output_schema.get_fields()\n                        if block.block_type != BlockType.AGENT\n                        else vals.get(\"output_schema\", {}).get(\"properties\", {}).keys()\n                    )",
                                                                                                    "start_token": 2362,
                                                                                                    "end_token": 2407,
                                                                                                    "children": [
                                                                                                        {
                                                                                                            "type": "identifier",
                                                                                                            "label": "fields",
                                                                                                            "start_token": 2362,
                                                                                                            "end_token": 2362,
                                                                                                            "children": []
                                                                                                        },
                                                                                                        {
                                                                                                            "type": "parenthesized_expression",
                                                                                                            "label": "(\n                        block.output_schema.get_fields()\n                        if block.block_type != BlockType.AGENT\n                        else vals.get(\"output_schema\", {}).get(\"properties\", {}).keys()\n                    )",
                                                                                                            "start_token": 2364,
                                                                                                            "end_token": 2407,
                                                                                                            "children": [
                                                                                                                {
                                                                                                                    "type": "conditional_expression",
                                                                                                                    "label": "block.output_schema.get_fields()\n                        if block.block_type != BlockType.AGENT\n                        else vals.get(\"output_schema\", {}).get(\"properties\", {}).keys()",
                                                                                                                    "start_token": 2366,
                                                                                                                    "end_token": 2405,
                                                                                                                    "children": [
                                                                                                                        {
                                                                                                                            "type": "call",
                                                                                                                            "label": "block.output_schema.get_fields()",
                                                                                                                            "start_token": 2366,
                                                                                                                            "end_token": 2372,
                                                                                                                            "children": [
                                                                                                                                {
                                                                                                                                    "type": "attribute",
                                                                                                                                    "label": "block.output_schema.get_fields",
                                                                                                                                    "start_token": 2366,
                                                                                                                                    "end_token": 2370,
                                                                                                                                    "children": [
                                                                                                                                        {
                                                                                                                                            "type": "attribute",
                                                                                                                                            "label": "block.output_schema",
                                                                                                                                            "start_token": 2366,
                                                                                                                                            "end_token": 2368,
                                                                                                                                            "children": [
                                                                                                                                                {
                                                                                                                                                    "type": "identifier",
                                                                                                                                                    "label": "block",
                                                                                                                                                    "start_token": 2366,
                                                                                                                                                    "end_token": 2366,
                                                                                                                                                    "children": []
                                                                                                                                                },
                                                                                                                                                {
                                                                                                                                                    "type": "identifier",
                                                                                                                                                    "label": "output_schema",
                                                                                                                                                    "start_token": 2368,
                                                                                                                                                    "end_token": 2368,
                                                                                                                                                    "children": []
                                                                                                                                                }
                                                                                                                                            ]
                                                                                                                                        },
                                                                                                                                        {
                                                                                                                                            "type": "identifier",
                                                                                                                                            "label": "get_fields",
                                                                                                                                            "start_token": 2370,
                                                                                                                                            "end_token": 2370,
                                                                                                                                            "children": []
                                                                                                                                        }
                                                                                                                                    ]
                                                                                                                                },
                                                                                                                                {
                                                                                                                                    "type": "argument_list",
                                                                                                                                    "label": "()",
                                                                                                                                    "start_token": 2371,
                                                                                                                                    "end_token": 2372,
                                                                                                                                    "children": []
                                                                                                                                }
                                                                                                                            ]
                                                                                                                        },
                                                                                                                        {
                                                                                                                            "type": "comparison_operator",
                                                                                                                            "label": "block.block_type != BlockType.AGENT",
                                                                                                                            "start_token": 2375,
                                                                                                                            "end_token": 2382,
                                                                                                                            "children": [
                                                                                                                                {
                                                                                                                                    "type": "attribute",
                                                                                                                                    "label": "block.block_type",
                                                                                                                                    "start_token": 2375,
                                                                                                                                    "end_token": 2377,
                                                                                                                                    "children": [
                                                                                                                                        {
                                                                                                                                            "type": "identifier",
                                                                                                                                            "label": "block",
                                                                                                                                            "start_token": 2375,
                                                                                                                                            "end_token": 2375,
                                                                                                                                            "children": []
                                                                                                                                        },
                                                                                                                                        {
                                                                                                                                            "type": "identifier",
                                                                                                                                            "label": "block_type",
                                                                                                                                            "start_token": 2377,
                                                                                                                                            "end_token": 2377,
                                                                                                                                            "children": []
                                                                                                                                        }
                                                                                                                                    ]
                                                                                                                                },
                                                                                                                                {
                                                                                                                                    "type": "attribute",
                                                                                                                                    "label": "BlockType.AGENT",
                                                                                                                                    "start_token": 2380,
                                                                                                                                    "end_token": 2382,
                                                                                                                                    "children": [
                                                                                                                                        {
                                                                                                                                            "type": "identifier",
                                                                                                                                            "label": "BlockType",
                                                                                                                                            "start_token": 2380,
                                                                                                                                            "end_token": 2380,
                                                                                                                                            "children": []
                                                                                                                                        },
                                                                                                                                        {
                                                                                                                                            "type": "identifier",
                                                                                                                                            "label": "AGENT",
                                                                                                                                            "start_token": 2382,
                                                                                                                                            "end_token": 2382,
                                                                                                                                            "children": []
                                                                                                                                        }
                                                                                                                                    ]
                                                                                                                                }
                                                                                                                            ]
                                                                                                                        },
                                                                                                                        {
                                                                                                                            "type": "call",
                                                                                                                            "label": "vals.get(\"output_schema\", {}).get(\"properties\", {}).keys()",
                                                                                                                            "start_token": 2385,
                                                                                                                            "end_token": 2405,
                                                                                                                            "children": [
                                                                                                                                {
                                                                                                                                    "type": "attribute",
                                                                                                                                    "label": "vals.get(\"output_schema\", {}).get(\"properties\", {}).keys",
                                                                                                                                    "start_token": 2385,
                                                                                                                                    "end_token": 2403,
                                                                                                                                    "children": [
                                                                                                                                        {
                                                                                                                                            "type": "call",
                                                                                                                                            "label": "vals.get(\"output_schema\", {}).get(\"properties\", {})",
                                                                                                                                            "start_token": 2385,
                                                                                                                                            "end_token": 2401,
                                                                                                                                            "children": [
                                                                                                                                                {
                                                                                                                                                    "type": "attribute",
                                                                                                                                                    "label": "vals.get(\"output_schema\", {}).get",
                                                                                                                                                    "start_token": 2385,
                                                                                                                                                    "end_token": 2395,
                                                                                                                                                    "children": [
                                                                                                                                                        {
                                                                                                                                                            "type": "call",
                                                                                                                                                            "label": "vals.get(\"output_schema\", {})",
                                                                                                                                                            "start_token": 2385,
                                                                                                                                                            "end_token": 2393,
                                                                                                                                                            "children": [
                                                                                                                                                                {
                                                                                                                                                                    "type": "attribute",
                                                                                                                                                                    "label": "vals.get",
                                                                                                                                                                    "start_token": 2385,
                                                                                                                                                                    "end_token": 2387,
                                                                                                                                                                    "children": [
                                                                                                                                                                        {
                                                                                                                                                                            "type": "identifier",
                                                                                                                                                                            "label": "vals",
                                                                                                                                                                            "start_token": 2385,
                                                                                                                                                                            "end_token": 2385,
                                                                                                                                                                            "children": []
                                                                                                                                                                        },
                                                                                                                                                                        {
                                                                                                                                                                            "type": "identifier",
                                                                                                                                                                            "label": "get",
                                                                                                                                                                            "start_token": 2387,
                                                                                                                                                                            "end_token": 2387,
                                                                                                                                                                            "children": []
                                                                                                                                                                        }
                                                                                                                                                                    ]
                                                                                                                                                                },
                                                                                                                                                                {
                                                                                                                                                                    "type": "argument_list",
                                                                                                                                                                    "label": "(\"output_schema\", {})",
                                                                                                                                                                    "start_token": 2388,
                                                                                                                                                                    "end_token": 2393,
                                                                                                                                                                    "children": [
                                                                                                                                                                        {
                                                                                                                                                                            "type": "string",
                                                                                                                                                                            "label": "\"output_schema\"",
                                                                                                                                                                            "start_token": 2389,
                                                                                                                                                                            "end_token": 2389,
                                                                                                                                                                            "children": [
                                                                                                                                                                                {
                                                                                                                                                                                    "type": "string_start",
                                                                                                                                                                                    "label": "\"",
                                                                                                                                                                                    "start_token": 2389,
                                                                                                                                                                                    "end_token": 2389,
                                                                                                                                                                                    "children": []
                                                                                                                                                                                },
                                                                                                                                                                                {
                                                                                                                                                                                    "type": "string_content",
                                                                                                                                                                                    "label": "output_schema",
                                                                                                                                                                                    "start_token": 2389,
                                                                                                                                                                                    "end_token": 2389,
                                                                                                                                                                                    "children": []
                                                                                                                                                                                },
                                                                                                                                                                                {
                                                                                                                                                                                    "type": "string_end",
                                                                                                                                                                                    "label": "\"",
                                                                                                                                                                                    "start_token": 2389,
                                                                                                                                                                                    "end_token": 2389,
                                                                                                                                                                                    "children": []
                                                                                                                                                                                }
                                                                                                                                                                            ]
                                                                                                                                                                        },
                                                                                                                                                                        {
                                                                                                                                                                            "type": "dictionary",
                                                                                                                                                                            "label": "{}",
                                                                                                                                                                            "start_token": 2391,
                                                                                                                                                                            "end_token": 2392,
                                                                                                                                                                            "children": []
                                                                                                                                                                        }
                                                                                                                                                                    ]
                                                                                                                                                                }
                                                                                                                                                            ]
                                                                                                                                                        },
                                                                                                                                                        {
                                                                                                                                                            "type": "identifier",
                                                                                                                                                            "label": "get",
                                                                                                                                                            "start_token": 2395,
                                                                                                                                                            "end_token": 2395,
                                                                                                                                                            "children": []
                                                                                                                                                        }
                                                                                                                                                    ]
                                                                                                                                                },
                                                                                                                                                {
                                                                                                                                                    "type": "argument_list",
                                                                                                                                                    "label": "(\"properties\", {})",
                                                                                                                                                    "start_token": 2396,
                                                                                                                                                    "end_token": 2401,
                                                                                                                                                    "children": [
                                                                                                                                                        {
                                                                                                                                                            "type": "string",
                                                                                                                                                            "label": "\"properties\"",
                                                                                                                                                            "start_token": 2397,
                                                                                                                                                            "end_token": 2397,
                                                                                                                                                            "children": [
                                                                                                                                                                {
                                                                                                                                                                    "type": "string_start",
                                                                                                                                                                    "label": "\"",
                                                                                                                                                                    "start_token": 2397,
                                                                                                                                                                    "end_token": 2397,
                                                                                                                                                                    "children": []
                                                                                                                                                                },
                                                                                                                                                                {
                                                                                                                                                                    "type": "string_content",
                                                                                                                                                                    "label": "properties",
                                                                                                                                                                    "start_token": 2397,
                                                                                                                                                                    "end_token": 2397,
                                                                                                                                                                    "children": []
                                                                                                                                                                },
                                                                                                                                                                {
                                                                                                                                                                    "type": "string_end",
                                                                                                                                                                    "label": "\"",
                                                                                                                                                                    "start_token": 2397,
                                                                                                                                                                    "end_token": 2397,
                                                                                                                                                                    "children": []
                                                                                                                                                                }
                                                                                                                                                            ]
                                                                                                                                                        },
                                                                                                                                                        {
                                                                                                                                                            "type": "dictionary",
                                                                                                                                                            "label": "{}",
                                                                                                                                                            "start_token": 2399,
                                                                                                                                                            "end_token": 2400,
                                                                                                                                                            "children": []
                                                                                                                                                        }
                                                                                                                                                    ]
                                                                                                                                                }
                                                                                                                                            ]
                                                                                                                                        },
                                                                                                                                        {
                                                                                                                                            "type": "identifier",
                                                                                                                                            "label": "keys",
                                                                                                                                            "start_token": 2403,
                                                                                                                                            "end_token": 2403,
                                                                                                                                            "children": []
                                                                                                                                        }
                                                                                                                                    ]
                                                                                                                                },
                                                                                                                                {
                                                                                                                                    "type": "argument_list",
                                                                                                                                    "label": "()",
                                                                                                                                    "start_token": 2404,
                                                                                                                                    "end_token": 2405,
                                                                                                                                    "children": []
                                                                                                                                }
                                                                                                                            ]
                                                                                                                        }
                                                                                                                    ]
                                                                                                                }
                                                                                                            ]
                                                                                                        }
                                                                                                    ]
                                                                                                }
                                                                                            ]
                                                                                        }
                                                                                    ]
                                                                                },
                                                                                {
                                                                                    "type": "else_clause",
                                                                                    "label": "else:\n                    fields = (\n                        block.input_schema.get_fields()\n                        if block.block_type != BlockType.AGENT\n                        else vals.get(\"input_schema\", {}).get(\"properties\", {}).keys()\n                    )",
                                                                                    "start_token": 2409,
                                                                                    "end_token": 2457,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "block",
                                                                                            "label": "fields = (\n                        block.input_schema.get_fields()\n                        if block.block_type != BlockType.AGENT\n                        else vals.get(\"input_schema\", {}).get(\"properties\", {}).keys()\n                    )",
                                                                                            "start_token": 2412,
                                                                                            "end_token": 2457,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "expression_statement",
                                                                                                    "label": "fields = (\n                        block.input_schema.get_fields()\n                        if block.block_type != BlockType.AGENT\n                        else vals.get(\"input_schema\", {}).get(\"properties\", {}).keys()\n                    )",
                                                                                                    "start_token": 2412,
                                                                                                    "end_token": 2457,
                                                                                                    "children": [
                                                                                                        {
                                                                                                            "type": "assignment",
                                                                                                            "label": "fields = (\n                        block.input_schema.get_fields()\n                        if block.block_type != BlockType.AGENT\n                        else vals.get(\"input_schema\", {}).get(\"properties\", {}).keys()\n                    )",
                                                                                                            "start_token": 2412,
                                                                                                            "end_token": 2457,
                                                                                                            "children": [
                                                                                                                {
                                                                                                                    "type": "identifier",
                                                                                                                    "label": "fields",
                                                                                                                    "start_token": 2412,
                                                                                                                    "end_token": 2412,
                                                                                                                    "children": []
                                                                                                                },
                                                                                                                {
                                                                                                                    "type": "parenthesized_expression",
                                                                                                                    "label": "(\n                        block.input_schema.get_fields()\n                        if block.block_type != BlockType.AGENT\n                        else vals.get(\"input_schema\", {}).get(\"properties\", {}).keys()\n                    )",
                                                                                                                    "start_token": 2414,
                                                                                                                    "end_token": 2457,
                                                                                                                    "children": [
                                                                                                                        {
                                                                                                                            "type": "conditional_expression",
                                                                                                                            "label": "block.input_schema.get_fields()\n                        if block.block_type != BlockType.AGENT\n                        else vals.get(\"input_schema\", {}).get(\"properties\", {}).keys()",
                                                                                                                            "start_token": 2416,
                                                                                                                            "end_token": 2455,
                                                                                                                            "children": [
                                                                                                                                {
                                                                                                                                    "type": "call",
                                                                                                                                    "label": "block.input_schema.get_fields()",
                                                                                                                                    "start_token": 2416,
                                                                                                                                    "end_token": 2422,
                                                                                                                                    "children": [
                                                                                                                                        {
                                                                                                                                            "type": "attribute",
                                                                                                                                            "label": "block.input_schema.get_fields",
                                                                                                                                            "start_token": 2416,
                                                                                                                                            "end_token": 2420,
                                                                                                                                            "children": [
                                                                                                                                                {
                                                                                                                                                    "type": "attribute",
                                                                                                                                                    "label": "block.input_schema",
                                                                                                                                                    "start_token": 2416,
                                                                                                                                                    "end_token": 2418,
                                                                                                                                                    "children": [
                                                                                                                                                        {
                                                                                                                                                            "type": "identifier",
                                                                                                                                                            "label": "block",
                                                                                                                                                            "start_token": 2416,
                                                                                                                                                            "end_token": 2416,
                                                                                                                                                            "children": []
                                                                                                                                                        },
                                                                                                                                                        {
                                                                                                                                                            "type": "identifier",
                                                                                                                                                            "label": "input_schema",
                                                                                                                                                            "start_token": 2418,
                                                                                                                                                            "end_token": 2418,
                                                                                                                                                            "children": []
                                                                                                                                                        }
                                                                                                                                                    ]
                                                                                                                                                },
                                                                                                                                                {
                                                                                                                                                    "type": "identifier",
                                                                                                                                                    "label": "get_fields",
                                                                                                                                                    "start_token": 2420,
                                                                                                                                                    "end_token": 2420,
                                                                                                                                                    "children": []
                                                                                                                                                }
                                                                                                                                            ]
                                                                                                                                        },
                                                                                                                                        {
                                                                                                                                            "type": "argument_list",
                                                                                                                                            "label": "()",
                                                                                                                                            "start_token": 2421,
                                                                                                                                            "end_token": 2422,
                                                                                                                                            "children": []
                                                                                                                                        }
                                                                                                                                    ]
                                                                                                                                },
                                                                                                                                {
                                                                                                                                    "type": "comparison_operator",
                                                                                                                                    "label": "block.block_type != BlockType.AGENT",
                                                                                                                                    "start_token": 2425,
                                                                                                                                    "end_token": 2432,
                                                                                                                                    "children": [
                                                                                                                                        {
                                                                                                                                            "type": "attribute",
                                                                                                                                            "label": "block.block_type",
                                                                                                                                            "start_token": 2425,
                                                                                                                                            "end_token": 2427,
                                                                                                                                            "children": [
                                                                                                                                                {
                                                                                                                                                    "type": "identifier",
                                                                                                                                                    "label": "block",
                                                                                                                                                    "start_token": 2425,
                                                                                                                                                    "end_token": 2425,
                                                                                                                                                    "children": []
                                                                                                                                                },
                                                                                                                                                {
                                                                                                                                                    "type": "identifier",
                                                                                                                                                    "label": "block_type",
                                                                                                                                                    "start_token": 2427,
                                                                                                                                                    "end_token": 2427,
                                                                                                                                                    "children": []
                                                                                                                                                }
                                                                                                                                            ]
                                                                                                                                        },
                                                                                                                                        {
                                                                                                                                            "type": "attribute",
                                                                                                                                            "label": "BlockType.AGENT",
                                                                                                                                            "start_token": 2430,
                                                                                                                                            "end_token": 2432,
                                                                                                                                            "children": [
                                                                                                                                                {
                                                                                                                                                    "type": "identifier",
                                                                                                                                                    "label": "BlockType",
                                                                                                                                                    "start_token": 2430,
                                                                                                                                                    "end_token": 2430,
                                                                                                                                                    "children": []
                                                                                                                                                },
                                                                                                                                                {
                                                                                                                                                    "type": "identifier",
                                                                                                                                                    "label": "AGENT",
                                                                                                                                                    "start_token": 2432,
                                                                                                                                                    "end_token": 2432,
                                                                                                                                                    "children": []
                                                                                                                                                }
                                                                                                                                            ]
                                                                                                                                        }
                                                                                                                                    ]
                                                                                                                                },
                                                                                                                                {
                                                                                                                                    "type": "call",
                                                                                                                                    "label": "vals.get(\"input_schema\", {}).get(\"properties\", {}).keys()",
                                                                                                                                    "start_token": 2435,
                                                                                                                                    "end_token": 2455,
                                                                                                                                    "children": [
                                                                                                                                        {
                                                                                                                                            "type": "attribute",
                                                                                                                                            "label": "vals.get(\"input_schema\", {}).get(\"properties\", {}).keys",
                                                                                                                                            "start_token": 2435,
                                                                                                                                            "end_token": 2453,
                                                                                                                                            "children": [
                                                                                                                                                {
                                                                                                                                                    "type": "call",
                                                                                                                                                    "label": "vals.get(\"input_schema\", {}).get(\"properties\", {})",
                                                                                                                                                    "start_token": 2435,
                                                                                                                                                    "end_token": 2451,
                                                                                                                                                    "children": [
                                                                                                                                                        {
                                                                                                                                                            "type": "attribute",
                                                                                                                                                            "label": "vals.get(\"input_schema\", {}).get",
                                                                                                                                                            "start_token": 2435,
                                                                                                                                                            "end_token": 2445,
                                                                                                                                                            "children": [
                                                                                                                                                                {
                                                                                                                                                                    "type": "call",
                                                                                                                                                                    "label": "vals.get(\"input_schema\", {})",
                                                                                                                                                                    "start_token": 2435,
                                                                                                                                                                    "end_token": 2443,
                                                                                                                                                                    "children": [
                                                                                                                                                                        {
                                                                                                                                                                            "type": "attribute",
                                                                                                                                                                            "label": "vals.get",
                                                                                                                                                                            "start_token": 2435,
                                                                                                                                                                            "end_token": 2437,
                                                                                                                                                                            "children": [
                                                                                                                                                                                {
                                                                                                                                                                                    "type": "identifier",
                                                                                                                                                                                    "label": "vals",
                                                                                                                                                                                    "start_token": 2435,
                                                                                                                                                                                    "end_token": 2435,
                                                                                                                                                                                    "children": []
                                                                                                                                                                                },
                                                                                                                                                                                {
                                                                                                                                                                                    "type": "identifier",
                                                                                                                                                                                    "label": "get",
                                                                                                                                                                                    "start_token": 2437,
                                                                                                                                                                                    "end_token": 2437,
                                                                                                                                                                                    "children": []
                                                                                                                                                                                }
                                                                                                                                                                            ]
                                                                                                                                                                        },
                                                                                                                                                                        {
                                                                                                                                                                            "type": "argument_list",
                                                                                                                                                                            "label": "(\"input_schema\", {})",
                                                                                                                                                                            "start_token": 2438,
                                                                                                                                                                            "end_token": 2443,
                                                                                                                                                                            "children": [
                                                                                                                                                                                {
                                                                                                                                                                                    "type": "string",
                                                                                                                                                                                    "label": "\"input_schema\"",
                                                                                                                                                                                    "start_token": 2439,
                                                                                                                                                                                    "end_token": 2439,
                                                                                                                                                                                    "children": [
                                                                                                                                                                                        {
                                                                                                                                                                                            "type": "string_start",
                                                                                                                                                                                            "label": "\"",
                                                                                                                                                                                            "start_token": 2439,
                                                                                                                                                                                            "end_token": 2439,
                                                                                                                                                                                            "children": []
                                                                                                                                                                                        },
                                                                                                                                                                                        {
                                                                                                                                                                                            "type": "string_content",
                                                                                                                                                                                            "label": "input_schema",
                                                                                                                                                                                            "start_token": 2439,
                                                                                                                                                                                            "end_token": 2439,
                                                                                                                                                                                            "children": []
                                                                                                                                                                                        },
                                                                                                                                                                                        {
                                                                                                                                                                                            "type": "string_end",
                                                                                                                                                                                            "label": "\"",
                                                                                                                                                                                            "start_token": 2439,
                                                                                                                                                                                            "end_token": 2439,
                                                                                                                                                                                            "children": []
                                                                                                                                                                                        }
                                                                                                                                                                                    ]
                                                                                                                                                                                },
                                                                                                                                                                                {
                                                                                                                                                                                    "type": "dictionary",
                                                                                                                                                                                    "label": "{}",
                                                                                                                                                                                    "start_token": 2441,
                                                                                                                                                                                    "end_token": 2442,
                                                                                                                                                                                    "children": []
                                                                                                                                                                                }
                                                                                                                                                                            ]
                                                                                                                                                                        }
                                                                                                                                                                    ]
                                                                                                                                                                },
                                                                                                                                                                {
                                                                                                                                                                    "type": "identifier",
                                                                                                                                                                    "label": "get",
                                                                                                                                                                    "start_token": 2445,
                                                                                                                                                                    "end_token": 2445,
                                                                                                                                                                    "children": []
                                                                                                                                                                }
                                                                                                                                                            ]
                                                                                                                                                        },
                                                                                                                                                        {
                                                                                                                                                            "type": "argument_list",
                                                                                                                                                            "label": "(\"properties\", {})",
                                                                                                                                                            "start_token": 2446,
                                                                                                                                                            "end_token": 2451,
                                                                                                                                                            "children": [
                                                                                                                                                                {
                                                                                                                                                                    "type": "string",
                                                                                                                                                                    "label": "\"properties\"",
                                                                                                                                                                    "start_token": 2447,
                                                                                                                                                                    "end_token": 2447,
                                                                                                                                                                    "children": [
                                                                                                                                                                        {
                                                                                                                                                                            "type": "string_start",
                                                                                                                                                                            "label": "\"",
                                                                                                                                                                            "start_token": 2447,
                                                                                                                                                                            "end_token": 2447,
                                                                                                                                                                            "children": []
                                                                                                                                                                        },
                                                                                                                                                                        {
                                                                                                                                                                            "type": "string_content",
                                                                                                                                                                            "label": "properties",
                                                                                                                                                                            "start_token": 2447,
                                                                                                                                                                            "end_token": 2447,
                                                                                                                                                                            "children": []
                                                                                                                                                                        },
                                                                                                                                                                        {
                                                                                                                                                                            "type": "string_end",
                                                                                                                                                                            "label": "\"",
                                                                                                                                                                            "start_token": 2447,
                                                                                                                                                                            "end_token": 2447,
                                                                                                                                                                            "children": []
                                                                                                                                                                        }
                                                                                                                                                                    ]
                                                                                                                                                                },
                                                                                                                                                                {
                                                                                                                                                                    "type": "dictionary",
                                                                                                                                                                    "label": "{}",
                                                                                                                                                                    "start_token": 2449,
                                                                                                                                                                    "end_token": 2450,
                                                                                                                                                                    "children": []
                                                                                                                                                                }
                                                                                                                                                            ]
                                                                                                                                                        }
                                                                                                                                                    ]
                                                                                                                                                },
                                                                                                                                                {
                                                                                                                                                    "type": "identifier",
                                                                                                                                                    "label": "keys",
                                                                                                                                                    "start_token": 2453,
                                                                                                                                                    "end_token": 2453,
                                                                                                                                                    "children": []
                                                                                                                                                }
                                                                                                                                            ]
                                                                                                                                        },
                                                                                                                                        {
                                                                                                                                            "type": "argument_list",
                                                                                                                                            "label": "()",
                                                                                                                                            "start_token": 2454,
                                                                                                                                            "end_token": 2455,
                                                                                                                                            "children": []
                                                                                                                                        }
                                                                                                                                    ]
                                                                                                                                }
                                                                                                                            ]
                                                                                                                        }
                                                                                                                    ]
                                                                                                                }
                                                                                                            ]
                                                                                                        }
                                                                                                    ]
                                                                                                }
                                                                                            ]
                                                                                        }
                                                                                    ]
                                                                                }
                                                                            ]
                                                                        },
                                                                        {
                                                                            "type": "if_statement",
                                                                            "label": "if sanitized_name not in fields:\n                    fields_msg = f\"Allowed fields: {fields}\"\n                    raise ValueError(f\"{suffix}, `{name}` invalid, {fields_msg}\")",
                                                                            "start_token": 2459,
                                                                            "end_token": 2476,
                                                                            "children": [
                                                                                {
                                                                                    "type": "comparison_operator",
                                                                                    "label": "sanitized_name not in fields",
                                                                                    "start_token": 2460,
                                                                                    "end_token": 2463,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "label": "sanitized_name",
                                                                                            "start_token": 2460,
                                                                                            "end_token": 2460,
                                                                                            "children": []
                                                                                        },
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "label": "fields",
                                                                                            "start_token": 2463,
                                                                                            "end_token": 2463,
                                                                                            "children": []
                                                                                        }
                                                                                    ]
                                                                                },
                                                                                {
                                                                                    "type": "block",
                                                                                    "label": "fields_msg = f\"Allowed fields: {fields}\"\n                    raise ValueError(f\"{suffix}, `{name}` invalid, {fields_msg}\")",
                                                                                    "start_token": 2466,
                                                                                    "end_token": 2476,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "expression_statement",
                                                                                            "label": "fields_msg = f\"Allowed fields: {fields}\"",
                                                                                            "start_token": 2466,
                                                                                            "end_token": 2469,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "assignment",
                                                                                                    "label": "fields_msg = f\"Allowed fields: {fields}\"",
                                                                                                    "start_token": 2466,
                                                                                                    "end_token": 2469,
                                                                                                    "children": [
                                                                                                        {
                                                                                                            "type": "identifier",
                                                                                                            "label": "fields_msg",
                                                                                                            "start_token": 2466,
                                                                                                            "end_token": 2466,
                                                                                                            "children": []
                                                                                                        },
                                                                                                        {
                                                                                                            "type": "string",
                                                                                                            "label": "f\"Allowed fields: {fields}\"",
                                                                                                            "start_token": 2468,
                                                                                                            "end_token": 2469,
                                                                                                            "children": [
                                                                                                                {
                                                                                                                    "type": "string_start",
                                                                                                                    "label": "f\"",
                                                                                                                    "start_token": 2468,
                                                                                                                    "end_token": 2469,
                                                                                                                    "children": []
                                                                                                                },
                                                                                                                {
                                                                                                                    "type": "string_content",
                                                                                                                    "label": "Allowed fields: ",
                                                                                                                    "start_token": 2469,
                                                                                                                    "end_token": 2469,
                                                                                                                    "children": []
                                                                                                                },
                                                                                                                {
                                                                                                                    "type": "interpolation",
                                                                                                                    "label": "{fields}",
                                                                                                                    "start_token": 2469,
                                                                                                                    "end_token": 2469,
                                                                                                                    "children": [
                                                                                                                        {
                                                                                                                            "type": "identifier",
                                                                                                                            "label": "fields",
                                                                                                                            "start_token": 2469,
                                                                                                                            "end_token": 2469,
                                                                                                                            "children": []
                                                                                                                        }
                                                                                                                    ]
                                                                                                                },
                                                                                                                {
                                                                                                                    "type": "string_end",
                                                                                                                    "label": "\"",
                                                                                                                    "start_token": 2469,
                                                                                                                    "end_token": 2469,
                                                                                                                    "children": []
                                                                                                                }
                                                                                                            ]
                                                                                                        }
                                                                                                    ]
                                                                                                }
                                                                                            ]
                                                                                        },
                                                                                        {
                                                                                            "type": "raise_statement",
                                                                                            "label": "raise ValueError(f\"{suffix}, `{name}` invalid, {fields_msg}\")",
                                                                                            "start_token": 2471,
                                                                                            "end_token": 2476,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "call",
                                                                                                    "label": "ValueError(f\"{suffix}, `{name}` invalid, {fields_msg}\")",
                                                                                                    "start_token": 2472,
                                                                                                    "end_token": 2476,
                                                                                                    "children": [
                                                                                                        {
                                                                                                            "type": "identifier",
                                                                                                            "label": "ValueError",
                                                                                                            "start_token": 2472,
                                                                                                            "end_token": 2472,
                                                                                                            "children": []
                                                                                                        },
                                                                                                        {
                                                                                                            "type": "argument_list",
                                                                                                            "label": "(f\"{suffix}, `{name}` invalid, {fields_msg}\")",
                                                                                                            "start_token": 2473,
                                                                                                            "end_token": 2476,
                                                                                                            "children": [
                                                                                                                {
                                                                                                                    "type": "string",
                                                                                                                    "label": "f\"{suffix}, `{name}` invalid, {fields_msg}\"",
                                                                                                                    "start_token": 2474,
                                                                                                                    "end_token": 2475,
                                                                                                                    "children": [
                                                                                                                        {
                                                                                                                            "type": "string_start",
                                                                                                                            "label": "f\"",
                                                                                                                            "start_token": 2474,
                                                                                                                            "end_token": 2475,
                                                                                                                            "children": []
                                                                                                                        },
                                                                                                                        {
                                                                                                                            "type": "interpolation",
                                                                                                                            "label": "{suffix}",
                                                                                                                            "start_token": 2475,
                                                                                                                            "end_token": 2475,
                                                                                                                            "children": [
                                                                                                                                {
                                                                                                                                    "type": "identifier",
                                                                                                                                    "label": "suffix",
                                                                                                                                    "start_token": 2475,
                                                                                                                                    "end_token": 2475,
                                                                                                                                    "children": []
                                                                                                                                }
                                                                                                                            ]
                                                                                                                        },
                                                                                                                        {
                                                                                                                            "type": "string_content",
                                                                                                                            "label": ", `",
                                                                                                                            "start_token": 2475,
                                                                                                                            "end_token": 2475,
                                                                                                                            "children": []
                                                                                                                        },
                                                                                                                        {
                                                                                                                            "type": "interpolation",
                                                                                                                            "label": "{name}",
                                                                                                                            "start_token": 2475,
                                                                                                                            "end_token": 2475,
                                                                                                                            "children": [
                                                                                                                                {
                                                                                                                                    "type": "identifier",
                                                                                                                                    "label": "name",
                                                                                                                                    "start_token": 2475,
                                                                                                                                    "end_token": 2475,
                                                                                                                                    "children": []
                                                                                                                                }
                                                                                                                            ]
                                                                                                                        },
                                                                                                                        {
                                                                                                                            "type": "string_content",
                                                                                                                            "label": "` invalid, ",
                                                                                                                            "start_token": 2475,
                                                                                                                            "end_token": 2475,
                                                                                                                            "children": []
                                                                                                                        },
                                                                                                                        {
                                                                                                                            "type": "interpolation",
                                                                                                                            "label": "{fields_msg}",
                                                                                                                            "start_token": 2475,
                                                                                                                            "end_token": 2475,
                                                                                                                            "children": [
                                                                                                                                {
                                                                                                                                    "type": "identifier",
                                                                                                                                    "label": "fields_msg",
                                                                                                                                    "start_token": 2475,
                                                                                                                                    "end_token": 2475,
                                                                                                                                    "children": []
                                                                                                                                }
                                                                                                                            ]
                                                                                                                        },
                                                                                                                        {
                                                                                                                            "type": "string_end",
                                                                                                                            "label": "\"",
                                                                                                                            "start_token": 2475,
                                                                                                                            "end_token": 2475,
                                                                                                                            "children": []
                                                                                                                        }
                                                                                                                    ]
                                                                                                                }
                                                                                                            ]
                                                                                                        }
                                                                                                    ]
                                                                                                }
                                                                                            ]
                                                                                        }
                                                                                    ]
                                                                                }
                                                                            ]
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        },
                                                        {
                                                            "type": "if_statement",
                                                            "label": "if is_static_output_block(link.source_id):\n                link.is_static = True  # Each value block output should be static.",
                                                            "start_token": 2479,
                                                            "end_token": 2501,
                                                            "children": [
                                                                {
                                                                    "type": "call",
                                                                    "label": "is_static_output_block(link.source_id)",
                                                                    "start_token": 2480,
                                                                    "end_token": 2485,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "is_static_output_block",
                                                                            "start_token": 2480,
                                                                            "end_token": 2480,
                                                                            "children": []
                                                                        },
                                                                        {
                                                                            "type": "argument_list",
                                                                            "label": "(link.source_id)",
                                                                            "start_token": 2481,
                                                                            "end_token": 2485,
                                                                            "children": [
                                                                                {
                                                                                    "type": "attribute",
                                                                                    "label": "link.source_id",
                                                                                    "start_token": 2482,
                                                                                    "end_token": 2484,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "label": "link",
                                                                                            "start_token": 2482,
                                                                                            "end_token": 2482,
                                                                                            "children": []
                                                                                        },
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "label": "source_id",
                                                                                            "start_token": 2484,
                                                                                            "end_token": 2484,
                                                                                            "children": []
                                                                                        }
                                                                                    ]
                                                                                }
                                                                            ]
                                                                        }
                                                                    ]
                                                                },
                                                                {
                                                                    "type": "block",
                                                                    "label": "link.is_static = True  # Each value block output should be static.",
                                                                    "start_token": 2488,
                                                                    "end_token": 2501,
                                                                    "children": [
                                                                        {
                                                                            "type": "expression_statement",
                                                                            "label": "link.is_static = True",
                                                                            "start_token": 2488,
                                                                            "end_token": 2492,
                                                                            "children": [
                                                                                {
                                                                                    "type": "assignment",
                                                                                    "label": "link.is_static = True",
                                                                                    "start_token": 2488,
                                                                                    "end_token": 2492,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "attribute",
                                                                                            "label": "link.is_static",
                                                                                            "start_token": 2488,
                                                                                            "end_token": 2490,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "label": "link",
                                                                                                    "start_token": 2488,
                                                                                                    "end_token": 2488,
                                                                                                    "children": []
                                                                                                },
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "label": "is_static",
                                                                                                    "start_token": 2490,
                                                                                                    "end_token": 2490,
                                                                                                    "children": []
                                                                                                }
                                                                                            ]
                                                                                        },
                                                                                        {
                                                                                            "type": "true",
                                                                                            "label": "True",
                                                                                            "start_token": 2492,
                                                                                            "end_token": 2492,
                                                                                            "children": []
                                                                                        }
                                                                                    ]
                                                                                }
                                                                            ]
                                                                        },
                                                                        {
                                                                            "type": "comment",
                                                                            "label": "# Each value block output should be static.",
                                                                            "start_token": 2493,
                                                                            "end_token": 2501,
                                                                            "children": []
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                }
                                            ]
                                        }
                                    ]
                                }
                            ]
                        },
                        {
                            "type": "decorated_definition",
                            "label": "@staticmethod\n    def from_db(graph: AgentGraph, for_export: bool = False):\n        return GraphModel(\n            id=graph.id,\n            user_id=graph.userId,\n            version=graph.version,\n            is_active=graph.isActive,\n            is_template=graph.isTemplate,\n            name=graph.name or \"\",\n            description=graph.description or \"\",\n            nodes=[\n                NodeModel.from_db(GraphModel._process_node(node, for_export))\n                for node in graph.AgentNodes or []\n            ],\n            links=list(\n                {\n                    Link.from_db(link)\n                    for node in graph.AgentNodes or []\n                    for link in (node.Input or []) + (node.Output or [])\n                }\n            ),\n        )",
                            "start_token": 2504,
                            "end_token": 2660,
                            "children": [
                                {
                                    "type": "decorator",
                                    "label": "@staticmethod",
                                    "start_token": 2504,
                                    "end_token": 2505,
                                    "children": [
                                        {
                                            "type": "identifier",
                                            "label": "staticmethod",
                                            "start_token": 2505,
                                            "end_token": 2505,
                                            "children": []
                                        }
                                    ]
                                },
                                {
                                    "type": "function_definition",
                                    "label": "def from_db(graph: AgentGraph, for_export: bool = False):\n        return GraphModel(\n            id=graph.id,\n            user_id=graph.userId,\n            version=graph.version,\n            is_active=graph.isActive,\n            is_template=graph.isTemplate,\n            name=graph.name or \"\",\n            description=graph.description or \"\",\n            nodes=[\n                NodeModel.from_db(GraphModel._process_node(node, for_export))\n                for node in graph.AgentNodes or []\n            ],\n            links=list(\n                {\n                    Link.from_db(link)\n                    for node in graph.AgentNodes or []\n                    for link in (node.Input or []) + (node.Output or [])\n                }\n            ),\n        )",
                                    "start_token": 2507,
                                    "end_token": 2660,
                                    "children": [
                                        {
                                            "type": "identifier",
                                            "label": "from_db",
                                            "start_token": 2508,
                                            "end_token": 2508,
                                            "children": []
                                        },
                                        {
                                            "type": "parameters",
                                            "label": "(graph: AgentGraph, for_export: bool = False)",
                                            "start_token": 2509,
                                            "end_token": 2519,
                                            "children": [
                                                {
                                                    "type": "typed_parameter",
                                                    "label": "graph: AgentGraph",
                                                    "start_token": 2510,
                                                    "end_token": 2512,
                                                    "children": [
                                                        {
                                                            "type": "identifier",
                                                            "label": "graph",
                                                            "start_token": 2510,
                                                            "end_token": 2510,
                                                            "children": []
                                                        },
                                                        {
                                                            "type": "type",
                                                            "label": "AgentGraph",
                                                            "start_token": 2512,
                                                            "end_token": 2512,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "label": "AgentGraph",
                                                                    "start_token": 2512,
                                                                    "end_token": 2512,
                                                                    "children": []
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                },
                                                {
                                                    "type": "typed_default_parameter",
                                                    "label": "for_export: bool = False",
                                                    "start_token": 2514,
                                                    "end_token": 2518,
                                                    "children": [
                                                        {
                                                            "type": "identifier",
                                                            "label": "for_export",
                                                            "start_token": 2514,
                                                            "end_token": 2514,
                                                            "children": []
                                                        },
                                                        {
                                                            "type": "type",
                                                            "label": "bool",
                                                            "start_token": 2516,
                                                            "end_token": 2516,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "label": "bool",
                                                                    "start_token": 2516,
                                                                    "end_token": 2516,
                                                                    "children": []
                                                                }
                                                            ]
                                                        },
                                                        {
                                                            "type": "false",
                                                            "label": "False",
                                                            "start_token": 2518,
                                                            "end_token": 2518,
                                                            "children": []
                                                        }
                                                    ]
                                                }
                                            ]
                                        },
                                        {
                                            "type": "block",
                                            "label": "return GraphModel(\n            id=graph.id,\n            user_id=graph.userId,\n            version=graph.version,\n            is_active=graph.isActive,\n            is_template=graph.isTemplate,\n            name=graph.name or \"\",\n            description=graph.description or \"\",\n            nodes=[\n                NodeModel.from_db(GraphModel._process_node(node, for_export))\n                for node in graph.AgentNodes or []\n            ],\n            links=list(\n                {\n                    Link.from_db(link)\n                    for node in graph.AgentNodes or []\n                    for link in (node.Input or []) + (node.Output or [])\n                }\n            ),\n        )",
                                            "start_token": 2522,
                                            "end_token": 2660,
                                            "children": [
                                                {
                                                    "type": "return_statement",
                                                    "label": "return GraphModel(\n            id=graph.id,\n            user_id=graph.userId,\n            version=graph.version,\n            is_active=graph.isActive,\n            is_template=graph.isTemplate,\n            name=graph.name or \"\",\n            description=graph.description or \"\",\n            nodes=[\n                NodeModel.from_db(GraphModel._process_node(node, for_export))\n                for node in graph.AgentNodes or []\n            ],\n            links=list(\n                {\n                    Link.from_db(link)\n                    for node in graph.AgentNodes or []\n                    for link in (node.Input or []) + (node.Output or [])\n                }\n            ),\n        )",
                                                    "start_token": 2522,
                                                    "end_token": 2660,
                                                    "children": [
                                                        {
                                                            "type": "call",
                                                            "label": "GraphModel(\n            id=graph.id,\n            user_id=graph.userId,\n            version=graph.version,\n            is_active=graph.isActive,\n            is_template=graph.isTemplate,\n            name=graph.name or \"\",\n            description=graph.description or \"\",\n            nodes=[\n                NodeModel.from_db(GraphModel._process_node(node, for_export))\n                for node in graph.AgentNodes or []\n            ],\n            links=list(\n                {\n                    Link.from_db(link)\n                    for node in graph.AgentNodes or []\n                    for link in (node.Input or []) + (node.Output or [])\n                }\n            ),\n        )",
                                                            "start_token": 2523,
                                                            "end_token": 2660,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "label": "GraphModel",
                                                                    "start_token": 2523,
                                                                    "end_token": 2523,
                                                                    "children": []
                                                                },
                                                                {
                                                                    "type": "argument_list",
                                                                    "label": "(\n            id=graph.id,\n            user_id=graph.userId,\n            version=graph.version,\n            is_active=graph.isActive,\n            is_template=graph.isTemplate,\n            name=graph.name or \"\",\n            description=graph.description or \"\",\n            nodes=[\n                NodeModel.from_db(GraphModel._process_node(node, for_export))\n                for node in graph.AgentNodes or []\n            ],\n            links=list(\n                {\n                    Link.from_db(link)\n                    for node in graph.AgentNodes or []\n                    for link in (node.Input or []) + (node.Output or [])\n                }\n            ),\n        )",
                                                                    "start_token": 2524,
                                                                    "end_token": 2660,
                                                                    "children": [
                                                                        {
                                                                            "type": "keyword_argument",
                                                                            "label": "id=graph.id",
                                                                            "start_token": 2526,
                                                                            "end_token": 2530,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "id",
                                                                                    "start_token": 2526,
                                                                                    "end_token": 2526,
                                                                                    "children": []
                                                                                },
                                                                                {
                                                                                    "type": "attribute",
                                                                                    "label": "graph.id",
                                                                                    "start_token": 2528,
                                                                                    "end_token": 2530,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "label": "graph",
                                                                                            "start_token": 2528,
                                                                                            "end_token": 2528,
                                                                                            "children": []
                                                                                        },
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "label": "id",
                                                                                            "start_token": 2530,
                                                                                            "end_token": 2530,
                                                                                            "children": []
                                                                                        }
                                                                                    ]
                                                                                }
                                                                            ]
                                                                        },
                                                                        {
                                                                            "type": "keyword_argument",
                                                                            "label": "user_id=graph.userId",
                                                                            "start_token": 2533,
                                                                            "end_token": 2537,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "user_id",
                                                                                    "start_token": 2533,
                                                                                    "end_token": 2533,
                                                                                    "children": []
                                                                                },
                                                                                {
                                                                                    "type": "attribute",
                                                                                    "label": "graph.userId",
                                                                                    "start_token": 2535,
                                                                                    "end_token": 2537,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "label": "graph",
                                                                                            "start_token": 2535,
                                                                                            "end_token": 2535,
                                                                                            "children": []
                                                                                        },
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "label": "userId",
                                                                                            "start_token": 2537,
                                                                                            "end_token": 2537,
                                                                                            "children": []
                                                                                        }
                                                                                    ]
                                                                                }
                                                                            ]
                                                                        },
                                                                        {
                                                                            "type": "keyword_argument",
                                                                            "label": "version=graph.version",
                                                                            "start_token": 2540,
                                                                            "end_token": 2544,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "version",
                                                                                    "start_token": 2540,
                                                                                    "end_token": 2540,
                                                                                    "children": []
                                                                                },
                                                                                {
                                                                                    "type": "attribute",
                                                                                    "label": "graph.version",
                                                                                    "start_token": 2542,
                                                                                    "end_token": 2544,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "label": "graph",
                                                                                            "start_token": 2542,
                                                                                            "end_token": 2542,
                                                                                            "children": []
                                                                                        },
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "label": "version",
                                                                                            "start_token": 2544,
                                                                                            "end_token": 2544,
                                                                                            "children": []
                                                                                        }
                                                                                    ]
                                                                                }
                                                                            ]
                                                                        },
                                                                        {
                                                                            "type": "keyword_argument",
                                                                            "label": "is_active=graph.isActive",
                                                                            "start_token": 2547,
                                                                            "end_token": 2551,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "is_active",
                                                                                    "start_token": 2547,
                                                                                    "end_token": 2547,
                                                                                    "children": []
                                                                                },
                                                                                {
                                                                                    "type": "attribute",
                                                                                    "label": "graph.isActive",
                                                                                    "start_token": 2549,
                                                                                    "end_token": 2551,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "label": "graph",
                                                                                            "start_token": 2549,
                                                                                            "end_token": 2549,
                                                                                            "children": []
                                                                                        },
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "label": "isActive",
                                                                                            "start_token": 2551,
                                                                                            "end_token": 2551,
                                                                                            "children": []
                                                                                        }
                                                                                    ]
                                                                                }
                                                                            ]
                                                                        },
                                                                        {
                                                                            "type": "keyword_argument",
                                                                            "label": "is_template=graph.isTemplate",
                                                                            "start_token": 2554,
                                                                            "end_token": 2558,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "is_template",
                                                                                    "start_token": 2554,
                                                                                    "end_token": 2554,
                                                                                    "children": []
                                                                                },
                                                                                {
                                                                                    "type": "attribute",
                                                                                    "label": "graph.isTemplate",
                                                                                    "start_token": 2556,
                                                                                    "end_token": 2558,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "label": "graph",
                                                                                            "start_token": 2556,
                                                                                            "end_token": 2556,
                                                                                            "children": []
                                                                                        },
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "label": "isTemplate",
                                                                                            "start_token": 2558,
                                                                                            "end_token": 2558,
                                                                                            "children": []
                                                                                        }
                                                                                    ]
                                                                                }
                                                                            ]
                                                                        },
                                                                        {
                                                                            "type": "keyword_argument",
                                                                            "label": "name=graph.name or \"\"",
                                                                            "start_token": 2561,
                                                                            "end_token": 2567,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "name",
                                                                                    "start_token": 2561,
                                                                                    "end_token": 2561,
                                                                                    "children": []
                                                                                },
                                                                                {
                                                                                    "type": "boolean_operator",
                                                                                    "label": "graph.name or \"\"",
                                                                                    "start_token": 2563,
                                                                                    "end_token": 2567,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "attribute",
                                                                                            "label": "graph.name",
                                                                                            "start_token": 2563,
                                                                                            "end_token": 2565,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "label": "graph",
                                                                                                    "start_token": 2563,
                                                                                                    "end_token": 2563,
                                                                                                    "children": []
                                                                                                },
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "label": "name",
                                                                                                    "start_token": 2565,
                                                                                                    "end_token": 2565,
                                                                                                    "children": []
                                                                                                }
                                                                                            ]
                                                                                        },
                                                                                        {
                                                                                            "type": "string",
                                                                                            "label": "\"\"",
                                                                                            "start_token": 2567,
                                                                                            "end_token": 2567,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "string_start",
                                                                                                    "label": "\"",
                                                                                                    "start_token": 2567,
                                                                                                    "end_token": 2567,
                                                                                                    "children": []
                                                                                                },
                                                                                                {
                                                                                                    "type": "string_end",
                                                                                                    "label": "\"",
                                                                                                    "start_token": 2567,
                                                                                                    "end_token": 2567,
                                                                                                    "children": []
                                                                                                }
                                                                                            ]
                                                                                        }
                                                                                    ]
                                                                                }
                                                                            ]
                                                                        },
                                                                        {
                                                                            "type": "keyword_argument",
                                                                            "label": "description=graph.description or \"\"",
                                                                            "start_token": 2570,
                                                                            "end_token": 2576,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "description",
                                                                                    "start_token": 2570,
                                                                                    "end_token": 2570,
                                                                                    "children": []
                                                                                },
                                                                                {
                                                                                    "type": "boolean_operator",
                                                                                    "label": "graph.description or \"\"",
                                                                                    "start_token": 2572,
                                                                                    "end_token": 2576,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "attribute",
                                                                                            "label": "graph.description",
                                                                                            "start_token": 2572,
                                                                                            "end_token": 2574,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "label": "graph",
                                                                                                    "start_token": 2572,
                                                                                                    "end_token": 2572,
                                                                                                    "children": []
                                                                                                },
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "label": "description",
                                                                                                    "start_token": 2574,
                                                                                                    "end_token": 2574,
                                                                                                    "children": []
                                                                                                }
                                                                                            ]
                                                                                        },
                                                                                        {
                                                                                            "type": "string",
                                                                                            "label": "\"\"",
                                                                                            "start_token": 2576,
                                                                                            "end_token": 2576,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "string_start",
                                                                                                    "label": "\"",
                                                                                                    "start_token": 2576,
                                                                                                    "end_token": 2576,
                                                                                                    "children": []
                                                                                                },
                                                                                                {
                                                                                                    "type": "string_end",
                                                                                                    "label": "\"",
                                                                                                    "start_token": 2576,
                                                                                                    "end_token": 2576,
                                                                                                    "children": []
                                                                                                }
                                                                                            ]
                                                                                        }
                                                                                    ]
                                                                                }
                                                                            ]
                                                                        },
                                                                        {
                                                                            "type": "keyword_argument",
                                                                            "label": "nodes=[\n                NodeModel.from_db(GraphModel._process_node(node, for_export))\n                for node in graph.AgentNodes or []\n            ]",
                                                                            "start_token": 2579,
                                                                            "end_token": 2607,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "nodes",
                                                                                    "start_token": 2579,
                                                                                    "end_token": 2579,
                                                                                    "children": []
                                                                                },
                                                                                {
                                                                                    "type": "list_comprehension",
                                                                                    "label": "[\n                NodeModel.from_db(GraphModel._process_node(node, for_export))\n                for node in graph.AgentNodes or []\n            ]",
                                                                                    "start_token": 2581,
                                                                                    "end_token": 2607,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "call",
                                                                                            "label": "NodeModel.from_db(GraphModel._process_node(node, for_export))",
                                                                                            "start_token": 2583,
                                                                                            "end_token": 2595,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "attribute",
                                                                                                    "label": "NodeModel.from_db",
                                                                                                    "start_token": 2583,
                                                                                                    "end_token": 2585,
                                                                                                    "children": [
                                                                                                        {
                                                                                                            "type": "identifier",
                                                                                                            "label": "NodeModel",
                                                                                                            "start_token": 2583,
                                                                                                            "end_token": 2583,
                                                                                                            "children": []
                                                                                                        },
                                                                                                        {
                                                                                                            "type": "identifier",
                                                                                                            "label": "from_db",
                                                                                                            "start_token": 2585,
                                                                                                            "end_token": 2585,
                                                                                                            "children": []
                                                                                                        }
                                                                                                    ]
                                                                                                },
                                                                                                {
                                                                                                    "type": "argument_list",
                                                                                                    "label": "(GraphModel._process_node(node, for_export))",
                                                                                                    "start_token": 2586,
                                                                                                    "end_token": 2595,
                                                                                                    "children": [
                                                                                                        {
                                                                                                            "type": "call",
                                                                                                            "label": "GraphModel._process_node(node, for_export)",
                                                                                                            "start_token": 2587,
                                                                                                            "end_token": 2594,
                                                                                                            "children": [
                                                                                                                {
                                                                                                                    "type": "attribute",
                                                                                                                    "label": "GraphModel._process_node",
                                                                                                                    "start_token": 2587,
                                                                                                                    "end_token": 2589,
                                                                                                                    "children": [
                                                                                                                        {
                                                                                                                            "type": "identifier",
                                                                                                                            "label": "GraphModel",
                                                                                                                            "start_token": 2587,
                                                                                                                            "end_token": 2587,
                                                                                                                            "children": []
                                                                                                                        },
                                                                                                                        {
                                                                                                                            "type": "identifier",
                                                                                                                            "label": "_process_node",
                                                                                                                            "start_token": 2589,
                                                                                                                            "end_token": 2589,
                                                                                                                            "children": []
                                                                                                                        }
                                                                                                                    ]
                                                                                                                },
                                                                                                                {
                                                                                                                    "type": "argument_list",
                                                                                                                    "label": "(node, for_export)",
                                                                                                                    "start_token": 2590,
                                                                                                                    "end_token": 2594,
                                                                                                                    "children": [
                                                                                                                        {
                                                                                                                            "type": "identifier",
                                                                                                                            "label": "node",
                                                                                                                            "start_token": 2591,
                                                                                                                            "end_token": 2591,
                                                                                                                            "children": []
                                                                                                                        },
                                                                                                                        {
                                                                                                                            "type": "identifier",
                                                                                                                            "label": "for_export",
                                                                                                                            "start_token": 2593,
                                                                                                                            "end_token": 2593,
                                                                                                                            "children": []
                                                                                                                        }
                                                                                                                    ]
                                                                                                                }
                                                                                                            ]
                                                                                                        }
                                                                                                    ]
                                                                                                }
                                                                                            ]
                                                                                        },
                                                                                        {
                                                                                            "type": "for_in_clause",
                                                                                            "label": "for node in graph.AgentNodes or []",
                                                                                            "start_token": 2597,
                                                                                            "end_token": 2605,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "label": "node",
                                                                                                    "start_token": 2598,
                                                                                                    "end_token": 2598,
                                                                                                    "children": []
                                                                                                },
                                                                                                {
                                                                                                    "type": "boolean_operator",
                                                                                                    "label": "graph.AgentNodes or []",
                                                                                                    "start_token": 2600,
                                                                                                    "end_token": 2605,
                                                                                                    "children": [
                                                                                                        {
                                                                                                            "type": "attribute",
                                                                                                            "label": "graph.AgentNodes",
                                                                                                            "start_token": 2600,
                                                                                                            "end_token": 2602,
                                                                                                            "children": [
                                                                                                                {
                                                                                                                    "type": "identifier",
                                                                                                                    "label": "graph",
                                                                                                                    "start_token": 2600,
                                                                                                                    "end_token": 2600,
                                                                                                                    "children": []
                                                                                                                },
                                                                                                                {
                                                                                                                    "type": "identifier",
                                                                                                                    "label": "AgentNodes",
                                                                                                                    "start_token": 2602,
                                                                                                                    "end_token": 2602,
                                                                                                                    "children": []
                                                                                                                }
                                                                                                            ]
                                                                                                        },
                                                                                                        {
                                                                                                            "type": "list",
                                                                                                            "label": "[]",
                                                                                                            "start_token": 2604,
                                                                                                            "end_token": 2605,
                                                                                                            "children": []
                                                                                                        }
                                                                                                    ]
                                                                                                }
                                                                                            ]
                                                                                        }
                                                                                    ]
                                                                                }
                                                                            ]
                                                                        },
                                                                        {
                                                                            "type": "keyword_argument",
                                                                            "label": "links=list(\n                {\n                    Link.from_db(link)\n                    for node in graph.AgentNodes or []\n                    for link in (node.Input or []) + (node.Output or [])\n                }\n            )",
                                                                            "start_token": 2610,
                                                                            "end_token": 2657,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "links",
                                                                                    "start_token": 2610,
                                                                                    "end_token": 2610,
                                                                                    "children": []
                                                                                },
                                                                                {
                                                                                    "type": "call",
                                                                                    "label": "list(\n                {\n                    Link.from_db(link)\n                    for node in graph.AgentNodes or []\n                    for link in (node.Input or []) + (node.Output or [])\n                }\n            )",
                                                                                    "start_token": 2612,
                                                                                    "end_token": 2657,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "label": "list",
                                                                                            "start_token": 2612,
                                                                                            "end_token": 2612,
                                                                                            "children": []
                                                                                        },
                                                                                        {
                                                                                            "type": "argument_list",
                                                                                            "label": "(\n                {\n                    Link.from_db(link)\n                    for node in graph.AgentNodes or []\n                    for link in (node.Input or []) + (node.Output or [])\n                }\n            )",
                                                                                            "start_token": 2613,
                                                                                            "end_token": 2657,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "set_comprehension",
                                                                                                    "label": "{\n                    Link.from_db(link)\n                    for node in graph.AgentNodes or []\n                    for link in (node.Input or []) + (node.Output or [])\n                }",
                                                                                                    "start_token": 2615,
                                                                                                    "end_token": 2655,
                                                                                                    "children": [
                                                                                                        {
                                                                                                            "type": "call",
                                                                                                            "label": "Link.from_db(link)",
                                                                                                            "start_token": 2617,
                                                                                                            "end_token": 2622,
                                                                                                            "children": [
                                                                                                                {
                                                                                                                    "type": "attribute",
                                                                                                                    "label": "Link.from_db",
                                                                                                                    "start_token": 2617,
                                                                                                                    "end_token": 2619,
                                                                                                                    "children": [
                                                                                                                        {
                                                                                                                            "type": "identifier",
                                                                                                                            "label": "Link",
                                                                                                                            "start_token": 2617,
                                                                                                                            "end_token": 2617,
                                                                                                                            "children": []
                                                                                                                        },
                                                                                                                        {
                                                                                                                            "type": "identifier",
                                                                                                                            "label": "from_db",
                                                                                                                            "start_token": 2619,
                                                                                                                            "end_token": 2619,
                                                                                                                            "children": []
                                                                                                                        }
                                                                                                                    ]
                                                                                                                },
                                                                                                                {
                                                                                                                    "type": "argument_list",
                                                                                                                    "label": "(link)",
                                                                                                                    "start_token": 2620,
                                                                                                                    "end_token": 2622,
                                                                                                                    "children": [
                                                                                                                        {
                                                                                                                            "type": "identifier",
                                                                                                                            "label": "link",
                                                                                                                            "start_token": 2621,
                                                                                                                            "end_token": 2621,
                                                                                                                            "children": []
                                                                                                                        }
                                                                                                                    ]
                                                                                                                }
                                                                                                            ]
                                                                                                        },
                                                                                                        {
                                                                                                            "type": "for_in_clause",
                                                                                                            "label": "for node in graph.AgentNodes or []",
                                                                                                            "start_token": 2624,
                                                                                                            "end_token": 2632,
                                                                                                            "children": [
                                                                                                                {
                                                                                                                    "type": "identifier",
                                                                                                                    "label": "node",
                                                                                                                    "start_token": 2625,
                                                                                                                    "end_token": 2625,
                                                                                                                    "children": []
                                                                                                                },
                                                                                                                {
                                                                                                                    "type": "boolean_operator",
                                                                                                                    "label": "graph.AgentNodes or []",
                                                                                                                    "start_token": 2627,
                                                                                                                    "end_token": 2632,
                                                                                                                    "children": [
                                                                                                                        {
                                                                                                                            "type": "attribute",
                                                                                                                            "label": "graph.AgentNodes",
                                                                                                                            "start_token": 2627,
                                                                                                                            "end_token": 2629,
                                                                                                                            "children": [
                                                                                                                                {
                                                                                                                                    "type": "identifier",
                                                                                                                                    "label": "graph",
                                                                                                                                    "start_token": 2627,
                                                                                                                                    "end_token": 2627,
                                                                                                                                    "children": []
                                                                                                                                },
                                                                                                                                {
                                                                                                                                    "type": "identifier",
                                                                                                                                    "label": "AgentNodes",
                                                                                                                                    "start_token": 2629,
                                                                                                                                    "end_token": 2629,
                                                                                                                                    "children": []
                                                                                                                                }
                                                                                                                            ]
                                                                                                                        },
                                                                                                                        {
                                                                                                                            "type": "list",
                                                                                                                            "label": "[]",
                                                                                                                            "start_token": 2631,
                                                                                                                            "end_token": 2632,
                                                                                                                            "children": []
                                                                                                                        }
                                                                                                                    ]
                                                                                                                }
                                                                                                            ]
                                                                                                        },
                                                                                                        {
                                                                                                            "type": "for_in_clause",
                                                                                                            "label": "for link in (node.Input or []) + (node.Output or [])",
                                                                                                            "start_token": 2634,
                                                                                                            "end_token": 2653,
                                                                                                            "children": [
                                                                                                                {
                                                                                                                    "type": "identifier",
                                                                                                                    "label": "link",
                                                                                                                    "start_token": 2635,
                                                                                                                    "end_token": 2635,
                                                                                                                    "children": []
                                                                                                                },
                                                                                                                {
                                                                                                                    "type": "binary_operator",
                                                                                                                    "label": "(node.Input or []) + (node.Output or [])",
                                                                                                                    "start_token": 2637,
                                                                                                                    "end_token": 2653,
                                                                                                                    "children": [
                                                                                                                        {
                                                                                                                            "type": "parenthesized_expression",
                                                                                                                            "label": "(node.Input or [])",
                                                                                                                            "start_token": 2637,
                                                                                                                            "end_token": 2644,
                                                                                                                            "children": [
                                                                                                                                {
                                                                                                                                    "type": "boolean_operator",
                                                                                                                                    "label": "node.Input or []",
                                                                                                                                    "start_token": 2638,
                                                                                                                                    "end_token": 2643,
                                                                                                                                    "children": [
                                                                                                                                        {
                                                                                                                                            "type": "attribute",
                                                                                                                                            "label": "node.Input",
                                                                                                                                            "start_token": 2638,
                                                                                                                                            "end_token": 2640,
                                                                                                                                            "children": [
                                                                                                                                                {
                                                                                                                                                    "type": "identifier",
                                                                                                                                                    "label": "node",
                                                                                                                                                    "start_token": 2638,
                                                                                                                                                    "end_token": 2638,
                                                                                                                                                    "children": []
                                                                                                                                                },
                                                                                                                                                {
                                                                                                                                                    "type": "identifier",
                                                                                                                                                    "label": "Input",
                                                                                                                                                    "start_token": 2640,
                                                                                                                                                    "end_token": 2640,
                                                                                                                                                    "children": []
                                                                                                                                                }
                                                                                                                                            ]
                                                                                                                                        },
                                                                                                                                        {
                                                                                                                                            "type": "list",
                                                                                                                                            "label": "[]",
                                                                                                                                            "start_token": 2642,
                                                                                                                                            "end_token": 2643,
                                                                                                                                            "children": []
                                                                                                                                        }
                                                                                                                                    ]
                                                                                                                                }
                                                                                                                            ]
                                                                                                                        },
                                                                                                                        {
                                                                                                                            "type": "parenthesized_expression",
                                                                                                                            "label": "(node.Output or [])",
                                                                                                                            "start_token": 2646,
                                                                                                                            "end_token": 2653,
                                                                                                                            "children": [
                                                                                                                                {
                                                                                                                                    "type": "boolean_operator",
                                                                                                                                    "label": "node.Output or []",
                                                                                                                                    "start_token": 2647,
                                                                                                                                    "end_token": 2652,
                                                                                                                                    "children": [
                                                                                                                                        {
                                                                                                                                            "type": "attribute",
                                                                                                                                            "label": "node.Output",
                                                                                                                                            "start_token": 2647,
                                                                                                                                            "end_token": 2649,
                                                                                                                                            "children": [
                                                                                                                                                {
                                                                                                                                                    "type": "identifier",
                                                                                                                                                    "label": "node",
                                                                                                                                                    "start_token": 2647,
                                                                                                                                                    "end_token": 2647,
                                                                                                                                                    "children": []
                                                                                                                                                },
                                                                                                                                                {
                                                                                                                                                    "type": "identifier",
                                                                                                                                                    "label": "Output",
                                                                                                                                                    "start_token": 2649,
                                                                                                                                                    "end_token": 2649,
                                                                                                                                                    "children": []
                                                                                                                                                }
                                                                                                                                            ]
                                                                                                                                        },
                                                                                                                                        {
                                                                                                                                            "type": "list",
                                                                                                                                            "label": "[]",
                                                                                                                                            "start_token": 2651,
                                                                                                                                            "end_token": 2652,
                                                                                                                                            "children": []
                                                                                                                                        }
                                                                                                                                    ]
                                                                                                                                }
                                                                                                                            ]
                                                                                                                        }
                                                                                                                    ]
                                                                                                                }
                                                                                                            ]
                                                                                                        }
                                                                                                    ]
                                                                                                }
                                                                                            ]
                                                                                        }
                                                                                    ]
                                                                                }
                                                                            ]
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                }
                                            ]
                                        }
                                    ]
                                }
                            ]
                        },
                        {
                            "type": "decorated_definition",
                            "label": "@staticmethod\n    def _process_node(node: AgentNode, for_export: bool) -> AgentNode:\n        if for_export:\n            # Remove credentials from node input\n            if node.constantInput:\n                constant_input = json.loads(\n                    node.constantInput, target_type=dict[str, Any]\n                )\n                constant_input = GraphModel._hide_node_input_credentials(constant_input)\n                node.constantInput = json.dumps(constant_input)\n\n            # Remove webhook info\n            node.webhookId = None\n            node.Webhook = None\n\n        return node",
                            "start_token": 2663,
                            "end_token": 2761,
                            "children": [
                                {
                                    "type": "decorator",
                                    "label": "@staticmethod",
                                    "start_token": 2663,
                                    "end_token": 2664,
                                    "children": [
                                        {
                                            "type": "identifier",
                                            "label": "staticmethod",
                                            "start_token": 2664,
                                            "end_token": 2664,
                                            "children": []
                                        }
                                    ]
                                },
                                {
                                    "type": "function_definition",
                                    "label": "def _process_node(node: AgentNode, for_export: bool) -> AgentNode:\n        if for_export:\n            # Remove credentials from node input\n            if node.constantInput:\n                constant_input = json.loads(\n                    node.constantInput, target_type=dict[str, Any]\n                )\n                constant_input = GraphModel._hide_node_input_credentials(constant_input)\n                node.constantInput = json.dumps(constant_input)\n\n            # Remove webhook info\n            node.webhookId = None\n            node.Webhook = None\n\n        return node",
                                    "start_token": 2666,
                                    "end_token": 2761,
                                    "children": [
                                        {
                                            "type": "identifier",
                                            "label": "_process_node",
                                            "start_token": 2667,
                                            "end_token": 2667,
                                            "children": []
                                        },
                                        {
                                            "type": "parameters",
                                            "label": "(node: AgentNode, for_export: bool)",
                                            "start_token": 2668,
                                            "end_token": 2676,
                                            "children": [
                                                {
                                                    "type": "typed_parameter",
                                                    "label": "node: AgentNode",
                                                    "start_token": 2669,
                                                    "end_token": 2671,
                                                    "children": [
                                                        {
                                                            "type": "identifier",
                                                            "label": "node",
                                                            "start_token": 2669,
                                                            "end_token": 2669,
                                                            "children": []
                                                        },
                                                        {
                                                            "type": "type",
                                                            "label": "AgentNode",
                                                            "start_token": 2671,
                                                            "end_token": 2671,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "label": "AgentNode",
                                                                    "start_token": 2671,
                                                                    "end_token": 2671,
                                                                    "children": []
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                },
                                                {
                                                    "type": "typed_parameter",
                                                    "label": "for_export: bool",
                                                    "start_token": 2673,
                                                    "end_token": 2675,
                                                    "children": [
                                                        {
                                                            "type": "identifier",
                                                            "label": "for_export",
                                                            "start_token": 2673,
                                                            "end_token": 2673,
                                                            "children": []
                                                        },
                                                        {
                                                            "type": "type",
                                                            "label": "bool",
                                                            "start_token": 2675,
                                                            "end_token": 2675,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "label": "bool",
                                                                    "start_token": 2675,
                                                                    "end_token": 2675,
                                                                    "children": []
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                }
                                            ]
                                        },
                                        {
                                            "type": "type",
                                            "label": "AgentNode",
                                            "start_token": 2679,
                                            "end_token": 2679,
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "label": "AgentNode",
                                                    "start_token": 2679,
                                                    "end_token": 2679,
                                                    "children": []
                                                }
                                            ]
                                        },
                                        {
                                            "type": "block",
                                            "label": "if for_export:\n            # Remove credentials from node input\n            if node.constantInput:\n                constant_input = json.loads(\n                    node.constantInput, target_type=dict[str, Any]\n                )\n                constant_input = GraphModel._hide_node_input_credentials(constant_input)\n                node.constantInput = json.dumps(constant_input)\n\n            # Remove webhook info\n            node.webhookId = None\n            node.Webhook = None\n\n        return node",
                                            "start_token": 2682,
                                            "end_token": 2761,
                                            "children": [
                                                {
                                                    "type": "if_statement",
                                                    "label": "if for_export:\n            # Remove credentials from node input\n            if node.constantInput:\n                constant_input = json.loads(\n                    node.constantInput, target_type=dict[str, Any]\n                )\n                constant_input = GraphModel._hide_node_input_credentials(constant_input)\n                node.constantInput = json.dumps(constant_input)\n\n            # Remove webhook info\n            node.webhookId = None\n            node.Webhook = None",
                                                    "start_token": 2682,
                                                    "end_token": 2757,
                                                    "children": [
                                                        {
                                                            "type": "identifier",
                                                            "label": "for_export",
                                                            "start_token": 2683,
                                                            "end_token": 2683,
                                                            "children": []
                                                        },
                                                        {
                                                            "type": "comment",
                                                            "label": "# Remove credentials from node input",
                                                            "start_token": 2686,
                                                            "end_token": 2691,
                                                            "children": []
                                                        },
                                                        {
                                                            "type": "block",
                                                            "label": "if node.constantInput:\n                constant_input = json.loads(\n                    node.constantInput, target_type=dict[str, Any]\n                )\n                constant_input = GraphModel._hide_node_input_credentials(constant_input)\n                node.constantInput = json.dumps(constant_input)\n\n            # Remove webhook info\n            node.webhookId = None\n            node.Webhook = None",
                                                            "start_token": 2693,
                                                            "end_token": 2757,
                                                            "children": [
                                                                {
                                                                    "type": "if_statement",
                                                                    "label": "if node.constantInput:\n                constant_input = json.loads(\n                    node.constantInput, target_type=dict[str, Any]\n                )\n                constant_input = GraphModel._hide_node_input_credentials(constant_input)\n                node.constantInput = json.dumps(constant_input)",
                                                                    "start_token": 2693,
                                                                    "end_token": 2739,
                                                                    "children": [
                                                                        {
                                                                            "type": "attribute",
                                                                            "label": "node.constantInput",
                                                                            "start_token": 2694,
                                                                            "end_token": 2696,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "node",
                                                                                    "start_token": 2694,
                                                                                    "end_token": 2694,
                                                                                    "children": []
                                                                                },
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "constantInput",
                                                                                    "start_token": 2696,
                                                                                    "end_token": 2696,
                                                                                    "children": []
                                                                                }
                                                                            ]
                                                                        },
                                                                        {
                                                                            "type": "block",
                                                                            "label": "constant_input = json.loads(\n                    node.constantInput, target_type=dict[str, Any]\n                )\n                constant_input = GraphModel._hide_node_input_credentials(constant_input)\n                node.constantInput = json.dumps(constant_input)",
                                                                            "start_token": 2699,
                                                                            "end_token": 2739,
                                                                            "children": [
                                                                                {
                                                                                    "type": "expression_statement",
                                                                                    "label": "constant_input = json.loads(\n                    node.constantInput, target_type=dict[str, Any]\n                )",
                                                                                    "start_token": 2699,
                                                                                    "end_token": 2719,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "assignment",
                                                                                            "label": "constant_input = json.loads(\n                    node.constantInput, target_type=dict[str, Any]\n                )",
                                                                                            "start_token": 2699,
                                                                                            "end_token": 2719,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "label": "constant_input",
                                                                                                    "start_token": 2699,
                                                                                                    "end_token": 2699,
                                                                                                    "children": []
                                                                                                },
                                                                                                {
                                                                                                    "type": "call",
                                                                                                    "label": "json.loads(\n                    node.constantInput, target_type=dict[str, Any]\n                )",
                                                                                                    "start_token": 2701,
                                                                                                    "end_token": 2719,
                                                                                                    "children": [
                                                                                                        {
                                                                                                            "type": "attribute",
                                                                                                            "label": "json.loads",
                                                                                                            "start_token": 2701,
                                                                                                            "end_token": 2703,
                                                                                                            "children": [
                                                                                                                {
                                                                                                                    "type": "identifier",
                                                                                                                    "label": "json",
                                                                                                                    "start_token": 2701,
                                                                                                                    "end_token": 2701,
                                                                                                                    "children": []
                                                                                                                },
                                                                                                                {
                                                                                                                    "type": "identifier",
                                                                                                                    "label": "loads",
                                                                                                                    "start_token": 2703,
                                                                                                                    "end_token": 2703,
                                                                                                                    "children": []
                                                                                                                }
                                                                                                            ]
                                                                                                        },
                                                                                                        {
                                                                                                            "type": "argument_list",
                                                                                                            "label": "(\n                    node.constantInput, target_type=dict[str, Any]\n                )",
                                                                                                            "start_token": 2704,
                                                                                                            "end_token": 2719,
                                                                                                            "children": [
                                                                                                                {
                                                                                                                    "type": "attribute",
                                                                                                                    "label": "node.constantInput",
                                                                                                                    "start_token": 2706,
                                                                                                                    "end_token": 2708,
                                                                                                                    "children": [
                                                                                                                        {
                                                                                                                            "type": "identifier",
                                                                                                                            "label": "node",
                                                                                                                            "start_token": 2706,
                                                                                                                            "end_token": 2706,
                                                                                                                            "children": []
                                                                                                                        },
                                                                                                                        {
                                                                                                                            "type": "identifier",
                                                                                                                            "label": "constantInput",
                                                                                                                            "start_token": 2708,
                                                                                                                            "end_token": 2708,
                                                                                                                            "children": []
                                                                                                                        }
                                                                                                                    ]
                                                                                                                },
                                                                                                                {
                                                                                                                    "type": "keyword_argument",
                                                                                                                    "label": "target_type=dict[str, Any]",
                                                                                                                    "start_token": 2710,
                                                                                                                    "end_token": 2717,
                                                                                                                    "children": [
                                                                                                                        {
                                                                                                                            "type": "identifier",
                                                                                                                            "label": "target_type",
                                                                                                                            "start_token": 2710,
                                                                                                                            "end_token": 2710,
                                                                                                                            "children": []
                                                                                                                        },
                                                                                                                        {
                                                                                                                            "type": "subscript",
                                                                                                                            "label": "dict[str, Any]",
                                                                                                                            "start_token": 2712,
                                                                                                                            "end_token": 2717,
                                                                                                                            "children": [
                                                                                                                                {
                                                                                                                                    "type": "identifier",
                                                                                                                                    "label": "dict",
                                                                                                                                    "start_token": 2712,
                                                                                                                                    "end_token": 2712,
                                                                                                                                    "children": []
                                                                                                                                },
                                                                                                                                {
                                                                                                                                    "type": "identifier",
                                                                                                                                    "label": "str",
                                                                                                                                    "start_token": 2714,
                                                                                                                                    "end_token": 2714,
                                                                                                                                    "children": []
                                                                                                                                },
                                                                                                                                {
                                                                                                                                    "type": "identifier",
                                                                                                                                    "label": "Any",
                                                                                                                                    "start_token": 2716,
                                                                                                                                    "end_token": 2716,
                                                                                                                                    "children": []
                                                                                                                                }
                                                                                                                            ]
                                                                                                                        }
                                                                                                                    ]
                                                                                                                }
                                                                                                            ]
                                                                                                        }
                                                                                                    ]
                                                                                                }
                                                                                            ]
                                                                                        }
                                                                                    ]
                                                                                },
                                                                                {
                                                                                    "type": "expression_statement",
                                                                                    "label": "constant_input = GraphModel._hide_node_input_credentials(constant_input)",
                                                                                    "start_token": 2721,
                                                                                    "end_token": 2728,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "assignment",
                                                                                            "label": "constant_input = GraphModel._hide_node_input_credentials(constant_input)",
                                                                                            "start_token": 2721,
                                                                                            "end_token": 2728,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "label": "constant_input",
                                                                                                    "start_token": 2721,
                                                                                                    "end_token": 2721,
                                                                                                    "children": []
                                                                                                },
                                                                                                {
                                                                                                    "type": "call",
                                                                                                    "label": "GraphModel._hide_node_input_credentials(constant_input)",
                                                                                                    "start_token": 2723,
                                                                                                    "end_token": 2728,
                                                                                                    "children": [
                                                                                                        {
                                                                                                            "type": "attribute",
                                                                                                            "label": "GraphModel._hide_node_input_credentials",
                                                                                                            "start_token": 2723,
                                                                                                            "end_token": 2725,
                                                                                                            "children": [
                                                                                                                {
                                                                                                                    "type": "identifier",
                                                                                                                    "label": "GraphModel",
                                                                                                                    "start_token": 2723,
                                                                                                                    "end_token": 2723,
                                                                                                                    "children": []
                                                                                                                },
                                                                                                                {
                                                                                                                    "type": "identifier",
                                                                                                                    "label": "_hide_node_input_credentials",
                                                                                                                    "start_token": 2725,
                                                                                                                    "end_token": 2725,
                                                                                                                    "children": []
                                                                                                                }
                                                                                                            ]
                                                                                                        },
                                                                                                        {
                                                                                                            "type": "argument_list",
                                                                                                            "label": "(constant_input)",
                                                                                                            "start_token": 2726,
                                                                                                            "end_token": 2728,
                                                                                                            "children": [
                                                                                                                {
                                                                                                                    "type": "identifier",
                                                                                                                    "label": "constant_input",
                                                                                                                    "start_token": 2727,
                                                                                                                    "end_token": 2727,
                                                                                                                    "children": []
                                                                                                                }
                                                                                                            ]
                                                                                                        }
                                                                                                    ]
                                                                                                }
                                                                                            ]
                                                                                        }
                                                                                    ]
                                                                                },
                                                                                {
                                                                                    "type": "expression_statement",
                                                                                    "label": "node.constantInput = json.dumps(constant_input)",
                                                                                    "start_token": 2730,
                                                                                    "end_token": 2739,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "assignment",
                                                                                            "label": "node.constantInput = json.dumps(constant_input)",
                                                                                            "start_token": 2730,
                                                                                            "end_token": 2739,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "attribute",
                                                                                                    "label": "node.constantInput",
                                                                                                    "start_token": 2730,
                                                                                                    "end_token": 2732,
                                                                                                    "children": [
                                                                                                        {
                                                                                                            "type": "identifier",
                                                                                                            "label": "node",
                                                                                                            "start_token": 2730,
                                                                                                            "end_token": 2730,
                                                                                                            "children": []
                                                                                                        },
                                                                                                        {
                                                                                                            "type": "identifier",
                                                                                                            "label": "constantInput",
                                                                                                            "start_token": 2732,
                                                                                                            "end_token": 2732,
                                                                                                            "children": []
                                                                                                        }
                                                                                                    ]
                                                                                                },
                                                                                                {
                                                                                                    "type": "call",
                                                                                                    "label": "json.dumps(constant_input)",
                                                                                                    "start_token": 2734,
                                                                                                    "end_token": 2739,
                                                                                                    "children": [
                                                                                                        {
                                                                                                            "type": "attribute",
                                                                                                            "label": "json.dumps",
                                                                                                            "start_token": 2734,
                                                                                                            "end_token": 2736,
                                                                                                            "children": [
                                                                                                                {
                                                                                                                    "type": "identifier",
                                                                                                                    "label": "json",
                                                                                                                    "start_token": 2734,
                                                                                                                    "end_token": 2734,
                                                                                                                    "children": []
                                                                                                                },
                                                                                                                {
                                                                                                                    "type": "identifier",
                                                                                                                    "label": "dumps",
                                                                                                                    "start_token": 2736,
                                                                                                                    "end_token": 2736,
                                                                                                                    "children": []
                                                                                                                }
                                                                                                            ]
                                                                                                        },
                                                                                                        {
                                                                                                            "type": "argument_list",
                                                                                                            "label": "(constant_input)",
                                                                                                            "start_token": 2737,
                                                                                                            "end_token": 2739,
                                                                                                            "children": [
                                                                                                                {
                                                                                                                    "type": "identifier",
                                                                                                                    "label": "constant_input",
                                                                                                                    "start_token": 2738,
                                                                                                                    "end_token": 2738,
                                                                                                                    "children": []
                                                                                                                }
                                                                                                            ]
                                                                                                        }
                                                                                                    ]
                                                                                                }
                                                                                            ]
                                                                                        }
                                                                                    ]
                                                                                }
                                                                            ]
                                                                        }
                                                                    ]
                                                                },
                                                                {
                                                                    "type": "comment",
                                                                    "label": "# Remove webhook info",
                                                                    "start_token": 2742,
                                                                    "end_token": 2745,
                                                                    "children": []
                                                                },
                                                                {
                                                                    "type": "expression_statement",
                                                                    "label": "node.webhookId = None",
                                                                    "start_token": 2747,
                                                                    "end_token": 2751,
                                                                    "children": [
                                                                        {
                                                                            "type": "assignment",
                                                                            "label": "node.webhookId = None",
                                                                            "start_token": 2747,
                                                                            "end_token": 2751,
                                                                            "children": [
                                                                                {
                                                                                    "type": "attribute",
                                                                                    "label": "node.webhookId",
                                                                                    "start_token": 2747,
                                                                                    "end_token": 2749,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "label": "node",
                                                                                            "start_token": 2747,
                                                                                            "end_token": 2747,
                                                                                            "children": []
                                                                                        },
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "label": "webhookId",
                                                                                            "start_token": 2749,
                                                                                            "end_token": 2749,
                                                                                            "children": []
                                                                                        }
                                                                                    ]
                                                                                },
                                                                                {
                                                                                    "type": "none",
                                                                                    "label": "None",
                                                                                    "start_token": 2751,
                                                                                    "end_token": 2751,
                                                                                    "children": []
                                                                                }
                                                                            ]
                                                                        }
                                                                    ]
                                                                },
                                                                {
                                                                    "type": "expression_statement",
                                                                    "label": "node.Webhook = None",
                                                                    "start_token": 2753,
                                                                    "end_token": 2757,
                                                                    "children": [
                                                                        {
                                                                            "type": "assignment",
                                                                            "label": "node.Webhook = None",
                                                                            "start_token": 2753,
                                                                            "end_token": 2757,
                                                                            "children": [
                                                                                {
                                                                                    "type": "attribute",
                                                                                    "label": "node.Webhook",
                                                                                    "start_token": 2753,
                                                                                    "end_token": 2755,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "label": "node",
                                                                                            "start_token": 2753,
                                                                                            "end_token": 2753,
                                                                                            "children": []
                                                                                        },
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "label": "Webhook",
                                                                                            "start_token": 2755,
                                                                                            "end_token": 2755,
                                                                                            "children": []
                                                                                        }
                                                                                    ]
                                                                                },
                                                                                {
                                                                                    "type": "none",
                                                                                    "label": "None",
                                                                                    "start_token": 2757,
                                                                                    "end_token": 2757,
                                                                                    "children": []
                                                                                }
                                                                            ]
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                },
                                                {
                                                    "type": "return_statement",
                                                    "label": "return node",
                                                    "start_token": 2760,
                                                    "end_token": 2761,
                                                    "children": [
                                                        {
                                                            "type": "identifier",
                                                            "label": "node",
                                                            "start_token": 2761,
                                                            "end_token": 2761,
                                                            "children": []
                                                        }
                                                    ]
                                                }
                                            ]
                                        }
                                    ]
                                }
                            ]
                        },
                        {
                            "type": "decorated_definition",
                            "label": "@staticmethod\n    def _hide_node_input_credentials(input_data: dict[str, Any]) -> dict[str, Any]:\n        sensitive_keys = [\"credentials\", \"api_key\", \"password\", \"token\", \"secret\"]\n        result = {}\n        for key, value in input_data.items():\n            if isinstance(value, dict):\n                result[key] = GraphModel._hide_node_input_credentials(value)\n            elif isinstance(value, str) and any(\n                sensitive_key in key.lower() for sensitive_key in sensitive_keys\n            ):\n                # Skip this key-value pair in the result\n                continue\n            else:\n                result[key] = value\n        return result",
                            "start_token": 2764,
                            "end_token": 2891,
                            "children": [
                                {
                                    "type": "decorator",
                                    "label": "@staticmethod",
                                    "start_token": 2764,
                                    "end_token": 2765,
                                    "children": [
                                        {
                                            "type": "identifier",
                                            "label": "staticmethod",
                                            "start_token": 2765,
                                            "end_token": 2765,
                                            "children": []
                                        }
                                    ]
                                },
                                {
                                    "type": "function_definition",
                                    "label": "def _hide_node_input_credentials(input_data: dict[str, Any]) -> dict[str, Any]:\n        sensitive_keys = [\"credentials\", \"api_key\", \"password\", \"token\", \"secret\"]\n        result = {}\n        for key, value in input_data.items():\n            if isinstance(value, dict):\n                result[key] = GraphModel._hide_node_input_credentials(value)\n            elif isinstance(value, str) and any(\n                sensitive_key in key.lower() for sensitive_key in sensitive_keys\n            ):\n                # Skip this key-value pair in the result\n                continue\n            else:\n                result[key] = value\n        return result",
                                    "start_token": 2767,
                                    "end_token": 2891,
                                    "children": [
                                        {
                                            "type": "identifier",
                                            "label": "_hide_node_input_credentials",
                                            "start_token": 2768,
                                            "end_token": 2768,
                                            "children": []
                                        },
                                        {
                                            "type": "parameters",
                                            "label": "(input_data: dict[str, Any])",
                                            "start_token": 2769,
                                            "end_token": 2778,
                                            "children": [
                                                {
                                                    "type": "typed_parameter",
                                                    "label": "input_data: dict[str, Any]",
                                                    "start_token": 2770,
                                                    "end_token": 2777,
                                                    "children": [
                                                        {
                                                            "type": "identifier",
                                                            "label": "input_data",
                                                            "start_token": 2770,
                                                            "end_token": 2770,
                                                            "children": []
                                                        },
                                                        {
                                                            "type": "type",
                                                            "label": "dict[str, Any]",
                                                            "start_token": 2772,
                                                            "end_token": 2777,
                                                            "children": [
                                                                {
                                                                    "type": "generic_type",
                                                                    "label": "dict[str, Any]",
                                                                    "start_token": 2772,
                                                                    "end_token": 2777,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "dict",
                                                                            "start_token": 2772,
                                                                            "end_token": 2772,
                                                                            "children": []
                                                                        },
                                                                        {
                                                                            "type": "type_parameter",
                                                                            "label": "[str, Any]",
                                                                            "start_token": 2773,
                                                                            "end_token": 2777,
                                                                            "children": [
                                                                                {
                                                                                    "type": "type",
                                                                                    "label": "str",
                                                                                    "start_token": 2774,
                                                                                    "end_token": 2774,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "label": "str",
                                                                                            "start_token": 2774,
                                                                                            "end_token": 2774,
                                                                                            "children": []
                                                                                        }
                                                                                    ]
                                                                                },
                                                                                {
                                                                                    "type": "type",
                                                                                    "label": "Any",
                                                                                    "start_token": 2776,
                                                                                    "end_token": 2776,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "label": "Any",
                                                                                            "start_token": 2776,
                                                                                            "end_token": 2776,
                                                                                            "children": []
                                                                                        }
                                                                                    ]
                                                                                }
                                                                            ]
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                }
                                            ]
                                        },
                                        {
                                            "type": "type",
                                            "label": "dict[str, Any]",
                                            "start_token": 2781,
                                            "end_token": 2786,
                                            "children": [
                                                {
                                                    "type": "generic_type",
                                                    "label": "dict[str, Any]",
                                                    "start_token": 2781,
                                                    "end_token": 2786,
                                                    "children": [
                                                        {
                                                            "type": "identifier",
                                                            "label": "dict",
                                                            "start_token": 2781,
                                                            "end_token": 2781,
                                                            "children": []
                                                        },
                                                        {
                                                            "type": "type_parameter",
                                                            "label": "[str, Any]",
                                                            "start_token": 2782,
                                                            "end_token": 2786,
                                                            "children": [
                                                                {
                                                                    "type": "type",
                                                                    "label": "str",
                                                                    "start_token": 2783,
                                                                    "end_token": 2783,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "str",
                                                                            "start_token": 2783,
                                                                            "end_token": 2783,
                                                                            "children": []
                                                                        }
                                                                    ]
                                                                },
                                                                {
                                                                    "type": "type",
                                                                    "label": "Any",
                                                                    "start_token": 2785,
                                                                    "end_token": 2785,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "Any",
                                                                            "start_token": 2785,
                                                                            "end_token": 2785,
                                                                            "children": []
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                }
                                            ]
                                        },
                                        {
                                            "type": "block",
                                            "label": "sensitive_keys = [\"credentials\", \"api_key\", \"password\", \"token\", \"secret\"]\n        result = {}\n        for key, value in input_data.items():\n            if isinstance(value, dict):\n                result[key] = GraphModel._hide_node_input_credentials(value)\n            elif isinstance(value, str) and any(\n                sensitive_key in key.lower() for sensitive_key in sensitive_keys\n            ):\n                # Skip this key-value pair in the result\n                continue\n            else:\n                result[key] = value\n        return result",
                                            "start_token": 2789,
                                            "end_token": 2891,
                                            "children": [
                                                {
                                                    "type": "expression_statement",
                                                    "label": "sensitive_keys = [\"credentials\", \"api_key\", \"password\", \"token\", \"secret\"]",
                                                    "start_token": 2789,
                                                    "end_token": 2801,
                                                    "children": [
                                                        {
                                                            "type": "assignment",
                                                            "label": "sensitive_keys = [\"credentials\", \"api_key\", \"password\", \"token\", \"secret\"]",
                                                            "start_token": 2789,
                                                            "end_token": 2801,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "label": "sensitive_keys",
                                                                    "start_token": 2789,
                                                                    "end_token": 2789,
                                                                    "children": []
                                                                },
                                                                {
                                                                    "type": "list",
                                                                    "label": "[\"credentials\", \"api_key\", \"password\", \"token\", \"secret\"]",
                                                                    "start_token": 2791,
                                                                    "end_token": 2801,
                                                                    "children": [
                                                                        {
                                                                            "type": "string",
                                                                            "label": "\"credentials\"",
                                                                            "start_token": 2792,
                                                                            "end_token": 2792,
                                                                            "children": [
                                                                                {
                                                                                    "type": "string_start",
                                                                                    "label": "\"",
                                                                                    "start_token": 2792,
                                                                                    "end_token": 2792,
                                                                                    "children": []
                                                                                },
                                                                                {
                                                                                    "type": "string_content",
                                                                                    "label": "credentials",
                                                                                    "start_token": 2792,
                                                                                    "end_token": 2792,
                                                                                    "children": []
                                                                                },
                                                                                {
                                                                                    "type": "string_end",
                                                                                    "label": "\"",
                                                                                    "start_token": 2792,
                                                                                    "end_token": 2792,
                                                                                    "children": []
                                                                                }
                                                                            ]
                                                                        },
                                                                        {
                                                                            "type": "string",
                                                                            "label": "\"api_key\"",
                                                                            "start_token": 2794,
                                                                            "end_token": 2794,
                                                                            "children": [
                                                                                {
                                                                                    "type": "string_start",
                                                                                    "label": "\"",
                                                                                    "start_token": 2794,
                                                                                    "end_token": 2794,
                                                                                    "children": []
                                                                                },
                                                                                {
                                                                                    "type": "string_content",
                                                                                    "label": "api_key",
                                                                                    "start_token": 2794,
                                                                                    "end_token": 2794,
                                                                                    "children": []
                                                                                },
                                                                                {
                                                                                    "type": "string_end",
                                                                                    "label": "\"",
                                                                                    "start_token": 2794,
                                                                                    "end_token": 2794,
                                                                                    "children": []
                                                                                }
                                                                            ]
                                                                        },
                                                                        {
                                                                            "type": "string",
                                                                            "label": "\"password\"",
                                                                            "start_token": 2796,
                                                                            "end_token": 2796,
                                                                            "children": [
                                                                                {
                                                                                    "type": "string_start",
                                                                                    "label": "\"",
                                                                                    "start_token": 2796,
                                                                                    "end_token": 2796,
                                                                                    "children": []
                                                                                },
                                                                                {
                                                                                    "type": "string_content",
                                                                                    "label": "password",
                                                                                    "start_token": 2796,
                                                                                    "end_token": 2796,
                                                                                    "children": []
                                                                                },
                                                                                {
                                                                                    "type": "string_end",
                                                                                    "label": "\"",
                                                                                    "start_token": 2796,
                                                                                    "end_token": 2796,
                                                                                    "children": []
                                                                                }
                                                                            ]
                                                                        },
                                                                        {
                                                                            "type": "string",
                                                                            "label": "\"token\"",
                                                                            "start_token": 2798,
                                                                            "end_token": 2798,
                                                                            "children": [
                                                                                {
                                                                                    "type": "string_start",
                                                                                    "label": "\"",
                                                                                    "start_token": 2798,
                                                                                    "end_token": 2798,
                                                                                    "children": []
                                                                                },
                                                                                {
                                                                                    "type": "string_content",
                                                                                    "label": "token",
                                                                                    "start_token": 2798,
                                                                                    "end_token": 2798,
                                                                                    "children": []
                                                                                },
                                                                                {
                                                                                    "type": "string_end",
                                                                                    "label": "\"",
                                                                                    "start_token": 2798,
                                                                                    "end_token": 2798,
                                                                                    "children": []
                                                                                }
                                                                            ]
                                                                        },
                                                                        {
                                                                            "type": "string",
                                                                            "label": "\"secret\"",
                                                                            "start_token": 2800,
                                                                            "end_token": 2800,
                                                                            "children": [
                                                                                {
                                                                                    "type": "string_start",
                                                                                    "label": "\"",
                                                                                    "start_token": 2800,
                                                                                    "end_token": 2800,
                                                                                    "children": []
                                                                                },
                                                                                {
                                                                                    "type": "string_content",
                                                                                    "label": "secret",
                                                                                    "start_token": 2800,
                                                                                    "end_token": 2800,
                                                                                    "children": []
                                                                                },
                                                                                {
                                                                                    "type": "string_end",
                                                                                    "label": "\"",
                                                                                    "start_token": 2800,
                                                                                    "end_token": 2800,
                                                                                    "children": []
                                                                                }
                                                                            ]
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                },
                                                {
                                                    "type": "expression_statement",
                                                    "label": "result = {}",
                                                    "start_token": 2803,
                                                    "end_token": 2806,
                                                    "children": [
                                                        {
                                                            "type": "assignment",
                                                            "label": "result = {}",
                                                            "start_token": 2803,
                                                            "end_token": 2806,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "label": "result",
                                                                    "start_token": 2803,
                                                                    "end_token": 2803,
                                                                    "children": []
                                                                },
                                                                {
                                                                    "type": "dictionary",
                                                                    "label": "{}",
                                                                    "start_token": 2805,
                                                                    "end_token": 2806,
                                                                    "children": []
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                },
                                                {
                                                    "type": "for_statement",
                                                    "label": "for key, value in input_data.items():\n            if isinstance(value, dict):\n                result[key] = GraphModel._hide_node_input_credentials(value)\n            elif isinstance(value, str) and any(\n                sensitive_key in key.lower() for sensitive_key in sensitive_keys\n            ):\n                # Skip this key-value pair in the result\n                continue\n            else:\n                result[key] = value",
                                                    "start_token": 2808,
                                                    "end_token": 2888,
                                                    "children": [
                                                        {
                                                            "type": "pattern_list",
                                                            "label": "key, value",
                                                            "start_token": 2809,
                                                            "end_token": 2811,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "label": "key",
                                                                    "start_token": 2809,
                                                                    "end_token": 2809,
                                                                    "children": []
                                                                },
                                                                {
                                                                    "type": "identifier",
                                                                    "label": "value",
                                                                    "start_token": 2811,
                                                                    "end_token": 2811,
                                                                    "children": []
                                                                }
                                                            ]
                                                        },
                                                        {
                                                            "type": "call",
                                                            "label": "input_data.items()",
                                                            "start_token": 2813,
                                                            "end_token": 2817,
                                                            "children": [
                                                                {
                                                                    "type": "attribute",
                                                                    "label": "input_data.items",
                                                                    "start_token": 2813,
                                                                    "end_token": 2815,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "input_data",
                                                                            "start_token": 2813,
                                                                            "end_token": 2813,
                                                                            "children": []
                                                                        },
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "items",
                                                                            "start_token": 2815,
                                                                            "end_token": 2815,
                                                                            "children": []
                                                                        }
                                                                    ]
                                                                },
                                                                {
                                                                    "type": "argument_list",
                                                                    "label": "()",
                                                                    "start_token": 2816,
                                                                    "end_token": 2817,
                                                                    "children": []
                                                                }
                                                            ]
                                                        },
                                                        {
                                                            "type": "block",
                                                            "label": "if isinstance(value, dict):\n                result[key] = GraphModel._hide_node_input_credentials(value)\n            elif isinstance(value, str) and any(\n                sensitive_key in key.lower() for sensitive_key in sensitive_keys\n            ):\n                # Skip this key-value pair in the result\n                continue\n            else:\n                result[key] = value",
                                                            "start_token": 2820,
                                                            "end_token": 2888,
                                                            "children": [
                                                                {
                                                                    "type": "if_statement",
                                                                    "label": "if isinstance(value, dict):\n                result[key] = GraphModel._hide_node_input_credentials(value)\n            elif isinstance(value, str) and any(\n                sensitive_key in key.lower() for sensitive_key in sensitive_keys\n            ):\n                # Skip this key-value pair in the result\n                continue\n            else:\n                result[key] = value",
                                                                    "start_token": 2820,
                                                                    "end_token": 2888,
                                                                    "children": [
                                                                        {
                                                                            "type": "call",
                                                                            "label": "isinstance(value, dict)",
                                                                            "start_token": 2821,
                                                                            "end_token": 2826,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "isinstance",
                                                                                    "start_token": 2821,
                                                                                    "end_token": 2821,
                                                                                    "children": []
                                                                                },
                                                                                {
                                                                                    "type": "argument_list",
                                                                                    "label": "(value, dict)",
                                                                                    "start_token": 2822,
                                                                                    "end_token": 2826,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "label": "value",
                                                                                            "start_token": 2823,
                                                                                            "end_token": 2823,
                                                                                            "children": []
                                                                                        },
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "label": "dict",
                                                                                            "start_token": 2825,
                                                                                            "end_token": 2825,
                                                                                            "children": []
                                                                                        }
                                                                                    ]
                                                                                }
                                                                            ]
                                                                        },
                                                                        {
                                                                            "type": "block",
                                                                            "label": "result[key] = GraphModel._hide_node_input_credentials(value)",
                                                                            "start_token": 2829,
                                                                            "end_token": 2839,
                                                                            "children": [
                                                                                {
                                                                                    "type": "expression_statement",
                                                                                    "label": "result[key] = GraphModel._hide_node_input_credentials(value)",
                                                                                    "start_token": 2829,
                                                                                    "end_token": 2839,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "assignment",
                                                                                            "label": "result[key] = GraphModel._hide_node_input_credentials(value)",
                                                                                            "start_token": 2829,
                                                                                            "end_token": 2839,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "subscript",
                                                                                                    "label": "result[key]",
                                                                                                    "start_token": 2829,
                                                                                                    "end_token": 2832,
                                                                                                    "children": [
                                                                                                        {
                                                                                                            "type": "identifier",
                                                                                                            "label": "result",
                                                                                                            "start_token": 2829,
                                                                                                            "end_token": 2829,
                                                                                                            "children": []
                                                                                                        },
                                                                                                        {
                                                                                                            "type": "identifier",
                                                                                                            "label": "key",
                                                                                                            "start_token": 2831,
                                                                                                            "end_token": 2831,
                                                                                                            "children": []
                                                                                                        }
                                                                                                    ]
                                                                                                },
                                                                                                {
                                                                                                    "type": "call",
                                                                                                    "label": "GraphModel._hide_node_input_credentials(value)",
                                                                                                    "start_token": 2834,
                                                                                                    "end_token": 2839,
                                                                                                    "children": [
                                                                                                        {
                                                                                                            "type": "attribute",
                                                                                                            "label": "GraphModel._hide_node_input_credentials",
                                                                                                            "start_token": 2834,
                                                                                                            "end_token": 2836,
                                                                                                            "children": [
                                                                                                                {
                                                                                                                    "type": "identifier",
                                                                                                                    "label": "GraphModel",
                                                                                                                    "start_token": 2834,
                                                                                                                    "end_token": 2834,
                                                                                                                    "children": []
                                                                                                                },
                                                                                                                {
                                                                                                                    "type": "identifier",
                                                                                                                    "label": "_hide_node_input_credentials",
                                                                                                                    "start_token": 2836,
                                                                                                                    "end_token": 2836,
                                                                                                                    "children": []
                                                                                                                }
                                                                                                            ]
                                                                                                        },
                                                                                                        {
                                                                                                            "type": "argument_list",
                                                                                                            "label": "(value)",
                                                                                                            "start_token": 2837,
                                                                                                            "end_token": 2839,
                                                                                                            "children": [
                                                                                                                {
                                                                                                                    "type": "identifier",
                                                                                                                    "label": "value",
                                                                                                                    "start_token": 2838,
                                                                                                                    "end_token": 2838,
                                                                                                                    "children": []
                                                                                                                }
                                                                                                            ]
                                                                                                        }
                                                                                                    ]
                                                                                                }
                                                                                            ]
                                                                                        }
                                                                                    ]
                                                                                }
                                                                            ]
                                                                        },
                                                                        {
                                                                            "type": "elif_clause",
                                                                            "label": "elif isinstance(value, str) and any(\n                sensitive_key in key.lower() for sensitive_key in sensitive_keys\n            ):\n                # Skip this key-value pair in the result\n                continue",
                                                                            "start_token": 2841,
                                                                            "end_token": 2878,
                                                                            "children": [
                                                                                {
                                                                                    "type": "boolean_operator",
                                                                                    "label": "isinstance(value, str) and any(\n                sensitive_key in key.lower() for sensitive_key in sensitive_keys\n            )",
                                                                                    "start_token": 2842,
                                                                                    "end_token": 2864,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "call",
                                                                                            "label": "isinstance(value, str)",
                                                                                            "start_token": 2842,
                                                                                            "end_token": 2847,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "label": "isinstance",
                                                                                                    "start_token": 2842,
                                                                                                    "end_token": 2842,
                                                                                                    "children": []
                                                                                                },
                                                                                                {
                                                                                                    "type": "argument_list",
                                                                                                    "label": "(value, str)",
                                                                                                    "start_token": 2843,
                                                                                                    "end_token": 2847,
                                                                                                    "children": [
                                                                                                        {
                                                                                                            "type": "identifier",
                                                                                                            "label": "value",
                                                                                                            "start_token": 2844,
                                                                                                            "end_token": 2844,
                                                                                                            "children": []
                                                                                                        },
                                                                                                        {
                                                                                                            "type": "identifier",
                                                                                                            "label": "str",
                                                                                                            "start_token": 2846,
                                                                                                            "end_token": 2846,
                                                                                                            "children": []
                                                                                                        }
                                                                                                    ]
                                                                                                }
                                                                                            ]
                                                                                        },
                                                                                        {
                                                                                            "type": "call",
                                                                                            "label": "any(\n                sensitive_key in key.lower() for sensitive_key in sensitive_keys\n            )",
                                                                                            "start_token": 2849,
                                                                                            "end_token": 2864,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "label": "any",
                                                                                                    "start_token": 2849,
                                                                                                    "end_token": 2849,
                                                                                                    "children": []
                                                                                                },
                                                                                                {
                                                                                                    "type": "generator_expression",
                                                                                                    "label": "(\n                sensitive_key in key.lower() for sensitive_key in sensitive_keys\n            )",
                                                                                                    "start_token": 2850,
                                                                                                    "end_token": 2864,
                                                                                                    "children": [
                                                                                                        {
                                                                                                            "type": "comparison_operator",
                                                                                                            "label": "sensitive_key in key.lower()",
                                                                                                            "start_token": 2852,
                                                                                                            "end_token": 2858,
                                                                                                            "children": [
                                                                                                                {
                                                                                                                    "type": "identifier",
                                                                                                                    "label": "sensitive_key",
                                                                                                                    "start_token": 2852,
                                                                                                                    "end_token": 2852,
                                                                                                                    "children": []
                                                                                                                },
                                                                                                                {
                                                                                                                    "type": "call",
                                                                                                                    "label": "key.lower()",
                                                                                                                    "start_token": 2854,
                                                                                                                    "end_token": 2858,
                                                                                                                    "children": [
                                                                                                                        {
                                                                                                                            "type": "attribute",
                                                                                                                            "label": "key.lower",
                                                                                                                            "start_token": 2854,
                                                                                                                            "end_token": 2856,
                                                                                                                            "children": [
                                                                                                                                {
                                                                                                                                    "type": "identifier",
                                                                                                                                    "label": "key",
                                                                                                                                    "start_token": 2854,
                                                                                                                                    "end_token": 2854,
                                                                                                                                    "children": []
                                                                                                                                },
                                                                                                                                {
                                                                                                                                    "type": "identifier",
                                                                                                                                    "label": "lower",
                                                                                                                                    "start_token": 2856,
                                                                                                                                    "end_token": 2856,
                                                                                                                                    "children": []
                                                                                                                                }
                                                                                                                            ]
                                                                                                                        },
                                                                                                                        {
                                                                                                                            "type": "argument_list",
                                                                                                                            "label": "()",
                                                                                                                            "start_token": 2857,
                                                                                                                            "end_token": 2858,
                                                                                                                            "children": []
                                                                                                                        }
                                                                                                                    ]
                                                                                                                }
                                                                                                            ]
                                                                                                        },
                                                                                                        {
                                                                                                            "type": "for_in_clause",
                                                                                                            "label": "for sensitive_key in sensitive_keys",
                                                                                                            "start_token": 2859,
                                                                                                            "end_token": 2862,
                                                                                                            "children": [
                                                                                                                {
                                                                                                                    "type": "identifier",
                                                                                                                    "label": "sensitive_key",
                                                                                                                    "start_token": 2860,
                                                                                                                    "end_token": 2860,
                                                                                                                    "children": []
                                                                                                                },
                                                                                                                {
                                                                                                                    "type": "identifier",
                                                                                                                    "label": "sensitive_keys",
                                                                                                                    "start_token": 2862,
                                                                                                                    "end_token": 2862,
                                                                                                                    "children": []
                                                                                                                }
                                                                                                            ]
                                                                                                        }
                                                                                                    ]
                                                                                                }
                                                                                            ]
                                                                                        }
                                                                                    ]
                                                                                },
                                                                                {
                                                                                    "type": "comment",
                                                                                    "label": "# Skip this key-value pair in the result",
                                                                                    "start_token": 2867,
                                                                                    "end_token": 2876,
                                                                                    "children": []
                                                                                },
                                                                                {
                                                                                    "type": "block",
                                                                                    "label": "continue",
                                                                                    "start_token": 2878,
                                                                                    "end_token": 2878,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "continue_statement",
                                                                                            "label": "continue",
                                                                                            "start_token": 2878,
                                                                                            "end_token": 2878,
                                                                                            "children": []
                                                                                        }
                                                                                    ]
                                                                                }
                                                                            ]
                                                                        },
                                                                        {
                                                                            "type": "else_clause",
                                                                            "label": "else:\n                result[key] = value",
                                                                            "start_token": 2880,
                                                                            "end_token": 2888,
                                                                            "children": [
                                                                                {
                                                                                    "type": "block",
                                                                                    "label": "result[key] = value",
                                                                                    "start_token": 2883,
                                                                                    "end_token": 2888,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "expression_statement",
                                                                                            "label": "result[key] = value",
                                                                                            "start_token": 2883,
                                                                                            "end_token": 2888,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "assignment",
                                                                                                    "label": "result[key] = value",
                                                                                                    "start_token": 2883,
                                                                                                    "end_token": 2888,
                                                                                                    "children": [
                                                                                                        {
                                                                                                            "type": "subscript",
                                                                                                            "label": "result[key]",
                                                                                                            "start_token": 2883,
                                                                                                            "end_token": 2886,
                                                                                                            "children": [
                                                                                                                {
                                                                                                                    "type": "identifier",
                                                                                                                    "label": "result",
                                                                                                                    "start_token": 2883,
                                                                                                                    "end_token": 2883,
                                                                                                                    "children": []
                                                                                                                },
                                                                                                                {
                                                                                                                    "type": "identifier",
                                                                                                                    "label": "key",
                                                                                                                    "start_token": 2885,
                                                                                                                    "end_token": 2885,
                                                                                                                    "children": []
                                                                                                                }
                                                                                                            ]
                                                                                                        },
                                                                                                        {
                                                                                                            "type": "identifier",
                                                                                                            "label": "value",
                                                                                                            "start_token": 2888,
                                                                                                            "end_token": 2888,
                                                                                                            "children": []
                                                                                                        }
                                                                                                    ]
                                                                                                }
                                                                                            ]
                                                                                        }
                                                                                    ]
                                                                                }
                                                                            ]
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                },
                                                {
                                                    "type": "return_statement",
                                                    "label": "return result",
                                                    "start_token": 2890,
                                                    "end_token": 2891,
                                                    "children": [
                                                        {
                                                            "type": "identifier",
                                                            "label": "result",
                                                            "start_token": 2891,
                                                            "end_token": 2891,
                                                            "children": []
                                                        }
                                                    ]
                                                }
                                            ]
                                        }
                                    ]
                                }
                            ]
                        }
                    ]
                }
            ]
        },
        {
            "type": "comment",
            "label": "# --------------------- CRUD functions --------------------- #",
            "start_token": 2895,
            "end_token": 2940,
            "children": []
        },
        {
            "type": "function_definition",
            "label": "async def get_node(node_id: str) -> NodeModel:\n    node = await AgentNode.prisma().find_unique_or_raise(\n        where={\"id\": node_id},\n        include=AGENT_NODE_INCLUDE,\n    )\n    return NodeModel.from_db(node)",
            "start_token": 2944,
            "end_token": 2991,
            "children": [
                {
                    "type": "identifier",
                    "label": "get_node",
                    "start_token": 2946,
                    "end_token": 2946,
                    "children": []
                },
                {
                    "type": "parameters",
                    "label": "(node_id: str)",
                    "start_token": 2947,
                    "end_token": 2951,
                    "children": [
                        {
                            "type": "typed_parameter",
                            "label": "node_id: str",
                            "start_token": 2948,
                            "end_token": 2950,
                            "children": [
                                {
                                    "type": "identifier",
                                    "label": "node_id",
                                    "start_token": 2948,
                                    "end_token": 2948,
                                    "children": []
                                },
                                {
                                    "type": "type",
                                    "label": "str",
                                    "start_token": 2950,
                                    "end_token": 2950,
                                    "children": [
                                        {
                                            "type": "identifier",
                                            "label": "str",
                                            "start_token": 2950,
                                            "end_token": 2950,
                                            "children": []
                                        }
                                    ]
                                }
                            ]
                        }
                    ]
                },
                {
                    "type": "type",
                    "label": "NodeModel",
                    "start_token": 2954,
                    "end_token": 2954,
                    "children": [
                        {
                            "type": "identifier",
                            "label": "NodeModel",
                            "start_token": 2954,
                            "end_token": 2954,
                            "children": []
                        }
                    ]
                },
                {
                    "type": "block",
                    "label": "node = await AgentNode.prisma().find_unique_or_raise(\n        where={\"id\": node_id},\n        include=AGENT_NODE_INCLUDE,\n    )\n    return NodeModel.from_db(node)",
                    "start_token": 2957,
                    "end_token": 2991,
                    "children": [
                        {
                            "type": "expression_statement",
                            "label": "node = await AgentNode.prisma().find_unique_or_raise(\n        where={\"id\": node_id},\n        include=AGENT_NODE_INCLUDE,\n    )",
                            "start_token": 2957,
                            "end_token": 2983,
                            "children": [
                                {
                                    "type": "assignment",
                                    "label": "node = await AgentNode.prisma().find_unique_or_raise(\n        where={\"id\": node_id},\n        include=AGENT_NODE_INCLUDE,\n    )",
                                    "start_token": 2957,
                                    "end_token": 2983,
                                    "children": [
                                        {
                                            "type": "identifier",
                                            "label": "node",
                                            "start_token": 2957,
                                            "end_token": 2957,
                                            "children": []
                                        },
                                        {
                                            "type": "await",
                                            "label": "await AgentNode.prisma().find_unique_or_raise(\n        where={\"id\": node_id},\n        include=AGENT_NODE_INCLUDE,\n    )",
                                            "start_token": 2959,
                                            "end_token": 2983,
                                            "children": [
                                                {
                                                    "type": "call",
                                                    "label": "AgentNode.prisma().find_unique_or_raise(\n        where={\"id\": node_id},\n        include=AGENT_NODE_INCLUDE,\n    )",
                                                    "start_token": 2960,
                                                    "end_token": 2983,
                                                    "children": [
                                                        {
                                                            "type": "attribute",
                                                            "label": "AgentNode.prisma().find_unique_or_raise",
                                                            "start_token": 2960,
                                                            "end_token": 2966,
                                                            "children": [
                                                                {
                                                                    "type": "call",
                                                                    "label": "AgentNode.prisma()",
                                                                    "start_token": 2960,
                                                                    "end_token": 2964,
                                                                    "children": [
                                                                        {
                                                                            "type": "attribute",
                                                                            "label": "AgentNode.prisma",
                                                                            "start_token": 2960,
                                                                            "end_token": 2962,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "AgentNode",
                                                                                    "start_token": 2960,
                                                                                    "end_token": 2960,
                                                                                    "children": []
                                                                                },
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "prisma",
                                                                                    "start_token": 2962,
                                                                                    "end_token": 2962,
                                                                                    "children": []
                                                                                }
                                                                            ]
                                                                        },
                                                                        {
                                                                            "type": "argument_list",
                                                                            "label": "()",
                                                                            "start_token": 2963,
                                                                            "end_token": 2964,
                                                                            "children": []
                                                                        }
                                                                    ]
                                                                },
                                                                {
                                                                    "type": "identifier",
                                                                    "label": "find_unique_or_raise",
                                                                    "start_token": 2966,
                                                                    "end_token": 2966,
                                                                    "children": []
                                                                }
                                                            ]
                                                        },
                                                        {
                                                            "type": "argument_list",
                                                            "label": "(\n        where={\"id\": node_id},\n        include=AGENT_NODE_INCLUDE,\n    )",
                                                            "start_token": 2967,
                                                            "end_token": 2983,
                                                            "children": [
                                                                {
                                                                    "type": "keyword_argument",
                                                                    "label": "where={\"id\": node_id}",
                                                                    "start_token": 2969,
                                                                    "end_token": 2975,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "where",
                                                                            "start_token": 2969,
                                                                            "end_token": 2969,
                                                                            "children": []
                                                                        },
                                                                        {
                                                                            "type": "dictionary",
                                                                            "label": "{\"id\": node_id}",
                                                                            "start_token": 2971,
                                                                            "end_token": 2975,
                                                                            "children": [
                                                                                {
                                                                                    "type": "pair",
                                                                                    "label": "\"id\": node_id",
                                                                                    "start_token": 2972,
                                                                                    "end_token": 2974,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "string",
                                                                                            "label": "\"id\"",
                                                                                            "start_token": 2972,
                                                                                            "end_token": 2972,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "string_start",
                                                                                                    "label": "\"",
                                                                                                    "start_token": 2972,
                                                                                                    "end_token": 2972,
                                                                                                    "children": []
                                                                                                },
                                                                                                {
                                                                                                    "type": "string_content",
                                                                                                    "label": "id",
                                                                                                    "start_token": 2972,
                                                                                                    "end_token": 2972,
                                                                                                    "children": []
                                                                                                },
                                                                                                {
                                                                                                    "type": "string_end",
                                                                                                    "label": "\"",
                                                                                                    "start_token": 2972,
                                                                                                    "end_token": 2972,
                                                                                                    "children": []
                                                                                                }
                                                                                            ]
                                                                                        },
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "label": "node_id",
                                                                                            "start_token": 2974,
                                                                                            "end_token": 2974,
                                                                                            "children": []
                                                                                        }
                                                                                    ]
                                                                                }
                                                                            ]
                                                                        }
                                                                    ]
                                                                },
                                                                {
                                                                    "type": "keyword_argument",
                                                                    "label": "include=AGENT_NODE_INCLUDE",
                                                                    "start_token": 2978,
                                                                    "end_token": 2980,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "include",
                                                                            "start_token": 2978,
                                                                            "end_token": 2978,
                                                                            "children": []
                                                                        },
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "AGENT_NODE_INCLUDE",
                                                                            "start_token": 2980,
                                                                            "end_token": 2980,
                                                                            "children": []
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                }
                                            ]
                                        }
                                    ]
                                }
                            ]
                        },
                        {
                            "type": "return_statement",
                            "label": "return NodeModel.from_db(node)",
                            "start_token": 2985,
                            "end_token": 2991,
                            "children": [
                                {
                                    "type": "call",
                                    "label": "NodeModel.from_db(node)",
                                    "start_token": 2986,
                                    "end_token": 2991,
                                    "children": [
                                        {
                                            "type": "attribute",
                                            "label": "NodeModel.from_db",
                                            "start_token": 2986,
                                            "end_token": 2988,
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "label": "NodeModel",
                                                    "start_token": 2986,
                                                    "end_token": 2986,
                                                    "children": []
                                                },
                                                {
                                                    "type": "identifier",
                                                    "label": "from_db",
                                                    "start_token": 2988,
                                                    "end_token": 2988,
                                                    "children": []
                                                }
                                            ]
                                        },
                                        {
                                            "type": "argument_list",
                                            "label": "(node)",
                                            "start_token": 2989,
                                            "end_token": 2991,
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "label": "node",
                                                    "start_token": 2990,
                                                    "end_token": 2990,
                                                    "children": []
                                                }
                                            ]
                                        }
                                    ]
                                }
                            ]
                        }
                    ]
                }
            ]
        },
        {
            "type": "function_definition",
            "label": "async def set_node_webhook(node_id: str, webhook_id: str | None) -> NodeModel:\n    node = await AgentNode.prisma().update(\n        where={\"id\": node_id},\n        data=(\n            {\"Webhook\": {\"connect\": {\"id\": webhook_id}}}\n            if webhook_id\n            else {\"Webhook\": {\"disconnect\": True}}\n        ),\n        include=AGENT_NODE_INCLUDE,\n    )\n    if not node:\n        raise ValueError(f\"Node #{node_id} not found\")\n    return NodeModel.from_db(node)",
            "start_token": 2995,
            "end_token": 3095,
            "children": [
                {
                    "type": "identifier",
                    "label": "set_node_webhook",
                    "start_token": 2997,
                    "end_token": 2997,
                    "children": []
                },
                {
                    "type": "parameters",
                    "label": "(node_id: str, webhook_id: str | None)",
                    "start_token": 2998,
                    "end_token": 3008,
                    "children": [
                        {
                            "type": "typed_parameter",
                            "label": "node_id: str",
                            "start_token": 2999,
                            "end_token": 3001,
                            "children": [
                                {
                                    "type": "identifier",
                                    "label": "node_id",
                                    "start_token": 2999,
                                    "end_token": 2999,
                                    "children": []
                                },
                                {
                                    "type": "type",
                                    "label": "str",
                                    "start_token": 3001,
                                    "end_token": 3001,
                                    "children": [
                                        {
                                            "type": "identifier",
                                            "label": "str",
                                            "start_token": 3001,
                                            "end_token": 3001,
                                            "children": []
                                        }
                                    ]
                                }
                            ]
                        },
                        {
                            "type": "typed_parameter",
                            "label": "webhook_id: str | None",
                            "start_token": 3003,
                            "end_token": 3007,
                            "children": [
                                {
                                    "type": "identifier",
                                    "label": "webhook_id",
                                    "start_token": 3003,
                                    "end_token": 3003,
                                    "children": []
                                },
                                {
                                    "type": "type",
                                    "label": "str | None",
                                    "start_token": 3005,
                                    "end_token": 3007,
                                    "children": [
                                        {
                                            "type": "binary_operator",
                                            "label": "str | None",
                                            "start_token": 3005,
                                            "end_token": 3007,
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "label": "str",
                                                    "start_token": 3005,
                                                    "end_token": 3005,
                                                    "children": []
                                                },
                                                {
                                                    "type": "none",
                                                    "label": "None",
                                                    "start_token": 3007,
                                                    "end_token": 3007,
                                                    "children": []
                                                }
                                            ]
                                        }
                                    ]
                                }
                            ]
                        }
                    ]
                },
                {
                    "type": "type",
                    "label": "NodeModel",
                    "start_token": 3011,
                    "end_token": 3011,
                    "children": [
                        {
                            "type": "identifier",
                            "label": "NodeModel",
                            "start_token": 3011,
                            "end_token": 3011,
                            "children": []
                        }
                    ]
                },
                {
                    "type": "block",
                    "label": "node = await AgentNode.prisma().update(\n        where={\"id\": node_id},\n        data=(\n            {\"Webhook\": {\"connect\": {\"id\": webhook_id}}}\n            if webhook_id\n            else {\"Webhook\": {\"disconnect\": True}}\n        ),\n        include=AGENT_NODE_INCLUDE,\n    )\n    if not node:\n        raise ValueError(f\"Node #{node_id} not found\")\n    return NodeModel.from_db(node)",
                    "start_token": 3014,
                    "end_token": 3095,
                    "children": [
                        {
                            "type": "expression_statement",
                            "label": "node = await AgentNode.prisma().update(\n        where={\"id\": node_id},\n        data=(\n            {\"Webhook\": {\"connect\": {\"id\": webhook_id}}}\n            if webhook_id\n            else {\"Webhook\": {\"disconnect\": True}}\n        ),\n        include=AGENT_NODE_INCLUDE,\n    )",
                            "start_token": 3014,
                            "end_token": 3075,
                            "children": [
                                {
                                    "type": "assignment",
                                    "label": "node = await AgentNode.prisma().update(\n        where={\"id\": node_id},\n        data=(\n            {\"Webhook\": {\"connect\": {\"id\": webhook_id}}}\n            if webhook_id\n            else {\"Webhook\": {\"disconnect\": True}}\n        ),\n        include=AGENT_NODE_INCLUDE,\n    )",
                                    "start_token": 3014,
                                    "end_token": 3075,
                                    "children": [
                                        {
                                            "type": "identifier",
                                            "label": "node",
                                            "start_token": 3014,
                                            "end_token": 3014,
                                            "children": []
                                        },
                                        {
                                            "type": "await",
                                            "label": "await AgentNode.prisma().update(\n        where={\"id\": node_id},\n        data=(\n            {\"Webhook\": {\"connect\": {\"id\": webhook_id}}}\n            if webhook_id\n            else {\"Webhook\": {\"disconnect\": True}}\n        ),\n        include=AGENT_NODE_INCLUDE,\n    )",
                                            "start_token": 3016,
                                            "end_token": 3075,
                                            "children": [
                                                {
                                                    "type": "call",
                                                    "label": "AgentNode.prisma().update(\n        where={\"id\": node_id},\n        data=(\n            {\"Webhook\": {\"connect\": {\"id\": webhook_id}}}\n            if webhook_id\n            else {\"Webhook\": {\"disconnect\": True}}\n        ),\n        include=AGENT_NODE_INCLUDE,\n    )",
                                                    "start_token": 3017,
                                                    "end_token": 3075,
                                                    "children": [
                                                        {
                                                            "type": "attribute",
                                                            "label": "AgentNode.prisma().update",
                                                            "start_token": 3017,
                                                            "end_token": 3023,
                                                            "children": [
                                                                {
                                                                    "type": "call",
                                                                    "label": "AgentNode.prisma()",
                                                                    "start_token": 3017,
                                                                    "end_token": 3021,
                                                                    "children": [
                                                                        {
                                                                            "type": "attribute",
                                                                            "label": "AgentNode.prisma",
                                                                            "start_token": 3017,
                                                                            "end_token": 3019,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "AgentNode",
                                                                                    "start_token": 3017,
                                                                                    "end_token": 3017,
                                                                                    "children": []
                                                                                },
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "prisma",
                                                                                    "start_token": 3019,
                                                                                    "end_token": 3019,
                                                                                    "children": []
                                                                                }
                                                                            ]
                                                                        },
                                                                        {
                                                                            "type": "argument_list",
                                                                            "label": "()",
                                                                            "start_token": 3020,
                                                                            "end_token": 3021,
                                                                            "children": []
                                                                        }
                                                                    ]
                                                                },
                                                                {
                                                                    "type": "identifier",
                                                                    "label": "update",
                                                                    "start_token": 3023,
                                                                    "end_token": 3023,
                                                                    "children": []
                                                                }
                                                            ]
                                                        },
                                                        {
                                                            "type": "argument_list",
                                                            "label": "(\n        where={\"id\": node_id},\n        data=(\n            {\"Webhook\": {\"connect\": {\"id\": webhook_id}}}\n            if webhook_id\n            else {\"Webhook\": {\"disconnect\": True}}\n        ),\n        include=AGENT_NODE_INCLUDE,\n    )",
                                                            "start_token": 3024,
                                                            "end_token": 3075,
                                                            "children": [
                                                                {
                                                                    "type": "keyword_argument",
                                                                    "label": "where={\"id\": node_id}",
                                                                    "start_token": 3026,
                                                                    "end_token": 3032,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "where",
                                                                            "start_token": 3026,
                                                                            "end_token": 3026,
                                                                            "children": []
                                                                        },
                                                                        {
                                                                            "type": "dictionary",
                                                                            "label": "{\"id\": node_id}",
                                                                            "start_token": 3028,
                                                                            "end_token": 3032,
                                                                            "children": [
                                                                                {
                                                                                    "type": "pair",
                                                                                    "label": "\"id\": node_id",
                                                                                    "start_token": 3029,
                                                                                    "end_token": 3031,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "string",
                                                                                            "label": "\"id\"",
                                                                                            "start_token": 3029,
                                                                                            "end_token": 3029,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "string_start",
                                                                                                    "label": "\"",
                                                                                                    "start_token": 3029,
                                                                                                    "end_token": 3029,
                                                                                                    "children": []
                                                                                                },
                                                                                                {
                                                                                                    "type": "string_content",
                                                                                                    "label": "id",
                                                                                                    "start_token": 3029,
                                                                                                    "end_token": 3029,
                                                                                                    "children": []
                                                                                                },
                                                                                                {
                                                                                                    "type": "string_end",
                                                                                                    "label": "\"",
                                                                                                    "start_token": 3029,
                                                                                                    "end_token": 3029,
                                                                                                    "children": []
                                                                                                }
                                                                                            ]
                                                                                        },
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "label": "node_id",
                                                                                            "start_token": 3031,
                                                                                            "end_token": 3031,
                                                                                            "children": []
                                                                                        }
                                                                                    ]
                                                                                }
                                                                            ]
                                                                        }
                                                                    ]
                                                                },
                                                                {
                                                                    "type": "keyword_argument",
                                                                    "label": "data=(\n            {\"Webhook\": {\"connect\": {\"id\": webhook_id}}}\n            if webhook_id\n            else {\"Webhook\": {\"disconnect\": True}}\n        )",
                                                                    "start_token": 3035,
                                                                    "end_token": 3067,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "data",
                                                                            "start_token": 3035,
                                                                            "end_token": 3035,
                                                                            "children": []
                                                                        },
                                                                        {
                                                                            "type": "parenthesized_expression",
                                                                            "label": "(\n            {\"Webhook\": {\"connect\": {\"id\": webhook_id}}}\n            if webhook_id\n            else {\"Webhook\": {\"disconnect\": True}}\n        )",
                                                                            "start_token": 3037,
                                                                            "end_token": 3067,
                                                                            "children": [
                                                                                {
                                                                                    "type": "conditional_expression",
                                                                                    "label": "{\"Webhook\": {\"connect\": {\"id\": webhook_id}}}\n            if webhook_id\n            else {\"Webhook\": {\"disconnect\": True}}",
                                                                                    "start_token": 3039,
                                                                                    "end_token": 3065,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "dictionary",
                                                                                            "label": "{\"Webhook\": {\"connect\": {\"id\": webhook_id}}}",
                                                                                            "start_token": 3039,
                                                                                            "end_token": 3051,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "pair",
                                                                                                    "label": "\"Webhook\": {\"connect\": {\"id\": webhook_id}}",
                                                                                                    "start_token": 3040,
                                                                                                    "end_token": 3050,
                                                                                                    "children": [
                                                                                                        {
                                                                                                            "type": "string",
                                                                                                            "label": "\"Webhook\"",
                                                                                                            "start_token": 3040,
                                                                                                            "end_token": 3040,
                                                                                                            "children": [
                                                                                                                {
                                                                                                                    "type": "string_start",
                                                                                                                    "label": "\"",
                                                                                                                    "start_token": 3040,
                                                                                                                    "end_token": 3040,
                                                                                                                    "children": []
                                                                                                                },
                                                                                                                {
                                                                                                                    "type": "string_content",
                                                                                                                    "label": "Webhook",
                                                                                                                    "start_token": 3040,
                                                                                                                    "end_token": 3040,
                                                                                                                    "children": []
                                                                                                                },
                                                                                                                {
                                                                                                                    "type": "string_end",
                                                                                                                    "label": "\"",
                                                                                                                    "start_token": 3040,
                                                                                                                    "end_token": 3040,
                                                                                                                    "children": []
                                                                                                                }
                                                                                                            ]
                                                                                                        },
                                                                                                        {
                                                                                                            "type": "dictionary",
                                                                                                            "label": "{\"connect\": {\"id\": webhook_id}}",
                                                                                                            "start_token": 3042,
                                                                                                            "end_token": 3050,
                                                                                                            "children": [
                                                                                                                {
                                                                                                                    "type": "pair",
                                                                                                                    "label": "\"connect\": {\"id\": webhook_id}",
                                                                                                                    "start_token": 3043,
                                                                                                                    "end_token": 3049,
                                                                                                                    "children": [
                                                                                                                        {
                                                                                                                            "type": "string",
                                                                                                                            "label": "\"connect\"",
                                                                                                                            "start_token": 3043,
                                                                                                                            "end_token": 3043,
                                                                                                                            "children": [
                                                                                                                                {
                                                                                                                                    "type": "string_start",
                                                                                                                                    "label": "\"",
                                                                                                                                    "start_token": 3043,
                                                                                                                                    "end_token": 3043,
                                                                                                                                    "children": []
                                                                                                                                },
                                                                                                                                {
                                                                                                                                    "type": "string_content",
                                                                                                                                    "label": "connect",
                                                                                                                                    "start_token": 3043,
                                                                                                                                    "end_token": 3043,
                                                                                                                                    "children": []
                                                                                                                                },
                                                                                                                                {
                                                                                                                                    "type": "string_end",
                                                                                                                                    "label": "\"",
                                                                                                                                    "start_token": 3043,
                                                                                                                                    "end_token": 3043,
                                                                                                                                    "children": []
                                                                                                                                }
                                                                                                                            ]
                                                                                                                        },
                                                                                                                        {
                                                                                                                            "type": "dictionary",
                                                                                                                            "label": "{\"id\": webhook_id}",
                                                                                                                            "start_token": 3045,
                                                                                                                            "end_token": 3049,
                                                                                                                            "children": [
                                                                                                                                {
                                                                                                                                    "type": "pair",
                                                                                                                                    "label": "\"id\": webhook_id",
                                                                                                                                    "start_token": 3046,
                                                                                                                                    "end_token": 3048,
                                                                                                                                    "children": [
                                                                                                                                        {
                                                                                                                                            "type": "string",
                                                                                                                                            "label": "\"id\"",
                                                                                                                                            "start_token": 3046,
                                                                                                                                            "end_token": 3046,
                                                                                                                                            "children": [
                                                                                                                                                {
                                                                                                                                                    "type": "string_start",
                                                                                                                                                    "label": "\"",
                                                                                                                                                    "start_token": 3046,
                                                                                                                                                    "end_token": 3046,
                                                                                                                                                    "children": []
                                                                                                                                                },
                                                                                                                                                {
                                                                                                                                                    "type": "string_content",
                                                                                                                                                    "label": "id",
                                                                                                                                                    "start_token": 3046,
                                                                                                                                                    "end_token": 3046,
                                                                                                                                                    "children": []
                                                                                                                                                },
                                                                                                                                                {
                                                                                                                                                    "type": "string_end",
                                                                                                                                                    "label": "\"",
                                                                                                                                                    "start_token": 3046,
                                                                                                                                                    "end_token": 3046,
                                                                                                                                                    "children": []
                                                                                                                                                }
                                                                                                                                            ]
                                                                                                                                        },
                                                                                                                                        {
                                                                                                                                            "type": "identifier",
                                                                                                                                            "label": "webhook_id",
                                                                                                                                            "start_token": 3048,
                                                                                                                                            "end_token": 3048,
                                                                                                                                            "children": []
                                                                                                                                        }
                                                                                                                                    ]
                                                                                                                                }
                                                                                                                            ]
                                                                                                                        }
                                                                                                                    ]
                                                                                                                }
                                                                                                            ]
                                                                                                        }
                                                                                                    ]
                                                                                                }
                                                                                            ]
                                                                                        },
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "label": "webhook_id",
                                                                                            "start_token": 3054,
                                                                                            "end_token": 3054,
                                                                                            "children": []
                                                                                        },
                                                                                        {
                                                                                            "type": "dictionary",
                                                                                            "label": "{\"Webhook\": {\"disconnect\": True}}",
                                                                                            "start_token": 3057,
                                                                                            "end_token": 3065,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "pair",
                                                                                                    "label": "\"Webhook\": {\"disconnect\": True}",
                                                                                                    "start_token": 3058,
                                                                                                    "end_token": 3064,
                                                                                                    "children": [
                                                                                                        {
                                                                                                            "type": "string",
                                                                                                            "label": "\"Webhook\"",
                                                                                                            "start_token": 3058,
                                                                                                            "end_token": 3058,
                                                                                                            "children": [
                                                                                                                {
                                                                                                                    "type": "string_start",
                                                                                                                    "label": "\"",
                                                                                                                    "start_token": 3058,
                                                                                                                    "end_token": 3058,
                                                                                                                    "children": []
                                                                                                                },
                                                                                                                {
                                                                                                                    "type": "string_content",
                                                                                                                    "label": "Webhook",
                                                                                                                    "start_token": 3058,
                                                                                                                    "end_token": 3058,
                                                                                                                    "children": []
                                                                                                                },
                                                                                                                {
                                                                                                                    "type": "string_end",
                                                                                                                    "label": "\"",
                                                                                                                    "start_token": 3058,
                                                                                                                    "end_token": 3058,
                                                                                                                    "children": []
                                                                                                                }
                                                                                                            ]
                                                                                                        },
                                                                                                        {
                                                                                                            "type": "dictionary",
                                                                                                            "label": "{\"disconnect\": True}",
                                                                                                            "start_token": 3060,
                                                                                                            "end_token": 3064,
                                                                                                            "children": [
                                                                                                                {
                                                                                                                    "type": "pair",
                                                                                                                    "label": "\"disconnect\": True",
                                                                                                                    "start_token": 3061,
                                                                                                                    "end_token": 3063,
                                                                                                                    "children": [
                                                                                                                        {
                                                                                                                            "type": "string",
                                                                                                                            "label": "\"disconnect\"",
                                                                                                                            "start_token": 3061,
                                                                                                                            "end_token": 3061,
                                                                                                                            "children": [
                                                                                                                                {
                                                                                                                                    "type": "string_start",
                                                                                                                                    "label": "\"",
                                                                                                                                    "start_token": 3061,
                                                                                                                                    "end_token": 3061,
                                                                                                                                    "children": []
                                                                                                                                },
                                                                                                                                {
                                                                                                                                    "type": "string_content",
                                                                                                                                    "label": "disconnect",
                                                                                                                                    "start_token": 3061,
                                                                                                                                    "end_token": 3061,
                                                                                                                                    "children": []
                                                                                                                                },
                                                                                                                                {
                                                                                                                                    "type": "string_end",
                                                                                                                                    "label": "\"",
                                                                                                                                    "start_token": 3061,
                                                                                                                                    "end_token": 3061,
                                                                                                                                    "children": []
                                                                                                                                }
                                                                                                                            ]
                                                                                                                        },
                                                                                                                        {
                                                                                                                            "type": "true",
                                                                                                                            "label": "True",
                                                                                                                            "start_token": 3063,
                                                                                                                            "end_token": 3063,
                                                                                                                            "children": []
                                                                                                                        }
                                                                                                                    ]
                                                                                                                }
                                                                                                            ]
                                                                                                        }
                                                                                                    ]
                                                                                                }
                                                                                            ]
                                                                                        }
                                                                                    ]
                                                                                }
                                                                            ]
                                                                        }
                                                                    ]
                                                                },
                                                                {
                                                                    "type": "keyword_argument",
                                                                    "label": "include=AGENT_NODE_INCLUDE",
                                                                    "start_token": 3070,
                                                                    "end_token": 3072,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "include",
                                                                            "start_token": 3070,
                                                                            "end_token": 3070,
                                                                            "children": []
                                                                        },
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "AGENT_NODE_INCLUDE",
                                                                            "start_token": 3072,
                                                                            "end_token": 3072,
                                                                            "children": []
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                }
                                            ]
                                        }
                                    ]
                                }
                            ]
                        },
                        {
                            "type": "if_statement",
                            "label": "if not node:\n        raise ValueError(f\"Node #{node_id} not found\")",
                            "start_token": 3077,
                            "end_token": 3087,
                            "children": [
                                {
                                    "type": "not_operator",
                                    "label": "not node",
                                    "start_token": 3078,
                                    "end_token": 3079,
                                    "children": [
                                        {
                                            "type": "identifier",
                                            "label": "node",
                                            "start_token": 3079,
                                            "end_token": 3079,
                                            "children": []
                                        }
                                    ]
                                },
                                {
                                    "type": "block",
                                    "label": "raise ValueError(f\"Node #{node_id} not found\")",
                                    "start_token": 3082,
                                    "end_token": 3087,
                                    "children": [
                                        {
                                            "type": "raise_statement",
                                            "label": "raise ValueError(f\"Node #{node_id} not found\")",
                                            "start_token": 3082,
                                            "end_token": 3087,
                                            "children": [
                                                {
                                                    "type": "call",
                                                    "label": "ValueError(f\"Node #{node_id} not found\")",
                                                    "start_token": 3083,
                                                    "end_token": 3087,
                                                    "children": [
                                                        {
                                                            "type": "identifier",
                                                            "label": "ValueError",
                                                            "start_token": 3083,
                                                            "end_token": 3083,
                                                            "children": []
                                                        },
                                                        {
                                                            "type": "argument_list",
                                                            "label": "(f\"Node #{node_id} not found\")",
                                                            "start_token": 3084,
                                                            "end_token": 3087,
                                                            "children": [
                                                                {
                                                                    "type": "string",
                                                                    "label": "f\"Node #{node_id} not found\"",
                                                                    "start_token": 3085,
                                                                    "end_token": 3086,
                                                                    "children": [
                                                                        {
                                                                            "type": "string_start",
                                                                            "label": "f\"",
                                                                            "start_token": 3085,
                                                                            "end_token": 3086,
                                                                            "children": []
                                                                        },
                                                                        {
                                                                            "type": "string_content",
                                                                            "label": "Node #",
                                                                            "start_token": 3086,
                                                                            "end_token": 3086,
                                                                            "children": []
                                                                        },
                                                                        {
                                                                            "type": "interpolation",
                                                                            "label": "{node_id}",
                                                                            "start_token": 3086,
                                                                            "end_token": 3086,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "node_id",
                                                                                    "start_token": 3086,
                                                                                    "end_token": 3086,
                                                                                    "children": []
                                                                                }
                                                                            ]
                                                                        },
                                                                        {
                                                                            "type": "string_content",
                                                                            "label": " not found",
                                                                            "start_token": 3086,
                                                                            "end_token": 3086,
                                                                            "children": []
                                                                        },
                                                                        {
                                                                            "type": "string_end",
                                                                            "label": "\"",
                                                                            "start_token": 3086,
                                                                            "end_token": 3086,
                                                                            "children": []
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                }
                                            ]
                                        }
                                    ]
                                }
                            ]
                        },
                        {
                            "type": "return_statement",
                            "label": "return NodeModel.from_db(node)",
                            "start_token": 3089,
                            "end_token": 3095,
                            "children": [
                                {
                                    "type": "call",
                                    "label": "NodeModel.from_db(node)",
                                    "start_token": 3090,
                                    "end_token": 3095,
                                    "children": [
                                        {
                                            "type": "attribute",
                                            "label": "NodeModel.from_db",
                                            "start_token": 3090,
                                            "end_token": 3092,
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "label": "NodeModel",
                                                    "start_token": 3090,
                                                    "end_token": 3090,
                                                    "children": []
                                                },
                                                {
                                                    "type": "identifier",
                                                    "label": "from_db",
                                                    "start_token": 3092,
                                                    "end_token": 3092,
                                                    "children": []
                                                }
                                            ]
                                        },
                                        {
                                            "type": "argument_list",
                                            "label": "(node)",
                                            "start_token": 3093,
                                            "end_token": 3095,
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "label": "node",
                                                    "start_token": 3094,
                                                    "end_token": 3094,
                                                    "children": []
                                                }
                                            ]
                                        }
                                    ]
                                }
                            ]
                        }
                    ]
                }
            ]
        },
        {
            "type": "function_definition",
            "label": "async def get_graphs(\n    user_id: str,\n    filter_by: Literal[\"active\", \"template\"] | None = \"active\",\n) -> list[GraphModel]:\n    \"\"\"\n    Retrieves graph metadata objects.\n    Default behaviour is to get all currently active graphs.\n\n    Args:\n        filter_by: An optional filter to either select templates or active graphs.\n        user_id: The ID of the user that owns the graph.\n\n    Returns:\n        list[GraphModel]: A list of objects representing the retrieved graphs.\n    \"\"\"\n    where_clause: AgentGraphWhereInput = {\"userId\": user_id}\n\n    if filter_by == \"active\":\n        where_clause[\"isActive\"] = True\n    elif filter_by == \"template\":\n        where_clause[\"isTemplate\"] = True\n\n    graphs = await AgentGraph.prisma().find_many(\n        where=where_clause,\n        distinct=[\"id\"],\n        order={\"version\": \"desc\"},\n        include=AGENT_GRAPH_INCLUDE,\n    )\n\n    graph_models = []\n    for graph in graphs:\n        try:\n            graph_models.append(GraphModel.from_db(graph))\n        except Exception as e:\n            logger.error(f\"Error processing graph {graph.id}: {e}\")\n            continue\n\n    return graph_models",
            "start_token": 3099,
            "end_token": 3261,
            "children": [
                {
                    "type": "identifier",
                    "label": "get_graphs",
                    "start_token": 3101,
                    "end_token": 3101,
                    "children": []
                },
                {
                    "type": "parameters",
                    "label": "(\n    user_id: str,\n    filter_by: Literal[\"active\", \"template\"] | None = \"active\",\n)",
                    "start_token": 3102,
                    "end_token": 3123,
                    "children": [
                        {
                            "type": "typed_parameter",
                            "label": "user_id: str",
                            "start_token": 3104,
                            "end_token": 3106,
                            "children": [
                                {
                                    "type": "identifier",
                                    "label": "user_id",
                                    "start_token": 3104,
                                    "end_token": 3104,
                                    "children": []
                                },
                                {
                                    "type": "type",
                                    "label": "str",
                                    "start_token": 3106,
                                    "end_token": 3106,
                                    "children": [
                                        {
                                            "type": "identifier",
                                            "label": "str",
                                            "start_token": 3106,
                                            "end_token": 3106,
                                            "children": []
                                        }
                                    ]
                                }
                            ]
                        },
                        {
                            "type": "typed_default_parameter",
                            "label": "filter_by: Literal[\"active\", \"template\"] | None = \"active\"",
                            "start_token": 3109,
                            "end_token": 3120,
                            "children": [
                                {
                                    "type": "identifier",
                                    "label": "filter_by",
                                    "start_token": 3109,
                                    "end_token": 3109,
                                    "children": []
                                },
                                {
                                    "type": "type",
                                    "label": "Literal[\"active\", \"template\"] | None",
                                    "start_token": 3111,
                                    "end_token": 3118,
                                    "children": [
                                        {
                                            "type": "union_type",
                                            "label": "Literal[\"active\", \"template\"] | None",
                                            "start_token": 3111,
                                            "end_token": 3118,
                                            "children": [
                                                {
                                                    "type": "type",
                                                    "label": "Literal[\"active\", \"template\"]",
                                                    "start_token": 3111,
                                                    "end_token": 3116,
                                                    "children": [
                                                        {
                                                            "type": "generic_type",
                                                            "label": "Literal[\"active\", \"template\"]",
                                                            "start_token": 3111,
                                                            "end_token": 3116,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "label": "Literal",
                                                                    "start_token": 3111,
                                                                    "end_token": 3111,
                                                                    "children": []
                                                                },
                                                                {
                                                                    "type": "type_parameter",
                                                                    "label": "[\"active\", \"template\"]",
                                                                    "start_token": 3112,
                                                                    "end_token": 3116,
                                                                    "children": [
                                                                        {
                                                                            "type": "type",
                                                                            "label": "\"active\"",
                                                                            "start_token": 3113,
                                                                            "end_token": 3113,
                                                                            "children": [
                                                                                {
                                                                                    "type": "string",
                                                                                    "label": "\"active\"",
                                                                                    "start_token": 3113,
                                                                                    "end_token": 3113,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "string_start",
                                                                                            "label": "\"",
                                                                                            "start_token": 3113,
                                                                                            "end_token": 3113,
                                                                                            "children": []
                                                                                        },
                                                                                        {
                                                                                            "type": "string_content",
                                                                                            "label": "active",
                                                                                            "start_token": 3113,
                                                                                            "end_token": 3113,
                                                                                            "children": []
                                                                                        },
                                                                                        {
                                                                                            "type": "string_end",
                                                                                            "label": "\"",
                                                                                            "start_token": 3113,
                                                                                            "end_token": 3113,
                                                                                            "children": []
                                                                                        }
                                                                                    ]
                                                                                }
                                                                            ]
                                                                        },
                                                                        {
                                                                            "type": "type",
                                                                            "label": "\"template\"",
                                                                            "start_token": 3115,
                                                                            "end_token": 3115,
                                                                            "children": [
                                                                                {
                                                                                    "type": "string",
                                                                                    "label": "\"template\"",
                                                                                    "start_token": 3115,
                                                                                    "end_token": 3115,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "string_start",
                                                                                            "label": "\"",
                                                                                            "start_token": 3115,
                                                                                            "end_token": 3115,
                                                                                            "children": []
                                                                                        },
                                                                                        {
                                                                                            "type": "string_content",
                                                                                            "label": "template",
                                                                                            "start_token": 3115,
                                                                                            "end_token": 3115,
                                                                                            "children": []
                                                                                        },
                                                                                        {
                                                                                            "type": "string_end",
                                                                                            "label": "\"",
                                                                                            "start_token": 3115,
                                                                                            "end_token": 3115,
                                                                                            "children": []
                                                                                        }
                                                                                    ]
                                                                                }
                                                                            ]
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                },
                                                {
                                                    "type": "type",
                                                    "label": "None",
                                                    "start_token": 3118,
                                                    "end_token": 3118,
                                                    "children": [
                                                        {
                                                            "type": "none",
                                                            "label": "None",
                                                            "start_token": 3118,
                                                            "end_token": 3118,
                                                            "children": []
                                                        }
                                                    ]
                                                }
                                            ]
                                        }
                                    ]
                                },
                                {
                                    "type": "string",
                                    "label": "\"active\"",
                                    "start_token": 3120,
                                    "end_token": 3120,
                                    "children": [
                                        {
                                            "type": "string_start",
                                            "label": "\"",
                                            "start_token": 3120,
                                            "end_token": 3120,
                                            "children": []
                                        },
                                        {
                                            "type": "string_content",
                                            "label": "active",
                                            "start_token": 3120,
                                            "end_token": 3120,
                                            "children": []
                                        },
                                        {
                                            "type": "string_end",
                                            "label": "\"",
                                            "start_token": 3120,
                                            "end_token": 3120,
                                            "children": []
                                        }
                                    ]
                                }
                            ]
                        }
                    ]
                },
                {
                    "type": "type",
                    "label": "list[GraphModel]",
                    "start_token": 3126,
                    "end_token": 3129,
                    "children": [
                        {
                            "type": "generic_type",
                            "label": "list[GraphModel]",
                            "start_token": 3126,
                            "end_token": 3129,
                            "children": [
                                {
                                    "type": "identifier",
                                    "label": "list",
                                    "start_token": 3126,
                                    "end_token": 3126,
                                    "children": []
                                },
                                {
                                    "type": "type_parameter",
                                    "label": "[GraphModel]",
                                    "start_token": 3127,
                                    "end_token": 3129,
                                    "children": [
                                        {
                                            "type": "type",
                                            "label": "GraphModel",
                                            "start_token": 3128,
                                            "end_token": 3128,
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "label": "GraphModel",
                                                    "start_token": 3128,
                                                    "end_token": 3128,
                                                    "children": []
                                                }
                                            ]
                                        }
                                    ]
                                }
                            ]
                        }
                    ]
                },
                {
                    "type": "block",
                    "label": "\"\"\"\n    Retrieves graph metadata objects.\n    Default behaviour is to get all currently active graphs.\n\n    Args:\n        filter_by: An optional filter to either select templates or active graphs.\n        user_id: The ID of the user that owns the graph.\n\n    Returns:\n        list[GraphModel]: A list of objects representing the retrieved graphs.\n    \"\"\"\n    where_clause: AgentGraphWhereInput = {\"userId\": user_id}\n\n    if filter_by == \"active\":\n        where_clause[\"isActive\"] = True\n    elif filter_by == \"template\":\n        where_clause[\"isTemplate\"] = True\n\n    graphs = await AgentGraph.prisma().find_many(\n        where=where_clause,\n        distinct=[\"id\"],\n        order={\"version\": \"desc\"},\n        include=AGENT_GRAPH_INCLUDE,\n    )\n\n    graph_models = []\n    for graph in graphs:\n        try:\n            graph_models.append(GraphModel.from_db(graph))\n        except Exception as e:\n            logger.error(f\"Error processing graph {graph.id}: {e}\")\n            continue\n\n    return graph_models",
                    "start_token": 3132,
                    "end_token": 3261,
                    "children": [
                        {
                            "type": "expression_statement",
                            "label": "\"\"\"\n    Retrieves graph metadata objects.\n    Default behaviour is to get all currently active graphs.\n\n    Args:\n        filter_by: An optional filter to either select templates or active graphs.\n        user_id: The ID of the user that owns the graph.\n\n    Returns:\n        list[GraphModel]: A list of objects representing the retrieved graphs.\n    \"\"\"",
                            "start_token": 3132,
                            "end_token": 3134,
                            "children": [
                                {
                                    "type": "string",
                                    "label": "\"\"\"\n    Retrieves graph metadata objects.\n    Default behaviour is to get all currently active graphs.\n\n    Args:\n        filter_by: An optional filter to either select templates or active graphs.\n        user_id: The ID of the user that owns the graph.\n\n    Returns:\n        list[GraphModel]: A list of objects representing the retrieved graphs.\n    \"\"\"",
                                    "start_token": 3132,
                                    "end_token": 3134,
                                    "children": [
                                        {
                                            "type": "string_start",
                                            "label": "\"\"\"",
                                            "start_token": 3132,
                                            "end_token": 3133,
                                            "children": []
                                        },
                                        {
                                            "type": "string_content",
                                            "label": "\n    Retrieves graph metadata objects.\n    Default behaviour is to get all currently active graphs.\n\n    Args:\n        filter_by: An optional filter to either select templates or active graphs.\n        user_id: The ID of the user that owns the graph.\n\n    Returns:\n        list[GraphModel]: A list of objects representing the retrieved graphs.\n    ",
                                            "start_token": 3133,
                                            "end_token": 3133,
                                            "children": []
                                        },
                                        {
                                            "type": "string_end",
                                            "label": "\"\"\"",
                                            "start_token": 3133,
                                            "end_token": 3134,
                                            "children": []
                                        }
                                    ]
                                }
                            ]
                        },
                        {
                            "type": "expression_statement",
                            "label": "where_clause: AgentGraphWhereInput = {\"userId\": user_id}",
                            "start_token": 3136,
                            "end_token": 3144,
                            "children": [
                                {
                                    "type": "assignment",
                                    "label": "where_clause: AgentGraphWhereInput = {\"userId\": user_id}",
                                    "start_token": 3136,
                                    "end_token": 3144,
                                    "children": [
                                        {
                                            "type": "identifier",
                                            "label": "where_clause",
                                            "start_token": 3136,
                                            "end_token": 3136,
                                            "children": []
                                        },
                                        {
                                            "type": "type",
                                            "label": "AgentGraphWhereInput",
                                            "start_token": 3138,
                                            "end_token": 3138,
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "label": "AgentGraphWhereInput",
                                                    "start_token": 3138,
                                                    "end_token": 3138,
                                                    "children": []
                                                }
                                            ]
                                        },
                                        {
                                            "type": "dictionary",
                                            "label": "{\"userId\": user_id}",
                                            "start_token": 3140,
                                            "end_token": 3144,
                                            "children": [
                                                {
                                                    "type": "pair",
                                                    "label": "\"userId\": user_id",
                                                    "start_token": 3141,
                                                    "end_token": 3143,
                                                    "children": [
                                                        {
                                                            "type": "string",
                                                            "label": "\"userId\"",
                                                            "start_token": 3141,
                                                            "end_token": 3141,
                                                            "children": [
                                                                {
                                                                    "type": "string_start",
                                                                    "label": "\"",
                                                                    "start_token": 3141,
                                                                    "end_token": 3141,
                                                                    "children": []
                                                                },
                                                                {
                                                                    "type": "string_content",
                                                                    "label": "userId",
                                                                    "start_token": 3141,
                                                                    "end_token": 3141,
                                                                    "children": []
                                                                },
                                                                {
                                                                    "type": "string_end",
                                                                    "label": "\"",
                                                                    "start_token": 3141,
                                                                    "end_token": 3141,
                                                                    "children": []
                                                                }
                                                            ]
                                                        },
                                                        {
                                                            "type": "identifier",
                                                            "label": "user_id",
                                                            "start_token": 3143,
                                                            "end_token": 3143,
                                                            "children": []
                                                        }
                                                    ]
                                                }
                                            ]
                                        }
                                    ]
                                }
                            ]
                        },
                        {
                            "type": "if_statement",
                            "label": "if filter_by == \"active\":\n        where_clause[\"isActive\"] = True\n    elif filter_by == \"template\":\n        where_clause[\"isTemplate\"] = True",
                            "start_token": 3147,
                            "end_token": 3173,
                            "children": [
                                {
                                    "type": "comparison_operator",
                                    "label": "filter_by == \"active\"",
                                    "start_token": 3148,
                                    "end_token": 3151,
                                    "children": [
                                        {
                                            "type": "identifier",
                                            "label": "filter_by",
                                            "start_token": 3148,
                                            "end_token": 3148,
                                            "children": []
                                        },
                                        {
                                            "type": "string",
                                            "label": "\"active\"",
                                            "start_token": 3151,
                                            "end_token": 3151,
                                            "children": [
                                                {
                                                    "type": "string_start",
                                                    "label": "\"",
                                                    "start_token": 3151,
                                                    "end_token": 3151,
                                                    "children": []
                                                },
                                                {
                                                    "type": "string_content",
                                                    "label": "active",
                                                    "start_token": 3151,
                                                    "end_token": 3151,
                                                    "children": []
                                                },
                                                {
                                                    "type": "string_end",
                                                    "label": "\"",
                                                    "start_token": 3151,
                                                    "end_token": 3151,
                                                    "children": []
                                                }
                                            ]
                                        }
                                    ]
                                },
                                {
                                    "type": "block",
                                    "label": "where_clause[\"isActive\"] = True",
                                    "start_token": 3154,
                                    "end_token": 3159,
                                    "children": [
                                        {
                                            "type": "expression_statement",
                                            "label": "where_clause[\"isActive\"] = True",
                                            "start_token": 3154,
                                            "end_token": 3159,
                                            "children": [
                                                {
                                                    "type": "assignment",
                                                    "label": "where_clause[\"isActive\"] = True",
                                                    "start_token": 3154,
                                                    "end_token": 3159,
                                                    "children": [
                                                        {
                                                            "type": "subscript",
                                                            "label": "where_clause[\"isActive\"]",
                                                            "start_token": 3154,
                                                            "end_token": 3157,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "label": "where_clause",
                                                                    "start_token": 3154,
                                                                    "end_token": 3154,
                                                                    "children": []
                                                                },
                                                                {
                                                                    "type": "string",
                                                                    "label": "\"isActive\"",
                                                                    "start_token": 3156,
                                                                    "end_token": 3156,
                                                                    "children": [
                                                                        {
                                                                            "type": "string_start",
                                                                            "label": "\"",
                                                                            "start_token": 3156,
                                                                            "end_token": 3156,
                                                                            "children": []
                                                                        },
                                                                        {
                                                                            "type": "string_content",
                                                                            "label": "isActive",
                                                                            "start_token": 3156,
                                                                            "end_token": 3156,
                                                                            "children": []
                                                                        },
                                                                        {
                                                                            "type": "string_end",
                                                                            "label": "\"",
                                                                            "start_token": 3156,
                                                                            "end_token": 3156,
                                                                            "children": []
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        },
                                                        {
                                                            "type": "true",
                                                            "label": "True",
                                                            "start_token": 3159,
                                                            "end_token": 3159,
                                                            "children": []
                                                        }
                                                    ]
                                                }
                                            ]
                                        }
                                    ]
                                },
                                {
                                    "type": "elif_clause",
                                    "label": "elif filter_by == \"template\":\n        where_clause[\"isTemplate\"] = True",
                                    "start_token": 3161,
                                    "end_token": 3173,
                                    "children": [
                                        {
                                            "type": "comparison_operator",
                                            "label": "filter_by == \"template\"",
                                            "start_token": 3162,
                                            "end_token": 3165,
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "label": "filter_by",
                                                    "start_token": 3162,
                                                    "end_token": 3162,
                                                    "children": []
                                                },
                                                {
                                                    "type": "string",
                                                    "label": "\"template\"",
                                                    "start_token": 3165,
                                                    "end_token": 3165,
                                                    "children": [
                                                        {
                                                            "type": "string_start",
                                                            "label": "\"",
                                                            "start_token": 3165,
                                                            "end_token": 3165,
                                                            "children": []
                                                        },
                                                        {
                                                            "type": "string_content",
                                                            "label": "template",
                                                            "start_token": 3165,
                                                            "end_token": 3165,
                                                            "children": []
                                                        },
                                                        {
                                                            "type": "string_end",
                                                            "label": "\"",
                                                            "start_token": 3165,
                                                            "end_token": 3165,
                                                            "children": []
                                                        }
                                                    ]
                                                }
                                            ]
                                        },
                                        {
                                            "type": "block",
                                            "label": "where_clause[\"isTemplate\"] = True",
                                            "start_token": 3168,
                                            "end_token": 3173,
                                            "children": [
                                                {
                                                    "type": "expression_statement",
                                                    "label": "where_clause[\"isTemplate\"] = True",
                                                    "start_token": 3168,
                                                    "end_token": 3173,
                                                    "children": [
                                                        {
                                                            "type": "assignment",
                                                            "label": "where_clause[\"isTemplate\"] = True",
                                                            "start_token": 3168,
                                                            "end_token": 3173,
                                                            "children": [
                                                                {
                                                                    "type": "subscript",
                                                                    "label": "where_clause[\"isTemplate\"]",
                                                                    "start_token": 3168,
                                                                    "end_token": 3171,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "where_clause",
                                                                            "start_token": 3168,
                                                                            "end_token": 3168,
                                                                            "children": []
                                                                        },
                                                                        {
                                                                            "type": "string",
                                                                            "label": "\"isTemplate\"",
                                                                            "start_token": 3170,
                                                                            "end_token": 3170,
                                                                            "children": [
                                                                                {
                                                                                    "type": "string_start",
                                                                                    "label": "\"",
                                                                                    "start_token": 3170,
                                                                                    "end_token": 3170,
                                                                                    "children": []
                                                                                },
                                                                                {
                                                                                    "type": "string_content",
                                                                                    "label": "isTemplate",
                                                                                    "start_token": 3170,
                                                                                    "end_token": 3170,
                                                                                    "children": []
                                                                                },
                                                                                {
                                                                                    "type": "string_end",
                                                                                    "label": "\"",
                                                                                    "start_token": 3170,
                                                                                    "end_token": 3170,
                                                                                    "children": []
                                                                                }
                                                                            ]
                                                                        }
                                                                    ]
                                                                },
                                                                {
                                                                    "type": "true",
                                                                    "label": "True",
                                                                    "start_token": 3173,
                                                                    "end_token": 3173,
                                                                    "children": []
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                }
                                            ]
                                        }
                                    ]
                                }
                            ]
                        },
                        {
                            "type": "expression_statement",
                            "label": "graphs = await AgentGraph.prisma().find_many(\n        where=where_clause,\n        distinct=[\"id\"],\n        order={\"version\": \"desc\"},\n        include=AGENT_GRAPH_INCLUDE,\n    )",
                            "start_token": 3176,
                            "end_token": 3214,
                            "children": [
                                {
                                    "type": "assignment",
                                    "label": "graphs = await AgentGraph.prisma().find_many(\n        where=where_clause,\n        distinct=[\"id\"],\n        order={\"version\": \"desc\"},\n        include=AGENT_GRAPH_INCLUDE,\n    )",
                                    "start_token": 3176,
                                    "end_token": 3214,
                                    "children": [
                                        {
                                            "type": "identifier",
                                            "label": "graphs",
                                            "start_token": 3176,
                                            "end_token": 3176,
                                            "children": []
                                        },
                                        {
                                            "type": "await",
                                            "label": "await AgentGraph.prisma().find_many(\n        where=where_clause,\n        distinct=[\"id\"],\n        order={\"version\": \"desc\"},\n        include=AGENT_GRAPH_INCLUDE,\n    )",
                                            "start_token": 3178,
                                            "end_token": 3214,
                                            "children": [
                                                {
                                                    "type": "call",
                                                    "label": "AgentGraph.prisma().find_many(\n        where=where_clause,\n        distinct=[\"id\"],\n        order={\"version\": \"desc\"},\n        include=AGENT_GRAPH_INCLUDE,\n    )",
                                                    "start_token": 3179,
                                                    "end_token": 3214,
                                                    "children": [
                                                        {
                                                            "type": "attribute",
                                                            "label": "AgentGraph.prisma().find_many",
                                                            "start_token": 3179,
                                                            "end_token": 3185,
                                                            "children": [
                                                                {
                                                                    "type": "call",
                                                                    "label": "AgentGraph.prisma()",
                                                                    "start_token": 3179,
                                                                    "end_token": 3183,
                                                                    "children": [
                                                                        {
                                                                            "type": "attribute",
                                                                            "label": "AgentGraph.prisma",
                                                                            "start_token": 3179,
                                                                            "end_token": 3181,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "AgentGraph",
                                                                                    "start_token": 3179,
                                                                                    "end_token": 3179,
                                                                                    "children": []
                                                                                },
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "prisma",
                                                                                    "start_token": 3181,
                                                                                    "end_token": 3181,
                                                                                    "children": []
                                                                                }
                                                                            ]
                                                                        },
                                                                        {
                                                                            "type": "argument_list",
                                                                            "label": "()",
                                                                            "start_token": 3182,
                                                                            "end_token": 3183,
                                                                            "children": []
                                                                        }
                                                                    ]
                                                                },
                                                                {
                                                                    "type": "identifier",
                                                                    "label": "find_many",
                                                                    "start_token": 3185,
                                                                    "end_token": 3185,
                                                                    "children": []
                                                                }
                                                            ]
                                                        },
                                                        {
                                                            "type": "argument_list",
                                                            "label": "(\n        where=where_clause,\n        distinct=[\"id\"],\n        order={\"version\": \"desc\"},\n        include=AGENT_GRAPH_INCLUDE,\n    )",
                                                            "start_token": 3186,
                                                            "end_token": 3214,
                                                            "children": [
                                                                {
                                                                    "type": "keyword_argument",
                                                                    "label": "where=where_clause",
                                                                    "start_token": 3188,
                                                                    "end_token": 3190,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "where",
                                                                            "start_token": 3188,
                                                                            "end_token": 3188,
                                                                            "children": []
                                                                        },
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "where_clause",
                                                                            "start_token": 3190,
                                                                            "end_token": 3190,
                                                                            "children": []
                                                                        }
                                                                    ]
                                                                },
                                                                {
                                                                    "type": "keyword_argument",
                                                                    "label": "distinct=[\"id\"]",
                                                                    "start_token": 3193,
                                                                    "end_token": 3197,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "distinct",
                                                                            "start_token": 3193,
                                                                            "end_token": 3193,
                                                                            "children": []
                                                                        },
                                                                        {
                                                                            "type": "list",
                                                                            "label": "[\"id\"]",
                                                                            "start_token": 3195,
                                                                            "end_token": 3197,
                                                                            "children": [
                                                                                {
                                                                                    "type": "string",
                                                                                    "label": "\"id\"",
                                                                                    "start_token": 3196,
                                                                                    "end_token": 3196,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "string_start",
                                                                                            "label": "\"",
                                                                                            "start_token": 3196,
                                                                                            "end_token": 3196,
                                                                                            "children": []
                                                                                        },
                                                                                        {
                                                                                            "type": "string_content",
                                                                                            "label": "id",
                                                                                            "start_token": 3196,
                                                                                            "end_token": 3196,
                                                                                            "children": []
                                                                                        },
                                                                                        {
                                                                                            "type": "string_end",
                                                                                            "label": "\"",
                                                                                            "start_token": 3196,
                                                                                            "end_token": 3196,
                                                                                            "children": []
                                                                                        }
                                                                                    ]
                                                                                }
                                                                            ]
                                                                        }
                                                                    ]
                                                                },
                                                                {
                                                                    "type": "keyword_argument",
                                                                    "label": "order={\"version\": \"desc\"}",
                                                                    "start_token": 3200,
                                                                    "end_token": 3206,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "order",
                                                                            "start_token": 3200,
                                                                            "end_token": 3200,
                                                                            "children": []
                                                                        },
                                                                        {
                                                                            "type": "dictionary",
                                                                            "label": "{\"version\": \"desc\"}",
                                                                            "start_token": 3202,
                                                                            "end_token": 3206,
                                                                            "children": [
                                                                                {
                                                                                    "type": "pair",
                                                                                    "label": "\"version\": \"desc\"",
                                                                                    "start_token": 3203,
                                                                                    "end_token": 3205,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "string",
                                                                                            "label": "\"version\"",
                                                                                            "start_token": 3203,
                                                                                            "end_token": 3203,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "string_start",
                                                                                                    "label": "\"",
                                                                                                    "start_token": 3203,
                                                                                                    "end_token": 3203,
                                                                                                    "children": []
                                                                                                },
                                                                                                {
                                                                                                    "type": "string_content",
                                                                                                    "label": "version",
                                                                                                    "start_token": 3203,
                                                                                                    "end_token": 3203,
                                                                                                    "children": []
                                                                                                },
                                                                                                {
                                                                                                    "type": "string_end",
                                                                                                    "label": "\"",
                                                                                                    "start_token": 3203,
                                                                                                    "end_token": 3203,
                                                                                                    "children": []
                                                                                                }
                                                                                            ]
                                                                                        },
                                                                                        {
                                                                                            "type": "string",
                                                                                            "label": "\"desc\"",
                                                                                            "start_token": 3205,
                                                                                            "end_token": 3205,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "string_start",
                                                                                                    "label": "\"",
                                                                                                    "start_token": 3205,
                                                                                                    "end_token": 3205,
                                                                                                    "children": []
                                                                                                },
                                                                                                {
                                                                                                    "type": "string_content",
                                                                                                    "label": "desc",
                                                                                                    "start_token": 3205,
                                                                                                    "end_token": 3205,
                                                                                                    "children": []
                                                                                                },
                                                                                                {
                                                                                                    "type": "string_end",
                                                                                                    "label": "\"",
                                                                                                    "start_token": 3205,
                                                                                                    "end_token": 3205,
                                                                                                    "children": []
                                                                                                }
                                                                                            ]
                                                                                        }
                                                                                    ]
                                                                                }
                                                                            ]
                                                                        }
                                                                    ]
                                                                },
                                                                {
                                                                    "type": "keyword_argument",
                                                                    "label": "include=AGENT_GRAPH_INCLUDE",
                                                                    "start_token": 3209,
                                                                    "end_token": 3211,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "include",
                                                                            "start_token": 3209,
                                                                            "end_token": 3209,
                                                                            "children": []
                                                                        },
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "AGENT_GRAPH_INCLUDE",
                                                                            "start_token": 3211,
                                                                            "end_token": 3211,
                                                                            "children": []
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                }
                                            ]
                                        }
                                    ]
                                }
                            ]
                        },
                        {
                            "type": "expression_statement",
                            "label": "graph_models = []",
                            "start_token": 3217,
                            "end_token": 3220,
                            "children": [
                                {
                                    "type": "assignment",
                                    "label": "graph_models = []",
                                    "start_token": 3217,
                                    "end_token": 3220,
                                    "children": [
                                        {
                                            "type": "identifier",
                                            "label": "graph_models",
                                            "start_token": 3217,
                                            "end_token": 3217,
                                            "children": []
                                        },
                                        {
                                            "type": "list",
                                            "label": "[]",
                                            "start_token": 3219,
                                            "end_token": 3220,
                                            "children": []
                                        }
                                    ]
                                }
                            ]
                        },
                        {
                            "type": "for_statement",
                            "label": "for graph in graphs:\n        try:\n            graph_models.append(GraphModel.from_db(graph))\n        except Exception as e:\n            logger.error(f\"Error processing graph {graph.id}: {e}\")\n            continue",
                            "start_token": 3222,
                            "end_token": 3257,
                            "children": [
                                {
                                    "type": "identifier",
                                    "label": "graph",
                                    "start_token": 3223,
                                    "end_token": 3223,
                                    "children": []
                                },
                                {
                                    "type": "identifier",
                                    "label": "graphs",
                                    "start_token": 3225,
                                    "end_token": 3225,
                                    "children": []
                                },
                                {
                                    "type": "block",
                                    "label": "try:\n            graph_models.append(GraphModel.from_db(graph))\n        except Exception as e:\n            logger.error(f\"Error processing graph {graph.id}: {e}\")\n            continue",
                                    "start_token": 3228,
                                    "end_token": 3257,
                                    "children": [
                                        {
                                            "type": "try_statement",
                                            "label": "try:\n            graph_models.append(GraphModel.from_db(graph))\n        except Exception as e:\n            logger.error(f\"Error processing graph {graph.id}: {e}\")\n            continue",
                                            "start_token": 3228,
                                            "end_token": 3257,
                                            "children": [
                                                {
                                                    "type": "block",
                                                    "label": "graph_models.append(GraphModel.from_db(graph))",
                                                    "start_token": 3231,
                                                    "end_token": 3241,
                                                    "children": [
                                                        {
                                                            "type": "expression_statement",
                                                            "label": "graph_models.append(GraphModel.from_db(graph))",
                                                            "start_token": 3231,
                                                            "end_token": 3241,
                                                            "children": [
                                                                {
                                                                    "type": "call",
                                                                    "label": "graph_models.append(GraphModel.from_db(graph))",
                                                                    "start_token": 3231,
                                                                    "end_token": 3241,
                                                                    "children": [
                                                                        {
                                                                            "type": "attribute",
                                                                            "label": "graph_models.append",
                                                                            "start_token": 3231,
                                                                            "end_token": 3233,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "graph_models",
                                                                                    "start_token": 3231,
                                                                                    "end_token": 3231,
                                                                                    "children": []
                                                                                },
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "append",
                                                                                    "start_token": 3233,
                                                                                    "end_token": 3233,
                                                                                    "children": []
                                                                                }
                                                                            ]
                                                                        },
                                                                        {
                                                                            "type": "argument_list",
                                                                            "label": "(GraphModel.from_db(graph))",
                                                                            "start_token": 3234,
                                                                            "end_token": 3241,
                                                                            "children": [
                                                                                {
                                                                                    "type": "call",
                                                                                    "label": "GraphModel.from_db(graph)",
                                                                                    "start_token": 3235,
                                                                                    "end_token": 3240,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "attribute",
                                                                                            "label": "GraphModel.from_db",
                                                                                            "start_token": 3235,
                                                                                            "end_token": 3237,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "label": "GraphModel",
                                                                                                    "start_token": 3235,
                                                                                                    "end_token": 3235,
                                                                                                    "children": []
                                                                                                },
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "label": "from_db",
                                                                                                    "start_token": 3237,
                                                                                                    "end_token": 3237,
                                                                                                    "children": []
                                                                                                }
                                                                                            ]
                                                                                        },
                                                                                        {
                                                                                            "type": "argument_list",
                                                                                            "label": "(graph)",
                                                                                            "start_token": 3238,
                                                                                            "end_token": 3240,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "label": "graph",
                                                                                                    "start_token": 3239,
                                                                                                    "end_token": 3239,
                                                                                                    "children": []
                                                                                                }
                                                                                            ]
                                                                                        }
                                                                                    ]
                                                                                }
                                                                            ]
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                },
                                                {
                                                    "type": "except_clause",
                                                    "label": "except Exception as e:\n            logger.error(f\"Error processing graph {graph.id}: {e}\")\n            continue",
                                                    "start_token": 3243,
                                                    "end_token": 3257,
                                                    "children": [
                                                        {
                                                            "type": "as_pattern",
                                                            "label": "Exception as e",
                                                            "start_token": 3244,
                                                            "end_token": 3246,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "label": "Exception",
                                                                    "start_token": 3244,
                                                                    "end_token": 3244,
                                                                    "children": []
                                                                },
                                                                {
                                                                    "type": "as_pattern_target",
                                                                    "label": "e",
                                                                    "start_token": 3246,
                                                                    "end_token": 3246,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "e",
                                                                            "start_token": 3246,
                                                                            "end_token": 3246,
                                                                            "children": []
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        },
                                                        {
                                                            "type": "block",
                                                            "label": "logger.error(f\"Error processing graph {graph.id}: {e}\")\n            continue",
                                                            "start_token": 3249,
                                                            "end_token": 3257,
                                                            "children": [
                                                                {
                                                                    "type": "expression_statement",
                                                                    "label": "logger.error(f\"Error processing graph {graph.id}: {e}\")",
                                                                    "start_token": 3249,
                                                                    "end_token": 3255,
                                                                    "children": [
                                                                        {
                                                                            "type": "call",
                                                                            "label": "logger.error(f\"Error processing graph {graph.id}: {e}\")",
                                                                            "start_token": 3249,
                                                                            "end_token": 3255,
                                                                            "children": [
                                                                                {
                                                                                    "type": "attribute",
                                                                                    "label": "logger.error",
                                                                                    "start_token": 3249,
                                                                                    "end_token": 3251,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "label": "logger",
                                                                                            "start_token": 3249,
                                                                                            "end_token": 3249,
                                                                                            "children": []
                                                                                        },
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "label": "error",
                                                                                            "start_token": 3251,
                                                                                            "end_token": 3251,
                                                                                            "children": []
                                                                                        }
                                                                                    ]
                                                                                },
                                                                                {
                                                                                    "type": "argument_list",
                                                                                    "label": "(f\"Error processing graph {graph.id}: {e}\")",
                                                                                    "start_token": 3252,
                                                                                    "end_token": 3255,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "string",
                                                                                            "label": "f\"Error processing graph {graph.id}: {e}\"",
                                                                                            "start_token": 3253,
                                                                                            "end_token": 3254,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "string_start",
                                                                                                    "label": "f\"",
                                                                                                    "start_token": 3253,
                                                                                                    "end_token": 3254,
                                                                                                    "children": []
                                                                                                },
                                                                                                {
                                                                                                    "type": "string_content",
                                                                                                    "label": "Error processing graph ",
                                                                                                    "start_token": 3254,
                                                                                                    "end_token": 3254,
                                                                                                    "children": []
                                                                                                },
                                                                                                {
                                                                                                    "type": "interpolation",
                                                                                                    "label": "{graph.id}",
                                                                                                    "start_token": 3254,
                                                                                                    "end_token": 3254,
                                                                                                    "children": [
                                                                                                        {
                                                                                                            "type": "attribute",
                                                                                                            "label": "graph.id",
                                                                                                            "start_token": 3254,
                                                                                                            "end_token": 3254,
                                                                                                            "children": [
                                                                                                                {
                                                                                                                    "type": "identifier",
                                                                                                                    "label": "graph",
                                                                                                                    "start_token": 3254,
                                                                                                                    "end_token": 3254,
                                                                                                                    "children": []
                                                                                                                },
                                                                                                                {
                                                                                                                    "type": "identifier",
                                                                                                                    "label": "id",
                                                                                                                    "start_token": 3254,
                                                                                                                    "end_token": 3254,
                                                                                                                    "children": []
                                                                                                                }
                                                                                                            ]
                                                                                                        }
                                                                                                    ]
                                                                                                },
                                                                                                {
                                                                                                    "type": "string_content",
                                                                                                    "label": ": ",
                                                                                                    "start_token": 3254,
                                                                                                    "end_token": 3254,
                                                                                                    "children": []
                                                                                                },
                                                                                                {
                                                                                                    "type": "interpolation",
                                                                                                    "label": "{e}",
                                                                                                    "start_token": 3254,
                                                                                                    "end_token": 3254,
                                                                                                    "children": [
                                                                                                        {
                                                                                                            "type": "identifier",
                                                                                                            "label": "e",
                                                                                                            "start_token": 3254,
                                                                                                            "end_token": 3254,
                                                                                                            "children": []
                                                                                                        }
                                                                                                    ]
                                                                                                },
                                                                                                {
                                                                                                    "type": "string_end",
                                                                                                    "label": "\"",
                                                                                                    "start_token": 3254,
                                                                                                    "end_token": 3254,
                                                                                                    "children": []
                                                                                                }
                                                                                            ]
                                                                                        }
                                                                                    ]
                                                                                }
                                                                            ]
                                                                        }
                                                                    ]
                                                                },
                                                                {
                                                                    "type": "continue_statement",
                                                                    "label": "continue",
                                                                    "start_token": 3257,
                                                                    "end_token": 3257,
                                                                    "children": []
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                }
                                            ]
                                        }
                                    ]
                                }
                            ]
                        },
                        {
                            "type": "return_statement",
                            "label": "return graph_models",
                            "start_token": 3260,
                            "end_token": 3261,
                            "children": [
                                {
                                    "type": "identifier",
                                    "label": "graph_models",
                                    "start_token": 3261,
                                    "end_token": 3261,
                                    "children": []
                                }
                            ]
                        }
                    ]
                }
            ]
        },
        {
            "type": "function_definition",
            "label": "async def get_executions(user_id: str) -> list[GraphExecution]:\n    executions = await AgentGraphExecution.prisma().find_many(\n        where={\"userId\": user_id},\n        order={\"createdAt\": \"desc\"},\n    )\n    return [GraphExecution.from_db(execution) for execution in executions]",
            "start_token": 3265,
            "end_token": 3325,
            "children": [
                {
                    "type": "identifier",
                    "label": "get_executions",
                    "start_token": 3267,
                    "end_token": 3267,
                    "children": []
                },
                {
                    "type": "parameters",
                    "label": "(user_id: str)",
                    "start_token": 3268,
                    "end_token": 3272,
                    "children": [
                        {
                            "type": "typed_parameter",
                            "label": "user_id: str",
                            "start_token": 3269,
                            "end_token": 3271,
                            "children": [
                                {
                                    "type": "identifier",
                                    "label": "user_id",
                                    "start_token": 3269,
                                    "end_token": 3269,
                                    "children": []
                                },
                                {
                                    "type": "type",
                                    "label": "str",
                                    "start_token": 3271,
                                    "end_token": 3271,
                                    "children": [
                                        {
                                            "type": "identifier",
                                            "label": "str",
                                            "start_token": 3271,
                                            "end_token": 3271,
                                            "children": []
                                        }
                                    ]
                                }
                            ]
                        }
                    ]
                },
                {
                    "type": "type",
                    "label": "list[GraphExecution]",
                    "start_token": 3275,
                    "end_token": 3278,
                    "children": [
                        {
                            "type": "generic_type",
                            "label": "list[GraphExecution]",
                            "start_token": 3275,
                            "end_token": 3278,
                            "children": [
                                {
                                    "type": "identifier",
                                    "label": "list",
                                    "start_token": 3275,
                                    "end_token": 3275,
                                    "children": []
                                },
                                {
                                    "type": "type_parameter",
                                    "label": "[GraphExecution]",
                                    "start_token": 3276,
                                    "end_token": 3278,
                                    "children": [
                                        {
                                            "type": "type",
                                            "label": "GraphExecution",
                                            "start_token": 3277,
                                            "end_token": 3277,
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "label": "GraphExecution",
                                                    "start_token": 3277,
                                                    "end_token": 3277,
                                                    "children": []
                                                }
                                            ]
                                        }
                                    ]
                                }
                            ]
                        }
                    ]
                },
                {
                    "type": "block",
                    "label": "executions = await AgentGraphExecution.prisma().find_many(\n        where={\"userId\": user_id},\n        order={\"createdAt\": \"desc\"},\n    )\n    return [GraphExecution.from_db(execution) for execution in executions]",
                    "start_token": 3281,
                    "end_token": 3325,
                    "children": [
                        {
                            "type": "expression_statement",
                            "label": "executions = await AgentGraphExecution.prisma().find_many(\n        where={\"userId\": user_id},\n        order={\"createdAt\": \"desc\"},\n    )",
                            "start_token": 3281,
                            "end_token": 3311,
                            "children": [
                                {
                                    "type": "assignment",
                                    "label": "executions = await AgentGraphExecution.prisma().find_many(\n        where={\"userId\": user_id},\n        order={\"createdAt\": \"desc\"},\n    )",
                                    "start_token": 3281,
                                    "end_token": 3311,
                                    "children": [
                                        {
                                            "type": "identifier",
                                            "label": "executions",
                                            "start_token": 3281,
                                            "end_token": 3281,
                                            "children": []
                                        },
                                        {
                                            "type": "await",
                                            "label": "await AgentGraphExecution.prisma().find_many(\n        where={\"userId\": user_id},\n        order={\"createdAt\": \"desc\"},\n    )",
                                            "start_token": 3283,
                                            "end_token": 3311,
                                            "children": [
                                                {
                                                    "type": "call",
                                                    "label": "AgentGraphExecution.prisma().find_many(\n        where={\"userId\": user_id},\n        order={\"createdAt\": \"desc\"},\n    )",
                                                    "start_token": 3284,
                                                    "end_token": 3311,
                                                    "children": [
                                                        {
                                                            "type": "attribute",
                                                            "label": "AgentGraphExecution.prisma().find_many",
                                                            "start_token": 3284,
                                                            "end_token": 3290,
                                                            "children": [
                                                                {
                                                                    "type": "call",
                                                                    "label": "AgentGraphExecution.prisma()",
                                                                    "start_token": 3284,
                                                                    "end_token": 3288,
                                                                    "children": [
                                                                        {
                                                                            "type": "attribute",
                                                                            "label": "AgentGraphExecution.prisma",
                                                                            "start_token": 3284,
                                                                            "end_token": 3286,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "AgentGraphExecution",
                                                                                    "start_token": 3284,
                                                                                    "end_token": 3284,
                                                                                    "children": []
                                                                                },
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "prisma",
                                                                                    "start_token": 3286,
                                                                                    "end_token": 3286,
                                                                                    "children": []
                                                                                }
                                                                            ]
                                                                        },
                                                                        {
                                                                            "type": "argument_list",
                                                                            "label": "()",
                                                                            "start_token": 3287,
                                                                            "end_token": 3288,
                                                                            "children": []
                                                                        }
                                                                    ]
                                                                },
                                                                {
                                                                    "type": "identifier",
                                                                    "label": "find_many",
                                                                    "start_token": 3290,
                                                                    "end_token": 3290,
                                                                    "children": []
                                                                }
                                                            ]
                                                        },
                                                        {
                                                            "type": "argument_list",
                                                            "label": "(\n        where={\"userId\": user_id},\n        order={\"createdAt\": \"desc\"},\n    )",
                                                            "start_token": 3291,
                                                            "end_token": 3311,
                                                            "children": [
                                                                {
                                                                    "type": "keyword_argument",
                                                                    "label": "where={\"userId\": user_id}",
                                                                    "start_token": 3293,
                                                                    "end_token": 3299,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "where",
                                                                            "start_token": 3293,
                                                                            "end_token": 3293,
                                                                            "children": []
                                                                        },
                                                                        {
                                                                            "type": "dictionary",
                                                                            "label": "{\"userId\": user_id}",
                                                                            "start_token": 3295,
                                                                            "end_token": 3299,
                                                                            "children": [
                                                                                {
                                                                                    "type": "pair",
                                                                                    "label": "\"userId\": user_id",
                                                                                    "start_token": 3296,
                                                                                    "end_token": 3298,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "string",
                                                                                            "label": "\"userId\"",
                                                                                            "start_token": 3296,
                                                                                            "end_token": 3296,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "string_start",
                                                                                                    "label": "\"",
                                                                                                    "start_token": 3296,
                                                                                                    "end_token": 3296,
                                                                                                    "children": []
                                                                                                },
                                                                                                {
                                                                                                    "type": "string_content",
                                                                                                    "label": "userId",
                                                                                                    "start_token": 3296,
                                                                                                    "end_token": 3296,
                                                                                                    "children": []
                                                                                                },
                                                                                                {
                                                                                                    "type": "string_end",
                                                                                                    "label": "\"",
                                                                                                    "start_token": 3296,
                                                                                                    "end_token": 3296,
                                                                                                    "children": []
                                                                                                }
                                                                                            ]
                                                                                        },
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "label": "user_id",
                                                                                            "start_token": 3298,
                                                                                            "end_token": 3298,
                                                                                            "children": []
                                                                                        }
                                                                                    ]
                                                                                }
                                                                            ]
                                                                        }
                                                                    ]
                                                                },
                                                                {
                                                                    "type": "keyword_argument",
                                                                    "label": "order={\"createdAt\": \"desc\"}",
                                                                    "start_token": 3302,
                                                                    "end_token": 3308,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "order",
                                                                            "start_token": 3302,
                                                                            "end_token": 3302,
                                                                            "children": []
                                                                        },
                                                                        {
                                                                            "type": "dictionary",
                                                                            "label": "{\"createdAt\": \"desc\"}",
                                                                            "start_token": 3304,
                                                                            "end_token": 3308,
                                                                            "children": [
                                                                                {
                                                                                    "type": "pair",
                                                                                    "label": "\"createdAt\": \"desc\"",
                                                                                    "start_token": 3305,
                                                                                    "end_token": 3307,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "string",
                                                                                            "label": "\"createdAt\"",
                                                                                            "start_token": 3305,
                                                                                            "end_token": 3305,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "string_start",
                                                                                                    "label": "\"",
                                                                                                    "start_token": 3305,
                                                                                                    "end_token": 3305,
                                                                                                    "children": []
                                                                                                },
                                                                                                {
                                                                                                    "type": "string_content",
                                                                                                    "label": "createdAt",
                                                                                                    "start_token": 3305,
                                                                                                    "end_token": 3305,
                                                                                                    "children": []
                                                                                                },
                                                                                                {
                                                                                                    "type": "string_end",
                                                                                                    "label": "\"",
                                                                                                    "start_token": 3305,
                                                                                                    "end_token": 3305,
                                                                                                    "children": []
                                                                                                }
                                                                                            ]
                                                                                        },
                                                                                        {
                                                                                            "type": "string",
                                                                                            "label": "\"desc\"",
                                                                                            "start_token": 3307,
                                                                                            "end_token": 3307,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "string_start",
                                                                                                    "label": "\"",
                                                                                                    "start_token": 3307,
                                                                                                    "end_token": 3307,
                                                                                                    "children": []
                                                                                                },
                                                                                                {
                                                                                                    "type": "string_content",
                                                                                                    "label": "desc",
                                                                                                    "start_token": 3307,
                                                                                                    "end_token": 3307,
                                                                                                    "children": []
                                                                                                },
                                                                                                {
                                                                                                    "type": "string_end",
                                                                                                    "label": "\"",
                                                                                                    "start_token": 3307,
                                                                                                    "end_token": 3307,
                                                                                                    "children": []
                                                                                                }
                                                                                            ]
                                                                                        }
                                                                                    ]
                                                                                }
                                                                            ]
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                }
                                            ]
                                        }
                                    ]
                                }
                            ]
                        },
                        {
                            "type": "return_statement",
                            "label": "return [GraphExecution.from_db(execution) for execution in executions]",
                            "start_token": 3313,
                            "end_token": 3325,
                            "children": [
                                {
                                    "type": "list_comprehension",
                                    "label": "[GraphExecution.from_db(execution) for execution in executions]",
                                    "start_token": 3314,
                                    "end_token": 3325,
                                    "children": [
                                        {
                                            "type": "call",
                                            "label": "GraphExecution.from_db(execution)",
                                            "start_token": 3315,
                                            "end_token": 3320,
                                            "children": [
                                                {
                                                    "type": "attribute",
                                                    "label": "GraphExecution.from_db",
                                                    "start_token": 3315,
                                                    "end_token": 3317,
                                                    "children": [
                                                        {
                                                            "type": "identifier",
                                                            "label": "GraphExecution",
                                                            "start_token": 3315,
                                                            "end_token": 3315,
                                                            "children": []
                                                        },
                                                        {
                                                            "type": "identifier",
                                                            "label": "from_db",
                                                            "start_token": 3317,
                                                            "end_token": 3317,
                                                            "children": []
                                                        }
                                                    ]
                                                },
                                                {
                                                    "type": "argument_list",
                                                    "label": "(execution)",
                                                    "start_token": 3318,
                                                    "end_token": 3320,
                                                    "children": [
                                                        {
                                                            "type": "identifier",
                                                            "label": "execution",
                                                            "start_token": 3319,
                                                            "end_token": 3319,
                                                            "children": []
                                                        }
                                                    ]
                                                }
                                            ]
                                        },
                                        {
                                            "type": "for_in_clause",
                                            "label": "for execution in executions",
                                            "start_token": 3321,
                                            "end_token": 3324,
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "label": "execution",
                                                    "start_token": 3322,
                                                    "end_token": 3322,
                                                    "children": []
                                                },
                                                {
                                                    "type": "identifier",
                                                    "label": "executions",
                                                    "start_token": 3324,
                                                    "end_token": 3324,
                                                    "children": []
                                                }
                                            ]
                                        }
                                    ]
                                }
                            ]
                        }
                    ]
                }
            ]
        },
        {
            "type": "function_definition",
            "label": "async def get_execution(user_id: str, execution_id: str) -> GraphExecution | None:\n    execution = await AgentGraphExecution.prisma().find_first(\n        where={\"id\": execution_id, \"userId\": user_id}\n    )\n    return GraphExecution.from_db(execution) if execution else None",
            "start_token": 3329,
            "end_token": 3384,
            "children": [
                {
                    "type": "identifier",
                    "label": "get_execution",
                    "start_token": 3331,
                    "end_token": 3331,
                    "children": []
                },
                {
                    "type": "parameters",
                    "label": "(user_id: str, execution_id: str)",
                    "start_token": 3332,
                    "end_token": 3340,
                    "children": [
                        {
                            "type": "typed_parameter",
                            "label": "user_id: str",
                            "start_token": 3333,
                            "end_token": 3335,
                            "children": [
                                {
                                    "type": "identifier",
                                    "label": "user_id",
                                    "start_token": 3333,
                                    "end_token": 3333,
                                    "children": []
                                },
                                {
                                    "type": "type",
                                    "label": "str",
                                    "start_token": 3335,
                                    "end_token": 3335,
                                    "children": [
                                        {
                                            "type": "identifier",
                                            "label": "str",
                                            "start_token": 3335,
                                            "end_token": 3335,
                                            "children": []
                                        }
                                    ]
                                }
                            ]
                        },
                        {
                            "type": "typed_parameter",
                            "label": "execution_id: str",
                            "start_token": 3337,
                            "end_token": 3339,
                            "children": [
                                {
                                    "type": "identifier",
                                    "label": "execution_id",
                                    "start_token": 3337,
                                    "end_token": 3337,
                                    "children": []
                                },
                                {
                                    "type": "type",
                                    "label": "str",
                                    "start_token": 3339,
                                    "end_token": 3339,
                                    "children": [
                                        {
                                            "type": "identifier",
                                            "label": "str",
                                            "start_token": 3339,
                                            "end_token": 3339,
                                            "children": []
                                        }
                                    ]
                                }
                            ]
                        }
                    ]
                },
                {
                    "type": "type",
                    "label": "GraphExecution | None",
                    "start_token": 3343,
                    "end_token": 3345,
                    "children": [
                        {
                            "type": "binary_operator",
                            "label": "GraphExecution | None",
                            "start_token": 3343,
                            "end_token": 3345,
                            "children": [
                                {
                                    "type": "identifier",
                                    "label": "GraphExecution",
                                    "start_token": 3343,
                                    "end_token": 3343,
                                    "children": []
                                },
                                {
                                    "type": "none",
                                    "label": "None",
                                    "start_token": 3345,
                                    "end_token": 3345,
                                    "children": []
                                }
                            ]
                        }
                    ]
                },
                {
                    "type": "block",
                    "label": "execution = await AgentGraphExecution.prisma().find_first(\n        where={\"id\": execution_id, \"userId\": user_id}\n    )\n    return GraphExecution.from_db(execution) if execution else None",
                    "start_token": 3348,
                    "end_token": 3384,
                    "children": [
                        {
                            "type": "expression_statement",
                            "label": "execution = await AgentGraphExecution.prisma().find_first(\n        where={\"id\": execution_id, \"userId\": user_id}\n    )",
                            "start_token": 3348,
                            "end_token": 3372,
                            "children": [
                                {
                                    "type": "assignment",
                                    "label": "execution = await AgentGraphExecution.prisma().find_first(\n        where={\"id\": execution_id, \"userId\": user_id}\n    )",
                                    "start_token": 3348,
                                    "end_token": 3372,
                                    "children": [
                                        {
                                            "type": "identifier",
                                            "label": "execution",
                                            "start_token": 3348,
                                            "end_token": 3348,
                                            "children": []
                                        },
                                        {
                                            "type": "await",
                                            "label": "await AgentGraphExecution.prisma().find_first(\n        where={\"id\": execution_id, \"userId\": user_id}\n    )",
                                            "start_token": 3350,
                                            "end_token": 3372,
                                            "children": [
                                                {
                                                    "type": "call",
                                                    "label": "AgentGraphExecution.prisma().find_first(\n        where={\"id\": execution_id, \"userId\": user_id}\n    )",
                                                    "start_token": 3351,
                                                    "end_token": 3372,
                                                    "children": [
                                                        {
                                                            "type": "attribute",
                                                            "label": "AgentGraphExecution.prisma().find_first",
                                                            "start_token": 3351,
                                                            "end_token": 3357,
                                                            "children": [
                                                                {
                                                                    "type": "call",
                                                                    "label": "AgentGraphExecution.prisma()",
                                                                    "start_token": 3351,
                                                                    "end_token": 3355,
                                                                    "children": [
                                                                        {
                                                                            "type": "attribute",
                                                                            "label": "AgentGraphExecution.prisma",
                                                                            "start_token": 3351,
                                                                            "end_token": 3353,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "AgentGraphExecution",
                                                                                    "start_token": 3351,
                                                                                    "end_token": 3351,
                                                                                    "children": []
                                                                                },
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "prisma",
                                                                                    "start_token": 3353,
                                                                                    "end_token": 3353,
                                                                                    "children": []
                                                                                }
                                                                            ]
                                                                        },
                                                                        {
                                                                            "type": "argument_list",
                                                                            "label": "()",
                                                                            "start_token": 3354,
                                                                            "end_token": 3355,
                                                                            "children": []
                                                                        }
                                                                    ]
                                                                },
                                                                {
                                                                    "type": "identifier",
                                                                    "label": "find_first",
                                                                    "start_token": 3357,
                                                                    "end_token": 3357,
                                                                    "children": []
                                                                }
                                                            ]
                                                        },
                                                        {
                                                            "type": "argument_list",
                                                            "label": "(\n        where={\"id\": execution_id, \"userId\": user_id}\n    )",
                                                            "start_token": 3358,
                                                            "end_token": 3372,
                                                            "children": [
                                                                {
                                                                    "type": "keyword_argument",
                                                                    "label": "where={\"id\": execution_id, \"userId\": user_id}",
                                                                    "start_token": 3360,
                                                                    "end_token": 3370,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "where",
                                                                            "start_token": 3360,
                                                                            "end_token": 3360,
                                                                            "children": []
                                                                        },
                                                                        {
                                                                            "type": "dictionary",
                                                                            "label": "{\"id\": execution_id, \"userId\": user_id}",
                                                                            "start_token": 3362,
                                                                            "end_token": 3370,
                                                                            "children": [
                                                                                {
                                                                                    "type": "pair",
                                                                                    "label": "\"id\": execution_id",
                                                                                    "start_token": 3363,
                                                                                    "end_token": 3365,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "string",
                                                                                            "label": "\"id\"",
                                                                                            "start_token": 3363,
                                                                                            "end_token": 3363,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "string_start",
                                                                                                    "label": "\"",
                                                                                                    "start_token": 3363,
                                                                                                    "end_token": 3363,
                                                                                                    "children": []
                                                                                                },
                                                                                                {
                                                                                                    "type": "string_content",
                                                                                                    "label": "id",
                                                                                                    "start_token": 3363,
                                                                                                    "end_token": 3363,
                                                                                                    "children": []
                                                                                                },
                                                                                                {
                                                                                                    "type": "string_end",
                                                                                                    "label": "\"",
                                                                                                    "start_token": 3363,
                                                                                                    "end_token": 3363,
                                                                                                    "children": []
                                                                                                }
                                                                                            ]
                                                                                        },
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "label": "execution_id",
                                                                                            "start_token": 3365,
                                                                                            "end_token": 3365,
                                                                                            "children": []
                                                                                        }
                                                                                    ]
                                                                                },
                                                                                {
                                                                                    "type": "pair",
                                                                                    "label": "\"userId\": user_id",
                                                                                    "start_token": 3367,
                                                                                    "end_token": 3369,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "string",
                                                                                            "label": "\"userId\"",
                                                                                            "start_token": 3367,
                                                                                            "end_token": 3367,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "string_start",
                                                                                                    "label": "\"",
                                                                                                    "start_token": 3367,
                                                                                                    "end_token": 3367,
                                                                                                    "children": []
                                                                                                },
                                                                                                {
                                                                                                    "type": "string_content",
                                                                                                    "label": "userId",
                                                                                                    "start_token": 3367,
                                                                                                    "end_token": 3367,
                                                                                                    "children": []
                                                                                                },
                                                                                                {
                                                                                                    "type": "string_end",
                                                                                                    "label": "\"",
                                                                                                    "start_token": 3367,
                                                                                                    "end_token": 3367,
                                                                                                    "children": []
                                                                                                }
                                                                                            ]
                                                                                        },
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "label": "user_id",
                                                                                            "start_token": 3369,
                                                                                            "end_token": 3369,
                                                                                            "children": []
                                                                                        }
                                                                                    ]
                                                                                }
                                                                            ]
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                }
                                            ]
                                        }
                                    ]
                                }
                            ]
                        },
                        {
                            "type": "return_statement",
                            "label": "return GraphExecution.from_db(execution) if execution else None",
                            "start_token": 3374,
                            "end_token": 3384,
                            "children": [
                                {
                                    "type": "conditional_expression",
                                    "label": "GraphExecution.from_db(execution) if execution else None",
                                    "start_token": 3375,
                                    "end_token": 3384,
                                    "children": [
                                        {
                                            "type": "call",
                                            "label": "GraphExecution.from_db(execution)",
                                            "start_token": 3375,
                                            "end_token": 3380,
                                            "children": [
                                                {
                                                    "type": "attribute",
                                                    "label": "GraphExecution.from_db",
                                                    "start_token": 3375,
                                                    "end_token": 3377,
                                                    "children": [
                                                        {
                                                            "type": "identifier",
                                                            "label": "GraphExecution",
                                                            "start_token": 3375,
                                                            "end_token": 3375,
                                                            "children": []
                                                        },
                                                        {
                                                            "type": "identifier",
                                                            "label": "from_db",
                                                            "start_token": 3377,
                                                            "end_token": 3377,
                                                            "children": []
                                                        }
                                                    ]
                                                },
                                                {
                                                    "type": "argument_list",
                                                    "label": "(execution)",
                                                    "start_token": 3378,
                                                    "end_token": 3380,
                                                    "children": [
                                                        {
                                                            "type": "identifier",
                                                            "label": "execution",
                                                            "start_token": 3379,
                                                            "end_token": 3379,
                                                            "children": []
                                                        }
                                                    ]
                                                }
                                            ]
                                        },
                                        {
                                            "type": "identifier",
                                            "label": "execution",
                                            "start_token": 3382,
                                            "end_token": 3382,
                                            "children": []
                                        },
                                        {
                                            "type": "none",
                                            "label": "None",
                                            "start_token": 3384,
                                            "end_token": 3384,
                                            "children": []
                                        }
                                    ]
                                }
                            ]
                        }
                    ]
                }
            ]
        },
        {
            "type": "function_definition",
            "label": "async def get_graph(\n    graph_id: str,\n    version: int | None = None,\n    template: bool = False,\n    user_id: str | None = None,\n    for_export: bool = False,\n) -> GraphModel | None:\n    \"\"\"\n    Retrieves a graph from the DB.\n    Defaults to the version with `is_active` if `version` is not passed,\n    or the latest version with `is_template` if `template=True`.\n\n    Returns `None` if the record is not found.\n    \"\"\"\n    where_clause: AgentGraphWhereInput = {\n        \"id\": graph_id,\n    }\n    if version is not None:\n        where_clause[\"version\"] = version\n    elif not template:\n        where_clause[\"isActive\"] = True\n\n    # TODO: Fix hack workaround to get adding store agents to work\n    if user_id is not None and not template:\n        where_clause[\"userId\"] = user_id\n\n    graph = await AgentGraph.prisma().find_first(\n        where=where_clause,\n        include=AGENT_GRAPH_INCLUDE,\n        order={\"version\": \"desc\"},\n    )\n    return GraphModel.from_db(graph, for_export) if graph else None",
            "start_token": 3388,
            "end_token": 3559,
            "children": [
                {
                    "type": "identifier",
                    "label": "get_graph",
                    "start_token": 3390,
                    "end_token": 3390,
                    "children": []
                },
                {
                    "type": "parameters",
                    "label": "(\n    graph_id: str,\n    version: int | None = None,\n    template: bool = False,\n    user_id: str | None = None,\n    for_export: bool = False,\n)",
                    "start_token": 3391,
                    "end_token": 3430,
                    "children": [
                        {
                            "type": "typed_parameter",
                            "label": "graph_id: str",
                            "start_token": 3393,
                            "end_token": 3395,
                            "children": [
                                {
                                    "type": "identifier",
                                    "label": "graph_id",
                                    "start_token": 3393,
                                    "end_token": 3393,
                                    "children": []
                                },
                                {
                                    "type": "type",
                                    "label": "str",
                                    "start_token": 3395,
                                    "end_token": 3395,
                                    "children": [
                                        {
                                            "type": "identifier",
                                            "label": "str",
                                            "start_token": 3395,
                                            "end_token": 3395,
                                            "children": []
                                        }
                                    ]
                                }
                            ]
                        },
                        {
                            "type": "typed_default_parameter",
                            "label": "version: int | None = None",
                            "start_token": 3398,
                            "end_token": 3404,
                            "children": [
                                {
                                    "type": "identifier",
                                    "label": "version",
                                    "start_token": 3398,
                                    "end_token": 3398,
                                    "children": []
                                },
                                {
                                    "type": "type",
                                    "label": "int | None",
                                    "start_token": 3400,
                                    "end_token": 3402,
                                    "children": [
                                        {
                                            "type": "binary_operator",
                                            "label": "int | None",
                                            "start_token": 3400,
                                            "end_token": 3402,
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "label": "int",
                                                    "start_token": 3400,
                                                    "end_token": 3400,
                                                    "children": []
                                                },
                                                {
                                                    "type": "none",
                                                    "label": "None",
                                                    "start_token": 3402,
                                                    "end_token": 3402,
                                                    "children": []
                                                }
                                            ]
                                        }
                                    ]
                                },
                                {
                                    "type": "none",
                                    "label": "None",
                                    "start_token": 3404,
                                    "end_token": 3404,
                                    "children": []
                                }
                            ]
                        },
                        {
                            "type": "typed_default_parameter",
                            "label": "template: bool = False",
                            "start_token": 3407,
                            "end_token": 3411,
                            "children": [
                                {
                                    "type": "identifier",
                                    "label": "template",
                                    "start_token": 3407,
                                    "end_token": 3407,
                                    "children": []
                                },
                                {
                                    "type": "type",
                                    "label": "bool",
                                    "start_token": 3409,
                                    "end_token": 3409,
                                    "children": [
                                        {
                                            "type": "identifier",
                                            "label": "bool",
                                            "start_token": 3409,
                                            "end_token": 3409,
                                            "children": []
                                        }
                                    ]
                                },
                                {
                                    "type": "false",
                                    "label": "False",
                                    "start_token": 3411,
                                    "end_token": 3411,
                                    "children": []
                                }
                            ]
                        },
                        {
                            "type": "typed_default_parameter",
                            "label": "user_id: str | None = None",
                            "start_token": 3414,
                            "end_token": 3420,
                            "children": [
                                {
                                    "type": "identifier",
                                    "label": "user_id",
                                    "start_token": 3414,
                                    "end_token": 3414,
                                    "children": []
                                },
                                {
                                    "type": "type",
                                    "label": "str | None",
                                    "start_token": 3416,
                                    "end_token": 3418,
                                    "children": [
                                        {
                                            "type": "binary_operator",
                                            "label": "str | None",
                                            "start_token": 3416,
                                            "end_token": 3418,
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "label": "str",
                                                    "start_token": 3416,
                                                    "end_token": 3416,
                                                    "children": []
                                                },
                                                {
                                                    "type": "none",
                                                    "label": "None",
                                                    "start_token": 3418,
                                                    "end_token": 3418,
                                                    "children": []
                                                }
                                            ]
                                        }
                                    ]
                                },
                                {
                                    "type": "none",
                                    "label": "None",
                                    "start_token": 3420,
                                    "end_token": 3420,
                                    "children": []
                                }
                            ]
                        },
                        {
                            "type": "typed_default_parameter",
                            "label": "for_export: bool = False",
                            "start_token": 3423,
                            "end_token": 3427,
                            "children": [
                                {
                                    "type": "identifier",
                                    "label": "for_export",
                                    "start_token": 3423,
                                    "end_token": 3423,
                                    "children": []
                                },
                                {
                                    "type": "type",
                                    "label": "bool",
                                    "start_token": 3425,
                                    "end_token": 3425,
                                    "children": [
                                        {
                                            "type": "identifier",
                                            "label": "bool",
                                            "start_token": 3425,
                                            "end_token": 3425,
                                            "children": []
                                        }
                                    ]
                                },
                                {
                                    "type": "false",
                                    "label": "False",
                                    "start_token": 3427,
                                    "end_token": 3427,
                                    "children": []
                                }
                            ]
                        }
                    ]
                },
                {
                    "type": "type",
                    "label": "GraphModel | None",
                    "start_token": 3433,
                    "end_token": 3435,
                    "children": [
                        {
                            "type": "binary_operator",
                            "label": "GraphModel | None",
                            "start_token": 3433,
                            "end_token": 3435,
                            "children": [
                                {
                                    "type": "identifier",
                                    "label": "GraphModel",
                                    "start_token": 3433,
                                    "end_token": 3433,
                                    "children": []
                                },
                                {
                                    "type": "none",
                                    "label": "None",
                                    "start_token": 3435,
                                    "end_token": 3435,
                                    "children": []
                                }
                            ]
                        }
                    ]
                },
                {
                    "type": "block",
                    "label": "\"\"\"\n    Retrieves a graph from the DB.\n    Defaults to the version with `is_active` if `version` is not passed,\n    or the latest version with `is_template` if `template=True`.\n\n    Returns `None` if the record is not found.\n    \"\"\"\n    where_clause: AgentGraphWhereInput = {\n        \"id\": graph_id,\n    }\n    if version is not None:\n        where_clause[\"version\"] = version\n    elif not template:\n        where_clause[\"isActive\"] = True\n\n    # TODO: Fix hack workaround to get adding store agents to work\n    if user_id is not None and not template:\n        where_clause[\"userId\"] = user_id\n\n    graph = await AgentGraph.prisma().find_first(\n        where=where_clause,\n        include=AGENT_GRAPH_INCLUDE,\n        order={\"version\": \"desc\"},\n    )\n    return GraphModel.from_db(graph, for_export) if graph else None",
                    "start_token": 3438,
                    "end_token": 3559,
                    "children": [
                        {
                            "type": "expression_statement",
                            "label": "\"\"\"\n    Retrieves a graph from the DB.\n    Defaults to the version with `is_active` if `version` is not passed,\n    or the latest version with `is_template` if `template=True`.\n\n    Returns `None` if the record is not found.\n    \"\"\"",
                            "start_token": 3438,
                            "end_token": 3440,
                            "children": [
                                {
                                    "type": "string",
                                    "label": "\"\"\"\n    Retrieves a graph from the DB.\n    Defaults to the version with `is_active` if `version` is not passed,\n    or the latest version with `is_template` if `template=True`.\n\n    Returns `None` if the record is not found.\n    \"\"\"",
                                    "start_token": 3438,
                                    "end_token": 3440,
                                    "children": [
                                        {
                                            "type": "string_start",
                                            "label": "\"\"\"",
                                            "start_token": 3438,
                                            "end_token": 3439,
                                            "children": []
                                        },
                                        {
                                            "type": "string_content",
                                            "label": "\n    Retrieves a graph from the DB.\n    Defaults to the version with `is_active` if `version` is not passed,\n    or the latest version with `is_template` if `template=True`.\n\n    Returns `None` if the record is not found.\n    ",
                                            "start_token": 3439,
                                            "end_token": 3439,
                                            "children": []
                                        },
                                        {
                                            "type": "string_end",
                                            "label": "\"\"\"",
                                            "start_token": 3439,
                                            "end_token": 3440,
                                            "children": []
                                        }
                                    ]
                                }
                            ]
                        },
                        {
                            "type": "expression_statement",
                            "label": "where_clause: AgentGraphWhereInput = {\n        \"id\": graph_id,\n    }",
                            "start_token": 3442,
                            "end_token": 3453,
                            "children": [
                                {
                                    "type": "assignment",
                                    "label": "where_clause: AgentGraphWhereInput = {\n        \"id\": graph_id,\n    }",
                                    "start_token": 3442,
                                    "end_token": 3453,
                                    "children": [
                                        {
                                            "type": "identifier",
                                            "label": "where_clause",
                                            "start_token": 3442,
                                            "end_token": 3442,
                                            "children": []
                                        },
                                        {
                                            "type": "type",
                                            "label": "AgentGraphWhereInput",
                                            "start_token": 3444,
                                            "end_token": 3444,
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "label": "AgentGraphWhereInput",
                                                    "start_token": 3444,
                                                    "end_token": 3444,
                                                    "children": []
                                                }
                                            ]
                                        },
                                        {
                                            "type": "dictionary",
                                            "label": "{\n        \"id\": graph_id,\n    }",
                                            "start_token": 3446,
                                            "end_token": 3453,
                                            "children": [
                                                {
                                                    "type": "pair",
                                                    "label": "\"id\": graph_id",
                                                    "start_token": 3448,
                                                    "end_token": 3450,
                                                    "children": [
                                                        {
                                                            "type": "string",
                                                            "label": "\"id\"",
                                                            "start_token": 3448,
                                                            "end_token": 3448,
                                                            "children": [
                                                                {
                                                                    "type": "string_start",
                                                                    "label": "\"",
                                                                    "start_token": 3448,
                                                                    "end_token": 3448,
                                                                    "children": []
                                                                },
                                                                {
                                                                    "type": "string_content",
                                                                    "label": "id",
                                                                    "start_token": 3448,
                                                                    "end_token": 3448,
                                                                    "children": []
                                                                },
                                                                {
                                                                    "type": "string_end",
                                                                    "label": "\"",
                                                                    "start_token": 3448,
                                                                    "end_token": 3448,
                                                                    "children": []
                                                                }
                                                            ]
                                                        },
                                                        {
                                                            "type": "identifier",
                                                            "label": "graph_id",
                                                            "start_token": 3450,
                                                            "end_token": 3450,
                                                            "children": []
                                                        }
                                                    ]
                                                }
                                            ]
                                        }
                                    ]
                                }
                            ]
                        },
                        {
                            "type": "if_statement",
                            "label": "if version is not None:\n        where_clause[\"version\"] = version\n    elif not template:\n        where_clause[\"isActive\"] = True",
                            "start_token": 3455,
                            "end_token": 3479,
                            "children": [
                                {
                                    "type": "comparison_operator",
                                    "label": "version is not None",
                                    "start_token": 3456,
                                    "end_token": 3459,
                                    "children": [
                                        {
                                            "type": "identifier",
                                            "label": "version",
                                            "start_token": 3456,
                                            "end_token": 3456,
                                            "children": []
                                        },
                                        {
                                            "type": "none",
                                            "label": "None",
                                            "start_token": 3459,
                                            "end_token": 3459,
                                            "children": []
                                        }
                                    ]
                                },
                                {
                                    "type": "block",
                                    "label": "where_clause[\"version\"] = version",
                                    "start_token": 3462,
                                    "end_token": 3467,
                                    "children": [
                                        {
                                            "type": "expression_statement",
                                            "label": "where_clause[\"version\"] = version",
                                            "start_token": 3462,
                                            "end_token": 3467,
                                            "children": [
                                                {
                                                    "type": "assignment",
                                                    "label": "where_clause[\"version\"] = version",
                                                    "start_token": 3462,
                                                    "end_token": 3467,
                                                    "children": [
                                                        {
                                                            "type": "subscript",
                                                            "label": "where_clause[\"version\"]",
                                                            "start_token": 3462,
                                                            "end_token": 3465,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "label": "where_clause",
                                                                    "start_token": 3462,
                                                                    "end_token": 3462,
                                                                    "children": []
                                                                },
                                                                {
                                                                    "type": "string",
                                                                    "label": "\"version\"",
                                                                    "start_token": 3464,
                                                                    "end_token": 3464,
                                                                    "children": [
                                                                        {
                                                                            "type": "string_start",
                                                                            "label": "\"",
                                                                            "start_token": 3464,
                                                                            "end_token": 3464,
                                                                            "children": []
                                                                        },
                                                                        {
                                                                            "type": "string_content",
                                                                            "label": "version",
                                                                            "start_token": 3464,
                                                                            "end_token": 3464,
                                                                            "children": []
                                                                        },
                                                                        {
                                                                            "type": "string_end",
                                                                            "label": "\"",
                                                                            "start_token": 3464,
                                                                            "end_token": 3464,
                                                                            "children": []
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        },
                                                        {
                                                            "type": "identifier",
                                                            "label": "version",
                                                            "start_token": 3467,
                                                            "end_token": 3467,
                                                            "children": []
                                                        }
                                                    ]
                                                }
                                            ]
                                        }
                                    ]
                                },
                                {
                                    "type": "elif_clause",
                                    "label": "elif not template:\n        where_clause[\"isActive\"] = True",
                                    "start_token": 3469,
                                    "end_token": 3479,
                                    "children": [
                                        {
                                            "type": "not_operator",
                                            "label": "not template",
                                            "start_token": 3470,
                                            "end_token": 3471,
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "label": "template",
                                                    "start_token": 3471,
                                                    "end_token": 3471,
                                                    "children": []
                                                }
                                            ]
                                        },
                                        {
                                            "type": "block",
                                            "label": "where_clause[\"isActive\"] = True",
                                            "start_token": 3474,
                                            "end_token": 3479,
                                            "children": [
                                                {
                                                    "type": "expression_statement",
                                                    "label": "where_clause[\"isActive\"] = True",
                                                    "start_token": 3474,
                                                    "end_token": 3479,
                                                    "children": [
                                                        {
                                                            "type": "assignment",
                                                            "label": "where_clause[\"isActive\"] = True",
                                                            "start_token": 3474,
                                                            "end_token": 3479,
                                                            "children": [
                                                                {
                                                                    "type": "subscript",
                                                                    "label": "where_clause[\"isActive\"]",
                                                                    "start_token": 3474,
                                                                    "end_token": 3477,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "where_clause",
                                                                            "start_token": 3474,
                                                                            "end_token": 3474,
                                                                            "children": []
                                                                        },
                                                                        {
                                                                            "type": "string",
                                                                            "label": "\"isActive\"",
                                                                            "start_token": 3476,
                                                                            "end_token": 3476,
                                                                            "children": [
                                                                                {
                                                                                    "type": "string_start",
                                                                                    "label": "\"",
                                                                                    "start_token": 3476,
                                                                                    "end_token": 3476,
                                                                                    "children": []
                                                                                },
                                                                                {
                                                                                    "type": "string_content",
                                                                                    "label": "isActive",
                                                                                    "start_token": 3476,
                                                                                    "end_token": 3476,
                                                                                    "children": []
                                                                                },
                                                                                {
                                                                                    "type": "string_end",
                                                                                    "label": "\"",
                                                                                    "start_token": 3476,
                                                                                    "end_token": 3476,
                                                                                    "children": []
                                                                                }
                                                                            ]
                                                                        }
                                                                    ]
                                                                },
                                                                {
                                                                    "type": "true",
                                                                    "label": "True",
                                                                    "start_token": 3479,
                                                                    "end_token": 3479,
                                                                    "children": []
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                }
                                            ]
                                        }
                                    ]
                                }
                            ]
                        },
                        {
                            "type": "comment",
                            "label": "# TODO: Fix hack workaround to get adding store agents to work",
                            "start_token": 3482,
                            "end_token": 3494,
                            "children": []
                        },
                        {
                            "type": "if_statement",
                            "label": "if user_id is not None and not template:\n        where_clause[\"userId\"] = user_id",
                            "start_token": 3496,
                            "end_token": 3511,
                            "children": [
                                {
                                    "type": "boolean_operator",
                                    "label": "user_id is not None and not template",
                                    "start_token": 3497,
                                    "end_token": 3503,
                                    "children": [
                                        {
                                            "type": "comparison_operator",
                                            "label": "user_id is not None",
                                            "start_token": 3497,
                                            "end_token": 3500,
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "label": "user_id",
                                                    "start_token": 3497,
                                                    "end_token": 3497,
                                                    "children": []
                                                },
                                                {
                                                    "type": "none",
                                                    "label": "None",
                                                    "start_token": 3500,
                                                    "end_token": 3500,
                                                    "children": []
                                                }
                                            ]
                                        },
                                        {
                                            "type": "not_operator",
                                            "label": "not template",
                                            "start_token": 3502,
                                            "end_token": 3503,
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "label": "template",
                                                    "start_token": 3503,
                                                    "end_token": 3503,
                                                    "children": []
                                                }
                                            ]
                                        }
                                    ]
                                },
                                {
                                    "type": "block",
                                    "label": "where_clause[\"userId\"] = user_id",
                                    "start_token": 3506,
                                    "end_token": 3511,
                                    "children": [
                                        {
                                            "type": "expression_statement",
                                            "label": "where_clause[\"userId\"] = user_id",
                                            "start_token": 3506,
                                            "end_token": 3511,
                                            "children": [
                                                {
                                                    "type": "assignment",
                                                    "label": "where_clause[\"userId\"] = user_id",
                                                    "start_token": 3506,
                                                    "end_token": 3511,
                                                    "children": [
                                                        {
                                                            "type": "subscript",
                                                            "label": "where_clause[\"userId\"]",
                                                            "start_token": 3506,
                                                            "end_token": 3509,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "label": "where_clause",
                                                                    "start_token": 3506,
                                                                    "end_token": 3506,
                                                                    "children": []
                                                                },
                                                                {
                                                                    "type": "string",
                                                                    "label": "\"userId\"",
                                                                    "start_token": 3508,
                                                                    "end_token": 3508,
                                                                    "children": [
                                                                        {
                                                                            "type": "string_start",
                                                                            "label": "\"",
                                                                            "start_token": 3508,
                                                                            "end_token": 3508,
                                                                            "children": []
                                                                        },
                                                                        {
                                                                            "type": "string_content",
                                                                            "label": "userId",
                                                                            "start_token": 3508,
                                                                            "end_token": 3508,
                                                                            "children": []
                                                                        },
                                                                        {
                                                                            "type": "string_end",
                                                                            "label": "\"",
                                                                            "start_token": 3508,
                                                                            "end_token": 3508,
                                                                            "children": []
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        },
                                                        {
                                                            "type": "identifier",
                                                            "label": "user_id",
                                                            "start_token": 3511,
                                                            "end_token": 3511,
                                                            "children": []
                                                        }
                                                    ]
                                                }
                                            ]
                                        }
                                    ]
                                }
                            ]
                        },
                        {
                            "type": "expression_statement",
                            "label": "graph = await AgentGraph.prisma().find_first(\n        where=where_clause,\n        include=AGENT_GRAPH_INCLUDE,\n        order={\"version\": \"desc\"},\n    )",
                            "start_token": 3514,
                            "end_token": 3545,
                            "children": [
                                {
                                    "type": "assignment",
                                    "label": "graph = await AgentGraph.prisma().find_first(\n        where=where_clause,\n        include=AGENT_GRAPH_INCLUDE,\n        order={\"version\": \"desc\"},\n    )",
                                    "start_token": 3514,
                                    "end_token": 3545,
                                    "children": [
                                        {
                                            "type": "identifier",
                                            "label": "graph",
                                            "start_token": 3514,
                                            "end_token": 3514,
                                            "children": []
                                        },
                                        {
                                            "type": "await",
                                            "label": "await AgentGraph.prisma().find_first(\n        where=where_clause,\n        include=AGENT_GRAPH_INCLUDE,\n        order={\"version\": \"desc\"},\n    )",
                                            "start_token": 3516,
                                            "end_token": 3545,
                                            "children": [
                                                {
                                                    "type": "call",
                                                    "label": "AgentGraph.prisma().find_first(\n        where=where_clause,\n        include=AGENT_GRAPH_INCLUDE,\n        order={\"version\": \"desc\"},\n    )",
                                                    "start_token": 3517,
                                                    "end_token": 3545,
                                                    "children": [
                                                        {
                                                            "type": "attribute",
                                                            "label": "AgentGraph.prisma().find_first",
                                                            "start_token": 3517,
                                                            "end_token": 3523,
                                                            "children": [
                                                                {
                                                                    "type": "call",
                                                                    "label": "AgentGraph.prisma()",
                                                                    "start_token": 3517,
                                                                    "end_token": 3521,
                                                                    "children": [
                                                                        {
                                                                            "type": "attribute",
                                                                            "label": "AgentGraph.prisma",
                                                                            "start_token": 3517,
                                                                            "end_token": 3519,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "AgentGraph",
                                                                                    "start_token": 3517,
                                                                                    "end_token": 3517,
                                                                                    "children": []
                                                                                },
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "prisma",
                                                                                    "start_token": 3519,
                                                                                    "end_token": 3519,
                                                                                    "children": []
                                                                                }
                                                                            ]
                                                                        },
                                                                        {
                                                                            "type": "argument_list",
                                                                            "label": "()",
                                                                            "start_token": 3520,
                                                                            "end_token": 3521,
                                                                            "children": []
                                                                        }
                                                                    ]
                                                                },
                                                                {
                                                                    "type": "identifier",
                                                                    "label": "find_first",
                                                                    "start_token": 3523,
                                                                    "end_token": 3523,
                                                                    "children": []
                                                                }
                                                            ]
                                                        },
                                                        {
                                                            "type": "argument_list",
                                                            "label": "(\n        where=where_clause,\n        include=AGENT_GRAPH_INCLUDE,\n        order={\"version\": \"desc\"},\n    )",
                                                            "start_token": 3524,
                                                            "end_token": 3545,
                                                            "children": [
                                                                {
                                                                    "type": "keyword_argument",
                                                                    "label": "where=where_clause",
                                                                    "start_token": 3526,
                                                                    "end_token": 3528,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "where",
                                                                            "start_token": 3526,
                                                                            "end_token": 3526,
                                                                            "children": []
                                                                        },
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "where_clause",
                                                                            "start_token": 3528,
                                                                            "end_token": 3528,
                                                                            "children": []
                                                                        }
                                                                    ]
                                                                },
                                                                {
                                                                    "type": "keyword_argument",
                                                                    "label": "include=AGENT_GRAPH_INCLUDE",
                                                                    "start_token": 3531,
                                                                    "end_token": 3533,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "include",
                                                                            "start_token": 3531,
                                                                            "end_token": 3531,
                                                                            "children": []
                                                                        },
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "AGENT_GRAPH_INCLUDE",
                                                                            "start_token": 3533,
                                                                            "end_token": 3533,
                                                                            "children": []
                                                                        }
                                                                    ]
                                                                },
                                                                {
                                                                    "type": "keyword_argument",
                                                                    "label": "order={\"version\": \"desc\"}",
                                                                    "start_token": 3536,
                                                                    "end_token": 3542,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "order",
                                                                            "start_token": 3536,
                                                                            "end_token": 3536,
                                                                            "children": []
                                                                        },
                                                                        {
                                                                            "type": "dictionary",
                                                                            "label": "{\"version\": \"desc\"}",
                                                                            "start_token": 3538,
                                                                            "end_token": 3542,
                                                                            "children": [
                                                                                {
                                                                                    "type": "pair",
                                                                                    "label": "\"version\": \"desc\"",
                                                                                    "start_token": 3539,
                                                                                    "end_token": 3541,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "string",
                                                                                            "label": "\"version\"",
                                                                                            "start_token": 3539,
                                                                                            "end_token": 3539,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "string_start",
                                                                                                    "label": "\"",
                                                                                                    "start_token": 3539,
                                                                                                    "end_token": 3539,
                                                                                                    "children": []
                                                                                                },
                                                                                                {
                                                                                                    "type": "string_content",
                                                                                                    "label": "version",
                                                                                                    "start_token": 3539,
                                                                                                    "end_token": 3539,
                                                                                                    "children": []
                                                                                                },
                                                                                                {
                                                                                                    "type": "string_end",
                                                                                                    "label": "\"",
                                                                                                    "start_token": 3539,
                                                                                                    "end_token": 3539,
                                                                                                    "children": []
                                                                                                }
                                                                                            ]
                                                                                        },
                                                                                        {
                                                                                            "type": "string",
                                                                                            "label": "\"desc\"",
                                                                                            "start_token": 3541,
                                                                                            "end_token": 3541,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "string_start",
                                                                                                    "label": "\"",
                                                                                                    "start_token": 3541,
                                                                                                    "end_token": 3541,
                                                                                                    "children": []
                                                                                                },
                                                                                                {
                                                                                                    "type": "string_content",
                                                                                                    "label": "desc",
                                                                                                    "start_token": 3541,
                                                                                                    "end_token": 3541,
                                                                                                    "children": []
                                                                                                },
                                                                                                {
                                                                                                    "type": "string_end",
                                                                                                    "label": "\"",
                                                                                                    "start_token": 3541,
                                                                                                    "end_token": 3541,
                                                                                                    "children": []
                                                                                                }
                                                                                            ]
                                                                                        }
                                                                                    ]
                                                                                }
                                                                            ]
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                }
                                            ]
                                        }
                                    ]
                                }
                            ]
                        },
                        {
                            "type": "return_statement",
                            "label": "return GraphModel.from_db(graph, for_export) if graph else None",
                            "start_token": 3547,
                            "end_token": 3559,
                            "children": [
                                {
                                    "type": "conditional_expression",
                                    "label": "GraphModel.from_db(graph, for_export) if graph else None",
                                    "start_token": 3548,
                                    "end_token": 3559,
                                    "children": [
                                        {
                                            "type": "call",
                                            "label": "GraphModel.from_db(graph, for_export)",
                                            "start_token": 3548,
                                            "end_token": 3555,
                                            "children": [
                                                {
                                                    "type": "attribute",
                                                    "label": "GraphModel.from_db",
                                                    "start_token": 3548,
                                                    "end_token": 3550,
                                                    "children": [
                                                        {
                                                            "type": "identifier",
                                                            "label": "GraphModel",
                                                            "start_token": 3548,
                                                            "end_token": 3548,
                                                            "children": []
                                                        },
                                                        {
                                                            "type": "identifier",
                                                            "label": "from_db",
                                                            "start_token": 3550,
                                                            "end_token": 3550,
                                                            "children": []
                                                        }
                                                    ]
                                                },
                                                {
                                                    "type": "argument_list",
                                                    "label": "(graph, for_export)",
                                                    "start_token": 3551,
                                                    "end_token": 3555,
                                                    "children": [
                                                        {
                                                            "type": "identifier",
                                                            "label": "graph",
                                                            "start_token": 3552,
                                                            "end_token": 3552,
                                                            "children": []
                                                        },
                                                        {
                                                            "type": "identifier",
                                                            "label": "for_export",
                                                            "start_token": 3554,
                                                            "end_token": 3554,
                                                            "children": []
                                                        }
                                                    ]
                                                }
                                            ]
                                        },
                                        {
                                            "type": "identifier",
                                            "label": "graph",
                                            "start_token": 3557,
                                            "end_token": 3557,
                                            "children": []
                                        },
                                        {
                                            "type": "none",
                                            "label": "None",
                                            "start_token": 3559,
                                            "end_token": 3559,
                                            "children": []
                                        }
                                    ]
                                }
                            ]
                        }
                    ]
                }
            ]
        },
        {
            "type": "function_definition",
            "label": "async def set_graph_active_version(graph_id: str, version: int, user_id: str) -> None:\n    # Activate the requested version if it exists and is owned by the user.\n    updated_count = await AgentGraph.prisma().update_many(\n        data={\"isActive\": True},\n        where={\n            \"id\": graph_id,\n            \"version\": version,\n            \"userId\": user_id,\n        },\n    )\n    if updated_count == 0:\n        raise Exception(f\"Graph #{graph_id} v{version} not found or not owned by user\")\n\n    # Deactivate all other versions.\n    await AgentGraph.prisma().update_many(\n        data={\"isActive\": False},\n        where={\n            \"id\": graph_id,\n            \"version\": {\"not\": version},\n            \"userId\": user_id,\n            \"isActive\": True,\n        },\n    )",
            "start_token": 3563,
            "end_token": 3717,
            "children": [
                {
                    "type": "identifier",
                    "label": "set_graph_active_version",
                    "start_token": 3565,
                    "end_token": 3565,
                    "children": []
                },
                {
                    "type": "parameters",
                    "label": "(graph_id: str, version: int, user_id: str)",
                    "start_token": 3566,
                    "end_token": 3578,
                    "children": [
                        {
                            "type": "typed_parameter",
                            "label": "graph_id: str",
                            "start_token": 3567,
                            "end_token": 3569,
                            "children": [
                                {
                                    "type": "identifier",
                                    "label": "graph_id",
                                    "start_token": 3567,
                                    "end_token": 3567,
                                    "children": []
                                },
                                {
                                    "type": "type",
                                    "label": "str",
                                    "start_token": 3569,
                                    "end_token": 3569,
                                    "children": [
                                        {
                                            "type": "identifier",
                                            "label": "str",
                                            "start_token": 3569,
                                            "end_token": 3569,
                                            "children": []
                                        }
                                    ]
                                }
                            ]
                        },
                        {
                            "type": "typed_parameter",
                            "label": "version: int",
                            "start_token": 3571,
                            "end_token": 3573,
                            "children": [
                                {
                                    "type": "identifier",
                                    "label": "version",
                                    "start_token": 3571,
                                    "end_token": 3571,
                                    "children": []
                                },
                                {
                                    "type": "type",
                                    "label": "int",
                                    "start_token": 3573,
                                    "end_token": 3573,
                                    "children": [
                                        {
                                            "type": "identifier",
                                            "label": "int",
                                            "start_token": 3573,
                                            "end_token": 3573,
                                            "children": []
                                        }
                                    ]
                                }
                            ]
                        },
                        {
                            "type": "typed_parameter",
                            "label": "user_id: str",
                            "start_token": 3575,
                            "end_token": 3577,
                            "children": [
                                {
                                    "type": "identifier",
                                    "label": "user_id",
                                    "start_token": 3575,
                                    "end_token": 3575,
                                    "children": []
                                },
                                {
                                    "type": "type",
                                    "label": "str",
                                    "start_token": 3577,
                                    "end_token": 3577,
                                    "children": [
                                        {
                                            "type": "identifier",
                                            "label": "str",
                                            "start_token": 3577,
                                            "end_token": 3577,
                                            "children": []
                                        }
                                    ]
                                }
                            ]
                        }
                    ]
                },
                {
                    "type": "type",
                    "label": "None",
                    "start_token": 3581,
                    "end_token": 3581,
                    "children": [
                        {
                            "type": "none",
                            "label": "None",
                            "start_token": 3581,
                            "end_token": 3581,
                            "children": []
                        }
                    ]
                },
                {
                    "type": "comment",
                    "label": "# Activate the requested version if it exists and is owned by the user.",
                    "start_token": 3584,
                    "end_token": 3598,
                    "children": []
                },
                {
                    "type": "block",
                    "label": "updated_count = await AgentGraph.prisma().update_many(\n        data={\"isActive\": True},\n        where={\n            \"id\": graph_id,\n            \"version\": version,\n            \"userId\": user_id,\n        },\n    )\n    if updated_count == 0:\n        raise Exception(f\"Graph #{graph_id} v{version} not found or not owned by user\")\n\n    # Deactivate all other versions.\n    await AgentGraph.prisma().update_many(\n        data={\"isActive\": False},\n        where={\n            \"id\": graph_id,\n            \"version\": {\"not\": version},\n            \"userId\": user_id,\n            \"isActive\": True,\n        },\n    )",
                    "start_token": 3600,
                    "end_token": 3717,
                    "children": [
                        {
                            "type": "expression_statement",
                            "label": "updated_count = await AgentGraph.prisma().update_many(\n        data={\"isActive\": True},\n        where={\n            \"id\": graph_id,\n            \"version\": version,\n            \"userId\": user_id,\n        },\n    )",
                            "start_token": 3600,
                            "end_token": 3643,
                            "children": [
                                {
                                    "type": "assignment",
                                    "label": "updated_count = await AgentGraph.prisma().update_many(\n        data={\"isActive\": True},\n        where={\n            \"id\": graph_id,\n            \"version\": version,\n            \"userId\": user_id,\n        },\n    )",
                                    "start_token": 3600,
                                    "end_token": 3643,
                                    "children": [
                                        {
                                            "type": "identifier",
                                            "label": "updated_count",
                                            "start_token": 3600,
                                            "end_token": 3600,
                                            "children": []
                                        },
                                        {
                                            "type": "await",
                                            "label": "await AgentGraph.prisma().update_many(\n        data={\"isActive\": True},\n        where={\n            \"id\": graph_id,\n            \"version\": version,\n            \"userId\": user_id,\n        },\n    )",
                                            "start_token": 3602,
                                            "end_token": 3643,
                                            "children": [
                                                {
                                                    "type": "call",
                                                    "label": "AgentGraph.prisma().update_many(\n        data={\"isActive\": True},\n        where={\n            \"id\": graph_id,\n            \"version\": version,\n            \"userId\": user_id,\n        },\n    )",
                                                    "start_token": 3603,
                                                    "end_token": 3643,
                                                    "children": [
                                                        {
                                                            "type": "attribute",
                                                            "label": "AgentGraph.prisma().update_many",
                                                            "start_token": 3603,
                                                            "end_token": 3609,
                                                            "children": [
                                                                {
                                                                    "type": "call",
                                                                    "label": "AgentGraph.prisma()",
                                                                    "start_token": 3603,
                                                                    "end_token": 3607,
                                                                    "children": [
                                                                        {
                                                                            "type": "attribute",
                                                                            "label": "AgentGraph.prisma",
                                                                            "start_token": 3603,
                                                                            "end_token": 3605,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "AgentGraph",
                                                                                    "start_token": 3603,
                                                                                    "end_token": 3603,
                                                                                    "children": []
                                                                                },
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "prisma",
                                                                                    "start_token": 3605,
                                                                                    "end_token": 3605,
                                                                                    "children": []
                                                                                }
                                                                            ]
                                                                        },
                                                                        {
                                                                            "type": "argument_list",
                                                                            "label": "()",
                                                                            "start_token": 3606,
                                                                            "end_token": 3607,
                                                                            "children": []
                                                                        }
                                                                    ]
                                                                },
                                                                {
                                                                    "type": "identifier",
                                                                    "label": "update_many",
                                                                    "start_token": 3609,
                                                                    "end_token": 3609,
                                                                    "children": []
                                                                }
                                                            ]
                                                        },
                                                        {
                                                            "type": "argument_list",
                                                            "label": "(\n        data={\"isActive\": True},\n        where={\n            \"id\": graph_id,\n            \"version\": version,\n            \"userId\": user_id,\n        },\n    )",
                                                            "start_token": 3610,
                                                            "end_token": 3643,
                                                            "children": [
                                                                {
                                                                    "type": "keyword_argument",
                                                                    "label": "data={\"isActive\": True}",
                                                                    "start_token": 3612,
                                                                    "end_token": 3618,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "data",
                                                                            "start_token": 3612,
                                                                            "end_token": 3612,
                                                                            "children": []
                                                                        },
                                                                        {
                                                                            "type": "dictionary",
                                                                            "label": "{\"isActive\": True}",
                                                                            "start_token": 3614,
                                                                            "end_token": 3618,
                                                                            "children": [
                                                                                {
                                                                                    "type": "pair",
                                                                                    "label": "\"isActive\": True",
                                                                                    "start_token": 3615,
                                                                                    "end_token": 3617,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "string",
                                                                                            "label": "\"isActive\"",
                                                                                            "start_token": 3615,
                                                                                            "end_token": 3615,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "string_start",
                                                                                                    "label": "\"",
                                                                                                    "start_token": 3615,
                                                                                                    "end_token": 3615,
                                                                                                    "children": []
                                                                                                },
                                                                                                {
                                                                                                    "type": "string_content",
                                                                                                    "label": "isActive",
                                                                                                    "start_token": 3615,
                                                                                                    "end_token": 3615,
                                                                                                    "children": []
                                                                                                },
                                                                                                {
                                                                                                    "type": "string_end",
                                                                                                    "label": "\"",
                                                                                                    "start_token": 3615,
                                                                                                    "end_token": 3615,
                                                                                                    "children": []
                                                                                                }
                                                                                            ]
                                                                                        },
                                                                                        {
                                                                                            "type": "true",
                                                                                            "label": "True",
                                                                                            "start_token": 3617,
                                                                                            "end_token": 3617,
                                                                                            "children": []
                                                                                        }
                                                                                    ]
                                                                                }
                                                                            ]
                                                                        }
                                                                    ]
                                                                },
                                                                {
                                                                    "type": "keyword_argument",
                                                                    "label": "where={\n            \"id\": graph_id,\n            \"version\": version,\n            \"userId\": user_id,\n        }",
                                                                    "start_token": 3621,
                                                                    "end_token": 3640,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "where",
                                                                            "start_token": 3621,
                                                                            "end_token": 3621,
                                                                            "children": []
                                                                        },
                                                                        {
                                                                            "type": "dictionary",
                                                                            "label": "{\n            \"id\": graph_id,\n            \"version\": version,\n            \"userId\": user_id,\n        }",
                                                                            "start_token": 3623,
                                                                            "end_token": 3640,
                                                                            "children": [
                                                                                {
                                                                                    "type": "pair",
                                                                                    "label": "\"id\": graph_id",
                                                                                    "start_token": 3625,
                                                                                    "end_token": 3627,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "string",
                                                                                            "label": "\"id\"",
                                                                                            "start_token": 3625,
                                                                                            "end_token": 3625,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "string_start",
                                                                                                    "label": "\"",
                                                                                                    "start_token": 3625,
                                                                                                    "end_token": 3625,
                                                                                                    "children": []
                                                                                                },
                                                                                                {
                                                                                                    "type": "string_content",
                                                                                                    "label": "id",
                                                                                                    "start_token": 3625,
                                                                                                    "end_token": 3625,
                                                                                                    "children": []
                                                                                                },
                                                                                                {
                                                                                                    "type": "string_end",
                                                                                                    "label": "\"",
                                                                                                    "start_token": 3625,
                                                                                                    "end_token": 3625,
                                                                                                    "children": []
                                                                                                }
                                                                                            ]
                                                                                        },
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "label": "graph_id",
                                                                                            "start_token": 3627,
                                                                                            "end_token": 3627,
                                                                                            "children": []
                                                                                        }
                                                                                    ]
                                                                                },
                                                                                {
                                                                                    "type": "pair",
                                                                                    "label": "\"version\": version",
                                                                                    "start_token": 3630,
                                                                                    "end_token": 3632,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "string",
                                                                                            "label": "\"version\"",
                                                                                            "start_token": 3630,
                                                                                            "end_token": 3630,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "string_start",
                                                                                                    "label": "\"",
                                                                                                    "start_token": 3630,
                                                                                                    "end_token": 3630,
                                                                                                    "children": []
                                                                                                },
                                                                                                {
                                                                                                    "type": "string_content",
                                                                                                    "label": "version",
                                                                                                    "start_token": 3630,
                                                                                                    "end_token": 3630,
                                                                                                    "children": []
                                                                                                },
                                                                                                {
                                                                                                    "type": "string_end",
                                                                                                    "label": "\"",
                                                                                                    "start_token": 3630,
                                                                                                    "end_token": 3630,
                                                                                                    "children": []
                                                                                                }
                                                                                            ]
                                                                                        },
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "label": "version",
                                                                                            "start_token": 3632,
                                                                                            "end_token": 3632,
                                                                                            "children": []
                                                                                        }
                                                                                    ]
                                                                                },
                                                                                {
                                                                                    "type": "pair",
                                                                                    "label": "\"userId\": user_id",
                                                                                    "start_token": 3635,
                                                                                    "end_token": 3637,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "string",
                                                                                            "label": "\"userId\"",
                                                                                            "start_token": 3635,
                                                                                            "end_token": 3635,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "string_start",
                                                                                                    "label": "\"",
                                                                                                    "start_token": 3635,
                                                                                                    "end_token": 3635,
                                                                                                    "children": []
                                                                                                },
                                                                                                {
                                                                                                    "type": "string_content",
                                                                                                    "label": "userId",
                                                                                                    "start_token": 3635,
                                                                                                    "end_token": 3635,
                                                                                                    "children": []
                                                                                                },
                                                                                                {
                                                                                                    "type": "string_end",
                                                                                                    "label": "\"",
                                                                                                    "start_token": 3635,
                                                                                                    "end_token": 3635,
                                                                                                    "children": []
                                                                                                }
                                                                                            ]
                                                                                        },
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "label": "user_id",
                                                                                            "start_token": 3637,
                                                                                            "end_token": 3637,
                                                                                            "children": []
                                                                                        }
                                                                                    ]
                                                                                }
                                                                            ]
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                }
                                            ]
                                        }
                                    ]
                                }
                            ]
                        },
                        {
                            "type": "if_statement",
                            "label": "if updated_count == 0:\n        raise Exception(f\"Graph #{graph_id} v{version} not found or not owned by user\")",
                            "start_token": 3645,
                            "end_token": 3657,
                            "children": [
                                {
                                    "type": "comparison_operator",
                                    "label": "updated_count == 0",
                                    "start_token": 3646,
                                    "end_token": 3649,
                                    "children": [
                                        {
                                            "type": "identifier",
                                            "label": "updated_count",
                                            "start_token": 3646,
                                            "end_token": 3646,
                                            "children": []
                                        },
                                        {
                                            "type": "integer",
                                            "label": "0",
                                            "start_token": 3649,
                                            "end_token": 3649,
                                            "children": []
                                        }
                                    ]
                                },
                                {
                                    "type": "block",
                                    "label": "raise Exception(f\"Graph #{graph_id} v{version} not found or not owned by user\")",
                                    "start_token": 3652,
                                    "end_token": 3657,
                                    "children": [
                                        {
                                            "type": "raise_statement",
                                            "label": "raise Exception(f\"Graph #{graph_id} v{version} not found or not owned by user\")",
                                            "start_token": 3652,
                                            "end_token": 3657,
                                            "children": [
                                                {
                                                    "type": "call",
                                                    "label": "Exception(f\"Graph #{graph_id} v{version} not found or not owned by user\")",
                                                    "start_token": 3653,
                                                    "end_token": 3657,
                                                    "children": [
                                                        {
                                                            "type": "identifier",
                                                            "label": "Exception",
                                                            "start_token": 3653,
                                                            "end_token": 3653,
                                                            "children": []
                                                        },
                                                        {
                                                            "type": "argument_list",
                                                            "label": "(f\"Graph #{graph_id} v{version} not found or not owned by user\")",
                                                            "start_token": 3654,
                                                            "end_token": 3657,
                                                            "children": [
                                                                {
                                                                    "type": "string",
                                                                    "label": "f\"Graph #{graph_id} v{version} not found or not owned by user\"",
                                                                    "start_token": 3655,
                                                                    "end_token": 3656,
                                                                    "children": [
                                                                        {
                                                                            "type": "string_start",
                                                                            "label": "f\"",
                                                                            "start_token": 3655,
                                                                            "end_token": 3656,
                                                                            "children": []
                                                                        },
                                                                        {
                                                                            "type": "string_content",
                                                                            "label": "Graph #",
                                                                            "start_token": 3656,
                                                                            "end_token": 3656,
                                                                            "children": []
                                                                        },
                                                                        {
                                                                            "type": "interpolation",
                                                                            "label": "{graph_id}",
                                                                            "start_token": 3656,
                                                                            "end_token": 3656,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "graph_id",
                                                                                    "start_token": 3656,
                                                                                    "end_token": 3656,
                                                                                    "children": []
                                                                                }
                                                                            ]
                                                                        },
                                                                        {
                                                                            "type": "string_content",
                                                                            "label": " v",
                                                                            "start_token": 3656,
                                                                            "end_token": 3656,
                                                                            "children": []
                                                                        },
                                                                        {
                                                                            "type": "interpolation",
                                                                            "label": "{version}",
                                                                            "start_token": 3656,
                                                                            "end_token": 3656,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "version",
                                                                                    "start_token": 3656,
                                                                                    "end_token": 3656,
                                                                                    "children": []
                                                                                }
                                                                            ]
                                                                        },
                                                                        {
                                                                            "type": "string_content",
                                                                            "label": " not found or not owned by user",
                                                                            "start_token": 3656,
                                                                            "end_token": 3656,
                                                                            "children": []
                                                                        },
                                                                        {
                                                                            "type": "string_end",
                                                                            "label": "\"",
                                                                            "start_token": 3656,
                                                                            "end_token": 3656,
                                                                            "children": []
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                }
                                            ]
                                        }
                                    ]
                                }
                            ]
                        },
                        {
                            "type": "comment",
                            "label": "# Deactivate all other versions.",
                            "start_token": 3660,
                            "end_token": 3665,
                            "children": []
                        },
                        {
                            "type": "expression_statement",
                            "label": "await AgentGraph.prisma().update_many(\n        data={\"isActive\": False},\n        where={\n            \"id\": graph_id,\n            \"version\": {\"not\": version},\n            \"userId\": user_id,\n            \"isActive\": True,\n        },\n    )",
                            "start_token": 3667,
                            "end_token": 3717,
                            "children": [
                                {
                                    "type": "await",
                                    "label": "await AgentGraph.prisma().update_many(\n        data={\"isActive\": False},\n        where={\n            \"id\": graph_id,\n            \"version\": {\"not\": version},\n            \"userId\": user_id,\n            \"isActive\": True,\n        },\n    )",
                                    "start_token": 3667,
                                    "end_token": 3717,
                                    "children": [
                                        {
                                            "type": "call",
                                            "label": "AgentGraph.prisma().update_many(\n        data={\"isActive\": False},\n        where={\n            \"id\": graph_id,\n            \"version\": {\"not\": version},\n            \"userId\": user_id,\n            \"isActive\": True,\n        },\n    )",
                                            "start_token": 3668,
                                            "end_token": 3717,
                                            "children": [
                                                {
                                                    "type": "attribute",
                                                    "label": "AgentGraph.prisma().update_many",
                                                    "start_token": 3668,
                                                    "end_token": 3674,
                                                    "children": [
                                                        {
                                                            "type": "call",
                                                            "label": "AgentGraph.prisma()",
                                                            "start_token": 3668,
                                                            "end_token": 3672,
                                                            "children": [
                                                                {
                                                                    "type": "attribute",
                                                                    "label": "AgentGraph.prisma",
                                                                    "start_token": 3668,
                                                                    "end_token": 3670,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "AgentGraph",
                                                                            "start_token": 3668,
                                                                            "end_token": 3668,
                                                                            "children": []
                                                                        },
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "prisma",
                                                                            "start_token": 3670,
                                                                            "end_token": 3670,
                                                                            "children": []
                                                                        }
                                                                    ]
                                                                },
                                                                {
                                                                    "type": "argument_list",
                                                                    "label": "()",
                                                                    "start_token": 3671,
                                                                    "end_token": 3672,
                                                                    "children": []
                                                                }
                                                            ]
                                                        },
                                                        {
                                                            "type": "identifier",
                                                            "label": "update_many",
                                                            "start_token": 3674,
                                                            "end_token": 3674,
                                                            "children": []
                                                        }
                                                    ]
                                                },
                                                {
                                                    "type": "argument_list",
                                                    "label": "(\n        data={\"isActive\": False},\n        where={\n            \"id\": graph_id,\n            \"version\": {\"not\": version},\n            \"userId\": user_id,\n            \"isActive\": True,\n        },\n    )",
                                                    "start_token": 3675,
                                                    "end_token": 3717,
                                                    "children": [
                                                        {
                                                            "type": "keyword_argument",
                                                            "label": "data={\"isActive\": False}",
                                                            "start_token": 3677,
                                                            "end_token": 3683,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "label": "data",
                                                                    "start_token": 3677,
                                                                    "end_token": 3677,
                                                                    "children": []
                                                                },
                                                                {
                                                                    "type": "dictionary",
                                                                    "label": "{\"isActive\": False}",
                                                                    "start_token": 3679,
                                                                    "end_token": 3683,
                                                                    "children": [
                                                                        {
                                                                            "type": "pair",
                                                                            "label": "\"isActive\": False",
                                                                            "start_token": 3680,
                                                                            "end_token": 3682,
                                                                            "children": [
                                                                                {
                                                                                    "type": "string",
                                                                                    "label": "\"isActive\"",
                                                                                    "start_token": 3680,
                                                                                    "end_token": 3680,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "string_start",
                                                                                            "label": "\"",
                                                                                            "start_token": 3680,
                                                                                            "end_token": 3680,
                                                                                            "children": []
                                                                                        },
                                                                                        {
                                                                                            "type": "string_content",
                                                                                            "label": "isActive",
                                                                                            "start_token": 3680,
                                                                                            "end_token": 3680,
                                                                                            "children": []
                                                                                        },
                                                                                        {
                                                                                            "type": "string_end",
                                                                                            "label": "\"",
                                                                                            "start_token": 3680,
                                                                                            "end_token": 3680,
                                                                                            "children": []
                                                                                        }
                                                                                    ]
                                                                                },
                                                                                {
                                                                                    "type": "false",
                                                                                    "label": "False",
                                                                                    "start_token": 3682,
                                                                                    "end_token": 3682,
                                                                                    "children": []
                                                                                }
                                                                            ]
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        },
                                                        {
                                                            "type": "keyword_argument",
                                                            "label": "where={\n            \"id\": graph_id,\n            \"version\": {\"not\": version},\n            \"userId\": user_id,\n            \"isActive\": True,\n        }",
                                                            "start_token": 3686,
                                                            "end_token": 3714,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "label": "where",
                                                                    "start_token": 3686,
                                                                    "end_token": 3686,
                                                                    "children": []
                                                                },
                                                                {
                                                                    "type": "dictionary",
                                                                    "label": "{\n            \"id\": graph_id,\n            \"version\": {\"not\": version},\n            \"userId\": user_id,\n            \"isActive\": True,\n        }",
                                                                    "start_token": 3688,
                                                                    "end_token": 3714,
                                                                    "children": [
                                                                        {
                                                                            "type": "pair",
                                                                            "label": "\"id\": graph_id",
                                                                            "start_token": 3690,
                                                                            "end_token": 3692,
                                                                            "children": [
                                                                                {
                                                                                    "type": "string",
                                                                                    "label": "\"id\"",
                                                                                    "start_token": 3690,
                                                                                    "end_token": 3690,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "string_start",
                                                                                            "label": "\"",
                                                                                            "start_token": 3690,
                                                                                            "end_token": 3690,
                                                                                            "children": []
                                                                                        },
                                                                                        {
                                                                                            "type": "string_content",
                                                                                            "label": "id",
                                                                                            "start_token": 3690,
                                                                                            "end_token": 3690,
                                                                                            "children": []
                                                                                        },
                                                                                        {
                                                                                            "type": "string_end",
                                                                                            "label": "\"",
                                                                                            "start_token": 3690,
                                                                                            "end_token": 3690,
                                                                                            "children": []
                                                                                        }
                                                                                    ]
                                                                                },
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "graph_id",
                                                                                    "start_token": 3692,
                                                                                    "end_token": 3692,
                                                                                    "children": []
                                                                                }
                                                                            ]
                                                                        },
                                                                        {
                                                                            "type": "pair",
                                                                            "label": "\"version\": {\"not\": version}",
                                                                            "start_token": 3695,
                                                                            "end_token": 3701,
                                                                            "children": [
                                                                                {
                                                                                    "type": "string",
                                                                                    "label": "\"version\"",
                                                                                    "start_token": 3695,
                                                                                    "end_token": 3695,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "string_start",
                                                                                            "label": "\"",
                                                                                            "start_token": 3695,
                                                                                            "end_token": 3695,
                                                                                            "children": []
                                                                                        },
                                                                                        {
                                                                                            "type": "string_content",
                                                                                            "label": "version",
                                                                                            "start_token": 3695,
                                                                                            "end_token": 3695,
                                                                                            "children": []
                                                                                        },
                                                                                        {
                                                                                            "type": "string_end",
                                                                                            "label": "\"",
                                                                                            "start_token": 3695,
                                                                                            "end_token": 3695,
                                                                                            "children": []
                                                                                        }
                                                                                    ]
                                                                                },
                                                                                {
                                                                                    "type": "dictionary",
                                                                                    "label": "{\"not\": version}",
                                                                                    "start_token": 3697,
                                                                                    "end_token": 3701,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "pair",
                                                                                            "label": "\"not\": version",
                                                                                            "start_token": 3698,
                                                                                            "end_token": 3700,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "string",
                                                                                                    "label": "\"not\"",
                                                                                                    "start_token": 3698,
                                                                                                    "end_token": 3698,
                                                                                                    "children": [
                                                                                                        {
                                                                                                            "type": "string_start",
                                                                                                            "label": "\"",
                                                                                                            "start_token": 3698,
                                                                                                            "end_token": 3698,
                                                                                                            "children": []
                                                                                                        },
                                                                                                        {
                                                                                                            "type": "string_content",
                                                                                                            "label": "not",
                                                                                                            "start_token": 3698,
                                                                                                            "end_token": 3698,
                                                                                                            "children": []
                                                                                                        },
                                                                                                        {
                                                                                                            "type": "string_end",
                                                                                                            "label": "\"",
                                                                                                            "start_token": 3698,
                                                                                                            "end_token": 3698,
                                                                                                            "children": []
                                                                                                        }
                                                                                                    ]
                                                                                                },
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "label": "version",
                                                                                                    "start_token": 3700,
                                                                                                    "end_token": 3700,
                                                                                                    "children": []
                                                                                                }
                                                                                            ]
                                                                                        }
                                                                                    ]
                                                                                }
                                                                            ]
                                                                        },
                                                                        {
                                                                            "type": "pair",
                                                                            "label": "\"userId\": user_id",
                                                                            "start_token": 3704,
                                                                            "end_token": 3706,
                                                                            "children": [
                                                                                {
                                                                                    "type": "string",
                                                                                    "label": "\"userId\"",
                                                                                    "start_token": 3704,
                                                                                    "end_token": 3704,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "string_start",
                                                                                            "label": "\"",
                                                                                            "start_token": 3704,
                                                                                            "end_token": 3704,
                                                                                            "children": []
                                                                                        },
                                                                                        {
                                                                                            "type": "string_content",
                                                                                            "label": "userId",
                                                                                            "start_token": 3704,
                                                                                            "end_token": 3704,
                                                                                            "children": []
                                                                                        },
                                                                                        {
                                                                                            "type": "string_end",
                                                                                            "label": "\"",
                                                                                            "start_token": 3704,
                                                                                            "end_token": 3704,
                                                                                            "children": []
                                                                                        }
                                                                                    ]
                                                                                },
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "user_id",
                                                                                    "start_token": 3706,
                                                                                    "end_token": 3706,
                                                                                    "children": []
                                                                                }
                                                                            ]
                                                                        },
                                                                        {
                                                                            "type": "pair",
                                                                            "label": "\"isActive\": True",
                                                                            "start_token": 3709,
                                                                            "end_token": 3711,
                                                                            "children": [
                                                                                {
                                                                                    "type": "string",
                                                                                    "label": "\"isActive\"",
                                                                                    "start_token": 3709,
                                                                                    "end_token": 3709,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "string_start",
                                                                                            "label": "\"",
                                                                                            "start_token": 3709,
                                                                                            "end_token": 3709,
                                                                                            "children": []
                                                                                        },
                                                                                        {
                                                                                            "type": "string_content",
                                                                                            "label": "isActive",
                                                                                            "start_token": 3709,
                                                                                            "end_token": 3709,
                                                                                            "children": []
                                                                                        },
                                                                                        {
                                                                                            "type": "string_end",
                                                                                            "label": "\"",
                                                                                            "start_token": 3709,
                                                                                            "end_token": 3709,
                                                                                            "children": []
                                                                                        }
                                                                                    ]
                                                                                },
                                                                                {
                                                                                    "type": "true",
                                                                                    "label": "True",
                                                                                    "start_token": 3711,
                                                                                    "end_token": 3711,
                                                                                    "children": []
                                                                                }
                                                                            ]
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                }
                                            ]
                                        }
                                    ]
                                }
                            ]
                        }
                    ]
                }
            ]
        },
        {
            "type": "function_definition",
            "label": "async def get_graph_all_versions(graph_id: str, user_id: str) -> list[GraphModel]:\n    graph_versions = await AgentGraph.prisma().find_many(\n        where={\"id\": graph_id, \"userId\": user_id},\n        order={\"version\": \"desc\"},\n        include=AGENT_GRAPH_INCLUDE,\n    )\n\n    if not graph_versions:\n        return []\n\n    return [GraphModel.from_db(graph) for graph in graph_versions]",
            "start_token": 3721,
            "end_token": 3805,
            "children": [
                {
                    "type": "identifier",
                    "label": "get_graph_all_versions",
                    "start_token": 3723,
                    "end_token": 3723,
                    "children": []
                },
                {
                    "type": "parameters",
                    "label": "(graph_id: str, user_id: str)",
                    "start_token": 3724,
                    "end_token": 3732,
                    "children": [
                        {
                            "type": "typed_parameter",
                            "label": "graph_id: str",
                            "start_token": 3725,
                            "end_token": 3727,
                            "children": [
                                {
                                    "type": "identifier",
                                    "label": "graph_id",
                                    "start_token": 3725,
                                    "end_token": 3725,
                                    "children": []
                                },
                                {
                                    "type": "type",
                                    "label": "str",
                                    "start_token": 3727,
                                    "end_token": 3727,
                                    "children": [
                                        {
                                            "type": "identifier",
                                            "label": "str",
                                            "start_token": 3727,
                                            "end_token": 3727,
                                            "children": []
                                        }
                                    ]
                                }
                            ]
                        },
                        {
                            "type": "typed_parameter",
                            "label": "user_id: str",
                            "start_token": 3729,
                            "end_token": 3731,
                            "children": [
                                {
                                    "type": "identifier",
                                    "label": "user_id",
                                    "start_token": 3729,
                                    "end_token": 3729,
                                    "children": []
                                },
                                {
                                    "type": "type",
                                    "label": "str",
                                    "start_token": 3731,
                                    "end_token": 3731,
                                    "children": [
                                        {
                                            "type": "identifier",
                                            "label": "str",
                                            "start_token": 3731,
                                            "end_token": 3731,
                                            "children": []
                                        }
                                    ]
                                }
                            ]
                        }
                    ]
                },
                {
                    "type": "type",
                    "label": "list[GraphModel]",
                    "start_token": 3735,
                    "end_token": 3738,
                    "children": [
                        {
                            "type": "generic_type",
                            "label": "list[GraphModel]",
                            "start_token": 3735,
                            "end_token": 3738,
                            "children": [
                                {
                                    "type": "identifier",
                                    "label": "list",
                                    "start_token": 3735,
                                    "end_token": 3735,
                                    "children": []
                                },
                                {
                                    "type": "type_parameter",
                                    "label": "[GraphModel]",
                                    "start_token": 3736,
                                    "end_token": 3738,
                                    "children": [
                                        {
                                            "type": "type",
                                            "label": "GraphModel",
                                            "start_token": 3737,
                                            "end_token": 3737,
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "label": "GraphModel",
                                                    "start_token": 3737,
                                                    "end_token": 3737,
                                                    "children": []
                                                }
                                            ]
                                        }
                                    ]
                                }
                            ]
                        }
                    ]
                },
                {
                    "type": "block",
                    "label": "graph_versions = await AgentGraph.prisma().find_many(\n        where={\"id\": graph_id, \"userId\": user_id},\n        order={\"version\": \"desc\"},\n        include=AGENT_GRAPH_INCLUDE,\n    )\n\n    if not graph_versions:\n        return []\n\n    return [GraphModel.from_db(graph) for graph in graph_versions]",
                    "start_token": 3741,
                    "end_token": 3805,
                    "children": [
                        {
                            "type": "expression_statement",
                            "label": "graph_versions = await AgentGraph.prisma().find_many(\n        where={\"id\": graph_id, \"userId\": user_id},\n        order={\"version\": \"desc\"},\n        include=AGENT_GRAPH_INCLUDE,\n    )",
                            "start_token": 3741,
                            "end_token": 3780,
                            "children": [
                                {
                                    "type": "assignment",
                                    "label": "graph_versions = await AgentGraph.prisma().find_many(\n        where={\"id\": graph_id, \"userId\": user_id},\n        order={\"version\": \"desc\"},\n        include=AGENT_GRAPH_INCLUDE,\n    )",
                                    "start_token": 3741,
                                    "end_token": 3780,
                                    "children": [
                                        {
                                            "type": "identifier",
                                            "label": "graph_versions",
                                            "start_token": 3741,
                                            "end_token": 3741,
                                            "children": []
                                        },
                                        {
                                            "type": "await",
                                            "label": "await AgentGraph.prisma().find_many(\n        where={\"id\": graph_id, \"userId\": user_id},\n        order={\"version\": \"desc\"},\n        include=AGENT_GRAPH_INCLUDE,\n    )",
                                            "start_token": 3743,
                                            "end_token": 3780,
                                            "children": [
                                                {
                                                    "type": "call",
                                                    "label": "AgentGraph.prisma().find_many(\n        where={\"id\": graph_id, \"userId\": user_id},\n        order={\"version\": \"desc\"},\n        include=AGENT_GRAPH_INCLUDE,\n    )",
                                                    "start_token": 3744,
                                                    "end_token": 3780,
                                                    "children": [
                                                        {
                                                            "type": "attribute",
                                                            "label": "AgentGraph.prisma().find_many",
                                                            "start_token": 3744,
                                                            "end_token": 3750,
                                                            "children": [
                                                                {
                                                                    "type": "call",
                                                                    "label": "AgentGraph.prisma()",
                                                                    "start_token": 3744,
                                                                    "end_token": 3748,
                                                                    "children": [
                                                                        {
                                                                            "type": "attribute",
                                                                            "label": "AgentGraph.prisma",
                                                                            "start_token": 3744,
                                                                            "end_token": 3746,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "AgentGraph",
                                                                                    "start_token": 3744,
                                                                                    "end_token": 3744,
                                                                                    "children": []
                                                                                },
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "prisma",
                                                                                    "start_token": 3746,
                                                                                    "end_token": 3746,
                                                                                    "children": []
                                                                                }
                                                                            ]
                                                                        },
                                                                        {
                                                                            "type": "argument_list",
                                                                            "label": "()",
                                                                            "start_token": 3747,
                                                                            "end_token": 3748,
                                                                            "children": []
                                                                        }
                                                                    ]
                                                                },
                                                                {
                                                                    "type": "identifier",
                                                                    "label": "find_many",
                                                                    "start_token": 3750,
                                                                    "end_token": 3750,
                                                                    "children": []
                                                                }
                                                            ]
                                                        },
                                                        {
                                                            "type": "argument_list",
                                                            "label": "(\n        where={\"id\": graph_id, \"userId\": user_id},\n        order={\"version\": \"desc\"},\n        include=AGENT_GRAPH_INCLUDE,\n    )",
                                                            "start_token": 3751,
                                                            "end_token": 3780,
                                                            "children": [
                                                                {
                                                                    "type": "keyword_argument",
                                                                    "label": "where={\"id\": graph_id, \"userId\": user_id}",
                                                                    "start_token": 3753,
                                                                    "end_token": 3763,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "where",
                                                                            "start_token": 3753,
                                                                            "end_token": 3753,
                                                                            "children": []
                                                                        },
                                                                        {
                                                                            "type": "dictionary",
                                                                            "label": "{\"id\": graph_id, \"userId\": user_id}",
                                                                            "start_token": 3755,
                                                                            "end_token": 3763,
                                                                            "children": [
                                                                                {
                                                                                    "type": "pair",
                                                                                    "label": "\"id\": graph_id",
                                                                                    "start_token": 3756,
                                                                                    "end_token": 3758,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "string",
                                                                                            "label": "\"id\"",
                                                                                            "start_token": 3756,
                                                                                            "end_token": 3756,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "string_start",
                                                                                                    "label": "\"",
                                                                                                    "start_token": 3756,
                                                                                                    "end_token": 3756,
                                                                                                    "children": []
                                                                                                },
                                                                                                {
                                                                                                    "type": "string_content",
                                                                                                    "label": "id",
                                                                                                    "start_token": 3756,
                                                                                                    "end_token": 3756,
                                                                                                    "children": []
                                                                                                },
                                                                                                {
                                                                                                    "type": "string_end",
                                                                                                    "label": "\"",
                                                                                                    "start_token": 3756,
                                                                                                    "end_token": 3756,
                                                                                                    "children": []
                                                                                                }
                                                                                            ]
                                                                                        },
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "label": "graph_id",
                                                                                            "start_token": 3758,
                                                                                            "end_token": 3758,
                                                                                            "children": []
                                                                                        }
                                                                                    ]
                                                                                },
                                                                                {
                                                                                    "type": "pair",
                                                                                    "label": "\"userId\": user_id",
                                                                                    "start_token": 3760,
                                                                                    "end_token": 3762,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "string",
                                                                                            "label": "\"userId\"",
                                                                                            "start_token": 3760,
                                                                                            "end_token": 3760,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "string_start",
                                                                                                    "label": "\"",
                                                                                                    "start_token": 3760,
                                                                                                    "end_token": 3760,
                                                                                                    "children": []
                                                                                                },
                                                                                                {
                                                                                                    "type": "string_content",
                                                                                                    "label": "userId",
                                                                                                    "start_token": 3760,
                                                                                                    "end_token": 3760,
                                                                                                    "children": []
                                                                                                },
                                                                                                {
                                                                                                    "type": "string_end",
                                                                                                    "label": "\"",
                                                                                                    "start_token": 3760,
                                                                                                    "end_token": 3760,
                                                                                                    "children": []
                                                                                                }
                                                                                            ]
                                                                                        },
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "label": "user_id",
                                                                                            "start_token": 3762,
                                                                                            "end_token": 3762,
                                                                                            "children": []
                                                                                        }
                                                                                    ]
                                                                                }
                                                                            ]
                                                                        }
                                                                    ]
                                                                },
                                                                {
                                                                    "type": "keyword_argument",
                                                                    "label": "order={\"version\": \"desc\"}",
                                                                    "start_token": 3766,
                                                                    "end_token": 3772,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "order",
                                                                            "start_token": 3766,
                                                                            "end_token": 3766,
                                                                            "children": []
                                                                        },
                                                                        {
                                                                            "type": "dictionary",
                                                                            "label": "{\"version\": \"desc\"}",
                                                                            "start_token": 3768,
                                                                            "end_token": 3772,
                                                                            "children": [
                                                                                {
                                                                                    "type": "pair",
                                                                                    "label": "\"version\": \"desc\"",
                                                                                    "start_token": 3769,
                                                                                    "end_token": 3771,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "string",
                                                                                            "label": "\"version\"",
                                                                                            "start_token": 3769,
                                                                                            "end_token": 3769,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "string_start",
                                                                                                    "label": "\"",
                                                                                                    "start_token": 3769,
                                                                                                    "end_token": 3769,
                                                                                                    "children": []
                                                                                                },
                                                                                                {
                                                                                                    "type": "string_content",
                                                                                                    "label": "version",
                                                                                                    "start_token": 3769,
                                                                                                    "end_token": 3769,
                                                                                                    "children": []
                                                                                                },
                                                                                                {
                                                                                                    "type": "string_end",
                                                                                                    "label": "\"",
                                                                                                    "start_token": 3769,
                                                                                                    "end_token": 3769,
                                                                                                    "children": []
                                                                                                }
                                                                                            ]
                                                                                        },
                                                                                        {
                                                                                            "type": "string",
                                                                                            "label": "\"desc\"",
                                                                                            "start_token": 3771,
                                                                                            "end_token": 3771,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "string_start",
                                                                                                    "label": "\"",
                                                                                                    "start_token": 3771,
                                                                                                    "end_token": 3771,
                                                                                                    "children": []
                                                                                                },
                                                                                                {
                                                                                                    "type": "string_content",
                                                                                                    "label": "desc",
                                                                                                    "start_token": 3771,
                                                                                                    "end_token": 3771,
                                                                                                    "children": []
                                                                                                },
                                                                                                {
                                                                                                    "type": "string_end",
                                                                                                    "label": "\"",
                                                                                                    "start_token": 3771,
                                                                                                    "end_token": 3771,
                                                                                                    "children": []
                                                                                                }
                                                                                            ]
                                                                                        }
                                                                                    ]
                                                                                }
                                                                            ]
                                                                        }
                                                                    ]
                                                                },
                                                                {
                                                                    "type": "keyword_argument",
                                                                    "label": "include=AGENT_GRAPH_INCLUDE",
                                                                    "start_token": 3775,
                                                                    "end_token": 3777,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "include",
                                                                            "start_token": 3775,
                                                                            "end_token": 3775,
                                                                            "children": []
                                                                        },
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "AGENT_GRAPH_INCLUDE",
                                                                            "start_token": 3777,
                                                                            "end_token": 3777,
                                                                            "children": []
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                }
                                            ]
                                        }
                                    ]
                                }
                            ]
                        },
                        {
                            "type": "if_statement",
                            "label": "if not graph_versions:\n        return []",
                            "start_token": 3783,
                            "end_token": 3790,
                            "children": [
                                {
                                    "type": "not_operator",
                                    "label": "not graph_versions",
                                    "start_token": 3784,
                                    "end_token": 3785,
                                    "children": [
                                        {
                                            "type": "identifier",
                                            "label": "graph_versions",
                                            "start_token": 3785,
                                            "end_token": 3785,
                                            "children": []
                                        }
                                    ]
                                },
                                {
                                    "type": "block",
                                    "label": "return []",
                                    "start_token": 3788,
                                    "end_token": 3790,
                                    "children": [
                                        {
                                            "type": "return_statement",
                                            "label": "return []",
                                            "start_token": 3788,
                                            "end_token": 3790,
                                            "children": [
                                                {
                                                    "type": "list",
                                                    "label": "[]",
                                                    "start_token": 3789,
                                                    "end_token": 3790,
                                                    "children": []
                                                }
                                            ]
                                        }
                                    ]
                                }
                            ]
                        },
                        {
                            "type": "return_statement",
                            "label": "return [GraphModel.from_db(graph) for graph in graph_versions]",
                            "start_token": 3793,
                            "end_token": 3805,
                            "children": [
                                {
                                    "type": "list_comprehension",
                                    "label": "[GraphModel.from_db(graph) for graph in graph_versions]",
                                    "start_token": 3794,
                                    "end_token": 3805,
                                    "children": [
                                        {
                                            "type": "call",
                                            "label": "GraphModel.from_db(graph)",
                                            "start_token": 3795,
                                            "end_token": 3800,
                                            "children": [
                                                {
                                                    "type": "attribute",
                                                    "label": "GraphModel.from_db",
                                                    "start_token": 3795,
                                                    "end_token": 3797,
                                                    "children": [
                                                        {
                                                            "type": "identifier",
                                                            "label": "GraphModel",
                                                            "start_token": 3795,
                                                            "end_token": 3795,
                                                            "children": []
                                                        },
                                                        {
                                                            "type": "identifier",
                                                            "label": "from_db",
                                                            "start_token": 3797,
                                                            "end_token": 3797,
                                                            "children": []
                                                        }
                                                    ]
                                                },
                                                {
                                                    "type": "argument_list",
                                                    "label": "(graph)",
                                                    "start_token": 3798,
                                                    "end_token": 3800,
                                                    "children": [
                                                        {
                                                            "type": "identifier",
                                                            "label": "graph",
                                                            "start_token": 3799,
                                                            "end_token": 3799,
                                                            "children": []
                                                        }
                                                    ]
                                                }
                                            ]
                                        },
                                        {
                                            "type": "for_in_clause",
                                            "label": "for graph in graph_versions",
                                            "start_token": 3801,
                                            "end_token": 3804,
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "label": "graph",
                                                    "start_token": 3802,
                                                    "end_token": 3802,
                                                    "children": []
                                                },
                                                {
                                                    "type": "identifier",
                                                    "label": "graph_versions",
                                                    "start_token": 3804,
                                                    "end_token": 3804,
                                                    "children": []
                                                }
                                            ]
                                        }
                                    ]
                                }
                            ]
                        }
                    ]
                }
            ]
        },
        {
            "type": "function_definition",
            "label": "async def delete_graph(graph_id: str, user_id: str) -> int:\n    entries_count = await AgentGraph.prisma().delete_many(\n        where={\"id\": graph_id, \"userId\": user_id}\n    )\n    if entries_count:\n        logger.info(f\"Deleted {entries_count} graph entries for Graph #{graph_id}\")\n    return entries_count",
            "start_token": 3809,
            "end_token": 3865,
            "children": [
                {
                    "type": "identifier",
                    "label": "delete_graph",
                    "start_token": 3811,
                    "end_token": 3811,
                    "children": []
                },
                {
                    "type": "parameters",
                    "label": "(graph_id: str, user_id: str)",
                    "start_token": 3812,
                    "end_token": 3820,
                    "children": [
                        {
                            "type": "typed_parameter",
                            "label": "graph_id: str",
                            "start_token": 3813,
                            "end_token": 3815,
                            "children": [
                                {
                                    "type": "identifier",
                                    "label": "graph_id",
                                    "start_token": 3813,
                                    "end_token": 3813,
                                    "children": []
                                },
                                {
                                    "type": "type",
                                    "label": "str",
                                    "start_token": 3815,
                                    "end_token": 3815,
                                    "children": [
                                        {
                                            "type": "identifier",
                                            "label": "str",
                                            "start_token": 3815,
                                            "end_token": 3815,
                                            "children": []
                                        }
                                    ]
                                }
                            ]
                        },
                        {
                            "type": "typed_parameter",
                            "label": "user_id: str",
                            "start_token": 3817,
                            "end_token": 3819,
                            "children": [
                                {
                                    "type": "identifier",
                                    "label": "user_id",
                                    "start_token": 3817,
                                    "end_token": 3817,
                                    "children": []
                                },
                                {
                                    "type": "type",
                                    "label": "str",
                                    "start_token": 3819,
                                    "end_token": 3819,
                                    "children": [
                                        {
                                            "type": "identifier",
                                            "label": "str",
                                            "start_token": 3819,
                                            "end_token": 3819,
                                            "children": []
                                        }
                                    ]
                                }
                            ]
                        }
                    ]
                },
                {
                    "type": "type",
                    "label": "int",
                    "start_token": 3823,
                    "end_token": 3823,
                    "children": [
                        {
                            "type": "identifier",
                            "label": "int",
                            "start_token": 3823,
                            "end_token": 3823,
                            "children": []
                        }
                    ]
                },
                {
                    "type": "block",
                    "label": "entries_count = await AgentGraph.prisma().delete_many(\n        where={\"id\": graph_id, \"userId\": user_id}\n    )\n    if entries_count:\n        logger.info(f\"Deleted {entries_count} graph entries for Graph #{graph_id}\")\n    return entries_count",
                    "start_token": 3826,
                    "end_token": 3865,
                    "children": [
                        {
                            "type": "expression_statement",
                            "label": "entries_count = await AgentGraph.prisma().delete_many(\n        where={\"id\": graph_id, \"userId\": user_id}\n    )",
                            "start_token": 3826,
                            "end_token": 3850,
                            "children": [
                                {
                                    "type": "assignment",
                                    "label": "entries_count = await AgentGraph.prisma().delete_many(\n        where={\"id\": graph_id, \"userId\": user_id}\n    )",
                                    "start_token": 3826,
                                    "end_token": 3850,
                                    "children": [
                                        {
                                            "type": "identifier",
                                            "label": "entries_count",
                                            "start_token": 3826,
                                            "end_token": 3826,
                                            "children": []
                                        },
                                        {
                                            "type": "await",
                                            "label": "await AgentGraph.prisma().delete_many(\n        where={\"id\": graph_id, \"userId\": user_id}\n    )",
                                            "start_token": 3828,
                                            "end_token": 3850,
                                            "children": [
                                                {
                                                    "type": "call",
                                                    "label": "AgentGraph.prisma().delete_many(\n        where={\"id\": graph_id, \"userId\": user_id}\n    )",
                                                    "start_token": 3829,
                                                    "end_token": 3850,
                                                    "children": [
                                                        {
                                                            "type": "attribute",
                                                            "label": "AgentGraph.prisma().delete_many",
                                                            "start_token": 3829,
                                                            "end_token": 3835,
                                                            "children": [
                                                                {
                                                                    "type": "call",
                                                                    "label": "AgentGraph.prisma()",
                                                                    "start_token": 3829,
                                                                    "end_token": 3833,
                                                                    "children": [
                                                                        {
                                                                            "type": "attribute",
                                                                            "label": "AgentGraph.prisma",
                                                                            "start_token": 3829,
                                                                            "end_token": 3831,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "AgentGraph",
                                                                                    "start_token": 3829,
                                                                                    "end_token": 3829,
                                                                                    "children": []
                                                                                },
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "prisma",
                                                                                    "start_token": 3831,
                                                                                    "end_token": 3831,
                                                                                    "children": []
                                                                                }
                                                                            ]
                                                                        },
                                                                        {
                                                                            "type": "argument_list",
                                                                            "label": "()",
                                                                            "start_token": 3832,
                                                                            "end_token": 3833,
                                                                            "children": []
                                                                        }
                                                                    ]
                                                                },
                                                                {
                                                                    "type": "identifier",
                                                                    "label": "delete_many",
                                                                    "start_token": 3835,
                                                                    "end_token": 3835,
                                                                    "children": []
                                                                }
                                                            ]
                                                        },
                                                        {
                                                            "type": "argument_list",
                                                            "label": "(\n        where={\"id\": graph_id, \"userId\": user_id}\n    )",
                                                            "start_token": 3836,
                                                            "end_token": 3850,
                                                            "children": [
                                                                {
                                                                    "type": "keyword_argument",
                                                                    "label": "where={\"id\": graph_id, \"userId\": user_id}",
                                                                    "start_token": 3838,
                                                                    "end_token": 3848,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "where",
                                                                            "start_token": 3838,
                                                                            "end_token": 3838,
                                                                            "children": []
                                                                        },
                                                                        {
                                                                            "type": "dictionary",
                                                                            "label": "{\"id\": graph_id, \"userId\": user_id}",
                                                                            "start_token": 3840,
                                                                            "end_token": 3848,
                                                                            "children": [
                                                                                {
                                                                                    "type": "pair",
                                                                                    "label": "\"id\": graph_id",
                                                                                    "start_token": 3841,
                                                                                    "end_token": 3843,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "string",
                                                                                            "label": "\"id\"",
                                                                                            "start_token": 3841,
                                                                                            "end_token": 3841,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "string_start",
                                                                                                    "label": "\"",
                                                                                                    "start_token": 3841,
                                                                                                    "end_token": 3841,
                                                                                                    "children": []
                                                                                                },
                                                                                                {
                                                                                                    "type": "string_content",
                                                                                                    "label": "id",
                                                                                                    "start_token": 3841,
                                                                                                    "end_token": 3841,
                                                                                                    "children": []
                                                                                                },
                                                                                                {
                                                                                                    "type": "string_end",
                                                                                                    "label": "\"",
                                                                                                    "start_token": 3841,
                                                                                                    "end_token": 3841,
                                                                                                    "children": []
                                                                                                }
                                                                                            ]
                                                                                        },
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "label": "graph_id",
                                                                                            "start_token": 3843,
                                                                                            "end_token": 3843,
                                                                                            "children": []
                                                                                        }
                                                                                    ]
                                                                                },
                                                                                {
                                                                                    "type": "pair",
                                                                                    "label": "\"userId\": user_id",
                                                                                    "start_token": 3845,
                                                                                    "end_token": 3847,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "string",
                                                                                            "label": "\"userId\"",
                                                                                            "start_token": 3845,
                                                                                            "end_token": 3845,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "string_start",
                                                                                                    "label": "\"",
                                                                                                    "start_token": 3845,
                                                                                                    "end_token": 3845,
                                                                                                    "children": []
                                                                                                },
                                                                                                {
                                                                                                    "type": "string_content",
                                                                                                    "label": "userId",
                                                                                                    "start_token": 3845,
                                                                                                    "end_token": 3845,
                                                                                                    "children": []
                                                                                                },
                                                                                                {
                                                                                                    "type": "string_end",
                                                                                                    "label": "\"",
                                                                                                    "start_token": 3845,
                                                                                                    "end_token": 3845,
                                                                                                    "children": []
                                                                                                }
                                                                                            ]
                                                                                        },
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "label": "user_id",
                                                                                            "start_token": 3847,
                                                                                            "end_token": 3847,
                                                                                            "children": []
                                                                                        }
                                                                                    ]
                                                                                }
                                                                            ]
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                }
                                            ]
                                        }
                                    ]
                                }
                            ]
                        },
                        {
                            "type": "if_statement",
                            "label": "if entries_count:\n        logger.info(f\"Deleted {entries_count} graph entries for Graph #{graph_id}\")",
                            "start_token": 3852,
                            "end_token": 3862,
                            "children": [
                                {
                                    "type": "identifier",
                                    "label": "entries_count",
                                    "start_token": 3853,
                                    "end_token": 3853,
                                    "children": []
                                },
                                {
                                    "type": "block",
                                    "label": "logger.info(f\"Deleted {entries_count} graph entries for Graph #{graph_id}\")",
                                    "start_token": 3856,
                                    "end_token": 3862,
                                    "children": [
                                        {
                                            "type": "expression_statement",
                                            "label": "logger.info(f\"Deleted {entries_count} graph entries for Graph #{graph_id}\")",
                                            "start_token": 3856,
                                            "end_token": 3862,
                                            "children": [
                                                {
                                                    "type": "call",
                                                    "label": "logger.info(f\"Deleted {entries_count} graph entries for Graph #{graph_id}\")",
                                                    "start_token": 3856,
                                                    "end_token": 3862,
                                                    "children": [
                                                        {
                                                            "type": "attribute",
                                                            "label": "logger.info",
                                                            "start_token": 3856,
                                                            "end_token": 3858,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "label": "logger",
                                                                    "start_token": 3856,
                                                                    "end_token": 3856,
                                                                    "children": []
                                                                },
                                                                {
                                                                    "type": "identifier",
                                                                    "label": "info",
                                                                    "start_token": 3858,
                                                                    "end_token": 3858,
                                                                    "children": []
                                                                }
                                                            ]
                                                        },
                                                        {
                                                            "type": "argument_list",
                                                            "label": "(f\"Deleted {entries_count} graph entries for Graph #{graph_id}\")",
                                                            "start_token": 3859,
                                                            "end_token": 3862,
                                                            "children": [
                                                                {
                                                                    "type": "string",
                                                                    "label": "f\"Deleted {entries_count} graph entries for Graph #{graph_id}\"",
                                                                    "start_token": 3860,
                                                                    "end_token": 3861,
                                                                    "children": [
                                                                        {
                                                                            "type": "string_start",
                                                                            "label": "f\"",
                                                                            "start_token": 3860,
                                                                            "end_token": 3861,
                                                                            "children": []
                                                                        },
                                                                        {
                                                                            "type": "string_content",
                                                                            "label": "Deleted ",
                                                                            "start_token": 3861,
                                                                            "end_token": 3861,
                                                                            "children": []
                                                                        },
                                                                        {
                                                                            "type": "interpolation",
                                                                            "label": "{entries_count}",
                                                                            "start_token": 3861,
                                                                            "end_token": 3861,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "entries_count",
                                                                                    "start_token": 3861,
                                                                                    "end_token": 3861,
                                                                                    "children": []
                                                                                }
                                                                            ]
                                                                        },
                                                                        {
                                                                            "type": "string_content",
                                                                            "label": " graph entries for Graph #",
                                                                            "start_token": 3861,
                                                                            "end_token": 3861,
                                                                            "children": []
                                                                        },
                                                                        {
                                                                            "type": "interpolation",
                                                                            "label": "{graph_id}",
                                                                            "start_token": 3861,
                                                                            "end_token": 3861,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "graph_id",
                                                                                    "start_token": 3861,
                                                                                    "end_token": 3861,
                                                                                    "children": []
                                                                                }
                                                                            ]
                                                                        },
                                                                        {
                                                                            "type": "string_end",
                                                                            "label": "\"",
                                                                            "start_token": 3861,
                                                                            "end_token": 3861,
                                                                            "children": []
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                }
                                            ]
                                        }
                                    ]
                                }
                            ]
                        },
                        {
                            "type": "return_statement",
                            "label": "return entries_count",
                            "start_token": 3864,
                            "end_token": 3865,
                            "children": [
                                {
                                    "type": "identifier",
                                    "label": "entries_count",
                                    "start_token": 3865,
                                    "end_token": 3865,
                                    "children": []
                                }
                            ]
                        }
                    ]
                }
            ]
        },
        {
            "type": "function_definition",
            "label": "async def create_graph(graph: Graph, user_id: str) -> GraphModel:\n    async with transaction() as tx:\n        await __create_graph(tx, graph, user_id)\n\n    if created_graph := await get_graph(\n        graph.id, graph.version, graph.is_template, user_id=user_id\n    ):\n        return created_graph\n\n    raise ValueError(f\"Created graph {graph.id} v{graph.version} is not in DB\")",
            "start_token": 3869,
            "end_token": 3942,
            "children": [
                {
                    "type": "identifier",
                    "label": "create_graph",
                    "start_token": 3871,
                    "end_token": 3871,
                    "children": []
                },
                {
                    "type": "parameters",
                    "label": "(graph: Graph, user_id: str)",
                    "start_token": 3872,
                    "end_token": 3880,
                    "children": [
                        {
                            "type": "typed_parameter",
                            "label": "graph: Graph",
                            "start_token": 3873,
                            "end_token": 3875,
                            "children": [
                                {
                                    "type": "identifier",
                                    "label": "graph",
                                    "start_token": 3873,
                                    "end_token": 3873,
                                    "children": []
                                },
                                {
                                    "type": "type",
                                    "label": "Graph",
                                    "start_token": 3875,
                                    "end_token": 3875,
                                    "children": [
                                        {
                                            "type": "identifier",
                                            "label": "Graph",
                                            "start_token": 3875,
                                            "end_token": 3875,
                                            "children": []
                                        }
                                    ]
                                }
                            ]
                        },
                        {
                            "type": "typed_parameter",
                            "label": "user_id: str",
                            "start_token": 3877,
                            "end_token": 3879,
                            "children": [
                                {
                                    "type": "identifier",
                                    "label": "user_id",
                                    "start_token": 3877,
                                    "end_token": 3877,
                                    "children": []
                                },
                                {
                                    "type": "type",
                                    "label": "str",
                                    "start_token": 3879,
                                    "end_token": 3879,
                                    "children": [
                                        {
                                            "type": "identifier",
                                            "label": "str",
                                            "start_token": 3879,
                                            "end_token": 3879,
                                            "children": []
                                        }
                                    ]
                                }
                            ]
                        }
                    ]
                },
                {
                    "type": "type",
                    "label": "GraphModel",
                    "start_token": 3883,
                    "end_token": 3883,
                    "children": [
                        {
                            "type": "identifier",
                            "label": "GraphModel",
                            "start_token": 3883,
                            "end_token": 3883,
                            "children": []
                        }
                    ]
                },
                {
                    "type": "block",
                    "label": "async with transaction() as tx:\n        await __create_graph(tx, graph, user_id)\n\n    if created_graph := await get_graph(\n        graph.id, graph.version, graph.is_template, user_id=user_id\n    ):\n        return created_graph\n\n    raise ValueError(f\"Created graph {graph.id} v{graph.version} is not in DB\")",
                    "start_token": 3886,
                    "end_token": 3942,
                    "children": [
                        {
                            "type": "with_statement",
                            "label": "async with transaction() as tx:\n        await __create_graph(tx, graph, user_id)",
                            "start_token": 3886,
                            "end_token": 3903,
                            "children": [
                                {
                                    "type": "with_clause",
                                    "label": "transaction() as tx",
                                    "start_token": 3888,
                                    "end_token": 3892,
                                    "children": [
                                        {
                                            "type": "with_item",
                                            "label": "transaction() as tx",
                                            "start_token": 3888,
                                            "end_token": 3892,
                                            "children": [
                                                {
                                                    "type": "as_pattern",
                                                    "label": "transaction() as tx",
                                                    "start_token": 3888,
                                                    "end_token": 3892,
                                                    "children": [
                                                        {
                                                            "type": "call",
                                                            "label": "transaction()",
                                                            "start_token": 3888,
                                                            "end_token": 3890,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "label": "transaction",
                                                                    "start_token": 3888,
                                                                    "end_token": 3888,
                                                                    "children": []
                                                                },
                                                                {
                                                                    "type": "argument_list",
                                                                    "label": "()",
                                                                    "start_token": 3889,
                                                                    "end_token": 3890,
                                                                    "children": []
                                                                }
                                                            ]
                                                        },
                                                        {
                                                            "type": "as_pattern_target",
                                                            "label": "tx",
                                                            "start_token": 3892,
                                                            "end_token": 3892,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "label": "tx",
                                                                    "start_token": 3892,
                                                                    "end_token": 3892,
                                                                    "children": []
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                }
                                            ]
                                        }
                                    ]
                                },
                                {
                                    "type": "block",
                                    "label": "await __create_graph(tx, graph, user_id)",
                                    "start_token": 3895,
                                    "end_token": 3903,
                                    "children": [
                                        {
                                            "type": "expression_statement",
                                            "label": "await __create_graph(tx, graph, user_id)",
                                            "start_token": 3895,
                                            "end_token": 3903,
                                            "children": [
                                                {
                                                    "type": "await",
                                                    "label": "await __create_graph(tx, graph, user_id)",
                                                    "start_token": 3895,
                                                    "end_token": 3903,
                                                    "children": [
                                                        {
                                                            "type": "call",
                                                            "label": "__create_graph(tx, graph, user_id)",
                                                            "start_token": 3896,
                                                            "end_token": 3903,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "label": "__create_graph",
                                                                    "start_token": 3896,
                                                                    "end_token": 3896,
                                                                    "children": []
                                                                },
                                                                {
                                                                    "type": "argument_list",
                                                                    "label": "(tx, graph, user_id)",
                                                                    "start_token": 3897,
                                                                    "end_token": 3903,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "tx",
                                                                            "start_token": 3898,
                                                                            "end_token": 3898,
                                                                            "children": []
                                                                        },
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "graph",
                                                                            "start_token": 3900,
                                                                            "end_token": 3900,
                                                                            "children": []
                                                                        },
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "user_id",
                                                                            "start_token": 3902,
                                                                            "end_token": 3902,
                                                                            "children": []
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                }
                                            ]
                                        }
                                    ]
                                }
                            ]
                        },
                        {
                            "type": "if_statement",
                            "label": "if created_graph := await get_graph(\n        graph.id, graph.version, graph.is_template, user_id=user_id\n    ):\n        return created_graph",
                            "start_token": 3906,
                            "end_token": 3934,
                            "children": [
                                {
                                    "type": "named_expression",
                                    "label": "created_graph := await get_graph(\n        graph.id, graph.version, graph.is_template, user_id=user_id\n    )",
                                    "start_token": 3907,
                                    "end_token": 3930,
                                    "children": [
                                        {
                                            "type": "identifier",
                                            "label": "created_graph",
                                            "start_token": 3907,
                                            "end_token": 3907,
                                            "children": []
                                        },
                                        {
                                            "type": "await",
                                            "label": "await get_graph(\n        graph.id, graph.version, graph.is_template, user_id=user_id\n    )",
                                            "start_token": 3910,
                                            "end_token": 3930,
                                            "children": [
                                                {
                                                    "type": "call",
                                                    "label": "get_graph(\n        graph.id, graph.version, graph.is_template, user_id=user_id\n    )",
                                                    "start_token": 3911,
                                                    "end_token": 3930,
                                                    "children": [
                                                        {
                                                            "type": "identifier",
                                                            "label": "get_graph",
                                                            "start_token": 3911,
                                                            "end_token": 3911,
                                                            "children": []
                                                        },
                                                        {
                                                            "type": "argument_list",
                                                            "label": "(\n        graph.id, graph.version, graph.is_template, user_id=user_id\n    )",
                                                            "start_token": 3912,
                                                            "end_token": 3930,
                                                            "children": [
                                                                {
                                                                    "type": "attribute",
                                                                    "label": "graph.id",
                                                                    "start_token": 3914,
                                                                    "end_token": 3916,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "graph",
                                                                            "start_token": 3914,
                                                                            "end_token": 3914,
                                                                            "children": []
                                                                        },
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "id",
                                                                            "start_token": 3916,
                                                                            "end_token": 3916,
                                                                            "children": []
                                                                        }
                                                                    ]
                                                                },
                                                                {
                                                                    "type": "attribute",
                                                                    "label": "graph.version",
                                                                    "start_token": 3918,
                                                                    "end_token": 3920,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "graph",
                                                                            "start_token": 3918,
                                                                            "end_token": 3918,
                                                                            "children": []
                                                                        },
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "version",
                                                                            "start_token": 3920,
                                                                            "end_token": 3920,
                                                                            "children": []
                                                                        }
                                                                    ]
                                                                },
                                                                {
                                                                    "type": "attribute",
                                                                    "label": "graph.is_template",
                                                                    "start_token": 3922,
                                                                    "end_token": 3924,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "graph",
                                                                            "start_token": 3922,
                                                                            "end_token": 3922,
                                                                            "children": []
                                                                        },
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "is_template",
                                                                            "start_token": 3924,
                                                                            "end_token": 3924,
                                                                            "children": []
                                                                        }
                                                                    ]
                                                                },
                                                                {
                                                                    "type": "keyword_argument",
                                                                    "label": "user_id=user_id",
                                                                    "start_token": 3926,
                                                                    "end_token": 3928,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "user_id",
                                                                            "start_token": 3926,
                                                                            "end_token": 3926,
                                                                            "children": []
                                                                        },
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "user_id",
                                                                            "start_token": 3928,
                                                                            "end_token": 3928,
                                                                            "children": []
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                }
                                            ]
                                        }
                                    ]
                                },
                                {
                                    "type": "block",
                                    "label": "return created_graph",
                                    "start_token": 3933,
                                    "end_token": 3934,
                                    "children": [
                                        {
                                            "type": "return_statement",
                                            "label": "return created_graph",
                                            "start_token": 3933,
                                            "end_token": 3934,
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "label": "created_graph",
                                                    "start_token": 3934,
                                                    "end_token": 3934,
                                                    "children": []
                                                }
                                            ]
                                        }
                                    ]
                                }
                            ]
                        },
                        {
                            "type": "raise_statement",
                            "label": "raise ValueError(f\"Created graph {graph.id} v{graph.version} is not in DB\")",
                            "start_token": 3937,
                            "end_token": 3942,
                            "children": [
                                {
                                    "type": "call",
                                    "label": "ValueError(f\"Created graph {graph.id} v{graph.version} is not in DB\")",
                                    "start_token": 3938,
                                    "end_token": 3942,
                                    "children": [
                                        {
                                            "type": "identifier",
                                            "label": "ValueError",
                                            "start_token": 3938,
                                            "end_token": 3938,
                                            "children": []
                                        },
                                        {
                                            "type": "argument_list",
                                            "label": "(f\"Created graph {graph.id} v{graph.version} is not in DB\")",
                                            "start_token": 3939,
                                            "end_token": 3942,
                                            "children": [
                                                {
                                                    "type": "string",
                                                    "label": "f\"Created graph {graph.id} v{graph.version} is not in DB\"",
                                                    "start_token": 3940,
                                                    "end_token": 3941,
                                                    "children": [
                                                        {
                                                            "type": "string_start",
                                                            "label": "f\"",
                                                            "start_token": 3940,
                                                            "end_token": 3941,
                                                            "children": []
                                                        },
                                                        {
                                                            "type": "string_content",
                                                            "label": "Created graph ",
                                                            "start_token": 3941,
                                                            "end_token": 3941,
                                                            "children": []
                                                        },
                                                        {
                                                            "type": "interpolation",
                                                            "label": "{graph.id}",
                                                            "start_token": 3941,
                                                            "end_token": 3941,
                                                            "children": [
                                                                {
                                                                    "type": "attribute",
                                                                    "label": "graph.id",
                                                                    "start_token": 3941,
                                                                    "end_token": 3941,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "graph",
                                                                            "start_token": 3941,
                                                                            "end_token": 3941,
                                                                            "children": []
                                                                        },
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "id",
                                                                            "start_token": 3941,
                                                                            "end_token": 3941,
                                                                            "children": []
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        },
                                                        {
                                                            "type": "string_content",
                                                            "label": " v",
                                                            "start_token": 3941,
                                                            "end_token": 3941,
                                                            "children": []
                                                        },
                                                        {
                                                            "type": "interpolation",
                                                            "label": "{graph.version}",
                                                            "start_token": 3941,
                                                            "end_token": 3941,
                                                            "children": [
                                                                {
                                                                    "type": "attribute",
                                                                    "label": "graph.version",
                                                                    "start_token": 3941,
                                                                    "end_token": 3941,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "graph",
                                                                            "start_token": 3941,
                                                                            "end_token": 3941,
                                                                            "children": []
                                                                        },
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "version",
                                                                            "start_token": 3941,
                                                                            "end_token": 3941,
                                                                            "children": []
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        },
                                                        {
                                                            "type": "string_content",
                                                            "label": " is not in DB",
                                                            "start_token": 3941,
                                                            "end_token": 3941,
                                                            "children": []
                                                        },
                                                        {
                                                            "type": "string_end",
                                                            "label": "\"",
                                                            "start_token": 3941,
                                                            "end_token": 3941,
                                                            "children": []
                                                        }
                                                    ]
                                                }
                                            ]
                                        }
                                    ]
                                }
                            ]
                        }
                    ]
                }
            ]
        },
        {
            "type": "function_definition",
            "label": "async def __create_graph(tx, graph: Graph, user_id: str):\n    await AgentGraph.prisma(tx).create(\n        data={\n            \"id\": graph.id,\n            \"version\": graph.version,\n            \"name\": graph.name,\n            \"description\": graph.description,\n            \"isTemplate\": graph.is_template,\n            \"isActive\": graph.is_active,\n            \"userId\": user_id,\n        }\n    )\n\n    await asyncio.gather(\n        *[\n            AgentNode.prisma(tx).create(\n                {\n                    \"id\": node.id,\n                    \"agentBlockId\": node.block_id,\n                    \"agentGraphId\": graph.id,\n                    \"agentGraphVersion\": graph.version,\n                    \"constantInput\": json.dumps(node.input_default),\n                    \"metadata\": json.dumps(node.metadata),\n                }\n            )\n            for node in graph.nodes\n        ]\n    )\n\n    await asyncio.gather(\n        *[\n            AgentNodeLink.prisma(tx).create(\n                {\n                    \"id\": str(uuid.uuid4()),\n                    \"sourceName\": link.source_name,\n                    \"sinkName\": link.sink_name,\n                    \"agentNodeSourceId\": link.source_id,\n                    \"agentNodeSinkId\": link.sink_id,\n                    \"isStatic\": link.is_static,\n                }\n            )\n            for link in graph.links\n        ]\n    )",
            "start_token": 3946,
            "end_token": 4199,
            "children": [
                {
                    "type": "identifier",
                    "label": "__create_graph",
                    "start_token": 3948,
                    "end_token": 3948,
                    "children": []
                },
                {
                    "type": "parameters",
                    "label": "(tx, graph: Graph, user_id: str)",
                    "start_token": 3949,
                    "end_token": 3959,
                    "children": [
                        {
                            "type": "identifier",
                            "label": "tx",
                            "start_token": 3950,
                            "end_token": 3950,
                            "children": []
                        },
                        {
                            "type": "typed_parameter",
                            "label": "graph: Graph",
                            "start_token": 3952,
                            "end_token": 3954,
                            "children": [
                                {
                                    "type": "identifier",
                                    "label": "graph",
                                    "start_token": 3952,
                                    "end_token": 3952,
                                    "children": []
                                },
                                {
                                    "type": "type",
                                    "label": "Graph",
                                    "start_token": 3954,
                                    "end_token": 3954,
                                    "children": [
                                        {
                                            "type": "identifier",
                                            "label": "Graph",
                                            "start_token": 3954,
                                            "end_token": 3954,
                                            "children": []
                                        }
                                    ]
                                }
                            ]
                        },
                        {
                            "type": "typed_parameter",
                            "label": "user_id: str",
                            "start_token": 3956,
                            "end_token": 3958,
                            "children": [
                                {
                                    "type": "identifier",
                                    "label": "user_id",
                                    "start_token": 3956,
                                    "end_token": 3956,
                                    "children": []
                                },
                                {
                                    "type": "type",
                                    "label": "str",
                                    "start_token": 3958,
                                    "end_token": 3958,
                                    "children": [
                                        {
                                            "type": "identifier",
                                            "label": "str",
                                            "start_token": 3958,
                                            "end_token": 3958,
                                            "children": []
                                        }
                                    ]
                                }
                            ]
                        }
                    ]
                },
                {
                    "type": "block",
                    "label": "await AgentGraph.prisma(tx).create(\n        data={\n            \"id\": graph.id,\n            \"version\": graph.version,\n            \"name\": graph.name,\n            \"description\": graph.description,\n            \"isTemplate\": graph.is_template,\n            \"isActive\": graph.is_active,\n            \"userId\": user_id,\n        }\n    )\n\n    await asyncio.gather(\n        *[\n            AgentNode.prisma(tx).create(\n                {\n                    \"id\": node.id,\n                    \"agentBlockId\": node.block_id,\n                    \"agentGraphId\": graph.id,\n                    \"agentGraphVersion\": graph.version,\n                    \"constantInput\": json.dumps(node.input_default),\n                    \"metadata\": json.dumps(node.metadata),\n                }\n            )\n            for node in graph.nodes\n        ]\n    )\n\n    await asyncio.gather(\n        *[\n            AgentNodeLink.prisma(tx).create(\n                {\n                    \"id\": str(uuid.uuid4()),\n                    \"sourceName\": link.source_name,\n                    \"sinkName\": link.sink_name,\n                    \"agentNodeSourceId\": link.source_id,\n                    \"agentNodeSinkId\": link.sink_id,\n                    \"isStatic\": link.is_static,\n                }\n            )\n            for link in graph.links\n        ]\n    )",
                    "start_token": 3962,
                    "end_token": 4199,
                    "children": [
                        {
                            "type": "expression_statement",
                            "label": "await AgentGraph.prisma(tx).create(\n        data={\n            \"id\": graph.id,\n            \"version\": graph.version,\n            \"name\": graph.name,\n            \"description\": graph.description,\n            \"isTemplate\": graph.is_template,\n            \"isActive\": graph.is_active,\n            \"userId\": user_id,\n        }\n    )",
                            "start_token": 3962,
                            "end_token": 4026,
                            "children": [
                                {
                                    "type": "await",
                                    "label": "await AgentGraph.prisma(tx).create(\n        data={\n            \"id\": graph.id,\n            \"version\": graph.version,\n            \"name\": graph.name,\n            \"description\": graph.description,\n            \"isTemplate\": graph.is_template,\n            \"isActive\": graph.is_active,\n            \"userId\": user_id,\n        }\n    )",
                                    "start_token": 3962,
                                    "end_token": 4026,
                                    "children": [
                                        {
                                            "type": "call",
                                            "label": "AgentGraph.prisma(tx).create(\n        data={\n            \"id\": graph.id,\n            \"version\": graph.version,\n            \"name\": graph.name,\n            \"description\": graph.description,\n            \"isTemplate\": graph.is_template,\n            \"isActive\": graph.is_active,\n            \"userId\": user_id,\n        }\n    )",
                                            "start_token": 3963,
                                            "end_token": 4026,
                                            "children": [
                                                {
                                                    "type": "attribute",
                                                    "label": "AgentGraph.prisma(tx).create",
                                                    "start_token": 3963,
                                                    "end_token": 3970,
                                                    "children": [
                                                        {
                                                            "type": "call",
                                                            "label": "AgentGraph.prisma(tx)",
                                                            "start_token": 3963,
                                                            "end_token": 3968,
                                                            "children": [
                                                                {
                                                                    "type": "attribute",
                                                                    "label": "AgentGraph.prisma",
                                                                    "start_token": 3963,
                                                                    "end_token": 3965,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "AgentGraph",
                                                                            "start_token": 3963,
                                                                            "end_token": 3963,
                                                                            "children": []
                                                                        },
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "prisma",
                                                                            "start_token": 3965,
                                                                            "end_token": 3965,
                                                                            "children": []
                                                                        }
                                                                    ]
                                                                },
                                                                {
                                                                    "type": "argument_list",
                                                                    "label": "(tx)",
                                                                    "start_token": 3966,
                                                                    "end_token": 3968,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "tx",
                                                                            "start_token": 3967,
                                                                            "end_token": 3967,
                                                                            "children": []
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        },
                                                        {
                                                            "type": "identifier",
                                                            "label": "create",
                                                            "start_token": 3970,
                                                            "end_token": 3970,
                                                            "children": []
                                                        }
                                                    ]
                                                },
                                                {
                                                    "type": "argument_list",
                                                    "label": "(\n        data={\n            \"id\": graph.id,\n            \"version\": graph.version,\n            \"name\": graph.name,\n            \"description\": graph.description,\n            \"isTemplate\": graph.is_template,\n            \"isActive\": graph.is_active,\n            \"userId\": user_id,\n        }\n    )",
                                                    "start_token": 3971,
                                                    "end_token": 4026,
                                                    "children": [
                                                        {
                                                            "type": "keyword_argument",
                                                            "label": "data={\n            \"id\": graph.id,\n            \"version\": graph.version,\n            \"name\": graph.name,\n            \"description\": graph.description,\n            \"isTemplate\": graph.is_template,\n            \"isActive\": graph.is_active,\n            \"userId\": user_id,\n        }",
                                                            "start_token": 3973,
                                                            "end_token": 4024,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "label": "data",
                                                                    "start_token": 3973,
                                                                    "end_token": 3973,
                                                                    "children": []
                                                                },
                                                                {
                                                                    "type": "dictionary",
                                                                    "label": "{\n            \"id\": graph.id,\n            \"version\": graph.version,\n            \"name\": graph.name,\n            \"description\": graph.description,\n            \"isTemplate\": graph.is_template,\n            \"isActive\": graph.is_active,\n            \"userId\": user_id,\n        }",
                                                                    "start_token": 3975,
                                                                    "end_token": 4024,
                                                                    "children": [
                                                                        {
                                                                            "type": "pair",
                                                                            "label": "\"id\": graph.id",
                                                                            "start_token": 3977,
                                                                            "end_token": 3981,
                                                                            "children": [
                                                                                {
                                                                                    "type": "string",
                                                                                    "label": "\"id\"",
                                                                                    "start_token": 3977,
                                                                                    "end_token": 3977,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "string_start",
                                                                                            "label": "\"",
                                                                                            "start_token": 3977,
                                                                                            "end_token": 3977,
                                                                                            "children": []
                                                                                        },
                                                                                        {
                                                                                            "type": "string_content",
                                                                                            "label": "id",
                                                                                            "start_token": 3977,
                                                                                            "end_token": 3977,
                                                                                            "children": []
                                                                                        },
                                                                                        {
                                                                                            "type": "string_end",
                                                                                            "label": "\"",
                                                                                            "start_token": 3977,
                                                                                            "end_token": 3977,
                                                                                            "children": []
                                                                                        }
                                                                                    ]
                                                                                },
                                                                                {
                                                                                    "type": "attribute",
                                                                                    "label": "graph.id",
                                                                                    "start_token": 3979,
                                                                                    "end_token": 3981,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "label": "graph",
                                                                                            "start_token": 3979,
                                                                                            "end_token": 3979,
                                                                                            "children": []
                                                                                        },
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "label": "id",
                                                                                            "start_token": 3981,
                                                                                            "end_token": 3981,
                                                                                            "children": []
                                                                                        }
                                                                                    ]
                                                                                }
                                                                            ]
                                                                        },
                                                                        {
                                                                            "type": "pair",
                                                                            "label": "\"version\": graph.version",
                                                                            "start_token": 3984,
                                                                            "end_token": 3988,
                                                                            "children": [
                                                                                {
                                                                                    "type": "string",
                                                                                    "label": "\"version\"",
                                                                                    "start_token": 3984,
                                                                                    "end_token": 3984,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "string_start",
                                                                                            "label": "\"",
                                                                                            "start_token": 3984,
                                                                                            "end_token": 3984,
                                                                                            "children": []
                                                                                        },
                                                                                        {
                                                                                            "type": "string_content",
                                                                                            "label": "version",
                                                                                            "start_token": 3984,
                                                                                            "end_token": 3984,
                                                                                            "children": []
                                                                                        },
                                                                                        {
                                                                                            "type": "string_end",
                                                                                            "label": "\"",
                                                                                            "start_token": 3984,
                                                                                            "end_token": 3984,
                                                                                            "children": []
                                                                                        }
                                                                                    ]
                                                                                },
                                                                                {
                                                                                    "type": "attribute",
                                                                                    "label": "graph.version",
                                                                                    "start_token": 3986,
                                                                                    "end_token": 3988,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "label": "graph",
                                                                                            "start_token": 3986,
                                                                                            "end_token": 3986,
                                                                                            "children": []
                                                                                        },
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "label": "version",
                                                                                            "start_token": 3988,
                                                                                            "end_token": 3988,
                                                                                            "children": []
                                                                                        }
                                                                                    ]
                                                                                }
                                                                            ]
                                                                        },
                                                                        {
                                                                            "type": "pair",
                                                                            "label": "\"name\": graph.name",
                                                                            "start_token": 3991,
                                                                            "end_token": 3995,
                                                                            "children": [
                                                                                {
                                                                                    "type": "string",
                                                                                    "label": "\"name\"",
                                                                                    "start_token": 3991,
                                                                                    "end_token": 3991,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "string_start",
                                                                                            "label": "\"",
                                                                                            "start_token": 3991,
                                                                                            "end_token": 3991,
                                                                                            "children": []
                                                                                        },
                                                                                        {
                                                                                            "type": "string_content",
                                                                                            "label": "name",
                                                                                            "start_token": 3991,
                                                                                            "end_token": 3991,
                                                                                            "children": []
                                                                                        },
                                                                                        {
                                                                                            "type": "string_end",
                                                                                            "label": "\"",
                                                                                            "start_token": 3991,
                                                                                            "end_token": 3991,
                                                                                            "children": []
                                                                                        }
                                                                                    ]
                                                                                },
                                                                                {
                                                                                    "type": "attribute",
                                                                                    "label": "graph.name",
                                                                                    "start_token": 3993,
                                                                                    "end_token": 3995,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "label": "graph",
                                                                                            "start_token": 3993,
                                                                                            "end_token": 3993,
                                                                                            "children": []
                                                                                        },
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "label": "name",
                                                                                            "start_token": 3995,
                                                                                            "end_token": 3995,
                                                                                            "children": []
                                                                                        }
                                                                                    ]
                                                                                }
                                                                            ]
                                                                        },
                                                                        {
                                                                            "type": "pair",
                                                                            "label": "\"description\": graph.description",
                                                                            "start_token": 3998,
                                                                            "end_token": 4002,
                                                                            "children": [
                                                                                {
                                                                                    "type": "string",
                                                                                    "label": "\"description\"",
                                                                                    "start_token": 3998,
                                                                                    "end_token": 3998,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "string_start",
                                                                                            "label": "\"",
                                                                                            "start_token": 3998,
                                                                                            "end_token": 3998,
                                                                                            "children": []
                                                                                        },
                                                                                        {
                                                                                            "type": "string_content",
                                                                                            "label": "description",
                                                                                            "start_token": 3998,
                                                                                            "end_token": 3998,
                                                                                            "children": []
                                                                                        },
                                                                                        {
                                                                                            "type": "string_end",
                                                                                            "label": "\"",
                                                                                            "start_token": 3998,
                                                                                            "end_token": 3998,
                                                                                            "children": []
                                                                                        }
                                                                                    ]
                                                                                },
                                                                                {
                                                                                    "type": "attribute",
                                                                                    "label": "graph.description",
                                                                                    "start_token": 4000,
                                                                                    "end_token": 4002,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "label": "graph",
                                                                                            "start_token": 4000,
                                                                                            "end_token": 4000,
                                                                                            "children": []
                                                                                        },
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "label": "description",
                                                                                            "start_token": 4002,
                                                                                            "end_token": 4002,
                                                                                            "children": []
                                                                                        }
                                                                                    ]
                                                                                }
                                                                            ]
                                                                        },
                                                                        {
                                                                            "type": "pair",
                                                                            "label": "\"isTemplate\": graph.is_template",
                                                                            "start_token": 4005,
                                                                            "end_token": 4009,
                                                                            "children": [
                                                                                {
                                                                                    "type": "string",
                                                                                    "label": "\"isTemplate\"",
                                                                                    "start_token": 4005,
                                                                                    "end_token": 4005,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "string_start",
                                                                                            "label": "\"",
                                                                                            "start_token": 4005,
                                                                                            "end_token": 4005,
                                                                                            "children": []
                                                                                        },
                                                                                        {
                                                                                            "type": "string_content",
                                                                                            "label": "isTemplate",
                                                                                            "start_token": 4005,
                                                                                            "end_token": 4005,
                                                                                            "children": []
                                                                                        },
                                                                                        {
                                                                                            "type": "string_end",
                                                                                            "label": "\"",
                                                                                            "start_token": 4005,
                                                                                            "end_token": 4005,
                                                                                            "children": []
                                                                                        }
                                                                                    ]
                                                                                },
                                                                                {
                                                                                    "type": "attribute",
                                                                                    "label": "graph.is_template",
                                                                                    "start_token": 4007,
                                                                                    "end_token": 4009,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "label": "graph",
                                                                                            "start_token": 4007,
                                                                                            "end_token": 4007,
                                                                                            "children": []
                                                                                        },
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "label": "is_template",
                                                                                            "start_token": 4009,
                                                                                            "end_token": 4009,
                                                                                            "children": []
                                                                                        }
                                                                                    ]
                                                                                }
                                                                            ]
                                                                        },
                                                                        {
                                                                            "type": "pair",
                                                                            "label": "\"isActive\": graph.is_active",
                                                                            "start_token": 4012,
                                                                            "end_token": 4016,
                                                                            "children": [
                                                                                {
                                                                                    "type": "string",
                                                                                    "label": "\"isActive\"",
                                                                                    "start_token": 4012,
                                                                                    "end_token": 4012,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "string_start",
                                                                                            "label": "\"",
                                                                                            "start_token": 4012,
                                                                                            "end_token": 4012,
                                                                                            "children": []
                                                                                        },
                                                                                        {
                                                                                            "type": "string_content",
                                                                                            "label": "isActive",
                                                                                            "start_token": 4012,
                                                                                            "end_token": 4012,
                                                                                            "children": []
                                                                                        },
                                                                                        {
                                                                                            "type": "string_end",
                                                                                            "label": "\"",
                                                                                            "start_token": 4012,
                                                                                            "end_token": 4012,
                                                                                            "children": []
                                                                                        }
                                                                                    ]
                                                                                },
                                                                                {
                                                                                    "type": "attribute",
                                                                                    "label": "graph.is_active",
                                                                                    "start_token": 4014,
                                                                                    "end_token": 4016,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "label": "graph",
                                                                                            "start_token": 4014,
                                                                                            "end_token": 4014,
                                                                                            "children": []
                                                                                        },
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "label": "is_active",
                                                                                            "start_token": 4016,
                                                                                            "end_token": 4016,
                                                                                            "children": []
                                                                                        }
                                                                                    ]
                                                                                }
                                                                            ]
                                                                        },
                                                                        {
                                                                            "type": "pair",
                                                                            "label": "\"userId\": user_id",
                                                                            "start_token": 4019,
                                                                            "end_token": 4021,
                                                                            "children": [
                                                                                {
                                                                                    "type": "string",
                                                                                    "label": "\"userId\"",
                                                                                    "start_token": 4019,
                                                                                    "end_token": 4019,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "string_start",
                                                                                            "label": "\"",
                                                                                            "start_token": 4019,
                                                                                            "end_token": 4019,
                                                                                            "children": []
                                                                                        },
                                                                                        {
                                                                                            "type": "string_content",
                                                                                            "label": "userId",
                                                                                            "start_token": 4019,
                                                                                            "end_token": 4019,
                                                                                            "children": []
                                                                                        },
                                                                                        {
                                                                                            "type": "string_end",
                                                                                            "label": "\"",
                                                                                            "start_token": 4019,
                                                                                            "end_token": 4019,
                                                                                            "children": []
                                                                                        }
                                                                                    ]
                                                                                },
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "user_id",
                                                                                    "start_token": 4021,
                                                                                    "end_token": 4021,
                                                                                    "children": []
                                                                                }
                                                                            ]
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                }
                                            ]
                                        }
                                    ]
                                }
                            ]
                        },
                        {
                            "type": "expression_statement",
                            "label": "await asyncio.gather(\n        *[\n            AgentNode.prisma(tx).create(\n                {\n                    \"id\": node.id,\n                    \"agentBlockId\": node.block_id,\n                    \"agentGraphId\": graph.id,\n                    \"agentGraphVersion\": graph.version,\n                    \"constantInput\": json.dumps(node.input_default),\n                    \"metadata\": json.dumps(node.metadata),\n                }\n            )\n            for node in graph.nodes\n        ]\n    )",
                            "start_token": 4029,
                            "end_token": 4115,
                            "children": [
                                {
                                    "type": "await",
                                    "label": "await asyncio.gather(\n        *[\n            AgentNode.prisma(tx).create(\n                {\n                    \"id\": node.id,\n                    \"agentBlockId\": node.block_id,\n                    \"agentGraphId\": graph.id,\n                    \"agentGraphVersion\": graph.version,\n                    \"constantInput\": json.dumps(node.input_default),\n                    \"metadata\": json.dumps(node.metadata),\n                }\n            )\n            for node in graph.nodes\n        ]\n    )",
                                    "start_token": 4029,
                                    "end_token": 4115,
                                    "children": [
                                        {
                                            "type": "call",
                                            "label": "asyncio.gather(\n        *[\n            AgentNode.prisma(tx).create(\n                {\n                    \"id\": node.id,\n                    \"agentBlockId\": node.block_id,\n                    \"agentGraphId\": graph.id,\n                    \"agentGraphVersion\": graph.version,\n                    \"constantInput\": json.dumps(node.input_default),\n                    \"metadata\": json.dumps(node.metadata),\n                }\n            )\n            for node in graph.nodes\n        ]\n    )",
                                            "start_token": 4030,
                                            "end_token": 4115,
                                            "children": [
                                                {
                                                    "type": "attribute",
                                                    "label": "asyncio.gather",
                                                    "start_token": 4030,
                                                    "end_token": 4032,
                                                    "children": [
                                                        {
                                                            "type": "identifier",
                                                            "label": "asyncio",
                                                            "start_token": 4030,
                                                            "end_token": 4030,
                                                            "children": []
                                                        },
                                                        {
                                                            "type": "identifier",
                                                            "label": "gather",
                                                            "start_token": 4032,
                                                            "end_token": 4032,
                                                            "children": []
                                                        }
                                                    ]
                                                },
                                                {
                                                    "type": "argument_list",
                                                    "label": "(\n        *[\n            AgentNode.prisma(tx).create(\n                {\n                    \"id\": node.id,\n                    \"agentBlockId\": node.block_id,\n                    \"agentGraphId\": graph.id,\n                    \"agentGraphVersion\": graph.version,\n                    \"constantInput\": json.dumps(node.input_default),\n                    \"metadata\": json.dumps(node.metadata),\n                }\n            )\n            for node in graph.nodes\n        ]\n    )",
                                                    "start_token": 4033,
                                                    "end_token": 4115,
                                                    "children": [
                                                        {
                                                            "type": "list_splat",
                                                            "label": "*[\n            AgentNode.prisma(tx).create(\n                {\n                    \"id\": node.id,\n                    \"agentBlockId\": node.block_id,\n                    \"agentGraphId\": graph.id,\n                    \"agentGraphVersion\": graph.version,\n                    \"constantInput\": json.dumps(node.input_default),\n                    \"metadata\": json.dumps(node.metadata),\n                }\n            )\n            for node in graph.nodes\n        ]",
                                                            "start_token": 4035,
                                                            "end_token": 4113,
                                                            "children": [
                                                                {
                                                                    "type": "list_comprehension",
                                                                    "label": "[\n            AgentNode.prisma(tx).create(\n                {\n                    \"id\": node.id,\n                    \"agentBlockId\": node.block_id,\n                    \"agentGraphId\": graph.id,\n                    \"agentGraphVersion\": graph.version,\n                    \"constantInput\": json.dumps(node.input_default),\n                    \"metadata\": json.dumps(node.metadata),\n                }\n            )\n            for node in graph.nodes\n        ]",
                                                                    "start_token": 4036,
                                                                    "end_token": 4113,
                                                                    "children": [
                                                                        {
                                                                            "type": "call",
                                                                            "label": "AgentNode.prisma(tx).create(\n                {\n                    \"id\": node.id,\n                    \"agentBlockId\": node.block_id,\n                    \"agentGraphId\": graph.id,\n                    \"agentGraphVersion\": graph.version,\n                    \"constantInput\": json.dumps(node.input_default),\n                    \"metadata\": json.dumps(node.metadata),\n                }\n            )",
                                                                            "start_token": 4038,
                                                                            "end_token": 4104,
                                                                            "children": [
                                                                                {
                                                                                    "type": "attribute",
                                                                                    "label": "AgentNode.prisma(tx).create",
                                                                                    "start_token": 4038,
                                                                                    "end_token": 4045,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "call",
                                                                                            "label": "AgentNode.prisma(tx)",
                                                                                            "start_token": 4038,
                                                                                            "end_token": 4043,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "attribute",
                                                                                                    "label": "AgentNode.prisma",
                                                                                                    "start_token": 4038,
                                                                                                    "end_token": 4040,
                                                                                                    "children": [
                                                                                                        {
                                                                                                            "type": "identifier",
                                                                                                            "label": "AgentNode",
                                                                                                            "start_token": 4038,
                                                                                                            "end_token": 4038,
                                                                                                            "children": []
                                                                                                        },
                                                                                                        {
                                                                                                            "type": "identifier",
                                                                                                            "label": "prisma",
                                                                                                            "start_token": 4040,
                                                                                                            "end_token": 4040,
                                                                                                            "children": []
                                                                                                        }
                                                                                                    ]
                                                                                                },
                                                                                                {
                                                                                                    "type": "argument_list",
                                                                                                    "label": "(tx)",
                                                                                                    "start_token": 4041,
                                                                                                    "end_token": 4043,
                                                                                                    "children": [
                                                                                                        {
                                                                                                            "type": "identifier",
                                                                                                            "label": "tx",
                                                                                                            "start_token": 4042,
                                                                                                            "end_token": 4042,
                                                                                                            "children": []
                                                                                                        }
                                                                                                    ]
                                                                                                }
                                                                                            ]
                                                                                        },
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "label": "create",
                                                                                            "start_token": 4045,
                                                                                            "end_token": 4045,
                                                                                            "children": []
                                                                                        }
                                                                                    ]
                                                                                },
                                                                                {
                                                                                    "type": "argument_list",
                                                                                    "label": "(\n                {\n                    \"id\": node.id,\n                    \"agentBlockId\": node.block_id,\n                    \"agentGraphId\": graph.id,\n                    \"agentGraphVersion\": graph.version,\n                    \"constantInput\": json.dumps(node.input_default),\n                    \"metadata\": json.dumps(node.metadata),\n                }\n            )",
                                                                                    "start_token": 4046,
                                                                                    "end_token": 4104,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "dictionary",
                                                                                            "label": "{\n                    \"id\": node.id,\n                    \"agentBlockId\": node.block_id,\n                    \"agentGraphId\": graph.id,\n                    \"agentGraphVersion\": graph.version,\n                    \"constantInput\": json.dumps(node.input_default),\n                    \"metadata\": json.dumps(node.metadata),\n                }",
                                                                                            "start_token": 4048,
                                                                                            "end_token": 4102,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "pair",
                                                                                                    "label": "\"id\": node.id",
                                                                                                    "start_token": 4050,
                                                                                                    "end_token": 4054,
                                                                                                    "children": [
                                                                                                        {
                                                                                                            "type": "string",
                                                                                                            "label": "\"id\"",
                                                                                                            "start_token": 4050,
                                                                                                            "end_token": 4050,
                                                                                                            "children": [
                                                                                                                {
                                                                                                                    "type": "string_start",
                                                                                                                    "label": "\"",
                                                                                                                    "start_token": 4050,
                                                                                                                    "end_token": 4050,
                                                                                                                    "children": []
                                                                                                                },
                                                                                                                {
                                                                                                                    "type": "string_content",
                                                                                                                    "label": "id",
                                                                                                                    "start_token": 4050,
                                                                                                                    "end_token": 4050,
                                                                                                                    "children": []
                                                                                                                },
                                                                                                                {
                                                                                                                    "type": "string_end",
                                                                                                                    "label": "\"",
                                                                                                                    "start_token": 4050,
                                                                                                                    "end_token": 4050,
                                                                                                                    "children": []
                                                                                                                }
                                                                                                            ]
                                                                                                        },
                                                                                                        {
                                                                                                            "type": "attribute",
                                                                                                            "label": "node.id",
                                                                                                            "start_token": 4052,
                                                                                                            "end_token": 4054,
                                                                                                            "children": [
                                                                                                                {
                                                                                                                    "type": "identifier",
                                                                                                                    "label": "node",
                                                                                                                    "start_token": 4052,
                                                                                                                    "end_token": 4052,
                                                                                                                    "children": []
                                                                                                                },
                                                                                                                {
                                                                                                                    "type": "identifier",
                                                                                                                    "label": "id",
                                                                                                                    "start_token": 4054,
                                                                                                                    "end_token": 4054,
                                                                                                                    "children": []
                                                                                                                }
                                                                                                            ]
                                                                                                        }
                                                                                                    ]
                                                                                                },
                                                                                                {
                                                                                                    "type": "pair",
                                                                                                    "label": "\"agentBlockId\": node.block_id",
                                                                                                    "start_token": 4057,
                                                                                                    "end_token": 4061,
                                                                                                    "children": [
                                                                                                        {
                                                                                                            "type": "string",
                                                                                                            "label": "\"agentBlockId\"",
                                                                                                            "start_token": 4057,
                                                                                                            "end_token": 4057,
                                                                                                            "children": [
                                                                                                                {
                                                                                                                    "type": "string_start",
                                                                                                                    "label": "\"",
                                                                                                                    "start_token": 4057,
                                                                                                                    "end_token": 4057,
                                                                                                                    "children": []
                                                                                                                },
                                                                                                                {
                                                                                                                    "type": "string_content",
                                                                                                                    "label": "agentBlockId",
                                                                                                                    "start_token": 4057,
                                                                                                                    "end_token": 4057,
                                                                                                                    "children": []
                                                                                                                },
                                                                                                                {
                                                                                                                    "type": "string_end",
                                                                                                                    "label": "\"",
                                                                                                                    "start_token": 4057,
                                                                                                                    "end_token": 4057,
                                                                                                                    "children": []
                                                                                                                }
                                                                                                            ]
                                                                                                        },
                                                                                                        {
                                                                                                            "type": "attribute",
                                                                                                            "label": "node.block_id",
                                                                                                            "start_token": 4059,
                                                                                                            "end_token": 4061,
                                                                                                            "children": [
                                                                                                                {
                                                                                                                    "type": "identifier",
                                                                                                                    "label": "node",
                                                                                                                    "start_token": 4059,
                                                                                                                    "end_token": 4059,
                                                                                                                    "children": []
                                                                                                                },
                                                                                                                {
                                                                                                                    "type": "identifier",
                                                                                                                    "label": "block_id",
                                                                                                                    "start_token": 4061,
                                                                                                                    "end_token": 4061,
                                                                                                                    "children": []
                                                                                                                }
                                                                                                            ]
                                                                                                        }
                                                                                                    ]
                                                                                                },
                                                                                                {
                                                                                                    "type": "pair",
                                                                                                    "label": "\"agentGraphId\": graph.id",
                                                                                                    "start_token": 4064,
                                                                                                    "end_token": 4068,
                                                                                                    "children": [
                                                                                                        {
                                                                                                            "type": "string",
                                                                                                            "label": "\"agentGraphId\"",
                                                                                                            "start_token": 4064,
                                                                                                            "end_token": 4064,
                                                                                                            "children": [
                                                                                                                {
                                                                                                                    "type": "string_start",
                                                                                                                    "label": "\"",
                                                                                                                    "start_token": 4064,
                                                                                                                    "end_token": 4064,
                                                                                                                    "children": []
                                                                                                                },
                                                                                                                {
                                                                                                                    "type": "string_content",
                                                                                                                    "label": "agentGraphId",
                                                                                                                    "start_token": 4064,
                                                                                                                    "end_token": 4064,
                                                                                                                    "children": []
                                                                                                                },
                                                                                                                {
                                                                                                                    "type": "string_end",
                                                                                                                    "label": "\"",
                                                                                                                    "start_token": 4064,
                                                                                                                    "end_token": 4064,
                                                                                                                    "children": []
                                                                                                                }
                                                                                                            ]
                                                                                                        },
                                                                                                        {
                                                                                                            "type": "attribute",
                                                                                                            "label": "graph.id",
                                                                                                            "start_token": 4066,
                                                                                                            "end_token": 4068,
                                                                                                            "children": [
                                                                                                                {
                                                                                                                    "type": "identifier",
                                                                                                                    "label": "graph",
                                                                                                                    "start_token": 4066,
                                                                                                                    "end_token": 4066,
                                                                                                                    "children": []
                                                                                                                },
                                                                                                                {
                                                                                                                    "type": "identifier",
                                                                                                                    "label": "id",
                                                                                                                    "start_token": 4068,
                                                                                                                    "end_token": 4068,
                                                                                                                    "children": []
                                                                                                                }
                                                                                                            ]
                                                                                                        }
                                                                                                    ]
                                                                                                },
                                                                                                {
                                                                                                    "type": "pair",
                                                                                                    "label": "\"agentGraphVersion\": graph.version",
                                                                                                    "start_token": 4071,
                                                                                                    "end_token": 4075,
                                                                                                    "children": [
                                                                                                        {
                                                                                                            "type": "string",
                                                                                                            "label": "\"agentGraphVersion\"",
                                                                                                            "start_token": 4071,
                                                                                                            "end_token": 4071,
                                                                                                            "children": [
                                                                                                                {
                                                                                                                    "type": "string_start",
                                                                                                                    "label": "\"",
                                                                                                                    "start_token": 4071,
                                                                                                                    "end_token": 4071,
                                                                                                                    "children": []
                                                                                                                },
                                                                                                                {
                                                                                                                    "type": "string_content",
                                                                                                                    "label": "agentGraphVersion",
                                                                                                                    "start_token": 4071,
                                                                                                                    "end_token": 4071,
                                                                                                                    "children": []
                                                                                                                },
                                                                                                                {
                                                                                                                    "type": "string_end",
                                                                                                                    "label": "\"",
                                                                                                                    "start_token": 4071,
                                                                                                                    "end_token": 4071,
                                                                                                                    "children": []
                                                                                                                }
                                                                                                            ]
                                                                                                        },
                                                                                                        {
                                                                                                            "type": "attribute",
                                                                                                            "label": "graph.version",
                                                                                                            "start_token": 4073,
                                                                                                            "end_token": 4075,
                                                                                                            "children": [
                                                                                                                {
                                                                                                                    "type": "identifier",
                                                                                                                    "label": "graph",
                                                                                                                    "start_token": 4073,
                                                                                                                    "end_token": 4073,
                                                                                                                    "children": []
                                                                                                                },
                                                                                                                {
                                                                                                                    "type": "identifier",
                                                                                                                    "label": "version",
                                                                                                                    "start_token": 4075,
                                                                                                                    "end_token": 4075,
                                                                                                                    "children": []
                                                                                                                }
                                                                                                            ]
                                                                                                        }
                                                                                                    ]
                                                                                                },
                                                                                                {
                                                                                                    "type": "pair",
                                                                                                    "label": "\"constantInput\": json.dumps(node.input_default)",
                                                                                                    "start_token": 4078,
                                                                                                    "end_token": 4087,
                                                                                                    "children": [
                                                                                                        {
                                                                                                            "type": "string",
                                                                                                            "label": "\"constantInput\"",
                                                                                                            "start_token": 4078,
                                                                                                            "end_token": 4078,
                                                                                                            "children": [
                                                                                                                {
                                                                                                                    "type": "string_start",
                                                                                                                    "label": "\"",
                                                                                                                    "start_token": 4078,
                                                                                                                    "end_token": 4078,
                                                                                                                    "children": []
                                                                                                                },
                                                                                                                {
                                                                                                                    "type": "string_content",
                                                                                                                    "label": "constantInput",
                                                                                                                    "start_token": 4078,
                                                                                                                    "end_token": 4078,
                                                                                                                    "children": []
                                                                                                                },
                                                                                                                {
                                                                                                                    "type": "string_end",
                                                                                                                    "label": "\"",
                                                                                                                    "start_token": 4078,
                                                                                                                    "end_token": 4078,
                                                                                                                    "children": []
                                                                                                                }
                                                                                                            ]
                                                                                                        },
                                                                                                        {
                                                                                                            "type": "call",
                                                                                                            "label": "json.dumps(node.input_default)",
                                                                                                            "start_token": 4080,
                                                                                                            "end_token": 4087,
                                                                                                            "children": [
                                                                                                                {
                                                                                                                    "type": "attribute",
                                                                                                                    "label": "json.dumps",
                                                                                                                    "start_token": 4080,
                                                                                                                    "end_token": 4082,
                                                                                                                    "children": [
                                                                                                                        {
                                                                                                                            "type": "identifier",
                                                                                                                            "label": "json",
                                                                                                                            "start_token": 4080,
                                                                                                                            "end_token": 4080,
                                                                                                                            "children": []
                                                                                                                        },
                                                                                                                        {
                                                                                                                            "type": "identifier",
                                                                                                                            "label": "dumps",
                                                                                                                            "start_token": 4082,
                                                                                                                            "end_token": 4082,
                                                                                                                            "children": []
                                                                                                                        }
                                                                                                                    ]
                                                                                                                },
                                                                                                                {
                                                                                                                    "type": "argument_list",
                                                                                                                    "label": "(node.input_default)",
                                                                                                                    "start_token": 4083,
                                                                                                                    "end_token": 4087,
                                                                                                                    "children": [
                                                                                                                        {
                                                                                                                            "type": "attribute",
                                                                                                                            "label": "node.input_default",
                                                                                                                            "start_token": 4084,
                                                                                                                            "end_token": 4086,
                                                                                                                            "children": [
                                                                                                                                {
                                                                                                                                    "type": "identifier",
                                                                                                                                    "label": "node",
                                                                                                                                    "start_token": 4084,
                                                                                                                                    "end_token": 4084,
                                                                                                                                    "children": []
                                                                                                                                },
                                                                                                                                {
                                                                                                                                    "type": "identifier",
                                                                                                                                    "label": "input_default",
                                                                                                                                    "start_token": 4086,
                                                                                                                                    "end_token": 4086,
                                                                                                                                    "children": []
                                                                                                                                }
                                                                                                                            ]
                                                                                                                        }
                                                                                                                    ]
                                                                                                                }
                                                                                                            ]
                                                                                                        }
                                                                                                    ]
                                                                                                },
                                                                                                {
                                                                                                    "type": "pair",
                                                                                                    "label": "\"metadata\": json.dumps(node.metadata)",
                                                                                                    "start_token": 4090,
                                                                                                    "end_token": 4099,
                                                                                                    "children": [
                                                                                                        {
                                                                                                            "type": "string",
                                                                                                            "label": "\"metadata\"",
                                                                                                            "start_token": 4090,
                                                                                                            "end_token": 4090,
                                                                                                            "children": [
                                                                                                                {
                                                                                                                    "type": "string_start",
                                                                                                                    "label": "\"",
                                                                                                                    "start_token": 4090,
                                                                                                                    "end_token": 4090,
                                                                                                                    "children": []
                                                                                                                },
                                                                                                                {
                                                                                                                    "type": "string_content",
                                                                                                                    "label": "metadata",
                                                                                                                    "start_token": 4090,
                                                                                                                    "end_token": 4090,
                                                                                                                    "children": []
                                                                                                                },
                                                                                                                {
                                                                                                                    "type": "string_end",
                                                                                                                    "label": "\"",
                                                                                                                    "start_token": 4090,
                                                                                                                    "end_token": 4090,
                                                                                                                    "children": []
                                                                                                                }
                                                                                                            ]
                                                                                                        },
                                                                                                        {
                                                                                                            "type": "call",
                                                                                                            "label": "json.dumps(node.metadata)",
                                                                                                            "start_token": 4092,
                                                                                                            "end_token": 4099,
                                                                                                            "children": [
                                                                                                                {
                                                                                                                    "type": "attribute",
                                                                                                                    "label": "json.dumps",
                                                                                                                    "start_token": 4092,
                                                                                                                    "end_token": 4094,
                                                                                                                    "children": [
                                                                                                                        {
                                                                                                                            "type": "identifier",
                                                                                                                            "label": "json",
                                                                                                                            "start_token": 4092,
                                                                                                                            "end_token": 4092,
                                                                                                                            "children": []
                                                                                                                        },
                                                                                                                        {
                                                                                                                            "type": "identifier",
                                                                                                                            "label": "dumps",
                                                                                                                            "start_token": 4094,
                                                                                                                            "end_token": 4094,
                                                                                                                            "children": []
                                                                                                                        }
                                                                                                                    ]
                                                                                                                },
                                                                                                                {
                                                                                                                    "type": "argument_list",
                                                                                                                    "label": "(node.metadata)",
                                                                                                                    "start_token": 4095,
                                                                                                                    "end_token": 4099,
                                                                                                                    "children": [
                                                                                                                        {
                                                                                                                            "type": "attribute",
                                                                                                                            "label": "node.metadata",
                                                                                                                            "start_token": 4096,
                                                                                                                            "end_token": 4098,
                                                                                                                            "children": [
                                                                                                                                {
                                                                                                                                    "type": "identifier",
                                                                                                                                    "label": "node",
                                                                                                                                    "start_token": 4096,
                                                                                                                                    "end_token": 4096,
                                                                                                                                    "children": []
                                                                                                                                },
                                                                                                                                {
                                                                                                                                    "type": "identifier",
                                                                                                                                    "label": "metadata",
                                                                                                                                    "start_token": 4098,
                                                                                                                                    "end_token": 4098,
                                                                                                                                    "children": []
                                                                                                                                }
                                                                                                                            ]
                                                                                                                        }
                                                                                                                    ]
                                                                                                                }
                                                                                                            ]
                                                                                                        }
                                                                                                    ]
                                                                                                }
                                                                                            ]
                                                                                        }
                                                                                    ]
                                                                                }
                                                                            ]
                                                                        },
                                                                        {
                                                                            "type": "for_in_clause",
                                                                            "label": "for node in graph.nodes",
                                                                            "start_token": 4106,
                                                                            "end_token": 4111,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "node",
                                                                                    "start_token": 4107,
                                                                                    "end_token": 4107,
                                                                                    "children": []
                                                                                },
                                                                                {
                                                                                    "type": "attribute",
                                                                                    "label": "graph.nodes",
                                                                                    "start_token": 4109,
                                                                                    "end_token": 4111,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "label": "graph",
                                                                                            "start_token": 4109,
                                                                                            "end_token": 4109,
                                                                                            "children": []
                                                                                        },
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "label": "nodes",
                                                                                            "start_token": 4111,
                                                                                            "end_token": 4111,
                                                                                            "children": []
                                                                                        }
                                                                                    ]
                                                                                }
                                                                            ]
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                }
                                            ]
                                        }
                                    ]
                                }
                            ]
                        },
                        {
                            "type": "expression_statement",
                            "label": "await asyncio.gather(\n        *[\n            AgentNodeLink.prisma(tx).create(\n                {\n                    \"id\": str(uuid.uuid4()),\n                    \"sourceName\": link.source_name,\n                    \"sinkName\": link.sink_name,\n                    \"agentNodeSourceId\": link.source_id,\n                    \"agentNodeSinkId\": link.sink_id,\n                    \"isStatic\": link.is_static,\n                }\n            )\n            for link in graph.links\n        ]\n    )",
                            "start_token": 4118,
                            "end_token": 4199,
                            "children": [
                                {
                                    "type": "await",
                                    "label": "await asyncio.gather(\n        *[\n            AgentNodeLink.prisma(tx).create(\n                {\n                    \"id\": str(uuid.uuid4()),\n                    \"sourceName\": link.source_name,\n                    \"sinkName\": link.sink_name,\n                    \"agentNodeSourceId\": link.source_id,\n                    \"agentNodeSinkId\": link.sink_id,\n                    \"isStatic\": link.is_static,\n                }\n            )\n            for link in graph.links\n        ]\n    )",
                                    "start_token": 4118,
                                    "end_token": 4199,
                                    "children": [
                                        {
                                            "type": "call",
                                            "label": "asyncio.gather(\n        *[\n            AgentNodeLink.prisma(tx).create(\n                {\n                    \"id\": str(uuid.uuid4()),\n                    \"sourceName\": link.source_name,\n                    \"sinkName\": link.sink_name,\n                    \"agentNodeSourceId\": link.source_id,\n                    \"agentNodeSinkId\": link.sink_id,\n                    \"isStatic\": link.is_static,\n                }\n            )\n            for link in graph.links\n        ]\n    )",
                                            "start_token": 4119,
                                            "end_token": 4199,
                                            "children": [
                                                {
                                                    "type": "attribute",
                                                    "label": "asyncio.gather",
                                                    "start_token": 4119,
                                                    "end_token": 4121,
                                                    "children": [
                                                        {
                                                            "type": "identifier",
                                                            "label": "asyncio",
                                                            "start_token": 4119,
                                                            "end_token": 4119,
                                                            "children": []
                                                        },
                                                        {
                                                            "type": "identifier",
                                                            "label": "gather",
                                                            "start_token": 4121,
                                                            "end_token": 4121,
                                                            "children": []
                                                        }
                                                    ]
                                                },
                                                {
                                                    "type": "argument_list",
                                                    "label": "(\n        *[\n            AgentNodeLink.prisma(tx).create(\n                {\n                    \"id\": str(uuid.uuid4()),\n                    \"sourceName\": link.source_name,\n                    \"sinkName\": link.sink_name,\n                    \"agentNodeSourceId\": link.source_id,\n                    \"agentNodeSinkId\": link.sink_id,\n                    \"isStatic\": link.is_static,\n                }\n            )\n            for link in graph.links\n        ]\n    )",
                                                    "start_token": 4122,
                                                    "end_token": 4199,
                                                    "children": [
                                                        {
                                                            "type": "list_splat",
                                                            "label": "*[\n            AgentNodeLink.prisma(tx).create(\n                {\n                    \"id\": str(uuid.uuid4()),\n                    \"sourceName\": link.source_name,\n                    \"sinkName\": link.sink_name,\n                    \"agentNodeSourceId\": link.source_id,\n                    \"agentNodeSinkId\": link.sink_id,\n                    \"isStatic\": link.is_static,\n                }\n            )\n            for link in graph.links\n        ]",
                                                            "start_token": 4124,
                                                            "end_token": 4197,
                                                            "children": [
                                                                {
                                                                    "type": "list_comprehension",
                                                                    "label": "[\n            AgentNodeLink.prisma(tx).create(\n                {\n                    \"id\": str(uuid.uuid4()),\n                    \"sourceName\": link.source_name,\n                    \"sinkName\": link.sink_name,\n                    \"agentNodeSourceId\": link.source_id,\n                    \"agentNodeSinkId\": link.sink_id,\n                    \"isStatic\": link.is_static,\n                }\n            )\n            for link in graph.links\n        ]",
                                                                    "start_token": 4125,
                                                                    "end_token": 4197,
                                                                    "children": [
                                                                        {
                                                                            "type": "call",
                                                                            "label": "AgentNodeLink.prisma(tx).create(\n                {\n                    \"id\": str(uuid.uuid4()),\n                    \"sourceName\": link.source_name,\n                    \"sinkName\": link.sink_name,\n                    \"agentNodeSourceId\": link.source_id,\n                    \"agentNodeSinkId\": link.sink_id,\n                    \"isStatic\": link.is_static,\n                }\n            )",
                                                                            "start_token": 4127,
                                                                            "end_token": 4188,
                                                                            "children": [
                                                                                {
                                                                                    "type": "attribute",
                                                                                    "label": "AgentNodeLink.prisma(tx).create",
                                                                                    "start_token": 4127,
                                                                                    "end_token": 4134,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "call",
                                                                                            "label": "AgentNodeLink.prisma(tx)",
                                                                                            "start_token": 4127,
                                                                                            "end_token": 4132,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "attribute",
                                                                                                    "label": "AgentNodeLink.prisma",
                                                                                                    "start_token": 4127,
                                                                                                    "end_token": 4129,
                                                                                                    "children": [
                                                                                                        {
                                                                                                            "type": "identifier",
                                                                                                            "label": "AgentNodeLink",
                                                                                                            "start_token": 4127,
                                                                                                            "end_token": 4127,
                                                                                                            "children": []
                                                                                                        },
                                                                                                        {
                                                                                                            "type": "identifier",
                                                                                                            "label": "prisma",
                                                                                                            "start_token": 4129,
                                                                                                            "end_token": 4129,
                                                                                                            "children": []
                                                                                                        }
                                                                                                    ]
                                                                                                },
                                                                                                {
                                                                                                    "type": "argument_list",
                                                                                                    "label": "(tx)",
                                                                                                    "start_token": 4130,
                                                                                                    "end_token": 4132,
                                                                                                    "children": [
                                                                                                        {
                                                                                                            "type": "identifier",
                                                                                                            "label": "tx",
                                                                                                            "start_token": 4131,
                                                                                                            "end_token": 4131,
                                                                                                            "children": []
                                                                                                        }
                                                                                                    ]
                                                                                                }
                                                                                            ]
                                                                                        },
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "label": "create",
                                                                                            "start_token": 4134,
                                                                                            "end_token": 4134,
                                                                                            "children": []
                                                                                        }
                                                                                    ]
                                                                                },
                                                                                {
                                                                                    "type": "argument_list",
                                                                                    "label": "(\n                {\n                    \"id\": str(uuid.uuid4()),\n                    \"sourceName\": link.source_name,\n                    \"sinkName\": link.sink_name,\n                    \"agentNodeSourceId\": link.source_id,\n                    \"agentNodeSinkId\": link.sink_id,\n                    \"isStatic\": link.is_static,\n                }\n            )",
                                                                                    "start_token": 4135,
                                                                                    "end_token": 4188,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "dictionary",
                                                                                            "label": "{\n                    \"id\": str(uuid.uuid4()),\n                    \"sourceName\": link.source_name,\n                    \"sinkName\": link.sink_name,\n                    \"agentNodeSourceId\": link.source_id,\n                    \"agentNodeSinkId\": link.sink_id,\n                    \"isStatic\": link.is_static,\n                }",
                                                                                            "start_token": 4137,
                                                                                            "end_token": 4186,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "pair",
                                                                                                    "label": "\"id\": str(uuid.uuid4())",
                                                                                                    "start_token": 4139,
                                                                                                    "end_token": 4148,
                                                                                                    "children": [
                                                                                                        {
                                                                                                            "type": "string",
                                                                                                            "label": "\"id\"",
                                                                                                            "start_token": 4139,
                                                                                                            "end_token": 4139,
                                                                                                            "children": [
                                                                                                                {
                                                                                                                    "type": "string_start",
                                                                                                                    "label": "\"",
                                                                                                                    "start_token": 4139,
                                                                                                                    "end_token": 4139,
                                                                                                                    "children": []
                                                                                                                },
                                                                                                                {
                                                                                                                    "type": "string_content",
                                                                                                                    "label": "id",
                                                                                                                    "start_token": 4139,
                                                                                                                    "end_token": 4139,
                                                                                                                    "children": []
                                                                                                                },
                                                                                                                {
                                                                                                                    "type": "string_end",
                                                                                                                    "label": "\"",
                                                                                                                    "start_token": 4139,
                                                                                                                    "end_token": 4139,
                                                                                                                    "children": []
                                                                                                                }
                                                                                                            ]
                                                                                                        },
                                                                                                        {
                                                                                                            "type": "call",
                                                                                                            "label": "str(uuid.uuid4())",
                                                                                                            "start_token": 4141,
                                                                                                            "end_token": 4148,
                                                                                                            "children": [
                                                                                                                {
                                                                                                                    "type": "identifier",
                                                                                                                    "label": "str",
                                                                                                                    "start_token": 4141,
                                                                                                                    "end_token": 4141,
                                                                                                                    "children": []
                                                                                                                },
                                                                                                                {
                                                                                                                    "type": "argument_list",
                                                                                                                    "label": "(uuid.uuid4())",
                                                                                                                    "start_token": 4142,
                                                                                                                    "end_token": 4148,
                                                                                                                    "children": [
                                                                                                                        {
                                                                                                                            "type": "call",
                                                                                                                            "label": "uuid.uuid4()",
                                                                                                                            "start_token": 4143,
                                                                                                                            "end_token": 4147,
                                                                                                                            "children": [
                                                                                                                                {
                                                                                                                                    "type": "attribute",
                                                                                                                                    "label": "uuid.uuid4",
                                                                                                                                    "start_token": 4143,
                                                                                                                                    "end_token": 4145,
                                                                                                                                    "children": [
                                                                                                                                        {
                                                                                                                                            "type": "identifier",
                                                                                                                                            "label": "uuid",
                                                                                                                                            "start_token": 4143,
                                                                                                                                            "end_token": 4143,
                                                                                                                                            "children": []
                                                                                                                                        },
                                                                                                                                        {
                                                                                                                                            "type": "identifier",
                                                                                                                                            "label": "uuid4",
                                                                                                                                            "start_token": 4145,
                                                                                                                                            "end_token": 4145,
                                                                                                                                            "children": []
                                                                                                                                        }
                                                                                                                                    ]
                                                                                                                                },
                                                                                                                                {
                                                                                                                                    "type": "argument_list",
                                                                                                                                    "label": "()",
                                                                                                                                    "start_token": 4146,
                                                                                                                                    "end_token": 4147,
                                                                                                                                    "children": []
                                                                                                                                }
                                                                                                                            ]
                                                                                                                        }
                                                                                                                    ]
                                                                                                                }
                                                                                                            ]
                                                                                                        }
                                                                                                    ]
                                                                                                },
                                                                                                {
                                                                                                    "type": "pair",
                                                                                                    "label": "\"sourceName\": link.source_name",
                                                                                                    "start_token": 4151,
                                                                                                    "end_token": 4155,
                                                                                                    "children": [
                                                                                                        {
                                                                                                            "type": "string",
                                                                                                            "label": "\"sourceName\"",
                                                                                                            "start_token": 4151,
                                                                                                            "end_token": 4151,
                                                                                                            "children": [
                                                                                                                {
                                                                                                                    "type": "string_start",
                                                                                                                    "label": "\"",
                                                                                                                    "start_token": 4151,
                                                                                                                    "end_token": 4151,
                                                                                                                    "children": []
                                                                                                                },
                                                                                                                {
                                                                                                                    "type": "string_content",
                                                                                                                    "label": "sourceName",
                                                                                                                    "start_token": 4151,
                                                                                                                    "end_token": 4151,
                                                                                                                    "children": []
                                                                                                                },
                                                                                                                {
                                                                                                                    "type": "string_end",
                                                                                                                    "label": "\"",
                                                                                                                    "start_token": 4151,
                                                                                                                    "end_token": 4151,
                                                                                                                    "children": []
                                                                                                                }
                                                                                                            ]
                                                                                                        },
                                                                                                        {
                                                                                                            "type": "attribute",
                                                                                                            "label": "link.source_name",
                                                                                                            "start_token": 4153,
                                                                                                            "end_token": 4155,
                                                                                                            "children": [
                                                                                                                {
                                                                                                                    "type": "identifier",
                                                                                                                    "label": "link",
                                                                                                                    "start_token": 4153,
                                                                                                                    "end_token": 4153,
                                                                                                                    "children": []
                                                                                                                },
                                                                                                                {
                                                                                                                    "type": "identifier",
                                                                                                                    "label": "source_name",
                                                                                                                    "start_token": 4155,
                                                                                                                    "end_token": 4155,
                                                                                                                    "children": []
                                                                                                                }
                                                                                                            ]
                                                                                                        }
                                                                                                    ]
                                                                                                },
                                                                                                {
                                                                                                    "type": "pair",
                                                                                                    "label": "\"sinkName\": link.sink_name",
                                                                                                    "start_token": 4158,
                                                                                                    "end_token": 4162,
                                                                                                    "children": [
                                                                                                        {
                                                                                                            "type": "string",
                                                                                                            "label": "\"sinkName\"",
                                                                                                            "start_token": 4158,
                                                                                                            "end_token": 4158,
                                                                                                            "children": [
                                                                                                                {
                                                                                                                    "type": "string_start",
                                                                                                                    "label": "\"",
                                                                                                                    "start_token": 4158,
                                                                                                                    "end_token": 4158,
                                                                                                                    "children": []
                                                                                                                },
                                                                                                                {
                                                                                                                    "type": "string_content",
                                                                                                                    "label": "sinkName",
                                                                                                                    "start_token": 4158,
                                                                                                                    "end_token": 4158,
                                                                                                                    "children": []
                                                                                                                },
                                                                                                                {
                                                                                                                    "type": "string_end",
                                                                                                                    "label": "\"",
                                                                                                                    "start_token": 4158,
                                                                                                                    "end_token": 4158,
                                                                                                                    "children": []
                                                                                                                }
                                                                                                            ]
                                                                                                        },
                                                                                                        {
                                                                                                            "type": "attribute",
                                                                                                            "label": "link.sink_name",
                                                                                                            "start_token": 4160,
                                                                                                            "end_token": 4162,
                                                                                                            "children": [
                                                                                                                {
                                                                                                                    "type": "identifier",
                                                                                                                    "label": "link",
                                                                                                                    "start_token": 4160,
                                                                                                                    "end_token": 4160,
                                                                                                                    "children": []
                                                                                                                },
                                                                                                                {
                                                                                                                    "type": "identifier",
                                                                                                                    "label": "sink_name",
                                                                                                                    "start_token": 4162,
                                                                                                                    "end_token": 4162,
                                                                                                                    "children": []
                                                                                                                }
                                                                                                            ]
                                                                                                        }
                                                                                                    ]
                                                                                                },
                                                                                                {
                                                                                                    "type": "pair",
                                                                                                    "label": "\"agentNodeSourceId\": link.source_id",
                                                                                                    "start_token": 4165,
                                                                                                    "end_token": 4169,
                                                                                                    "children": [
                                                                                                        {
                                                                                                            "type": "string",
                                                                                                            "label": "\"agentNodeSourceId\"",
                                                                                                            "start_token": 4165,
                                                                                                            "end_token": 4165,
                                                                                                            "children": [
                                                                                                                {
                                                                                                                    "type": "string_start",
                                                                                                                    "label": "\"",
                                                                                                                    "start_token": 4165,
                                                                                                                    "end_token": 4165,
                                                                                                                    "children": []
                                                                                                                },
                                                                                                                {
                                                                                                                    "type": "string_content",
                                                                                                                    "label": "agentNodeSourceId",
                                                                                                                    "start_token": 4165,
                                                                                                                    "end_token": 4165,
                                                                                                                    "children": []
                                                                                                                },
                                                                                                                {
                                                                                                                    "type": "string_end",
                                                                                                                    "label": "\"",
                                                                                                                    "start_token": 4165,
                                                                                                                    "end_token": 4165,
                                                                                                                    "children": []
                                                                                                                }
                                                                                                            ]
                                                                                                        },
                                                                                                        {
                                                                                                            "type": "attribute",
                                                                                                            "label": "link.source_id",
                                                                                                            "start_token": 4167,
                                                                                                            "end_token": 4169,
                                                                                                            "children": [
                                                                                                                {
                                                                                                                    "type": "identifier",
                                                                                                                    "label": "link",
                                                                                                                    "start_token": 4167,
                                                                                                                    "end_token": 4167,
                                                                                                                    "children": []
                                                                                                                },
                                                                                                                {
                                                                                                                    "type": "identifier",
                                                                                                                    "label": "source_id",
                                                                                                                    "start_token": 4169,
                                                                                                                    "end_token": 4169,
                                                                                                                    "children": []
                                                                                                                }
                                                                                                            ]
                                                                                                        }
                                                                                                    ]
                                                                                                },
                                                                                                {
                                                                                                    "type": "pair",
                                                                                                    "label": "\"agentNodeSinkId\": link.sink_id",
                                                                                                    "start_token": 4172,
                                                                                                    "end_token": 4176,
                                                                                                    "children": [
                                                                                                        {
                                                                                                            "type": "string",
                                                                                                            "label": "\"agentNodeSinkId\"",
                                                                                                            "start_token": 4172,
                                                                                                            "end_token": 4172,
                                                                                                            "children": [
                                                                                                                {
                                                                                                                    "type": "string_start",
                                                                                                                    "label": "\"",
                                                                                                                    "start_token": 4172,
                                                                                                                    "end_token": 4172,
                                                                                                                    "children": []
                                                                                                                },
                                                                                                                {
                                                                                                                    "type": "string_content",
                                                                                                                    "label": "agentNodeSinkId",
                                                                                                                    "start_token": 4172,
                                                                                                                    "end_token": 4172,
                                                                                                                    "children": []
                                                                                                                },
                                                                                                                {
                                                                                                                    "type": "string_end",
                                                                                                                    "label": "\"",
                                                                                                                    "start_token": 4172,
                                                                                                                    "end_token": 4172,
                                                                                                                    "children": []
                                                                                                                }
                                                                                                            ]
                                                                                                        },
                                                                                                        {
                                                                                                            "type": "attribute",
                                                                                                            "label": "link.sink_id",
                                                                                                            "start_token": 4174,
                                                                                                            "end_token": 4176,
                                                                                                            "children": [
                                                                                                                {
                                                                                                                    "type": "identifier",
                                                                                                                    "label": "link",
                                                                                                                    "start_token": 4174,
                                                                                                                    "end_token": 4174,
                                                                                                                    "children": []
                                                                                                                },
                                                                                                                {
                                                                                                                    "type": "identifier",
                                                                                                                    "label": "sink_id",
                                                                                                                    "start_token": 4176,
                                                                                                                    "end_token": 4176,
                                                                                                                    "children": []
                                                                                                                }
                                                                                                            ]
                                                                                                        }
                                                                                                    ]
                                                                                                },
                                                                                                {
                                                                                                    "type": "pair",
                                                                                                    "label": "\"isStatic\": link.is_static",
                                                                                                    "start_token": 4179,
                                                                                                    "end_token": 4183,
                                                                                                    "children": [
                                                                                                        {
                                                                                                            "type": "string",
                                                                                                            "label": "\"isStatic\"",
                                                                                                            "start_token": 4179,
                                                                                                            "end_token": 4179,
                                                                                                            "children": [
                                                                                                                {
                                                                                                                    "type": "string_start",
                                                                                                                    "label": "\"",
                                                                                                                    "start_token": 4179,
                                                                                                                    "end_token": 4179,
                                                                                                                    "children": []
                                                                                                                },
                                                                                                                {
                                                                                                                    "type": "string_content",
                                                                                                                    "label": "isStatic",
                                                                                                                    "start_token": 4179,
                                                                                                                    "end_token": 4179,
                                                                                                                    "children": []
                                                                                                                },
                                                                                                                {
                                                                                                                    "type": "string_end",
                                                                                                                    "label": "\"",
                                                                                                                    "start_token": 4179,
                                                                                                                    "end_token": 4179,
                                                                                                                    "children": []
                                                                                                                }
                                                                                                            ]
                                                                                                        },
                                                                                                        {
                                                                                                            "type": "attribute",
                                                                                                            "label": "link.is_static",
                                                                                                            "start_token": 4181,
                                                                                                            "end_token": 4183,
                                                                                                            "children": [
                                                                                                                {
                                                                                                                    "type": "identifier",
                                                                                                                    "label": "link",
                                                                                                                    "start_token": 4181,
                                                                                                                    "end_token": 4181,
                                                                                                                    "children": []
                                                                                                                },
                                                                                                                {
                                                                                                                    "type": "identifier",
                                                                                                                    "label": "is_static",
                                                                                                                    "start_token": 4183,
                                                                                                                    "end_token": 4183,
                                                                                                                    "children": []
                                                                                                                }
                                                                                                            ]
                                                                                                        }
                                                                                                    ]
                                                                                                }
                                                                                            ]
                                                                                        }
                                                                                    ]
                                                                                }
                                                                            ]
                                                                        },
                                                                        {
                                                                            "type": "for_in_clause",
                                                                            "label": "for link in graph.links",
                                                                            "start_token": 4190,
                                                                            "end_token": 4195,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "link",
                                                                                    "start_token": 4191,
                                                                                    "end_token": 4191,
                                                                                    "children": []
                                                                                },
                                                                                {
                                                                                    "type": "attribute",
                                                                                    "label": "graph.links",
                                                                                    "start_token": 4193,
                                                                                    "end_token": 4195,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "label": "graph",
                                                                                            "start_token": 4193,
                                                                                            "end_token": 4193,
                                                                                            "children": []
                                                                                        },
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "label": "links",
                                                                                            "start_token": 4195,
                                                                                            "end_token": 4195,
                                                                                            "children": []
                                                                                        }
                                                                                    ]
                                                                                }
                                                                            ]
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                }
                                            ]
                                        }
                                    ]
                                }
                            ]
                        }
                    ]
                }
            ]
        },
        {
            "type": "comment",
            "label": "# ------------------------ UTILITIES ------------------------ #",
            "start_token": 4203,
            "end_token": 4253,
            "children": []
        },
        {
            "type": "function_definition",
            "label": "def make_graph_model(creatable_graph: Graph, user_id: str) -> GraphModel:\n    \"\"\"\n    Convert a Graph to a GraphModel, setting graph_id and graph_version on all nodes.\n\n    Args:\n        creatable_graph (Graph): The creatable graph to convert.\n        user_id (str): The ID of the user creating the graph.\n\n    Returns:\n        GraphModel: The converted Graph object.\n    \"\"\"\n    # Create a new Graph object, inheriting properties from CreatableGraph\n    return GraphModel(\n        **creatable_graph.model_dump(exclude={\"nodes\"}),\n        user_id=user_id,\n        nodes=[\n            NodeModel(\n                **creatable_node.model_dump(),\n                graph_id=creatable_graph.id,\n                graph_version=creatable_graph.version,\n            )\n            for creatable_node in creatable_graph.nodes\n        ],\n    )",
            "start_token": 4257,
            "end_token": 4354,
            "children": [
                {
                    "type": "identifier",
                    "label": "make_graph_model",
                    "start_token": 4258,
                    "end_token": 4258,
                    "children": []
                },
                {
                    "type": "parameters",
                    "label": "(creatable_graph: Graph, user_id: str)",
                    "start_token": 4259,
                    "end_token": 4267,
                    "children": [
                        {
                            "type": "typed_parameter",
                            "label": "creatable_graph: Graph",
                            "start_token": 4260,
                            "end_token": 4262,
                            "children": [
                                {
                                    "type": "identifier",
                                    "label": "creatable_graph",
                                    "start_token": 4260,
                                    "end_token": 4260,
                                    "children": []
                                },
                                {
                                    "type": "type",
                                    "label": "Graph",
                                    "start_token": 4262,
                                    "end_token": 4262,
                                    "children": [
                                        {
                                            "type": "identifier",
                                            "label": "Graph",
                                            "start_token": 4262,
                                            "end_token": 4262,
                                            "children": []
                                        }
                                    ]
                                }
                            ]
                        },
                        {
                            "type": "typed_parameter",
                            "label": "user_id: str",
                            "start_token": 4264,
                            "end_token": 4266,
                            "children": [
                                {
                                    "type": "identifier",
                                    "label": "user_id",
                                    "start_token": 4264,
                                    "end_token": 4264,
                                    "children": []
                                },
                                {
                                    "type": "type",
                                    "label": "str",
                                    "start_token": 4266,
                                    "end_token": 4266,
                                    "children": [
                                        {
                                            "type": "identifier",
                                            "label": "str",
                                            "start_token": 4266,
                                            "end_token": 4266,
                                            "children": []
                                        }
                                    ]
                                }
                            ]
                        }
                    ]
                },
                {
                    "type": "type",
                    "label": "GraphModel",
                    "start_token": 4270,
                    "end_token": 4270,
                    "children": [
                        {
                            "type": "identifier",
                            "label": "GraphModel",
                            "start_token": 4270,
                            "end_token": 4270,
                            "children": []
                        }
                    ]
                },
                {
                    "type": "block",
                    "label": "\"\"\"\n    Convert a Graph to a GraphModel, setting graph_id and graph_version on all nodes.\n\n    Args:\n        creatable_graph (Graph): The creatable graph to convert.\n        user_id (str): The ID of the user creating the graph.\n\n    Returns:\n        GraphModel: The converted Graph object.\n    \"\"\"\n    # Create a new Graph object, inheriting properties from CreatableGraph\n    return GraphModel(\n        **creatable_graph.model_dump(exclude={\"nodes\"}),\n        user_id=user_id,\n        nodes=[\n            NodeModel(\n                **creatable_node.model_dump(),\n                graph_id=creatable_graph.id,\n                graph_version=creatable_graph.version,\n            )\n            for creatable_node in creatable_graph.nodes\n        ],\n    )",
                    "start_token": 4273,
                    "end_token": 4354,
                    "children": [
                        {
                            "type": "expression_statement",
                            "label": "\"\"\"\n    Convert a Graph to a GraphModel, setting graph_id and graph_version on all nodes.\n\n    Args:\n        creatable_graph (Graph): The creatable graph to convert.\n        user_id (str): The ID of the user creating the graph.\n\n    Returns:\n        GraphModel: The converted Graph object.\n    \"\"\"",
                            "start_token": 4273,
                            "end_token": 4275,
                            "children": [
                                {
                                    "type": "string",
                                    "label": "\"\"\"\n    Convert a Graph to a GraphModel, setting graph_id and graph_version on all nodes.\n\n    Args:\n        creatable_graph (Graph): The creatable graph to convert.\n        user_id (str): The ID of the user creating the graph.\n\n    Returns:\n        GraphModel: The converted Graph object.\n    \"\"\"",
                                    "start_token": 4273,
                                    "end_token": 4275,
                                    "children": [
                                        {
                                            "type": "string_start",
                                            "label": "\"\"\"",
                                            "start_token": 4273,
                                            "end_token": 4274,
                                            "children": []
                                        },
                                        {
                                            "type": "string_content",
                                            "label": "\n    Convert a Graph to a GraphModel, setting graph_id and graph_version on all nodes.\n\n    Args:\n        creatable_graph (Graph): The creatable graph to convert.\n        user_id (str): The ID of the user creating the graph.\n\n    Returns:\n        GraphModel: The converted Graph object.\n    ",
                                            "start_token": 4274,
                                            "end_token": 4274,
                                            "children": []
                                        },
                                        {
                                            "type": "string_end",
                                            "label": "\"\"\"",
                                            "start_token": 4274,
                                            "end_token": 4275,
                                            "children": []
                                        }
                                    ]
                                }
                            ]
                        },
                        {
                            "type": "comment",
                            "label": "# Create a new Graph object, inheriting properties from CreatableGraph",
                            "start_token": 4277,
                            "end_token": 4287,
                            "children": []
                        },
                        {
                            "type": "return_statement",
                            "label": "return GraphModel(\n        **creatable_graph.model_dump(exclude={\"nodes\"}),\n        user_id=user_id,\n        nodes=[\n            NodeModel(\n                **creatable_node.model_dump(),\n                graph_id=creatable_graph.id,\n                graph_version=creatable_graph.version,\n            )\n            for creatable_node in creatable_graph.nodes\n        ],\n    )",
                            "start_token": 4289,
                            "end_token": 4354,
                            "children": [
                                {
                                    "type": "call",
                                    "label": "GraphModel(\n        **creatable_graph.model_dump(exclude={\"nodes\"}),\n        user_id=user_id,\n        nodes=[\n            NodeModel(\n                **creatable_node.model_dump(),\n                graph_id=creatable_graph.id,\n                graph_version=creatable_graph.version,\n            )\n            for creatable_node in creatable_graph.nodes\n        ],\n    )",
                                    "start_token": 4290,
                                    "end_token": 4354,
                                    "children": [
                                        {
                                            "type": "identifier",
                                            "label": "GraphModel",
                                            "start_token": 4290,
                                            "end_token": 4290,
                                            "children": []
                                        },
                                        {
                                            "type": "argument_list",
                                            "label": "(\n        **creatable_graph.model_dump(exclude={\"nodes\"}),\n        user_id=user_id,\n        nodes=[\n            NodeModel(\n                **creatable_node.model_dump(),\n                graph_id=creatable_graph.id,\n                graph_version=creatable_graph.version,\n            )\n            for creatable_node in creatable_graph.nodes\n        ],\n    )",
                                            "start_token": 4291,
                                            "end_token": 4354,
                                            "children": [
                                                {
                                                    "type": "dictionary_splat",
                                                    "label": "**creatable_graph.model_dump(exclude={\"nodes\"})",
                                                    "start_token": 4293,
                                                    "end_token": 4304,
                                                    "children": [
                                                        {
                                                            "type": "call",
                                                            "label": "creatable_graph.model_dump(exclude={\"nodes\"})",
                                                            "start_token": 4295,
                                                            "end_token": 4304,
                                                            "children": [
                                                                {
                                                                    "type": "attribute",
                                                                    "label": "creatable_graph.model_dump",
                                                                    "start_token": 4295,
                                                                    "end_token": 4297,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "creatable_graph",
                                                                            "start_token": 4295,
                                                                            "end_token": 4295,
                                                                            "children": []
                                                                        },
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "model_dump",
                                                                            "start_token": 4297,
                                                                            "end_token": 4297,
                                                                            "children": []
                                                                        }
                                                                    ]
                                                                },
                                                                {
                                                                    "type": "argument_list",
                                                                    "label": "(exclude={\"nodes\"})",
                                                                    "start_token": 4298,
                                                                    "end_token": 4304,
                                                                    "children": [
                                                                        {
                                                                            "type": "keyword_argument",
                                                                            "label": "exclude={\"nodes\"}",
                                                                            "start_token": 4299,
                                                                            "end_token": 4303,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "exclude",
                                                                                    "start_token": 4299,
                                                                                    "end_token": 4299,
                                                                                    "children": []
                                                                                },
                                                                                {
                                                                                    "type": "set",
                                                                                    "label": "{\"nodes\"}",
                                                                                    "start_token": 4301,
                                                                                    "end_token": 4303,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "string",
                                                                                            "label": "\"nodes\"",
                                                                                            "start_token": 4302,
                                                                                            "end_token": 4302,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "string_start",
                                                                                                    "label": "\"",
                                                                                                    "start_token": 4302,
                                                                                                    "end_token": 4302,
                                                                                                    "children": []
                                                                                                },
                                                                                                {
                                                                                                    "type": "string_content",
                                                                                                    "label": "nodes",
                                                                                                    "start_token": 4302,
                                                                                                    "end_token": 4302,
                                                                                                    "children": []
                                                                                                },
                                                                                                {
                                                                                                    "type": "string_end",
                                                                                                    "label": "\"",
                                                                                                    "start_token": 4302,
                                                                                                    "end_token": 4302,
                                                                                                    "children": []
                                                                                                }
                                                                                            ]
                                                                                        }
                                                                                    ]
                                                                                }
                                                                            ]
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                },
                                                {
                                                    "type": "keyword_argument",
                                                    "label": "user_id=user_id",
                                                    "start_token": 4307,
                                                    "end_token": 4309,
                                                    "children": [
                                                        {
                                                            "type": "identifier",
                                                            "label": "user_id",
                                                            "start_token": 4307,
                                                            "end_token": 4307,
                                                            "children": []
                                                        },
                                                        {
                                                            "type": "identifier",
                                                            "label": "user_id",
                                                            "start_token": 4309,
                                                            "end_token": 4309,
                                                            "children": []
                                                        }
                                                    ]
                                                },
                                                {
                                                    "type": "keyword_argument",
                                                    "label": "nodes=[\n            NodeModel(\n                **creatable_node.model_dump(),\n                graph_id=creatable_graph.id,\n                graph_version=creatable_graph.version,\n            )\n            for creatable_node in creatable_graph.nodes\n        ]",
                                                    "start_token": 4312,
                                                    "end_token": 4351,
                                                    "children": [
                                                        {
                                                            "type": "identifier",
                                                            "label": "nodes",
                                                            "start_token": 4312,
                                                            "end_token": 4312,
                                                            "children": []
                                                        },
                                                        {
                                                            "type": "list_comprehension",
                                                            "label": "[\n            NodeModel(\n                **creatable_node.model_dump(),\n                graph_id=creatable_graph.id,\n                graph_version=creatable_graph.version,\n            )\n            for creatable_node in creatable_graph.nodes\n        ]",
                                                            "start_token": 4314,
                                                            "end_token": 4351,
                                                            "children": [
                                                                {
                                                                    "type": "call",
                                                                    "label": "NodeModel(\n                **creatable_node.model_dump(),\n                graph_id=creatable_graph.id,\n                graph_version=creatable_graph.version,\n            )",
                                                                    "start_token": 4316,
                                                                    "end_token": 4342,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "NodeModel",
                                                                            "start_token": 4316,
                                                                            "end_token": 4316,
                                                                            "children": []
                                                                        },
                                                                        {
                                                                            "type": "argument_list",
                                                                            "label": "(\n                **creatable_node.model_dump(),\n                graph_id=creatable_graph.id,\n                graph_version=creatable_graph.version,\n            )",
                                                                            "start_token": 4317,
                                                                            "end_token": 4342,
                                                                            "children": [
                                                                                {
                                                                                    "type": "dictionary_splat",
                                                                                    "label": "**creatable_node.model_dump()",
                                                                                    "start_token": 4319,
                                                                                    "end_token": 4325,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "call",
                                                                                            "label": "creatable_node.model_dump()",
                                                                                            "start_token": 4321,
                                                                                            "end_token": 4325,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "attribute",
                                                                                                    "label": "creatable_node.model_dump",
                                                                                                    "start_token": 4321,
                                                                                                    "end_token": 4323,
                                                                                                    "children": [
                                                                                                        {
                                                                                                            "type": "identifier",
                                                                                                            "label": "creatable_node",
                                                                                                            "start_token": 4321,
                                                                                                            "end_token": 4321,
                                                                                                            "children": []
                                                                                                        },
                                                                                                        {
                                                                                                            "type": "identifier",
                                                                                                            "label": "model_dump",
                                                                                                            "start_token": 4323,
                                                                                                            "end_token": 4323,
                                                                                                            "children": []
                                                                                                        }
                                                                                                    ]
                                                                                                },
                                                                                                {
                                                                                                    "type": "argument_list",
                                                                                                    "label": "()",
                                                                                                    "start_token": 4324,
                                                                                                    "end_token": 4325,
                                                                                                    "children": []
                                                                                                }
                                                                                            ]
                                                                                        }
                                                                                    ]
                                                                                },
                                                                                {
                                                                                    "type": "keyword_argument",
                                                                                    "label": "graph_id=creatable_graph.id",
                                                                                    "start_token": 4328,
                                                                                    "end_token": 4332,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "label": "graph_id",
                                                                                            "start_token": 4328,
                                                                                            "end_token": 4328,
                                                                                            "children": []
                                                                                        },
                                                                                        {
                                                                                            "type": "attribute",
                                                                                            "label": "creatable_graph.id",
                                                                                            "start_token": 4330,
                                                                                            "end_token": 4332,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "label": "creatable_graph",
                                                                                                    "start_token": 4330,
                                                                                                    "end_token": 4330,
                                                                                                    "children": []
                                                                                                },
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "label": "id",
                                                                                                    "start_token": 4332,
                                                                                                    "end_token": 4332,
                                                                                                    "children": []
                                                                                                }
                                                                                            ]
                                                                                        }
                                                                                    ]
                                                                                },
                                                                                {
                                                                                    "type": "keyword_argument",
                                                                                    "label": "graph_version=creatable_graph.version",
                                                                                    "start_token": 4335,
                                                                                    "end_token": 4339,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "label": "graph_version",
                                                                                            "start_token": 4335,
                                                                                            "end_token": 4335,
                                                                                            "children": []
                                                                                        },
                                                                                        {
                                                                                            "type": "attribute",
                                                                                            "label": "creatable_graph.version",
                                                                                            "start_token": 4337,
                                                                                            "end_token": 4339,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "label": "creatable_graph",
                                                                                                    "start_token": 4337,
                                                                                                    "end_token": 4337,
                                                                                                    "children": []
                                                                                                },
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "label": "version",
                                                                                                    "start_token": 4339,
                                                                                                    "end_token": 4339,
                                                                                                    "children": []
                                                                                                }
                                                                                            ]
                                                                                        }
                                                                                    ]
                                                                                }
                                                                            ]
                                                                        }
                                                                    ]
                                                                },
                                                                {
                                                                    "type": "for_in_clause",
                                                                    "label": "for creatable_node in creatable_graph.nodes",
                                                                    "start_token": 4344,
                                                                    "end_token": 4349,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "creatable_node",
                                                                            "start_token": 4345,
                                                                            "end_token": 4345,
                                                                            "children": []
                                                                        },
                                                                        {
                                                                            "type": "attribute",
                                                                            "label": "creatable_graph.nodes",
                                                                            "start_token": 4347,
                                                                            "end_token": 4349,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "creatable_graph",
                                                                                    "start_token": 4347,
                                                                                    "end_token": 4347,
                                                                                    "children": []
                                                                                },
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "nodes",
                                                                                    "start_token": 4349,
                                                                                    "end_token": 4349,
                                                                                    "children": []
                                                                                }
                                                                            ]
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                }
                                            ]
                                        }
                                    ]
                                }
                            ]
                        }
                    ]
                }
            ]
        },
        {
            "type": "function_definition",
            "label": "async def fix_llm_provider_credentials():\n    \"\"\"Fix node credentials with provider `llm`\"\"\"\n    from backend.integrations.credentials_store import IntegrationCredentialsStore\n\n    from .user import get_user_integrations\n\n    store = IntegrationCredentialsStore()\n\n    broken_nodes = await prisma.get_client().query_raw(\n        \"\"\"\n        SELECT    graph.\"userId\"       user_id,\n                  node.id              node_id,\n                  node.\"constantInput\" node_preset_input\n        FROM      platform.\"AgentNode\"  node\n        LEFT JOIN platform.\"AgentGraph\" graph\n        ON        node.\"agentGraphId\" = graph.id\n        WHERE     node.\"constantInput\"::jsonb->'credentials'->>'provider' = 'llm'\n        ORDER BY  graph.\"userId\";\n        \"\"\"\n    )\n    logger.info(f\"Fixing LLM credential inputs on {len(broken_nodes)} nodes\")\n\n    user_id: str = \"\"\n    user_integrations = None\n    for node in broken_nodes:\n        if node[\"user_id\"] != user_id:\n            # Save queries by only fetching once per user\n            user_id = node[\"user_id\"]\n            user_integrations = await get_user_integrations(user_id)\n        elif not user_integrations:\n            raise RuntimeError(f\"Impossible state while processing node {node}\")\n\n        node_id: str = node[\"node_id\"]\n        node_preset_input: dict = json.loads(node[\"node_preset_input\"])\n        credentials_meta: dict = node_preset_input[\"credentials\"]\n\n        credentials = next(\n            (\n                c\n                for c in user_integrations.credentials\n                if c.id == credentials_meta[\"id\"]\n            ),\n            None,\n        )\n        if not credentials:\n            continue\n        if credentials.type != \"api_key\":\n            logger.warning(\n                f\"User {user_id} credentials {credentials.id} with provider 'llm' \"\n                f\"has invalid type '{credentials.type}'\"\n            )\n            continue\n\n        api_key = credentials.api_key.get_secret_value()\n        if api_key.startswith(\"sk-ant-api03-\"):\n            credentials.provider = credentials_meta[\"provider\"] = \"anthropic\"\n        elif api_key.startswith(\"sk-\"):\n            credentials.provider = credentials_meta[\"provider\"] = \"openai\"\n        elif api_key.startswith(\"gsk_\"):\n            credentials.provider = credentials_meta[\"provider\"] = \"groq\"\n        else:\n            logger.warning(\n                f\"Could not identify provider from key prefix {api_key[:13]}*****\"\n            )\n            continue\n\n        store.update_creds(user_id, credentials)\n        await AgentNode.prisma().update(\n            where={\"id\": node_id},\n            data={\"constantInput\": json.dumps(node_preset_input)},\n        )",
            "start_token": 4358,
            "end_token": 4726,
            "children": [
                {
                    "type": "identifier",
                    "label": "fix_llm_provider_credentials",
                    "start_token": 4360,
                    "end_token": 4360,
                    "children": []
                },
                {
                    "type": "parameters",
                    "label": "()",
                    "start_token": 4361,
                    "end_token": 4362,
                    "children": []
                },
                {
                    "type": "block",
                    "label": "\"\"\"Fix node credentials with provider `llm`\"\"\"\n    from backend.integrations.credentials_store import IntegrationCredentialsStore\n\n    from .user import get_user_integrations\n\n    store = IntegrationCredentialsStore()\n\n    broken_nodes = await prisma.get_client().query_raw(\n        \"\"\"\n        SELECT    graph.\"userId\"       user_id,\n                  node.id              node_id,\n                  node.\"constantInput\" node_preset_input\n        FROM      platform.\"AgentNode\"  node\n        LEFT JOIN platform.\"AgentGraph\" graph\n        ON        node.\"agentGraphId\" = graph.id\n        WHERE     node.\"constantInput\"::jsonb->'credentials'->>'provider' = 'llm'\n        ORDER BY  graph.\"userId\";\n        \"\"\"\n    )\n    logger.info(f\"Fixing LLM credential inputs on {len(broken_nodes)} nodes\")\n\n    user_id: str = \"\"\n    user_integrations = None\n    for node in broken_nodes:\n        if node[\"user_id\"] != user_id:\n            # Save queries by only fetching once per user\n            user_id = node[\"user_id\"]\n            user_integrations = await get_user_integrations(user_id)\n        elif not user_integrations:\n            raise RuntimeError(f\"Impossible state while processing node {node}\")\n\n        node_id: str = node[\"node_id\"]\n        node_preset_input: dict = json.loads(node[\"node_preset_input\"])\n        credentials_meta: dict = node_preset_input[\"credentials\"]\n\n        credentials = next(\n            (\n                c\n                for c in user_integrations.credentials\n                if c.id == credentials_meta[\"id\"]\n            ),\n            None,\n        )\n        if not credentials:\n            continue\n        if credentials.type != \"api_key\":\n            logger.warning(\n                f\"User {user_id} credentials {credentials.id} with provider 'llm' \"\n                f\"has invalid type '{credentials.type}'\"\n            )\n            continue\n\n        api_key = credentials.api_key.get_secret_value()\n        if api_key.startswith(\"sk-ant-api03-\"):\n            credentials.provider = credentials_meta[\"provider\"] = \"anthropic\"\n        elif api_key.startswith(\"sk-\"):\n            credentials.provider = credentials_meta[\"provider\"] = \"openai\"\n        elif api_key.startswith(\"gsk_\"):\n            credentials.provider = credentials_meta[\"provider\"] = \"groq\"\n        else:\n            logger.warning(\n                f\"Could not identify provider from key prefix {api_key[:13]}*****\"\n            )\n            continue\n\n        store.update_creds(user_id, credentials)\n        await AgentNode.prisma().update(\n            where={\"id\": node_id},\n            data={\"constantInput\": json.dumps(node_preset_input)},\n        )",
                    "start_token": 4365,
                    "end_token": 4726,
                    "children": [
                        {
                            "type": "expression_statement",
                            "label": "\"\"\"Fix node credentials with provider `llm`\"\"\"",
                            "start_token": 4365,
                            "end_token": 4367,
                            "children": [
                                {
                                    "type": "string",
                                    "label": "\"\"\"Fix node credentials with provider `llm`\"\"\"",
                                    "start_token": 4365,
                                    "end_token": 4367,
                                    "children": [
                                        {
                                            "type": "string_start",
                                            "label": "\"\"\"",
                                            "start_token": 4365,
                                            "end_token": 4366,
                                            "children": []
                                        },
                                        {
                                            "type": "string_content",
                                            "label": "Fix node credentials with provider `llm`",
                                            "start_token": 4366,
                                            "end_token": 4366,
                                            "children": []
                                        },
                                        {
                                            "type": "string_end",
                                            "label": "\"\"\"",
                                            "start_token": 4366,
                                            "end_token": 4367,
                                            "children": []
                                        }
                                    ]
                                }
                            ]
                        },
                        {
                            "type": "import_from_statement",
                            "label": "from backend.integrations.credentials_store import IntegrationCredentialsStore",
                            "start_token": 4369,
                            "end_token": 4376,
                            "children": [
                                {
                                    "type": "dotted_name",
                                    "label": "backend.integrations.credentials_store",
                                    "start_token": 4370,
                                    "end_token": 4374,
                                    "children": [
                                        {
                                            "type": "identifier",
                                            "label": "backend",
                                            "start_token": 4370,
                                            "end_token": 4370,
                                            "children": []
                                        },
                                        {
                                            "type": "identifier",
                                            "label": "integrations",
                                            "start_token": 4372,
                                            "end_token": 4372,
                                            "children": []
                                        },
                                        {
                                            "type": "identifier",
                                            "label": "credentials_store",
                                            "start_token": 4374,
                                            "end_token": 4374,
                                            "children": []
                                        }
                                    ]
                                },
                                {
                                    "type": "dotted_name",
                                    "label": "IntegrationCredentialsStore",
                                    "start_token": 4376,
                                    "end_token": 4376,
                                    "children": [
                                        {
                                            "type": "identifier",
                                            "label": "IntegrationCredentialsStore",
                                            "start_token": 4376,
                                            "end_token": 4376,
                                            "children": []
                                        }
                                    ]
                                }
                            ]
                        },
                        {
                            "type": "import_from_statement",
                            "label": "from .user import get_user_integrations",
                            "start_token": 4379,
                            "end_token": 4383,
                            "children": [
                                {
                                    "type": "relative_import",
                                    "label": ".user",
                                    "start_token": 4380,
                                    "end_token": 4381,
                                    "children": [
                                        {
                                            "type": "import_prefix",
                                            "label": ".",
                                            "start_token": 4380,
                                            "end_token": 4380,
                                            "children": []
                                        },
                                        {
                                            "type": "dotted_name",
                                            "label": "user",
                                            "start_token": 4381,
                                            "end_token": 4381,
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "label": "user",
                                                    "start_token": 4381,
                                                    "end_token": 4381,
                                                    "children": []
                                                }
                                            ]
                                        }
                                    ]
                                },
                                {
                                    "type": "dotted_name",
                                    "label": "get_user_integrations",
                                    "start_token": 4383,
                                    "end_token": 4383,
                                    "children": [
                                        {
                                            "type": "identifier",
                                            "label": "get_user_integrations",
                                            "start_token": 4383,
                                            "end_token": 4383,
                                            "children": []
                                        }
                                    ]
                                }
                            ]
                        },
                        {
                            "type": "expression_statement",
                            "label": "store = IntegrationCredentialsStore()",
                            "start_token": 4386,
                            "end_token": 4390,
                            "children": [
                                {
                                    "type": "assignment",
                                    "label": "store = IntegrationCredentialsStore()",
                                    "start_token": 4386,
                                    "end_token": 4390,
                                    "children": [
                                        {
                                            "type": "identifier",
                                            "label": "store",
                                            "start_token": 4386,
                                            "end_token": 4386,
                                            "children": []
                                        },
                                        {
                                            "type": "call",
                                            "label": "IntegrationCredentialsStore()",
                                            "start_token": 4388,
                                            "end_token": 4390,
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "label": "IntegrationCredentialsStore",
                                                    "start_token": 4388,
                                                    "end_token": 4388,
                                                    "children": []
                                                },
                                                {
                                                    "type": "argument_list",
                                                    "label": "()",
                                                    "start_token": 4389,
                                                    "end_token": 4390,
                                                    "children": []
                                                }
                                            ]
                                        }
                                    ]
                                }
                            ]
                        },
                        {
                            "type": "expression_statement",
                            "label": "broken_nodes = await prisma.get_client().query_raw(\n        \"\"\"\n        SELECT    graph.\"userId\"       user_id,\n                  node.id              node_id,\n                  node.\"constantInput\" node_preset_input\n        FROM      platform.\"AgentNode\"  node\n        LEFT JOIN platform.\"AgentGraph\" graph\n        ON        node.\"agentGraphId\" = graph.id\n        WHERE     node.\"constantInput\"::jsonb->'credentials'->>'provider' = 'llm'\n        ORDER BY  graph.\"userId\";\n        \"\"\"\n    )",
                            "start_token": 4393,
                            "end_token": 4423,
                            "children": [
                                {
                                    "type": "assignment",
                                    "label": "broken_nodes = await prisma.get_client().query_raw(\n        \"\"\"\n        SELECT    graph.\"userId\"       user_id,\n                  node.id              node_id,\n                  node.\"constantInput\" node_preset_input\n        FROM      platform.\"AgentNode\"  node\n        LEFT JOIN platform.\"AgentGraph\" graph\n        ON        node.\"agentGraphId\" = graph.id\n        WHERE     node.\"constantInput\"::jsonb->'credentials'->>'provider' = 'llm'\n        ORDER BY  graph.\"userId\";\n        \"\"\"\n    )",
                                    "start_token": 4393,
                                    "end_token": 4423,
                                    "children": [
                                        {
                                            "type": "identifier",
                                            "label": "broken_nodes",
                                            "start_token": 4393,
                                            "end_token": 4393,
                                            "children": []
                                        },
                                        {
                                            "type": "await",
                                            "label": "await prisma.get_client().query_raw(\n        \"\"\"\n        SELECT    graph.\"userId\"       user_id,\n                  node.id              node_id,\n                  node.\"constantInput\" node_preset_input\n        FROM      platform.\"AgentNode\"  node\n        LEFT JOIN platform.\"AgentGraph\" graph\n        ON        node.\"agentGraphId\" = graph.id\n        WHERE     node.\"constantInput\"::jsonb->'credentials'->>'provider' = 'llm'\n        ORDER BY  graph.\"userId\";\n        \"\"\"\n    )",
                                            "start_token": 4395,
                                            "end_token": 4423,
                                            "children": [
                                                {
                                                    "type": "call",
                                                    "label": "prisma.get_client().query_raw(\n        \"\"\"\n        SELECT    graph.\"userId\"       user_id,\n                  node.id              node_id,\n                  node.\"constantInput\" node_preset_input\n        FROM      platform.\"AgentNode\"  node\n        LEFT JOIN platform.\"AgentGraph\" graph\n        ON        node.\"agentGraphId\" = graph.id\n        WHERE     node.\"constantInput\"::jsonb->'credentials'->>'provider' = 'llm'\n        ORDER BY  graph.\"userId\";\n        \"\"\"\n    )",
                                                    "start_token": 4396,
                                                    "end_token": 4423,
                                                    "children": [
                                                        {
                                                            "type": "attribute",
                                                            "label": "prisma.get_client().query_raw",
                                                            "start_token": 4396,
                                                            "end_token": 4402,
                                                            "children": [
                                                                {
                                                                    "type": "call",
                                                                    "label": "prisma.get_client()",
                                                                    "start_token": 4396,
                                                                    "end_token": 4400,
                                                                    "children": [
                                                                        {
                                                                            "type": "attribute",
                                                                            "label": "prisma.get_client",
                                                                            "start_token": 4396,
                                                                            "end_token": 4398,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "prisma",
                                                                                    "start_token": 4396,
                                                                                    "end_token": 4396,
                                                                                    "children": []
                                                                                },
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "get_client",
                                                                                    "start_token": 4398,
                                                                                    "end_token": 4398,
                                                                                    "children": []
                                                                                }
                                                                            ]
                                                                        },
                                                                        {
                                                                            "type": "argument_list",
                                                                            "label": "()",
                                                                            "start_token": 4399,
                                                                            "end_token": 4400,
                                                                            "children": []
                                                                        }
                                                                    ]
                                                                },
                                                                {
                                                                    "type": "identifier",
                                                                    "label": "query_raw",
                                                                    "start_token": 4402,
                                                                    "end_token": 4402,
                                                                    "children": []
                                                                }
                                                            ]
                                                        },
                                                        {
                                                            "type": "argument_list",
                                                            "label": "(\n        \"\"\"\n        SELECT    graph.\"userId\"       user_id,\n                  node.id              node_id,\n                  node.\"constantInput\" node_preset_input\n        FROM      platform.\"AgentNode\"  node\n        LEFT JOIN platform.\"AgentGraph\" graph\n        ON        node.\"agentGraphId\" = graph.id\n        WHERE     node.\"constantInput\"::jsonb->'credentials'->>'provider' = 'llm'\n        ORDER BY  graph.\"userId\";\n        \"\"\"\n    )",
                                                            "start_token": 4403,
                                                            "end_token": 4423,
                                                            "children": [
                                                                {
                                                                    "type": "string",
                                                                    "label": "\"\"\"\n        SELECT    graph.\"userId\"       user_id,\n                  node.id              node_id,\n                  node.\"constantInput\" node_preset_input\n        FROM      platform.\"AgentNode\"  node\n        LEFT JOIN platform.\"AgentGraph\" graph\n        ON        node.\"agentGraphId\" = graph.id\n        WHERE     node.\"constantInput\"::jsonb->'credentials'->>'provider' = 'llm'\n        ORDER BY  graph.\"userId\";\n        \"\"\"",
                                                                    "start_token": 4405,
                                                                    "end_token": 4421,
                                                                    "children": [
                                                                        {
                                                                            "type": "string_start",
                                                                            "label": "\"\"\"",
                                                                            "start_token": 4405,
                                                                            "end_token": 4406,
                                                                            "children": []
                                                                        },
                                                                        {
                                                                            "type": "string_content",
                                                                            "label": "\n        SELECT    graph.\"userId\"       user_id,\n                  node.id              node_id,\n                  node.\"constantInput\" node_preset_input\n        FROM      platform.\"AgentNode\"  node\n        LEFT JOIN platform.\"AgentGraph\" graph\n        ON        node.\"agentGraphId\" = graph.id\n        WHERE     node.\"constantInput\"::jsonb->'credentials'->>'provider' = 'llm'\n        ORDER BY  graph.\"userId\";\n        ",
                                                                            "start_token": 4406,
                                                                            "end_token": 4420,
                                                                            "children": []
                                                                        },
                                                                        {
                                                                            "type": "string_end",
                                                                            "label": "\"\"\"",
                                                                            "start_token": 4420,
                                                                            "end_token": 4421,
                                                                            "children": []
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                }
                                            ]
                                        }
                                    ]
                                }
                            ]
                        },
                        {
                            "type": "expression_statement",
                            "label": "logger.info(f\"Fixing LLM credential inputs on {len(broken_nodes)} nodes\")",
                            "start_token": 4425,
                            "end_token": 4431,
                            "children": [
                                {
                                    "type": "call",
                                    "label": "logger.info(f\"Fixing LLM credential inputs on {len(broken_nodes)} nodes\")",
                                    "start_token": 4425,
                                    "end_token": 4431,
                                    "children": [
                                        {
                                            "type": "attribute",
                                            "label": "logger.info",
                                            "start_token": 4425,
                                            "end_token": 4427,
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "label": "logger",
                                                    "start_token": 4425,
                                                    "end_token": 4425,
                                                    "children": []
                                                },
                                                {
                                                    "type": "identifier",
                                                    "label": "info",
                                                    "start_token": 4427,
                                                    "end_token": 4427,
                                                    "children": []
                                                }
                                            ]
                                        },
                                        {
                                            "type": "argument_list",
                                            "label": "(f\"Fixing LLM credential inputs on {len(broken_nodes)} nodes\")",
                                            "start_token": 4428,
                                            "end_token": 4431,
                                            "children": [
                                                {
                                                    "type": "string",
                                                    "label": "f\"Fixing LLM credential inputs on {len(broken_nodes)} nodes\"",
                                                    "start_token": 4429,
                                                    "end_token": 4430,
                                                    "children": [
                                                        {
                                                            "type": "string_start",
                                                            "label": "f\"",
                                                            "start_token": 4429,
                                                            "end_token": 4430,
                                                            "children": []
                                                        },
                                                        {
                                                            "type": "string_content",
                                                            "label": "Fixing LLM credential inputs on ",
                                                            "start_token": 4430,
                                                            "end_token": 4430,
                                                            "children": []
                                                        },
                                                        {
                                                            "type": "interpolation",
                                                            "label": "{len(broken_nodes)}",
                                                            "start_token": 4430,
                                                            "end_token": 4430,
                                                            "children": [
                                                                {
                                                                    "type": "call",
                                                                    "label": "len(broken_nodes)",
                                                                    "start_token": 4430,
                                                                    "end_token": 4430,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "len",
                                                                            "start_token": 4430,
                                                                            "end_token": 4430,
                                                                            "children": []
                                                                        },
                                                                        {
                                                                            "type": "argument_list",
                                                                            "label": "(broken_nodes)",
                                                                            "start_token": 4430,
                                                                            "end_token": 4430,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "broken_nodes",
                                                                                    "start_token": 4430,
                                                                                    "end_token": 4430,
                                                                                    "children": []
                                                                                }
                                                                            ]
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        },
                                                        {
                                                            "type": "string_content",
                                                            "label": " nodes",
                                                            "start_token": 4430,
                                                            "end_token": 4430,
                                                            "children": []
                                                        },
                                                        {
                                                            "type": "string_end",
                                                            "label": "\"",
                                                            "start_token": 4430,
                                                            "end_token": 4430,
                                                            "children": []
                                                        }
                                                    ]
                                                }
                                            ]
                                        }
                                    ]
                                }
                            ]
                        },
                        {
                            "type": "expression_statement",
                            "label": "user_id: str = \"\"",
                            "start_token": 4434,
                            "end_token": 4438,
                            "children": [
                                {
                                    "type": "assignment",
                                    "label": "user_id: str = \"\"",
                                    "start_token": 4434,
                                    "end_token": 4438,
                                    "children": [
                                        {
                                            "type": "identifier",
                                            "label": "user_id",
                                            "start_token": 4434,
                                            "end_token": 4434,
                                            "children": []
                                        },
                                        {
                                            "type": "type",
                                            "label": "str",
                                            "start_token": 4436,
                                            "end_token": 4436,
                                            "children": [
                                                {
                                                    "type": "identifier",
                                                    "label": "str",
                                                    "start_token": 4436,
                                                    "end_token": 4436,
                                                    "children": []
                                                }
                                            ]
                                        },
                                        {
                                            "type": "string",
                                            "label": "\"\"",
                                            "start_token": 4438,
                                            "end_token": 4438,
                                            "children": [
                                                {
                                                    "type": "string_start",
                                                    "label": "\"",
                                                    "start_token": 4438,
                                                    "end_token": 4438,
                                                    "children": []
                                                },
                                                {
                                                    "type": "string_end",
                                                    "label": "\"",
                                                    "start_token": 4438,
                                                    "end_token": 4438,
                                                    "children": []
                                                }
                                            ]
                                        }
                                    ]
                                }
                            ]
                        },
                        {
                            "type": "expression_statement",
                            "label": "user_integrations = None",
                            "start_token": 4440,
                            "end_token": 4442,
                            "children": [
                                {
                                    "type": "assignment",
                                    "label": "user_integrations = None",
                                    "start_token": 4440,
                                    "end_token": 4442,
                                    "children": [
                                        {
                                            "type": "identifier",
                                            "label": "user_integrations",
                                            "start_token": 4440,
                                            "end_token": 4440,
                                            "children": []
                                        },
                                        {
                                            "type": "none",
                                            "label": "None",
                                            "start_token": 4442,
                                            "end_token": 4442,
                                            "children": []
                                        }
                                    ]
                                }
                            ]
                        },
                        {
                            "type": "for_statement",
                            "label": "for node in broken_nodes:\n        if node[\"user_id\"] != user_id:\n            # Save queries by only fetching once per user\n            user_id = node[\"user_id\"]\n            user_integrations = await get_user_integrations(user_id)\n        elif not user_integrations:\n            raise RuntimeError(f\"Impossible state while processing node {node}\")\n\n        node_id: str = node[\"node_id\"]\n        node_preset_input: dict = json.loads(node[\"node_preset_input\"])\n        credentials_meta: dict = node_preset_input[\"credentials\"]\n\n        credentials = next(\n            (\n                c\n                for c in user_integrations.credentials\n                if c.id == credentials_meta[\"id\"]\n            ),\n            None,\n        )\n        if not credentials:\n            continue\n        if credentials.type != \"api_key\":\n            logger.warning(\n                f\"User {user_id} credentials {credentials.id} with provider 'llm' \"\n                f\"has invalid type '{credentials.type}'\"\n            )\n            continue\n\n        api_key = credentials.api_key.get_secret_value()\n        if api_key.startswith(\"sk-ant-api03-\"):\n            credentials.provider = credentials_meta[\"provider\"] = \"anthropic\"\n        elif api_key.startswith(\"sk-\"):\n            credentials.provider = credentials_meta[\"provider\"] = \"openai\"\n        elif api_key.startswith(\"gsk_\"):\n            credentials.provider = credentials_meta[\"provider\"] = \"groq\"\n        else:\n            logger.warning(\n                f\"Could not identify provider from key prefix {api_key[:13]}*****\"\n            )\n            continue\n\n        store.update_creds(user_id, credentials)\n        await AgentNode.prisma().update(\n            where={\"id\": node_id},\n            data={\"constantInput\": json.dumps(node_preset_input)},\n        )",
                            "start_token": 4444,
                            "end_token": 4726,
                            "children": [
                                {
                                    "type": "identifier",
                                    "label": "node",
                                    "start_token": 4445,
                                    "end_token": 4445,
                                    "children": []
                                },
                                {
                                    "type": "identifier",
                                    "label": "broken_nodes",
                                    "start_token": 4447,
                                    "end_token": 4447,
                                    "children": []
                                },
                                {
                                    "type": "block",
                                    "label": "if node[\"user_id\"] != user_id:\n            # Save queries by only fetching once per user\n            user_id = node[\"user_id\"]\n            user_integrations = await get_user_integrations(user_id)\n        elif not user_integrations:\n            raise RuntimeError(f\"Impossible state while processing node {node}\")\n\n        node_id: str = node[\"node_id\"]\n        node_preset_input: dict = json.loads(node[\"node_preset_input\"])\n        credentials_meta: dict = node_preset_input[\"credentials\"]\n\n        credentials = next(\n            (\n                c\n                for c in user_integrations.credentials\n                if c.id == credentials_meta[\"id\"]\n            ),\n            None,\n        )\n        if not credentials:\n            continue\n        if credentials.type != \"api_key\":\n            logger.warning(\n                f\"User {user_id} credentials {credentials.id} with provider 'llm' \"\n                f\"has invalid type '{credentials.type}'\"\n            )\n            continue\n\n        api_key = credentials.api_key.get_secret_value()\n        if api_key.startswith(\"sk-ant-api03-\"):\n            credentials.provider = credentials_meta[\"provider\"] = \"anthropic\"\n        elif api_key.startswith(\"sk-\"):\n            credentials.provider = credentials_meta[\"provider\"] = \"openai\"\n        elif api_key.startswith(\"gsk_\"):\n            credentials.provider = credentials_meta[\"provider\"] = \"groq\"\n        else:\n            logger.warning(\n                f\"Could not identify provider from key prefix {api_key[:13]}*****\"\n            )\n            continue\n\n        store.update_creds(user_id, credentials)\n        await AgentNode.prisma().update(\n            where={\"id\": node_id},\n            data={\"constantInput\": json.dumps(node_preset_input)},\n        )",
                                    "start_token": 4450,
                                    "end_token": 4726,
                                    "children": [
                                        {
                                            "type": "if_statement",
                                            "label": "if node[\"user_id\"] != user_id:\n            # Save queries by only fetching once per user\n            user_id = node[\"user_id\"]\n            user_integrations = await get_user_integrations(user_id)\n        elif not user_integrations:\n            raise RuntimeError(f\"Impossible state while processing node {node}\")",
                                            "start_token": 4450,
                                            "end_token": 4495,
                                            "children": [
                                                {
                                                    "type": "comparison_operator",
                                                    "label": "node[\"user_id\"] != user_id",
                                                    "start_token": 4451,
                                                    "end_token": 4457,
                                                    "children": [
                                                        {
                                                            "type": "subscript",
                                                            "label": "node[\"user_id\"]",
                                                            "start_token": 4451,
                                                            "end_token": 4454,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "label": "node",
                                                                    "start_token": 4451,
                                                                    "end_token": 4451,
                                                                    "children": []
                                                                },
                                                                {
                                                                    "type": "string",
                                                                    "label": "\"user_id\"",
                                                                    "start_token": 4453,
                                                                    "end_token": 4453,
                                                                    "children": [
                                                                        {
                                                                            "type": "string_start",
                                                                            "label": "\"",
                                                                            "start_token": 4453,
                                                                            "end_token": 4453,
                                                                            "children": []
                                                                        },
                                                                        {
                                                                            "type": "string_content",
                                                                            "label": "user_id",
                                                                            "start_token": 4453,
                                                                            "end_token": 4453,
                                                                            "children": []
                                                                        },
                                                                        {
                                                                            "type": "string_end",
                                                                            "label": "\"",
                                                                            "start_token": 4453,
                                                                            "end_token": 4453,
                                                                            "children": []
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        },
                                                        {
                                                            "type": "identifier",
                                                            "label": "user_id",
                                                            "start_token": 4457,
                                                            "end_token": 4457,
                                                            "children": []
                                                        }
                                                    ]
                                                },
                                                {
                                                    "type": "comment",
                                                    "label": "# Save queries by only fetching once per user",
                                                    "start_token": 4460,
                                                    "end_token": 4468,
                                                    "children": []
                                                },
                                                {
                                                    "type": "block",
                                                    "label": "user_id = node[\"user_id\"]\n            user_integrations = await get_user_integrations(user_id)",
                                                    "start_token": 4470,
                                                    "end_token": 4483,
                                                    "children": [
                                                        {
                                                            "type": "expression_statement",
                                                            "label": "user_id = node[\"user_id\"]",
                                                            "start_token": 4470,
                                                            "end_token": 4475,
                                                            "children": [
                                                                {
                                                                    "type": "assignment",
                                                                    "label": "user_id = node[\"user_id\"]",
                                                                    "start_token": 4470,
                                                                    "end_token": 4475,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "user_id",
                                                                            "start_token": 4470,
                                                                            "end_token": 4470,
                                                                            "children": []
                                                                        },
                                                                        {
                                                                            "type": "subscript",
                                                                            "label": "node[\"user_id\"]",
                                                                            "start_token": 4472,
                                                                            "end_token": 4475,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "node",
                                                                                    "start_token": 4472,
                                                                                    "end_token": 4472,
                                                                                    "children": []
                                                                                },
                                                                                {
                                                                                    "type": "string",
                                                                                    "label": "\"user_id\"",
                                                                                    "start_token": 4474,
                                                                                    "end_token": 4474,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "string_start",
                                                                                            "label": "\"",
                                                                                            "start_token": 4474,
                                                                                            "end_token": 4474,
                                                                                            "children": []
                                                                                        },
                                                                                        {
                                                                                            "type": "string_content",
                                                                                            "label": "user_id",
                                                                                            "start_token": 4474,
                                                                                            "end_token": 4474,
                                                                                            "children": []
                                                                                        },
                                                                                        {
                                                                                            "type": "string_end",
                                                                                            "label": "\"",
                                                                                            "start_token": 4474,
                                                                                            "end_token": 4474,
                                                                                            "children": []
                                                                                        }
                                                                                    ]
                                                                                }
                                                                            ]
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        },
                                                        {
                                                            "type": "expression_statement",
                                                            "label": "user_integrations = await get_user_integrations(user_id)",
                                                            "start_token": 4477,
                                                            "end_token": 4483,
                                                            "children": [
                                                                {
                                                                    "type": "assignment",
                                                                    "label": "user_integrations = await get_user_integrations(user_id)",
                                                                    "start_token": 4477,
                                                                    "end_token": 4483,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "user_integrations",
                                                                            "start_token": 4477,
                                                                            "end_token": 4477,
                                                                            "children": []
                                                                        },
                                                                        {
                                                                            "type": "await",
                                                                            "label": "await get_user_integrations(user_id)",
                                                                            "start_token": 4479,
                                                                            "end_token": 4483,
                                                                            "children": [
                                                                                {
                                                                                    "type": "call",
                                                                                    "label": "get_user_integrations(user_id)",
                                                                                    "start_token": 4480,
                                                                                    "end_token": 4483,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "label": "get_user_integrations",
                                                                                            "start_token": 4480,
                                                                                            "end_token": 4480,
                                                                                            "children": []
                                                                                        },
                                                                                        {
                                                                                            "type": "argument_list",
                                                                                            "label": "(user_id)",
                                                                                            "start_token": 4481,
                                                                                            "end_token": 4483,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "label": "user_id",
                                                                                                    "start_token": 4482,
                                                                                                    "end_token": 4482,
                                                                                                    "children": []
                                                                                                }
                                                                                            ]
                                                                                        }
                                                                                    ]
                                                                                }
                                                                            ]
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                },
                                                {
                                                    "type": "elif_clause",
                                                    "label": "elif not user_integrations:\n            raise RuntimeError(f\"Impossible state while processing node {node}\")",
                                                    "start_token": 4485,
                                                    "end_token": 4495,
                                                    "children": [
                                                        {
                                                            "type": "not_operator",
                                                            "label": "not user_integrations",
                                                            "start_token": 4486,
                                                            "end_token": 4487,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "label": "user_integrations",
                                                                    "start_token": 4487,
                                                                    "end_token": 4487,
                                                                    "children": []
                                                                }
                                                            ]
                                                        },
                                                        {
                                                            "type": "block",
                                                            "label": "raise RuntimeError(f\"Impossible state while processing node {node}\")",
                                                            "start_token": 4490,
                                                            "end_token": 4495,
                                                            "children": [
                                                                {
                                                                    "type": "raise_statement",
                                                                    "label": "raise RuntimeError(f\"Impossible state while processing node {node}\")",
                                                                    "start_token": 4490,
                                                                    "end_token": 4495,
                                                                    "children": [
                                                                        {
                                                                            "type": "call",
                                                                            "label": "RuntimeError(f\"Impossible state while processing node {node}\")",
                                                                            "start_token": 4491,
                                                                            "end_token": 4495,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "RuntimeError",
                                                                                    "start_token": 4491,
                                                                                    "end_token": 4491,
                                                                                    "children": []
                                                                                },
                                                                                {
                                                                                    "type": "argument_list",
                                                                                    "label": "(f\"Impossible state while processing node {node}\")",
                                                                                    "start_token": 4492,
                                                                                    "end_token": 4495,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "string",
                                                                                            "label": "f\"Impossible state while processing node {node}\"",
                                                                                            "start_token": 4493,
                                                                                            "end_token": 4494,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "string_start",
                                                                                                    "label": "f\"",
                                                                                                    "start_token": 4493,
                                                                                                    "end_token": 4494,
                                                                                                    "children": []
                                                                                                },
                                                                                                {
                                                                                                    "type": "string_content",
                                                                                                    "label": "Impossible state while processing node ",
                                                                                                    "start_token": 4494,
                                                                                                    "end_token": 4494,
                                                                                                    "children": []
                                                                                                },
                                                                                                {
                                                                                                    "type": "interpolation",
                                                                                                    "label": "{node}",
                                                                                                    "start_token": 4494,
                                                                                                    "end_token": 4494,
                                                                                                    "children": [
                                                                                                        {
                                                                                                            "type": "identifier",
                                                                                                            "label": "node",
                                                                                                            "start_token": 4494,
                                                                                                            "end_token": 4494,
                                                                                                            "children": []
                                                                                                        }
                                                                                                    ]
                                                                                                },
                                                                                                {
                                                                                                    "type": "string_end",
                                                                                                    "label": "\"",
                                                                                                    "start_token": 4494,
                                                                                                    "end_token": 4494,
                                                                                                    "children": []
                                                                                                }
                                                                                            ]
                                                                                        }
                                                                                    ]
                                                                                }
                                                                            ]
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                }
                                            ]
                                        },
                                        {
                                            "type": "expression_statement",
                                            "label": "node_id: str = node[\"node_id\"]",
                                            "start_token": 4498,
                                            "end_token": 4505,
                                            "children": [
                                                {
                                                    "type": "assignment",
                                                    "label": "node_id: str = node[\"node_id\"]",
                                                    "start_token": 4498,
                                                    "end_token": 4505,
                                                    "children": [
                                                        {
                                                            "type": "identifier",
                                                            "label": "node_id",
                                                            "start_token": 4498,
                                                            "end_token": 4498,
                                                            "children": []
                                                        },
                                                        {
                                                            "type": "type",
                                                            "label": "str",
                                                            "start_token": 4500,
                                                            "end_token": 4500,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "label": "str",
                                                                    "start_token": 4500,
                                                                    "end_token": 4500,
                                                                    "children": []
                                                                }
                                                            ]
                                                        },
                                                        {
                                                            "type": "subscript",
                                                            "label": "node[\"node_id\"]",
                                                            "start_token": 4502,
                                                            "end_token": 4505,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "label": "node",
                                                                    "start_token": 4502,
                                                                    "end_token": 4502,
                                                                    "children": []
                                                                },
                                                                {
                                                                    "type": "string",
                                                                    "label": "\"node_id\"",
                                                                    "start_token": 4504,
                                                                    "end_token": 4504,
                                                                    "children": [
                                                                        {
                                                                            "type": "string_start",
                                                                            "label": "\"",
                                                                            "start_token": 4504,
                                                                            "end_token": 4504,
                                                                            "children": []
                                                                        },
                                                                        {
                                                                            "type": "string_content",
                                                                            "label": "node_id",
                                                                            "start_token": 4504,
                                                                            "end_token": 4504,
                                                                            "children": []
                                                                        },
                                                                        {
                                                                            "type": "string_end",
                                                                            "label": "\"",
                                                                            "start_token": 4504,
                                                                            "end_token": 4504,
                                                                            "children": []
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                }
                                            ]
                                        },
                                        {
                                            "type": "expression_statement",
                                            "label": "node_preset_input: dict = json.loads(node[\"node_preset_input\"])",
                                            "start_token": 4507,
                                            "end_token": 4519,
                                            "children": [
                                                {
                                                    "type": "assignment",
                                                    "label": "node_preset_input: dict = json.loads(node[\"node_preset_input\"])",
                                                    "start_token": 4507,
                                                    "end_token": 4519,
                                                    "children": [
                                                        {
                                                            "type": "identifier",
                                                            "label": "node_preset_input",
                                                            "start_token": 4507,
                                                            "end_token": 4507,
                                                            "children": []
                                                        },
                                                        {
                                                            "type": "type",
                                                            "label": "dict",
                                                            "start_token": 4509,
                                                            "end_token": 4509,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "label": "dict",
                                                                    "start_token": 4509,
                                                                    "end_token": 4509,
                                                                    "children": []
                                                                }
                                                            ]
                                                        },
                                                        {
                                                            "type": "call",
                                                            "label": "json.loads(node[\"node_preset_input\"])",
                                                            "start_token": 4511,
                                                            "end_token": 4519,
                                                            "children": [
                                                                {
                                                                    "type": "attribute",
                                                                    "label": "json.loads",
                                                                    "start_token": 4511,
                                                                    "end_token": 4513,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "json",
                                                                            "start_token": 4511,
                                                                            "end_token": 4511,
                                                                            "children": []
                                                                        },
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "loads",
                                                                            "start_token": 4513,
                                                                            "end_token": 4513,
                                                                            "children": []
                                                                        }
                                                                    ]
                                                                },
                                                                {
                                                                    "type": "argument_list",
                                                                    "label": "(node[\"node_preset_input\"])",
                                                                    "start_token": 4514,
                                                                    "end_token": 4519,
                                                                    "children": [
                                                                        {
                                                                            "type": "subscript",
                                                                            "label": "node[\"node_preset_input\"]",
                                                                            "start_token": 4515,
                                                                            "end_token": 4518,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "node",
                                                                                    "start_token": 4515,
                                                                                    "end_token": 4515,
                                                                                    "children": []
                                                                                },
                                                                                {
                                                                                    "type": "string",
                                                                                    "label": "\"node_preset_input\"",
                                                                                    "start_token": 4517,
                                                                                    "end_token": 4517,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "string_start",
                                                                                            "label": "\"",
                                                                                            "start_token": 4517,
                                                                                            "end_token": 4517,
                                                                                            "children": []
                                                                                        },
                                                                                        {
                                                                                            "type": "string_content",
                                                                                            "label": "node_preset_input",
                                                                                            "start_token": 4517,
                                                                                            "end_token": 4517,
                                                                                            "children": []
                                                                                        },
                                                                                        {
                                                                                            "type": "string_end",
                                                                                            "label": "\"",
                                                                                            "start_token": 4517,
                                                                                            "end_token": 4517,
                                                                                            "children": []
                                                                                        }
                                                                                    ]
                                                                                }
                                                                            ]
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                }
                                            ]
                                        },
                                        {
                                            "type": "expression_statement",
                                            "label": "credentials_meta: dict = node_preset_input[\"credentials\"]",
                                            "start_token": 4521,
                                            "end_token": 4528,
                                            "children": [
                                                {
                                                    "type": "assignment",
                                                    "label": "credentials_meta: dict = node_preset_input[\"credentials\"]",
                                                    "start_token": 4521,
                                                    "end_token": 4528,
                                                    "children": [
                                                        {
                                                            "type": "identifier",
                                                            "label": "credentials_meta",
                                                            "start_token": 4521,
                                                            "end_token": 4521,
                                                            "children": []
                                                        },
                                                        {
                                                            "type": "type",
                                                            "label": "dict",
                                                            "start_token": 4523,
                                                            "end_token": 4523,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "label": "dict",
                                                                    "start_token": 4523,
                                                                    "end_token": 4523,
                                                                    "children": []
                                                                }
                                                            ]
                                                        },
                                                        {
                                                            "type": "subscript",
                                                            "label": "node_preset_input[\"credentials\"]",
                                                            "start_token": 4525,
                                                            "end_token": 4528,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "label": "node_preset_input",
                                                                    "start_token": 4525,
                                                                    "end_token": 4525,
                                                                    "children": []
                                                                },
                                                                {
                                                                    "type": "string",
                                                                    "label": "\"credentials\"",
                                                                    "start_token": 4527,
                                                                    "end_token": 4527,
                                                                    "children": [
                                                                        {
                                                                            "type": "string_start",
                                                                            "label": "\"",
                                                                            "start_token": 4527,
                                                                            "end_token": 4527,
                                                                            "children": []
                                                                        },
                                                                        {
                                                                            "type": "string_content",
                                                                            "label": "credentials",
                                                                            "start_token": 4527,
                                                                            "end_token": 4527,
                                                                            "children": []
                                                                        },
                                                                        {
                                                                            "type": "string_end",
                                                                            "label": "\"",
                                                                            "start_token": 4527,
                                                                            "end_token": 4527,
                                                                            "children": []
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                }
                                            ]
                                        },
                                        {
                                            "type": "expression_statement",
                                            "label": "credentials = next(\n            (\n                c\n                for c in user_integrations.credentials\n                if c.id == credentials_meta[\"id\"]\n            ),\n            None,\n        )",
                                            "start_token": 4531,
                                            "end_token": 4564,
                                            "children": [
                                                {
                                                    "type": "assignment",
                                                    "label": "credentials = next(\n            (\n                c\n                for c in user_integrations.credentials\n                if c.id == credentials_meta[\"id\"]\n            ),\n            None,\n        )",
                                                    "start_token": 4531,
                                                    "end_token": 4564,
                                                    "children": [
                                                        {
                                                            "type": "identifier",
                                                            "label": "credentials",
                                                            "start_token": 4531,
                                                            "end_token": 4531,
                                                            "children": []
                                                        },
                                                        {
                                                            "type": "call",
                                                            "label": "next(\n            (\n                c\n                for c in user_integrations.credentials\n                if c.id == credentials_meta[\"id\"]\n            ),\n            None,\n        )",
                                                            "start_token": 4533,
                                                            "end_token": 4564,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "label": "next",
                                                                    "start_token": 4533,
                                                                    "end_token": 4533,
                                                                    "children": []
                                                                },
                                                                {
                                                                    "type": "argument_list",
                                                                    "label": "(\n            (\n                c\n                for c in user_integrations.credentials\n                if c.id == credentials_meta[\"id\"]\n            ),\n            None,\n        )",
                                                                    "start_token": 4534,
                                                                    "end_token": 4564,
                                                                    "children": [
                                                                        {
                                                                            "type": "generator_expression",
                                                                            "label": "(\n                c\n                for c in user_integrations.credentials\n                if c.id == credentials_meta[\"id\"]\n            )",
                                                                            "start_token": 4536,
                                                                            "end_token": 4558,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "c",
                                                                                    "start_token": 4538,
                                                                                    "end_token": 4538,
                                                                                    "children": []
                                                                                },
                                                                                {
                                                                                    "type": "for_in_clause",
                                                                                    "label": "for c in user_integrations.credentials",
                                                                                    "start_token": 4540,
                                                                                    "end_token": 4545,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "label": "c",
                                                                                            "start_token": 4541,
                                                                                            "end_token": 4541,
                                                                                            "children": []
                                                                                        },
                                                                                        {
                                                                                            "type": "attribute",
                                                                                            "label": "user_integrations.credentials",
                                                                                            "start_token": 4543,
                                                                                            "end_token": 4545,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "label": "user_integrations",
                                                                                                    "start_token": 4543,
                                                                                                    "end_token": 4543,
                                                                                                    "children": []
                                                                                                },
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "label": "credentials",
                                                                                                    "start_token": 4545,
                                                                                                    "end_token": 4545,
                                                                                                    "children": []
                                                                                                }
                                                                                            ]
                                                                                        }
                                                                                    ]
                                                                                },
                                                                                {
                                                                                    "type": "if_clause",
                                                                                    "label": "if c.id == credentials_meta[\"id\"]",
                                                                                    "start_token": 4547,
                                                                                    "end_token": 4556,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "comparison_operator",
                                                                                            "label": "c.id == credentials_meta[\"id\"]",
                                                                                            "start_token": 4548,
                                                                                            "end_token": 4556,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "attribute",
                                                                                                    "label": "c.id",
                                                                                                    "start_token": 4548,
                                                                                                    "end_token": 4550,
                                                                                                    "children": [
                                                                                                        {
                                                                                                            "type": "identifier",
                                                                                                            "label": "c",
                                                                                                            "start_token": 4548,
                                                                                                            "end_token": 4548,
                                                                                                            "children": []
                                                                                                        },
                                                                                                        {
                                                                                                            "type": "identifier",
                                                                                                            "label": "id",
                                                                                                            "start_token": 4550,
                                                                                                            "end_token": 4550,
                                                                                                            "children": []
                                                                                                        }
                                                                                                    ]
                                                                                                },
                                                                                                {
                                                                                                    "type": "subscript",
                                                                                                    "label": "credentials_meta[\"id\"]",
                                                                                                    "start_token": 4553,
                                                                                                    "end_token": 4556,
                                                                                                    "children": [
                                                                                                        {
                                                                                                            "type": "identifier",
                                                                                                            "label": "credentials_meta",
                                                                                                            "start_token": 4553,
                                                                                                            "end_token": 4553,
                                                                                                            "children": []
                                                                                                        },
                                                                                                        {
                                                                                                            "type": "string",
                                                                                                            "label": "\"id\"",
                                                                                                            "start_token": 4555,
                                                                                                            "end_token": 4555,
                                                                                                            "children": [
                                                                                                                {
                                                                                                                    "type": "string_start",
                                                                                                                    "label": "\"",
                                                                                                                    "start_token": 4555,
                                                                                                                    "end_token": 4555,
                                                                                                                    "children": []
                                                                                                                },
                                                                                                                {
                                                                                                                    "type": "string_content",
                                                                                                                    "label": "id",
                                                                                                                    "start_token": 4555,
                                                                                                                    "end_token": 4555,
                                                                                                                    "children": []
                                                                                                                },
                                                                                                                {
                                                                                                                    "type": "string_end",
                                                                                                                    "label": "\"",
                                                                                                                    "start_token": 4555,
                                                                                                                    "end_token": 4555,
                                                                                                                    "children": []
                                                                                                                }
                                                                                                            ]
                                                                                                        }
                                                                                                    ]
                                                                                                }
                                                                                            ]
                                                                                        }
                                                                                    ]
                                                                                }
                                                                            ]
                                                                        },
                                                                        {
                                                                            "type": "none",
                                                                            "label": "None",
                                                                            "start_token": 4561,
                                                                            "end_token": 4561,
                                                                            "children": []
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                }
                                            ]
                                        },
                                        {
                                            "type": "if_statement",
                                            "label": "if not credentials:\n            continue",
                                            "start_token": 4566,
                                            "end_token": 4571,
                                            "children": [
                                                {
                                                    "type": "not_operator",
                                                    "label": "not credentials",
                                                    "start_token": 4567,
                                                    "end_token": 4568,
                                                    "children": [
                                                        {
                                                            "type": "identifier",
                                                            "label": "credentials",
                                                            "start_token": 4568,
                                                            "end_token": 4568,
                                                            "children": []
                                                        }
                                                    ]
                                                },
                                                {
                                                    "type": "block",
                                                    "label": "continue",
                                                    "start_token": 4571,
                                                    "end_token": 4571,
                                                    "children": [
                                                        {
                                                            "type": "continue_statement",
                                                            "label": "continue",
                                                            "start_token": 4571,
                                                            "end_token": 4571,
                                                            "children": []
                                                        }
                                                    ]
                                                }
                                            ]
                                        },
                                        {
                                            "type": "if_statement",
                                            "label": "if credentials.type != \"api_key\":\n            logger.warning(\n                f\"User {user_id} credentials {credentials.id} with provider 'llm' \"\n                f\"has invalid type '{credentials.type}'\"\n            )\n            continue",
                                            "start_token": 4573,
                                            "end_token": 4595,
                                            "children": [
                                                {
                                                    "type": "comparison_operator",
                                                    "label": "credentials.type != \"api_key\"",
                                                    "start_token": 4574,
                                                    "end_token": 4579,
                                                    "children": [
                                                        {
                                                            "type": "attribute",
                                                            "label": "credentials.type",
                                                            "start_token": 4574,
                                                            "end_token": 4576,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "label": "credentials",
                                                                    "start_token": 4574,
                                                                    "end_token": 4574,
                                                                    "children": []
                                                                },
                                                                {
                                                                    "type": "identifier",
                                                                    "label": "type",
                                                                    "start_token": 4576,
                                                                    "end_token": 4576,
                                                                    "children": []
                                                                }
                                                            ]
                                                        },
                                                        {
                                                            "type": "string",
                                                            "label": "\"api_key\"",
                                                            "start_token": 4579,
                                                            "end_token": 4579,
                                                            "children": [
                                                                {
                                                                    "type": "string_start",
                                                                    "label": "\"",
                                                                    "start_token": 4579,
                                                                    "end_token": 4579,
                                                                    "children": []
                                                                },
                                                                {
                                                                    "type": "string_content",
                                                                    "label": "api_key",
                                                                    "start_token": 4579,
                                                                    "end_token": 4579,
                                                                    "children": []
                                                                },
                                                                {
                                                                    "type": "string_end",
                                                                    "label": "\"",
                                                                    "start_token": 4579,
                                                                    "end_token": 4579,
                                                                    "children": []
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                },
                                                {
                                                    "type": "block",
                                                    "label": "logger.warning(\n                f\"User {user_id} credentials {credentials.id} with provider 'llm' \"\n                f\"has invalid type '{credentials.type}'\"\n            )\n            continue",
                                                    "start_token": 4582,
                                                    "end_token": 4595,
                                                    "children": [
                                                        {
                                                            "type": "expression_statement",
                                                            "label": "logger.warning(\n                f\"User {user_id} credentials {credentials.id} with provider 'llm' \"\n                f\"has invalid type '{credentials.type}'\"\n            )",
                                                            "start_token": 4582,
                                                            "end_token": 4593,
                                                            "children": [
                                                                {
                                                                    "type": "call",
                                                                    "label": "logger.warning(\n                f\"User {user_id} credentials {credentials.id} with provider 'llm' \"\n                f\"has invalid type '{credentials.type}'\"\n            )",
                                                                    "start_token": 4582,
                                                                    "end_token": 4593,
                                                                    "children": [
                                                                        {
                                                                            "type": "attribute",
                                                                            "label": "logger.warning",
                                                                            "start_token": 4582,
                                                                            "end_token": 4584,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "logger",
                                                                                    "start_token": 4582,
                                                                                    "end_token": 4582,
                                                                                    "children": []
                                                                                },
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "warning",
                                                                                    "start_token": 4584,
                                                                                    "end_token": 4584,
                                                                                    "children": []
                                                                                }
                                                                            ]
                                                                        },
                                                                        {
                                                                            "type": "argument_list",
                                                                            "label": "(\n                f\"User {user_id} credentials {credentials.id} with provider 'llm' \"\n                f\"has invalid type '{credentials.type}'\"\n            )",
                                                                            "start_token": 4585,
                                                                            "end_token": 4593,
                                                                            "children": [
                                                                                {
                                                                                    "type": "concatenated_string",
                                                                                    "label": "f\"User {user_id} credentials {credentials.id} with provider 'llm' \"\n                f\"has invalid type '{credentials.type}'\"",
                                                                                    "start_token": 4587,
                                                                                    "end_token": 4591,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "string",
                                                                                            "label": "f\"User {user_id} credentials {credentials.id} with provider 'llm' \"",
                                                                                            "start_token": 4587,
                                                                                            "end_token": 4588,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "string_start",
                                                                                                    "label": "f\"",
                                                                                                    "start_token": 4587,
                                                                                                    "end_token": 4588,
                                                                                                    "children": []
                                                                                                },
                                                                                                {
                                                                                                    "type": "string_content",
                                                                                                    "label": "User ",
                                                                                                    "start_token": 4588,
                                                                                                    "end_token": 4588,
                                                                                                    "children": []
                                                                                                },
                                                                                                {
                                                                                                    "type": "interpolation",
                                                                                                    "label": "{user_id}",
                                                                                                    "start_token": 4588,
                                                                                                    "end_token": 4588,
                                                                                                    "children": [
                                                                                                        {
                                                                                                            "type": "identifier",
                                                                                                            "label": "user_id",
                                                                                                            "start_token": 4588,
                                                                                                            "end_token": 4588,
                                                                                                            "children": []
                                                                                                        }
                                                                                                    ]
                                                                                                },
                                                                                                {
                                                                                                    "type": "string_content",
                                                                                                    "label": " credentials ",
                                                                                                    "start_token": 4588,
                                                                                                    "end_token": 4588,
                                                                                                    "children": []
                                                                                                },
                                                                                                {
                                                                                                    "type": "interpolation",
                                                                                                    "label": "{credentials.id}",
                                                                                                    "start_token": 4588,
                                                                                                    "end_token": 4588,
                                                                                                    "children": [
                                                                                                        {
                                                                                                            "type": "attribute",
                                                                                                            "label": "credentials.id",
                                                                                                            "start_token": 4588,
                                                                                                            "end_token": 4588,
                                                                                                            "children": [
                                                                                                                {
                                                                                                                    "type": "identifier",
                                                                                                                    "label": "credentials",
                                                                                                                    "start_token": 4588,
                                                                                                                    "end_token": 4588,
                                                                                                                    "children": []
                                                                                                                },
                                                                                                                {
                                                                                                                    "type": "identifier",
                                                                                                                    "label": "id",
                                                                                                                    "start_token": 4588,
                                                                                                                    "end_token": 4588,
                                                                                                                    "children": []
                                                                                                                }
                                                                                                            ]
                                                                                                        }
                                                                                                    ]
                                                                                                },
                                                                                                {
                                                                                                    "type": "string_content",
                                                                                                    "label": " with provider 'llm' ",
                                                                                                    "start_token": 4588,
                                                                                                    "end_token": 4588,
                                                                                                    "children": []
                                                                                                },
                                                                                                {
                                                                                                    "type": "string_end",
                                                                                                    "label": "\"",
                                                                                                    "start_token": 4588,
                                                                                                    "end_token": 4588,
                                                                                                    "children": []
                                                                                                }
                                                                                            ]
                                                                                        },
                                                                                        {
                                                                                            "type": "string",
                                                                                            "label": "f\"has invalid type '{credentials.type}'\"",
                                                                                            "start_token": 4590,
                                                                                            "end_token": 4591,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "string_start",
                                                                                                    "label": "f\"",
                                                                                                    "start_token": 4590,
                                                                                                    "end_token": 4591,
                                                                                                    "children": []
                                                                                                },
                                                                                                {
                                                                                                    "type": "string_content",
                                                                                                    "label": "has invalid type '",
                                                                                                    "start_token": 4591,
                                                                                                    "end_token": 4591,
                                                                                                    "children": []
                                                                                                },
                                                                                                {
                                                                                                    "type": "interpolation",
                                                                                                    "label": "{credentials.type}",
                                                                                                    "start_token": 4591,
                                                                                                    "end_token": 4591,
                                                                                                    "children": [
                                                                                                        {
                                                                                                            "type": "attribute",
                                                                                                            "label": "credentials.type",
                                                                                                            "start_token": 4591,
                                                                                                            "end_token": 4591,
                                                                                                            "children": [
                                                                                                                {
                                                                                                                    "type": "identifier",
                                                                                                                    "label": "credentials",
                                                                                                                    "start_token": 4591,
                                                                                                                    "end_token": 4591,
                                                                                                                    "children": []
                                                                                                                },
                                                                                                                {
                                                                                                                    "type": "identifier",
                                                                                                                    "label": "type",
                                                                                                                    "start_token": 4591,
                                                                                                                    "end_token": 4591,
                                                                                                                    "children": []
                                                                                                                }
                                                                                                            ]
                                                                                                        }
                                                                                                    ]
                                                                                                },
                                                                                                {
                                                                                                    "type": "string_content",
                                                                                                    "label": "'",
                                                                                                    "start_token": 4591,
                                                                                                    "end_token": 4591,
                                                                                                    "children": []
                                                                                                },
                                                                                                {
                                                                                                    "type": "string_end",
                                                                                                    "label": "\"",
                                                                                                    "start_token": 4591,
                                                                                                    "end_token": 4591,
                                                                                                    "children": []
                                                                                                }
                                                                                            ]
                                                                                        }
                                                                                    ]
                                                                                }
                                                                            ]
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        },
                                                        {
                                                            "type": "continue_statement",
                                                            "label": "continue",
                                                            "start_token": 4595,
                                                            "end_token": 4595,
                                                            "children": []
                                                        }
                                                    ]
                                                }
                                            ]
                                        },
                                        {
                                            "type": "expression_statement",
                                            "label": "api_key = credentials.api_key.get_secret_value()",
                                            "start_token": 4598,
                                            "end_token": 4606,
                                            "children": [
                                                {
                                                    "type": "assignment",
                                                    "label": "api_key = credentials.api_key.get_secret_value()",
                                                    "start_token": 4598,
                                                    "end_token": 4606,
                                                    "children": [
                                                        {
                                                            "type": "identifier",
                                                            "label": "api_key",
                                                            "start_token": 4598,
                                                            "end_token": 4598,
                                                            "children": []
                                                        },
                                                        {
                                                            "type": "call",
                                                            "label": "credentials.api_key.get_secret_value()",
                                                            "start_token": 4600,
                                                            "end_token": 4606,
                                                            "children": [
                                                                {
                                                                    "type": "attribute",
                                                                    "label": "credentials.api_key.get_secret_value",
                                                                    "start_token": 4600,
                                                                    "end_token": 4604,
                                                                    "children": [
                                                                        {
                                                                            "type": "attribute",
                                                                            "label": "credentials.api_key",
                                                                            "start_token": 4600,
                                                                            "end_token": 4602,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "credentials",
                                                                                    "start_token": 4600,
                                                                                    "end_token": 4600,
                                                                                    "children": []
                                                                                },
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "api_key",
                                                                                    "start_token": 4602,
                                                                                    "end_token": 4602,
                                                                                    "children": []
                                                                                }
                                                                            ]
                                                                        },
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "get_secret_value",
                                                                            "start_token": 4604,
                                                                            "end_token": 4604,
                                                                            "children": []
                                                                        }
                                                                    ]
                                                                },
                                                                {
                                                                    "type": "argument_list",
                                                                    "label": "()",
                                                                    "start_token": 4605,
                                                                    "end_token": 4606,
                                                                    "children": []
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                }
                                            ]
                                        },
                                        {
                                            "type": "if_statement",
                                            "label": "if api_key.startswith(\"sk-ant-api03-\"):\n            credentials.provider = credentials_meta[\"provider\"] = \"anthropic\"\n        elif api_key.startswith(\"sk-\"):\n            credentials.provider = credentials_meta[\"provider\"] = \"openai\"\n        elif api_key.startswith(\"gsk_\"):\n            credentials.provider = credentials_meta[\"provider\"] = \"groq\"\n        else:\n            logger.warning(\n                f\"Could not identify provider from key prefix {api_key[:13]}*****\"\n            )\n            continue",
                                            "start_token": 4608,
                                            "end_token": 4681,
                                            "children": [
                                                {
                                                    "type": "call",
                                                    "label": "api_key.startswith(\"sk-ant-api03-\")",
                                                    "start_token": 4609,
                                                    "end_token": 4614,
                                                    "children": [
                                                        {
                                                            "type": "attribute",
                                                            "label": "api_key.startswith",
                                                            "start_token": 4609,
                                                            "end_token": 4611,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "label": "api_key",
                                                                    "start_token": 4609,
                                                                    "end_token": 4609,
                                                                    "children": []
                                                                },
                                                                {
                                                                    "type": "identifier",
                                                                    "label": "startswith",
                                                                    "start_token": 4611,
                                                                    "end_token": 4611,
                                                                    "children": []
                                                                }
                                                            ]
                                                        },
                                                        {
                                                            "type": "argument_list",
                                                            "label": "(\"sk-ant-api03-\")",
                                                            "start_token": 4612,
                                                            "end_token": 4614,
                                                            "children": [
                                                                {
                                                                    "type": "string",
                                                                    "label": "\"sk-ant-api03-\"",
                                                                    "start_token": 4613,
                                                                    "end_token": 4613,
                                                                    "children": [
                                                                        {
                                                                            "type": "string_start",
                                                                            "label": "\"",
                                                                            "start_token": 4613,
                                                                            "end_token": 4613,
                                                                            "children": []
                                                                        },
                                                                        {
                                                                            "type": "string_content",
                                                                            "label": "sk-ant-api03-",
                                                                            "start_token": 4613,
                                                                            "end_token": 4613,
                                                                            "children": []
                                                                        },
                                                                        {
                                                                            "type": "string_end",
                                                                            "label": "\"",
                                                                            "start_token": 4613,
                                                                            "end_token": 4613,
                                                                            "children": []
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                },
                                                {
                                                    "type": "block",
                                                    "label": "credentials.provider = credentials_meta[\"provider\"] = \"anthropic\"",
                                                    "start_token": 4617,
                                                    "end_token": 4626,
                                                    "children": [
                                                        {
                                                            "type": "expression_statement",
                                                            "label": "credentials.provider = credentials_meta[\"provider\"] = \"anthropic\"",
                                                            "start_token": 4617,
                                                            "end_token": 4626,
                                                            "children": [
                                                                {
                                                                    "type": "assignment",
                                                                    "label": "credentials.provider = credentials_meta[\"provider\"] = \"anthropic\"",
                                                                    "start_token": 4617,
                                                                    "end_token": 4626,
                                                                    "children": [
                                                                        {
                                                                            "type": "attribute",
                                                                            "label": "credentials.provider",
                                                                            "start_token": 4617,
                                                                            "end_token": 4619,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "credentials",
                                                                                    "start_token": 4617,
                                                                                    "end_token": 4617,
                                                                                    "children": []
                                                                                },
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "provider",
                                                                                    "start_token": 4619,
                                                                                    "end_token": 4619,
                                                                                    "children": []
                                                                                }
                                                                            ]
                                                                        },
                                                                        {
                                                                            "type": "assignment",
                                                                            "label": "credentials_meta[\"provider\"] = \"anthropic\"",
                                                                            "start_token": 4621,
                                                                            "end_token": 4626,
                                                                            "children": [
                                                                                {
                                                                                    "type": "subscript",
                                                                                    "label": "credentials_meta[\"provider\"]",
                                                                                    "start_token": 4621,
                                                                                    "end_token": 4624,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "label": "credentials_meta",
                                                                                            "start_token": 4621,
                                                                                            "end_token": 4621,
                                                                                            "children": []
                                                                                        },
                                                                                        {
                                                                                            "type": "string",
                                                                                            "label": "\"provider\"",
                                                                                            "start_token": 4623,
                                                                                            "end_token": 4623,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "string_start",
                                                                                                    "label": "\"",
                                                                                                    "start_token": 4623,
                                                                                                    "end_token": 4623,
                                                                                                    "children": []
                                                                                                },
                                                                                                {
                                                                                                    "type": "string_content",
                                                                                                    "label": "provider",
                                                                                                    "start_token": 4623,
                                                                                                    "end_token": 4623,
                                                                                                    "children": []
                                                                                                },
                                                                                                {
                                                                                                    "type": "string_end",
                                                                                                    "label": "\"",
                                                                                                    "start_token": 4623,
                                                                                                    "end_token": 4623,
                                                                                                    "children": []
                                                                                                }
                                                                                            ]
                                                                                        }
                                                                                    ]
                                                                                },
                                                                                {
                                                                                    "type": "string",
                                                                                    "label": "\"anthropic\"",
                                                                                    "start_token": 4626,
                                                                                    "end_token": 4626,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "string_start",
                                                                                            "label": "\"",
                                                                                            "start_token": 4626,
                                                                                            "end_token": 4626,
                                                                                            "children": []
                                                                                        },
                                                                                        {
                                                                                            "type": "string_content",
                                                                                            "label": "anthropic",
                                                                                            "start_token": 4626,
                                                                                            "end_token": 4626,
                                                                                            "children": []
                                                                                        },
                                                                                        {
                                                                                            "type": "string_end",
                                                                                            "label": "\"",
                                                                                            "start_token": 4626,
                                                                                            "end_token": 4626,
                                                                                            "children": []
                                                                                        }
                                                                                    ]
                                                                                }
                                                                            ]
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                },
                                                {
                                                    "type": "elif_clause",
                                                    "label": "elif api_key.startswith(\"sk-\"):\n            credentials.provider = credentials_meta[\"provider\"] = \"openai\"",
                                                    "start_token": 4628,
                                                    "end_token": 4646,
                                                    "children": [
                                                        {
                                                            "type": "call",
                                                            "label": "api_key.startswith(\"sk-\")",
                                                            "start_token": 4629,
                                                            "end_token": 4634,
                                                            "children": [
                                                                {
                                                                    "type": "attribute",
                                                                    "label": "api_key.startswith",
                                                                    "start_token": 4629,
                                                                    "end_token": 4631,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "api_key",
                                                                            "start_token": 4629,
                                                                            "end_token": 4629,
                                                                            "children": []
                                                                        },
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "startswith",
                                                                            "start_token": 4631,
                                                                            "end_token": 4631,
                                                                            "children": []
                                                                        }
                                                                    ]
                                                                },
                                                                {
                                                                    "type": "argument_list",
                                                                    "label": "(\"sk-\")",
                                                                    "start_token": 4632,
                                                                    "end_token": 4634,
                                                                    "children": [
                                                                        {
                                                                            "type": "string",
                                                                            "label": "\"sk-\"",
                                                                            "start_token": 4633,
                                                                            "end_token": 4633,
                                                                            "children": [
                                                                                {
                                                                                    "type": "string_start",
                                                                                    "label": "\"",
                                                                                    "start_token": 4633,
                                                                                    "end_token": 4633,
                                                                                    "children": []
                                                                                },
                                                                                {
                                                                                    "type": "string_content",
                                                                                    "label": "sk-",
                                                                                    "start_token": 4633,
                                                                                    "end_token": 4633,
                                                                                    "children": []
                                                                                },
                                                                                {
                                                                                    "type": "string_end",
                                                                                    "label": "\"",
                                                                                    "start_token": 4633,
                                                                                    "end_token": 4633,
                                                                                    "children": []
                                                                                }
                                                                            ]
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        },
                                                        {
                                                            "type": "block",
                                                            "label": "credentials.provider = credentials_meta[\"provider\"] = \"openai\"",
                                                            "start_token": 4637,
                                                            "end_token": 4646,
                                                            "children": [
                                                                {
                                                                    "type": "expression_statement",
                                                                    "label": "credentials.provider = credentials_meta[\"provider\"] = \"openai\"",
                                                                    "start_token": 4637,
                                                                    "end_token": 4646,
                                                                    "children": [
                                                                        {
                                                                            "type": "assignment",
                                                                            "label": "credentials.provider = credentials_meta[\"provider\"] = \"openai\"",
                                                                            "start_token": 4637,
                                                                            "end_token": 4646,
                                                                            "children": [
                                                                                {
                                                                                    "type": "attribute",
                                                                                    "label": "credentials.provider",
                                                                                    "start_token": 4637,
                                                                                    "end_token": 4639,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "label": "credentials",
                                                                                            "start_token": 4637,
                                                                                            "end_token": 4637,
                                                                                            "children": []
                                                                                        },
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "label": "provider",
                                                                                            "start_token": 4639,
                                                                                            "end_token": 4639,
                                                                                            "children": []
                                                                                        }
                                                                                    ]
                                                                                },
                                                                                {
                                                                                    "type": "assignment",
                                                                                    "label": "credentials_meta[\"provider\"] = \"openai\"",
                                                                                    "start_token": 4641,
                                                                                    "end_token": 4646,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "subscript",
                                                                                            "label": "credentials_meta[\"provider\"]",
                                                                                            "start_token": 4641,
                                                                                            "end_token": 4644,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "label": "credentials_meta",
                                                                                                    "start_token": 4641,
                                                                                                    "end_token": 4641,
                                                                                                    "children": []
                                                                                                },
                                                                                                {
                                                                                                    "type": "string",
                                                                                                    "label": "\"provider\"",
                                                                                                    "start_token": 4643,
                                                                                                    "end_token": 4643,
                                                                                                    "children": [
                                                                                                        {
                                                                                                            "type": "string_start",
                                                                                                            "label": "\"",
                                                                                                            "start_token": 4643,
                                                                                                            "end_token": 4643,
                                                                                                            "children": []
                                                                                                        },
                                                                                                        {
                                                                                                            "type": "string_content",
                                                                                                            "label": "provider",
                                                                                                            "start_token": 4643,
                                                                                                            "end_token": 4643,
                                                                                                            "children": []
                                                                                                        },
                                                                                                        {
                                                                                                            "type": "string_end",
                                                                                                            "label": "\"",
                                                                                                            "start_token": 4643,
                                                                                                            "end_token": 4643,
                                                                                                            "children": []
                                                                                                        }
                                                                                                    ]
                                                                                                }
                                                                                            ]
                                                                                        },
                                                                                        {
                                                                                            "type": "string",
                                                                                            "label": "\"openai\"",
                                                                                            "start_token": 4646,
                                                                                            "end_token": 4646,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "string_start",
                                                                                                    "label": "\"",
                                                                                                    "start_token": 4646,
                                                                                                    "end_token": 4646,
                                                                                                    "children": []
                                                                                                },
                                                                                                {
                                                                                                    "type": "string_content",
                                                                                                    "label": "openai",
                                                                                                    "start_token": 4646,
                                                                                                    "end_token": 4646,
                                                                                                    "children": []
                                                                                                },
                                                                                                {
                                                                                                    "type": "string_end",
                                                                                                    "label": "\"",
                                                                                                    "start_token": 4646,
                                                                                                    "end_token": 4646,
                                                                                                    "children": []
                                                                                                }
                                                                                            ]
                                                                                        }
                                                                                    ]
                                                                                }
                                                                            ]
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                },
                                                {
                                                    "type": "elif_clause",
                                                    "label": "elif api_key.startswith(\"gsk_\"):\n            credentials.provider = credentials_meta[\"provider\"] = \"groq\"",
                                                    "start_token": 4648,
                                                    "end_token": 4666,
                                                    "children": [
                                                        {
                                                            "type": "call",
                                                            "label": "api_key.startswith(\"gsk_\")",
                                                            "start_token": 4649,
                                                            "end_token": 4654,
                                                            "children": [
                                                                {
                                                                    "type": "attribute",
                                                                    "label": "api_key.startswith",
                                                                    "start_token": 4649,
                                                                    "end_token": 4651,
                                                                    "children": [
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "api_key",
                                                                            "start_token": 4649,
                                                                            "end_token": 4649,
                                                                            "children": []
                                                                        },
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "startswith",
                                                                            "start_token": 4651,
                                                                            "end_token": 4651,
                                                                            "children": []
                                                                        }
                                                                    ]
                                                                },
                                                                {
                                                                    "type": "argument_list",
                                                                    "label": "(\"gsk_\")",
                                                                    "start_token": 4652,
                                                                    "end_token": 4654,
                                                                    "children": [
                                                                        {
                                                                            "type": "string",
                                                                            "label": "\"gsk_\"",
                                                                            "start_token": 4653,
                                                                            "end_token": 4653,
                                                                            "children": [
                                                                                {
                                                                                    "type": "string_start",
                                                                                    "label": "\"",
                                                                                    "start_token": 4653,
                                                                                    "end_token": 4653,
                                                                                    "children": []
                                                                                },
                                                                                {
                                                                                    "type": "string_content",
                                                                                    "label": "gsk_",
                                                                                    "start_token": 4653,
                                                                                    "end_token": 4653,
                                                                                    "children": []
                                                                                },
                                                                                {
                                                                                    "type": "string_end",
                                                                                    "label": "\"",
                                                                                    "start_token": 4653,
                                                                                    "end_token": 4653,
                                                                                    "children": []
                                                                                }
                                                                            ]
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        },
                                                        {
                                                            "type": "block",
                                                            "label": "credentials.provider = credentials_meta[\"provider\"] = \"groq\"",
                                                            "start_token": 4657,
                                                            "end_token": 4666,
                                                            "children": [
                                                                {
                                                                    "type": "expression_statement",
                                                                    "label": "credentials.provider = credentials_meta[\"provider\"] = \"groq\"",
                                                                    "start_token": 4657,
                                                                    "end_token": 4666,
                                                                    "children": [
                                                                        {
                                                                            "type": "assignment",
                                                                            "label": "credentials.provider = credentials_meta[\"provider\"] = \"groq\"",
                                                                            "start_token": 4657,
                                                                            "end_token": 4666,
                                                                            "children": [
                                                                                {
                                                                                    "type": "attribute",
                                                                                    "label": "credentials.provider",
                                                                                    "start_token": 4657,
                                                                                    "end_token": 4659,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "label": "credentials",
                                                                                            "start_token": 4657,
                                                                                            "end_token": 4657,
                                                                                            "children": []
                                                                                        },
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "label": "provider",
                                                                                            "start_token": 4659,
                                                                                            "end_token": 4659,
                                                                                            "children": []
                                                                                        }
                                                                                    ]
                                                                                },
                                                                                {
                                                                                    "type": "assignment",
                                                                                    "label": "credentials_meta[\"provider\"] = \"groq\"",
                                                                                    "start_token": 4661,
                                                                                    "end_token": 4666,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "subscript",
                                                                                            "label": "credentials_meta[\"provider\"]",
                                                                                            "start_token": 4661,
                                                                                            "end_token": 4664,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "label": "credentials_meta",
                                                                                                    "start_token": 4661,
                                                                                                    "end_token": 4661,
                                                                                                    "children": []
                                                                                                },
                                                                                                {
                                                                                                    "type": "string",
                                                                                                    "label": "\"provider\"",
                                                                                                    "start_token": 4663,
                                                                                                    "end_token": 4663,
                                                                                                    "children": [
                                                                                                        {
                                                                                                            "type": "string_start",
                                                                                                            "label": "\"",
                                                                                                            "start_token": 4663,
                                                                                                            "end_token": 4663,
                                                                                                            "children": []
                                                                                                        },
                                                                                                        {
                                                                                                            "type": "string_content",
                                                                                                            "label": "provider",
                                                                                                            "start_token": 4663,
                                                                                                            "end_token": 4663,
                                                                                                            "children": []
                                                                                                        },
                                                                                                        {
                                                                                                            "type": "string_end",
                                                                                                            "label": "\"",
                                                                                                            "start_token": 4663,
                                                                                                            "end_token": 4663,
                                                                                                            "children": []
                                                                                                        }
                                                                                                    ]
                                                                                                }
                                                                                            ]
                                                                                        },
                                                                                        {
                                                                                            "type": "string",
                                                                                            "label": "\"groq\"",
                                                                                            "start_token": 4666,
                                                                                            "end_token": 4666,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "string_start",
                                                                                                    "label": "\"",
                                                                                                    "start_token": 4666,
                                                                                                    "end_token": 4666,
                                                                                                    "children": []
                                                                                                },
                                                                                                {
                                                                                                    "type": "string_content",
                                                                                                    "label": "groq",
                                                                                                    "start_token": 4666,
                                                                                                    "end_token": 4666,
                                                                                                    "children": []
                                                                                                },
                                                                                                {
                                                                                                    "type": "string_end",
                                                                                                    "label": "\"",
                                                                                                    "start_token": 4666,
                                                                                                    "end_token": 4666,
                                                                                                    "children": []
                                                                                                }
                                                                                            ]
                                                                                        }
                                                                                    ]
                                                                                }
                                                                            ]
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                },
                                                {
                                                    "type": "else_clause",
                                                    "label": "else:\n            logger.warning(\n                f\"Could not identify provider from key prefix {api_key[:13]}*****\"\n            )\n            continue",
                                                    "start_token": 4668,
                                                    "end_token": 4681,
                                                    "children": [
                                                        {
                                                            "type": "block",
                                                            "label": "logger.warning(\n                f\"Could not identify provider from key prefix {api_key[:13]}*****\"\n            )\n            continue",
                                                            "start_token": 4671,
                                                            "end_token": 4681,
                                                            "children": [
                                                                {
                                                                    "type": "expression_statement",
                                                                    "label": "logger.warning(\n                f\"Could not identify provider from key prefix {api_key[:13]}*****\"\n            )",
                                                                    "start_token": 4671,
                                                                    "end_token": 4679,
                                                                    "children": [
                                                                        {
                                                                            "type": "call",
                                                                            "label": "logger.warning(\n                f\"Could not identify provider from key prefix {api_key[:13]}*****\"\n            )",
                                                                            "start_token": 4671,
                                                                            "end_token": 4679,
                                                                            "children": [
                                                                                {
                                                                                    "type": "attribute",
                                                                                    "label": "logger.warning",
                                                                                    "start_token": 4671,
                                                                                    "end_token": 4673,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "label": "logger",
                                                                                            "start_token": 4671,
                                                                                            "end_token": 4671,
                                                                                            "children": []
                                                                                        },
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "label": "warning",
                                                                                            "start_token": 4673,
                                                                                            "end_token": 4673,
                                                                                            "children": []
                                                                                        }
                                                                                    ]
                                                                                },
                                                                                {
                                                                                    "type": "argument_list",
                                                                                    "label": "(\n                f\"Could not identify provider from key prefix {api_key[:13]}*****\"\n            )",
                                                                                    "start_token": 4674,
                                                                                    "end_token": 4679,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "string",
                                                                                            "label": "f\"Could not identify provider from key prefix {api_key[:13]}*****\"",
                                                                                            "start_token": 4676,
                                                                                            "end_token": 4677,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "string_start",
                                                                                                    "label": "f\"",
                                                                                                    "start_token": 4676,
                                                                                                    "end_token": 4677,
                                                                                                    "children": []
                                                                                                },
                                                                                                {
                                                                                                    "type": "string_content",
                                                                                                    "label": "Could not identify provider from key prefix ",
                                                                                                    "start_token": 4677,
                                                                                                    "end_token": 4677,
                                                                                                    "children": []
                                                                                                },
                                                                                                {
                                                                                                    "type": "interpolation",
                                                                                                    "label": "{api_key[:13]}",
                                                                                                    "start_token": 4677,
                                                                                                    "end_token": 4677,
                                                                                                    "children": [
                                                                                                        {
                                                                                                            "type": "subscript",
                                                                                                            "label": "api_key[:13]",
                                                                                                            "start_token": 4677,
                                                                                                            "end_token": 4677,
                                                                                                            "children": [
                                                                                                                {
                                                                                                                    "type": "identifier",
                                                                                                                    "label": "api_key",
                                                                                                                    "start_token": 4677,
                                                                                                                    "end_token": 4677,
                                                                                                                    "children": []
                                                                                                                },
                                                                                                                {
                                                                                                                    "type": "slice",
                                                                                                                    "label": ":13",
                                                                                                                    "start_token": 4677,
                                                                                                                    "end_token": 4677,
                                                                                                                    "children": [
                                                                                                                        {
                                                                                                                            "type": "integer",
                                                                                                                            "label": "13",
                                                                                                                            "start_token": 4677,
                                                                                                                            "end_token": 4677,
                                                                                                                            "children": []
                                                                                                                        }
                                                                                                                    ]
                                                                                                                }
                                                                                                            ]
                                                                                                        }
                                                                                                    ]
                                                                                                },
                                                                                                {
                                                                                                    "type": "string_content",
                                                                                                    "label": "*****",
                                                                                                    "start_token": 4677,
                                                                                                    "end_token": 4677,
                                                                                                    "children": []
                                                                                                },
                                                                                                {
                                                                                                    "type": "string_end",
                                                                                                    "label": "\"",
                                                                                                    "start_token": 4677,
                                                                                                    "end_token": 4677,
                                                                                                    "children": []
                                                                                                }
                                                                                            ]
                                                                                        }
                                                                                    ]
                                                                                }
                                                                            ]
                                                                        }
                                                                    ]
                                                                },
                                                                {
                                                                    "type": "continue_statement",
                                                                    "label": "continue",
                                                                    "start_token": 4681,
                                                                    "end_token": 4681,
                                                                    "children": []
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                }
                                            ]
                                        },
                                        {
                                            "type": "expression_statement",
                                            "label": "store.update_creds(user_id, credentials)",
                                            "start_token": 4684,
                                            "end_token": 4691,
                                            "children": [
                                                {
                                                    "type": "call",
                                                    "label": "store.update_creds(user_id, credentials)",
                                                    "start_token": 4684,
                                                    "end_token": 4691,
                                                    "children": [
                                                        {
                                                            "type": "attribute",
                                                            "label": "store.update_creds",
                                                            "start_token": 4684,
                                                            "end_token": 4686,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "label": "store",
                                                                    "start_token": 4684,
                                                                    "end_token": 4684,
                                                                    "children": []
                                                                },
                                                                {
                                                                    "type": "identifier",
                                                                    "label": "update_creds",
                                                                    "start_token": 4686,
                                                                    "end_token": 4686,
                                                                    "children": []
                                                                }
                                                            ]
                                                        },
                                                        {
                                                            "type": "argument_list",
                                                            "label": "(user_id, credentials)",
                                                            "start_token": 4687,
                                                            "end_token": 4691,
                                                            "children": [
                                                                {
                                                                    "type": "identifier",
                                                                    "label": "user_id",
                                                                    "start_token": 4688,
                                                                    "end_token": 4688,
                                                                    "children": []
                                                                },
                                                                {
                                                                    "type": "identifier",
                                                                    "label": "credentials",
                                                                    "start_token": 4690,
                                                                    "end_token": 4690,
                                                                    "children": []
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                }
                                            ]
                                        },
                                        {
                                            "type": "expression_statement",
                                            "label": "await AgentNode.prisma().update(\n            where={\"id\": node_id},\n            data={\"constantInput\": json.dumps(node_preset_input)},\n        )",
                                            "start_token": 4693,
                                            "end_token": 4726,
                                            "children": [
                                                {
                                                    "type": "await",
                                                    "label": "await AgentNode.prisma().update(\n            where={\"id\": node_id},\n            data={\"constantInput\": json.dumps(node_preset_input)},\n        )",
                                                    "start_token": 4693,
                                                    "end_token": 4726,
                                                    "children": [
                                                        {
                                                            "type": "call",
                                                            "label": "AgentNode.prisma().update(\n            where={\"id\": node_id},\n            data={\"constantInput\": json.dumps(node_preset_input)},\n        )",
                                                            "start_token": 4694,
                                                            "end_token": 4726,
                                                            "children": [
                                                                {
                                                                    "type": "attribute",
                                                                    "label": "AgentNode.prisma().update",
                                                                    "start_token": 4694,
                                                                    "end_token": 4700,
                                                                    "children": [
                                                                        {
                                                                            "type": "call",
                                                                            "label": "AgentNode.prisma()",
                                                                            "start_token": 4694,
                                                                            "end_token": 4698,
                                                                            "children": [
                                                                                {
                                                                                    "type": "attribute",
                                                                                    "label": "AgentNode.prisma",
                                                                                    "start_token": 4694,
                                                                                    "end_token": 4696,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "label": "AgentNode",
                                                                                            "start_token": 4694,
                                                                                            "end_token": 4694,
                                                                                            "children": []
                                                                                        },
                                                                                        {
                                                                                            "type": "identifier",
                                                                                            "label": "prisma",
                                                                                            "start_token": 4696,
                                                                                            "end_token": 4696,
                                                                                            "children": []
                                                                                        }
                                                                                    ]
                                                                                },
                                                                                {
                                                                                    "type": "argument_list",
                                                                                    "label": "()",
                                                                                    "start_token": 4697,
                                                                                    "end_token": 4698,
                                                                                    "children": []
                                                                                }
                                                                            ]
                                                                        },
                                                                        {
                                                                            "type": "identifier",
                                                                            "label": "update",
                                                                            "start_token": 4700,
                                                                            "end_token": 4700,
                                                                            "children": []
                                                                        }
                                                                    ]
                                                                },
                                                                {
                                                                    "type": "argument_list",
                                                                    "label": "(\n            where={\"id\": node_id},\n            data={\"constantInput\": json.dumps(node_preset_input)},\n        )",
                                                                    "start_token": 4701,
                                                                    "end_token": 4726,
                                                                    "children": [
                                                                        {
                                                                            "type": "keyword_argument",
                                                                            "label": "where={\"id\": node_id}",
                                                                            "start_token": 4703,
                                                                            "end_token": 4709,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "where",
                                                                                    "start_token": 4703,
                                                                                    "end_token": 4703,
                                                                                    "children": []
                                                                                },
                                                                                {
                                                                                    "type": "dictionary",
                                                                                    "label": "{\"id\": node_id}",
                                                                                    "start_token": 4705,
                                                                                    "end_token": 4709,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "pair",
                                                                                            "label": "\"id\": node_id",
                                                                                            "start_token": 4706,
                                                                                            "end_token": 4708,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "string",
                                                                                                    "label": "\"id\"",
                                                                                                    "start_token": 4706,
                                                                                                    "end_token": 4706,
                                                                                                    "children": [
                                                                                                        {
                                                                                                            "type": "string_start",
                                                                                                            "label": "\"",
                                                                                                            "start_token": 4706,
                                                                                                            "end_token": 4706,
                                                                                                            "children": []
                                                                                                        },
                                                                                                        {
                                                                                                            "type": "string_content",
                                                                                                            "label": "id",
                                                                                                            "start_token": 4706,
                                                                                                            "end_token": 4706,
                                                                                                            "children": []
                                                                                                        },
                                                                                                        {
                                                                                                            "type": "string_end",
                                                                                                            "label": "\"",
                                                                                                            "start_token": 4706,
                                                                                                            "end_token": 4706,
                                                                                                            "children": []
                                                                                                        }
                                                                                                    ]
                                                                                                },
                                                                                                {
                                                                                                    "type": "identifier",
                                                                                                    "label": "node_id",
                                                                                                    "start_token": 4708,
                                                                                                    "end_token": 4708,
                                                                                                    "children": []
                                                                                                }
                                                                                            ]
                                                                                        }
                                                                                    ]
                                                                                }
                                                                            ]
                                                                        },
                                                                        {
                                                                            "type": "keyword_argument",
                                                                            "label": "data={\"constantInput\": json.dumps(node_preset_input)}",
                                                                            "start_token": 4712,
                                                                            "end_token": 4723,
                                                                            "children": [
                                                                                {
                                                                                    "type": "identifier",
                                                                                    "label": "data",
                                                                                    "start_token": 4712,
                                                                                    "end_token": 4712,
                                                                                    "children": []
                                                                                },
                                                                                {
                                                                                    "type": "dictionary",
                                                                                    "label": "{\"constantInput\": json.dumps(node_preset_input)}",
                                                                                    "start_token": 4714,
                                                                                    "end_token": 4723,
                                                                                    "children": [
                                                                                        {
                                                                                            "type": "pair",
                                                                                            "label": "\"constantInput\": json.dumps(node_preset_input)",
                                                                                            "start_token": 4715,
                                                                                            "end_token": 4722,
                                                                                            "children": [
                                                                                                {
                                                                                                    "type": "string",
                                                                                                    "label": "\"constantInput\"",
                                                                                                    "start_token": 4715,
                                                                                                    "end_token": 4715,
                                                                                                    "children": [
                                                                                                        {
                                                                                                            "type": "string_start",
                                                                                                            "label": "\"",
                                                                                                            "start_token": 4715,
                                                                                                            "end_token": 4715,
                                                                                                            "children": []
                                                                                                        },
                                                                                                        {
                                                                                                            "type": "string_content",
                                                                                                            "label": "constantInput",
                                                                                                            "start_token": 4715,
                                                                                                            "end_token": 4715,
                                                                                                            "children": []
                                                                                                        },
                                                                                                        {
                                                                                                            "type": "string_end",
                                                                                                            "label": "\"",
                                                                                                            "start_token": 4715,
                                                                                                            "end_token": 4715,
                                                                                                            "children": []
                                                                                                        }
                                                                                                    ]
                                                                                                },
                                                                                                {
                                                                                                    "type": "call",
                                                                                                    "label": "json.dumps(node_preset_input)",
                                                                                                    "start_token": 4717,
                                                                                                    "end_token": 4722,
                                                                                                    "children": [
                                                                                                        {
                                                                                                            "type": "attribute",
                                                                                                            "label": "json.dumps",
                                                                                                            "start_token": 4717,
                                                                                                            "end_token": 4719,
                                                                                                            "children": [
                                                                                                                {
                                                                                                                    "type": "identifier",
                                                                                                                    "label": "json",
                                                                                                                    "start_token": 4717,
                                                                                                                    "end_token": 4717,
                                                                                                                    "children": []
                                                                                                                },
                                                                                                                {
                                                                                                                    "type": "identifier",
                                                                                                                    "label": "dumps",
                                                                                                                    "start_token": 4719,
                                                                                                                    "end_token": 4719,
                                                                                                                    "children": []
                                                                                                                }
                                                                                                            ]
                                                                                                        },
                                                                                                        {
                                                                                                            "type": "argument_list",
                                                                                                            "label": "(node_preset_input)",
                                                                                                            "start_token": 4720,
                                                                                                            "end_token": 4722,
                                                                                                            "children": [
                                                                                                                {
                                                                                                                    "type": "identifier",
                                                                                                                    "label": "node_preset_input",
                                                                                                                    "start_token": 4721,
                                                                                                                    "end_token": 4721,
                                                                                                                    "children": []
                                                                                                                }
                                                                                                            ]
                                                                                                        }
                                                                                                    ]
                                                                                                }
                                                                                            ]
                                                                                        }
                                                                                    ]
                                                                                }
                                                                            ]
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                }
                                            ]
                                        }
                                    ]
                                }
                            ]
                        }
                    ]
                }
            ]
        }
    ]
}
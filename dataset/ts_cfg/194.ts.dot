digraph "194.ts" {
subgraph "cluster_@ts_files/194.ts: %dflt.[static]%dflt()" {
  label="@ts_files/194.ts: %dflt.[static]%dflt()";
  Node33780 [label="id:0
      this = this: @ts_files/194.ts: %dflt
      %1 = new @ts_files/194.ts: %AC$%dflt$%dflt$0
      instanceinvoke %1.<@ts_files/194.ts: %AC$%dflt$%dflt$0.constructor()>()
      %2 = instanceinvoke proxyquire.<@%unk/%unk: .noCallThru()>()
      %0 = instanceinvoke %2.<@%unk/%unk: .load()>('../../../../../../../server/services/federation/application/room/receiver/RoomServiceReceiver', %1)
      FederationRoomServiceReceiver = %0.<@%unk/%unk: .FederationRoomServiceReceiver>
      %4 = new @ts_files/194.ts: %AC$%dflt$%dflt$2
      instanceinvoke %4.<@ts_files/194.ts: %AC$%dflt$%dflt$2.constructor()>()
      %5 = instanceinvoke proxyquire.<@%unk/%unk: .noCallThru()>()
      %3 = instanceinvoke %5.<@%unk/%unk: .load()>('../../../../../../../server/services/federation/domain/FederatedUser', %4)
      FederatedUser = %3.<@%unk/%unk: .FederatedUser>
      %7 = new @ts_files/194.ts: %AC$%dflt$%dflt$4
      instanceinvoke %7.<@ts_files/194.ts: %AC$%dflt$%dflt$4.constructor()>()
      %8 = instanceinvoke proxyquire.<@%unk/%unk: .noCallThru()>()
      %6 = instanceinvoke %8.<@%unk/%unk: .load()>('../../../../../../../server/services/federation/domain/FederatedRoom', %7)
      DirectMessageFederatedRoom = %6.<@%unk/%unk: .DirectMessageFederatedRoom>
      FederatedRoom = %6.<@%unk/%unk: .FederatedRoom>
      staticinvoke <@%unk/%unk: .describe()>('Federation - Application - FederationRoomServiceReceiver', %AM0)
      return"];
}
subgraph "cluster_@ts_files/194.ts: %dflt.%AM1$%AM0()" {
  label="@ts_files/194.ts: %dflt.%AM1$%AM0()";
  Node25740 [label="id:0
      this = this: @ts_files/194.ts: %dflt
      %0 = new @%unk/%unk: FederationRoomServiceReceiver
      %1 = <any>roomAdapter
      %2 = <any>userAdapter
      %3 = <any>messageAdapter
      %4 = <any>fileAdapter
      %5 = <any>settingsAdapter
      %6 = <any>notificationsAdapter
      %7 = <any>queueInstance
      %8 = <any>bridge
      instanceinvoke %0.<@%unk/%unk: FederationRoomServiceReceiver.constructor()>(%1, %2, %3, %4, %5, %6, %7, %8)
      service = %0
      return"];
}
subgraph "cluster_@ts_files/194.ts: %dflt.%AM2$%AM0()" {
  label="@ts_files/194.ts: %dflt.%AM2$%AM0()";
  Node25750 [label="id:0
      this = this: @ts_files/194.ts: %dflt
      %0 = roomAdapter.<@%unk/%unk: .getFederatedRoomByExternalId>
      instanceinvoke %0.<@%unk/%unk: .reset()>()
      %1 = roomAdapter.<@%unk/%unk: .createFederatedRoom>
      instanceinvoke %1.<@%unk/%unk: .reset()>()
      %2 = roomAdapter.<@%unk/%unk: .createFederatedRoomForDirectMessage>
      instanceinvoke %2.<@%unk/%unk: .reset()>()
      %3 = roomAdapter.<@%unk/%unk: .removeDirectMessageRoom>
      instanceinvoke %3.<@%unk/%unk: .reset()>()
      %4 = roomAdapter.<@%unk/%unk: .updateRoomType>
      instanceinvoke %4.<@%unk/%unk: .reset()>()
      %5 = roomAdapter.<@%unk/%unk: .updateRoomName>
      instanceinvoke %5.<@%unk/%unk: .reset()>()
      %6 = roomAdapter.<@%unk/%unk: .updateFederatedRoomByInternalRoomId>
      instanceinvoke %6.<@%unk/%unk: .reset()>()
      %7 = roomAdapter.<@%unk/%unk: .updateRoomTopic>
      instanceinvoke %7.<@%unk/%unk: .reset()>()
      %8 = roomAdapter.<@%unk/%unk: .removeUserFromRoom>
      instanceinvoke %8.<@%unk/%unk: .reset()>()
      %9 = roomAdapter.<@%unk/%unk: .isUserAlreadyJoined>
      instanceinvoke %9.<@%unk/%unk: .reset()>()
      %10 = roomAdapter.<@%unk/%unk: .addUsersToRoomWhenJoinExternalPublicRoom>
      instanceinvoke %10.<@%unk/%unk: .reset()>()
      %11 = roomAdapter.<@%unk/%unk: .getInternalRoomById>
      instanceinvoke %11.<@%unk/%unk: .reset()>()
      %12 = roomAdapter.<@%unk/%unk: .addUserToRoom>
      instanceinvoke %12.<@%unk/%unk: .reset()>()
      %13 = roomAdapter.<@%unk/%unk: .applyRoomRolesToUser>
      instanceinvoke %13.<@%unk/%unk: .reset()>()
      %14 = roomAdapter.<@%unk/%unk: .updateDisplayRoomName>
      instanceinvoke %14.<@%unk/%unk: .reset()>()
      %15 = userAdapter.<@%unk/%unk: .getFederatedUserByExternalId>
      instanceinvoke %15.<@%unk/%unk: .reset()>()
      %16 = userAdapter.<@%unk/%unk: .createFederatedUser>
      instanceinvoke %16.<@%unk/%unk: .reset()>()
      %17 = userAdapter.<@%unk/%unk: .updateFederationAvatar>
      instanceinvoke %17.<@%unk/%unk: .reset()>()
      %18 = userAdapter.<@%unk/%unk: .setAvatar>
      instanceinvoke %18.<@%unk/%unk: .reset()>()
      %19 = userAdapter.<@%unk/%unk: .getInternalUserByUsername>
      instanceinvoke %19.<@%unk/%unk: .reset()>()
      %20 = userAdapter.<@%unk/%unk: .updateRealName>
      instanceinvoke %20.<@%unk/%unk: .reset()>()
      %21 = userAdapter.<@%unk/%unk: .getFederatedUsersByExternalIds>
      instanceinvoke %21.<@%unk/%unk: .reset()>()
      %22 = messageAdapter.<@%unk/%unk: .sendMessage>
      instanceinvoke %22.<@%unk/%unk: .reset()>()
      %23 = messageAdapter.<@%unk/%unk: .sendFileMessage>
      instanceinvoke %23.<@%unk/%unk: .reset()>()
      %24 = messageAdapter.<@%unk/%unk: .deleteMessage>
      instanceinvoke %24.<@%unk/%unk: .reset()>()
      %25 = messageAdapter.<@%unk/%unk: .getMessageByFederationId>
      instanceinvoke %25.<@%unk/%unk: .reset()>()
      %26 = messageAdapter.<@%unk/%unk: .editMessage>
      instanceinvoke %26.<@%unk/%unk: .reset()>()
      %27 = messageAdapter.<@%unk/%unk: .unreactToMessage>
      instanceinvoke %27.<@%unk/%unk: .reset()>()
      %28 = messageAdapter.<@%unk/%unk: .findOneByFederationIdOnReactions>
      instanceinvoke %28.<@%unk/%unk: .reset()>()
      %29 = messageAdapter.<@%unk/%unk: .sendQuoteFileMessage>
      instanceinvoke %29.<@%unk/%unk: .reset()>()
      %30 = messageAdapter.<@%unk/%unk: .sendQuoteMessage>
      instanceinvoke %30.<@%unk/%unk: .reset()>()
      %31 = messageAdapter.<@%unk/%unk: .sendThreadQuoteMessage>
      instanceinvoke %31.<@%unk/%unk: .reset()>()
      %32 = messageAdapter.<@%unk/%unk: .sendThreadMessage>
      instanceinvoke %32.<@%unk/%unk: .reset()>()
      %33 = messageAdapter.<@%unk/%unk: .sendThreadFileMessage>
      instanceinvoke %33.<@%unk/%unk: .reset()>()
      %34 = messageAdapter.<@%unk/%unk: .sendThreadQuoteFileMessage>
      instanceinvoke %34.<@%unk/%unk: .reset()>()
      %35 = bridge.<@%unk/%unk: .extractHomeserverOrigin>
      instanceinvoke %35.<@%unk/%unk: .reset()>()
      %36 = bridge.<@%unk/%unk: .joinRoom>
      instanceinvoke %36.<@%unk/%unk: .reset()>()
      %37 = bridge.<@%unk/%unk: .getUserProfileInformation>
      instanceinvoke %37.<@%unk/%unk: .reset()>()
      %38 = bridge.<@%unk/%unk: .getReadStreamForFileFromUrl>
      instanceinvoke %38.<@%unk/%unk: .reset()>()
      %39 = bridge.<@%unk/%unk: .getRoomData>
      instanceinvoke %39.<@%unk/%unk: .reset()>()
      %40 = bridge.<@%unk/%unk: .getRoomHistoricalJoinEvents>
      instanceinvoke %40.<@%unk/%unk: .reset()>()
      %41 = fileAdapter.<@%unk/%unk: .uploadFile>
      instanceinvoke %41.<@%unk/%unk: .reset()>()
      %42 = queueInstance.<@%unk/%unk: .addToQueue>
      instanceinvoke %42.<@%unk/%unk: .reset()>()
      return"];
}
subgraph "cluster_@ts_files/194.ts: %dflt.%AM4$%AM3$%AM0()" {
  label="@ts_files/194.ts: %dflt.%AM4$%AM3$%AM0()";
  Node28430 [label="id:0
      this = this: @ts_files/194.ts: %dflt
      %0 = new @ts_files/194.ts: %AC$%dflt$%AM4$%AM3$%AM0$15
      instanceinvoke %0.<@ts_files/194.ts: %AC$%dflt$%AM4$%AM3$%AM0$15.constructor()>()
      %1 = <@ts_files/194.ts: %AC$%dflt$%AM4$%AM3$%AM0$15>%0
      %2 = roomAdapter.<@%unk/%unk: .getFederatedRoomByExternalId>
      instanceinvoke %2.<@%unk/%unk: .resolves()>(%1)
      %3 = new @ts_files/194.ts: %AC$%dflt$%AM4$%AM3$%AM0$16
      instanceinvoke %3.<@ts_files/194.ts: %AC$%dflt$%AM4$%AM3$%AM0$16.constructor()>()
      %4 = <@ts_files/194.ts: %AC$%dflt$%AM4$%AM3$%AM0$16>%3
      %5 = instanceinvoke service.<@%unk/%unk: .onCreateRoom()>(%4)
      %6 = await %5
      %7 = roomAdapter.<@%unk/%unk: .createFederatedRoom>
      %8 = %7.<@ts_files/194.ts: %AC$%dflt$%dflt$4.called>
      %9 = staticinvoke <@%unk/%unk: .expect()>(%8)
      %10 = %9.<@%unk/%unk: .to>
      %11 = %10.<@%unk/%unk: .be>
      %12 = userAdapter.<@%unk/%unk: .createFederatedUser>
      %13 = %12.<@%unk/%unk: .called>
      %14 = staticinvoke <@%unk/%unk: .expect()>(%13)
      %15 = %14.<@%unk/%unk: .to>
      %16 = %15.<@%unk/%unk: .be>
      return"];
}
subgraph "cluster_@ts_files/194.ts: %dflt.%AM5$%AM3$%AM0()" {
  label="@ts_files/194.ts: %dflt.%AM5$%AM3$%AM0()";
  Node28440 [label="id:0
      this = this: @ts_files/194.ts: %dflt
      %0 = roomAdapter.<@%unk/%unk: .getFederatedRoomByExternalId>
      instanceinvoke %0.<@%unk/%unk: .resolves()>(undefined)
      %1 = new @ts_files/194.ts: %AC$%dflt$%AM5$%AM3$%AM0$17
      instanceinvoke %1.<@ts_files/194.ts: %AC$%dflt$%AM5$%AM3$%AM0$17.constructor()>()
      %2 = <@ts_files/194.ts: %AC$%dflt$%AM5$%AM3$%AM0$17>%1
      %3 = instanceinvoke service.<@%unk/%unk: .onCreateRoom()>(%2)
      %4 = await %3
      %5 = roomAdapter.<@%unk/%unk: .createFederatedRoom>
      %6 = %5.<@%unk/%unk: .called>
      %7 = staticinvoke <@%unk/%unk: .expect()>(%6)
      %8 = %7.<@ts_files/194.ts: %AC$%dflt$%dflt$4.to>
      %9 = %8.<@%unk/%unk: .be>
      %10 = userAdapter.<@%unk/%unk: .createFederatedUser>
      %11 = %10.<@%unk/%unk: .called>
      %12 = staticinvoke <@%unk/%unk: .expect()>(%11)
      %13 = %12.<@%unk/%unk: .to>
      %14 = %13.<@%unk/%unk: .be>
      return"];
}
subgraph "cluster_@ts_files/194.ts: %dflt.%AM6$%AM3$%AM0()" {
  label="@ts_files/194.ts: %dflt.%AM6$%AM3$%AM0()";
  Node28450 [label="id:0
      this = this: @ts_files/194.ts: %dflt
      %0 = roomAdapter.<@%unk/%unk: .getFederatedRoomByExternalId>
      instanceinvoke %0.<@%unk/%unk: .resolves()>(undefined)
      %1 = new @ts_files/194.ts: %AC$%dflt$%AM6$%AM3$%AM0$18
      instanceinvoke %1.<@ts_files/194.ts: %AC$%dflt$%AM6$%AM3$%AM0$18.constructor()>()
      %2 = roomAdapter.<@%unk/%unk: .getInternalRoomById>
      instanceinvoke %2.<@%unk/%unk: .resolves()>(%1)
      %3 = new @ts_files/194.ts: %AC$%dflt$%AM6$%AM3$%AM0$19
      instanceinvoke %3.<@ts_files/194.ts: %AC$%dflt$%AM6$%AM3$%AM0$19.constructor()>()
      %4 = <@ts_files/194.ts: %AC$%dflt$%AM6$%AM3$%AM0$19>%3
      %5 = instanceinvoke service.<@%unk/%unk: .onCreateRoom()>(%4)
      %6 = await %5
      %7 = roomAdapter.<@%unk/%unk: .updateFederatedRoomByInternalRoomId>
      %8 = %7.<@ts_files/194.ts: %AC$%dflt$%dflt$4.called>
      %9 = staticinvoke <@%unk/%unk: .expect()>(%8)
      %10 = %9.<@%unk/%unk: .to>
      %11 = %10.<@%unk/%unk: .be>
      %12 = roomAdapter.<@%unk/%unk: .createFederatedRoom>
      %13 = %12.<@%unk/%unk: .called>
      %14 = staticinvoke <@%unk/%unk: .expect()>(%13)
      %15 = %14.<@%unk/%unk: .to>
      %16 = %15.<@%unk/%unk: .be>
      %17 = userAdapter.<@%unk/%unk: .createFederatedUser>
      %18 = %17.<@%unk/%unk: .called>
      %19 = staticinvoke <@%unk/%unk: .expect()>(%18)
      %20 = %19.<@%unk/%unk: .to>
      %21 = %20.<@%unk/%unk: .be>
      return"];
}
subgraph "cluster_@ts_files/194.ts: %dflt.%AM7$%AM3$%AM0()" {
  label="@ts_files/194.ts: %dflt.%AM7$%AM3$%AM0()";
  Node28460 [label="id:0
      this = this: @ts_files/194.ts: %dflt
      %0 = roomAdapter.<@%unk/%unk: .getFederatedRoomByExternalId>
      instanceinvoke %0.<@%unk/%unk: .resolves()>(undefined)
      %1 = roomAdapter.<@%unk/%unk: .getInternalRoomById>
      instanceinvoke %1.<@%unk/%unk: .resolves()>(undefined)
      %2 = new @ts_files/194.ts: %AC$%dflt$%AM7$%AM3$%AM0$20
      instanceinvoke %2.<@ts_files/194.ts: %AC$%dflt$%AM7$%AM3$%AM0$20.constructor()>()
      %3 = <@ts_files/194.ts: %AC$%dflt$%AM7$%AM3$%AM0$20>%2
      %4 = instanceinvoke service.<@%unk/%unk: .onCreateRoom()>(%3)
      %5 = await %4
      %6 = roomAdapter.<@%unk/%unk: .updateFederatedRoomByInternalRoomId>
      %7 = %6.<@%unk/%unk: .called>
      %8 = staticinvoke <@%unk/%unk: .expect()>(%7)
      %9 = %8.<@%unk/%unk: .to>
      %10 = %9.<@%unk/%unk: .be>
      %11 = roomAdapter.<@%unk/%unk: .createFederatedRoom>
      %12 = %11.<@%unk/%unk: .called>
      %13 = staticinvoke <@%unk/%unk: .expect()>(%12)
      %14 = %13.<@%unk/%unk: .to>
      %15 = %14.<@%unk/%unk: .be>
      %16 = userAdapter.<@%unk/%unk: .createFederatedUser>
      %17 = %16.<@%unk/%unk: .called>
      %18 = staticinvoke <@%unk/%unk: .expect()>(%17)
      %19 = %18.<@%unk/%unk: .to>
      %20 = %19.<@%unk/%unk: .be>
      return"];
}
subgraph "cluster_@ts_files/194.ts: %dflt.%AM8$%AM3$%AM0()" {
  label="@ts_files/194.ts: %dflt.%AM8$%AM3$%AM0()";
  Node28470 [label="id:0
      this = this: @ts_files/194.ts: %dflt
      %0 = roomAdapter.<@%unk/%unk: .getFederatedRoomByExternalId>
      instanceinvoke %0.<@%unk/%unk: .resolves()>(undefined)
      %1 = new @ts_files/194.ts: %AC$%dflt$%AM8$%AM3$%AM0$21
      instanceinvoke %1.<@ts_files/194.ts: %AC$%dflt$%AM8$%AM3$%AM0$21.constructor()>()
      %2 = roomAdapter.<@%unk/%unk: .getInternalRoomById>
      instanceinvoke %2.<@%unk/%unk: .resolves()>(%1)
      %3 = new @ts_files/194.ts: %AC$%dflt$%AM8$%AM3$%AM0$22
      instanceinvoke %3.<@ts_files/194.ts: %AC$%dflt$%AM8$%AM3$%AM0$22.constructor()>()
      %4 = <@ts_files/194.ts: %AC$%dflt$%AM8$%AM3$%AM0$22>%3
      %5 = instanceinvoke service.<@%unk/%unk: .onCreateRoom()>(%4)
      %6 = await %5
      %7 = roomAdapter.<@%unk/%unk: .updateFederatedRoomByInternalRoomId>
      %8 = instanceinvoke %7.<@%unk/%unk: .calledWith()>('internalRoomId', 'externalRoomId')
      %9 = staticinvoke <@%unk/%unk: .expect()>(%8)
      %10 = %9.<@%unk/%unk: .to>
      %11 = %10.<@%unk/%unk: .be>
      %12 = roomAdapter.<@%unk/%unk: .createFederatedRoom>
      %13 = %12.<@%unk/%unk: .called>
      %14 = staticinvoke <@%unk/%unk: .expect()>(%13)
      %15 = %14.<@%unk/%unk: .to>
      %16 = %15.<@%unk/%unk: .be>
      %17 = userAdapter.<@%unk/%unk: .createFederatedUser>
      %18 = %17.<@%unk/%unk: .called>
      %19 = staticinvoke <@%unk/%unk: .expect()>(%18)
      %20 = %19.<@%unk/%unk: .to>
      %21 = %20.<@%unk/%unk: .be>
      return"];
}
subgraph "cluster_@ts_files/194.ts: %dflt.%AM3$%AM0()" {
  label="@ts_files/194.ts: %dflt.%AM3$%AM0()";
  Node25760 [label="id:0
      this = this: @ts_files/194.ts: %dflt
      staticinvoke <@%unk/%unk: .it()>('should NOT create users nor room if the room already exists', %AM4$%AM3$%AM0)
      staticinvoke <@%unk/%unk: .it()>('should NOT create users nor room if the room was created internally and programatically even if the room does not exists', %AM5$%AM3$%AM0)
      staticinvoke <@%unk/%unk: .it()>('should NOT update the room if it was created internally and programatically but it is not a DM message and dont create the room', %AM6$%AM3$%AM0)
      staticinvoke <@%unk/%unk: .it()>('should NOT update the room if it was created internally and programatically but it does not exists and dont create the room', %AM7$%AM3$%AM0)
      staticinvoke <@%unk/%unk: .it()>('should update the room if it was created internally and programatically but it is a DM message but it should NOT create a new DM Room(this is necessary due to a race condition on matrix events)', %AM8$%AM3$%AM0)
      return"];
}
subgraph "cluster_@ts_files/194.ts: %dflt.%AM10$%AM9$%AM0()" {
  label="@ts_files/194.ts: %dflt.%AM10$%AM9$%AM0()";
  Node28940 [label="id:0
      this = this: @ts_files/194.ts: %dflt
      %0 = roomAdapter.<@%unk/%unk: .getFederatedRoomByExternalId>
      instanceinvoke %0.<@%unk/%unk: .resolves()>(room)
      %1 = userAdapter.<@%unk/%unk: .getFederatedUserByExternalId>
      instanceinvoke %1.<@%unk/%unk: .resolves()>(user)
      %2 = new @ts_files/194.ts: %AC$%dflt$%AM10$%AM9$%AM0$24
      instanceinvoke %2.<@ts_files/194.ts: %AC$%dflt$%AM10$%AM9$%AM0$24.constructor()>()
      %3 = <@ts_files/194.ts: %AC$%dflt$%AM10$%AM9$%AM0$24>%2
      %4 = instanceinvoke service.<@%unk/%unk: .onChangeRoomMembership()>(%3)
      %5 = await %4
      %6 = userAdapter.<@%unk/%unk: .createFederatedUser>
      %7 = %6.<@%unk/%unk: .called>
      %8 = staticinvoke <@%unk/%unk: .expect()>(%7)
      %9 = %8.<@%unk/%unk: .to>
      %10 = %9.<@%unk/%unk: .be>
      return"];
}
subgraph "cluster_@ts_files/194.ts: %dflt.%AM11$%AM9$%AM0()" {
  label="@ts_files/194.ts: %dflt.%AM11$%AM9$%AM0()";
  Node28950 [label="id:0
      this = this: @ts_files/194.ts: %dflt
      %0 = roomAdapter.<@%unk/%unk: .getFederatedRoomByExternalId>
      instanceinvoke %0.<@%unk/%unk: .resolves()>(room)
      %1 = userAdapter.<@%unk/%unk: .getFederatedUserByExternalId>
      instanceinvoke %1.<@%unk/%unk: .resolves()>(user)
      %2 = new @ts_files/194.ts: %AC$%dflt$%AM11$%AM9$%AM0$25
      instanceinvoke %2.<@ts_files/194.ts: %AC$%dflt$%AM11$%AM9$%AM0$25.constructor()>()
      %3 = <@ts_files/194.ts: %AC$%dflt$%AM11$%AM9$%AM0$25>%2
      %4 = instanceinvoke service.<@%unk/%unk: .onChangeRoomMembership()>(%3)
      %5 = await %4
      %6 = userAdapter.<@%unk/%unk: .createFederatedUser>
      %7 = %6.<@%unk/%unk: .called>
      %8 = staticinvoke <@%unk/%unk: .expect()>(%7)
      %9 = %8.<@%unk/%unk: .to>
      %10 = %9.<@%unk/%unk: .be>
      return"];
}
subgraph "cluster_@ts_files/194.ts: %dflt.%AM12$%AM9$%AM0()" {
  label="@ts_files/194.ts: %dflt.%AM12$%AM9$%AM0()";
  Node28960 [label="id:0
      this = this: @ts_files/194.ts: %dflt
      %0 = roomAdapter.<@%unk/%unk: .getFederatedRoomByExternalId>
      instanceinvoke %0.<@%unk/%unk: .resolves()>(undefined)
      %1 = userAdapter.<@%unk/%unk: .getFederatedUserByExternalId>
      %2 = instanceinvoke %1.<@%unk/%unk: .onFirstCall()>()
      instanceinvoke %2.<@%unk/%unk: .resolves()>(undefined)
      %3 = new @ts_files/194.ts: %AC$%dflt$%AM12$%AM9$%AM0$26
      instanceinvoke %3.<@ts_files/194.ts: %AC$%dflt$%AM12$%AM9$%AM0$26.constructor()>()
      %4 = <@ts_files/194.ts: %AC$%dflt$%AM12$%AM9$%AM0$26>%3
      %5 = instanceinvoke service.<@%unk/%unk: .onChangeRoomMembership()>(%4)
      %6 = await %5
      %7 = userAdapter.<@%unk/%unk: .createFederatedUser>
      %8 = %7.<@ts_files/194.ts: %AC$%dflt$%dflt$4.called>
      %9 = staticinvoke <@%unk/%unk: .expect()>(%8)
      %10 = %9.<@%unk/%unk: .to>
      %11 = %10.<@%unk/%unk: .be>
      return"];
}
subgraph "cluster_@ts_files/194.ts: %dflt.%AM13$%AM9$%AM0()" {
  label="@ts_files/194.ts: %dflt.%AM13$%AM9$%AM0()";
  Node28970 [label="id:0
      this = this: @ts_files/194.ts: %dflt
      %0 = roomAdapter.<@%unk/%unk: .getFederatedRoomByExternalId>
      instanceinvoke %0.<@%unk/%unk: .resolves()>(room)
      %1 = userAdapter.<@%unk/%unk: .getFederatedUserByExternalId>
      instanceinvoke %1.<@%unk/%unk: .resolves()>(user)
      %2 = new @ts_files/194.ts: %AC$%dflt$%AM13$%AM9$%AM0$27
      instanceinvoke %2.<@ts_files/194.ts: %AC$%dflt$%AM13$%AM9$%AM0$27.constructor()>()
      %3 = <@ts_files/194.ts: %AC$%dflt$%AM13$%AM9$%AM0$27>%2
      %4 = instanceinvoke service.<@%unk/%unk: .onChangeRoomMembership()>(%3)
      %5 = await %4
      %6 = userAdapter.<@%unk/%unk: .createFederatedUser>
      %7 = %6.<@%unk/%unk: .called>
      %8 = staticinvoke <@%unk/%unk: .expect()>(%7)
      %9 = %8.<@%unk/%unk: .to>
      %10 = %9.<@%unk/%unk: .be>
      return"];
}
subgraph "cluster_@ts_files/194.ts: %dflt.%AM14$%AM9$%AM0()" {
  label="@ts_files/194.ts: %dflt.%AM14$%AM9$%AM0()";
  Node28980 [label="id:0
      this = this: @ts_files/194.ts: %dflt
      %0 = new @ts_files/194.ts: %AC$%dflt$%AM14$%AM9$%AM0$28
      instanceinvoke %0.<@ts_files/194.ts: %AC$%dflt$%AM14$%AM9$%AM0$28.constructor()>()
      inviter = instanceinvoke FederatedUser.<@%unk/%unk: .createInstance()>('externalInviterId', %0)
      %1 = roomAdapter.<@%unk/%unk: .getFederatedRoomByExternalId>
      instanceinvoke %1.<@%unk/%unk: .resolves()>(room)
      %2 = userAdapter.<@%unk/%unk: .getFederatedUserByExternalId>
      %3 = instanceinvoke %2.<@%unk/%unk: .onFirstCall()>()
      instanceinvoke %3.<@%unk/%unk: .resolves()>(undefined)
      %4 = userAdapter.<@%unk/%unk: .getFederatedUserByExternalId>
      instanceinvoke %4.<@%unk/%unk: .resolves()>(user)
      %5 = bridge.<@%unk/%unk: .extractHomeserverOrigin>
      instanceinvoke %5.<@%unk/%unk: .returns()>('localDomain')
      %6 = new @ts_files/194.ts: %AC$%dflt$%AM14$%AM9$%AM0$29
      instanceinvoke %6.<@ts_files/194.ts: %AC$%dflt$%AM14$%AM9$%AM0$29.constructor()>()
      %7 = <@ts_files/194.ts: %AC$%dflt$%AM14$%AM9$%AM0$29>%6
      %8 = instanceinvoke service.<@%unk/%unk: .onChangeRoomMembership()>(%7)
      %9 = await %8
      %10 = userAdapter.<@%unk/%unk: .createFederatedUser>
      %11 = instanceinvoke %10.<@%unk/%unk: .calledWith()>(inviter)
      %12 = staticinvoke <@%unk/%unk: .expect()>(%11)
      %13 = %12.<@%unk/%unk: .to>
      %14 = %13.<@%unk/%unk: .be>
      return"];
}
subgraph "cluster_@ts_files/194.ts: %dflt.%AM15$%AM9$%AM0()" {
  label="@ts_files/194.ts: %dflt.%AM15$%AM9$%AM0()";
  Node28990 [label="id:0
      this = this: @ts_files/194.ts: %dflt
      %0 = roomAdapter.<@%unk/%unk: .getFederatedRoomByExternalId>
      instanceinvoke %0.<@%unk/%unk: .resolves()>(room)
      %1 = userAdapter.<@%unk/%unk: .getFederatedUserByExternalId>
      instanceinvoke %1.<@%unk/%unk: .resolves()>(user)
      %2 = new @ts_files/194.ts: %AC$%dflt$%AM15$%AM9$%AM0$30
      instanceinvoke %2.<@ts_files/194.ts: %AC$%dflt$%AM15$%AM9$%AM0$30.constructor()>()
      %3 = <@ts_files/194.ts: %AC$%dflt$%AM15$%AM9$%AM0$30>%2
      %4 = instanceinvoke service.<@%unk/%unk: .onChangeRoomMembership()>(%3)
      %5 = await %4
      %6 = userAdapter.<@%unk/%unk: .createFederatedUser>
      %7 = %6.<@%unk/%unk: .called>
      %8 = staticinvoke <@%unk/%unk: .expect()>(%7)
      %9 = %8.<@%unk/%unk: .to>
      %10 = %9.<@%unk/%unk: .be>
      return"];
}
subgraph "cluster_@ts_files/194.ts: %dflt.%AM16$%AM9$%AM0()" {
  label="@ts_files/194.ts: %dflt.%AM16$%AM9$%AM0()";
  Node29000 [label="id:0
      this = this: @ts_files/194.ts: %dflt
      %0 = new @ts_files/194.ts: %AC$%dflt$%AM16$%AM9$%AM0$31
      instanceinvoke %0.<@ts_files/194.ts: %AC$%dflt$%AM16$%AM9$%AM0$31.constructor()>()
      invitee = instanceinvoke FederatedUser.<@%unk/%unk: .createInstance()>('externalInviteeId', %0)
      %1 = roomAdapter.<@%unk/%unk: .getFederatedRoomByExternalId>
      instanceinvoke %1.<@%unk/%unk: .resolves()>(room)
      %2 = userAdapter.<@%unk/%unk: .getFederatedUserByExternalId>
      instanceinvoke %2.<@%unk/%unk: .resolves()>(invitee)
      %3 = userAdapter.<@%unk/%unk: .getFederatedUserByExternalId>
      %4 = instanceinvoke %3.<@%unk/%unk: .onSecondCall()>()
      instanceinvoke %4.<@%unk/%unk: .resolves()>(undefined)
      %5 = bridge.<@%unk/%unk: .extractHomeserverOrigin>
      %6 = instanceinvoke %5.<@%unk/%unk: .onCall()>(1)
      instanceinvoke %6.<@%unk/%unk: .returns()>('externalDomain')
      %7 = new @ts_files/194.ts: %AC$%dflt$%AM16$%AM9$%AM0$32
      instanceinvoke %7.<@ts_files/194.ts: %AC$%dflt$%AM16$%AM9$%AM0$32.constructor()>()
      %8 = <@ts_files/194.ts: %AC$%dflt$%AM16$%AM9$%AM0$32>%7
      %9 = instanceinvoke service.<@%unk/%unk: .onChangeRoomMembership()>(%8)
      %10 = await %9
      %11 = userAdapter.<@%unk/%unk: .createFederatedUser>
      %12 = instanceinvoke %11.<@%unk/%unk: .calledWith()>(invitee)
      %13 = staticinvoke <@%unk/%unk: .expect()>(%12)
      %14 = %13.<@%unk/%unk: .to>
      %15 = %14.<@%unk/%unk: .be>
      return"];
}
subgraph "cluster_@ts_files/194.ts: %dflt.%AM17$%AM9$%AM0()" {
  label="@ts_files/194.ts: %dflt.%AM17$%AM9$%AM0()";
  Node29010 [label="id:0
      this = this: @ts_files/194.ts: %dflt
      %0 = roomAdapter.<@%unk/%unk: .getFederatedRoomByExternalId>
      instanceinvoke %0.<@%unk/%unk: .resolves()>(room)
      %1 = userAdapter.<@%unk/%unk: .getFederatedUserByExternalId>
      instanceinvoke %1.<@%unk/%unk: .resolves()>(undefined)
      %2 = new @ts_files/194.ts: %AC$%dflt$%AM17$%AM9$%AM0$33
      instanceinvoke %2.<@ts_files/194.ts: %AC$%dflt$%AM17$%AM9$%AM0$33.constructor()>()
      %3 = <@ts_files/194.ts: %AC$%dflt$%AM17$%AM9$%AM0$33>%2
      %4 = instanceinvoke service.<@%unk/%unk: .onChangeRoomMembership()>(%3)
      %5 = staticinvoke <@%unk/%unk: .expect()>(%4)
      %6 = %5.<@%unk/%unk: .to>
      %7 = %6.<@%unk/%unk: .be>
      %8 = instanceinvoke %7.<@%unk/%unk: .rejectedWith()>('Invitee or inviter user not found')
      %9 = await %8
      return"];
}
subgraph "cluster_@ts_files/194.ts: %dflt.%AM18$%AM9$%AM0()" {
  label="@ts_files/194.ts: %dflt.%AM18$%AM9$%AM0()";
  Node29020 [label="id:0
      this = this: @ts_files/194.ts: %dflt
      %0 = roomAdapter.<@%unk/%unk: .getFederatedRoomByExternalId>
      instanceinvoke %0.<@%unk/%unk: .resolves()>(room)
      %1 = userAdapter.<@%unk/%unk: .getFederatedUserByExternalId>
      instanceinvoke %1.<@%unk/%unk: .resolves()>(undefined)
      %2 = new @ts_files/194.ts: %AC$%dflt$%AM18$%AM9$%AM0$34
      instanceinvoke %2.<@ts_files/194.ts: %AC$%dflt$%AM18$%AM9$%AM0$34.constructor()>()
      %3 = <@ts_files/194.ts: %AC$%dflt$%AM18$%AM9$%AM0$34>%2
      %4 = instanceinvoke service.<@%unk/%unk: .onChangeRoomMembership()>(%3)
      %5 = staticinvoke <@%unk/%unk: .expect()>(%4)
      %6 = %5.<@%unk/%unk: .to>
      %7 = %6.<@%unk/%unk: .be>
      %8 = instanceinvoke %7.<@%unk/%unk: .rejectedWith()>('Invitee or inviter user not found')
      %9 = await %8
      return"];
}
subgraph "cluster_@ts_files/194.ts: %dflt.%AM19$%AM9$%AM0()" {
  label="@ts_files/194.ts: %dflt.%AM19$%AM9$%AM0()";
  Node29030 [label="id:0
      this = this: @ts_files/194.ts: %dflt
      %0 = roomAdapter.<@%unk/%unk: .getFederatedRoomByExternalId>
      %1 = instanceinvoke %0.<@%unk/%unk: .onCall()>(0)
      instanceinvoke %1.<@%unk/%unk: .resolves()>(undefined)
      %2 = roomAdapter.<@%unk/%unk: .getFederatedRoomByExternalId>
      instanceinvoke %2.<@%unk/%unk: .resolves()>(room)
      %3 = userAdapter.<@%unk/%unk: .getFederatedUserByExternalId>
      instanceinvoke %3.<@%unk/%unk: .resolves()>(user)
      %4 = new @ts_files/194.ts: %AC$%dflt$%AM19$%AM9$%AM0$35
      instanceinvoke %4.<@ts_files/194.ts: %AC$%dflt$%AM19$%AM9$%AM0$35.constructor()>()
      %5 = <@ts_files/194.ts: %AC$%dflt$%AM19$%AM9$%AM0$35>%4
      %6 = instanceinvoke service.<@%unk/%unk: .onChangeRoomMembership()>(%5)
      %7 = await %6
      %8 = roomAdapter.<@%unk/%unk: .createFederatedRoom>
      %9 = %8.<@%unk/%unk: .called>
      %10 = staticinvoke <@%unk/%unk: .expect()>(%9)
      %11 = %10.<@%unk/%unk: .to>
      %12 = %11.<@%unk/%unk: .be>
      return"];
}
subgraph "cluster_@ts_files/194.ts: %dflt.%AM20$%AM9$%AM0()" {
  label="@ts_files/194.ts: %dflt.%AM20$%AM9$%AM0()";
  Node28950 [label="id:0
      this = this: @ts_files/194.ts: %dflt
      inviter = user
      %0 = new @ts_files/194.ts: %AC$%dflt$%AM20$%AM9$%AM0$36
      instanceinvoke %0.<@ts_files/194.ts: %AC$%dflt$%AM20$%AM9$%AM0$36.constructor()>()
      invitee = instanceinvoke FederatedUser.<@%unk/%unk: .createInstance()>('externalInviteeId', %0)
      %1 = roomAdapter.<@%unk/%unk: .getFederatedRoomByExternalId>
      %2 = instanceinvoke %1.<@%unk/%unk: .onCall()>(0)
      instanceinvoke %2.<@%unk/%unk: .resolves()>(undefined)
      %3 = roomAdapter.<@%unk/%unk: .getFederatedRoomByExternalId>
      instanceinvoke %3.<@%unk/%unk: .resolves()>(room)
      %4 = userAdapter.<@%unk/%unk: .getFederatedUserByExternalId>
      %5 = instanceinvoke %4.<@%unk/%unk: .onCall()>(0)
      instanceinvoke %5.<@%unk/%unk: .resolves()>(inviter)
      %6 = userAdapter.<@%unk/%unk: .getFederatedUserByExternalId>
      instanceinvoke %6.<@%unk/%unk: .resolves()>(invitee)
      %7 = bridge.<@%unk/%unk: .extractHomeserverOrigin>
      instanceinvoke %7.<@%unk/%unk: .returns()>('localDomain')
      %8 = new @ts_files/194.ts: %AC$%dflt$%AM20$%AM9$%AM0$37
      instanceinvoke %8.<@ts_files/194.ts: %AC$%dflt$%AM20$%AM9$%AM0$37.constructor()>()
      %9 = <@ts_files/194.ts: %AC$%dflt$%AM20$%AM9$%AM0$37>%8
      %10 = instanceinvoke service.<@%unk/%unk: .onChangeRoomMembership()>(%9)
      %11 = await %10
      %12 = newarray (unknown)[2]
      %12[0] = inviter
      %12[1] = invitee
      createdRoom = instanceinvoke DirectMessageFederatedRoom.<@%unk/%unk: .createInstance()>('externalRoomId', inviter, %12)
      %13 = roomAdapter.<@%unk/%unk: .createFederatedRoomForDirectMessage>
      %14 = instanceinvoke %13.<@%unk/%unk: .calledWith()>(createdRoom)
      %15 = staticinvoke <@%unk/%unk: .expect()>(%14)
      %16 = %15.<@%unk/%unk: .to>
      %17 = %16.<@%unk/%unk: .be>
      %18 = roomAdapter.<@%unk/%unk: .createFederatedRoom>
      %19 = %18.<@%unk/%unk: .called>
      %20 = staticinvoke <@%unk/%unk: .expect()>(%19)
      %21 = %20.<@%unk/%unk: .to>
      %22 = %21.<@%unk/%unk: .be>
      %23 = bridge.<@%unk/%unk: .joinRoom>
      %24 = instanceinvoke %23.<@%unk/%unk: .calledOnceWith()>('externalRoomId', 'externalInviteeId')
      %25 = staticinvoke <@%unk/%unk: .expect()>(%24)
      %26 = %25.<@%unk/%unk: .to>
      %27 = %26.<@%unk/%unk: .be>
      return"];
}
subgraph "cluster_@ts_files/194.ts: %dflt.%AM21$%AM9$%AM0()" {
  label="@ts_files/194.ts: %dflt.%AM21$%AM9$%AM0()";
  Node28960 [label="id:0
      this = this: @ts_files/194.ts: %dflt
      inviter = user
      %0 = new @ts_files/194.ts: %AC$%dflt$%AM21$%AM9$%AM0$38
      instanceinvoke %0.<@ts_files/194.ts: %AC$%dflt$%AM21$%AM9$%AM0$38.constructor()>()
      invitee = instanceinvoke FederatedUser.<@%unk/%unk: .createInstance()>('externalInviteeId', %0)
      %1 = roomAdapter.<@%unk/%unk: .getFederatedRoomByExternalId>
      %2 = instanceinvoke %1.<@%unk/%unk: .onCall()>(0)
      instanceinvoke %2.<@%unk/%unk: .resolves()>(undefined)
      %3 = roomAdapter.<@%unk/%unk: .getFederatedRoomByExternalId>
      instanceinvoke %3.<@%unk/%unk: .resolves()>(room)
      %4 = userAdapter.<@%unk/%unk: .getFederatedUserByExternalId>
      %5 = instanceinvoke %4.<@%unk/%unk: .onCall()>(0)
      instanceinvoke %5.<@%unk/%unk: .resolves()>(inviter)
      %6 = userAdapter.<@%unk/%unk: .getFederatedUserByExternalId>
      instanceinvoke %6.<@%unk/%unk: .resolves()>(invitee)
      %7 = bridge.<@%unk/%unk: .extractHomeserverOrigin>
      instanceinvoke %7.<@%unk/%unk: .returns()>('externalDomain')
      %8 = new @ts_files/194.ts: %AC$%dflt$%AM21$%AM9$%AM0$39
      instanceinvoke %8.<@ts_files/194.ts: %AC$%dflt$%AM21$%AM9$%AM0$39.constructor()>()
      %9 = <@ts_files/194.ts: %AC$%dflt$%AM21$%AM9$%AM0$39>%8
      %10 = instanceinvoke service.<@%unk/%unk: .onChangeRoomMembership()>(%9)
      %11 = await %10
      %12 = newarray (unknown)[2]
      %12[0] = inviter
      %12[1] = invitee
      createdRoom = instanceinvoke DirectMessageFederatedRoom.<@%unk/%unk: .createInstance()>('externalRoomId', inviter, %12)
      %13 = roomAdapter.<@%unk/%unk: .createFederatedRoomForDirectMessage>
      %14 = instanceinvoke %13.<@%unk/%unk: .calledWith()>(createdRoom)
      %15 = staticinvoke <@%unk/%unk: .expect()>(%14)
      %16 = %15.<@%unk/%unk: .to>
      %17 = %16.<@%unk/%unk: .be>
      %18 = roomAdapter.<@%unk/%unk: .createFederatedRoom>
      %19 = %18.<@%unk/%unk: .called>
      %20 = staticinvoke <@%unk/%unk: .expect()>(%19)
      %21 = %20.<@%unk/%unk: .to>
      %22 = %21.<@%unk/%unk: .be>
      %23 = bridge.<@%unk/%unk: .joinRoom>
      %24 = %23.<@%unk/%unk: .called>
      %25 = staticinvoke <@%unk/%unk: .expect()>(%24)
      %26 = %25.<@%unk/%unk: .to>
      %27 = %26.<@%unk/%unk: .be>
      return"];
}
subgraph "cluster_@ts_files/194.ts: %dflt.%AM22$%AM9$%AM0()" {
  label="@ts_files/194.ts: %dflt.%AM22$%AM9$%AM0()";
  Node28970 [label="id:0
      this = this: @ts_files/194.ts: %dflt
      inviter = user
      %0 = new @ts_files/194.ts: %AC$%dflt$%AM22$%AM9$%AM0$40
      instanceinvoke %0.<@ts_files/194.ts: %AC$%dflt$%AM22$%AM9$%AM0$40.constructor()>()
      invitee = instanceinvoke FederatedUser.<@%unk/%unk: .createInstance()>('externalInviteeId', %0)
      %1 = roomAdapter.<@%unk/%unk: .getFederatedRoomByExternalId>
      %2 = instanceinvoke %1.<@%unk/%unk: .onCall()>(0)
      instanceinvoke %2.<@%unk/%unk: .resolves()>(undefined)
      %3 = roomAdapter.<@%unk/%unk: .getFederatedRoomByExternalId>
      instanceinvoke %3.<@%unk/%unk: .resolves()>(room)
      %4 = userAdapter.<@%unk/%unk: .getFederatedUserByExternalId>
      %5 = instanceinvoke %4.<@%unk/%unk: .onCall()>(0)
      instanceinvoke %5.<@%unk/%unk: .resolves()>(inviter)
      %6 = userAdapter.<@%unk/%unk: .getFederatedUserByExternalId>
      instanceinvoke %6.<@%unk/%unk: .resolves()>(invitee)
      %7 = bridge.<@%unk/%unk: .extractHomeserverOrigin>
      instanceinvoke %7.<@%unk/%unk: .returns()>('localDomain')
      %8 = new @ts_files/194.ts: %AC$%dflt$%AM22$%AM9$%AM0$41
      instanceinvoke %8.<@ts_files/194.ts: %AC$%dflt$%AM22$%AM9$%AM0$41.constructor()>()
      %9 = <@ts_files/194.ts: %AC$%dflt$%AM22$%AM9$%AM0$41>%8
      %10 = instanceinvoke service.<@%unk/%unk: .onChangeRoomMembership()>(%9)
      %11 = await %10
      %12 = newarray (unknown)[2]
      %12[0] = inviter
      %12[1] = invitee
      createdRoom = instanceinvoke DirectMessageFederatedRoom.<@%unk/%unk: .createInstance()>('externalRoomId', inviter, %12)
      %13 = roomAdapter.<@%unk/%unk: .createFederatedRoomForDirectMessage>
      %14 = instanceinvoke %13.<@%unk/%unk: .calledWith()>(createdRoom)
      %15 = staticinvoke <@%unk/%unk: .expect()>(%14)
      %16 = %15.<@%unk/%unk: .to>
      %17 = %16.<@%unk/%unk: .be>
      %18 = roomAdapter.<@%unk/%unk: .createFederatedRoom>
      %19 = %18.<@%unk/%unk: .called>
      %20 = staticinvoke <@%unk/%unk: .expect()>(%19)
      %21 = %20.<@%unk/%unk: .to>
      %22 = %21.<@%unk/%unk: .be>
      %23 = bridge.<@%unk/%unk: .joinRoom>
      %24 = instanceinvoke %23.<@%unk/%unk: .calledOnceWith()>('externalRoomId', 'externalInviteeId')
      %25 = staticinvoke <@%unk/%unk: .expect()>(%24)
      %26 = %25.<@%unk/%unk: .to>
      %27 = %26.<@%unk/%unk: .be>
      return"];
}
subgraph "cluster_@ts_files/194.ts: %dflt.%AM23$%AM9$%AM0()" {
  label="@ts_files/194.ts: %dflt.%AM23$%AM9$%AM0()";
  Node28980 [label="id:0
      this = this: @ts_files/194.ts: %dflt
      inviter = user
      %0 = new @ts_files/194.ts: %AC$%dflt$%AM23$%AM9$%AM0$43
      instanceinvoke %0.<@ts_files/194.ts: %AC$%dflt$%AM23$%AM9$%AM0$43.constructor()>()
      invitee = instanceinvoke FederatedUser.<@%unk/%unk: .createInstance()>('externalInviteeId', %0)
      %1 = roomAdapter.<@%unk/%unk: .getFederatedRoomByExternalId>
      %2 = instanceinvoke %1.<@%unk/%unk: .onCall()>(0)
      instanceinvoke %2.<@%unk/%unk: .resolves()>(undefined)
      %3 = roomAdapter.<@%unk/%unk: .getFederatedRoomByExternalId>
      instanceinvoke %3.<@%unk/%unk: .resolves()>(room)
      %4 = userAdapter.<@%unk/%unk: .getFederatedUserByExternalId>
      %5 = instanceinvoke %4.<@%unk/%unk: .onCall()>(0)
      instanceinvoke %5.<@%unk/%unk: .resolves()>(inviter)
      %6 = userAdapter.<@%unk/%unk: .getFederatedUserByExternalId>
      instanceinvoke %6.<@%unk/%unk: .resolves()>(invitee)
      %7 = bridge.<@%unk/%unk: .extractHomeserverOrigin>
      instanceinvoke %7.<@%unk/%unk: .returns()>('externalDomain')
      %8 = new @ts_files/194.ts: %AC$%dflt$%AM23$%AM9$%AM0$44
      instanceinvoke %8.<@ts_files/194.ts: %AC$%dflt$%AM23$%AM9$%AM0$44.constructor()>()
      %9 = <@ts_files/194.ts: %AC$%dflt$%AM23$%AM9$%AM0$44>%8
      %10 = instanceinvoke service.<@%unk/%unk: .onChangeRoomMembership()>(%9)
      %11 = await %10
      %12 = newarray (unknown)[2]
      %12[0] = inviter
      %12[1] = invitee
      createdRoom = instanceinvoke DirectMessageFederatedRoom.<@%unk/%unk: .createInstance()>('externalRoomId', inviter, %12)
      %13 = roomAdapter.<@%unk/%unk: .createFederatedRoomForDirectMessage>
      %14 = instanceinvoke %13.<@%unk/%unk: .calledWith()>(createdRoom)
      %15 = staticinvoke <@%unk/%unk: .expect()>(%14)
      %16 = %15.<@%unk/%unk: .to>
      %17 = %16.<@%unk/%unk: .be>
      %18 = roomAdapter.<@%unk/%unk: .createFederatedRoom>
      %19 = %18.<@%unk/%unk: .called>
      %20 = staticinvoke <@%unk/%unk: .expect()>(%19)
      %21 = %20.<@%unk/%unk: .to>
      %22 = %21.<@%unk/%unk: .be>
      %23 = bridge.<@%unk/%unk: .joinRoom>
      %24 = %23.<@%unk/%unk: .called>
      %25 = staticinvoke <@%unk/%unk: .expect()>(%24)
      %26 = %25.<@%unk/%unk: .to>
      %27 = %26.<@%unk/%unk: .be>
      return"];
}
subgraph "cluster_@ts_files/194.ts: %dflt.%AM25$%AM24$%AM9$%AM0(unknown)" {
  label="@ts_files/194.ts: %dflt.%AM25$%AM24$%AM9$%AM0(unknown)";
  Node40010 [label="id:0
      event = parameter0: string
      this = this: @ts_files/194.ts: %dflt
      %0 = queueInstance.<@%unk/%unk: .addToQueue>
      %1 = instanceinvoke %0.<@%unk/%unk: .calledWith()>(event)
      %2 = staticinvoke <@%unk/%unk: .expect()>(%1)
      %3 = %2.<@%unk/%unk: .to>
      %4 = %3.<@%unk/%unk: .be>
      %5 = %4.<@ts_files/194.ts: %AC$%dflt$%dflt$2.true>
      return %5"];
}
subgraph "cluster_@ts_files/194.ts: %dflt.%AM24$%AM9$%AM0()" {
  label="@ts_files/194.ts: %dflt.%AM24$%AM9$%AM0()";
  Node28990 [label="id:0
      this = this: @ts_files/194.ts: %dflt
      %0 = new @ts_files/194.ts: %AC$%dflt$%AM24$%AM9$%AM0$46
      instanceinvoke %0.<@ts_files/194.ts: %AC$%dflt$%AM24$%AM9$%AM0$46.constructor()>()
      invitee = instanceinvoke FederatedUser.<@%unk/%unk: .createInstance()>('externalInviteeId', %0)
      %1 = roomAdapter.<@%unk/%unk: .getFederatedRoomByExternalId>
      %2 = instanceinvoke %1.<@%unk/%unk: .onCall()>(0)
      instanceinvoke %2.<@%unk/%unk: .resolves()>(undefined)
      %3 = roomAdapter.<@%unk/%unk: .getFederatedRoomByExternalId>
      instanceinvoke %3.<@%unk/%unk: .resolves()>(room)
      %4 = userAdapter.<@%unk/%unk: .getFederatedUserByExternalId>
      instanceinvoke %4.<@%unk/%unk: .resolves()>(invitee)
      %5 = newarray (string)[2]
      %5[0] = 'event1'
      %5[1] = 'event2'
      %6 = bridge.<@%unk/%unk: .getRoomHistoricalJoinEvents>
      instanceinvoke %6.<@%unk/%unk: .resolves()>(%5)
      %7 = new @ts_files/194.ts: %AC$%dflt$%AM24$%AM9$%AM0$47
      instanceinvoke %7.<@ts_files/194.ts: %AC$%dflt$%AM24$%AM9$%AM0$47.constructor()>()
      %8 = <@ts_files/194.ts: %AC$%dflt$%AM24$%AM9$%AM0$47>%7
      %9 = instanceinvoke service.<@%unk/%unk: .onChangeRoomMembership()>(%8)
      %10 = await %9
      %11 = RoomType.<@%unk/%unk: .CHANNEL>
      createdRoom = instanceinvoke FederatedRoom.<@%unk/%unk: .createInstance()>('externalRoomId', 'normalizedRoomId', invitee, %11)
      %12 = roomAdapter.<@%unk/%unk: .createFederatedRoom>
      %13 = instanceinvoke %12.<@%unk/%unk: .calledWith()>(createdRoom)
      %14 = staticinvoke <@%unk/%unk: .expect()>(%13)
      %15 = %14.<@%unk/%unk: .to>
      %16 = %15.<@%unk/%unk: .be>
      %17 = roomAdapter.<@%unk/%unk: .createFederatedRoomForDirectMessage>
      %18 = %17.<@%unk/%unk: .called>
      %19 = staticinvoke <@%unk/%unk: .expect()>(%18)
      %20 = %19.<@%unk/%unk: .to>
      %21 = %20.<@%unk/%unk: .be>
      %22 = bridge.<@%unk/%unk: .joinRoom>
      %23 = instanceinvoke %22.<@%unk/%unk: .calledWith()>('externalRoomId', 'externalInviteeId')
      %24 = staticinvoke <@%unk/%unk: .expect()>(%23)
      %25 = %24.<@%unk/%unk: .to>
      %26 = %25.<@%unk/%unk: .be>
      %27 = newarray (string)[2]
      %27[0] = 'event1'
      %27[1] = 'event2'
      instanceinvoke %27.<@%unk/%unk: .forEach()>(%AM25$%AM24$%AM9$%AM0)
      return"];
}
subgraph "cluster_@ts_files/194.ts: %dflt.%AM26$%AM9$%AM0()" {
  label="@ts_files/194.ts: %dflt.%AM26$%AM9$%AM0()";
  Node29010 [label="id:0
      this = this: @ts_files/194.ts: %dflt
      %0 = new @ts_files/194.ts: %AC$%dflt$%AM26$%AM9$%AM0$48
      instanceinvoke %0.<@ts_files/194.ts: %AC$%dflt$%AM26$%AM9$%AM0$48.constructor()>()
      invitee = instanceinvoke FederatedUser.<@%unk/%unk: .createInstance()>('externalInviteeId', %0)
      %1 = roomAdapter.<@%unk/%unk: .getFederatedRoomByExternalId>
      %2 = instanceinvoke %1.<@%unk/%unk: .onCall()>(0)
      instanceinvoke %2.<@%unk/%unk: .resolves()>(undefined)
      %3 = roomAdapter.<@%unk/%unk: .getFederatedRoomByExternalId>
      instanceinvoke %3.<@%unk/%unk: .resolves()>(room)
      %4 = userAdapter.<@%unk/%unk: .getFederatedUserByExternalId>
      instanceinvoke %4.<@%unk/%unk: .resolves()>(invitee)
      %5 = newarray (any)[0]
      %6 = bridge.<@%unk/%unk: .getRoomHistoricalJoinEvents>
      instanceinvoke %6.<@%unk/%unk: .resolves()>(%5)
      %7 = new @ts_files/194.ts: %AC$%dflt$%AM26$%AM9$%AM0$49
      instanceinvoke %7.<@ts_files/194.ts: %AC$%dflt$%AM26$%AM9$%AM0$49.constructor()>()
      %8 = <@ts_files/194.ts: %AC$%dflt$%AM26$%AM9$%AM0$49>%7
      %9 = instanceinvoke service.<@%unk/%unk: .onChangeRoomMembership()>(%8)
      %10 = await %9
      %11 = RoomType.<@%unk/%unk: .CHANNEL>
      createdRoom = instanceinvoke FederatedRoom.<@%unk/%unk: .createInstance()>('externalRoomId', 'normalizedRoomId', invitee, %11)
      %12 = roomAdapter.<@%unk/%unk: .createFederatedRoom>
      %13 = instanceinvoke %12.<@%unk/%unk: .calledWith()>(createdRoom)
      %14 = staticinvoke <@%unk/%unk: .expect()>(%13)
      %15 = %14.<@%unk/%unk: .to>
      %16 = %15.<@%unk/%unk: .be>
      %17 = roomAdapter.<@%unk/%unk: .createFederatedRoomForDirectMessage>
      %18 = %17.<@%unk/%unk: .called>
      %19 = staticinvoke <@%unk/%unk: .expect()>(%18)
      %20 = %19.<@%unk/%unk: .to>
      %21 = %20.<@%unk/%unk: .be>
      %22 = bridge.<@%unk/%unk: .joinRoom>
      %23 = instanceinvoke %22.<@%unk/%unk: .calledWith()>('externalRoomId', 'externalInviteeId')
      %24 = staticinvoke <@%unk/%unk: .expect()>(%23)
      %25 = %24.<@%unk/%unk: .to>
      %26 = %25.<@%unk/%unk: .be>
      %27 = queueInstance.<@%unk/%unk: .addToQueue>
      %28 = %27.<@%unk/%unk: .called>
      %29 = staticinvoke <@%unk/%unk: .expect()>(%28)
      %30 = %29.<@%unk/%unk: .to>
      %31 = %30.<@%unk/%unk: .be>
      return"];
}
subgraph "cluster_@ts_files/194.ts: %dflt.%AM27$%AM9$%AM0()" {
  label="@ts_files/194.ts: %dflt.%AM27$%AM9$%AM0()";
  Node29020 [label="id:0
      this = this: @ts_files/194.ts: %dflt
      %0 = new @ts_files/194.ts: %AC$%dflt$%AM27$%AM9$%AM0$50
      instanceinvoke %0.<@ts_files/194.ts: %AC$%dflt$%AM27$%AM9$%AM0$50.constructor()>()
      invitee = instanceinvoke FederatedUser.<@%unk/%unk: .createInstance()>('externalInviteeId', %0)
      %1 = roomAdapter.<@%unk/%unk: .getFederatedRoomByExternalId>
      %2 = instanceinvoke %1.<@%unk/%unk: .onCall()>(0)
      instanceinvoke %2.<@%unk/%unk: .resolves()>(undefined)
      %3 = roomAdapter.<@%unk/%unk: .getFederatedRoomByExternalId>
      instanceinvoke %3.<@%unk/%unk: .resolves()>(room)
      %4 = userAdapter.<@%unk/%unk: .getFederatedUserByExternalId>
      instanceinvoke %4.<@%unk/%unk: .resolves()>(invitee)
      %5 = newarray (any)[0]
      %6 = bridge.<@%unk/%unk: .getRoomHistoricalJoinEvents>
      instanceinvoke %6.<@%unk/%unk: .resolves()>(%5)
      spy = instanceinvoke sinon.<@%unk/%unk: .spy()>(service, 'onChangeRoomName')
      %7 = new @ts_files/194.ts: %AC$%dflt$%AM27$%AM9$%AM0$51
      instanceinvoke %7.<@ts_files/194.ts: %AC$%dflt$%AM27$%AM9$%AM0$51.constructor()>()
      %8 = <@ts_files/194.ts: %AC$%dflt$%AM27$%AM9$%AM0$51>%7
      %9 = instanceinvoke service.<@%unk/%unk: .onChangeRoomMembership()>(%8)
      %10 = await %9
      %11 = new @ts_files/194.ts: %AC$%dflt$%AM27$%AM9$%AM0$52
      instanceinvoke %11.<@ts_files/194.ts: %AC$%dflt$%AM27$%AM9$%AM0$52.constructor()>()
      %12 = instanceinvoke spy.<@%unk/%unk: .calledWith()>(%11)
      %13 = staticinvoke <@%unk/%unk: .expect()>(%12)
      %14 = %13.<@%unk/%unk: .to>
      %15 = %14.<@%unk/%unk: .be>
      return"];
}
subgraph "cluster_@ts_files/194.ts: %dflt.%AM28$%AM9$%AM0()" {
  label="@ts_files/194.ts: %dflt.%AM28$%AM9$%AM0()";
  Node29030 [label="id:0
      this = this: @ts_files/194.ts: %dflt
      %0 = roomAdapter.<@%unk/%unk: .getFederatedRoomByExternalId>
      instanceinvoke %0.<@%unk/%unk: .resolves()>(room)
      %1 = userAdapter.<@%unk/%unk: .getFederatedUserByExternalId>
      instanceinvoke %1.<@%unk/%unk: .resolves()>(user)
      %2 = new @ts_files/194.ts: %AC$%dflt$%AM28$%AM9$%AM0$53
      instanceinvoke %2.<@ts_files/194.ts: %AC$%dflt$%AM28$%AM9$%AM0$53.constructor()>()
      %3 = <@ts_files/194.ts: %AC$%dflt$%AM28$%AM9$%AM0$53>%2
      %4 = instanceinvoke service.<@%unk/%unk: .onChangeRoomMembership()>(%3)
      %5 = await %4
      %6 = roomAdapter.<@%unk/%unk: .createFederatedRoom>
      %7 = %6.<@%unk/%unk: .called>
      %8 = staticinvoke <@%unk/%unk: .expect()>(%7)
      %9 = %8.<@%unk/%unk: .to>
      %10 = %9.<@%unk/%unk: .be>
      %11 = roomAdapter.<@%unk/%unk: .createFederatedRoomForDirectMessage>
      %12 = %11.<@%unk/%unk: .called>
      %13 = staticinvoke <@%unk/%unk: .expect()>(%12)
      %14 = %13.<@%unk/%unk: .to>
      %15 = %14.<@%unk/%unk: .be>
      %16 = bridge.<@%unk/%unk: .joinRoom>
      %17 = %16.<@%unk/%unk: .called>
      %18 = staticinvoke <@%unk/%unk: .expect()>(%17)
      %19 = %18.<@%unk/%unk: .to>
      %20 = %19.<@%unk/%unk: .be>
      return"];
}
subgraph "cluster_@ts_files/194.ts: %dflt.%AM29$%AM9$%AM0()" {
  label="@ts_files/194.ts: %dflt.%AM29$%AM9$%AM0()";
  Node29040 [label="id:0
      this = this: @ts_files/194.ts: %dflt
      %0 = roomAdapter.<@%unk/%unk: .getFederatedRoomByExternalId>
      instanceinvoke %0.<@%unk/%unk: .resolves()>(room)
      %1 = roomAdapter.<@%unk/%unk: .isUserAlreadyJoined>
      instanceinvoke %1.<@%unk/%unk: .resolves()>(true)
      %2 = userAdapter.<@%unk/%unk: .getFederatedUserByExternalId>
      instanceinvoke %2.<@%unk/%unk: .resolves()>(user)
      %3 = new @ts_files/194.ts: %AC$%dflt$%AM29$%AM9$%AM0$54
      instanceinvoke %3.<@ts_files/194.ts: %AC$%dflt$%AM29$%AM9$%AM0$54.constructor()>()
      %4 = <@ts_files/194.ts: %AC$%dflt$%AM29$%AM9$%AM0$54>%3
      %5 = instanceinvoke service.<@%unk/%unk: .onChangeRoomMembership()>(%4)
      %6 = await %5
      %7 = roomAdapter.<@%unk/%unk: .removeUserFromRoom>
      %8 = instanceinvoke %7.<@%unk/%unk: .calledWith()>(room, user, user)
      %9 = staticinvoke <@%unk/%unk: .expect()>(%8)
      %10 = %9.<@%unk/%unk: .to>
      %11 = %10.<@%unk/%unk: .be>
      %12 = roomAdapter.<@%unk/%unk: .addUserToRoom>
      %13 = %12.<@%unk/%unk: .called>
      %14 = staticinvoke <@%unk/%unk: .expect()>(%13)
      %15 = %14.<@%unk/%unk: .to>
      %16 = %15.<@%unk/%unk: .be>
      return"];
}
subgraph "cluster_@ts_files/194.ts: %dflt.%AM30$%AM9$%AM0()" {
  label="@ts_files/194.ts: %dflt.%AM30$%AM9$%AM0()";
  Node28960 [label="id:0
      this = this: @ts_files/194.ts: %dflt
      %0 = roomAdapter.<@%unk/%unk: .getFederatedRoomByExternalId>
      instanceinvoke %0.<@%unk/%unk: .resolves()>(room)
      %1 = roomAdapter.<@%unk/%unk: .isUserAlreadyJoined>
      instanceinvoke %1.<@%unk/%unk: .resolves()>(false)
      %2 = userAdapter.<@%unk/%unk: .getFederatedUserByExternalId>
      instanceinvoke %2.<@%unk/%unk: .resolves()>(user)
      %3 = new @ts_files/194.ts: %AC$%dflt$%AM30$%AM9$%AM0$55
      instanceinvoke %3.<@ts_files/194.ts: %AC$%dflt$%AM30$%AM9$%AM0$55.constructor()>()
      %4 = <@ts_files/194.ts: %AC$%dflt$%AM30$%AM9$%AM0$55>%3
      %5 = instanceinvoke service.<@%unk/%unk: .onChangeRoomMembership()>(%4)
      %6 = await %5
      %7 = roomAdapter.<@%unk/%unk: .removeUserFromRoom>
      %8 = %7.<@ts_files/194.ts: %AC$%dflt$%dflt$4.called>
      %9 = staticinvoke <@%unk/%unk: .expect()>(%8)
      %10 = %9.<@%unk/%unk: .to>
      %11 = %10.<@%unk/%unk: .be>
      %12 = roomAdapter.<@%unk/%unk: .addUserToRoom>
      %13 = %12.<@%unk/%unk: .called>
      %14 = staticinvoke <@%unk/%unk: .expect()>(%13)
      %15 = %14.<@%unk/%unk: .to>
      %16 = %15.<@%unk/%unk: .be>
      return"];
}
subgraph "cluster_@ts_files/194.ts: %dflt.%AM31$%AM9$%AM0()" {
  label="@ts_files/194.ts: %dflt.%AM31$%AM9$%AM0()";
  Node28970 [label="id:0
      this = this: @ts_files/194.ts: %dflt
      %0 = new @ts_files/194.ts: %AC$%dflt$%AM31$%AM9$%AM0$56
      instanceinvoke %0.<@ts_files/194.ts: %AC$%dflt$%AM31$%AM9$%AM0$56.constructor()>()
      %1 = <@ts_files/194.ts: %AC$%dflt$%AM31$%AM9$%AM0$56>%0
      %2 = newarray (unknown)[2]
      %2[0] = user
      %2[1] = user
      dmRoom = instanceinvoke DirectMessageFederatedRoom.<@%unk/%unk: .createWithInternalReference()>('externalRoomId', %1, %2)
      %3 = roomAdapter.<@%unk/%unk: .getFederatedRoomByExternalId>
      instanceinvoke %3.<@%unk/%unk: .resolves()>(dmRoom)
      %4 = userAdapter.<@%unk/%unk: .getFederatedUserByExternalId>
      instanceinvoke %4.<@%unk/%unk: .resolves()>(user)
      %5 = new @ts_files/194.ts: %AC$%dflt$%AM31$%AM9$%AM0$57
      instanceinvoke %5.<@ts_files/194.ts: %AC$%dflt$%AM31$%AM9$%AM0$57.constructor()>()
      %6 = <@ts_files/194.ts: %AC$%dflt$%AM31$%AM9$%AM0$57>%5
      %7 = instanceinvoke service.<@%unk/%unk: .onChangeRoomMembership()>(%6)
      %8 = await %7
      %9 = roomAdapter.<@%unk/%unk: .removeDirectMessageRoom>
      %10 = %9.<@%unk/%unk: .called>
      %11 = staticinvoke <@%unk/%unk: .expect()>(%10)
      %12 = %11.<@%unk/%unk: .to>
      %13 = %12.<@%unk/%unk: .be>
      %14 = roomAdapter.<@%unk/%unk: .createFederatedRoomForDirectMessage>
      %15 = %14.<@%unk/%unk: .called>
      %16 = staticinvoke <@%unk/%unk: .expect()>(%15)
      %17 = %16.<@%unk/%unk: .to>
      %18 = %17.<@%unk/%unk: .be>
      return"];
}
subgraph "cluster_@ts_files/194.ts: %dflt.%AM32$%AM9$%AM0()" {
  label="@ts_files/194.ts: %dflt.%AM32$%AM9$%AM0()";
  Node28980 [label="id:0
      this = this: @ts_files/194.ts: %dflt
      %0 = new @ts_files/194.ts: %AC$%dflt$%AM32$%AM9$%AM0$58
      instanceinvoke %0.<@ts_files/194.ts: %AC$%dflt$%AM32$%AM9$%AM0$58.constructor()>()
      %1 = <@ts_files/194.ts: %AC$%dflt$%AM32$%AM9$%AM0$58>%0
      %2 = newarray (unknown)[2]
      %2[0] = user
      %2[1] = user
      dmRoom = instanceinvoke DirectMessageFederatedRoom.<@%unk/%unk: .createWithInternalReference()>('externalRoomId', %1, %2)
      %3 = new @ts_files/194.ts: %AC$%dflt$%AM32$%AM9$%AM0$59
      instanceinvoke %3.<@ts_files/194.ts: %AC$%dflt$%AM32$%AM9$%AM0$59.constructor()>()
      invitee = instanceinvoke FederatedUser.<@%unk/%unk: .createInstance()>('externalInviteeId', %3)
      %4 = roomAdapter.<@%unk/%unk: .getFederatedRoomByExternalId>
      instanceinvoke %4.<@%unk/%unk: .resolves()>(dmRoom)
      %5 = userAdapter.<@%unk/%unk: .getFederatedUserByExternalId>
      instanceinvoke %5.<@%unk/%unk: .resolves()>(user)
      %6 = userAdapter.<@%unk/%unk: .getFederatedUserByExternalId>
      %7 = instanceinvoke %6.<@%unk/%unk: .onCall()>(1)
      instanceinvoke %7.<@%unk/%unk: .resolves()>(invitee)
      %8 = new @ts_files/194.ts: %AC$%dflt$%AM32$%AM9$%AM0$60
      instanceinvoke %8.<@ts_files/194.ts: %AC$%dflt$%AM32$%AM9$%AM0$60.constructor()>()
      %9 = <@ts_files/194.ts: %AC$%dflt$%AM32$%AM9$%AM0$60>%8
      %10 = instanceinvoke service.<@%unk/%unk: .onChangeRoomMembership()>(%9)
      %11 = await %10
      %12 = newarray (unknown)[3]
      %12[0] = user
      %12[1] = user
      %12[2] = invitee
      createdRoom = instanceinvoke DirectMessageFederatedRoom.<@%unk/%unk: .createInstance()>('externalRoomId', user, %12)
      %13 = roomAdapter.<@%unk/%unk: .removeDirectMessageRoom>
      %14 = instanceinvoke %13.<@%unk/%unk: .calledWith()>(dmRoom)
      %15 = staticinvoke <@%unk/%unk: .expect()>(%14)
      %16 = %15.<@%unk/%unk: .to>
      %17 = %16.<@%unk/%unk: .be>
      %18 = roomAdapter.<@%unk/%unk: .createFederatedRoomForDirectMessage>
      %19 = instanceinvoke %18.<@%unk/%unk: .calledWith()>(createdRoom)
      %20 = staticinvoke <@%unk/%unk: .expect()>(%19)
      %21 = %20.<@%unk/%unk: .to>
      %22 = %21.<@%unk/%unk: .be>
      %23 = roomAdapter.<@%unk/%unk: .addUserToRoom>
      %24 = %23.<@%unk/%unk: .called>
      %25 = staticinvoke <@%unk/%unk: .expect()>(%24)
      %26 = %25.<@%unk/%unk: .to>
      %27 = %26.<@%unk/%unk: .be>
      return"];
}
subgraph "cluster_@ts_files/194.ts: %dflt.%AM33$%AM9$%AM0()" {
  label="@ts_files/194.ts: %dflt.%AM33$%AM9$%AM0()";
  Node28990 [label="id:0
      this = this: @ts_files/194.ts: %dflt
      %0 = roomAdapter.<@%unk/%unk: .getFederatedRoomByExternalId>
      instanceinvoke %0.<@%unk/%unk: .resolves()>(room)
      %1 = roomAdapter.<@%unk/%unk: .isUserAlreadyJoined>
      instanceinvoke %1.<@%unk/%unk: .resolves()>(true)
      %2 = userAdapter.<@%unk/%unk: .getFederatedUserByExternalId>
      instanceinvoke %2.<@%unk/%unk: .resolves()>(user)
      %3 = new @ts_files/194.ts: %AC$%dflt$%AM33$%AM9$%AM0$61
      instanceinvoke %3.<@ts_files/194.ts: %AC$%dflt$%AM33$%AM9$%AM0$61.constructor()>()
      %4 = <@ts_files/194.ts: %AC$%dflt$%AM33$%AM9$%AM0$61>%3
      %5 = instanceinvoke service.<@%unk/%unk: .onChangeRoomMembership()>(%4)
      %6 = await %5
      %7 = roomAdapter.<@%unk/%unk: .removeUserFromRoom>
      %8 = %7.<@ts_files/194.ts: %AC$%dflt$%dflt$4.called>
      %9 = staticinvoke <@%unk/%unk: .expect()>(%8)
      %10 = %9.<@%unk/%unk: .to>
      %11 = %10.<@%unk/%unk: .be>
      %12 = roomAdapter.<@%unk/%unk: .removeDirectMessageRoom>
      %13 = %12.<@%unk/%unk: .called>
      %14 = staticinvoke <@%unk/%unk: .expect()>(%13)
      %15 = %14.<@%unk/%unk: .to>
      %16 = %15.<@%unk/%unk: .be>
      %17 = roomAdapter.<@%unk/%unk: .createFederatedRoomForDirectMessage>
      %18 = %17.<@%unk/%unk: .called>
      %19 = staticinvoke <@%unk/%unk: .expect()>(%18)
      %20 = %19.<@%unk/%unk: .to>
      %21 = %20.<@%unk/%unk: .be>
      %22 = bridge.<@%unk/%unk: .joinRoom>
      %23 = %22.<@%unk/%unk: .called>
      %24 = staticinvoke <@%unk/%unk: .expect()>(%23)
      %25 = %24.<@%unk/%unk: .to>
      %26 = %25.<@%unk/%unk: .be>
      %27 = roomAdapter.<@%unk/%unk: .addUserToRoom>
      %28 = %27.<@%unk/%unk: .called>
      %29 = staticinvoke <@%unk/%unk: .expect()>(%28)
      %30 = %29.<@%unk/%unk: .to>
      %31 = %30.<@%unk/%unk: .be>
      return"];
}
subgraph "cluster_@ts_files/194.ts: %dflt.%AM34$%AM9$%AM0()" {
  label="@ts_files/194.ts: %dflt.%AM34$%AM9$%AM0()";
  Node29000 [label="id:0
      this = this: @ts_files/194.ts: %dflt
      %0 = roomAdapter.<@%unk/%unk: .getFederatedRoomByExternalId>
      instanceinvoke %0.<@%unk/%unk: .resolves()>(room)
      %1 = userAdapter.<@%unk/%unk: .getFederatedUserByExternalId>
      instanceinvoke %1.<@%unk/%unk: .resolves()>(user)
      %2 = new @ts_files/194.ts: %AC$%dflt$%AM34$%AM9$%AM0$62
      instanceinvoke %2.<@ts_files/194.ts: %AC$%dflt$%AM34$%AM9$%AM0$62.constructor()>()
      %3 = <@ts_files/194.ts: %AC$%dflt$%AM34$%AM9$%AM0$62>%2
      %4 = instanceinvoke service.<@%unk/%unk: .onChangeRoomMembership()>(%3)
      %5 = await %4
      %6 = roomAdapter.<@%unk/%unk: .removeUserFromRoom>
      %7 = %6.<@%unk/%unk: .called>
      %8 = staticinvoke <@%unk/%unk: .expect()>(%7)
      %9 = %8.<@%unk/%unk: .to>
      %10 = %9.<@%unk/%unk: .be>
      %11 = roomAdapter.<@%unk/%unk: .removeDirectMessageRoom>
      %12 = %11.<@%unk/%unk: .called>
      %13 = staticinvoke <@%unk/%unk: .expect()>(%12)
      %14 = %13.<@%unk/%unk: .to>
      %15 = %14.<@%unk/%unk: .be>
      %16 = roomAdapter.<@%unk/%unk: .createFederatedRoomForDirectMessage>
      %17 = %16.<@%unk/%unk: .called>
      %18 = staticinvoke <@%unk/%unk: .expect()>(%17)
      %19 = %18.<@%unk/%unk: .to>
      %20 = %19.<@%unk/%unk: .be>
      %21 = bridge.<@%unk/%unk: .joinRoom>
      %22 = %21.<@%unk/%unk: .called>
      %23 = staticinvoke <@%unk/%unk: .expect()>(%22)
      %24 = %23.<@%unk/%unk: .to>
      %25 = %24.<@%unk/%unk: .be>
      %26 = roomAdapter.<@%unk/%unk: .addUserToRoom>
      %27 = instanceinvoke %26.<@%unk/%unk: .calledWith()>(room, user, user)
      %28 = staticinvoke <@%unk/%unk: .expect()>(%27)
      %29 = %28.<@%unk/%unk: .to>
      %30 = %29.<@%unk/%unk: .be>
      return"];
}
subgraph "cluster_@ts_files/194.ts: %dflt.%AM35$%AM9$%AM0()" {
  label="@ts_files/194.ts: %dflt.%AM35$%AM9$%AM0()";
  Node29010 [label="id:0
      this = this: @ts_files/194.ts: %dflt
      %0 = roomAdapter.<@%unk/%unk: .getFederatedRoomByExternalId>
      instanceinvoke %0.<@%unk/%unk: .resolves()>(room)
      %1 = userAdapter.<@%unk/%unk: .getFederatedUserByExternalId>
      instanceinvoke %1.<@%unk/%unk: .resolves()>(user)
      %2 = bridge.<@%unk/%unk: .extractHomeserverOrigin>
      instanceinvoke %2.<@%unk/%unk: .returns()>('localDomain')
      %3 = new @ts_files/194.ts: %AC$%dflt$%AM35$%AM9$%AM0$63
      instanceinvoke %3.<@ts_files/194.ts: %AC$%dflt$%AM35$%AM9$%AM0$63.constructor()>()
      %4 = <@ts_files/194.ts: %AC$%dflt$%AM35$%AM9$%AM0$63>%3
      %5 = instanceinvoke service.<@%unk/%unk: .onChangeRoomMembership()>(%4)
      %6 = await %5
      %7 = roomAdapter.<@%unk/%unk: .addUserToRoom>
      %8 = instanceinvoke %7.<@%unk/%unk: .calledWith()>(room, user, user)
      %9 = staticinvoke <@%unk/%unk: .expect()>(%8)
      %10 = %9.<@%unk/%unk: .to>
      %11 = %10.<@%unk/%unk: .be>
      %12 = bridge.<@%unk/%unk: .joinRoom>
      %13 = instanceinvoke %12.<@%unk/%unk: .calledWith()>('externalRoomId', 'externalInviteeId')
      %14 = staticinvoke <@%unk/%unk: .expect()>(%13)
      %15 = %14.<@%unk/%unk: .to>
      %16 = %15.<@%unk/%unk: .be>
      return"];
}
subgraph "cluster_@ts_files/194.ts: %dflt.%AM36$%AM9$%AM0()" {
  label="@ts_files/194.ts: %dflt.%AM36$%AM9$%AM0()";
  Node29020 [label="id:0
      this = this: @ts_files/194.ts: %dflt
      %0 = roomAdapter.<@%unk/%unk: .getFederatedRoomByExternalId>
      instanceinvoke %0.<@%unk/%unk: .resolves()>(room)
      %1 = userAdapter.<@%unk/%unk: .getFederatedUserByExternalId>
      instanceinvoke %1.<@%unk/%unk: .resolves()>(user)
      %2 = bridge.<@%unk/%unk: .extractHomeserverOrigin>
      instanceinvoke %2.<@%unk/%unk: .returns()>('externalDomain')
      %3 = new @ts_files/194.ts: %AC$%dflt$%AM36$%AM9$%AM0$64
      instanceinvoke %3.<@ts_files/194.ts: %AC$%dflt$%AM36$%AM9$%AM0$64.constructor()>()
      %4 = <@ts_files/194.ts: %AC$%dflt$%AM36$%AM9$%AM0$64>%3
      %5 = instanceinvoke service.<@%unk/%unk: .onChangeRoomMembership()>(%4)
      %6 = await %5
      %7 = roomAdapter.<@%unk/%unk: .addUserToRoom>
      %8 = instanceinvoke %7.<@%unk/%unk: .calledWith()>(room, user, user)
      %9 = staticinvoke <@%unk/%unk: .expect()>(%8)
      %10 = %9.<@%unk/%unk: .to>
      %11 = %10.<@%unk/%unk: .be>
      %12 = bridge.<@%unk/%unk: .joinRoom>
      %13 = %12.<@%unk/%unk: .called>
      %14 = staticinvoke <@%unk/%unk: .expect()>(%13)
      %15 = %14.<@%unk/%unk: .to>
      %16 = %15.<@%unk/%unk: .be>
      return"];
}
subgraph "cluster_@ts_files/194.ts: %dflt.%AM37$%AM9$%AM0()" {
  label="@ts_files/194.ts: %dflt.%AM37$%AM9$%AM0()";
  Node29030 [label="id:0
      this = this: @ts_files/194.ts: %dflt
      %0 = roomAdapter.<@%unk/%unk: .getFederatedRoomByExternalId>
      instanceinvoke %0.<@%unk/%unk: .resolves()>(room)
      %1 = userAdapter.<@%unk/%unk: .getFederatedUserByExternalId>
      instanceinvoke %1.<@%unk/%unk: .resolves()>(user)
      %2 = new @ts_files/194.ts: %AC$%dflt$%AM37$%AM9$%AM0$65
      instanceinvoke %2.<@ts_files/194.ts: %AC$%dflt$%AM37$%AM9$%AM0$65.constructor()>()
      %3 = <@ts_files/194.ts: %AC$%dflt$%AM37$%AM9$%AM0$65>%2
      %4 = instanceinvoke service.<@%unk/%unk: .onChangeRoomMembership()>(%3)
      %5 = await %4
      %6 = roomAdapter.<@%unk/%unk: .removeUserFromRoom>
      %7 = %6.<@%unk/%unk: .called>
      %8 = staticinvoke <@%unk/%unk: .expect()>(%7)
      %9 = %8.<@%unk/%unk: .to>
      %10 = %9.<@%unk/%unk: .be>
      %11 = roomAdapter.<@%unk/%unk: .removeDirectMessageRoom>
      %12 = %11.<@%unk/%unk: .called>
      %13 = staticinvoke <@%unk/%unk: .expect()>(%12)
      %14 = %13.<@%unk/%unk: .to>
      %15 = %14.<@%unk/%unk: .be>
      %16 = roomAdapter.<@%unk/%unk: .createFederatedRoomForDirectMessage>
      %17 = %16.<@%unk/%unk: .called>
      %18 = staticinvoke <@%unk/%unk: .expect()>(%17)
      %19 = %18.<@%unk/%unk: .to>
      %20 = %19.<@%unk/%unk: .be>
      %21 = bridge.<@%unk/%unk: .joinRoom>
      %22 = %21.<@%unk/%unk: .called>
      %23 = staticinvoke <@%unk/%unk: .expect()>(%22)
      %24 = %23.<@%unk/%unk: .to>
      %25 = %24.<@%unk/%unk: .be>
      %26 = roomAdapter.<@%unk/%unk: .addUserToRoom>
      %27 = instanceinvoke %26.<@%unk/%unk: .calledWith()>(room, user)
      %28 = staticinvoke <@%unk/%unk: .expect()>(%27)
      %29 = %28.<@%unk/%unk: .to>
      %30 = %29.<@%unk/%unk: .be>
      return"];
}
subgraph "cluster_@ts_files/194.ts: %dflt.%AM39$%AM38$%AM9$%AM0()" {
  label="@ts_files/194.ts: %dflt.%AM39$%AM38$%AM9$%AM0()";
  Node32270 [label="id:0
      this = this: @ts_files/194.ts: %dflt
      %0 = roomAdapter.<@%unk/%unk: .getFederatedRoomByExternalId>
      instanceinvoke %0.<@%unk/%unk: .resolves()>(room)
      %1 = userAdapter.<@%unk/%unk: .getFederatedUserByExternalId>
      instanceinvoke %1.<@%unk/%unk: .resolves()>(user)
      %2 = new @ts_files/194.ts: %AC$%dflt$%AM39$%AM38$%AM9$%AM0$66
      instanceinvoke %2.<@ts_files/194.ts: %AC$%dflt$%AM39$%AM38$%AM9$%AM0$66.constructor()>()
      %3 = <@ts_files/194.ts: %AC$%dflt$%AM39$%AM38$%AM9$%AM0$66>%2
      %4 = instanceinvoke service.<@%unk/%unk: .onChangeRoomMembership()>(%3)
      %5 = await %4
      %6 = notificationsAdapter.<@%unk/%unk: .subscribeToUserTypingEventsOnFederatedRoomId>
      %7 = %6.<@%unk/%unk: .called>
      %8 = staticinvoke <@%unk/%unk: .expect()>(%7)
      %9 = %8.<@%unk/%unk: .to>
      %10 = %9.<@%unk/%unk: .be>
      return"];
}
subgraph "cluster_@ts_files/194.ts: %dflt.%AM40$%AM38$%AM9$%AM0()" {
  label="@ts_files/194.ts: %dflt.%AM40$%AM38$%AM9$%AM0()";
  Node32190 [label="id:0
      this = this: @ts_files/194.ts: %dflt
      %0 = roomAdapter.<@%unk/%unk: .getFederatedRoomByExternalId>
      instanceinvoke %0.<@%unk/%unk: .resolves()>(room)
      %1 = userAdapter.<@%unk/%unk: .getFederatedUserByExternalId>
      instanceinvoke %1.<@%unk/%unk: .resolves()>(user)
      %2 = roomAdapter.<@%unk/%unk: .isUserAlreadyJoined>
      instanceinvoke %2.<@%unk/%unk: .resolves()>(true)
      %3 = new @ts_files/194.ts: %AC$%dflt$%AM40$%AM38$%AM9$%AM0$67
      instanceinvoke %3.<@ts_files/194.ts: %AC$%dflt$%AM40$%AM38$%AM9$%AM0$67.constructor()>()
      %4 = <@ts_files/194.ts: %AC$%dflt$%AM40$%AM38$%AM9$%AM0$67>%3
      %5 = instanceinvoke service.<@%unk/%unk: .onChangeRoomMembership()>(%4)
      %6 = await %5
      %7 = roomAdapter.<@%unk/%unk: .addUserToRoom>
      %8 = %7.<@ts_files/194.ts: %AC$%dflt$%dflt$4.called>
      %9 = staticinvoke <@%unk/%unk: .expect()>(%8)
      %10 = %9.<@%unk/%unk: .to>
      %11 = %10.<@%unk/%unk: .be>
      return"];
}
subgraph "cluster_@ts_files/194.ts: %dflt.%AM41$%AM38$%AM9$%AM0()" {
  label="@ts_files/194.ts: %dflt.%AM41$%AM38$%AM9$%AM0()";
  Node32200 [label="id:0
      this = this: @ts_files/194.ts: %dflt
      %0 = roomAdapter.<@%unk/%unk: .getFederatedRoomByExternalId>
      instanceinvoke %0.<@%unk/%unk: .resolves()>(room)
      %1 = userAdapter.<@%unk/%unk: .getFederatedUserByExternalId>
      instanceinvoke %1.<@%unk/%unk: .resolves()>(user)
      %2 = roomAdapter.<@%unk/%unk: .isUserAlreadyJoined>
      instanceinvoke %2.<@%unk/%unk: .resolves()>(false)
      %3 = new @ts_files/194.ts: %AC$%dflt$%AM41$%AM38$%AM9$%AM0$68
      instanceinvoke %3.<@ts_files/194.ts: %AC$%dflt$%AM41$%AM38$%AM9$%AM0$68.constructor()>()
      %4 = <@ts_files/194.ts: %AC$%dflt$%AM41$%AM38$%AM9$%AM0$68>%3
      %5 = instanceinvoke service.<@%unk/%unk: .onChangeRoomMembership()>(%4)
      %6 = await %5
      %7 = roomAdapter.<@%unk/%unk: .addUserToRoom>
      %8 = instanceinvoke %7.<@%unk/%unk: .calledWith()>(room, user)
      %9 = staticinvoke <@%unk/%unk: .expect()>(%8)
      %10 = %9.<@%unk/%unk: .to>
      %11 = %10.<@%unk/%unk: .be>
      return"];
}
subgraph "cluster_@ts_files/194.ts: %dflt.%AM42$%AM38$%AM9$%AM0()" {
  label="@ts_files/194.ts: %dflt.%AM42$%AM38$%AM9$%AM0()";
  Node32210 [label="id:0
      this = this: @ts_files/194.ts: %dflt
      %0 = roomAdapter.<@%unk/%unk: .getFederatedRoomByExternalId>
      %1 = instanceinvoke %0.<@%unk/%unk: .onCall()>(0)
      instanceinvoke %1.<@%unk/%unk: .resolves()>(room)
      %2 = roomAdapter.<@%unk/%unk: .getFederatedRoomByExternalId>
      instanceinvoke %2.<@%unk/%unk: .resolves()>(undefined)
      %3 = userAdapter.<@%unk/%unk: .getFederatedUserByExternalId>
      instanceinvoke %3.<@%unk/%unk: .resolves()>(user)
      %4 = roomAdapter.<@%unk/%unk: .isUserAlreadyJoined>
      instanceinvoke %4.<@%unk/%unk: .resolves()>(false)
      %5 = bridge.<@%unk/%unk: .getRoomData>
      instanceinvoke %5.<@%unk/%unk: .resolves()>(undefined)
      %6 = new @ts_files/194.ts: %AC$%dflt$%AM42$%AM38$%AM9$%AM0$69
      instanceinvoke %6.<@ts_files/194.ts: %AC$%dflt$%AM42$%AM38$%AM9$%AM0$69.constructor()>()
      %7 = <@ts_files/194.ts: %AC$%dflt$%AM42$%AM38$%AM9$%AM0$69>%6
      %8 = instanceinvoke service.<@%unk/%unk: .onChangeRoomMembership()>(%7)
      %9 = await %8
      %10 = roomAdapter.<@%unk/%unk: .createFederatedRoom>
      %11 = %10.<@%unk/%unk: .called>
      %12 = staticinvoke <@%unk/%unk: .expect()>(%11)
      %13 = %12.<@%unk/%unk: .to>
      %14 = %13.<@%unk/%unk: .be>
      return"];
}
subgraph "cluster_@ts_files/194.ts: %dflt.%AM43$%AM38$%AM9$%AM0()" {
  label="@ts_files/194.ts: %dflt.%AM43$%AM38$%AM9$%AM0()";
  Node32220 [label="id:0
      this = this: @ts_files/194.ts: %dflt
      %0 = roomAdapter.<@%unk/%unk: .getFederatedRoomByExternalId>
      %1 = instanceinvoke %0.<@%unk/%unk: .onCall()>(0)
      instanceinvoke %1.<@%unk/%unk: .resolves()>(room)
      %2 = roomAdapter.<@%unk/%unk: .getFederatedRoomByExternalId>
      instanceinvoke %2.<@%unk/%unk: .resolves()>(undefined)
      %3 = userAdapter.<@%unk/%unk: .getFederatedUserByExternalId>
      instanceinvoke %3.<@%unk/%unk: .resolves()>(user)
      %4 = roomAdapter.<@%unk/%unk: .isUserAlreadyJoined>
      instanceinvoke %4.<@%unk/%unk: .resolves()>(false)
      %5 = new @ts_files/194.ts: %AC$%dflt$%AM43$%AM38$%AM9$%AM0$70
      instanceinvoke %5.<@ts_files/194.ts: %AC$%dflt$%AM43$%AM38$%AM9$%AM0$70.constructor()>()
      %6 = bridge.<@%unk/%unk: .getRoomData>
      instanceinvoke %6.<@%unk/%unk: .resolves()>(%5)
      %7 = new @ts_files/194.ts: %AC$%dflt$%AM43$%AM38$%AM9$%AM0$72
      instanceinvoke %7.<@ts_files/194.ts: %AC$%dflt$%AM43$%AM38$%AM9$%AM0$72.constructor()>()
      %8 = <@ts_files/194.ts: %AC$%dflt$%AM43$%AM38$%AM9$%AM0$72>%7
      %9 = instanceinvoke service.<@%unk/%unk: .onChangeRoomMembership()>(%8)
      %10 = await %9
      %11 = roomAdapter.<@%unk/%unk: .createFederatedRoom>
      %12 = %11.<@%unk/%unk: .called>
      %13 = staticinvoke <@%unk/%unk: .expect()>(%12)
      %14 = %13.<@%unk/%unk: .to>
      %15 = %14.<@%unk/%unk: .be>
      return"];
}
subgraph "cluster_@ts_files/194.ts: %dflt.%AM44$%AM38$%AM9$%AM0()" {
  label="@ts_files/194.ts: %dflt.%AM44$%AM38$%AM9$%AM0()";
  Node32230 [label="id:0
      this = this: @ts_files/194.ts: %dflt
      spy = instanceinvoke sinon.<@%unk/%unk: .spy()>(service, 'createFederatedUserInternallyOnly')
      %0 = roomAdapter.<@%unk/%unk: .getFederatedRoomByExternalId>
      %1 = instanceinvoke %0.<@%unk/%unk: .onCall()>(0)
      instanceinvoke %1.<@%unk/%unk: .resolves()>(room)
      %2 = userAdapter.<@%unk/%unk: .getFederatedUserByExternalId>
      %3 = instanceinvoke %2.<@%unk/%unk: .onCall()>(0)
      instanceinvoke %3.<@%unk/%unk: .resolves()>(user)
      %4 = userAdapter.<@%unk/%unk: .getFederatedUserByExternalId>
      %5 = instanceinvoke %4.<@%unk/%unk: .onCall()>(1)
      instanceinvoke %5.<@%unk/%unk: .resolves()>(user)
      %6 = userAdapter.<@%unk/%unk: .getFederatedUserByExternalId>
      %7 = instanceinvoke %6.<@%unk/%unk: .onCall()>(2)
      instanceinvoke %7.<@%unk/%unk: .resolves()>(undefined)
      %8 = userAdapter.<@%unk/%unk: .getFederatedUserByExternalId>
      %9 = instanceinvoke %8.<@%unk/%unk: .onCall()>(3)
      instanceinvoke %9.<@%unk/%unk: .resolves()>(undefined)
      %10 = new @ts_files/194.ts: %AC$%dflt$%AM44$%AM38$%AM9$%AM0$73
      instanceinvoke %10.<@ts_files/194.ts: %AC$%dflt$%AM44$%AM38$%AM9$%AM0$73.constructor()>()
      %11 = bridge.<@%unk/%unk: .getRoomData>
      instanceinvoke %11.<@%unk/%unk: .resolves()>(%10)
      %12 = bridge.<@%unk/%unk: .extractHomeserverOrigin>
      instanceinvoke %12.<@%unk/%unk: .returns()>('localDomain')
      %13 = new @ts_files/194.ts: %AC$%dflt$%AM44$%AM38$%AM9$%AM0$75
      instanceinvoke %13.<@ts_files/194.ts: %AC$%dflt$%AM44$%AM38$%AM9$%AM0$75.constructor()>()
      %14 = <@ts_files/194.ts: %AC$%dflt$%AM44$%AM38$%AM9$%AM0$75>%13
      %15 = instanceinvoke service.<@%unk/%unk: .onChangeRoomMembership()>(%14)
      %16 = await %15
      existsOnlyOnProxyServer = true
      %17 = instanceinvoke spy.<@%unk/%unk: .calledWith()>('creatorId', 'creatorUsername', existsOnlyOnProxyServer)
      %18 = staticinvoke <@%unk/%unk: .expect()>(%17)
      %19 = %18.<@%unk/%unk: .to>
      %20 = %19.<@%unk/%unk: .be>
      return"];
}
subgraph "cluster_@ts_files/194.ts: %dflt.%AM45$%AM38$%AM9$%AM0()" {
  label="@ts_files/194.ts: %dflt.%AM45$%AM38$%AM9$%AM0()";
  Node32240 [label="id:0
      this = this: @ts_files/194.ts: %dflt
      spy = instanceinvoke sinon.<@%unk/%unk: .spy()>(service, 'createFederatedUserInternallyOnly')
      %0 = roomAdapter.<@%unk/%unk: .getFederatedRoomByExternalId>
      %1 = instanceinvoke %0.<@%unk/%unk: .onCall()>(0)
      instanceinvoke %1.<@%unk/%unk: .resolves()>(room)
      %2 = userAdapter.<@%unk/%unk: .getFederatedUserByExternalId>
      %3 = instanceinvoke %2.<@%unk/%unk: .onCall()>(0)
      instanceinvoke %3.<@%unk/%unk: .resolves()>(user)
      %4 = userAdapter.<@%unk/%unk: .getFederatedUserByExternalId>
      %5 = instanceinvoke %4.<@%unk/%unk: .onCall()>(1)
      instanceinvoke %5.<@%unk/%unk: .resolves()>(user)
      %6 = userAdapter.<@%unk/%unk: .getFederatedUserByExternalId>
      %7 = instanceinvoke %6.<@%unk/%unk: .onCall()>(2)
      instanceinvoke %7.<@%unk/%unk: .resolves()>(undefined)
      %8 = userAdapter.<@%unk/%unk: .getFederatedUserByExternalId>
      %9 = instanceinvoke %8.<@%unk/%unk: .onCall()>(3)
      instanceinvoke %9.<@%unk/%unk: .resolves()>(undefined)
      %10 = new @ts_files/194.ts: %AC$%dflt$%AM45$%AM38$%AM9$%AM0$76
      instanceinvoke %10.<@ts_files/194.ts: %AC$%dflt$%AM45$%AM38$%AM9$%AM0$76.constructor()>()
      %11 = bridge.<@%unk/%unk: .getRoomData>
      instanceinvoke %11.<@%unk/%unk: .resolves()>(%10)
      %12 = bridge.<@%unk/%unk: .extractHomeserverOrigin>
      instanceinvoke %12.<@%unk/%unk: .returns()>('externalDomain')
      %13 = new @ts_files/194.ts: %AC$%dflt$%AM45$%AM38$%AM9$%AM0$78
      instanceinvoke %13.<@ts_files/194.ts: %AC$%dflt$%AM45$%AM38$%AM9$%AM0$78.constructor()>()
      %14 = <@ts_files/194.ts: %AC$%dflt$%AM45$%AM38$%AM9$%AM0$78>%13
      %15 = instanceinvoke service.<@%unk/%unk: .onChangeRoomMembership()>(%14)
      %16 = await %15
      existsOnlyOnProxyServer = false
      %17 = instanceinvoke spy.<@%unk/%unk: .calledWith()>('@creatorId:externalserver.com', 'creatorId:externalserver.com', existsOnlyOnProxyServer)
      %18 = staticinvoke <@%unk/%unk: .expect()>(%17)
      %19 = %18.<@%unk/%unk: .to>
      %20 = %19.<@%unk/%unk: .be>
      return"];
}
subgraph "cluster_@ts_files/194.ts: %dflt.%AM46$%AM38$%AM9$%AM0()" {
  label="@ts_files/194.ts: %dflt.%AM46$%AM38$%AM9$%AM0()";
  Node32250 [label="id:0
      this = this: @ts_files/194.ts: %dflt
      %0 = instanceinvoke sinon.<@%unk/%unk: .stub()>(service, 'createFederatedUserAndReturnIt')
      instanceinvoke %0.<@%unk/%unk: .resolves()>()
      %1 = roomAdapter.<@%unk/%unk: .getFederatedRoomByExternalId>
      instanceinvoke %1.<@%unk/%unk: .resolves()>(undefined)
      %2 = userAdapter.<@%unk/%unk: .getFederatedUserByExternalId>
      %3 = instanceinvoke %2.<@%unk/%unk: .onCall()>(0)
      instanceinvoke %3.<@%unk/%unk: .resolves()>(user)
      %4 = userAdapter.<@%unk/%unk: .getFederatedUserByExternalId>
      %5 = instanceinvoke %4.<@%unk/%unk: .onCall()>(1)
      instanceinvoke %5.<@%unk/%unk: .resolves()>(user)
      %6 = userAdapter.<@%unk/%unk: .getFederatedUserByExternalId>
      %7 = instanceinvoke %6.<@%unk/%unk: .onCall()>(2)
      instanceinvoke %7.<@%unk/%unk: .resolves()>(undefined)
      %8 = new @ts_files/194.ts: %AC$%dflt$%AM46$%AM38$%AM9$%AM0$79
      instanceinvoke %8.<@ts_files/194.ts: %AC$%dflt$%AM46$%AM38$%AM9$%AM0$79.constructor()>()
      %9 = bridge.<@%unk/%unk: .getRoomData>
      instanceinvoke %9.<@%unk/%unk: .resolves()>(%8)
      %10 = bridge.<@%unk/%unk: .extractHomeserverOrigin>
      instanceinvoke %10.<@%unk/%unk: .returns()>('externalDomain')
      %11 = new @ts_files/194.ts: %AC$%dflt$%AM46$%AM38$%AM9$%AM0$81
      instanceinvoke %11.<@ts_files/194.ts: %AC$%dflt$%AM46$%AM38$%AM9$%AM0$81.constructor()>()
      %12 = <@ts_files/194.ts: %AC$%dflt$%AM46$%AM38$%AM9$%AM0$81>%11
      %13 = instanceinvoke service.<@%unk/%unk: .onChangeRoomMembership()>(%12)
      %14 = await %13
      %15 = roomAdapter.<@%unk/%unk: .createFederatedRoom>
      %16 = %15.<@%unk/%unk: .called>
      %17 = staticinvoke <@%unk/%unk: .expect()>(%16)
      %18 = %17.<@%unk/%unk: .to>
      %19 = %18.<@%unk/%unk: .be>
      return"];
}
subgraph "cluster_@ts_files/194.ts: %dflt.%AM47$%AM38$%AM9$%AM0()" {
  label="@ts_files/194.ts: %dflt.%AM47$%AM38$%AM9$%AM0()";
  Node32260 [label="id:0
      this = this: @ts_files/194.ts: %dflt
      %0 = instanceinvoke sinon.<@%unk/%unk: .stub()>(service, 'createFederatedUserAndReturnIt')
      instanceinvoke %0.<@%unk/%unk: .resolves()>()
      %1 = roomAdapter.<@%unk/%unk: .getFederatedRoomByExternalId>
      instanceinvoke %1.<@%unk/%unk: .resolves()>(undefined)
      %2 = userAdapter.<@%unk/%unk: .getFederatedUserByExternalId>
      %3 = instanceinvoke %2.<@%unk/%unk: .onCall()>(0)
      instanceinvoke %3.<@%unk/%unk: .resolves()>(user)
      %4 = userAdapter.<@%unk/%unk: .getFederatedUserByExternalId>
      %5 = instanceinvoke %4.<@%unk/%unk: .onCall()>(1)
      instanceinvoke %5.<@%unk/%unk: .resolves()>(user)
      %6 = userAdapter.<@%unk/%unk: .getFederatedUserByExternalId>
      %7 = instanceinvoke %6.<@%unk/%unk: .onCall()>(2)
      instanceinvoke %7.<@%unk/%unk: .resolves()>(undefined)
      %8 = userAdapter.<@%unk/%unk: .getFederatedUserByExternalId>
      %9 = instanceinvoke %8.<@%unk/%unk: .onCall()>(3)
      instanceinvoke %9.<@%unk/%unk: .resolves()>(user)
      %10 = new @ts_files/194.ts: %AC$%dflt$%AM47$%AM38$%AM9$%AM0$82
      instanceinvoke %10.<@ts_files/194.ts: %AC$%dflt$%AM47$%AM38$%AM9$%AM0$82.constructor()>()
      %11 = bridge.<@%unk/%unk: .getRoomData>
      instanceinvoke %11.<@%unk/%unk: .resolves()>(%10)
      %12 = bridge.<@%unk/%unk: .extractHomeserverOrigin>
      instanceinvoke %12.<@%unk/%unk: .returns()>('localDomain')
      %13 = new @ts_files/194.ts: %AC$%dflt$%AM47$%AM38$%AM9$%AM0$84
      instanceinvoke %13.<@ts_files/194.ts: %AC$%dflt$%AM47$%AM38$%AM9$%AM0$84.constructor()>()
      %14 = <@ts_files/194.ts: %AC$%dflt$%AM47$%AM38$%AM9$%AM0$84>%13
      %15 = instanceinvoke service.<@%unk/%unk: .onChangeRoomMembership()>(%14)
      %16 = await %15
      %17 = RoomType.<@%unk/%unk: .CHANNEL>
      %18 = instanceinvoke FederatedRoom.<@%unk/%unk: .createInstance()>('externalRoomId', 'normalizedRoomId', user, %17, 'roomName')
      %19 = roomAdapter.<@%unk/%unk: .createFederatedRoom>
      %20 = instanceinvoke %19.<@%unk/%unk: .calledWith()>(%18)
      %21 = staticinvoke <@%unk/%unk: .expect()>(%20)
      %22 = %21.<@%unk/%unk: .to>
      %23 = %22.<@%unk/%unk: .be>
      return"];
}
subgraph "cluster_@ts_files/194.ts: %dflt.%AM48$%AM38$%AM9$%AM0()" {
  label="@ts_files/194.ts: %dflt.%AM48$%AM38$%AM9$%AM0()";
  Node32270 [label="id:0
      this = this: @ts_files/194.ts: %dflt
      %0 = instanceinvoke sinon.<@%unk/%unk: .stub()>(service, 'createFederatedUserAndReturnIt')
      instanceinvoke %0.<@%unk/%unk: .resolves()>()
      %1 = roomAdapter.<@%unk/%unk: .getFederatedRoomByExternalId>
      instanceinvoke %1.<@%unk/%unk: .resolves()>(undefined)
      %2 = userAdapter.<@%unk/%unk: .getFederatedUserByExternalId>
      %3 = instanceinvoke %2.<@%unk/%unk: .onCall()>(0)
      instanceinvoke %3.<@%unk/%unk: .resolves()>(user)
      %4 = userAdapter.<@%unk/%unk: .getFederatedUserByExternalId>
      %5 = instanceinvoke %4.<@%unk/%unk: .onCall()>(1)
      instanceinvoke %5.<@%unk/%unk: .resolves()>(user)
      %6 = userAdapter.<@%unk/%unk: .getFederatedUserByExternalId>
      %7 = instanceinvoke %6.<@%unk/%unk: .onCall()>(2)
      instanceinvoke %7.<@%unk/%unk: .resolves()>(undefined)
      %8 = userAdapter.<@%unk/%unk: .getFederatedUserByExternalId>
      %9 = instanceinvoke %8.<@%unk/%unk: .onCall()>(3)
      instanceinvoke %9.<@%unk/%unk: .resolves()>(user)
      %10 = new @ts_files/194.ts: %AC$%dflt$%AM48$%AM38$%AM9$%AM0$85
      instanceinvoke %10.<@ts_files/194.ts: %AC$%dflt$%AM48$%AM38$%AM9$%AM0$85.constructor()>()
      %11 = bridge.<@%unk/%unk: .getRoomData>
      instanceinvoke %11.<@%unk/%unk: .resolves()>(%10)
      %12 = bridge.<@%unk/%unk: .extractHomeserverOrigin>
      instanceinvoke %12.<@%unk/%unk: .returns()>('externalDomain')
      %13 = new @ts_files/194.ts: %AC$%dflt$%AM48$%AM38$%AM9$%AM0$87
      instanceinvoke %13.<@ts_files/194.ts: %AC$%dflt$%AM48$%AM38$%AM9$%AM0$87.constructor()>()
      %14 = <@ts_files/194.ts: %AC$%dflt$%AM48$%AM38$%AM9$%AM0$87>%13
      %15 = instanceinvoke service.<@%unk/%unk: .onChangeRoomMembership()>(%14)
      %16 = await %15
      %17 = RoomType.<@%unk/%unk: .CHANNEL>
      %18 = instanceinvoke FederatedRoom.<@%unk/%unk: .createInstance()>('externalRoomId', 'normalizedRoomId', user, %17, undefined)
      %19 = roomAdapter.<@%unk/%unk: .createFederatedRoom>
      %20 = instanceinvoke %19.<@%unk/%unk: .calledWith()>(%18)
      %21 = staticinvoke <@%unk/%unk: .expect()>(%20)
      %22 = %21.<@%unk/%unk: .to>
      %23 = %22.<@%unk/%unk: .be>
      return"];
}
subgraph "cluster_@ts_files/194.ts: %dflt.%AM49$%AM38$%AM9$%AM0()" {
  label="@ts_files/194.ts: %dflt.%AM49$%AM38$%AM9$%AM0()";
  Node32280 [label="id:0
      this = this: @ts_files/194.ts: %dflt
      spy = instanceinvoke sinon.<@%unk/%unk: .spy()>(service, 'onChangeRoomName')
      %0 = instanceinvoke sinon.<@%unk/%unk: .stub()>(service, 'createFederatedUserAndReturnIt')
      instanceinvoke %0.<@%unk/%unk: .resolves()>()
      %1 = roomAdapter.<@%unk/%unk: .getFederatedRoomByExternalId>
      instanceinvoke %1.<@%unk/%unk: .resolves()>(undefined)
      %2 = userAdapter.<@%unk/%unk: .getFederatedUserByExternalId>
      %3 = instanceinvoke %2.<@%unk/%unk: .onCall()>(0)
      instanceinvoke %3.<@%unk/%unk: .resolves()>(user)
      %4 = userAdapter.<@%unk/%unk: .getFederatedUserByExternalId>
      %5 = instanceinvoke %4.<@%unk/%unk: .onCall()>(1)
      instanceinvoke %5.<@%unk/%unk: .resolves()>(user)
      %6 = userAdapter.<@%unk/%unk: .getFederatedUserByExternalId>
      %7 = instanceinvoke %6.<@%unk/%unk: .onCall()>(2)
      instanceinvoke %7.<@%unk/%unk: .resolves()>(undefined)
      %8 = userAdapter.<@%unk/%unk: .getFederatedUserByExternalId>
      %9 = instanceinvoke %8.<@%unk/%unk: .onCall()>(3)
      instanceinvoke %9.<@%unk/%unk: .resolves()>(user)
      %10 = roomAdapter.<@%unk/%unk: .createFederatedRoom>
      instanceinvoke %10.<@%unk/%unk: .resolves()>()
      %11 = new @ts_files/194.ts: %AC$%dflt$%AM49$%AM38$%AM9$%AM0$88
      instanceinvoke %11.<@ts_files/194.ts: %AC$%dflt$%AM49$%AM38$%AM9$%AM0$88.constructor()>()
      %12 = bridge.<@%unk/%unk: .getRoomData>
      instanceinvoke %12.<@%unk/%unk: .resolves()>(%11)
      %13 = bridge.<@%unk/%unk: .extractHomeserverOrigin>
      instanceinvoke %13.<@%unk/%unk: .returns()>('externalDomain')
      %14 = new @ts_files/194.ts: %AC$%dflt$%AM49$%AM38$%AM9$%AM0$90
      instanceinvoke %14.<@ts_files/194.ts: %AC$%dflt$%AM49$%AM38$%AM9$%AM0$90.constructor()>()
      %15 = <@ts_files/194.ts: %AC$%dflt$%AM49$%AM38$%AM9$%AM0$90>%14
      %16 = instanceinvoke service.<@%unk/%unk: .onChangeRoomMembership()>(%15)
      %17 = await %16
      %18 = new @ts_files/194.ts: %AC$%dflt$%AM49$%AM38$%AM9$%AM0$91
      instanceinvoke %18.<@ts_files/194.ts: %AC$%dflt$%AM49$%AM38$%AM9$%AM0$91.constructor()>()
      %19 = instanceinvoke spy.<@%unk/%unk: .calledWith()>(%18)
      %20 = staticinvoke <@%unk/%unk: .expect()>(%19)
      %21 = %20.<@%unk/%unk: .to>
      %22 = %21.<@%unk/%unk: .be>
      return"];
}
subgraph "cluster_@ts_files/194.ts: %dflt.%AM50$%AM38$%AM9$%AM0()" {
  label="@ts_files/194.ts: %dflt.%AM50$%AM38$%AM9$%AM0()";
  Node32200 [label="id:0
      this = this: @ts_files/194.ts: %dflt
      stub = instanceinvoke sinon.<@%unk/%unk: .stub()>(service, 'createFederatedUserAndReturnIt')
      %0 = roomAdapter.<@%unk/%unk: .getFederatedRoomByExternalId>
      %1 = instanceinvoke %0.<@%unk/%unk: .onCall()>(0)
      instanceinvoke %1.<@%unk/%unk: .resolves()>(undefined)
      %2 = roomAdapter.<@%unk/%unk: .getFederatedRoomByExternalId>
      %3 = instanceinvoke %2.<@%unk/%unk: .onCall()>(1)
      instanceinvoke %3.<@%unk/%unk: .resolves()>(undefined)
      %4 = roomAdapter.<@%unk/%unk: .getFederatedRoomByExternalId>
      %5 = instanceinvoke %4.<@%unk/%unk: .onCall()>(2)
      instanceinvoke %5.<@%unk/%unk: .resolves()>(room)
      %6 = userAdapter.<@%unk/%unk: .getFederatedUserByExternalId>
      %7 = instanceinvoke %6.<@%unk/%unk: .onCall()>(0)
      instanceinvoke %7.<@%unk/%unk: .resolves()>(user)
      %8 = userAdapter.<@%unk/%unk: .getFederatedUserByExternalId>
      %9 = instanceinvoke %8.<@%unk/%unk: .onCall()>(1)
      instanceinvoke %9.<@%unk/%unk: .resolves()>(user)
      %10 = userAdapter.<@%unk/%unk: .getFederatedUserByExternalId>
      %11 = instanceinvoke %10.<@%unk/%unk: .onCall()>(2)
      instanceinvoke %11.<@%unk/%unk: .resolves()>(undefined)
      %12 = userAdapter.<@%unk/%unk: .getFederatedUserByExternalId>
      %13 = instanceinvoke %12.<@%unk/%unk: .onCall()>(3)
      instanceinvoke %13.<@%unk/%unk: .resolves()>(user)
      instanceinvoke stub.<@%unk/%unk: .resolves()>(user)
      %14 = new @ts_files/194.ts: %AC$%dflt$%AM50$%AM38$%AM9$%AM0$92
      instanceinvoke %14.<@ts_files/194.ts: %AC$%dflt$%AM50$%AM38$%AM9$%AM0$92.constructor()>()
      %15 = roomAdapter.<@%unk/%unk: .createFederatedRoom>
      instanceinvoke %15.<@%unk/%unk: .resolves()>(%14)
      %16 = new @ts_files/194.ts: %AC$%dflt$%AM50$%AM38$%AM9$%AM0$93
      instanceinvoke %16.<@ts_files/194.ts: %AC$%dflt$%AM50$%AM38$%AM9$%AM0$93.constructor()>()
      %17 = bridge.<@%unk/%unk: .getRoomData>
      instanceinvoke %17.<@%unk/%unk: .resolves()>(%16)
      %18 = bridge.<@%unk/%unk: .extractHomeserverOrigin>
      instanceinvoke %18.<@%unk/%unk: .returns()>('localDomain')
      %19 = new @ts_files/194.ts: %AC$%dflt$%AM50$%AM38$%AM9$%AM0$95
      instanceinvoke %19.<@ts_files/194.ts: %AC$%dflt$%AM50$%AM38$%AM9$%AM0$95.constructor()>()
      %20 = <@ts_files/194.ts: %AC$%dflt$%AM50$%AM38$%AM9$%AM0$95>%19
      %21 = instanceinvoke service.<@%unk/%unk: .onChangeRoomMembership()>(%20)
      %22 = await %21
      %23 = stub.<@%unk/%unk: .callCount>
      %24 = staticinvoke <@%unk/%unk: .expect()>(%23)
      %25 = %24.<@%unk/%unk: .to>
      %26 = %25.<@%unk/%unk: .be>
      instanceinvoke %26.<@%unk/%unk: .equal()>(3)
      %27 = instanceinvoke stub.<@%unk/%unk: .getCall()>(1)
      %28 = instanceinvoke %27.<@%unk/%unk: .calledWith()>('user1')
      %29 = staticinvoke <@%unk/%unk: .expect()>(%28)
      %30 = %29.<@%unk/%unk: .to>
      %31 = %30.<@%unk/%unk: .be>
      %32 = instanceinvoke stub.<@%unk/%unk: .getCall()>(2)
      %33 = instanceinvoke %32.<@%unk/%unk: .calledWith()>('user2')
      %34 = staticinvoke <@%unk/%unk: .expect()>(%33)
      %35 = %34.<@%unk/%unk: .to>
      %36 = %35.<@%unk/%unk: .be>
      %37 = newarray (unknown)[2]
      %37[0] = user
      %37[1] = user
      %38 = roomAdapter.<@%unk/%unk: .addUsersToRoomWhenJoinExternalPublicRoom>
      %39 = instanceinvoke %38.<@%unk/%unk: .calledWith()>(%37)
      %40 = staticinvoke <@%unk/%unk: .expect()>(%39)
      %41 = %40.<@%unk/%unk: .to>
      %42 = %41.<@%unk/%unk: .be>
      return"];
}
subgraph "cluster_@ts_files/194.ts: %dflt.%AM51$%AM38$%AM9$%AM0()" {
  label="@ts_files/194.ts: %dflt.%AM51$%AM38$%AM9$%AM0()";
  Node32210 [label="id:0
      this = this: @ts_files/194.ts: %dflt
      %0 = instanceinvoke sinon.<@%unk/%unk: .stub()>(service, 'createFederatedUserAndReturnIt')
      instanceinvoke %0.<@%unk/%unk: .resolves()>(user)
      %1 = roomAdapter.<@%unk/%unk: .getFederatedRoomByExternalId>
      %2 = instanceinvoke %1.<@%unk/%unk: .onCall()>(0)
      instanceinvoke %2.<@%unk/%unk: .resolves()>(undefined)
      %3 = roomAdapter.<@%unk/%unk: .getFederatedRoomByExternalId>
      %4 = instanceinvoke %3.<@%unk/%unk: .onCall()>(1)
      instanceinvoke %4.<@%unk/%unk: .resolves()>(undefined)
      %5 = roomAdapter.<@%unk/%unk: .getFederatedRoomByExternalId>
      %6 = instanceinvoke %5.<@%unk/%unk: .onCall()>(2)
      instanceinvoke %6.<@%unk/%unk: .resolves()>(room)
      %7 = userAdapter.<@%unk/%unk: .getFederatedUserByExternalId>
      %8 = instanceinvoke %7.<@%unk/%unk: .onCall()>(0)
      instanceinvoke %8.<@%unk/%unk: .resolves()>(user)
      %9 = userAdapter.<@%unk/%unk: .getFederatedUserByExternalId>
      %10 = instanceinvoke %9.<@%unk/%unk: .onCall()>(1)
      instanceinvoke %10.<@%unk/%unk: .resolves()>(user)
      %11 = userAdapter.<@%unk/%unk: .getFederatedUserByExternalId>
      %12 = instanceinvoke %11.<@%unk/%unk: .onCall()>(2)
      instanceinvoke %12.<@%unk/%unk: .resolves()>(undefined)
      %13 = userAdapter.<@%unk/%unk: .getFederatedUserByExternalId>
      %14 = instanceinvoke %13.<@%unk/%unk: .onCall()>(3)
      instanceinvoke %14.<@%unk/%unk: .resolves()>(user)
      %15 = new @ts_files/194.ts: %AC$%dflt$%AM51$%AM38$%AM9$%AM0$96
      instanceinvoke %15.<@ts_files/194.ts: %AC$%dflt$%AM51$%AM38$%AM9$%AM0$96.constructor()>()
      %16 = roomAdapter.<@%unk/%unk: .createFederatedRoom>
      instanceinvoke %16.<@%unk/%unk: .resolves()>(%15)
      %17 = new @ts_files/194.ts: %AC$%dflt$%AM51$%AM38$%AM9$%AM0$97
      instanceinvoke %17.<@ts_files/194.ts: %AC$%dflt$%AM51$%AM38$%AM9$%AM0$97.constructor()>()
      %18 = bridge.<@%unk/%unk: .getRoomData>
      instanceinvoke %18.<@%unk/%unk: .resolves()>(%17)
      %19 = bridge.<@%unk/%unk: .extractHomeserverOrigin>
      instanceinvoke %19.<@%unk/%unk: .returns()>('localDomain')
      %20 = new @ts_files/194.ts: %AC$%dflt$%AM51$%AM38$%AM9$%AM0$99
      instanceinvoke %20.<@ts_files/194.ts: %AC$%dflt$%AM51$%AM38$%AM9$%AM0$99.constructor()>()
      %21 = <@ts_files/194.ts: %AC$%dflt$%AM51$%AM38$%AM9$%AM0$99>%20
      %22 = instanceinvoke service.<@%unk/%unk: .onChangeRoomMembership()>(%21)
      %23 = await %22
      %24 = notificationsAdapter.<@%unk/%unk: .subscribeToUserTypingEventsOnFederatedRoomId>
      %25 = %24.<@%unk/%unk: .called>
      %26 = staticinvoke <@%unk/%unk: .expect()>(%25)
      %27 = %26.<@%unk/%unk: .to>
      %28 = %27.<@%unk/%unk: .be>
      %29 = roomAdapter.<@%unk/%unk: .addUserToRoom>
      %30 = instanceinvoke %29.<@%unk/%unk: .calledWith()>(room, user)
      %31 = staticinvoke <@%unk/%unk: .expect()>(%30)
      %32 = %31.<@%unk/%unk: .to>
      %33 = %32.<@%unk/%unk: .be>
      return"];
}
subgraph "cluster_@ts_files/194.ts: %dflt.%AM38$%AM9$%AM0()" {
  label="@ts_files/194.ts: %dflt.%AM38$%AM9$%AM0()";
  Node29040 [label="id:0
      this = this: @ts_files/194.ts: %dflt
      staticinvoke <@%unk/%unk: .it()>('should subscribe to the typings events if the room already exists', %AM39$%AM38$%AM9$%AM0)
      staticinvoke <@%unk/%unk: .it()>('should NOT add the user to the room if the user is already a room member', %AM40$%AM38$%AM9$%AM0)
      staticinvoke <@%unk/%unk: .it()>('should add the user to the room if the user is NOT a room member yet', %AM41$%AM38$%AM9$%AM0)
      staticinvoke <@%unk/%unk: .it()>('should NOT create the room if it was not possible to retrieve the information from the room from the bridge', %AM42$%AM38$%AM9$%AM0)
      staticinvoke <@%unk/%unk: .it()>('should NOT create the room if it there is already a room creation process already running', %AM43$%AM38$%AM9$%AM0)
      staticinvoke <@%unk/%unk: .it()>('should create the creator user only if it does not exists yet and use the provided username if its from the same homeserver', %AM44$%AM38$%AM9$%AM0)
      staticinvoke <@%unk/%unk: .it()>('should create the creator user if it does not exists yet and use the external id as username if its not from the same homeserver', %AM45$%AM38$%AM9$%AM0)
      staticinvoke <@%unk/%unk: .it()>('should NOT create the room if the creator does not exists nor was created successfully previously', %AM46$%AM38$%AM9$%AM0)
      staticinvoke <@%unk/%unk: .it()>('should create the room using the external room name if its original from the same homeserver', %AM47$%AM38$%AM9$%AM0)
      staticinvoke <@%unk/%unk: .it()>('should create the room using nothing if its not original from the same homeserver', %AM48$%AM38$%AM9$%AM0)
      staticinvoke <@%unk/%unk: .it()>('should dispatch a room name event if its not from the same homeserver and it was possible to retrieve the name from the bridge query', %AM49$%AM38$%AM9$%AM0)
      staticinvoke <@%unk/%unk: .it()>('should create federated users for each member of the room excluding the one joining and the creator, and add them to the room ', %AM50$%AM38$%AM9$%AM0)
      staticinvoke <@%unk/%unk: .it()>('should add the user to the room and subscribe to typings events if everything was done correctly', %AM51$%AM38$%AM9$%AM0)
      return"];
}
subgraph "cluster_@ts_files/194.ts: %dflt.%AM53$%AM52$%AM9$%AM0()" {
  label="@ts_files/194.ts: %dflt.%AM53$%AM52$%AM9$%AM0()";
  Node32190 [label="id:0
      this = this: @ts_files/194.ts: %dflt
      spy = instanceinvoke sinon.<@%unk/%unk: .spy()>(service, 'updateUserAvatarInternally')
      %0 = new @ts_files/194.ts: %AC$%dflt$%AM53$%AM52$%AM9$%AM0$100
      instanceinvoke %0.<@ts_files/194.ts: %AC$%dflt$%AM53$%AM52$%AM9$%AM0$100.constructor()>()
      %1 = <@ts_files/194.ts: %AC$%dflt$%AM53$%AM52$%AM9$%AM0$100>%0
      %2 = instanceinvoke service.<@%unk/%unk: .onChangeRoomMembership()>(%1)
      %3 = await %2
      %4 = spy.<@%unk/%unk: .called>
      %5 = staticinvoke <@%unk/%unk: .expect()>(%4)
      %6 = %5.<@%unk/%unk: .to>
      %7 = %6.<@%unk/%unk: .be>
      return"];
}
subgraph "cluster_@ts_files/194.ts: %dflt.%AM54$%AM52$%AM9$%AM0()" {
  label="@ts_files/194.ts: %dflt.%AM54$%AM52$%AM9$%AM0()";
  Node32200 [label="id:0
      this = this: @ts_files/194.ts: %dflt
      spy = instanceinvoke sinon.<@%unk/%unk: .spy()>(service, 'updateUserAvatarInternally')
      %0 = userAdapter.<@%unk/%unk: .getFederatedUserByExternalId>
      instanceinvoke %0.<@%unk/%unk: .resolves()>(undefined)
      %1 = instanceinvoke service.<@%unk/%unk: .onChangeRoomMembership()>(eventForUserProfileChanges)
      %2 = await %1
      %3 = spy.<@%unk/%unk: .called>
      %4 = staticinvoke <@%unk/%unk: .expect()>(%3)
      %5 = %4.<@ts_files/194.ts: %AC$%dflt$%dflt$2.to>
      %6 = %5.<@%unk/%unk: .be>
      return"];
}
subgraph "cluster_@ts_files/194.ts: %dflt.%AM55$%AM52$%AM9$%AM0()" {
  label="@ts_files/194.ts: %dflt.%AM55$%AM52$%AM9$%AM0()";
  Node32210 [label="id:0
      this = this: @ts_files/194.ts: %dflt
      %0 = userAdapter.<@%unk/%unk: .getFederatedUserByExternalId>
      instanceinvoke %0.<@%unk/%unk: .resolves()>(user)
      %1 = new @ts_files/194.ts: %AC$%dflt$%AM55$%AM52$%AM9$%AM0$103
      instanceinvoke %1.<@ts_files/194.ts: %AC$%dflt$%AM55$%AM52$%AM9$%AM0$103.constructor()>()
      %2 = instanceinvoke service.<@%unk/%unk: .onChangeRoomMembership()>(%1)
      %3 = await %2
      %4 = userAdapter.<@%unk/%unk: .setAvatar>
      %5 = %4.<@ts_files/194.ts: %AC$%dflt$%dflt$2.called>
      %6 = staticinvoke <@%unk/%unk: .expect()>(%5)
      %7 = %6.<@%unk/%unk: .to>
      %8 = %7.<@ts_files/194.ts: %AC$%dflt$%dflt$4.be>
      %9 = userAdapter.<@%unk/%unk: .updateFederationAvatar>
      %10 = %9.<@%unk/%unk: .called>
      %11 = staticinvoke <@%unk/%unk: .expect()>(%10)
      %12 = %11.<@%unk/%unk: .to>
      %13 = %12.<@%unk/%unk: .be>
      %14 = userAdapter.<@%unk/%unk: .updateRealName>
      %15 = %14.<@%unk/%unk: .called>
      %16 = staticinvoke <@%unk/%unk: .expect()>(%15)
      %17 = %16.<@%unk/%unk: .to>
      %18 = %17.<@%unk/%unk: .be>
      return"];
}
subgraph "cluster_@ts_files/194.ts: %dflt.%AM56$%AM52$%AM9$%AM0()" {
  label="@ts_files/194.ts: %dflt.%AM56$%AM52$%AM9$%AM0()";
  Node32220 [label="id:0
      this = this: @ts_files/194.ts: %dflt
      %0 = new @ts_files/194.ts: %AC$%dflt$%AM56$%AM52$%AM9$%AM0$105
      instanceinvoke %0.<@ts_files/194.ts: %AC$%dflt$%AM56$%AM52$%AM9$%AM0$105.constructor()>()
      %1 = instanceinvoke FederatedUser.<@%unk/%unk: .createInstance()>('externalInviterId', %0)
      %2 = userAdapter.<@%unk/%unk: .getFederatedUserByExternalId>
      instanceinvoke %2.<@%unk/%unk: .resolves()>(%1)
      %3 = instanceinvoke service.<@%unk/%unk: .onChangeRoomMembership()>(eventForUserProfileChanges)
      %4 = await %3
      %5 = userAdapter.<@%unk/%unk: .setAvatar>
      %6 = %5.<@%unk/%unk: .called>
      %7 = staticinvoke <@%unk/%unk: .expect()>(%6)
      %8 = %7.<@ts_files/194.ts: %AC$%dflt$%dflt$4.to>
      %9 = %8.<@%unk/%unk: .be>
      %10 = userAdapter.<@%unk/%unk: .updateFederationAvatar>
      %11 = %10.<@%unk/%unk: .called>
      %12 = staticinvoke <@%unk/%unk: .expect()>(%11)
      %13 = %12.<@%unk/%unk: .to>
      %14 = %13.<@%unk/%unk: .be>
      %15 = userAdapter.<@%unk/%unk: .updateRealName>
      %16 = %15.<@%unk/%unk: .called>
      %17 = staticinvoke <@%unk/%unk: .expect()>(%16)
      %18 = %17.<@%unk/%unk: .to>
      %19 = %18.<@%unk/%unk: .be>
      return"];
}
subgraph "cluster_@ts_files/194.ts: %dflt.%AM57$%AM52$%AM9$%AM0()" {
  label="@ts_files/194.ts: %dflt.%AM57$%AM52$%AM9$%AM0()";
  Node32230 [label="id:0
      this = this: @ts_files/194.ts: %dflt
      existsOnlyOnProxyServer = false
      %0 = new @ts_files/194.ts: %AC$%dflt$%AM57$%AM52$%AM9$%AM0$106
      instanceinvoke %0.<@ts_files/194.ts: %AC$%dflt$%AM57$%AM52$%AM9$%AM0$106.constructor()>()
      %1 = instanceinvoke FederatedUser.<@%unk/%unk: .createWithInternalReference()>('externalInviterId', existsOnlyOnProxyServer, %0)
      %2 = userAdapter.<@%unk/%unk: .getFederatedUserByExternalId>
      instanceinvoke %2.<@%unk/%unk: .resolves()>(%1)
      %3 = new @ts_files/194.ts: %AC$%dflt$%AM57$%AM52$%AM9$%AM0$108
      instanceinvoke %3.<@ts_files/194.ts: %AC$%dflt$%AM57$%AM52$%AM9$%AM0$108.constructor()>()
      %4 = instanceinvoke service.<@%unk/%unk: .onChangeRoomMembership()>(%3)
      %5 = await %4
      %6 = userAdapter.<@%unk/%unk: .setAvatar>
      %7 = %6.<@%unk/%unk: .called>
      %8 = staticinvoke <@%unk/%unk: .expect()>(%7)
      %9 = %8.<@%unk/%unk: .to>
      %10 = %9.<@%unk/%unk: .be>
      %11 = userAdapter.<@%unk/%unk: .updateFederationAvatar>
      %12 = %11.<@%unk/%unk: .called>
      %13 = staticinvoke <@%unk/%unk: .expect()>(%12)
      %14 = %13.<@%unk/%unk: .to>
      %15 = %14.<@%unk/%unk: .be>
      return"];
}
subgraph "cluster_@ts_files/194.ts: %dflt.%AM58$%AM52$%AM9$%AM0()" {
  label="@ts_files/194.ts: %dflt.%AM58$%AM52$%AM9$%AM0()";
  Node32240 [label="id:0
      this = this: @ts_files/194.ts: %dflt
      existsOnlyOnProxyServer = false
      %0 = new @ts_files/194.ts: %AC$%dflt$%AM58$%AM52$%AM9$%AM0$110
      instanceinvoke %0.<@ts_files/194.ts: %AC$%dflt$%AM58$%AM52$%AM9$%AM0$110.constructor()>()
      userAvatar = instanceinvoke FederatedUser.<@%unk/%unk: .createWithInternalReference()>('externalInviterId', existsOnlyOnProxyServer, %0)
      %1 = userAdapter.<@%unk/%unk: .getFederatedUserByExternalId>
      instanceinvoke %1.<@%unk/%unk: .resolves()>(userAvatar)
      %2 = instanceinvoke service.<@%unk/%unk: .onChangeRoomMembership()>(eventForUserProfileChanges)
      %3 = await %2
      %4 = userAdapter.<@%unk/%unk: .setAvatar>
      %5 = instanceinvoke %4.<@%unk/%unk: .calledWith()>(userAvatar, 'toHttpUrl')
      %6 = staticinvoke <@%unk/%unk: .expect()>(%5)
      %7 = %6.<@%unk/%unk: .to>
      %8 = %7.<@ts_files/194.ts: %AC$%dflt$%dflt$4.be>
      %9 = instanceinvoke userAvatar.<@%unk/%unk: .getInternalId()>()
      %10 = userAdapter.<@%unk/%unk: .updateFederationAvatar>
      %11 = instanceinvoke %10.<@%unk/%unk: .calledWith()>(%9, 'avatarUrl')
      %12 = staticinvoke <@%unk/%unk: .expect()>(%11)
      %13 = %12.<@%unk/%unk: .to>
      %14 = %13.<@%unk/%unk: .be>
      return"];
}
subgraph "cluster_@ts_files/194.ts: %dflt.%AM59$%AM52$%AM9$%AM0()" {
  label="@ts_files/194.ts: %dflt.%AM59$%AM52$%AM9$%AM0()";
  Node32250 [label="id:0
      this = this: @ts_files/194.ts: %dflt
      existsOnlyOnProxyServer = false
      %0 = new @ts_files/194.ts: %AC$%dflt$%AM59$%AM52$%AM9$%AM0$112
      instanceinvoke %0.<@ts_files/194.ts: %AC$%dflt$%AM59$%AM52$%AM9$%AM0$112.constructor()>()
      %1 = instanceinvoke FederatedUser.<@%unk/%unk: .createWithInternalReference()>('externalInviterId', existsOnlyOnProxyServer, %0)
      %2 = userAdapter.<@%unk/%unk: .getFederatedUserByExternalId>
      instanceinvoke %2.<@%unk/%unk: .resolves()>(%1)
      %3 = new @ts_files/194.ts: %AC$%dflt$%AM59$%AM52$%AM9$%AM0$113
      instanceinvoke %3.<@ts_files/194.ts: %AC$%dflt$%AM59$%AM52$%AM9$%AM0$113.constructor()>()
      %4 = instanceinvoke service.<@%unk/%unk: .onChangeRoomMembership()>(%3)
      %5 = await %4
      %6 = userAdapter.<@%unk/%unk: .setAvatar>
      %7 = %6.<@%unk/%unk: .called>
      %8 = staticinvoke <@%unk/%unk: .expect()>(%7)
      %9 = %8.<@%unk/%unk: .to>
      %10 = %9.<@%unk/%unk: .be>
      %11 = userAdapter.<@%unk/%unk: .updateFederationAvatar>
      %12 = %11.<@%unk/%unk: .called>
      %13 = staticinvoke <@%unk/%unk: .expect()>(%12)
      %14 = %13.<@%unk/%unk: .to>
      %15 = %14.<@%unk/%unk: .be>
      %16 = userAdapter.<@%unk/%unk: .updateRealName>
      %17 = %16.<@%unk/%unk: .called>
      %18 = staticinvoke <@%unk/%unk: .expect()>(%17)
      %19 = %18.<@%unk/%unk: .to>
      %20 = %19.<@%unk/%unk: .be>
      return"];
}
subgraph "cluster_@ts_files/194.ts: %dflt.%AM60$%AM52$%AM9$%AM0()" {
  label="@ts_files/194.ts: %dflt.%AM60$%AM52$%AM9$%AM0()";
  Node32170 [label="id:0
      this = this: @ts_files/194.ts: %dflt
      existsOnlyOnProxyServer = false
      %0 = new @ts_files/194.ts: %AC$%dflt$%AM60$%AM52$%AM9$%AM0$115
      instanceinvoke %0.<@ts_files/194.ts: %AC$%dflt$%AM60$%AM52$%AM9$%AM0$115.constructor()>()
      user = instanceinvoke FederatedUser.<@%unk/%unk: .createWithInternalReference()>('externalInviterId', existsOnlyOnProxyServer, %0)
      %1 = userAdapter.<@%unk/%unk: .getFederatedUserByExternalId>
      instanceinvoke %1.<@%unk/%unk: .resolves()>(user)
      %2 = new @ts_files/194.ts: %AC$%dflt$%AM60$%AM52$%AM9$%AM0$116
      instanceinvoke %2.<@ts_files/194.ts: %AC$%dflt$%AM60$%AM52$%AM9$%AM0$116.constructor()>()
      %3 = instanceinvoke service.<@%unk/%unk: .onChangeRoomMembership()>(%2)
      %4 = await %3
      %5 = userAdapter.<@%unk/%unk: .setAvatar>
      %6 = %5.<@%unk/%unk: .called>
      %7 = staticinvoke <@%unk/%unk: .expect()>(%6)
      %8 = %7.<@ts_files/194.ts: %AC$%dflt$%dflt$4.to>
      %9 = %8.<@%unk/%unk: .be>
      %10 = userAdapter.<@%unk/%unk: .updateFederationAvatar>
      %11 = %10.<@%unk/%unk: .called>
      %12 = staticinvoke <@%unk/%unk: .expect()>(%11)
      %13 = %12.<@%unk/%unk: .to>
      %14 = %13.<@%unk/%unk: .be>
      %15 = instanceinvoke user.<@%unk/%unk: .getInternalReference()>()
      %16 = userAdapter.<@%unk/%unk: .updateRealName>
      %17 = instanceinvoke %16.<@%unk/%unk: .calledWith()>(%15, 'displayName')
      %18 = staticinvoke <@%unk/%unk: .expect()>(%17)
      %19 = %18.<@%unk/%unk: .to>
      %20 = %19.<@%unk/%unk: .be>
      return"];
}
subgraph "cluster_@ts_files/194.ts: %dflt.%AM52$%AM9$%AM0()" {
  label="@ts_files/194.ts: %dflt.%AM52$%AM9$%AM0()";
  Node29000 [label="id:0
      this = this: @ts_files/194.ts: %dflt
      staticinvoke <@%unk/%unk: .it()>('should NOT call the function to update the user avatar if the event does not include an avatarUrl property', %AM53$%AM52$%AM9$%AM0)
      %0 = new @ts_files/194.ts: %AC$%dflt$%AM52$%AM9$%AM0$101
      instanceinvoke %0.<@ts_files/194.ts: %AC$%dflt$%AM52$%AM9$%AM0$101.constructor()>()
      eventForUserProfileChanges = <@ts_files/194.ts: %AC$%dflt$%AM52$%AM9$%AM0$101>%0
      staticinvoke <@%unk/%unk: .it()>('should NOT call the function to update the avatar internally if the user does not exists', %AM54$%AM52$%AM9$%AM0)
      staticinvoke <@%unk/%unk: .it()>('should NOT update the avatar nor the display name if both does not exists', %AM55$%AM52$%AM9$%AM0)
      staticinvoke <@%unk/%unk: .it()>('should NOT update the avatar url nor the display name if the user is from the local home server', %AM56$%AM52$%AM9$%AM0)
      staticinvoke <@%unk/%unk: .it()>('should NOT update the avatar url if the url received in the event is equal to the one already used', %AM57$%AM52$%AM9$%AM0)
      staticinvoke <@%unk/%unk: .it()>('should call the functions to update the avatar internally correctly', %AM58$%AM52$%AM9$%AM0)
      staticinvoke <@%unk/%unk: .it()>('should NOT update the display name if the name received in the event is equal to the one already used', %AM59$%AM52$%AM9$%AM0)
      staticinvoke <@%unk/%unk: .it()>('should call the functions to update the display name internally correctly', %AM60$%AM52$%AM9$%AM0)
      return"];
}
subgraph "cluster_@ts_files/194.ts: %dflt.%AM9$%AM0()" {
  label="@ts_files/194.ts: %dflt.%AM9$%AM0()";
  Node25820 [label="id:0
      this = this: @ts_files/194.ts: %dflt
      %0 = new @ts_files/194.ts: %AC$%dflt$%AM9$%AM0$23
      instanceinvoke %0.<@ts_files/194.ts: %AC$%dflt$%AM9$%AM0$23.constructor()>()
      user = instanceinvoke FederatedUser.<@%unk/%unk: .createInstance()>('externalInviterId', %0)
      %1 = RoomType.<@%unk/%unk: .CHANNEL>
      room = instanceinvoke FederatedRoom.<@%unk/%unk: .createInstance()>('externalRoomId', 'normalizedRoomId', user, %1, 'externalRoomName')
      staticinvoke <@%unk/%unk: .it()>('should NOT process the method if the room already exists AND event origin is equal to LOCAL', %AM10$%AM9$%AM0)
      staticinvoke <@%unk/%unk: .it()>('should NOT process the method if the room already exists AND event origin is equal to REMOTE', %AM11$%AM9$%AM0)
      staticinvoke <@%unk/%unk: .it()>('should NOT process the method logic if the event was generated on the proxy home server, it is NOT a join event (user joining himself), but the room does not exists yet', %AM12$%AM9$%AM0)
      staticinvoke <@%unk/%unk: .it()>('should NOT create the inviter if it already exists', %AM13$%AM9$%AM0)
      staticinvoke <@%unk/%unk: .it()>('should create the inviter if it does not exists', %AM14$%AM9$%AM0)
      staticinvoke <@%unk/%unk: .it()>('should NOT create the invitee if it already exists', %AM15$%AM9$%AM0)
      staticinvoke <@%unk/%unk: .it()>('should create the invitee if it does not exists', %AM16$%AM9$%AM0)
      staticinvoke <@%unk/%unk: .it()>('should throw an error if the invitee user does not exists at all', %AM17$%AM9$%AM0)
      staticinvoke <@%unk/%unk: .it()>('should throw an error if the inviter user does not exists at all', %AM18$%AM9$%AM0)
      staticinvoke <@%unk/%unk: .it()>('should NOT create the room if it does not exists yet AND the event origin is REMOTE but there is no room type on the event', %AM19$%AM9$%AM0)
      staticinvoke <@%unk/%unk: .it()>('should create a room for DM if the room type is equal a direct message and it is handling regular events (m.room.member)(not using the property extracted from the invite_room_state)', %AM20$%AM9$%AM0)
      staticinvoke <@%unk/%unk: .it()>('should create a room for DM if the room type is equal a direct message and it is handling regular events (m.room.member)(not using the property extracted from the invite_room_state), but not automatically join the invitee if he/she is not from the proxy homeserver', %AM21$%AM9$%AM0)
      staticinvoke <@%unk/%unk: .it()>('should create a room for DM if the room type is equal a direct message handling the property extracted from the invite_room_state', %AM22$%AM9$%AM0)
      staticinvoke <@%unk/%unk: .it()>('should create a room for DM if the room type is equal a direct message handling the property extracted from the invite_room_state, but not automatically join the user if he/she is not from the proxy homeserver', %AM23$%AM9$%AM0)
      staticinvoke <@%unk/%unk: .it()>('should create a room (not DM) if the room type is NOT equal a direct message AND to add the historical room events to the processing queue when they exists', %AM24$%AM9$%AM0)
      staticinvoke <@%unk/%unk: .it()>('should create a room (not DM) if the room type is NOT equal a direct message AND NOT to add the historical room events to the processing queue when they exists', %AM26$%AM9$%AM0)
      staticinvoke <@%unk/%unk: .it()>('should call the update name function if the name is inside the received input', %AM27$%AM9$%AM0)
      staticinvoke <@%unk/%unk: .it()>('should NOT create the room if it already exists yet AND the event origin is REMOTE', %AM28$%AM9$%AM0)
      staticinvoke <@%unk/%unk: .it()>('should remove the user from room if its a LEAVE event and the user is in the room already', %AM29$%AM9$%AM0)
      staticinvoke <@%unk/%unk: .it()>('should NOT remove the user from room if its a LEAVE event and the user is NOT in the room anymore', %AM30$%AM9$%AM0)
      staticinvoke <@%unk/%unk: .it()>('should NOT remove and recreate the DM room if the user is already part of the room (in case of being a multiple DM, Matrix send events for each user at a time, which requires us to remove and recreate the DM room)', %AM31$%AM9$%AM0)
      staticinvoke <@%unk/%unk: .it()>('should remove and recreate the DM room if the user is part of the room yet (in case of being a multiple DM, Matrix send events for each user at a time, which requires us to remove and recreate the DM room)', %AM32$%AM9$%AM0)
      staticinvoke <@%unk/%unk: .it()>('should NOT add the user to the room if its NOT a LEAVE event but the user is already in the room', %AM33$%AM9$%AM0)
      staticinvoke <@%unk/%unk: .it()>('should add the user into the room if its NOT a LEAVE event providing the inviter when the user is NOT joining by himself', %AM34$%AM9$%AM0)
      staticinvoke <@%unk/%unk: .it()>('should join the room using the bridge if its NOT a leave event AND the invitee is from the proxy home server', %AM35$%AM9$%AM0)
      staticinvoke <@%unk/%unk: .it()>('should NOT join the room using the bridge if its NOT a leave event AND the invitee is NOT from the proxy home server', %AM36$%AM9$%AM0)
      staticinvoke <@%unk/%unk: .it()>('should add the user into the room if its NOT a LEAVE event NOT providing the inviter when the user is joining by himself', %AM37$%AM9$%AM0)
      staticinvoke <@%unk/%unk: .describe()>('Handling users auto-joining', %AM38$%AM9$%AM0)
      staticinvoke <@%unk/%unk: .describe()>('User profile changed event', %AM52$%AM9$%AM0)
      return"];
}
subgraph "cluster_@ts_files/194.ts: %dflt.%AM62$%AM61$%AM0()" {
  label="@ts_files/194.ts: %dflt.%AM62$%AM61$%AM0()";
  Node29470 [label="id:0
      this = this: @ts_files/194.ts: %dflt
      %0 = roomAdapter.<@%unk/%unk: .getFederatedRoomByExternalId>
      instanceinvoke %0.<@%unk/%unk: .resolves()>(undefined)
      %1 = new @ts_files/194.ts: %AC$%dflt$%AM62$%AM61$%AM0$119
      instanceinvoke %1.<@ts_files/194.ts: %AC$%dflt$%AM62$%AM61$%AM0$119.constructor()>()
      %2 = <@ts_files/194.ts: %AC$%dflt$%AM62$%AM61$%AM0$119>%1
      %3 = instanceinvoke service.<@%unk/%unk: .onExternalFileMessageReceived()>(%2)
      %4 = await %3
      %5 = messageAdapter.<@%unk/%unk: .sendFileMessage>
      %6 = %5.<@%unk/%unk: .called>
      %7 = staticinvoke <@%unk/%unk: .expect()>(%6)
      %8 = %7.<@ts_files/194.ts: %AC$%dflt$%dflt$4.to>
      %9 = %8.<@%unk/%unk: .be>
      return"];
}
subgraph "cluster_@ts_files/194.ts: %dflt.%AM63$%AM61$%AM0()" {
  label="@ts_files/194.ts: %dflt.%AM63$%AM61$%AM0()";
  Node29480 [label="id:0
      this = this: @ts_files/194.ts: %dflt
      %0 = new @ts_files/194.ts: %AC$%dflt$%AM63$%AM61$%AM0$120
      instanceinvoke %0.<@ts_files/194.ts: %AC$%dflt$%AM63$%AM61$%AM0$120.constructor()>()
      %1 = <@ts_files/194.ts: %AC$%dflt$%AM63$%AM61$%AM0$120>%0
      %2 = roomAdapter.<@%unk/%unk: .getFederatedRoomByExternalId>
      instanceinvoke %2.<@%unk/%unk: .resolves()>(%1)
      %3 = userAdapter.<@%unk/%unk: .getFederatedUserByExternalId>
      instanceinvoke %3.<@%unk/%unk: .resolves()>(undefined)
      %4 = new @ts_files/194.ts: %AC$%dflt$%AM63$%AM61$%AM0$121
      instanceinvoke %4.<@ts_files/194.ts: %AC$%dflt$%AM63$%AM61$%AM0$121.constructor()>()
      %5 = <@ts_files/194.ts: %AC$%dflt$%AM63$%AM61$%AM0$121>%4
      %6 = instanceinvoke service.<@%unk/%unk: .onExternalFileMessageReceived()>(%5)
      %7 = await %6
      %8 = messageAdapter.<@%unk/%unk: .sendFileMessage>
      %9 = %8.<@%unk/%unk: .called>
      %10 = staticinvoke <@%unk/%unk: .expect()>(%9)
      %11 = %10.<@%unk/%unk: .to>
      %12 = %11.<@%unk/%unk: .be>
      return"];
}
subgraph "cluster_@ts_files/194.ts: %dflt.%AM64$%AM61$%AM0()" {
  label="@ts_files/194.ts: %dflt.%AM64$%AM61$%AM0()";
  Node29490 [label="id:0
      this = this: @ts_files/194.ts: %dflt
      %0 = roomAdapter.<@%unk/%unk: .getFederatedRoomByExternalId>
      instanceinvoke %0.<@%unk/%unk: .resolves()>(room)
      %1 = userAdapter.<@%unk/%unk: .getFederatedUserByExternalId>
      instanceinvoke %1.<@%unk/%unk: .resolves()>(user)
      %2 = bridge.<@%unk/%unk: .getReadStreamForFileFromUrl>
      instanceinvoke %2.<@%unk/%unk: .resolves()>()
      %3 = new @ts_files/194.ts: %AC$%dflt$%AM64$%AM61$%AM0$122
      instanceinvoke %3.<@ts_files/194.ts: %AC$%dflt$%AM64$%AM61$%AM0$122.constructor()>()
      %4 = newarray (@ts_files/194.ts: %AC$%dflt$%AM64$%AM61$%AM0$122)[1]
      %4[0] = %3
      files = %4
      %5 = newarray (string)[2]
      %5[0] = 'attachment'
      %5[1] = 'attachment2'
      attachments = %5
      %6 = new @ts_files/194.ts: %AC$%dflt$%AM64$%AM61$%AM0$123
      instanceinvoke %6.<@ts_files/194.ts: %AC$%dflt$%AM64$%AM61$%AM0$123.constructor()>()
      %7 = <@ts_files/194.ts: %AC$%dflt$%AM64$%AM61$%AM0$123>%6
      %8 = fileAdapter.<@%unk/%unk: .uploadFile>
      instanceinvoke %8.<@%unk/%unk: .resolves()>(%7)
      %9 = new @ts_files/194.ts: %AC$%dflt$%AM64$%AM61$%AM0$124
      instanceinvoke %9.<@ts_files/194.ts: %AC$%dflt$%AM64$%AM61$%AM0$124.constructor()>()
      %10 = <@ts_files/194.ts: %AC$%dflt$%AM64$%AM61$%AM0$124>%9
      %11 = instanceinvoke service.<@%unk/%unk: .onExternalFileMessageReceived()>(%10)
      %12 = await %11
      %13 = messageAdapter.<@%unk/%unk: .sendFileMessage>
      %14 = instanceinvoke %13.<@%unk/%unk: .calledWith()>(user, room, files, attachments)
      %15 = staticinvoke <@%unk/%unk: .expect()>(%14)
      %16 = %15.<@%unk/%unk: .to>
      %17 = %16.<@%unk/%unk: .be>
      return"];
}
subgraph "cluster_@ts_files/194.ts: %dflt.%AM66$%AM65$%AM61$%AM0()" {
  label="@ts_files/194.ts: %dflt.%AM66$%AM65$%AM61$%AM0()";
  Node32730 [label="id:0
      this = this: @ts_files/194.ts: %dflt
      %0 = roomAdapter.<@%unk/%unk: .getFederatedRoomByExternalId>
      instanceinvoke %0.<@%unk/%unk: .resolves()>(room)
      %1 = userAdapter.<@%unk/%unk: .getFederatedUserByExternalId>
      instanceinvoke %1.<@%unk/%unk: .resolves()>(user)
      %2 = messageAdapter.<@%unk/%unk: .getMessageByFederationId>
      instanceinvoke %2.<@%unk/%unk: .resolves()>(undefined)
      %3 = new @ts_files/194.ts: %AC$%dflt$%AM66$%AM65$%AM61$%AM0$126
      instanceinvoke %3.<@ts_files/194.ts: %AC$%dflt$%AM66$%AM65$%AM61$%AM0$126.constructor()>()
      %4 = <@ts_files/194.ts: %AC$%dflt$%AM66$%AM65$%AM61$%AM0$126>%3
      %5 = fileAdapter.<@%unk/%unk: .uploadFile>
      instanceinvoke %5.<@%unk/%unk: .resolves()>(%4)
      %6 = new @ts_files/194.ts: %AC$%dflt$%AM66$%AM65$%AM61$%AM0$127
      instanceinvoke %6.<@ts_files/194.ts: %AC$%dflt$%AM66$%AM65$%AM61$%AM0$127.constructor()>()
      %7 = <@ts_files/194.ts: %AC$%dflt$%AM66$%AM65$%AM61$%AM0$127>%6
      %8 = instanceinvoke service.<@%unk/%unk: .onExternalFileMessageReceived()>(%7)
      %9 = await %8
      %10 = messageAdapter.<@%unk/%unk: .sendQuoteFileMessage>
      %11 = %10.<@%unk/%unk: .called>
      %12 = staticinvoke <@%unk/%unk: .expect()>(%11)
      %13 = %12.<@%unk/%unk: .to>
      %14 = %13.<@%unk/%unk: .be>
      %15 = messageAdapter.<@%unk/%unk: .sendFileMessage>
      %16 = %15.<@%unk/%unk: .called>
      %17 = staticinvoke <@%unk/%unk: .expect()>(%16)
      %18 = %17.<@%unk/%unk: .to>
      %19 = %18.<@%unk/%unk: .be>
      return"];
}
subgraph "cluster_@ts_files/194.ts: %dflt.%AM67$%AM65$%AM61$%AM0()" {
  label="@ts_files/194.ts: %dflt.%AM67$%AM65$%AM61$%AM0()";
  Node32740 [label="id:0
      this = this: @ts_files/194.ts: %dflt
      %0 = new @ts_files/194.ts: %AC$%dflt$%AM67$%AM65$%AM61$%AM0$129
      instanceinvoke %0.<@ts_files/194.ts: %AC$%dflt$%AM67$%AM65$%AM61$%AM0$129.constructor()>()
      messageToReplyTo = <@ts_files/194.ts: %AC$%dflt$%AM67$%AM65$%AM61$%AM0$129>%0
      %1 = roomAdapter.<@%unk/%unk: .getFederatedRoomByExternalId>
      instanceinvoke %1.<@%unk/%unk: .resolves()>(room)
      %2 = userAdapter.<@%unk/%unk: .getFederatedUserByExternalId>
      instanceinvoke %2.<@%unk/%unk: .resolves()>(user)
      %3 = messageAdapter.<@%unk/%unk: .getMessageByFederationId>
      %4 = instanceinvoke %3.<@%unk/%unk: .onFirstCall()>()
      instanceinvoke %4.<@%unk/%unk: .resolves()>(undefined)
      %5 = messageAdapter.<@%unk/%unk: .getMessageByFederationId>
      %6 = instanceinvoke %5.<@%unk/%unk: .onSecondCall()>()
      instanceinvoke %6.<@%unk/%unk: .resolves()>(messageToReplyTo)
      %7 = new @ts_files/194.ts: %AC$%dflt$%AM67$%AM65$%AM61$%AM0$131
      instanceinvoke %7.<@ts_files/194.ts: %AC$%dflt$%AM67$%AM65$%AM61$%AM0$131.constructor()>()
      %8 = newarray (@ts_files/194.ts: %AC$%dflt$%AM67$%AM65$%AM61$%AM0$131)[1]
      %8[0] = %7
      files = %8
      %9 = newarray (string)[2]
      %9[0] = 'attachment'
      %9[1] = 'attachment2'
      attachments = %9
      %10 = new @ts_files/194.ts: %AC$%dflt$%AM67$%AM65$%AM61$%AM0$132
      instanceinvoke %10.<@ts_files/194.ts: %AC$%dflt$%AM67$%AM65$%AM61$%AM0$132.constructor()>()
      %11 = <@ts_files/194.ts: %AC$%dflt$%AM67$%AM65$%AM61$%AM0$132>%10
      %12 = fileAdapter.<@%unk/%unk: .uploadFile>
      instanceinvoke %12.<@%unk/%unk: .resolves()>(%11)
      %13 = new @ts_files/194.ts: %AC$%dflt$%AM67$%AM65$%AM61$%AM0$133
      instanceinvoke %13.<@ts_files/194.ts: %AC$%dflt$%AM67$%AM65$%AM61$%AM0$133.constructor()>()
      %14 = <@ts_files/194.ts: %AC$%dflt$%AM67$%AM65$%AM61$%AM0$133>%13
      %15 = instanceinvoke service.<@%unk/%unk: .onExternalFileMessageReceived()>(%14)
      %16 = await %15
      %17 = messageAdapter.<@%unk/%unk: .sendQuoteFileMessage>
      %18 = instanceinvoke %17.<@%unk/%unk: .calledWith()>(user, room, files, attachments, 'externalEventId', messageToReplyTo, 'localDomain')
      %19 = staticinvoke <@%unk/%unk: .expect()>(%18)
      %20 = %19.<@%unk/%unk: .to>
      %21 = %20.<@%unk/%unk: .be>
      %22 = messageAdapter.<@%unk/%unk: .sendFileMessage>
      %23 = %22.<@%unk/%unk: .called>
      %24 = staticinvoke <@%unk/%unk: .expect()>(%23)
      %25 = %24.<@%unk/%unk: .to>
      %26 = %25.<@%unk/%unk: .be>
      return"];
}
subgraph "cluster_@ts_files/194.ts: %dflt.%AM65$%AM61$%AM0()" {
  label="@ts_files/194.ts: %dflt.%AM65$%AM61$%AM0()";
  Node29500 [label="id:0
      this = this: @ts_files/194.ts: %dflt
      staticinvoke <@%unk/%unk: .it()>('should NOT send a quote message if its necessary to quote but the message to quote does not exists', %AM66$%AM65$%AM61$%AM0)
      staticinvoke <@%unk/%unk: .it()>('should send a quote message if its necessary to quote and the message to quote exists', %AM67$%AM65$%AM61$%AM0)
      return"];
}
subgraph "cluster_@ts_files/194.ts: %dflt.%AM61$%AM0()" {
  label="@ts_files/194.ts: %dflt.%AM61$%AM0()";
  Node26280 [label="id:0
      this = this: @ts_files/194.ts: %dflt
      %0 = new @ts_files/194.ts: %AC$%dflt$%AM61$%AM0$118
      instanceinvoke %0.<@ts_files/194.ts: %AC$%dflt$%AM61$%AM0$118.constructor()>()
      user = instanceinvoke FederatedUser.<@%unk/%unk: .createInstance()>('externalInviterId', %0)
      %1 = RoomType.<@%unk/%unk: .CHANNEL>
      room = instanceinvoke FederatedRoom.<@%unk/%unk: .createInstance()>('externalRoomId', 'normalizedRoomId', user, %1, 'externalRoomName')
      staticinvoke <@%unk/%unk: .it()>('should NOT send a message if the room does not exists', %AM62$%AM61$%AM0)
      staticinvoke <@%unk/%unk: .it()>('should NOT send a message if the sender does not exists', %AM63$%AM61$%AM0)
      staticinvoke <@%unk/%unk: .it()>('should send a message if the room and the sender already exists', %AM64$%AM61$%AM0)
      staticinvoke <@%unk/%unk: .describe()>('Quoting messages', %AM65$%AM61$%AM0)
      return"];
}
subgraph "cluster_@ts_files/194.ts: %dflt.%AM69$%AM68$%AM0()" {
  label="@ts_files/194.ts: %dflt.%AM69$%AM68$%AM0()";
  Node29610 [label="id:0
      this = this: @ts_files/194.ts: %dflt
      %0 = roomAdapter.<@%unk/%unk: .getFederatedRoomByExternalId>
      instanceinvoke %0.<@%unk/%unk: .resolves()>(undefined)
      %1 = new @ts_files/194.ts: %AC$%dflt$%AM69$%AM68$%AM0$135
      instanceinvoke %1.<@ts_files/194.ts: %AC$%dflt$%AM69$%AM68$%AM0$135.constructor()>()
      %2 = <@ts_files/194.ts: %AC$%dflt$%AM69$%AM68$%AM0$135>%1
      %3 = instanceinvoke service.<@%unk/%unk: .onExternalMessageReceived()>(%2)
      %4 = await %3
      %5 = messageAdapter.<@%unk/%unk: .sendMessage>
      %6 = %5.<@%unk/%unk: .called>
      %7 = staticinvoke <@%unk/%unk: .expect()>(%6)
      %8 = %7.<@ts_files/194.ts: %AC$%dflt$%dflt$4.to>
      %9 = %8.<@%unk/%unk: .be>
      return"];
}
subgraph "cluster_@ts_files/194.ts: %dflt.%AM70$%AM68$%AM0()" {
  label="@ts_files/194.ts: %dflt.%AM70$%AM68$%AM0()";
  Node29530 [label="id:0
      this = this: @ts_files/194.ts: %dflt
      %0 = new @ts_files/194.ts: %AC$%dflt$%AM70$%AM68$%AM0$136
      instanceinvoke %0.<@ts_files/194.ts: %AC$%dflt$%AM70$%AM68$%AM0$136.constructor()>()
      %1 = <@ts_files/194.ts: %AC$%dflt$%AM70$%AM68$%AM0$136>%0
      %2 = roomAdapter.<@%unk/%unk: .getFederatedRoomByExternalId>
      instanceinvoke %2.<@%unk/%unk: .resolves()>(%1)
      %3 = userAdapter.<@%unk/%unk: .getFederatedUserByExternalId>
      instanceinvoke %3.<@%unk/%unk: .resolves()>(undefined)
      %4 = new @ts_files/194.ts: %AC$%dflt$%AM70$%AM68$%AM0$137
      instanceinvoke %4.<@ts_files/194.ts: %AC$%dflt$%AM70$%AM68$%AM0$137.constructor()>()
      %5 = <@ts_files/194.ts: %AC$%dflt$%AM70$%AM68$%AM0$137>%4
      %6 = instanceinvoke service.<@%unk/%unk: .onExternalMessageReceived()>(%5)
      %7 = await %6
      %8 = messageAdapter.<@%unk/%unk: .sendMessage>
      %9 = %8.<@%unk/%unk: .called>
      %10 = staticinvoke <@%unk/%unk: .expect()>(%9)
      %11 = %10.<@%unk/%unk: .to>
      %12 = %11.<@%unk/%unk: .be>
      return"];
}
subgraph "cluster_@ts_files/194.ts: %dflt.%AM71$%AM68$%AM0()" {
  label="@ts_files/194.ts: %dflt.%AM71$%AM68$%AM0()";
  Node29540 [label="id:0
      this = this: @ts_files/194.ts: %dflt
      %0 = new @ts_files/194.ts: %AC$%dflt$%AM71$%AM68$%AM0$138
      instanceinvoke %0.<@ts_files/194.ts: %AC$%dflt$%AM71$%AM68$%AM0$138.constructor()>()
      %1 = <@ts_files/194.ts: %AC$%dflt$%AM71$%AM68$%AM0$138>%0
      %2 = roomAdapter.<@%unk/%unk: .getFederatedRoomByExternalId>
      instanceinvoke %2.<@%unk/%unk: .resolves()>(%1)
      %3 = new @ts_files/194.ts: %AC$%dflt$%AM71$%AM68$%AM0$139
      instanceinvoke %3.<@ts_files/194.ts: %AC$%dflt$%AM71$%AM68$%AM0$139.constructor()>()
      %4 = <@ts_files/194.ts: %AC$%dflt$%AM71$%AM68$%AM0$139>%3
      %5 = userAdapter.<@%unk/%unk: .getFederatedUserByExternalId>
      instanceinvoke %5.<@%unk/%unk: .resolves()>(%4)
      %6 = new @ts_files/194.ts: %AC$%dflt$%AM71$%AM68$%AM0$140
      instanceinvoke %6.<@ts_files/194.ts: %AC$%dflt$%AM71$%AM68$%AM0$140.constructor()>()
      %7 = <@ts_files/194.ts: %AC$%dflt$%AM71$%AM68$%AM0$140>%6
      %8 = messageAdapter.<@%unk/%unk: .getMessageByFederationId>
      instanceinvoke %8.<@%unk/%unk: .resolves()>(%7)
      %9 = new @ts_files/194.ts: %AC$%dflt$%AM71$%AM68$%AM0$141
      instanceinvoke %9.<@ts_files/194.ts: %AC$%dflt$%AM71$%AM68$%AM0$141.constructor()>()
      %10 = <@ts_files/194.ts: %AC$%dflt$%AM71$%AM68$%AM0$141>%9
      %11 = instanceinvoke service.<@%unk/%unk: .onExternalMessageReceived()>(%10)
      %12 = await %11
      %13 = messageAdapter.<@%unk/%unk: .sendMessage>
      %14 = %13.<@%unk/%unk: .called>
      %15 = staticinvoke <@%unk/%unk: .expect()>(%14)
      %16 = %15.<@%unk/%unk: .to>
      %17 = %16.<@%unk/%unk: .be>
      return"];
}
subgraph "cluster_@ts_files/194.ts: %dflt.%AM72$%AM68$%AM0()" {
  label="@ts_files/194.ts: %dflt.%AM72$%AM68$%AM0()";
  Node29550 [label="id:0
      this = this: @ts_files/194.ts: %dflt
      %0 = new @ts_files/194.ts: %AC$%dflt$%AM72$%AM68$%AM0$142
      instanceinvoke %0.<@ts_files/194.ts: %AC$%dflt$%AM72$%AM68$%AM0$142.constructor()>()
      %1 = <@ts_files/194.ts: %AC$%dflt$%AM72$%AM68$%AM0$142>%0
      %2 = roomAdapter.<@%unk/%unk: .getFederatedRoomByExternalId>
      instanceinvoke %2.<@%unk/%unk: .resolves()>(%1)
      %3 = new @ts_files/194.ts: %AC$%dflt$%AM72$%AM68$%AM0$143
      instanceinvoke %3.<@ts_files/194.ts: %AC$%dflt$%AM72$%AM68$%AM0$143.constructor()>()
      %4 = <@ts_files/194.ts: %AC$%dflt$%AM72$%AM68$%AM0$143>%3
      %5 = userAdapter.<@%unk/%unk: .getFederatedUserByExternalId>
      instanceinvoke %5.<@%unk/%unk: .resolves()>(%4)
      %6 = messageAdapter.<@%unk/%unk: .getMessageByFederationId>
      instanceinvoke %6.<@%unk/%unk: .resolves()>(undefined)
      %7 = new @ts_files/194.ts: %AC$%dflt$%AM72$%AM68$%AM0$144
      instanceinvoke %7.<@ts_files/194.ts: %AC$%dflt$%AM72$%AM68$%AM0$144.constructor()>()
      %8 = <@ts_files/194.ts: %AC$%dflt$%AM72$%AM68$%AM0$144>%7
      %9 = instanceinvoke service.<@%unk/%unk: .onExternalMessageReceived()>(%8)
      %10 = await %9
      %11 = new @ts_files/194.ts: %AC$%dflt$%AM72$%AM68$%AM0$145
      instanceinvoke %11.<@ts_files/194.ts: %AC$%dflt$%AM72$%AM68$%AM0$145.constructor()>()
      %12 = new @ts_files/194.ts: %AC$%dflt$%AM72$%AM68$%AM0$146
      instanceinvoke %12.<@ts_files/194.ts: %AC$%dflt$%AM72$%AM68$%AM0$146.constructor()>()
      %13 = messageAdapter.<@%unk/%unk: .sendMessage>
      %14 = instanceinvoke %13.<@%unk/%unk: .calledWith()>(%11, %12, 'rawMessage', 'externalFormattedText', 'externalEventId', 'localDomain')
      %15 = staticinvoke <@%unk/%unk: .expect()>(%14)
      %16 = %15.<@%unk/%unk: .to>
      %17 = %16.<@%unk/%unk: .be>
      %18 = messageAdapter.<@%unk/%unk: .sendQuoteMessage>
      %19 = %18.<@%unk/%unk: .called>
      %20 = staticinvoke <@%unk/%unk: .expect()>(%19)
      %21 = %20.<@%unk/%unk: .to>
      %22 = %21.<@%unk/%unk: .be>
      return"];
}
subgraph "cluster_@ts_files/194.ts: %dflt.%AM74$%AM73$%AM68$%AM0()" {
  label="@ts_files/194.ts: %dflt.%AM74$%AM73$%AM68$%AM0()";
  Node32780 [label="id:0
      this = this: @ts_files/194.ts: %dflt
      %0 = new @ts_files/194.ts: %AC$%dflt$%AM74$%AM73$%AM68$%AM0$147
      instanceinvoke %0.<@ts_files/194.ts: %AC$%dflt$%AM74$%AM73$%AM68$%AM0$147.constructor()>()
      %1 = <@ts_files/194.ts: %AC$%dflt$%AM74$%AM73$%AM68$%AM0$147>%0
      %2 = roomAdapter.<@%unk/%unk: .getFederatedRoomByExternalId>
      instanceinvoke %2.<@%unk/%unk: .resolves()>(%1)
      %3 = new @ts_files/194.ts: %AC$%dflt$%AM74$%AM73$%AM68$%AM0$148
      instanceinvoke %3.<@ts_files/194.ts: %AC$%dflt$%AM74$%AM73$%AM68$%AM0$148.constructor()>()
      %4 = <@ts_files/194.ts: %AC$%dflt$%AM74$%AM73$%AM68$%AM0$148>%3
      %5 = userAdapter.<@%unk/%unk: .getFederatedUserByExternalId>
      instanceinvoke %5.<@%unk/%unk: .resolves()>(%4)
      %6 = messageAdapter.<@%unk/%unk: .getMessageByFederationId>
      instanceinvoke %6.<@%unk/%unk: .resolves()>(undefined)
      %7 = new @ts_files/194.ts: %AC$%dflt$%AM74$%AM73$%AM68$%AM0$149
      instanceinvoke %7.<@ts_files/194.ts: %AC$%dflt$%AM74$%AM73$%AM68$%AM0$149.constructor()>()
      %8 = <@ts_files/194.ts: %AC$%dflt$%AM74$%AM73$%AM68$%AM0$149>%7
      %9 = instanceinvoke service.<@%unk/%unk: .onExternalMessageReceived()>(%8)
      %10 = await %9
      %11 = messageAdapter.<@%unk/%unk: .sendQuoteMessage>
      %12 = %11.<@%unk/%unk: .called>
      %13 = staticinvoke <@%unk/%unk: .expect()>(%12)
      %14 = %13.<@%unk/%unk: .to>
      %15 = %14.<@%unk/%unk: .be>
      %16 = messageAdapter.<@%unk/%unk: .sendMessage>
      %17 = %16.<@%unk/%unk: .called>
      %18 = staticinvoke <@%unk/%unk: .expect()>(%17)
      %19 = %18.<@%unk/%unk: .to>
      %20 = %19.<@%unk/%unk: .be>
      return"];
}
subgraph "cluster_@ts_files/194.ts: %dflt.%AM75$%AM73$%AM68$%AM0()" {
  label="@ts_files/194.ts: %dflt.%AM75$%AM73$%AM68$%AM0()";
  Node32790 [label="id:0
      this = this: @ts_files/194.ts: %dflt
      %0 = new @ts_files/194.ts: %AC$%dflt$%AM75$%AM73$%AM68$%AM0$150
      instanceinvoke %0.<@ts_files/194.ts: %AC$%dflt$%AM75$%AM73$%AM68$%AM0$150.constructor()>()
      %1 = <@ts_files/194.ts: %AC$%dflt$%AM75$%AM73$%AM68$%AM0$150>%0
      %2 = roomAdapter.<@%unk/%unk: .getFederatedRoomByExternalId>
      instanceinvoke %2.<@%unk/%unk: .resolves()>(%1)
      %3 = new @ts_files/194.ts: %AC$%dflt$%AM75$%AM73$%AM68$%AM0$151
      instanceinvoke %3.<@ts_files/194.ts: %AC$%dflt$%AM75$%AM73$%AM68$%AM0$151.constructor()>()
      %4 = <@ts_files/194.ts: %AC$%dflt$%AM75$%AM73$%AM68$%AM0$151>%3
      %5 = userAdapter.<@%unk/%unk: .getFederatedUserByExternalId>
      instanceinvoke %5.<@%unk/%unk: .resolves()>(%4)
      %6 = messageAdapter.<@%unk/%unk: .getMessageByFederationId>
      %7 = instanceinvoke %6.<@%unk/%unk: .onFirstCall()>()
      instanceinvoke %7.<@%unk/%unk: .resolves()>(undefined)
      %8 = new @ts_files/194.ts: %AC$%dflt$%AM75$%AM73$%AM68$%AM0$152
      instanceinvoke %8.<@ts_files/194.ts: %AC$%dflt$%AM75$%AM73$%AM68$%AM0$152.constructor()>()
      %9 = <@ts_files/194.ts: %AC$%dflt$%AM75$%AM73$%AM68$%AM0$152>%8
      %10 = messageAdapter.<@%unk/%unk: .getMessageByFederationId>
      %11 = instanceinvoke %10.<@%unk/%unk: .onSecondCall()>()
      instanceinvoke %11.<@%unk/%unk: .resolves()>(%9)
      %12 = new @ts_files/194.ts: %AC$%dflt$%AM75$%AM73$%AM68$%AM0$153
      instanceinvoke %12.<@ts_files/194.ts: %AC$%dflt$%AM75$%AM73$%AM68$%AM0$153.constructor()>()
      %13 = <@ts_files/194.ts: %AC$%dflt$%AM75$%AM73$%AM68$%AM0$153>%12
      %14 = instanceinvoke service.<@%unk/%unk: .onExternalMessageReceived()>(%13)
      %15 = await %14
      %16 = new @ts_files/194.ts: %AC$%dflt$%AM75$%AM73$%AM68$%AM0$154
      instanceinvoke %16.<@ts_files/194.ts: %AC$%dflt$%AM75$%AM73$%AM68$%AM0$154.constructor()>()
      %17 = new @ts_files/194.ts: %AC$%dflt$%AM75$%AM73$%AM68$%AM0$155
      instanceinvoke %17.<@ts_files/194.ts: %AC$%dflt$%AM75$%AM73$%AM68$%AM0$155.constructor()>()
      %18 = new @ts_files/194.ts: %AC$%dflt$%AM75$%AM73$%AM68$%AM0$156
      instanceinvoke %18.<@ts_files/194.ts: %AC$%dflt$%AM75$%AM73$%AM68$%AM0$156.constructor()>()
      %19 = messageAdapter.<@%unk/%unk: .sendQuoteMessage>
      %20 = instanceinvoke %19.<@%unk/%unk: .calledWith()>(%16, %17, 'externalFormattedText', 'rawMessage', 'externalEventId', %18, 'localDomain')
      %21 = staticinvoke <@%unk/%unk: .expect()>(%20)
      %22 = %21.<@%unk/%unk: .to>
      %23 = %22.<@%unk/%unk: .be>
      %24 = messageAdapter.<@%unk/%unk: .sendMessage>
      %25 = %24.<@%unk/%unk: .called>
      %26 = staticinvoke <@%unk/%unk: .expect()>(%25)
      %27 = %26.<@%unk/%unk: .to>
      %28 = %27.<@%unk/%unk: .be>
      return"];
}
subgraph "cluster_@ts_files/194.ts: %dflt.%AM73$%AM68$%AM0()" {
  label="@ts_files/194.ts: %dflt.%AM73$%AM68$%AM0()";
  Node29560 [label="id:0
      this = this: @ts_files/194.ts: %dflt
      staticinvoke <@%unk/%unk: .it()>('should NOT send a quote message if its necessary to quote but the message to quote does not exists', %AM74$%AM73$%AM68$%AM0)
      staticinvoke <@%unk/%unk: .it()>('should send a quote message if its necessary to quote and the message to quote exists', %AM75$%AM73$%AM68$%AM0)
      return"];
}
subgraph "cluster_@ts_files/194.ts: %dflt.%AM68$%AM0()" {
  label="@ts_files/194.ts: %dflt.%AM68$%AM0()";
  Node26350 [label="id:0
      this = this: @ts_files/194.ts: %dflt
      staticinvoke <@%unk/%unk: .it()>('should NOT send a message if the room does not exists', %AM69$%AM68$%AM0)
      staticinvoke <@%unk/%unk: .it()>('should NOT send a message if the sender does not exists', %AM70$%AM68$%AM0)
      staticinvoke <@%unk/%unk: .it()>('should NOT send a message if the message was already be sent through federation and is just a reply back event', %AM71$%AM68$%AM0)
      staticinvoke <@%unk/%unk: .it()>('should send a message if the room, the sender already exists and the message does not exists, because it was sent originally from Matrix', %AM72$%AM68$%AM0)
      staticinvoke <@%unk/%unk: .describe()>('Quoting messages', %AM73$%AM68$%AM0)
      return"];
}
subgraph "cluster_@ts_files/194.ts: %dflt.%AM77$%AM76$%AM0()" {
  label="@ts_files/194.ts: %dflt.%AM77$%AM76$%AM0()";
  Node29590 [label="id:0
      this = this: @ts_files/194.ts: %dflt
      %0 = roomAdapter.<@%unk/%unk: .getFederatedRoomByExternalId>
      instanceinvoke %0.<@%unk/%unk: .resolves()>(undefined)
      %1 = new @ts_files/194.ts: %AC$%dflt$%AM77$%AM76$%AM0$158
      instanceinvoke %1.<@ts_files/194.ts: %AC$%dflt$%AM77$%AM76$%AM0$158.constructor()>()
      %2 = <@ts_files/194.ts: %AC$%dflt$%AM77$%AM76$%AM0$158>%1
      %3 = instanceinvoke service.<@%unk/%unk: .onChangeJoinRules()>(%2)
      %4 = await %3
      %5 = roomAdapter.<@%unk/%unk: .updateRoomType>
      %6 = %5.<@%unk/%unk: .called>
      %7 = staticinvoke <@%unk/%unk: .expect()>(%6)
      %8 = %7.<@ts_files/194.ts: %AC$%dflt$%dflt$4.to>
      %9 = %8.<@%unk/%unk: .be>
      return"];
}
subgraph "cluster_@ts_files/194.ts: %dflt.%AM78$%AM76$%AM0()" {
  label="@ts_files/194.ts: %dflt.%AM78$%AM76$%AM0()";
  Node29600 [label="id:0
      this = this: @ts_files/194.ts: %dflt
      %0 = newarray (unknown)[2]
      %0[0] = user
      %0[1] = user
      dmRoom = instanceinvoke DirectMessageFederatedRoom.<@%unk/%unk: .createInstance()>('externalRoomId', user, %0)
      %1 = roomAdapter.<@%unk/%unk: .getFederatedRoomByExternalId>
      instanceinvoke %1.<@%unk/%unk: .resolves()>(dmRoom)
      %2 = new @ts_files/194.ts: %AC$%dflt$%AM78$%AM76$%AM0$159
      instanceinvoke %2.<@ts_files/194.ts: %AC$%dflt$%AM78$%AM76$%AM0$159.constructor()>()
      %3 = <@ts_files/194.ts: %AC$%dflt$%AM78$%AM76$%AM0$159>%2
      %4 = instanceinvoke service.<@%unk/%unk: .onChangeJoinRules()>(%3)
      %5 = await %4
      %6 = roomAdapter.<@%unk/%unk: .updateRoomType>
      %7 = %6.<@%unk/%unk: .called>
      %8 = staticinvoke <@%unk/%unk: .expect()>(%7)
      %9 = %8.<@%unk/%unk: .to>
      %10 = %9.<@%unk/%unk: .be>
      return"];
}
subgraph "cluster_@ts_files/194.ts: %dflt.%AM79$%AM76$%AM0()" {
  label="@ts_files/194.ts: %dflt.%AM79$%AM76$%AM0()";
  Node29610 [label="id:0
      this = this: @ts_files/194.ts: %dflt
      %0 = roomAdapter.<@%unk/%unk: .getFederatedRoomByExternalId>
      instanceinvoke %0.<@%unk/%unk: .resolves()>(room)
      %1 = new @ts_files/194.ts: %AC$%dflt$%AM79$%AM76$%AM0$160
      instanceinvoke %1.<@ts_files/194.ts: %AC$%dflt$%AM79$%AM76$%AM0$160.constructor()>()
      %2 = <@ts_files/194.ts: %AC$%dflt$%AM79$%AM76$%AM0$160>%1
      %3 = instanceinvoke service.<@%unk/%unk: .onChangeJoinRules()>(%2)
      %4 = await %3
      %5 = RoomType.<@%unk/%unk: .PRIVATE_GROUP>
      instanceinvoke room.<@%unk/%unk: .changeRoomType()>(%5)
      %6 = roomAdapter.<@%unk/%unk: .updateRoomType>
      %7 = instanceinvoke %6.<@%unk/%unk: .calledWith()>(room)
      %8 = staticinvoke <@%unk/%unk: .expect()>(%7)
      %9 = %8.<@%unk/%unk: .to>
      %10 = %9.<@%unk/%unk: .be>
      return"];
}
subgraph "cluster_@ts_files/194.ts: %dflt.%AM76$%AM0()" {
  label="@ts_files/194.ts: %dflt.%AM76$%AM0()";
  Node26340 [label="id:0
      this = this: @ts_files/194.ts: %dflt
      %0 = new @ts_files/194.ts: %AC$%dflt$%AM76$%AM0$157
      instanceinvoke %0.<@ts_files/194.ts: %AC$%dflt$%AM76$%AM0$157.constructor()>()
      user = instanceinvoke FederatedUser.<@%unk/%unk: .createInstance()>('externalInviterId', %0)
      %1 = RoomType.<@%unk/%unk: .CHANNEL>
      room = instanceinvoke FederatedRoom.<@%unk/%unk: .createInstance()>('externalRoomId', 'normalizedRoomId', user, %1, 'externalRoomName')
      staticinvoke <@%unk/%unk: .it()>('should NOT change the room type if the room does not exists', %AM77$%AM76$%AM0)
      staticinvoke <@%unk/%unk: .it()>('should NOT change the room type if it exists and is a direct message', %AM78$%AM76$%AM0)
      staticinvoke <@%unk/%unk: .it()>('should change the room type if it exists and is NOT a direct message', %AM79$%AM76$%AM0)
      return"];
}
subgraph "cluster_@ts_files/194.ts: %dflt.%AM81$%AM80$%AM0()" {
  label="@ts_files/194.ts: %dflt.%AM81$%AM80$%AM0()";
  Node29490 [label="id:0
      this = this: @ts_files/194.ts: %dflt
      %0 = roomAdapter.<@%unk/%unk: .getFederatedRoomByExternalId>
      instanceinvoke %0.<@%unk/%unk: .resolves()>(undefined)
      %1 = new @ts_files/194.ts: %AC$%dflt$%AM81$%AM80$%AM0$162
      instanceinvoke %1.<@ts_files/194.ts: %AC$%dflt$%AM81$%AM80$%AM0$162.constructor()>()
      %2 = <@ts_files/194.ts: %AC$%dflt$%AM81$%AM80$%AM0$162>%1
      %3 = instanceinvoke service.<@%unk/%unk: .onChangeRoomName()>(%2)
      %4 = await %3
      %5 = roomAdapter.<@%unk/%unk: .updateRoomName>
      %6 = %5.<@%unk/%unk: .called>
      %7 = staticinvoke <@%unk/%unk: .expect()>(%6)
      %8 = %7.<@ts_files/194.ts: %AC$%dflt$%dflt$4.to>
      %9 = %8.<@%unk/%unk: .be>
      %10 = roomAdapter.<@%unk/%unk: .updateDisplayRoomName>
      %11 = %10.<@%unk/%unk: .called>
      %12 = staticinvoke <@%unk/%unk: .expect()>(%11)
      %13 = %12.<@%unk/%unk: .to>
      %14 = %13.<@%unk/%unk: .be>
      return"];
}
subgraph "cluster_@ts_files/194.ts: %dflt.%AM82$%AM80$%AM0()" {
  label="@ts_files/194.ts: %dflt.%AM82$%AM80$%AM0()";
  Node29500 [label="id:0
      this = this: @ts_files/194.ts: %dflt
      %0 = roomAdapter.<@%unk/%unk: .getFederatedRoomByExternalId>
      instanceinvoke %0.<@%unk/%unk: .resolves()>(room)
      %1 = userAdapter.<@%unk/%unk: .getFederatedUserByExternalId>
      instanceinvoke %1.<@%unk/%unk: .resolves()>(undefined)
      %2 = new @ts_files/194.ts: %AC$%dflt$%AM82$%AM80$%AM0$163
      instanceinvoke %2.<@ts_files/194.ts: %AC$%dflt$%AM82$%AM80$%AM0$163.constructor()>()
      %3 = <@ts_files/194.ts: %AC$%dflt$%AM82$%AM80$%AM0$163>%2
      %4 = instanceinvoke service.<@%unk/%unk: .onChangeRoomName()>(%3)
      %5 = await %4
      %6 = roomAdapter.<@%unk/%unk: .updateRoomName>
      %7 = %6.<@%unk/%unk: .called>
      %8 = staticinvoke <@%unk/%unk: .expect()>(%7)
      %9 = %8.<@%unk/%unk: .to>
      %10 = %9.<@%unk/%unk: .be>
      %11 = roomAdapter.<@%unk/%unk: .updateDisplayRoomName>
      %12 = %11.<@%unk/%unk: .called>
      %13 = staticinvoke <@%unk/%unk: .expect()>(%12)
      %14 = %13.<@%unk/%unk: .to>
      %15 = %14.<@%unk/%unk: .be>
      return"];
}
subgraph "cluster_@ts_files/194.ts: %dflt.%AM83$%AM80$%AM0()" {
  label="@ts_files/194.ts: %dflt.%AM83$%AM80$%AM0()";
  Node29510 [label="id:0
      this = this: @ts_files/194.ts: %dflt
      %0 = roomAdapter.<@%unk/%unk: .getFederatedRoomByExternalId>
      instanceinvoke %0.<@%unk/%unk: .resolves()>(room)
      %1 = userAdapter.<@%unk/%unk: .getFederatedUserByExternalId>
      instanceinvoke %1.<@%unk/%unk: .resolves()>(user)
      %2 = bridge.<@%unk/%unk: .extractHomeserverOrigin>
      instanceinvoke %2.<@%unk/%unk: .returns()>('localDomain')
      %3 = new @ts_files/194.ts: %AC$%dflt$%AM83$%AM80$%AM0$164
      instanceinvoke %3.<@ts_files/194.ts: %AC$%dflt$%AM83$%AM80$%AM0$164.constructor()>()
      %4 = <@ts_files/194.ts: %AC$%dflt$%AM83$%AM80$%AM0$164>%3
      %5 = instanceinvoke service.<@%unk/%unk: .onChangeRoomName()>(%4)
      %6 = await %5
      %7 = roomAdapter.<@%unk/%unk: .updateRoomName>
      %8 = %7.<@ts_files/194.ts: %AC$%dflt$%dflt$4.called>
      %9 = staticinvoke <@%unk/%unk: .expect()>(%8)
      %10 = %9.<@%unk/%unk: .to>
      %11 = %10.<@%unk/%unk: .be>
      return"];
}
subgraph "cluster_@ts_files/194.ts: %dflt.%AM84$%AM80$%AM0()" {
  label="@ts_files/194.ts: %dflt.%AM84$%AM80$%AM0()";
  Node29520 [label="id:0
      this = this: @ts_files/194.ts: %dflt
      %0 = roomAdapter.<@%unk/%unk: .getFederatedRoomByExternalId>
      instanceinvoke %0.<@%unk/%unk: .resolves()>(room)
      %1 = userAdapter.<@%unk/%unk: .getFederatedUserByExternalId>
      instanceinvoke %1.<@%unk/%unk: .resolves()>(user)
      %2 = bridge.<@%unk/%unk: .extractHomeserverOrigin>
      instanceinvoke %2.<@%unk/%unk: .returns()>('externalDomain')
      %3 = new @ts_files/194.ts: %AC$%dflt$%AM84$%AM80$%AM0$165
      instanceinvoke %3.<@ts_files/194.ts: %AC$%dflt$%AM84$%AM80$%AM0$165.constructor()>()
      %4 = <@ts_files/194.ts: %AC$%dflt$%AM84$%AM80$%AM0$165>%3
      %5 = instanceinvoke service.<@%unk/%unk: .onChangeRoomName()>(%4)
      %6 = await %5
      instanceinvoke room.<@%unk/%unk: .changeRoomName()>('!externalRoomId:externalDomain')
      %7 = roomAdapter.<@%unk/%unk: .updateRoomName>
      %8 = instanceinvoke %7.<@%unk/%unk: .calledWith()>(room)
      %9 = staticinvoke <@%unk/%unk: .expect()>(%8)
      %10 = %9.<@%unk/%unk: .to>
      %11 = %10.<@%unk/%unk: .be>
      return"];
}
subgraph "cluster_@ts_files/194.ts: %dflt.%AM85$%AM80$%AM0()" {
  label="@ts_files/194.ts: %dflt.%AM85$%AM80$%AM0()";
  Node29530 [label="id:0
      this = this: @ts_files/194.ts: %dflt
      %0 = newarray (unknown)[2]
      %0[0] = user
      %0[1] = user
      dmRoom = instanceinvoke DirectMessageFederatedRoom.<@%unk/%unk: .createInstance()>('externalRoomId', user, %0)
      %1 = roomAdapter.<@%unk/%unk: .getFederatedRoomByExternalId>
      instanceinvoke %1.<@%unk/%unk: .resolves()>(dmRoom)
      %2 = new @ts_files/194.ts: %AC$%dflt$%AM85$%AM80$%AM0$166
      instanceinvoke %2.<@ts_files/194.ts: %AC$%dflt$%AM85$%AM80$%AM0$166.constructor()>()
      %3 = <@ts_files/194.ts: %AC$%dflt$%AM85$%AM80$%AM0$166>%2
      %4 = instanceinvoke service.<@%unk/%unk: .onChangeRoomName()>(%3)
      %5 = await %4
      %6 = roomAdapter.<@%unk/%unk: .updateDisplayRoomName>
      %7 = %6.<@%unk/%unk: .called>
      %8 = staticinvoke <@%unk/%unk: .expect()>(%7)
      %9 = %8.<@%unk/%unk: .to>
      %10 = %9.<@%unk/%unk: .be>
      return"];
}
subgraph "cluster_@ts_files/194.ts: %dflt.%AM86$%AM80$%AM0()" {
  label="@ts_files/194.ts: %dflt.%AM86$%AM80$%AM0()";
  Node29540 [label="id:0
      this = this: @ts_files/194.ts: %dflt
      %0 = roomAdapter.<@%unk/%unk: .getFederatedRoomByExternalId>
      instanceinvoke %0.<@%unk/%unk: .resolves()>(room)
      %1 = userAdapter.<@%unk/%unk: .getFederatedUserByExternalId>
      instanceinvoke %1.<@%unk/%unk: .resolves()>(user)
      %2 = new @ts_files/194.ts: %AC$%dflt$%AM86$%AM80$%AM0$167
      instanceinvoke %2.<@ts_files/194.ts: %AC$%dflt$%AM86$%AM80$%AM0$167.constructor()>()
      %3 = <@ts_files/194.ts: %AC$%dflt$%AM86$%AM80$%AM0$167>%2
      %4 = instanceinvoke service.<@%unk/%unk: .onChangeRoomName()>(%3)
      %5 = await %4
      instanceinvoke room.<@%unk/%unk: .changeDisplayRoomName()>('normalizedRoomName2')
      %6 = roomAdapter.<@%unk/%unk: .updateDisplayRoomName>
      %7 = instanceinvoke %6.<@%unk/%unk: .calledWith()>(room, user)
      %8 = staticinvoke <@%unk/%unk: .expect()>(%7)
      %9 = %8.<@%unk/%unk: .to>
      %10 = %9.<@%unk/%unk: .be>
      return"];
}
subgraph "cluster_@ts_files/194.ts: %dflt.%AM80$%AM0()" {
  label="@ts_files/194.ts: %dflt.%AM80$%AM0()";
  Node26290 [label="id:0
      this = this: @ts_files/194.ts: %dflt
      %0 = new @ts_files/194.ts: %AC$%dflt$%AM80$%AM0$161
      instanceinvoke %0.<@ts_files/194.ts: %AC$%dflt$%AM80$%AM0$161.constructor()>()
      user = instanceinvoke FederatedUser.<@%unk/%unk: .createInstance()>('externalInviterId', %0)
      %1 = RoomType.<@%unk/%unk: .CHANNEL>
      room = instanceinvoke FederatedRoom.<@%unk/%unk: .createInstance()>('externalRoomId', 'normalizedRoomId', user, %1, 'externalRoomName')
      staticinvoke <@%unk/%unk: .it()>('should NOT change the room name if the room does not exists', %AM81$%AM80$%AM0)
      staticinvoke <@%unk/%unk: .it()>('should NOT change the room name if the user does not exists', %AM82$%AM80$%AM0)
      staticinvoke <@%unk/%unk: .it()>('should NOT change the room name if the room is an internal room', %AM83$%AM80$%AM0)
      staticinvoke <@%unk/%unk: .it()>('should change the room name if the room is NOT an internal room', %AM84$%AM80$%AM0)
      staticinvoke <@%unk/%unk: .it()>('should NOT change the room fname if it exists and is a direct message', %AM85$%AM80$%AM0)
      staticinvoke <@%unk/%unk: .it()>('should change the room fname if it exists and is NOT a direct message', %AM86$%AM80$%AM0)
      return"];
}
subgraph "cluster_@ts_files/194.ts: %dflt.%AM88$%AM87$%AM0()" {
  label="@ts_files/194.ts: %dflt.%AM88$%AM87$%AM0()";
  Node29630 [label="id:0
      this = this: @ts_files/194.ts: %dflt
      %0 = roomAdapter.<@%unk/%unk: .getFederatedRoomByExternalId>
      instanceinvoke %0.<@%unk/%unk: .resolves()>(undefined)
      %1 = new @ts_files/194.ts: %AC$%dflt$%AM88$%AM87$%AM0$169
      instanceinvoke %1.<@ts_files/194.ts: %AC$%dflt$%AM88$%AM87$%AM0$169.constructor()>()
      %2 = <@ts_files/194.ts: %AC$%dflt$%AM88$%AM87$%AM0$169>%1
      %3 = instanceinvoke service.<@%unk/%unk: .onChangeRoomTopic()>(%2)
      %4 = await %3
      %5 = roomAdapter.<@%unk/%unk: .updateRoomTopic>
      %6 = %5.<@%unk/%unk: .called>
      %7 = staticinvoke <@%unk/%unk: .expect()>(%6)
      %8 = %7.<@ts_files/194.ts: %AC$%dflt$%dflt$4.to>
      %9 = %8.<@%unk/%unk: .be>
      return"];
}
subgraph "cluster_@ts_files/194.ts: %dflt.%AM89$%AM87$%AM0()" {
  label="@ts_files/194.ts: %dflt.%AM89$%AM87$%AM0()";
  Node29640 [label="id:0
      this = this: @ts_files/194.ts: %dflt
      %0 = newarray (unknown)[2]
      %0[0] = user
      %0[1] = user
      dmRoom = instanceinvoke DirectMessageFederatedRoom.<@%unk/%unk: .createInstance()>('externalRoomId', user, %0)
      %1 = roomAdapter.<@%unk/%unk: .getFederatedRoomByExternalId>
      instanceinvoke %1.<@%unk/%unk: .resolves()>(dmRoom)
      %2 = new @ts_files/194.ts: %AC$%dflt$%AM89$%AM87$%AM0$170
      instanceinvoke %2.<@ts_files/194.ts: %AC$%dflt$%AM89$%AM87$%AM0$170.constructor()>()
      %3 = <@ts_files/194.ts: %AC$%dflt$%AM89$%AM87$%AM0$170>%2
      %4 = instanceinvoke service.<@%unk/%unk: .onChangeRoomTopic()>(%3)
      %5 = await %4
      %6 = roomAdapter.<@%unk/%unk: .updateRoomTopic>
      %7 = %6.<@%unk/%unk: .called>
      %8 = staticinvoke <@%unk/%unk: .expect()>(%7)
      %9 = %8.<@%unk/%unk: .to>
      %10 = %9.<@%unk/%unk: .be>
      return"];
}
subgraph "cluster_@ts_files/194.ts: %dflt.%AM90$%AM87$%AM0()" {
  label="@ts_files/194.ts: %dflt.%AM90$%AM87$%AM0()";
  Node29560 [label="id:0
      this = this: @ts_files/194.ts: %dflt
      %0 = roomAdapter.<@%unk/%unk: .getFederatedRoomByExternalId>
      instanceinvoke %0.<@%unk/%unk: .resolves()>(room)
      %1 = userAdapter.<@%unk/%unk: .getFederatedUserByExternalId>
      instanceinvoke %1.<@%unk/%unk: .resolves()>(user)
      %2 = new @ts_files/194.ts: %AC$%dflt$%AM90$%AM87$%AM0$171
      instanceinvoke %2.<@ts_files/194.ts: %AC$%dflt$%AM90$%AM87$%AM0$171.constructor()>()
      %3 = <@ts_files/194.ts: %AC$%dflt$%AM90$%AM87$%AM0$171>%2
      %4 = instanceinvoke service.<@%unk/%unk: .onChangeRoomTopic()>(%3)
      %5 = await %4
      instanceinvoke room.<@%unk/%unk: .changeRoomTopic()>('roomTopic')
      %6 = roomAdapter.<@%unk/%unk: .updateRoomTopic>
      %7 = instanceinvoke %6.<@%unk/%unk: .calledWith()>(room, user)
      %8 = staticinvoke <@%unk/%unk: .expect()>(%7)
      %9 = %8.<@%unk/%unk: .to>
      %10 = %9.<@%unk/%unk: .be>
      return"];
}
subgraph "cluster_@ts_files/194.ts: %dflt.%AM87$%AM0()" {
  label="@ts_files/194.ts: %dflt.%AM87$%AM0()";
  Node26360 [label="id:0
      this = this: @ts_files/194.ts: %dflt
      %0 = new @ts_files/194.ts: %AC$%dflt$%AM87$%AM0$168
      instanceinvoke %0.<@ts_files/194.ts: %AC$%dflt$%AM87$%AM0$168.constructor()>()
      user = instanceinvoke FederatedUser.<@%unk/%unk: .createInstance()>('externalInviterId', %0)
      %1 = RoomType.<@%unk/%unk: .CHANNEL>
      room = instanceinvoke FederatedRoom.<@%unk/%unk: .createInstance()>('externalRoomId', 'normalizedRoomId', user, %1, 'externalRoomName')
      staticinvoke <@%unk/%unk: .it()>('should NOT change the room topic if the room does not exists', %AM88$%AM87$%AM0)
      staticinvoke <@%unk/%unk: .it()>('should NOT change the room topic if it exists and is a direct message', %AM89$%AM87$%AM0)
      staticinvoke <@%unk/%unk: .it()>('should change the room topic if it exists and is NOT a direct message', %AM90$%AM87$%AM0)
      return"];
}
subgraph "cluster_@ts_files/194.ts: %dflt.%AM92$%AM91$%AM0()" {
  label="@ts_files/194.ts: %dflt.%AM92$%AM91$%AM0()";
  Node29530 [label="id:0
      this = this: @ts_files/194.ts: %dflt
      %0 = roomAdapter.<@%unk/%unk: .getFederatedRoomByExternalId>
      instanceinvoke %0.<@%unk/%unk: .resolves()>(undefined)
      %1 = new @ts_files/194.ts: %AC$%dflt$%AM92$%AM91$%AM0$173
      instanceinvoke %1.<@ts_files/194.ts: %AC$%dflt$%AM92$%AM91$%AM0$173.constructor()>()
      %2 = <@ts_files/194.ts: %AC$%dflt$%AM92$%AM91$%AM0$173>%1
      %3 = instanceinvoke service.<@%unk/%unk: .onRedactEvent()>(%2)
      %4 = await %3
      %5 = messageAdapter.<@%unk/%unk: .deleteMessage>
      %6 = %5.<@%unk/%unk: .called>
      %7 = staticinvoke <@%unk/%unk: .expect()>(%6)
      %8 = %7.<@ts_files/194.ts: %AC$%dflt$%dflt$4.to>
      %9 = %8.<@%unk/%unk: .be>
      %10 = messageAdapter.<@%unk/%unk: .unreactToMessage>
      %11 = %10.<@%unk/%unk: .called>
      %12 = staticinvoke <@%unk/%unk: .expect()>(%11)
      %13 = %12.<@%unk/%unk: .to>
      %14 = %13.<@%unk/%unk: .be>
      return"];
}
subgraph "cluster_@ts_files/194.ts: %dflt.%AM93$%AM91$%AM0()" {
  label="@ts_files/194.ts: %dflt.%AM93$%AM91$%AM0()";
  Node29540 [label="id:0
      this = this: @ts_files/194.ts: %dflt
      %0 = roomAdapter.<@%unk/%unk: .getFederatedRoomByExternalId>
      instanceinvoke %0.<@%unk/%unk: .resolves()>(room)
      %1 = userAdapter.<@%unk/%unk: .getFederatedUserByExternalId>
      instanceinvoke %1.<@%unk/%unk: .resolves()>(undefined)
      %2 = new @ts_files/194.ts: %AC$%dflt$%AM93$%AM91$%AM0$174
      instanceinvoke %2.<@ts_files/194.ts: %AC$%dflt$%AM93$%AM91$%AM0$174.constructor()>()
      %3 = <@ts_files/194.ts: %AC$%dflt$%AM93$%AM91$%AM0$174>%2
      %4 = instanceinvoke service.<@%unk/%unk: .onRedactEvent()>(%3)
      %5 = await %4
      %6 = messageAdapter.<@%unk/%unk: .deleteMessage>
      %7 = %6.<@%unk/%unk: .called>
      %8 = staticinvoke <@%unk/%unk: .expect()>(%7)
      %9 = %8.<@%unk/%unk: .to>
      %10 = %9.<@%unk/%unk: .be>
      %11 = messageAdapter.<@%unk/%unk: .unreactToMessage>
      %12 = %11.<@%unk/%unk: .called>
      %13 = staticinvoke <@%unk/%unk: .expect()>(%12)
      %14 = %13.<@%unk/%unk: .to>
      %15 = %14.<@%unk/%unk: .be>
      return"];
}
subgraph "cluster_@ts_files/194.ts: %dflt.%AM94$%AM91$%AM0()" {
  label="@ts_files/194.ts: %dflt.%AM94$%AM91$%AM0()";
  Node29550 [label="id:0
      this = this: @ts_files/194.ts: %dflt
      %0 = roomAdapter.<@%unk/%unk: .getFederatedRoomByExternalId>
      instanceinvoke %0.<@%unk/%unk: .resolves()>(room)
      %1 = userAdapter.<@%unk/%unk: .getFederatedUserByExternalId>
      instanceinvoke %1.<@%unk/%unk: .resolves()>(user)
      %2 = messageAdapter.<@%unk/%unk: .getMessageByFederationId>
      instanceinvoke %2.<@%unk/%unk: .resolves()>(undefined)
      %3 = new @ts_files/194.ts: %AC$%dflt$%AM94$%AM91$%AM0$175
      instanceinvoke %3.<@ts_files/194.ts: %AC$%dflt$%AM94$%AM91$%AM0$175.constructor()>()
      %4 = <@ts_files/194.ts: %AC$%dflt$%AM94$%AM91$%AM0$175>%3
      %5 = instanceinvoke service.<@%unk/%unk: .onRedactEvent()>(%4)
      %6 = await %5
      %7 = messageAdapter.<@%unk/%unk: .deleteMessage>
      %8 = %7.<@ts_files/194.ts: %AC$%dflt$%dflt$4.called>
      %9 = staticinvoke <@%unk/%unk: .expect()>(%8)
      %10 = %9.<@%unk/%unk: .to>
      %11 = %10.<@%unk/%unk: .be>
      %12 = messageAdapter.<@%unk/%unk: .unreactToMessage>
      %13 = %12.<@%unk/%unk: .called>
      %14 = staticinvoke <@%unk/%unk: .expect()>(%13)
      %15 = %14.<@%unk/%unk: .to>
      %16 = %15.<@%unk/%unk: .be>
      return"];
}
subgraph "cluster_@ts_files/194.ts: %dflt.%AM95$%AM91$%AM0()" {
  label="@ts_files/194.ts: %dflt.%AM95$%AM91$%AM0()";
  Node29560 [label="id:0
      this = this: @ts_files/194.ts: %dflt
      %0 = roomAdapter.<@%unk/%unk: .getFederatedRoomByExternalId>
      instanceinvoke %0.<@%unk/%unk: .resolves()>(room)
      %1 = userAdapter.<@%unk/%unk: .getFederatedUserByExternalId>
      instanceinvoke %1.<@%unk/%unk: .resolves()>(user)
      %2 = new @ts_files/194.ts: %AC$%dflt$%AM95$%AM91$%AM0$176
      instanceinvoke %2.<@ts_files/194.ts: %AC$%dflt$%AM95$%AM91$%AM0$176.constructor()>()
      %3 = messageAdapter.<@%unk/%unk: .getMessageByFederationId>
      instanceinvoke %3.<@%unk/%unk: .resolves()>(%2)
      %4 = messageAdapter.<@%unk/%unk: .findOneByFederationIdOnReactions>
      instanceinvoke %4.<@%unk/%unk: .resolves()>(undefined)
      %5 = new @ts_files/194.ts: %AC$%dflt$%AM95$%AM91$%AM0$177
      instanceinvoke %5.<@ts_files/194.ts: %AC$%dflt$%AM95$%AM91$%AM0$177.constructor()>()
      %6 = <@ts_files/194.ts: %AC$%dflt$%AM95$%AM91$%AM0$177>%5
      %7 = instanceinvoke service.<@%unk/%unk: .onRedactEvent()>(%6)
      %8 = await %7
      %9 = new @ts_files/194.ts: %AC$%dflt$%AM95$%AM91$%AM0$178
      instanceinvoke %9.<@ts_files/194.ts: %AC$%dflt$%AM95$%AM91$%AM0$178.constructor()>()
      %10 = messageAdapter.<@%unk/%unk: .deleteMessage>
      %11 = instanceinvoke %10.<@%unk/%unk: .calledWith()>(%9, user)
      %12 = staticinvoke <@%unk/%unk: .expect()>(%11)
      %13 = %12.<@%unk/%unk: .to>
      %14 = %13.<@%unk/%unk: .be>
      %15 = messageAdapter.<@%unk/%unk: .unreactToMessage>
      %16 = %15.<@%unk/%unk: .called>
      %17 = staticinvoke <@%unk/%unk: .expect()>(%16)
      %18 = %17.<@%unk/%unk: .to>
      %19 = %18.<@%unk/%unk: .be>
      return"];
}
subgraph "cluster_@ts_files/194.ts: %dflt.%AM96$%AM91$%AM0()" {
  label="@ts_files/194.ts: %dflt.%AM96$%AM91$%AM0()";
  Node29570 [label="id:0
      this = this: @ts_files/194.ts: %dflt
      %0 = roomAdapter.<@%unk/%unk: .getFederatedRoomByExternalId>
      instanceinvoke %0.<@%unk/%unk: .resolves()>(room)
      %1 = userAdapter.<@%unk/%unk: .getFederatedUserByExternalId>
      instanceinvoke %1.<@%unk/%unk: .resolves()>(user)
      %2 = messageAdapter.<@%unk/%unk: .getMessageByFederationId>
      instanceinvoke %2.<@%unk/%unk: .resolves()>(undefined)
      %3 = new @ts_files/194.ts: %AC$%dflt$%AM96$%AM91$%AM0$179
      instanceinvoke %3.<@ts_files/194.ts: %AC$%dflt$%AM96$%AM91$%AM0$179.constructor()>()
      %4 = messageAdapter.<@%unk/%unk: .findOneByFederationIdOnReactions>
      instanceinvoke %4.<@%unk/%unk: .resolves()>(%3)
      %5 = new @ts_files/194.ts: %AC$%dflt$%AM96$%AM91$%AM0$183
      instanceinvoke %5.<@ts_files/194.ts: %AC$%dflt$%AM96$%AM91$%AM0$183.constructor()>()
      %6 = <@ts_files/194.ts: %AC$%dflt$%AM96$%AM91$%AM0$183>%5
      %7 = instanceinvoke service.<@%unk/%unk: .onRedactEvent()>(%6)
      %8 = await %7
      %9 = messageAdapter.<@%unk/%unk: .deleteMessage>
      %10 = %9.<@%unk/%unk: .called>
      %11 = staticinvoke <@%unk/%unk: .expect()>(%10)
      %12 = %11.<@%unk/%unk: .to>
      %13 = %12.<@%unk/%unk: .be>
      %14 = messageAdapter.<@%unk/%unk: .unreactToMessage>
      %15 = %14.<@%unk/%unk: .called>
      %16 = staticinvoke <@%unk/%unk: .expect()>(%15)
      %17 = %16.<@%unk/%unk: .to>
      %18 = %17.<@%unk/%unk: .be>
      return"];
}
subgraph "cluster_@ts_files/194.ts: %dflt.%AM97$%AM91$%AM0()" {
  label="@ts_files/194.ts: %dflt.%AM97$%AM91$%AM0()";
  Node29580 [label="id:0
      this = this: @ts_files/194.ts: %dflt
      %0 = new @ts_files/194.ts: %AC$%dflt$%AM97$%AM91$%AM0$184
      instanceinvoke %0.<@ts_files/194.ts: %AC$%dflt$%AM97$%AM91$%AM0$184.constructor()>()
      message = %0
      %1 = roomAdapter.<@%unk/%unk: .getFederatedRoomByExternalId>
      instanceinvoke %1.<@%unk/%unk: .resolves()>(room)
      %2 = userAdapter.<@%unk/%unk: .getFederatedUserByExternalId>
      instanceinvoke %2.<@%unk/%unk: .resolves()>(user)
      %3 = messageAdapter.<@%unk/%unk: .getMessageByFederationId>
      instanceinvoke %3.<@%unk/%unk: .resolves()>(undefined)
      %4 = messageAdapter.<@%unk/%unk: .findOneByFederationIdOnReactions>
      instanceinvoke %4.<@%unk/%unk: .resolves()>(message)
      %5 = new @ts_files/194.ts: %AC$%dflt$%AM97$%AM91$%AM0$188
      instanceinvoke %5.<@ts_files/194.ts: %AC$%dflt$%AM97$%AM91$%AM0$188.constructor()>()
      %6 = <@ts_files/194.ts: %AC$%dflt$%AM97$%AM91$%AM0$188>%5
      %7 = instanceinvoke service.<@%unk/%unk: .onRedactEvent()>(%6)
      %8 = await %7
      %9 = messageAdapter.<@%unk/%unk: .deleteMessage>
      %10 = %9.<@%unk/%unk: .called>
      %11 = staticinvoke <@%unk/%unk: .expect()>(%10)
      %12 = %11.<@%unk/%unk: .to>
      %13 = %12.<@%unk/%unk: .be>
      %14 = messageAdapter.<@%unk/%unk: .unreactToMessage>
      %15 = instanceinvoke %14.<@%unk/%unk: .calledWith()>(user, message, 'reaction', 'redactsEvent')
      %16 = staticinvoke <@%unk/%unk: .expect()>(%15)
      %17 = %16.<@%unk/%unk: .to>
      %18 = %17.<@%unk/%unk: .be>
      return"];
}
subgraph "cluster_@ts_files/194.ts: %dflt.%AM91$%AM0()" {
  label="@ts_files/194.ts: %dflt.%AM91$%AM0()";
  Node26310 [label="id:0
      this = this: @ts_files/194.ts: %dflt
      %0 = new @ts_files/194.ts: %AC$%dflt$%AM91$%AM0$172
      instanceinvoke %0.<@ts_files/194.ts: %AC$%dflt$%AM91$%AM0$172.constructor()>()
      user = instanceinvoke FederatedUser.<@%unk/%unk: .createInstance()>('externalInviterId', %0)
      %1 = RoomType.<@%unk/%unk: .CHANNEL>
      room = instanceinvoke FederatedRoom.<@%unk/%unk: .createInstance()>('externalRoomId', 'normalizedRoomId', user, %1, 'externalRoomName')
      staticinvoke <@%unk/%unk: .it()>('should NOT delete the message if the room does not exists', %AM92$%AM91$%AM0)
      staticinvoke <@%unk/%unk: .it()>('should NOT delete the message if the sender does not exists', %AM93$%AM91$%AM0)
      staticinvoke <@%unk/%unk: .it()>('should NOT delete the message if the message does not exists', %AM94$%AM91$%AM0)
      staticinvoke <@%unk/%unk: .it()>('should delete the message if its a raw text redact handler', %AM95$%AM91$%AM0)
      staticinvoke <@%unk/%unk: .it()>('should NOT unreact if the message was not reacted before by the user', %AM96$%AM91$%AM0)
      staticinvoke <@%unk/%unk: .it()>('should unreact if the message was reacted before by the user', %AM97$%AM91$%AM0)
      return"];
}
subgraph "cluster_@ts_files/194.ts: %dflt.%AM99$%AM98$%AM0()" {
  label="@ts_files/194.ts: %dflt.%AM99$%AM98$%AM0()";
  Node29670 [label="id:0
      this = this: @ts_files/194.ts: %dflt
      %0 = roomAdapter.<@%unk/%unk: .getFederatedRoomByExternalId>
      instanceinvoke %0.<@%unk/%unk: .resolves()>(undefined)
      %1 = new @ts_files/194.ts: %AC$%dflt$%AM99$%AM98$%AM0$190
      instanceinvoke %1.<@ts_files/194.ts: %AC$%dflt$%AM99$%AM98$%AM0$190.constructor()>()
      %2 = <@ts_files/194.ts: %AC$%dflt$%AM99$%AM98$%AM0$190>%1
      %3 = instanceinvoke service.<@%unk/%unk: .onExternalMessageEditedReceived()>(%2)
      %4 = await %3
      %5 = messageAdapter.<@%unk/%unk: .editMessage>
      %6 = %5.<@%unk/%unk: .called>
      %7 = staticinvoke <@%unk/%unk: .expect()>(%6)
      %8 = %7.<@ts_files/194.ts: %AC$%dflt$%dflt$4.to>
      %9 = %8.<@%unk/%unk: .be>
      return"];
}
subgraph "cluster_@ts_files/194.ts: %dflt.%AM100$%AM98$%AM0()" {
  label="@ts_files/194.ts: %dflt.%AM100$%AM98$%AM0()";
  Node29980 [label="id:0
      this = this: @ts_files/194.ts: %dflt
      %0 = roomAdapter.<@%unk/%unk: .getFederatedRoomByExternalId>
      instanceinvoke %0.<@%unk/%unk: .resolves()>(room)
      %1 = userAdapter.<@%unk/%unk: .getFederatedUserByExternalId>
      instanceinvoke %1.<@%unk/%unk: .resolves()>(undefined)
      %2 = new @ts_files/194.ts: %AC$%dflt$%AM100$%AM98$%AM0$191
      instanceinvoke %2.<@ts_files/194.ts: %AC$%dflt$%AM100$%AM98$%AM0$191.constructor()>()
      %3 = <@ts_files/194.ts: %AC$%dflt$%AM100$%AM98$%AM0$191>%2
      %4 = instanceinvoke service.<@%unk/%unk: .onExternalMessageEditedReceived()>(%3)
      %5 = await %4
      %6 = messageAdapter.<@%unk/%unk: .editMessage>
      %7 = %6.<@%unk/%unk: .called>
      %8 = staticinvoke <@%unk/%unk: .expect()>(%7)
      %9 = %8.<@%unk/%unk: .to>
      %10 = %9.<@%unk/%unk: .be>
      return"];
}
subgraph "cluster_@ts_files/194.ts: %dflt.%AM101$%AM98$%AM0()" {
  label="@ts_files/194.ts: %dflt.%AM101$%AM98$%AM0()";
  Node29990 [label="id:0
      this = this: @ts_files/194.ts: %dflt
      %0 = roomAdapter.<@%unk/%unk: .getFederatedRoomByExternalId>
      instanceinvoke %0.<@%unk/%unk: .resolves()>(room)
      %1 = userAdapter.<@%unk/%unk: .getFederatedUserByExternalId>
      instanceinvoke %1.<@%unk/%unk: .resolves()>(user)
      %2 = messageAdapter.<@%unk/%unk: .getMessageByFederationId>
      instanceinvoke %2.<@%unk/%unk: .resolves()>(undefined)
      %3 = new @ts_files/194.ts: %AC$%dflt$%AM101$%AM98$%AM0$192
      instanceinvoke %3.<@ts_files/194.ts: %AC$%dflt$%AM101$%AM98$%AM0$192.constructor()>()
      %4 = <@ts_files/194.ts: %AC$%dflt$%AM101$%AM98$%AM0$192>%3
      %5 = instanceinvoke service.<@%unk/%unk: .onExternalMessageEditedReceived()>(%4)
      %6 = await %5
      %7 = messageAdapter.<@%unk/%unk: .editMessage>
      %8 = %7.<@ts_files/194.ts: %AC$%dflt$%dflt$4.called>
      %9 = staticinvoke <@%unk/%unk: .expect()>(%8)
      %10 = %9.<@%unk/%unk: .to>
      %11 = %10.<@%unk/%unk: .be>
      return"];
}
subgraph "cluster_@ts_files/194.ts: %dflt.%AM102$%AM98$%AM0()" {
  label="@ts_files/194.ts: %dflt.%AM102$%AM98$%AM0()";
  Node30000 [label="id:0
      this = this: @ts_files/194.ts: %dflt
      %0 = roomAdapter.<@%unk/%unk: .getFederatedRoomByExternalId>
      instanceinvoke %0.<@%unk/%unk: .resolves()>(room)
      %1 = userAdapter.<@%unk/%unk: .getFederatedUserByExternalId>
      instanceinvoke %1.<@%unk/%unk: .resolves()>(user)
      %2 = new @ts_files/194.ts: %AC$%dflt$%AM102$%AM98$%AM0$193
      instanceinvoke %2.<@ts_files/194.ts: %AC$%dflt$%AM102$%AM98$%AM0$193.constructor()>()
      %3 = messageAdapter.<@%unk/%unk: .getMessageByFederationId>
      instanceinvoke %3.<@%unk/%unk: .resolves()>(%2)
      %4 = new @ts_files/194.ts: %AC$%dflt$%AM102$%AM98$%AM0$194
      instanceinvoke %4.<@ts_files/194.ts: %AC$%dflt$%AM102$%AM98$%AM0$194.constructor()>()
      %5 = <@ts_files/194.ts: %AC$%dflt$%AM102$%AM98$%AM0$194>%4
      %6 = instanceinvoke service.<@%unk/%unk: .onExternalMessageEditedReceived()>(%5)
      %7 = await %6
      %8 = messageAdapter.<@%unk/%unk: .editMessage>
      %9 = %8.<@%unk/%unk: .called>
      %10 = staticinvoke <@%unk/%unk: .expect()>(%9)
      %11 = %10.<@%unk/%unk: .to>
      %12 = %11.<@%unk/%unk: .be>
      return"];
}
subgraph "cluster_@ts_files/194.ts: %dflt.%AM103$%AM98$%AM0()" {
  label="@ts_files/194.ts: %dflt.%AM103$%AM98$%AM0()";
  Node30010 [label="id:0
      this = this: @ts_files/194.ts: %dflt
      %0 = roomAdapter.<@%unk/%unk: .getFederatedRoomByExternalId>
      instanceinvoke %0.<@%unk/%unk: .resolves()>(room)
      %1 = userAdapter.<@%unk/%unk: .getFederatedUserByExternalId>
      instanceinvoke %1.<@%unk/%unk: .resolves()>(user)
      %2 = new @ts_files/194.ts: %AC$%dflt$%AM103$%AM98$%AM0$195
      instanceinvoke %2.<@ts_files/194.ts: %AC$%dflt$%AM103$%AM98$%AM0$195.constructor()>()
      %3 = messageAdapter.<@%unk/%unk: .getMessageByFederationId>
      instanceinvoke %3.<@%unk/%unk: .resolves()>(%2)
      %4 = new @ts_files/194.ts: %AC$%dflt$%AM103$%AM98$%AM0$196
      instanceinvoke %4.<@ts_files/194.ts: %AC$%dflt$%AM103$%AM98$%AM0$196.constructor()>()
      %5 = <@ts_files/194.ts: %AC$%dflt$%AM103$%AM98$%AM0$196>%4
      %6 = instanceinvoke service.<@%unk/%unk: .onExternalMessageEditedReceived()>(%5)
      %7 = await %6
      %8 = new @ts_files/194.ts: %AC$%dflt$%AM103$%AM98$%AM0$197
      instanceinvoke %8.<@ts_files/194.ts: %AC$%dflt$%AM103$%AM98$%AM0$197.constructor()>()
      %9 = messageAdapter.<@%unk/%unk: .editMessage>
      %10 = instanceinvoke %9.<@%unk/%unk: .calledWith()>(user, 'newRawMessage', 'newExternalFormattedText', %8, 'localDomain')
      %11 = staticinvoke <@%unk/%unk: .expect()>(%10)
      %12 = %11.<@%unk/%unk: .to>
      %13 = %12.<@%unk/%unk: .be>
      return"];
}
subgraph "cluster_@ts_files/194.ts: %dflt.%AM105$%AM104$%AM98$%AM0()" {
  label="@ts_files/194.ts: %dflt.%AM105$%AM104$%AM98$%AM0()";
  Node33670 [label="id:0
      this = this: @ts_files/194.ts: %dflt
      %0 = roomAdapter.<@%unk/%unk: .getFederatedRoomByExternalId>
      instanceinvoke %0.<@%unk/%unk: .resolves()>(room)
      %1 = userAdapter.<@%unk/%unk: .getFederatedUserByExternalId>
      instanceinvoke %1.<@%unk/%unk: .resolves()>(user)
      %2 = new @ts_files/194.ts: %AC$%dflt$%AM105$%AM104$%AM98$%AM0$198
      instanceinvoke %2.<@ts_files/194.ts: %AC$%dflt$%AM105$%AM104$%AM98$%AM0$198.constructor()>()
      %3 = messageAdapter.<@%unk/%unk: .getMessageByFederationId>
      instanceinvoke %3.<@%unk/%unk: .resolves()>(%2)
      %4 = bridge.<@%unk/%unk: .extractHomeserverOrigin>
      instanceinvoke %4.<@%unk/%unk: .returns()>('localDomain')
      %5 = new @ts_files/194.ts: %AC$%dflt$%AM105$%AM104$%AM98$%AM0$200
      instanceinvoke %5.<@ts_files/194.ts: %AC$%dflt$%AM105$%AM104$%AM98$%AM0$200.constructor()>()
      %6 = <@ts_files/194.ts: %AC$%dflt$%AM105$%AM104$%AM98$%AM0$200>%5
      %7 = instanceinvoke service.<@%unk/%unk: .onExternalMessageEditedReceived()>(%6)
      %8 = await %7
      %9 = messageAdapter.<@%unk/%unk: .editMessage>
      %10 = %9.<@%unk/%unk: .called>
      %11 = staticinvoke <@%unk/%unk: .expect()>(%10)
      %12 = %11.<@%unk/%unk: .to>
      %13 = %12.<@%unk/%unk: .be>
      %14 = messageAdapter.<@%unk/%unk: .editQuotedMessage>
      %15 = %14.<@%unk/%unk: .called>
      %16 = staticinvoke <@%unk/%unk: .expect()>(%15)
      %17 = %16.<@%unk/%unk: .to>
      %18 = %17.<@%unk/%unk: .be>
      return"];
}
subgraph "cluster_@ts_files/194.ts: %dflt.%AM106$%AM104$%AM98$%AM0()" {
  label="@ts_files/194.ts: %dflt.%AM106$%AM104$%AM98$%AM0()";
  Node33680 [label="id:0
      this = this: @ts_files/194.ts: %dflt
      %0 = roomAdapter.<@%unk/%unk: .getFederatedRoomByExternalId>
      instanceinvoke %0.<@%unk/%unk: .resolves()>(room)
      %1 = userAdapter.<@%unk/%unk: .getFederatedUserByExternalId>
      instanceinvoke %1.<@%unk/%unk: .resolves()>(user)
      %2 = new @ts_files/194.ts: %AC$%dflt$%AM106$%AM104$%AM98$%AM0$201
      instanceinvoke %2.<@ts_files/194.ts: %AC$%dflt$%AM106$%AM104$%AM98$%AM0$201.constructor()>()
      %3 = messageAdapter.<@%unk/%unk: .getMessageByFederationId>
      instanceinvoke %3.<@%unk/%unk: .resolves()>(%2)
      %4 = bridge.<@%unk/%unk: .extractHomeserverOrigin>
      instanceinvoke %4.<@%unk/%unk: .returns()>('externalDomain')
      %5 = messageAdapter.<@%unk/%unk: .getMessageToEditWhenReplyAndQuote>
      instanceinvoke %5.<@%unk/%unk: .resolves()>('internalFormattedMessageToBeEdited')
      %6 = new @ts_files/194.ts: %AC$%dflt$%AM106$%AM104$%AM98$%AM0$203
      instanceinvoke %6.<@ts_files/194.ts: %AC$%dflt$%AM106$%AM104$%AM98$%AM0$203.constructor()>()
      %7 = <@ts_files/194.ts: %AC$%dflt$%AM106$%AM104$%AM98$%AM0$203>%6
      %8 = instanceinvoke service.<@%unk/%unk: .onExternalMessageEditedReceived()>(%7)
      %9 = await %8
      %10 = messageAdapter.<@%unk/%unk: .editMessage>
      %11 = %10.<@%unk/%unk: .called>
      %12 = staticinvoke <@%unk/%unk: .expect()>(%11)
      %13 = %12.<@%unk/%unk: .to>
      %14 = %13.<@%unk/%unk: .be>
      %15 = messageAdapter.<@%unk/%unk: .editQuotedMessage>
      %16 = %15.<@%unk/%unk: .called>
      %17 = staticinvoke <@%unk/%unk: .expect()>(%16)
      %18 = %17.<@%unk/%unk: .to>
      %19 = %18.<@%unk/%unk: .be>
      return"];
}
subgraph "cluster_@ts_files/194.ts: %dflt.%AM107$%AM104$%AM98$%AM0()" {
  label="@ts_files/194.ts: %dflt.%AM107$%AM104$%AM98$%AM0()";
  Node33690 [label="id:0
      this = this: @ts_files/194.ts: %dflt
      %0 = new @ts_files/194.ts: %AC$%dflt$%AM107$%AM104$%AM98$%AM0$204
      instanceinvoke %0.<@ts_files/194.ts: %AC$%dflt$%AM107$%AM104$%AM98$%AM0$204.constructor()>()
      message = %0
      %1 = roomAdapter.<@%unk/%unk: .getFederatedRoomByExternalId>
      instanceinvoke %1.<@%unk/%unk: .resolves()>(room)
      %2 = userAdapter.<@%unk/%unk: .getFederatedUserByExternalId>
      instanceinvoke %2.<@%unk/%unk: .resolves()>(user)
      %3 = messageAdapter.<@%unk/%unk: .getMessageByFederationId>
      instanceinvoke %3.<@%unk/%unk: .resolves()>(message)
      %4 = bridge.<@%unk/%unk: .extractHomeserverOrigin>
      instanceinvoke %4.<@%unk/%unk: .returns()>('externalDomain')
      %5 = messageAdapter.<@%unk/%unk: .getMessageToEditWhenReplyAndQuote>
      instanceinvoke %5.<@%unk/%unk: .resolves()>('internalFormattedMessageToBeEdited')
      %6 = new @ts_files/194.ts: %AC$%dflt$%AM107$%AM104$%AM98$%AM0$206
      instanceinvoke %6.<@ts_files/194.ts: %AC$%dflt$%AM107$%AM104$%AM98$%AM0$206.constructor()>()
      %7 = <@ts_files/194.ts: %AC$%dflt$%AM107$%AM104$%AM98$%AM0$206>%6
      %8 = instanceinvoke service.<@%unk/%unk: .onExternalMessageEditedReceived()>(%7)
      %9 = await %8
      %10 = messageAdapter.<@%unk/%unk: .editMessage>
      %11 = %10.<@%unk/%unk: .called>
      %12 = staticinvoke <@%unk/%unk: .expect()>(%11)
      %13 = %12.<@%unk/%unk: .to>
      %14 = %13.<@%unk/%unk: .be>
      %15 = messageAdapter.<@%unk/%unk: .editQuotedMessage>
      %16 = instanceinvoke %15.<@%unk/%unk: .calledWith()>(user, 'newRawMessage', 'newExternalFormattedText', message, 'localDomain')
      %17 = staticinvoke <@%unk/%unk: .expect()>(%16)
      %18 = %17.<@%unk/%unk: .to>
      %19 = %18.<@%unk/%unk: .be>
      return"];
}
subgraph "cluster_@ts_files/194.ts: %dflt.%AM104$%AM98$%AM0()" {
  label="@ts_files/194.ts: %dflt.%AM104$%AM98$%AM0()";
  Node30020 [label="id:0
      this = this: @ts_files/194.ts: %dflt
      staticinvoke <@%unk/%unk: .it()>('should NOT edit the quoted message if the event was generated locally (the message edited was on local server only)', %AM105$%AM104$%AM98$%AM0)
      staticinvoke <@%unk/%unk: .it()>('should NOT edit the quoted message if the event was remotely generated but the message content is the same as the current one (the message is already up to date)', %AM106$%AM104$%AM98$%AM0)
      staticinvoke <@%unk/%unk: .it()>('should edit the quoted message if the event was remotely the message content is outdated', %AM107$%AM104$%AM98$%AM0)
      return"];
}
subgraph "cluster_@ts_files/194.ts: %dflt.%AM98$%AM0()" {
  label="@ts_files/194.ts: %dflt.%AM98$%AM0()";
  Node26380 [label="id:0
      this = this: @ts_files/194.ts: %dflt
      %0 = new @ts_files/194.ts: %AC$%dflt$%AM98$%AM0$189
      instanceinvoke %0.<@ts_files/194.ts: %AC$%dflt$%AM98$%AM0$189.constructor()>()
      user = instanceinvoke FederatedUser.<@%unk/%unk: .createInstance()>('externalInviterId', %0)
      %1 = RoomType.<@%unk/%unk: .CHANNEL>
      room = instanceinvoke FederatedRoom.<@%unk/%unk: .createInstance()>('externalRoomId', 'normalizedRoomId', user, %1, 'externalRoomName')
      staticinvoke <@%unk/%unk: .it()>('should NOT update the message if the room does not exists', %AM99$%AM98$%AM0)
      staticinvoke <@%unk/%unk: .it()>('should NOT update the message if the sender does not exists', %AM100$%AM98$%AM0)
      staticinvoke <@%unk/%unk: .it()>('should NOT update the message if the message does not exists', %AM101$%AM98$%AM0)
      staticinvoke <@%unk/%unk: .it()>('should NOT update the message if the content of the message is equal of the oldest one', %AM102$%AM98$%AM0)
      staticinvoke <@%unk/%unk: .it()>('should update the message', %AM103$%AM98$%AM0)
      staticinvoke <@%unk/%unk: .describe()>('Editing quoted messages', %AM104$%AM98$%AM0)
      return"];
}
subgraph "cluster_@ts_files/194.ts: %dflt.%AM109$%AM108$%AM0()" {
  label="@ts_files/194.ts: %dflt.%AM109$%AM108$%AM0()";
  Node30470 [label="id:0
      this = this: @ts_files/194.ts: %dflt
      %0 = roomAdapter.<@%unk/%unk: .getFederatedRoomByExternalId>
      instanceinvoke %0.<@%unk/%unk: .resolves()>(undefined)
      %1 = new @ts_files/194.ts: %AC$%dflt$%AM109$%AM108$%AM0$208
      instanceinvoke %1.<@ts_files/194.ts: %AC$%dflt$%AM109$%AM108$%AM0$208.constructor()>()
      %2 = <@ts_files/194.ts: %AC$%dflt$%AM109$%AM108$%AM0$208>%1
      %3 = instanceinvoke service.<@%unk/%unk: .onChangeRoomPowerLevels()>(%2)
      %4 = await %3
      %5 = roomAdapter.<@%unk/%unk: .applyRoomRolesToUser>
      %6 = %5.<@%unk/%unk: .called>
      %7 = staticinvoke <@%unk/%unk: .expect()>(%6)
      %8 = %7.<@ts_files/194.ts: %AC$%dflt$%dflt$4.to>
      %9 = %8.<@%unk/%unk: .be>
      return"];
}
subgraph "cluster_@ts_files/194.ts: %dflt.%AM110$%AM108$%AM0()" {
  label="@ts_files/194.ts: %dflt.%AM110$%AM108$%AM0()";
  Node30390 [label="id:0
      this = this: @ts_files/194.ts: %dflt
      %0 = roomAdapter.<@%unk/%unk: .getFederatedRoomByExternalId>
      instanceinvoke %0.<@%unk/%unk: .resolves()>(room)
      %1 = userAdapter.<@%unk/%unk: .getFederatedUserByExternalId>
      instanceinvoke %1.<@%unk/%unk: .resolves()>(undefined)
      %2 = new @ts_files/194.ts: %AC$%dflt$%AM110$%AM108$%AM0$209
      instanceinvoke %2.<@ts_files/194.ts: %AC$%dflt$%AM110$%AM108$%AM0$209.constructor()>()
      %3 = <@ts_files/194.ts: %AC$%dflt$%AM110$%AM108$%AM0$209>%2
      %4 = instanceinvoke service.<@%unk/%unk: .onChangeRoomPowerLevels()>(%3)
      %5 = await %4
      %6 = roomAdapter.<@%unk/%unk: .applyRoomRolesToUser>
      %7 = %6.<@%unk/%unk: .called>
      %8 = staticinvoke <@%unk/%unk: .expect()>(%7)
      %9 = %8.<@%unk/%unk: .to>
      %10 = %9.<@%unk/%unk: .be>
      return"];
}
subgraph "cluster_@ts_files/194.ts: %dflt.%AM111$%AM108$%AM0()" {
  label="@ts_files/194.ts: %dflt.%AM111$%AM108$%AM0()";
  Node30400 [label="id:0
      this = this: @ts_files/194.ts: %dflt
      %0 = roomAdapter.<@%unk/%unk: .getFederatedRoomByExternalId>
      instanceinvoke %0.<@%unk/%unk: .resolves()>(room)
      %1 = userAdapter.<@%unk/%unk: .getFederatedUserByExternalId>
      instanceinvoke %1.<@%unk/%unk: .resolves()>(user)
      %2 = newarray (any)[0]
      %3 = userAdapter.<@%unk/%unk: .getFederatedUsersByExternalIds>
      instanceinvoke %3.<@%unk/%unk: .resolves()>(%2)
      %4 = new @ts_files/194.ts: %AC$%dflt$%AM111$%AM108$%AM0$210
      instanceinvoke %4.<@ts_files/194.ts: %AC$%dflt$%AM111$%AM108$%AM0$210.constructor()>()
      %5 = <@ts_files/194.ts: %AC$%dflt$%AM111$%AM108$%AM0$210>%4
      %6 = instanceinvoke service.<@%unk/%unk: .onChangeRoomPowerLevels()>(%5)
      %7 = await %6
      %8 = roomAdapter.<@%unk/%unk: .applyRoomRolesToUser>
      %9 = %8.<@%unk/%unk: .called>
      %10 = staticinvoke <@%unk/%unk: .expect()>(%9)
      %11 = %10.<@%unk/%unk: .to>
      %12 = %11.<@%unk/%unk: .be>
      return"];
}
subgraph "cluster_@ts_files/194.ts: %dflt.%AM112$%AM108$%AM0()" {
  label="@ts_files/194.ts: %dflt.%AM112$%AM108$%AM0()";
  Node30410 [label="id:0
      this = this: @ts_files/194.ts: %dflt
      %0 = roomAdapter.<@%unk/%unk: .getFederatedRoomByExternalId>
      instanceinvoke %0.<@%unk/%unk: .resolves()>(room)
      %1 = userAdapter.<@%unk/%unk: .getFederatedUserByExternalId>
      instanceinvoke %1.<@%unk/%unk: .resolves()>(user)
      %2 = newarray (unknown)[1]
      %2[0] = user
      %3 = userAdapter.<@%unk/%unk: .getFederatedUsersByExternalIds>
      instanceinvoke %3.<@%unk/%unk: .resolves()>(%2)
      %4 = new @ts_files/194.ts: %AC$%dflt$%AM112$%AM108$%AM0$211
      instanceinvoke %4.<@ts_files/194.ts: %AC$%dflt$%AM112$%AM108$%AM0$211.constructor()>()
      %5 = <@ts_files/194.ts: %AC$%dflt$%AM112$%AM108$%AM0$211>%4
      %6 = instanceinvoke service.<@%unk/%unk: .onChangeRoomPowerLevels()>(%5)
      %7 = await %6
      %8 = new @ts_files/194.ts: %AC$%dflt$%AM112$%AM108$%AM0$214
      instanceinvoke %8.<@ts_files/194.ts: %AC$%dflt$%AM112$%AM108$%AM0$214.constructor()>()
      %9 = roomAdapter.<@%unk/%unk: .applyRoomRolesToUser>
      %10 = instanceinvoke %9.<@%unk/%unk: .calledWith()>(%8)
      %11 = staticinvoke <@%unk/%unk: .expect()>(%10)
      %12 = %11.<@%unk/%unk: .to>
      %13 = %12.<@%unk/%unk: .be>
      return"];
}
subgraph "cluster_@ts_files/194.ts: %dflt.%AM113$%AM108$%AM0()" {
  label="@ts_files/194.ts: %dflt.%AM113$%AM108$%AM0()";
  Node30420 [label="id:0
      this = this: @ts_files/194.ts: %dflt
      %0 = roomAdapter.<@%unk/%unk: .getFederatedRoomByExternalId>
      instanceinvoke %0.<@%unk/%unk: .resolves()>(room)
      %1 = userAdapter.<@%unk/%unk: .getFederatedUserByExternalId>
      instanceinvoke %1.<@%unk/%unk: .resolves()>(user)
      %2 = newarray (unknown)[1]
      %2[0] = user
      %3 = userAdapter.<@%unk/%unk: .getFederatedUsersByExternalIds>
      instanceinvoke %3.<@%unk/%unk: .resolves()>(%2)
      %4 = new @ts_files/194.ts: %AC$%dflt$%AM113$%AM108$%AM0$215
      instanceinvoke %4.<@ts_files/194.ts: %AC$%dflt$%AM113$%AM108$%AM0$215.constructor()>()
      %5 = <@ts_files/194.ts: %AC$%dflt$%AM113$%AM108$%AM0$215>%4
      %6 = instanceinvoke service.<@%unk/%unk: .onChangeRoomPowerLevels()>(%5)
      %7 = await %6
      %8 = new @ts_files/194.ts: %AC$%dflt$%AM113$%AM108$%AM0$218
      instanceinvoke %8.<@ts_files/194.ts: %AC$%dflt$%AM113$%AM108$%AM0$218.constructor()>()
      %9 = roomAdapter.<@%unk/%unk: .applyRoomRolesToUser>
      %10 = instanceinvoke %9.<@%unk/%unk: .calledWith()>(%8)
      %11 = staticinvoke <@%unk/%unk: .expect()>(%10)
      %12 = %11.<@%unk/%unk: .to>
      %13 = %12.<@%unk/%unk: .be>
      return"];
}
subgraph "cluster_@ts_files/194.ts: %dflt.%AM108$%AM0()" {
  label="@ts_files/194.ts: %dflt.%AM108$%AM0()";
  Node26780 [label="id:0
      this = this: @ts_files/194.ts: %dflt
      %0 = new @ts_files/194.ts: %AC$%dflt$%AM108$%AM0$207
      instanceinvoke %0.<@ts_files/194.ts: %AC$%dflt$%AM108$%AM0$207.constructor()>()
      user = instanceinvoke FederatedUser.<@%unk/%unk: .createInstance()>('externalUserId', %0)
      %1 = RoomType.<@%unk/%unk: .CHANNEL>
      room = instanceinvoke FederatedRoom.<@%unk/%unk: .createInstance()>('externalRoomId', 'normalizedRoomId', user, %1, 'externalRoomName')
      staticinvoke <@%unk/%unk: .it()>('should NOT update the room roles if the room does not exists', %AM109$%AM108$%AM0)
      staticinvoke <@%unk/%unk: .it()>('should NOT update the room roles if the user does not exists', %AM110$%AM108$%AM0)
      staticinvoke <@%unk/%unk: .it()>('should NOT update the room roles if there is no target users', %AM111$%AM108$%AM0)
      staticinvoke <@%unk/%unk: .it()>('should update the room roles adding one role to be added', %AM112$%AM108$%AM0)
      staticinvoke <@%unk/%unk: .it()>('should update the room roles adding one role to be removed', %AM113$%AM108$%AM0)
      return"];
}
subgraph "cluster_@ts_files/194.ts: %dflt.%AM115$%AM114$%AM0()" {
  label="@ts_files/194.ts: %dflt.%AM115$%AM114$%AM0()";
  Node30410 [label="id:0
      this = this: @ts_files/194.ts: %dflt
      %0 = new @ts_files/194.ts: %AC$%dflt$%AM115$%AM114$%AM0$219
      instanceinvoke %0.<@ts_files/194.ts: %AC$%dflt$%AM115$%AM114$%AM0$219.constructor()>()
      %1 = <@ts_files/194.ts: %AC$%dflt$%AM115$%AM114$%AM0$219>%0
      %2 = instanceinvoke service.<@%unk/%unk: .onExternalThreadedMessageReceived()>(%1)
      %3 = await %2
      %4 = messageAdapter.<@%unk/%unk: .sendThreadMessage>
      %5 = %4.<@ts_files/194.ts: %AC$%dflt$%dflt$2.called>
      %6 = staticinvoke <@%unk/%unk: .expect()>(%5)
      %7 = %6.<@%unk/%unk: .to>
      %8 = %7.<@ts_files/194.ts: %AC$%dflt$%dflt$4.be>
      %9 = messageAdapter.<@%unk/%unk: .sendThreadQuoteMessage>
      %10 = %9.<@%unk/%unk: .called>
      %11 = staticinvoke <@%unk/%unk: .expect()>(%10)
      %12 = %11.<@%unk/%unk: .to>
      %13 = %12.<@%unk/%unk: .be>
      return"];
}
subgraph "cluster_@ts_files/194.ts: %dflt.%AM116$%AM114$%AM0()" {
  label="@ts_files/194.ts: %dflt.%AM116$%AM114$%AM0()";
  Node30420 [label="id:0
      this = this: @ts_files/194.ts: %dflt
      %0 = messageAdapter.<@%unk/%unk: .getMessageByFederationId>
      instanceinvoke %0.<@%unk/%unk: .resolves()>(undefined)
      %1 = new @ts_files/194.ts: %AC$%dflt$%AM116$%AM114$%AM0$220
      instanceinvoke %1.<@ts_files/194.ts: %AC$%dflt$%AM116$%AM114$%AM0$220.constructor()>()
      %2 = <@ts_files/194.ts: %AC$%dflt$%AM116$%AM114$%AM0$220>%1
      %3 = instanceinvoke service.<@%unk/%unk: .onExternalThreadedMessageReceived()>(%2)
      %4 = await %3
      %5 = messageAdapter.<@%unk/%unk: .sendThreadMessage>
      %6 = %5.<@%unk/%unk: .called>
      %7 = staticinvoke <@%unk/%unk: .expect()>(%6)
      %8 = %7.<@ts_files/194.ts: %AC$%dflt$%dflt$4.to>
      %9 = %8.<@%unk/%unk: .be>
      %10 = messageAdapter.<@%unk/%unk: .sendThreadQuoteMessage>
      %11 = %10.<@%unk/%unk: .called>
      %12 = staticinvoke <@%unk/%unk: .expect()>(%11)
      %13 = %12.<@%unk/%unk: .to>
      %14 = %13.<@%unk/%unk: .be>
      return"];
}
subgraph "cluster_@ts_files/194.ts: %dflt.%AM117$%AM114$%AM0()" {
  label="@ts_files/194.ts: %dflt.%AM117$%AM114$%AM0()";
  Node30430 [label="id:0
      this = this: @ts_files/194.ts: %dflt
      %0 = new @ts_files/194.ts: %AC$%dflt$%AM117$%AM114$%AM0$222
      instanceinvoke %0.<@ts_files/194.ts: %AC$%dflt$%AM117$%AM114$%AM0$222.constructor()>()
      %1 = messageAdapter.<@%unk/%unk: .getMessageByFederationId>
      instanceinvoke %1.<@%unk/%unk: .resolves()>(%0)
      %2 = roomAdapter.<@%unk/%unk: .getFederatedRoomByExternalId>
      instanceinvoke %2.<@%unk/%unk: .resolves()>(undefined)
      %3 = new @ts_files/194.ts: %AC$%dflt$%AM117$%AM114$%AM0$223
      instanceinvoke %3.<@ts_files/194.ts: %AC$%dflt$%AM117$%AM114$%AM0$223.constructor()>()
      %4 = <@ts_files/194.ts: %AC$%dflt$%AM117$%AM114$%AM0$223>%3
      %5 = instanceinvoke service.<@%unk/%unk: .onExternalThreadedMessageReceived()>(%4)
      %6 = await %5
      %7 = messageAdapter.<@%unk/%unk: .sendThreadQuoteMessage>
      %8 = %7.<@ts_files/194.ts: %AC$%dflt$%dflt$4.called>
      %9 = staticinvoke <@%unk/%unk: .expect()>(%8)
      %10 = %9.<@%unk/%unk: .to>
      %11 = %10.<@%unk/%unk: .be>
      %12 = messageAdapter.<@%unk/%unk: .sendThreadMessage>
      %13 = %12.<@%unk/%unk: .called>
      %14 = staticinvoke <@%unk/%unk: .expect()>(%13)
      %15 = %14.<@%unk/%unk: .to>
      %16 = %15.<@%unk/%unk: .be>
      return"];
}
subgraph "cluster_@ts_files/194.ts: %dflt.%AM118$%AM114$%AM0()" {
  label="@ts_files/194.ts: %dflt.%AM118$%AM114$%AM0()";
  Node30440 [label="id:0
      this = this: @ts_files/194.ts: %dflt
      %0 = new @ts_files/194.ts: %AC$%dflt$%AM118$%AM114$%AM0$225
      instanceinvoke %0.<@ts_files/194.ts: %AC$%dflt$%AM118$%AM114$%AM0$225.constructor()>()
      %1 = messageAdapter.<@%unk/%unk: .getMessageByFederationId>
      instanceinvoke %1.<@%unk/%unk: .resolves()>(%0)
      %2 = new @ts_files/194.ts: %AC$%dflt$%AM118$%AM114$%AM0$226
      instanceinvoke %2.<@ts_files/194.ts: %AC$%dflt$%AM118$%AM114$%AM0$226.constructor()>()
      %3 = <@ts_files/194.ts: %AC$%dflt$%AM118$%AM114$%AM0$226>%2
      %4 = roomAdapter.<@%unk/%unk: .getFederatedRoomByExternalId>
      instanceinvoke %4.<@%unk/%unk: .resolves()>(%3)
      %5 = userAdapter.<@%unk/%unk: .getFederatedUserByExternalId>
      instanceinvoke %5.<@%unk/%unk: .resolves()>(undefined)
      %6 = new @ts_files/194.ts: %AC$%dflt$%AM118$%AM114$%AM0$227
      instanceinvoke %6.<@ts_files/194.ts: %AC$%dflt$%AM118$%AM114$%AM0$227.constructor()>()
      %7 = <@ts_files/194.ts: %AC$%dflt$%AM118$%AM114$%AM0$227>%6
      %8 = instanceinvoke service.<@%unk/%unk: .onExternalThreadedMessageReceived()>(%7)
      %9 = await %8
      %10 = messageAdapter.<@%unk/%unk: .sendThreadQuoteMessage>
      %11 = %10.<@%unk/%unk: .called>
      %12 = staticinvoke <@%unk/%unk: .expect()>(%11)
      %13 = %12.<@%unk/%unk: .to>
      %14 = %13.<@%unk/%unk: .be>
      %15 = messageAdapter.<@%unk/%unk: .sendThreadMessage>
      %16 = %15.<@%unk/%unk: .called>
      %17 = staticinvoke <@%unk/%unk: .expect()>(%16)
      %18 = %17.<@%unk/%unk: .to>
      %19 = %18.<@%unk/%unk: .be>
      return"];
}
subgraph "cluster_@ts_files/194.ts: %dflt.%AM119$%AM114$%AM0()" {
  label="@ts_files/194.ts: %dflt.%AM119$%AM114$%AM0()";
  Node30450 [label="id:0
      this = this: @ts_files/194.ts: %dflt
      %0 = new @ts_files/194.ts: %AC$%dflt$%AM119$%AM114$%AM0$229
      instanceinvoke %0.<@ts_files/194.ts: %AC$%dflt$%AM119$%AM114$%AM0$229.constructor()>()
      %1 = <@ts_files/194.ts: %AC$%dflt$%AM119$%AM114$%AM0$229>%0
      %2 = roomAdapter.<@%unk/%unk: .getFederatedRoomByExternalId>
      instanceinvoke %2.<@%unk/%unk: .resolves()>(%1)
      %3 = new @ts_files/194.ts: %AC$%dflt$%AM119$%AM114$%AM0$230
      instanceinvoke %3.<@ts_files/194.ts: %AC$%dflt$%AM119$%AM114$%AM0$230.constructor()>()
      %4 = <@ts_files/194.ts: %AC$%dflt$%AM119$%AM114$%AM0$230>%3
      %5 = userAdapter.<@%unk/%unk: .getFederatedUserByExternalId>
      instanceinvoke %5.<@%unk/%unk: .resolves()>(%4)
      %6 = new @ts_files/194.ts: %AC$%dflt$%AM119$%AM114$%AM0$231
      instanceinvoke %6.<@ts_files/194.ts: %AC$%dflt$%AM119$%AM114$%AM0$231.constructor()>()
      %7 = <@ts_files/194.ts: %AC$%dflt$%AM119$%AM114$%AM0$231>%6
      %8 = messageAdapter.<@%unk/%unk: .getMessageByFederationId>
      instanceinvoke %8.<@%unk/%unk: .resolves()>(%7)
      %9 = new @ts_files/194.ts: %AC$%dflt$%AM119$%AM114$%AM0$232
      instanceinvoke %9.<@ts_files/194.ts: %AC$%dflt$%AM119$%AM114$%AM0$232.constructor()>()
      %10 = <@ts_files/194.ts: %AC$%dflt$%AM119$%AM114$%AM0$232>%9
      %11 = instanceinvoke service.<@%unk/%unk: .onExternalThreadedMessageReceived()>(%10)
      %12 = await %11
      %13 = messageAdapter.<@%unk/%unk: .sendThreadQuoteMessage>
      %14 = %13.<@%unk/%unk: .called>
      %15 = staticinvoke <@%unk/%unk: .expect()>(%14)
      %16 = %15.<@%unk/%unk: .to>
      %17 = %16.<@%unk/%unk: .be>
      %18 = messageAdapter.<@%unk/%unk: .sendThreadMessage>
      %19 = %18.<@%unk/%unk: .called>
      %20 = staticinvoke <@%unk/%unk: .expect()>(%19)
      %21 = %20.<@%unk/%unk: .to>
      %22 = %21.<@%unk/%unk: .be>
      return"];
}
subgraph "cluster_@ts_files/194.ts: %dflt.%AM120$%AM114$%AM0()" {
  label="@ts_files/194.ts: %dflt.%AM120$%AM114$%AM0()";
  Node30370 [label="id:0
      this = this: @ts_files/194.ts: %dflt
      %0 = new @ts_files/194.ts: %AC$%dflt$%AM120$%AM114$%AM0$234
      instanceinvoke %0.<@ts_files/194.ts: %AC$%dflt$%AM120$%AM114$%AM0$234.constructor()>()
      %1 = <@ts_files/194.ts: %AC$%dflt$%AM120$%AM114$%AM0$234>%0
      %2 = roomAdapter.<@%unk/%unk: .getFederatedRoomByExternalId>
      instanceinvoke %2.<@%unk/%unk: .resolves()>(%1)
      %3 = new @ts_files/194.ts: %AC$%dflt$%AM120$%AM114$%AM0$235
      instanceinvoke %3.<@ts_files/194.ts: %AC$%dflt$%AM120$%AM114$%AM0$235.constructor()>()
      %4 = <@ts_files/194.ts: %AC$%dflt$%AM120$%AM114$%AM0$235>%3
      %5 = userAdapter.<@%unk/%unk: .getFederatedUserByExternalId>
      instanceinvoke %5.<@%unk/%unk: .resolves()>(%4)
      %6 = new @ts_files/194.ts: %AC$%dflt$%AM120$%AM114$%AM0$236
      instanceinvoke %6.<@ts_files/194.ts: %AC$%dflt$%AM120$%AM114$%AM0$236.constructor()>()
      %7 = messageAdapter.<@%unk/%unk: .getMessageByFederationId>
      %8 = instanceinvoke %7.<@%unk/%unk: .onFirstCall()>()
      instanceinvoke %8.<@%unk/%unk: .resolves()>(%6)
      %9 = roomAdapter.<@%unk/%unk: .getFederatedRoomByExternalId>
      %10 = instanceinvoke %9.<@%unk/%unk: .onSecondCall()>()
      instanceinvoke %10.<@%unk/%unk: .resolves()>(undefined)
      %11 = new @ts_files/194.ts: %AC$%dflt$%AM120$%AM114$%AM0$237
      instanceinvoke %11.<@ts_files/194.ts: %AC$%dflt$%AM120$%AM114$%AM0$237.constructor()>()
      %12 = <@ts_files/194.ts: %AC$%dflt$%AM120$%AM114$%AM0$237>%11
      %13 = instanceinvoke service.<@%unk/%unk: .onExternalThreadedMessageReceived()>(%12)
      %14 = await %13
      %15 = new @ts_files/194.ts: %AC$%dflt$%AM120$%AM114$%AM0$239
      instanceinvoke %15.<@ts_files/194.ts: %AC$%dflt$%AM120$%AM114$%AM0$239.constructor()>()
      %16 = new @ts_files/194.ts: %AC$%dflt$%AM120$%AM114$%AM0$240
      instanceinvoke %16.<@ts_files/194.ts: %AC$%dflt$%AM120$%AM114$%AM0$240.constructor()>()
      %17 = messageAdapter.<@%unk/%unk: .sendThreadMessage>
      %18 = instanceinvoke %17.<@%unk/%unk: .calledWith()>(%15, %16, 'rawMessage', 'externalEventId', 'messageThreadId', 'externalFormattedText', 'localDomain')
      %19 = staticinvoke <@%unk/%unk: .expect()>(%18)
      %20 = %19.<@%unk/%unk: .to>
      %21 = %20.<@%unk/%unk: .be>
      %22 = messageAdapter.<@%unk/%unk: .sendThreadQuoteMessage>
      %23 = %22.<@%unk/%unk: .called>
      %24 = staticinvoke <@%unk/%unk: .expect()>(%23)
      %25 = %24.<@%unk/%unk: .to>
      %26 = %25.<@%unk/%unk: .be>
      return"];
}
subgraph "cluster_@ts_files/194.ts: %dflt.%AM122$%AM121$%AM114$%AM0()" {
  label="@ts_files/194.ts: %dflt.%AM122$%AM121$%AM114$%AM0()";
  Node34020 [label="id:0
      this = this: @ts_files/194.ts: %dflt
      %0 = new @ts_files/194.ts: %AC$%dflt$%AM122$%AM121$%AM114$%AM0$241
      instanceinvoke %0.<@ts_files/194.ts: %AC$%dflt$%AM122$%AM121$%AM114$%AM0$241.constructor()>()
      %1 = messageAdapter.<@%unk/%unk: .getMessageByFederationId>
      %2 = instanceinvoke %1.<@%unk/%unk: .onFirstCall()>()
      instanceinvoke %2.<@%unk/%unk: .resolves()>(%0)
      %3 = roomAdapter.<@%unk/%unk: .getFederatedRoomByExternalId>
      %4 = instanceinvoke %3.<@%unk/%unk: .onSecondCall()>()
      instanceinvoke %4.<@%unk/%unk: .resolves()>(undefined)
      %5 = roomAdapter.<@%unk/%unk: .getFederatedRoomByExternalId>
      %6 = instanceinvoke %5.<@%unk/%unk: .onThirdCall()>()
      instanceinvoke %6.<@%unk/%unk: .resolves()>(undefined)
      %7 = new @ts_files/194.ts: %AC$%dflt$%AM122$%AM121$%AM114$%AM0$242
      instanceinvoke %7.<@ts_files/194.ts: %AC$%dflt$%AM122$%AM121$%AM114$%AM0$242.constructor()>()
      %8 = <@ts_files/194.ts: %AC$%dflt$%AM122$%AM121$%AM114$%AM0$242>%7
      %9 = roomAdapter.<@%unk/%unk: .getFederatedRoomByExternalId>
      instanceinvoke %9.<@%unk/%unk: .resolves()>(%8)
      %10 = new @ts_files/194.ts: %AC$%dflt$%AM122$%AM121$%AM114$%AM0$243
      instanceinvoke %10.<@ts_files/194.ts: %AC$%dflt$%AM122$%AM121$%AM114$%AM0$243.constructor()>()
      %11 = <@ts_files/194.ts: %AC$%dflt$%AM122$%AM121$%AM114$%AM0$243>%10
      %12 = userAdapter.<@%unk/%unk: .getFederatedUserByExternalId>
      instanceinvoke %12.<@%unk/%unk: .resolves()>(%11)
      %13 = messageAdapter.<@%unk/%unk: .getMessageByFederationId>
      instanceinvoke %13.<@%unk/%unk: .resolves()>(undefined)
      %14 = new @ts_files/194.ts: %AC$%dflt$%AM122$%AM121$%AM114$%AM0$244
      instanceinvoke %14.<@ts_files/194.ts: %AC$%dflt$%AM122$%AM121$%AM114$%AM0$244.constructor()>()
      %15 = <@ts_files/194.ts: %AC$%dflt$%AM122$%AM121$%AM114$%AM0$244>%14
      %16 = instanceinvoke service.<@%unk/%unk: .onExternalThreadedMessageReceived()>(%15)
      %17 = await %16
      %18 = messageAdapter.<@%unk/%unk: .sendThreadQuoteMessage>
      %19 = %18.<@%unk/%unk: .called>
      %20 = staticinvoke <@%unk/%unk: .expect()>(%19)
      %21 = %20.<@%unk/%unk: .to>
      %22 = %21.<@%unk/%unk: .be>
      %23 = messageAdapter.<@%unk/%unk: .sendThreadMessage>
      %24 = %23.<@%unk/%unk: .called>
      %25 = staticinvoke <@%unk/%unk: .expect()>(%24)
      %26 = %25.<@%unk/%unk: .to>
      %27 = %26.<@%unk/%unk: .be>
      return"];
}
subgraph "cluster_@ts_files/194.ts: %dflt.%AM123$%AM121$%AM114$%AM0()" {
  label="@ts_files/194.ts: %dflt.%AM123$%AM121$%AM114$%AM0()";
  Node34030 [label="id:0
      this = this: @ts_files/194.ts: %dflt
      %0 = new @ts_files/194.ts: %AC$%dflt$%AM123$%AM121$%AM114$%AM0$246
      instanceinvoke %0.<@ts_files/194.ts: %AC$%dflt$%AM123$%AM121$%AM114$%AM0$246.constructor()>()
      %1 = messageAdapter.<@%unk/%unk: .getMessageByFederationId>
      %2 = instanceinvoke %1.<@%unk/%unk: .onFirstCall()>()
      instanceinvoke %2.<@%unk/%unk: .resolves()>(%0)
      %3 = new @ts_files/194.ts: %AC$%dflt$%AM123$%AM121$%AM114$%AM0$247
      instanceinvoke %3.<@ts_files/194.ts: %AC$%dflt$%AM123$%AM121$%AM114$%AM0$247.constructor()>()
      %4 = <@ts_files/194.ts: %AC$%dflt$%AM123$%AM121$%AM114$%AM0$247>%3
      %5 = roomAdapter.<@%unk/%unk: .getFederatedRoomByExternalId>
      instanceinvoke %5.<@%unk/%unk: .resolves()>(%4)
      %6 = new @ts_files/194.ts: %AC$%dflt$%AM123$%AM121$%AM114$%AM0$248
      instanceinvoke %6.<@ts_files/194.ts: %AC$%dflt$%AM123$%AM121$%AM114$%AM0$248.constructor()>()
      %7 = <@ts_files/194.ts: %AC$%dflt$%AM123$%AM121$%AM114$%AM0$248>%6
      %8 = userAdapter.<@%unk/%unk: .getFederatedUserByExternalId>
      instanceinvoke %8.<@%unk/%unk: .resolves()>(%7)
      %9 = messageAdapter.<@%unk/%unk: .getMessageByFederationId>
      %10 = instanceinvoke %9.<@%unk/%unk: .onSecondCall()>()
      instanceinvoke %10.<@%unk/%unk: .resolves()>(undefined)
      %11 = new @ts_files/194.ts: %AC$%dflt$%AM123$%AM121$%AM114$%AM0$249
      instanceinvoke %11.<@ts_files/194.ts: %AC$%dflt$%AM123$%AM121$%AM114$%AM0$249.constructor()>()
      %12 = <@ts_files/194.ts: %AC$%dflt$%AM123$%AM121$%AM114$%AM0$249>%11
      %13 = messageAdapter.<@%unk/%unk: .getMessageByFederationId>
      %14 = instanceinvoke %13.<@%unk/%unk: .onThirdCall()>()
      instanceinvoke %14.<@%unk/%unk: .resolves()>(%12)
      %15 = new @ts_files/194.ts: %AC$%dflt$%AM123$%AM121$%AM114$%AM0$250
      instanceinvoke %15.<@ts_files/194.ts: %AC$%dflt$%AM123$%AM121$%AM114$%AM0$250.constructor()>()
      %16 = <@ts_files/194.ts: %AC$%dflt$%AM123$%AM121$%AM114$%AM0$250>%15
      %17 = instanceinvoke service.<@%unk/%unk: .onExternalThreadedMessageReceived()>(%16)
      %18 = await %17
      %19 = new @ts_files/194.ts: %AC$%dflt$%AM123$%AM121$%AM114$%AM0$252
      instanceinvoke %19.<@ts_files/194.ts: %AC$%dflt$%AM123$%AM121$%AM114$%AM0$252.constructor()>()
      %20 = new @ts_files/194.ts: %AC$%dflt$%AM123$%AM121$%AM114$%AM0$253
      instanceinvoke %20.<@ts_files/194.ts: %AC$%dflt$%AM123$%AM121$%AM114$%AM0$253.constructor()>()
      %21 = new @ts_files/194.ts: %AC$%dflt$%AM123$%AM121$%AM114$%AM0$254
      instanceinvoke %21.<@ts_files/194.ts: %AC$%dflt$%AM123$%AM121$%AM114$%AM0$254.constructor()>()
      %22 = messageAdapter.<@%unk/%unk: .sendThreadQuoteMessage>
      %23 = instanceinvoke %22.<@%unk/%unk: .calledWith()>(%19, %20, 'rawMessage', 'externalEventId', %21, 'localDomain', 'messageThreadId', 'externalFormattedText')
      %24 = staticinvoke <@%unk/%unk: .expect()>(%23)
      %25 = %24.<@%unk/%unk: .to>
      %26 = %25.<@%unk/%unk: .be>
      %27 = messageAdapter.<@%unk/%unk: .sendThreadMessage>
      %28 = %27.<@%unk/%unk: .called>
      %29 = staticinvoke <@%unk/%unk: .expect()>(%28)
      %30 = %29.<@%unk/%unk: .to>
      %31 = %30.<@%unk/%unk: .be>
      return"];
}
subgraph "cluster_@ts_files/194.ts: %dflt.%AM121$%AM114$%AM0()" {
  label="@ts_files/194.ts: %dflt.%AM121$%AM114$%AM0()";
  Node30380 [label="id:0
      this = this: @ts_files/194.ts: %dflt
      staticinvoke <@%unk/%unk: .it()>('should NOT send a quote message if its necessary to quote but the message to quote does not exists', %AM122$%AM121$%AM114$%AM0)
      staticinvoke <@%unk/%unk: .it()>('should send a quote message if its necessary to quote and the message to quote exists', %AM123$%AM121$%AM114$%AM0)
      return"];
}
subgraph "cluster_@ts_files/194.ts: %dflt.%AM114$%AM0()" {
  label="@ts_files/194.ts: %dflt.%AM114$%AM0()";
  Node26750 [label="id:0
      this = this: @ts_files/194.ts: %dflt
      staticinvoke <@%unk/%unk: .it()>('should NOT send a message if the thread root event id does not exist', %AM115$%AM114$%AM0)
      staticinvoke <@%unk/%unk: .it()>('should NOT send a message if the internal thread parent message does not exist', %AM116$%AM114$%AM0)
      staticinvoke <@%unk/%unk: .it()>('should NOT send a message if the room does not exists', %AM117$%AM114$%AM0)
      staticinvoke <@%unk/%unk: .it()>('should NOT send a message if the sender does not exists', %AM118$%AM114$%AM0)
      staticinvoke <@%unk/%unk: .it()>('should NOT send a message if the message was already be sent through federation and is just a reply back event', %AM119$%AM114$%AM0)
      staticinvoke <@%unk/%unk: .it()>('should send a message if the room, the sender already exists and the message does not exists, because it was sent originally from Matrix', %AM120$%AM114$%AM0)
      staticinvoke <@%unk/%unk: .describe()>('Quoting messages', %AM121$%AM114$%AM0)
      return"];
}
subgraph "cluster_@ts_files/194.ts: %dflt.%AM125$%AM124$%AM0()" {
  label="@ts_files/194.ts: %dflt.%AM125$%AM124$%AM0()";
  Node30430 [label="id:0
      this = this: @ts_files/194.ts: %dflt
      %0 = new @ts_files/194.ts: %AC$%dflt$%AM125$%AM124$%AM0$256
      instanceinvoke %0.<@ts_files/194.ts: %AC$%dflt$%AM125$%AM124$%AM0$256.constructor()>()
      %1 = <@ts_files/194.ts: %AC$%dflt$%AM125$%AM124$%AM0$256>%0
      %2 = instanceinvoke service.<@%unk/%unk: .onExternalThreadedFileMessageReceived()>(%1)
      %3 = await %2
      %4 = messageAdapter.<@%unk/%unk: .sendThreadQuoteFileMessage>
      %5 = %4.<@ts_files/194.ts: %AC$%dflt$%dflt$2.called>
      %6 = staticinvoke <@%unk/%unk: .expect()>(%5)
      %7 = %6.<@%unk/%unk: .to>
      %8 = %7.<@ts_files/194.ts: %AC$%dflt$%dflt$4.be>
      %9 = messageAdapter.<@%unk/%unk: .sendThreadFileMessage>
      %10 = %9.<@%unk/%unk: .called>
      %11 = staticinvoke <@%unk/%unk: .expect()>(%10)
      %12 = %11.<@%unk/%unk: .to>
      %13 = %12.<@%unk/%unk: .be>
      return"];
}
subgraph "cluster_@ts_files/194.ts: %dflt.%AM126$%AM124$%AM0()" {
  label="@ts_files/194.ts: %dflt.%AM126$%AM124$%AM0()";
  Node30440 [label="id:0
      this = this: @ts_files/194.ts: %dflt
      %0 = messageAdapter.<@%unk/%unk: .getMessageByFederationId>
      instanceinvoke %0.<@%unk/%unk: .resolves()>(undefined)
      %1 = new @ts_files/194.ts: %AC$%dflt$%AM126$%AM124$%AM0$257
      instanceinvoke %1.<@ts_files/194.ts: %AC$%dflt$%AM126$%AM124$%AM0$257.constructor()>()
      %2 = <@ts_files/194.ts: %AC$%dflt$%AM126$%AM124$%AM0$257>%1
      %3 = instanceinvoke service.<@%unk/%unk: .onExternalThreadedFileMessageReceived()>(%2)
      %4 = await %3
      %5 = messageAdapter.<@%unk/%unk: .sendThreadQuoteFileMessage>
      %6 = %5.<@%unk/%unk: .called>
      %7 = staticinvoke <@%unk/%unk: .expect()>(%6)
      %8 = %7.<@ts_files/194.ts: %AC$%dflt$%dflt$4.to>
      %9 = %8.<@%unk/%unk: .be>
      %10 = messageAdapter.<@%unk/%unk: .sendThreadFileMessage>
      %11 = %10.<@%unk/%unk: .called>
      %12 = staticinvoke <@%unk/%unk: .expect()>(%11)
      %13 = %12.<@%unk/%unk: .to>
      %14 = %13.<@%unk/%unk: .be>
      return"];
}
subgraph "cluster_@ts_files/194.ts: %dflt.%AM127$%AM124$%AM0()" {
  label="@ts_files/194.ts: %dflt.%AM127$%AM124$%AM0()";
  Node30450 [label="id:0
      this = this: @ts_files/194.ts: %dflt
      %0 = new @ts_files/194.ts: %AC$%dflt$%AM127$%AM124$%AM0$259
      instanceinvoke %0.<@ts_files/194.ts: %AC$%dflt$%AM127$%AM124$%AM0$259.constructor()>()
      %1 = messageAdapter.<@%unk/%unk: .getMessageByFederationId>
      instanceinvoke %1.<@%unk/%unk: .resolves()>(%0)
      %2 = roomAdapter.<@%unk/%unk: .getFederatedRoomByExternalId>
      instanceinvoke %2.<@%unk/%unk: .resolves()>(undefined)
      %3 = new @ts_files/194.ts: %AC$%dflt$%AM127$%AM124$%AM0$260
      instanceinvoke %3.<@ts_files/194.ts: %AC$%dflt$%AM127$%AM124$%AM0$260.constructor()>()
      %4 = <@ts_files/194.ts: %AC$%dflt$%AM127$%AM124$%AM0$260>%3
      %5 = instanceinvoke service.<@%unk/%unk: .onExternalThreadedFileMessageReceived()>(%4)
      %6 = await %5
      %7 = messageAdapter.<@%unk/%unk: .sendThreadQuoteFileMessage>
      %8 = %7.<@ts_files/194.ts: %AC$%dflt$%dflt$4.called>
      %9 = staticinvoke <@%unk/%unk: .expect()>(%8)
      %10 = %9.<@%unk/%unk: .to>
      %11 = %10.<@%unk/%unk: .be>
      %12 = messageAdapter.<@%unk/%unk: .sendThreadFileMessage>
      %13 = %12.<@%unk/%unk: .called>
      %14 = staticinvoke <@%unk/%unk: .expect()>(%13)
      %15 = %14.<@%unk/%unk: .to>
      %16 = %15.<@%unk/%unk: .be>
      return"];
}
subgraph "cluster_@ts_files/194.ts: %dflt.%AM128$%AM124$%AM0()" {
  label="@ts_files/194.ts: %dflt.%AM128$%AM124$%AM0()";
  Node30460 [label="id:0
      this = this: @ts_files/194.ts: %dflt
      %0 = new @ts_files/194.ts: %AC$%dflt$%AM128$%AM124$%AM0$262
      instanceinvoke %0.<@ts_files/194.ts: %AC$%dflt$%AM128$%AM124$%AM0$262.constructor()>()
      %1 = <@ts_files/194.ts: %AC$%dflt$%AM128$%AM124$%AM0$262>%0
      %2 = roomAdapter.<@%unk/%unk: .getFederatedRoomByExternalId>
      instanceinvoke %2.<@%unk/%unk: .resolves()>(%1)
      %3 = userAdapter.<@%unk/%unk: .getFederatedUserByExternalId>
      instanceinvoke %3.<@%unk/%unk: .resolves()>(undefined)
      %4 = new @ts_files/194.ts: %AC$%dflt$%AM128$%AM124$%AM0$263
      instanceinvoke %4.<@ts_files/194.ts: %AC$%dflt$%AM128$%AM124$%AM0$263.constructor()>()
      %5 = messageAdapter.<@%unk/%unk: .getMessageByFederationId>
      instanceinvoke %5.<@%unk/%unk: .resolves()>(%4)
      %6 = new @ts_files/194.ts: %AC$%dflt$%AM128$%AM124$%AM0$264
      instanceinvoke %6.<@ts_files/194.ts: %AC$%dflt$%AM128$%AM124$%AM0$264.constructor()>()
      %7 = <@ts_files/194.ts: %AC$%dflt$%AM128$%AM124$%AM0$264>%6
      %8 = instanceinvoke service.<@%unk/%unk: .onExternalThreadedFileMessageReceived()>(%7)
      %9 = await %8
      %10 = messageAdapter.<@%unk/%unk: .sendThreadQuoteFileMessage>
      %11 = %10.<@%unk/%unk: .called>
      %12 = staticinvoke <@%unk/%unk: .expect()>(%11)
      %13 = %12.<@%unk/%unk: .to>
      %14 = %13.<@%unk/%unk: .be>
      %15 = messageAdapter.<@%unk/%unk: .sendThreadFileMessage>
      %16 = %15.<@%unk/%unk: .called>
      %17 = staticinvoke <@%unk/%unk: .expect()>(%16)
      %18 = %17.<@%unk/%unk: .to>
      %19 = %18.<@%unk/%unk: .be>
      return"];
}
subgraph "cluster_@ts_files/194.ts: %dflt.%AM129$%AM124$%AM0()" {
  label="@ts_files/194.ts: %dflt.%AM129$%AM124$%AM0()";
  Node30470 [label="id:0
      this = this: @ts_files/194.ts: %dflt
      %0 = roomAdapter.<@%unk/%unk: .getFederatedRoomByExternalId>
      instanceinvoke %0.<@%unk/%unk: .resolves()>(room)
      %1 = userAdapter.<@%unk/%unk: .getFederatedUserByExternalId>
      instanceinvoke %1.<@%unk/%unk: .resolves()>(user)
      %2 = bridge.<@%unk/%unk: .getReadStreamForFileFromUrl>
      instanceinvoke %2.<@%unk/%unk: .resolves()>()
      %3 = new @ts_files/194.ts: %AC$%dflt$%AM129$%AM124$%AM0$266
      instanceinvoke %3.<@ts_files/194.ts: %AC$%dflt$%AM129$%AM124$%AM0$266.constructor()>()
      %4 = newarray (@ts_files/194.ts: %AC$%dflt$%AM129$%AM124$%AM0$266)[1]
      %4[0] = %3
      files = %4
      %5 = newarray (string)[2]
      %5[0] = 'attachment'
      %5[1] = 'attachment2'
      attachments = %5
      %6 = new @ts_files/194.ts: %AC$%dflt$%AM129$%AM124$%AM0$267
      instanceinvoke %6.<@ts_files/194.ts: %AC$%dflt$%AM129$%AM124$%AM0$267.constructor()>()
      %7 = <@ts_files/194.ts: %AC$%dflt$%AM129$%AM124$%AM0$267>%6
      %8 = fileAdapter.<@%unk/%unk: .uploadFile>
      instanceinvoke %8.<@%unk/%unk: .resolves()>(%7)
      %9 = new @ts_files/194.ts: %AC$%dflt$%AM129$%AM124$%AM0$268
      instanceinvoke %9.<@ts_files/194.ts: %AC$%dflt$%AM129$%AM124$%AM0$268.constructor()>()
      %10 = messageAdapter.<@%unk/%unk: .getMessageByFederationId>
      %11 = instanceinvoke %10.<@%unk/%unk: .onFirstCall()>()
      instanceinvoke %11.<@%unk/%unk: .resolves()>(%9)
      %12 = messageAdapter.<@%unk/%unk: .getMessageByFederationId>
      %13 = instanceinvoke %12.<@%unk/%unk: .onSecondCall()>()
      instanceinvoke %13.<@%unk/%unk: .resolves()>(undefined)
      %14 = new @ts_files/194.ts: %AC$%dflt$%AM129$%AM124$%AM0$269
      instanceinvoke %14.<@ts_files/194.ts: %AC$%dflt$%AM129$%AM124$%AM0$269.constructor()>()
      %15 = <@ts_files/194.ts: %AC$%dflt$%AM129$%AM124$%AM0$269>%14
      %16 = instanceinvoke service.<@%unk/%unk: .onExternalThreadedFileMessageReceived()>(%15)
      %17 = await %16
      %18 = messageAdapter.<@%unk/%unk: .sendThreadFileMessage>
      %19 = instanceinvoke %18.<@%unk/%unk: .calledWith()>(user, room, files, attachments, 'externalEventId', 'messageThreadId')
      %20 = staticinvoke <@%unk/%unk: .expect()>(%19)
      %21 = %20.<@%unk/%unk: .to>
      %22 = %21.<@%unk/%unk: .be>
      %23 = messageAdapter.<@%unk/%unk: .sendThreadQuoteFileMessage>
      %24 = %23.<@%unk/%unk: .called>
      %25 = staticinvoke <@%unk/%unk: .expect()>(%24)
      %26 = %25.<@%unk/%unk: .to>
      %27 = %26.<@%unk/%unk: .be>
      return"];
}
subgraph "cluster_@ts_files/194.ts: %dflt.%AM131$%AM130$%AM124$%AM0()" {
  label="@ts_files/194.ts: %dflt.%AM131$%AM130$%AM124$%AM0()";
  Node34030 [label="id:0
      this = this: @ts_files/194.ts: %dflt
      %0 = roomAdapter.<@%unk/%unk: .getFederatedRoomByExternalId>
      instanceinvoke %0.<@%unk/%unk: .resolves()>(room)
      %1 = userAdapter.<@%unk/%unk: .getFederatedUserByExternalId>
      instanceinvoke %1.<@%unk/%unk: .resolves()>(user)
      %2 = messageAdapter.<@%unk/%unk: .getMessageByFederationId>
      instanceinvoke %2.<@%unk/%unk: .resolves()>(undefined)
      %3 = new @ts_files/194.ts: %AC$%dflt$%AM131$%AM130$%AM124$%AM0$272
      instanceinvoke %3.<@ts_files/194.ts: %AC$%dflt$%AM131$%AM130$%AM124$%AM0$272.constructor()>()
      %4 = <@ts_files/194.ts: %AC$%dflt$%AM131$%AM130$%AM124$%AM0$272>%3
      %5 = fileAdapter.<@%unk/%unk: .uploadFile>
      instanceinvoke %5.<@%unk/%unk: .resolves()>(%4)
      %6 = new @ts_files/194.ts: %AC$%dflt$%AM131$%AM130$%AM124$%AM0$273
      instanceinvoke %6.<@ts_files/194.ts: %AC$%dflt$%AM131$%AM130$%AM124$%AM0$273.constructor()>()
      %7 = messageAdapter.<@%unk/%unk: .getMessageByFederationId>
      %8 = instanceinvoke %7.<@%unk/%unk: .onFirstCall()>()
      instanceinvoke %8.<@%unk/%unk: .resolves()>(%6)
      %9 = messageAdapter.<@%unk/%unk: .getMessageByFederationId>
      %10 = instanceinvoke %9.<@%unk/%unk: .onSecondCall()>()
      instanceinvoke %10.<@%unk/%unk: .resolves()>(undefined)
      %11 = messageAdapter.<@%unk/%unk: .getMessageByFederationId>
      %12 = instanceinvoke %11.<@%unk/%unk: .onThirdCall()>()
      instanceinvoke %12.<@%unk/%unk: .resolves()>(undefined)
      %13 = new @ts_files/194.ts: %AC$%dflt$%AM131$%AM130$%AM124$%AM0$274
      instanceinvoke %13.<@ts_files/194.ts: %AC$%dflt$%AM131$%AM130$%AM124$%AM0$274.constructor()>()
      %14 = <@ts_files/194.ts: %AC$%dflt$%AM131$%AM130$%AM124$%AM0$274>%13
      %15 = instanceinvoke service.<@%unk/%unk: .onExternalThreadedFileMessageReceived()>(%14)
      %16 = await %15
      %17 = messageAdapter.<@%unk/%unk: .sendThreadQuoteFileMessage>
      %18 = %17.<@%unk/%unk: .called>
      %19 = staticinvoke <@%unk/%unk: .expect()>(%18)
      %20 = %19.<@%unk/%unk: .to>
      %21 = %20.<@%unk/%unk: .be>
      %22 = messageAdapter.<@%unk/%unk: .sendThreadFileMessage>
      %23 = %22.<@%unk/%unk: .called>
      %24 = staticinvoke <@%unk/%unk: .expect()>(%23)
      %25 = %24.<@%unk/%unk: .to>
      %26 = %25.<@%unk/%unk: .be>
      return"];
}
subgraph "cluster_@ts_files/194.ts: %dflt.%AM132$%AM130$%AM124$%AM0()" {
  label="@ts_files/194.ts: %dflt.%AM132$%AM130$%AM124$%AM0()";
  Node34040 [label="id:0
      this = this: @ts_files/194.ts: %dflt
      %0 = new @ts_files/194.ts: %AC$%dflt$%AM132$%AM130$%AM124$%AM0$277
      instanceinvoke %0.<@ts_files/194.ts: %AC$%dflt$%AM132$%AM130$%AM124$%AM0$277.constructor()>()
      messageToReplyTo = <@ts_files/194.ts: %AC$%dflt$%AM132$%AM130$%AM124$%AM0$277>%0
      %1 = roomAdapter.<@%unk/%unk: .getFederatedRoomByExternalId>
      instanceinvoke %1.<@%unk/%unk: .resolves()>(room)
      %2 = userAdapter.<@%unk/%unk: .getFederatedUserByExternalId>
      instanceinvoke %2.<@%unk/%unk: .resolves()>(user)
      %3 = new @ts_files/194.ts: %AC$%dflt$%AM132$%AM130$%AM124$%AM0$279
      instanceinvoke %3.<@ts_files/194.ts: %AC$%dflt$%AM132$%AM130$%AM124$%AM0$279.constructor()>()
      %4 = messageAdapter.<@%unk/%unk: .getMessageByFederationId>
      %5 = instanceinvoke %4.<@%unk/%unk: .onFirstCall()>()
      instanceinvoke %5.<@%unk/%unk: .resolves()>(%3)
      %6 = messageAdapter.<@%unk/%unk: .getMessageByFederationId>
      %7 = instanceinvoke %6.<@%unk/%unk: .onSecondCall()>()
      instanceinvoke %7.<@%unk/%unk: .resolves()>(undefined)
      %8 = messageAdapter.<@%unk/%unk: .getMessageByFederationId>
      %9 = instanceinvoke %8.<@%unk/%unk: .onThirdCall()>()
      instanceinvoke %9.<@%unk/%unk: .resolves()>(messageToReplyTo)
      %10 = new @ts_files/194.ts: %AC$%dflt$%AM132$%AM130$%AM124$%AM0$280
      instanceinvoke %10.<@ts_files/194.ts: %AC$%dflt$%AM132$%AM130$%AM124$%AM0$280.constructor()>()
      %11 = newarray (@ts_files/194.ts: %AC$%dflt$%AM132$%AM130$%AM124$%AM0$280)[1]
      %11[0] = %10
      files = %11
      %12 = newarray (string)[2]
      %12[0] = 'attachment'
      %12[1] = 'attachment2'
      attachments = %12
      %13 = new @ts_files/194.ts: %AC$%dflt$%AM132$%AM130$%AM124$%AM0$281
      instanceinvoke %13.<@ts_files/194.ts: %AC$%dflt$%AM132$%AM130$%AM124$%AM0$281.constructor()>()
      %14 = <@ts_files/194.ts: %AC$%dflt$%AM132$%AM130$%AM124$%AM0$281>%13
      %15 = fileAdapter.<@%unk/%unk: .uploadFile>
      instanceinvoke %15.<@%unk/%unk: .resolves()>(%14)
      %16 = new @ts_files/194.ts: %AC$%dflt$%AM132$%AM130$%AM124$%AM0$282
      instanceinvoke %16.<@ts_files/194.ts: %AC$%dflt$%AM132$%AM130$%AM124$%AM0$282.constructor()>()
      %17 = <@ts_files/194.ts: %AC$%dflt$%AM132$%AM130$%AM124$%AM0$282>%16
      %18 = instanceinvoke service.<@%unk/%unk: .onExternalThreadedFileMessageReceived()>(%17)
      %19 = await %18
      %20 = messageAdapter.<@%unk/%unk: .sendThreadQuoteFileMessage>
      %21 = instanceinvoke %20.<@%unk/%unk: .calledWith()>(user, room, files, attachments, 'externalEventId', messageToReplyTo, 'localDomain', 'messageThreadId')
      %22 = staticinvoke <@%unk/%unk: .expect()>(%21)
      %23 = %22.<@%unk/%unk: .to>
      %24 = %23.<@%unk/%unk: .be>
      %25 = messageAdapter.<@%unk/%unk: .sendThreadFileMessage>
      %26 = %25.<@%unk/%unk: .called>
      %27 = staticinvoke <@%unk/%unk: .expect()>(%26)
      %28 = %27.<@%unk/%unk: .to>
      %29 = %28.<@%unk/%unk: .be>
      return"];
}
subgraph "cluster_@ts_files/194.ts: %dflt.%AM130$%AM124$%AM0()" {
  label="@ts_files/194.ts: %dflt.%AM130$%AM124$%AM0()";
  Node30390 [label="id:0
      this = this: @ts_files/194.ts: %dflt
      staticinvoke <@%unk/%unk: .it()>('should NOT send a quote message if its necessary to quote but the message to quote does not exists', %AM131$%AM130$%AM124$%AM0)
      staticinvoke <@%unk/%unk: .it()>('should send a quote message if its necessary to quote and the message to quote exists', %AM132$%AM130$%AM124$%AM0)
      return"];
}
subgraph "cluster_@ts_files/194.ts: %dflt.%AM124$%AM0()" {
  label="@ts_files/194.ts: %dflt.%AM124$%AM0()";
  Node26760 [label="id:0
      this = this: @ts_files/194.ts: %dflt
      %0 = new @ts_files/194.ts: %AC$%dflt$%AM124$%AM0$255
      instanceinvoke %0.<@ts_files/194.ts: %AC$%dflt$%AM124$%AM0$255.constructor()>()
      user = instanceinvoke FederatedUser.<@%unk/%unk: .createInstance()>('externalInviterId', %0)
      %1 = RoomType.<@%unk/%unk: .CHANNEL>
      room = instanceinvoke FederatedRoom.<@%unk/%unk: .createInstance()>('externalRoomId', 'normalizedRoomId', user, %1, 'externalRoomName')
      staticinvoke <@%unk/%unk: .it()>('should NOT send a message if the thread root event id does not exist', %AM125$%AM124$%AM0)
      staticinvoke <@%unk/%unk: .it()>('should NOT send a message if the internal thread parent message does not exist', %AM126$%AM124$%AM0)
      staticinvoke <@%unk/%unk: .it()>('should NOT send a message if the room does not exists', %AM127$%AM124$%AM0)
      staticinvoke <@%unk/%unk: .it()>('should NOT send a message if the sender does not exists', %AM128$%AM124$%AM0)
      staticinvoke <@%unk/%unk: .it()>('should send a message if the room and the sender already exists', %AM129$%AM124$%AM0)
      staticinvoke <@%unk/%unk: .describe()>('Quoting messages', %AM130$%AM124$%AM0)
      return"];
}
subgraph "cluster_@ts_files/194.ts: %dflt.%AM0()" {
  label="@ts_files/194.ts: %dflt.%AM0()";
  Node23100 [label="id:0
      this = this: @ts_files/194.ts: %dflt
      service = undefined
      %0 = new @ts_files/194.ts: %AC$%dflt$%AM0$6
      instanceinvoke %0.<@ts_files/194.ts: %AC$%dflt$%AM0$6.constructor()>()
      roomAdapter = %0
      %1 = new @ts_files/194.ts: %AC$%dflt$%AM0$7
      instanceinvoke %1.<@ts_files/194.ts: %AC$%dflt$%AM0$7.constructor()>()
      userAdapter = %1
      %2 = new @ts_files/194.ts: %AC$%dflt$%AM0$8
      instanceinvoke %2.<@ts_files/194.ts: %AC$%dflt$%AM0$8.constructor()>()
      messageAdapter = %2
      %3 = new @ts_files/194.ts: %AC$%dflt$%AM0$9
      instanceinvoke %3.<@ts_files/194.ts: %AC$%dflt$%AM0$9.constructor()>()
      settingsAdapter = %3
      %4 = new @ts_files/194.ts: %AC$%dflt$%AM0$10
      instanceinvoke %4.<@ts_files/194.ts: %AC$%dflt$%AM0$10.constructor()>()
      notificationsAdapter = %4
      %5 = new @ts_files/194.ts: %AC$%dflt$%AM0$11
      instanceinvoke %5.<@ts_files/194.ts: %AC$%dflt$%AM0$11.constructor()>()
      fileAdapter = %5
      %6 = new @ts_files/194.ts: %AC$%dflt$%AM0$12
      instanceinvoke %6.<@ts_files/194.ts: %AC$%dflt$%AM0$12.constructor()>()
      queueInstance = %6
      %7 = new @ts_files/194.ts: %AC$%dflt$%AM0$13
      instanceinvoke %7.<@ts_files/194.ts: %AC$%dflt$%AM0$13.constructor()>()
      bridge = %7
      staticinvoke <@%unk/%unk: .beforeEach()>(%AM1$%AM0)
      staticinvoke <@%unk/%unk: .afterEach()>(%AM2$%AM0)
      staticinvoke <@%unk/%unk: .describe()>('#onCreateRoom()', %AM3$%AM0)
      staticinvoke <@%unk/%unk: .describe()>('#onChangeRoomMembership()', %AM9$%AM0)
      staticinvoke <@%unk/%unk: .describe()>('#onExternalFileMessageReceived()', %AM61$%AM0)
      staticinvoke <@%unk/%unk: .describe()>('#onExternalMessageReceived()', %AM68$%AM0)
      staticinvoke <@%unk/%unk: .describe()>('#onChangeJoinRules()', %AM76$%AM0)
      staticinvoke <@%unk/%unk: .describe()>('#onChangeRoomName()', %AM80$%AM0)
      staticinvoke <@%unk/%unk: .describe()>('#onChangeRoomTopic()', %AM87$%AM0)
      staticinvoke <@%unk/%unk: .describe()>('#onRedactEvent()', %AM91$%AM0)
      staticinvoke <@%unk/%unk: .describe()>('#onExternalMessageEditedReceived()', %AM98$%AM0)
      staticinvoke <@%unk/%unk: .describe()>('#onChangeRoomPowerLevels()', %AM108$%AM0)
      staticinvoke <@%unk/%unk: .describe()>('#onExternalThreadedMessageReceived()', %AM114$%AM0)
      staticinvoke <@%unk/%unk: .describe()>('#onExternalThreadedFileMessageReceived()', %AM124$%AM0)
      return"];
}
subgraph "cluster_@ts_files/194.ts: ObjectId.toHexString()" {
  label="@ts_files/194.ts: ObjectId.toHexString()";
  Node35430 [label="id:0
      this = this: @ts_files/194.ts: ObjectId
      return 'hexString'"];
}
}

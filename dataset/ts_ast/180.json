{
  "type": "SourceFile",
  "label": "import { DebugLogger } from '@affine/debug';\nimport {\n  type DBSchema,\n  type IDBPDatabase,\n  type IDBPTransaction,\n  openDB,\n  type StoreNames,\n} from 'idb';\nimport {\n  type AggregateOptions,\n  type AggregateResult,\n  Document,\n  type Query,\n  type Schema,\n  type SearchOptions,\n  type SearchResult,\n} from '../../';\nimport { highlighter } from './highlighter';\nimport {\n  BooleanInvertedIndex,\n  FullTextInvertedIndex,\n  IntegerInvertedIndex,\n  type InvertedIndex,\n  StringInvertedIndex,\n} from './inverted-index';\nimport { Match } from './match';\nconst logger = new DebugLogger('indexeddb');\nexport interface IndexDB extends DBSchema {\n  kvMetadata: {\n    key: string;\n    value: {\n      key: string;\n      value: any;\n    };\n  };\n  records: {\n    key: number;\n    value: {\n      id: string;\n      data: Map<string, string[]>;\n    };\n    indexes: { id: string };\n  };\n  invertedIndex: {\n    key: number;\n    value: {\n      nid: number;\n      pos?: {\n        i: number ;\n        l: number ;\n        rs: [number, number][] ;\n      };\n      key: ArrayBuffer;\n    };\n    indexes: { key: ArrayBuffer; nid: number };\n  };\n}\nexport type DataStructRWTransaction = IDBPTransaction<\n  IndexDB,\n  ArrayLike<StoreNames<IndexDB>>,\n  'readwrite'\n>;\nexport type DataStructROTransaction = IDBPTransaction<\n  IndexDB,\n  ArrayLike<StoreNames<IndexDB>>,\n  'readonly' | 'readwrite'\n>;\nexport class DataStruct {\n  private initializePromise: Promise<void> | null = null;\n  database: IDBPDatabase<IndexDB> = null as any;\n  invertedIndex = new Map<string, InvertedIndex>();\n  constructor(\n    readonly databaseName: string,\n    readonly schema: Schema\n  ) {\n    for (const [key, type] of Object.entries(schema)) {\n      const typeInfo = typeof type === 'string' ? { type } : type;\n      if (typeInfo.index === false) {\n        // If index is false, we don't need to create an inverted index for this field.\n        continue;\n      }\n      if (typeInfo.type === 'String') {\n        this.invertedIndex.set(key, new StringInvertedIndex(key));\n      } else if (typeInfo.type === 'Integer') {\n        this.invertedIndex.set(key, new IntegerInvertedIndex(key));\n      } else if (typeInfo.type === 'FullText') {\n        this.invertedIndex.set(key, new FullTextInvertedIndex(key));\n      } else if (type === 'Boolean') {\n        this.invertedIndex.set(key, new BooleanInvertedIndex(key));\n      } else {\n        throw new Error(`Field type '${type}' not supported`);\n      }\n    }\n  }\n  private async insert(trx: DataStructRWTransaction, document: Document) {\n    const exists = await trx\n      .objectStore('records')\n      .index('id')\n      .get(document.id);\n    if (exists) {\n      throw new Error('Document already exists');\n    }\n    const dataMap = new Map();\n    for (const [key, values] of document.fields) {\n      const type = this.schema[key as string];\n      if (!type) {\n        continue;\n      }\n      const typeInfo = typeof type === 'string' ? { type } : type;\n      if (typeInfo.store !== false) {\n        // If store is false, the field will not be stored\n        dataMap.set(key, values);\n      }\n    }\n    const nid = await trx.objectStore('records').add({\n      id: document.id,\n      data: dataMap,\n    });\n    for (const [key, values] of document.fields) {\n      const iidx = this.invertedIndex.get(key as string);\n      if (!iidx) {\n        continue;\n      }\n      await iidx.insert(trx, nid, values);\n    }\n  }\n  private async delete(trx: DataStructRWTransaction, id: string) {\n    const nid = await trx.objectStore('records').index('id').getKey(id);\n    if (nid) {\n      await trx.objectStore('records').delete(nid);\n    }\n    const indexIds = await trx\n      .objectStore('invertedIndex')\n      .index('nid')\n      .getAllKeys(nid);\n    for (const indexId of indexIds) {\n      await trx.objectStore('invertedIndex').delete(indexId);\n    }\n  }\n  async batchWrite(\n    trx: DataStructRWTransaction,\n    deletes: string[],\n    inserts: Document[]\n  ) {\n    const startTime = performance.now();\n    try {\n      for (const del of deletes) {\n        await this.delete(trx, del);\n      }\n      for (const inst of inserts) {\n        await this.insert(trx, inst);\n      }\n    } finally {\n      const endTime = performance.now();\n      if (BUILD_CONFIG.debug) {\n        performance.measure(\n          `[IndexedDB Indexer] Batch Write (${this.databaseName})`,\n          {\n            start: startTime,\n            end: endTime,\n          }\n        );\n      }\n      logger.debug(\n        `[indexer ${this.databaseName}] batchWrite`,\n        endTime - startTime,\n        'ms'\n      );\n    }\n  }\n  async matchAll(trx: DataStructROTransaction): Promise<Match> {\n    const allNids = await trx.objectStore('records').getAllKeys();\n    const match = new Match();\n    for (const nid of allNids) {\n      match.addScore(nid, 1);\n    }\n    return match;\n  }\n  private async queryRaw(\n    trx: DataStructROTransaction,\n    query: Query<any>\n  ): Promise<Match> {\n    if (query.type === 'match') {\n      const iidx = this.invertedIndex.get(query.field as string);\n      if (!iidx) {\n        return new Match();\n      }\n      return await iidx.match(trx, query.match);\n    } else if (query.type === 'boolean') {\n      const weights = [];\n      for (const q of query.queries) {\n        weights.push(await this.queryRaw(trx, q));\n      }\n      if (query.occur === 'must') {\n        return weights.reduce((acc, w) => acc.and(w));\n      } else if (query.occur === 'must_not') {\n        const total = weights.reduce((acc, w) => acc.and(w));\n        return (await this.matchAll(trx)).exclude(total);\n      } else if (query.occur === 'should') {\n        return weights.reduce((acc, w) => acc.or(w));\n      }\n    } else if (query.type === 'all') {\n      return await this.matchAll(trx);\n    } else if (query.type === 'boost') {\n      return (await this.queryRaw(trx, query.query)).boost(query.boost);\n    } else if (query.type === 'exists') {\n      const iidx = this.invertedIndex.get(query.field as string);\n      if (!iidx) {\n        return new Match();\n      }\n      return await iidx.all(trx);\n    }\n    throw new Error(`Query type '${query.type}' not supported`);\n  }\n  async clear(trx: DataStructRWTransaction) {\n    await trx.objectStore('records').clear();\n    await trx.objectStore('invertedIndex').clear();\n    await trx.objectStore('kvMetadata').clear();\n  }\n  async search(\n    trx: DataStructROTransaction,\n    query: Query<any>,\n    options: SearchOptions<any>\n  ): Promise<SearchResult<any, any>> {\n    const startTime = performance.now();\n    try {\n      const pagination = {\n        skip: options.pagination?.skip ?? 0,\n        limit: options.pagination?.limit ?? 100,\n      };\n      const match = await this.queryRaw(trx, query);\n      const nids = match\n        .toArray()\n        .slice(pagination.skip, pagination.skip + pagination.limit);\n      const nodes = [];\n      for (const nid of nids) {\n        const record = await trx.objectStore('records').get(nid);\n        if (!record) {\n          continue;\n        }\n        nodes.push(this.resultNode(record, options, match, nid));\n      }\n      return {\n        pagination: {\n          count: match.size(),\n          hasMore: match.size() > pagination.limit + pagination.skip,\n          limit: pagination.limit,\n          skip: pagination.skip,\n        },\n        nodes: nodes,\n      };\n    } finally {\n      const endTime = performance.now();\n      if (BUILD_CONFIG.debug) {\n        performance.measure(\n          `[IndexedDB Indexer] Search (${this.databaseName})`,\n          {\n            detail: { query, options },\n            start: startTime,\n            end: endTime,\n          }\n        );\n      }\n      logger.debug(\n        `[indexer ${this.databaseName}] search`,\n        endTime - startTime,\n        'ms',\n        query\n      );\n    }\n  }\n  async aggregate(\n    trx: DataStructROTransaction,\n    query: Query<any>,\n    field: string,\n    options: AggregateOptions<any>\n  ): Promise<AggregateResult<any, any>> {\n    const startTime = performance.now();\n    try {\n      const pagination = {\n        skip: options.pagination?.skip ?? 0,\n        limit: options.pagination?.limit ?? 100,\n      };\n      const hitPagination = options.hits\n        ? {\n            skip: options.hits.pagination?.skip ?? 0,\n            limit: options.hits.pagination?.limit ?? 3,\n          }\n        : {\n            skip: 0,\n            limit: 0,\n          };\n      const match = await this.queryRaw(trx, query);\n      const nids = match.toArray();\n      const buckets: {\n        key: string;\n        nids: number[];\n        hits: SearchResult<any, any>['nodes'];\n      }[] = [];\n      for (const nid of nids) {\n        const record = await trx.objectStore('records').get(nid);\n        if (!record) {\n          continue;\n        }\n        const values = record.data.get(field);\n        for (const value of values ?? []) {\n          let bucket;\n          let bucketIndex = buckets.findIndex(b => b.key === value);\n          if (bucketIndex === -1) {\n            bucket = { key: value, nids: [], hits: [] };\n            buckets.push(bucket);\n            bucketIndex = buckets.length - 1;\n          } else {\n            bucket = buckets[bucketIndex];\n          }\n          if (\n            bucketIndex >= pagination.skip &&\n            bucketIndex < pagination.skip + pagination.limit\n          ) {\n            bucket.nids.push(nid);\n            if (\n              bucket.nids.length - 1 >= hitPagination.skip &&\n              bucket.nids.length - 1 < hitPagination.skip + hitPagination.limit\n            ) {\n              bucket.hits.push(\n                this.resultNode(record, options.hits ?? {}, match, nid)\n              );\n            }\n          }\n        }\n      }\n      return {\n        buckets: buckets\n          .slice(pagination.skip, pagination.skip + pagination.limit)\n          .map(bucket => {\n            const result = {\n              key: bucket.key,\n              score: match.getScore(bucket.nids[0]),\n              count: bucket.nids.length,\n            } as AggregateResult<any, any>['buckets'][number];\n            if (options.hits) {\n              (result as any).hits = {\n                pagination: {\n                  count: bucket.nids.length,\n                  hasMore:\n                    bucket.nids.length >\n                    hitPagination.limit + hitPagination.skip,\n                  limit: hitPagination.limit,\n                  skip: hitPagination.skip,\n                },\n                nodes: bucket.hits,\n              } as SearchResult<any, any>;\n            }\n            return result;\n          }),\n        pagination: {\n          count: buckets.length,\n          hasMore: buckets.length > pagination.limit + pagination.skip,\n          limit: pagination.limit,\n          skip: pagination.skip,\n        },\n      };\n    } finally {\n      const endTime = performance.now();\n      if (BUILD_CONFIG.debug) {\n        performance.measure(\n          `[IndexedDB Indexer] Aggregate (${this.databaseName})`,\n          {\n            detail: { query, field, options },\n            start: startTime,\n            end: endTime,\n          }\n        );\n      }\n      logger.debug(\n        `[indexer ${this.databaseName}] aggregate`,\n        endTime - startTime,\n        'ms'\n      );\n    }\n  }\n  async getAll(\n    trx: DataStructROTransaction,\n    ids?: string[]\n  ): Promise<Document[]> {\n    const docs = [];\n    if (ids) {\n      for (const id of ids) {\n        const record = await trx.objectStore('records').index('id').get(id);\n        if (record) {\n          docs.push(Document.from(record.id, record.data));\n        }\n      }\n    } else {\n      const records = await trx.objectStore('records').getAll();\n      for (const record of records) {\n        docs.push(Document.from(record.id, record.data));\n      }\n    }\n    return docs;\n  }\n  async has(trx: DataStructROTransaction, id: string): Promise<boolean> {\n    const nid = await trx.objectStore('records').index('id').getKey(id);\n    return nid !== undefined;\n  }\n  async readonly() {\n    await this.ensureInitialized();\n    return this.database.transaction(\n      ['records', 'invertedIndex', 'kvMetadata'],\n      'readonly',\n      {\n        durability: 'relaxed',\n      }\n    );\n  }\n  async readwrite() {\n    await this.ensureInitialized();\n    return this.database.transaction(\n      ['records', 'invertedIndex', 'kvMetadata'],\n      'readwrite',\n      {\n        durability: 'relaxed',\n      }\n    );\n  }\n  private async ensureInitialized() {\n    if (this.database) {\n      return;\n    }\n    this.initializePromise ??= this.initialize();\n    await this.initializePromise;\n  }\n  private async initialize() {\n    this.database = await openDB<IndexDB>(this.databaseName, 1, {\n      upgrade(database) {\n        database.createObjectStore('kvMetadata', {\n          keyPath: 'key',\n        });\n        const recordsStore = database.createObjectStore('records', {\n          autoIncrement: true,\n        });\n        recordsStore.createIndex('id', 'id', {\n          unique: true,\n        });\n        const invertedIndexStore = database.createObjectStore('invertedIndex', {\n          autoIncrement: true,\n        });\n        invertedIndexStore.createIndex('key', 'key', { unique: false });\n        invertedIndexStore.createIndex('nid', 'nid', { unique: false });\n      },\n    });\n  }\n  private resultNode(\n    record: { id: string; data: Map<string, string[]> },\n    options: SearchOptions<any>,\n    match?: Match,\n    nid?: number\n  ): SearchResult<any, any>['nodes'][number] {\n    const node = {\n      id: record.id,\n      score: match && nid ? match.getScore(nid) : 1,\n    } as any;\n    if (options.fields) {\n      const fields = {} as Record<string, string | string[]>;\n      for (const field of options.fields as string[]) {\n        fields[field] = record.data.get(field) ?? [''];\n        if (fields[field].length === 1) {\n          fields[field] = fields[field][0];\n        }\n      }\n      node.fields = fields;\n    }\n    if (match && nid && options.highlights) {\n      const highlights = {} as Record<string, string[]>;\n      for (const { field, before, end } of options.highlights) {\n        const highlightValues = match.getHighlighters(nid, field);\n        if (highlightValues) {\n          const rawValues = record.data.get(field) ?? [];\n          highlights[field] = Array.from(highlightValues)\n            .map(([index, ranges]) => {\n              const raw = rawValues[index];\n              if (raw) {\n                return (\n                  highlighter(raw, before, end, ranges, {\n                    maxPrefix: 20,\n                    maxLength: 50,\n                  }) ?? ''\n                );\n              }\n              return '';\n            })\n            .filter(Boolean);\n        }\n      }\n      node.highlights = highlights;\n    }\n    return node;\n  }\n}",
  "start_token": 0,
  "end_token": 3016,
  "children": [
    {
      "type": "ImportDeclaration",
      "label": "import { DebugLogger } from '@affine/debug';",
      "start_token": 0,
      "end_token": 6,
      "children": [
        {
          "type": "ImportClause",
          "label": "{ DebugLogger }",
          "start_token": 1,
          "end_token": 3,
          "children": [
            {
              "type": "NamedImports",
              "label": "{ DebugLogger }",
              "start_token": 1,
              "end_token": 3,
              "children": [
                {
                  "type": "ImportSpecifier",
                  "label": "DebugLogger",
                  "start_token": 2,
                  "end_token": 2,
                  "children": [
                    {
                      "type": "Identifier",
                      "label": "DebugLogger",
                      "start_token": 2,
                      "end_token": 2,
                      "children": []
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "type": "StringLiteral",
          "label": "'@affine/debug'",
          "start_token": 5,
          "end_token": 5,
          "children": []
        }
      ]
    },
    {
      "type": "ImportDeclaration",
      "label": "import {\n  type DBSchema,\n  type IDBPDatabase,\n  type IDBPTransaction,\n  openDB,\n  type StoreNames,\n} from 'idb';",
      "start_token": 7,
      "end_token": 26,
      "children": [
        {
          "type": "ImportClause",
          "label": "{\n  type DBSchema,\n  type IDBPDatabase,\n  type IDBPTransaction,\n  openDB,\n  type StoreNames,\n}",
          "start_token": 8,
          "end_token": 23,
          "children": [
            {
              "type": "NamedImports",
              "label": "{\n  type DBSchema,\n  type IDBPDatabase,\n  type IDBPTransaction,\n  openDB,\n  type StoreNames,\n}",
              "start_token": 8,
              "end_token": 23,
              "children": [
                {
                  "type": "ImportSpecifier",
                  "label": "type DBSchema",
                  "start_token": 9,
                  "end_token": 10,
                  "children": [
                    {
                      "type": "Identifier",
                      "label": "DBSchema",
                      "start_token": 10,
                      "end_token": 10,
                      "children": []
                    }
                  ]
                },
                {
                  "type": "ImportSpecifier",
                  "label": "type IDBPDatabase",
                  "start_token": 12,
                  "end_token": 13,
                  "children": [
                    {
                      "type": "Identifier",
                      "label": "IDBPDatabase",
                      "start_token": 13,
                      "end_token": 13,
                      "children": []
                    }
                  ]
                },
                {
                  "type": "ImportSpecifier",
                  "label": "type IDBPTransaction",
                  "start_token": 15,
                  "end_token": 16,
                  "children": [
                    {
                      "type": "Identifier",
                      "label": "IDBPTransaction",
                      "start_token": 16,
                      "end_token": 16,
                      "children": []
                    }
                  ]
                },
                {
                  "type": "ImportSpecifier",
                  "label": "openDB",
                  "start_token": 18,
                  "end_token": 18,
                  "children": [
                    {
                      "type": "Identifier",
                      "label": "openDB",
                      "start_token": 18,
                      "end_token": 18,
                      "children": []
                    }
                  ]
                },
                {
                  "type": "ImportSpecifier",
                  "label": "type StoreNames",
                  "start_token": 20,
                  "end_token": 21,
                  "children": [
                    {
                      "type": "Identifier",
                      "label": "StoreNames",
                      "start_token": 21,
                      "end_token": 21,
                      "children": []
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "type": "StringLiteral",
          "label": "'idb'",
          "start_token": 25,
          "end_token": 25,
          "children": []
        }
      ]
    },
    {
      "type": "ImportDeclaration",
      "label": "import {\n  type AggregateOptions,\n  type AggregateResult,\n  Document,\n  type Query,\n  type Schema,\n  type SearchOptions,\n  type SearchResult,\n} from '../../';",
      "start_token": 27,
      "end_token": 52,
      "children": [
        {
          "type": "ImportClause",
          "label": "{\n  type AggregateOptions,\n  type AggregateResult,\n  Document,\n  type Query,\n  type Schema,\n  type SearchOptions,\n  type SearchResult,\n}",
          "start_token": 28,
          "end_token": 49,
          "children": [
            {
              "type": "NamedImports",
              "label": "{\n  type AggregateOptions,\n  type AggregateResult,\n  Document,\n  type Query,\n  type Schema,\n  type SearchOptions,\n  type SearchResult,\n}",
              "start_token": 28,
              "end_token": 49,
              "children": [
                {
                  "type": "ImportSpecifier",
                  "label": "type AggregateOptions",
                  "start_token": 29,
                  "end_token": 30,
                  "children": [
                    {
                      "type": "Identifier",
                      "label": "AggregateOptions",
                      "start_token": 30,
                      "end_token": 30,
                      "children": []
                    }
                  ]
                },
                {
                  "type": "ImportSpecifier",
                  "label": "type AggregateResult",
                  "start_token": 32,
                  "end_token": 33,
                  "children": [
                    {
                      "type": "Identifier",
                      "label": "AggregateResult",
                      "start_token": 33,
                      "end_token": 33,
                      "children": []
                    }
                  ]
                },
                {
                  "type": "ImportSpecifier",
                  "label": "Document",
                  "start_token": 35,
                  "end_token": 35,
                  "children": [
                    {
                      "type": "Identifier",
                      "label": "Document",
                      "start_token": 35,
                      "end_token": 35,
                      "children": []
                    }
                  ]
                },
                {
                  "type": "ImportSpecifier",
                  "label": "type Query",
                  "start_token": 37,
                  "end_token": 38,
                  "children": [
                    {
                      "type": "Identifier",
                      "label": "Query",
                      "start_token": 38,
                      "end_token": 38,
                      "children": []
                    }
                  ]
                },
                {
                  "type": "ImportSpecifier",
                  "label": "type Schema",
                  "start_token": 40,
                  "end_token": 41,
                  "children": [
                    {
                      "type": "Identifier",
                      "label": "Schema",
                      "start_token": 41,
                      "end_token": 41,
                      "children": []
                    }
                  ]
                },
                {
                  "type": "ImportSpecifier",
                  "label": "type SearchOptions",
                  "start_token": 43,
                  "end_token": 44,
                  "children": [
                    {
                      "type": "Identifier",
                      "label": "SearchOptions",
                      "start_token": 44,
                      "end_token": 44,
                      "children": []
                    }
                  ]
                },
                {
                  "type": "ImportSpecifier",
                  "label": "type SearchResult",
                  "start_token": 46,
                  "end_token": 47,
                  "children": [
                    {
                      "type": "Identifier",
                      "label": "SearchResult",
                      "start_token": 47,
                      "end_token": 47,
                      "children": []
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "type": "StringLiteral",
          "label": "'../../'",
          "start_token": 51,
          "end_token": 51,
          "children": []
        }
      ]
    },
    {
      "type": "ImportDeclaration",
      "label": "import { highlighter } from './highlighter';",
      "start_token": 53,
      "end_token": 59,
      "children": [
        {
          "type": "ImportClause",
          "label": "{ highlighter }",
          "start_token": 54,
          "end_token": 56,
          "children": [
            {
              "type": "NamedImports",
              "label": "{ highlighter }",
              "start_token": 54,
              "end_token": 56,
              "children": [
                {
                  "type": "ImportSpecifier",
                  "label": "highlighter",
                  "start_token": 55,
                  "end_token": 55,
                  "children": [
                    {
                      "type": "Identifier",
                      "label": "highlighter",
                      "start_token": 55,
                      "end_token": 55,
                      "children": []
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "type": "StringLiteral",
          "label": "'./highlighter'",
          "start_token": 58,
          "end_token": 58,
          "children": []
        }
      ]
    },
    {
      "type": "ImportDeclaration",
      "label": "import {\n  BooleanInvertedIndex,\n  FullTextInvertedIndex,\n  IntegerInvertedIndex,\n  type InvertedIndex,\n  StringInvertedIndex,\n} from './inverted-index';",
      "start_token": 60,
      "end_token": 76,
      "children": [
        {
          "type": "ImportClause",
          "label": "{\n  BooleanInvertedIndex,\n  FullTextInvertedIndex,\n  IntegerInvertedIndex,\n  type InvertedIndex,\n  StringInvertedIndex,\n}",
          "start_token": 61,
          "end_token": 73,
          "children": [
            {
              "type": "NamedImports",
              "label": "{\n  BooleanInvertedIndex,\n  FullTextInvertedIndex,\n  IntegerInvertedIndex,\n  type InvertedIndex,\n  StringInvertedIndex,\n}",
              "start_token": 61,
              "end_token": 73,
              "children": [
                {
                  "type": "ImportSpecifier",
                  "label": "BooleanInvertedIndex",
                  "start_token": 62,
                  "end_token": 62,
                  "children": [
                    {
                      "type": "Identifier",
                      "label": "BooleanInvertedIndex",
                      "start_token": 62,
                      "end_token": 62,
                      "children": []
                    }
                  ]
                },
                {
                  "type": "ImportSpecifier",
                  "label": "FullTextInvertedIndex",
                  "start_token": 64,
                  "end_token": 64,
                  "children": [
                    {
                      "type": "Identifier",
                      "label": "FullTextInvertedIndex",
                      "start_token": 64,
                      "end_token": 64,
                      "children": []
                    }
                  ]
                },
                {
                  "type": "ImportSpecifier",
                  "label": "IntegerInvertedIndex",
                  "start_token": 66,
                  "end_token": 66,
                  "children": [
                    {
                      "type": "Identifier",
                      "label": "IntegerInvertedIndex",
                      "start_token": 66,
                      "end_token": 66,
                      "children": []
                    }
                  ]
                },
                {
                  "type": "ImportSpecifier",
                  "label": "type InvertedIndex",
                  "start_token": 68,
                  "end_token": 69,
                  "children": [
                    {
                      "type": "Identifier",
                      "label": "InvertedIndex",
                      "start_token": 69,
                      "end_token": 69,
                      "children": []
                    }
                  ]
                },
                {
                  "type": "ImportSpecifier",
                  "label": "StringInvertedIndex",
                  "start_token": 71,
                  "end_token": 71,
                  "children": [
                    {
                      "type": "Identifier",
                      "label": "StringInvertedIndex",
                      "start_token": 71,
                      "end_token": 71,
                      "children": []
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "type": "StringLiteral",
          "label": "'./inverted-index'",
          "start_token": 75,
          "end_token": 75,
          "children": []
        }
      ]
    },
    {
      "type": "ImportDeclaration",
      "label": "import { Match } from './match';",
      "start_token": 77,
      "end_token": 83,
      "children": [
        {
          "type": "ImportClause",
          "label": "{ Match }",
          "start_token": 78,
          "end_token": 80,
          "children": [
            {
              "type": "NamedImports",
              "label": "{ Match }",
              "start_token": 78,
              "end_token": 80,
              "children": [
                {
                  "type": "ImportSpecifier",
                  "label": "Match",
                  "start_token": 79,
                  "end_token": 79,
                  "children": [
                    {
                      "type": "Identifier",
                      "label": "Match",
                      "start_token": 79,
                      "end_token": 79,
                      "children": []
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "type": "StringLiteral",
          "label": "'./match'",
          "start_token": 82,
          "end_token": 82,
          "children": []
        }
      ]
    },
    {
      "type": "FirstStatement",
      "label": "const logger = new DebugLogger('indexeddb');",
      "start_token": 84,
      "end_token": 92,
      "children": [
        {
          "type": "VariableDeclarationList",
          "label": "const logger = new DebugLogger('indexeddb')",
          "start_token": 84,
          "end_token": 91,
          "children": [
            {
              "type": "VariableDeclaration",
              "label": "logger = new DebugLogger('indexeddb')",
              "start_token": 85,
              "end_token": 91,
              "children": [
                {
                  "type": "Identifier",
                  "label": "logger",
                  "start_token": 85,
                  "end_token": 85,
                  "children": []
                },
                {
                  "type": "NewExpression",
                  "label": "new DebugLogger('indexeddb')",
                  "start_token": 87,
                  "end_token": 91,
                  "children": [
                    {
                      "type": "Identifier",
                      "label": "DebugLogger",
                      "start_token": 88,
                      "end_token": 88,
                      "children": []
                    },
                    {
                      "type": "StringLiteral",
                      "label": "'indexeddb'",
                      "start_token": 90,
                      "end_token": 90,
                      "children": []
                    }
                  ]
                }
              ]
            }
          ]
        }
      ]
    },
    {
      "type": "InterfaceDeclaration",
      "label": "export interface IndexDB extends DBSchema {\n  kvMetadata: {\n    key: string;\n    value: {\n      key: string;\n      value: any;\n    };\n  };\n  records: {\n    key: number;\n    value: {\n      id: string;\n      data: Map<string, string[]>;\n    };\n    indexes: { id: string };\n  };\n  invertedIndex: {\n    key: number;\n    value: {\n      nid: number;\n      pos?: {\n        i: number ;\n        l: number ;\n        rs: [number, number][] ;\n      };\n      key: ArrayBuffer;\n    };\n    indexes: { key: ArrayBuffer; nid: number };\n  };\n}",
      "start_token": 93,
      "end_token": 216,
      "children": [
        {
          "type": "ExportKeyword",
          "label": "export",
          "start_token": 93,
          "end_token": 93,
          "children": []
        },
        {
          "type": "Identifier",
          "label": "IndexDB",
          "start_token": 95,
          "end_token": 95,
          "children": []
        },
        {
          "type": "HeritageClause",
          "label": "extends DBSchema",
          "start_token": 96,
          "end_token": 97,
          "children": [
            {
              "type": "ExpressionWithTypeArguments",
              "label": "DBSchema",
              "start_token": 97,
              "end_token": 97,
              "children": [
                {
                  "type": "Identifier",
                  "label": "DBSchema",
                  "start_token": 97,
                  "end_token": 97,
                  "children": []
                }
              ]
            }
          ]
        },
        {
          "type": "PropertySignature",
          "label": "kvMetadata: {\n    key: string;\n    value: {\n      key: string;\n      value: any;\n    };\n  };",
          "start_token": 99,
          "end_token": 120,
          "children": [
            {
              "type": "Identifier",
              "label": "kvMetadata",
              "start_token": 99,
              "end_token": 99,
              "children": []
            },
            {
              "type": "TypeLiteral",
              "label": "{\n    key: string;\n    value: {\n      key: string;\n      value: any;\n    };\n  }",
              "start_token": 101,
              "end_token": 119,
              "children": [
                {
                  "type": "PropertySignature",
                  "label": "key: string;",
                  "start_token": 102,
                  "end_token": 105,
                  "children": [
                    {
                      "type": "Identifier",
                      "label": "key",
                      "start_token": 102,
                      "end_token": 102,
                      "children": []
                    },
                    {
                      "type": "StringKeyword",
                      "label": "string",
                      "start_token": 104,
                      "end_token": 104,
                      "children": []
                    }
                  ]
                },
                {
                  "type": "PropertySignature",
                  "label": "value: {\n      key: string;\n      value: any;\n    };",
                  "start_token": 106,
                  "end_token": 118,
                  "children": [
                    {
                      "type": "Identifier",
                      "label": "value",
                      "start_token": 106,
                      "end_token": 106,
                      "children": []
                    },
                    {
                      "type": "TypeLiteral",
                      "label": "{\n      key: string;\n      value: any;\n    }",
                      "start_token": 108,
                      "end_token": 117,
                      "children": [
                        {
                          "type": "PropertySignature",
                          "label": "key: string;",
                          "start_token": 109,
                          "end_token": 112,
                          "children": [
                            {
                              "type": "Identifier",
                              "label": "key",
                              "start_token": 109,
                              "end_token": 109,
                              "children": []
                            },
                            {
                              "type": "StringKeyword",
                              "label": "string",
                              "start_token": 111,
                              "end_token": 111,
                              "children": []
                            }
                          ]
                        },
                        {
                          "type": "PropertySignature",
                          "label": "value: any;",
                          "start_token": 113,
                          "end_token": 116,
                          "children": [
                            {
                              "type": "Identifier",
                              "label": "value",
                              "start_token": 113,
                              "end_token": 113,
                              "children": []
                            },
                            {
                              "type": "AnyKeyword",
                              "label": "any",
                              "start_token": 115,
                              "end_token": 115,
                              "children": []
                            }
                          ]
                        }
                      ]
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "type": "PropertySignature",
          "label": "records: {\n    key: number;\n    value: {\n      id: string;\n      data: Map<string, string[]>;\n    };\n    indexes: { id: string };\n  };",
          "start_token": 121,
          "end_token": 157,
          "children": [
            {
              "type": "Identifier",
              "label": "records",
              "start_token": 121,
              "end_token": 121,
              "children": []
            },
            {
              "type": "TypeLiteral",
              "label": "{\n    key: number;\n    value: {\n      id: string;\n      data: Map<string, string[]>;\n    };\n    indexes: { id: string };\n  }",
              "start_token": 123,
              "end_token": 156,
              "children": [
                {
                  "type": "PropertySignature",
                  "label": "key: number;",
                  "start_token": 124,
                  "end_token": 127,
                  "children": [
                    {
                      "type": "Identifier",
                      "label": "key",
                      "start_token": 124,
                      "end_token": 124,
                      "children": []
                    },
                    {
                      "type": "NumberKeyword",
                      "label": "number",
                      "start_token": 126,
                      "end_token": 126,
                      "children": []
                    }
                  ]
                },
                {
                  "type": "PropertySignature",
                  "label": "value: {\n      id: string;\n      data: Map<string, string[]>;\n    };",
                  "start_token": 128,
                  "end_token": 147,
                  "children": [
                    {
                      "type": "Identifier",
                      "label": "value",
                      "start_token": 128,
                      "end_token": 128,
                      "children": []
                    },
                    {
                      "type": "TypeLiteral",
                      "label": "{\n      id: string;\n      data: Map<string, string[]>;\n    }",
                      "start_token": 130,
                      "end_token": 146,
                      "children": [
                        {
                          "type": "PropertySignature",
                          "label": "id: string;",
                          "start_token": 131,
                          "end_token": 134,
                          "children": [
                            {
                              "type": "Identifier",
                              "label": "id",
                              "start_token": 131,
                              "end_token": 131,
                              "children": []
                            },
                            {
                              "type": "StringKeyword",
                              "label": "string",
                              "start_token": 133,
                              "end_token": 133,
                              "children": []
                            }
                          ]
                        },
                        {
                          "type": "PropertySignature",
                          "label": "data: Map<string, string[]>;",
                          "start_token": 135,
                          "end_token": 145,
                          "children": [
                            {
                              "type": "Identifier",
                              "label": "data",
                              "start_token": 135,
                              "end_token": 135,
                              "children": []
                            },
                            {
                              "type": "TypeReference",
                              "label": "Map<string, string[]>",
                              "start_token": 137,
                              "end_token": 144,
                              "children": [
                                {
                                  "type": "Identifier",
                                  "label": "Map",
                                  "start_token": 137,
                                  "end_token": 137,
                                  "children": []
                                },
                                {
                                  "type": "StringKeyword",
                                  "label": "string",
                                  "start_token": 139,
                                  "end_token": 139,
                                  "children": []
                                },
                                {
                                  "type": "ArrayType",
                                  "label": "string[]",
                                  "start_token": 141,
                                  "end_token": 143,
                                  "children": [
                                    {
                                      "type": "StringKeyword",
                                      "label": "string",
                                      "start_token": 141,
                                      "end_token": 141,
                                      "children": []
                                    }
                                  ]
                                }
                              ]
                            }
                          ]
                        }
                      ]
                    }
                  ]
                },
                {
                  "type": "PropertySignature",
                  "label": "indexes: { id: string };",
                  "start_token": 148,
                  "end_token": 155,
                  "children": [
                    {
                      "type": "Identifier",
                      "label": "indexes",
                      "start_token": 148,
                      "end_token": 148,
                      "children": []
                    },
                    {
                      "type": "TypeLiteral",
                      "label": "{ id: string }",
                      "start_token": 150,
                      "end_token": 154,
                      "children": [
                        {
                          "type": "PropertySignature",
                          "label": "id: string",
                          "start_token": 151,
                          "end_token": 153,
                          "children": [
                            {
                              "type": "Identifier",
                              "label": "id",
                              "start_token": 151,
                              "end_token": 151,
                              "children": []
                            },
                            {
                              "type": "StringKeyword",
                              "label": "string",
                              "start_token": 153,
                              "end_token": 153,
                              "children": []
                            }
                          ]
                        }
                      ]
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "type": "PropertySignature",
          "label": "invertedIndex: {\n    key: number;\n    value: {\n      nid: number;\n      pos?: {\n        i: number ;\n        l: number ;\n        rs: [number, number][] ;\n      };\n      key: ArrayBuffer;\n    };\n    indexes: { key: ArrayBuffer; nid: number };\n  };",
          "start_token": 158,
          "end_token": 215,
          "children": [
            {
              "type": "Identifier",
              "label": "invertedIndex",
              "start_token": 158,
              "end_token": 158,
              "children": []
            },
            {
              "type": "TypeLiteral",
              "label": "{\n    key: number;\n    value: {\n      nid: number;\n      pos?: {\n        i: number ;\n        l: number ;\n        rs: [number, number][] ;\n      };\n      key: ArrayBuffer;\n    };\n    indexes: { key: ArrayBuffer; nid: number };\n  }",
              "start_token": 160,
              "end_token": 214,
              "children": [
                {
                  "type": "PropertySignature",
                  "label": "key: number;",
                  "start_token": 161,
                  "end_token": 164,
                  "children": [
                    {
                      "type": "Identifier",
                      "label": "key",
                      "start_token": 161,
                      "end_token": 161,
                      "children": []
                    },
                    {
                      "type": "NumberKeyword",
                      "label": "number",
                      "start_token": 163,
                      "end_token": 163,
                      "children": []
                    }
                  ]
                },
                {
                  "type": "PropertySignature",
                  "label": "value: {\n      nid: number;\n      pos?: {\n        i: number ;\n        l: number ;\n        rs: [number, number][] ;\n      };\n      key: ArrayBuffer;\n    };",
                  "start_token": 165,
                  "end_token": 201,
                  "children": [
                    {
                      "type": "Identifier",
                      "label": "value",
                      "start_token": 165,
                      "end_token": 165,
                      "children": []
                    },
                    {
                      "type": "TypeLiteral",
                      "label": "{\n      nid: number;\n      pos?: {\n        i: number ;\n        l: number ;\n        rs: [number, number][] ;\n      };\n      key: ArrayBuffer;\n    }",
                      "start_token": 167,
                      "end_token": 200,
                      "children": [
                        {
                          "type": "PropertySignature",
                          "label": "nid: number;",
                          "start_token": 168,
                          "end_token": 171,
                          "children": [
                            {
                              "type": "Identifier",
                              "label": "nid",
                              "start_token": 168,
                              "end_token": 168,
                              "children": []
                            },
                            {
                              "type": "NumberKeyword",
                              "label": "number",
                              "start_token": 170,
                              "end_token": 170,
                              "children": []
                            }
                          ]
                        },
                        {
                          "type": "PropertySignature",
                          "label": "pos?: {\n        i: number ;\n        l: number ;\n        rs: [number, number][] ;\n      };",
                          "start_token": 172,
                          "end_token": 195,
                          "children": [
                            {
                              "type": "Identifier",
                              "label": "pos",
                              "start_token": 172,
                              "end_token": 172,
                              "children": []
                            },
                            {
                              "type": "QuestionToken",
                              "label": "?",
                              "start_token": 173,
                              "end_token": 173,
                              "children": []
                            },
                            {
                              "type": "TypeLiteral",
                              "label": "{\n        i: number ;\n        l: number ;\n        rs: [number, number][] ;\n      }",
                              "start_token": 175,
                              "end_token": 194,
                              "children": [
                                {
                                  "type": "PropertySignature",
                                  "label": "i: number ;",
                                  "start_token": 176,
                                  "end_token": 179,
                                  "children": [
                                    {
                                      "type": "Identifier",
                                      "label": "i",
                                      "start_token": 176,
                                      "end_token": 176,
                                      "children": []
                                    },
                                    {
                                      "type": "NumberKeyword",
                                      "label": "number",
                                      "start_token": 178,
                                      "end_token": 178,
                                      "children": []
                                    }
                                  ]
                                },
                                {
                                  "type": "PropertySignature",
                                  "label": "l: number ;",
                                  "start_token": 180,
                                  "end_token": 183,
                                  "children": [
                                    {
                                      "type": "Identifier",
                                      "label": "l",
                                      "start_token": 180,
                                      "end_token": 180,
                                      "children": []
                                    },
                                    {
                                      "type": "NumberKeyword",
                                      "label": "number",
                                      "start_token": 182,
                                      "end_token": 182,
                                      "children": []
                                    }
                                  ]
                                },
                                {
                                  "type": "PropertySignature",
                                  "label": "rs: [number, number][] ;",
                                  "start_token": 184,
                                  "end_token": 193,
                                  "children": [
                                    {
                                      "type": "Identifier",
                                      "label": "rs",
                                      "start_token": 184,
                                      "end_token": 184,
                                      "children": []
                                    },
                                    {
                                      "type": "ArrayType",
                                      "label": "[number, number][]",
                                      "start_token": 186,
                                      "end_token": 192,
                                      "children": [
                                        {
                                          "type": "TupleType",
                                          "label": "[number, number]",
                                          "start_token": 186,
                                          "end_token": 190,
                                          "children": [
                                            {
                                              "type": "NumberKeyword",
                                              "label": "number",
                                              "start_token": 187,
                                              "end_token": 187,
                                              "children": []
                                            },
                                            {
                                              "type": "NumberKeyword",
                                              "label": "number",
                                              "start_token": 189,
                                              "end_token": 189,
                                              "children": []
                                            }
                                          ]
                                        }
                                      ]
                                    }
                                  ]
                                }
                              ]
                            }
                          ]
                        },
                        {
                          "type": "PropertySignature",
                          "label": "key: ArrayBuffer;",
                          "start_token": 196,
                          "end_token": 199,
                          "children": [
                            {
                              "type": "Identifier",
                              "label": "key",
                              "start_token": 196,
                              "end_token": 196,
                              "children": []
                            },
                            {
                              "type": "TypeReference",
                              "label": "ArrayBuffer",
                              "start_token": 198,
                              "end_token": 198,
                              "children": [
                                {
                                  "type": "Identifier",
                                  "label": "ArrayBuffer",
                                  "start_token": 198,
                                  "end_token": 198,
                                  "children": []
                                }
                              ]
                            }
                          ]
                        }
                      ]
                    }
                  ]
                },
                {
                  "type": "PropertySignature",
                  "label": "indexes: { key: ArrayBuffer; nid: number };",
                  "start_token": 202,
                  "end_token": 213,
                  "children": [
                    {
                      "type": "Identifier",
                      "label": "indexes",
                      "start_token": 202,
                      "end_token": 202,
                      "children": []
                    },
                    {
                      "type": "TypeLiteral",
                      "label": "{ key: ArrayBuffer; nid: number }",
                      "start_token": 204,
                      "end_token": 212,
                      "children": [
                        {
                          "type": "PropertySignature",
                          "label": "key: ArrayBuffer;",
                          "start_token": 205,
                          "end_token": 208,
                          "children": [
                            {
                              "type": "Identifier",
                              "label": "key",
                              "start_token": 205,
                              "end_token": 205,
                              "children": []
                            },
                            {
                              "type": "TypeReference",
                              "label": "ArrayBuffer",
                              "start_token": 207,
                              "end_token": 207,
                              "children": [
                                {
                                  "type": "Identifier",
                                  "label": "ArrayBuffer",
                                  "start_token": 207,
                                  "end_token": 207,
                                  "children": []
                                }
                              ]
                            }
                          ]
                        },
                        {
                          "type": "PropertySignature",
                          "label": "nid: number",
                          "start_token": 209,
                          "end_token": 211,
                          "children": [
                            {
                              "type": "Identifier",
                              "label": "nid",
                              "start_token": 209,
                              "end_token": 209,
                              "children": []
                            },
                            {
                              "type": "NumberKeyword",
                              "label": "number",
                              "start_token": 211,
                              "end_token": 211,
                              "children": []
                            }
                          ]
                        }
                      ]
                    }
                  ]
                }
              ]
            }
          ]
        }
      ]
    },
    {
      "type": "TypeAliasDeclaration",
      "label": "export type DataStructRWTransaction = IDBPTransaction<\n  IndexDB,\n  ArrayLike<StoreNames<IndexDB>>,\n  'readwrite'\n>;",
      "start_token": 217,
      "end_token": 235,
      "children": [
        {
          "type": "ExportKeyword",
          "label": "export",
          "start_token": 217,
          "end_token": 217,
          "children": []
        },
        {
          "type": "Identifier",
          "label": "DataStructRWTransaction",
          "start_token": 219,
          "end_token": 219,
          "children": []
        },
        {
          "type": "TypeReference",
          "label": "IDBPTransaction<\n  IndexDB,\n  ArrayLike<StoreNames<IndexDB>>,\n  'readwrite'\n>",
          "start_token": 221,
          "end_token": 234,
          "children": [
            {
              "type": "Identifier",
              "label": "IDBPTransaction",
              "start_token": 221,
              "end_token": 221,
              "children": []
            },
            {
              "type": "TypeReference",
              "label": "IndexDB",
              "start_token": 223,
              "end_token": 223,
              "children": [
                {
                  "type": "Identifier",
                  "label": "IndexDB",
                  "start_token": 223,
                  "end_token": 223,
                  "children": []
                }
              ]
            },
            {
              "type": "TypeReference",
              "label": "ArrayLike<StoreNames<IndexDB>>",
              "start_token": 225,
              "end_token": 231,
              "children": [
                {
                  "type": "Identifier",
                  "label": "ArrayLike",
                  "start_token": 225,
                  "end_token": 225,
                  "children": []
                },
                {
                  "type": "TypeReference",
                  "label": "StoreNames<IndexDB>",
                  "start_token": 227,
                  "end_token": 230,
                  "children": [
                    {
                      "type": "Identifier",
                      "label": "StoreNames",
                      "start_token": 227,
                      "end_token": 227,
                      "children": []
                    },
                    {
                      "type": "TypeReference",
                      "label": "IndexDB",
                      "start_token": 229,
                      "end_token": 229,
                      "children": [
                        {
                          "type": "Identifier",
                          "label": "IndexDB",
                          "start_token": 229,
                          "end_token": 229,
                          "children": []
                        }
                      ]
                    }
                  ]
                }
              ]
            },
            {
              "type": "LiteralType",
              "label": "'readwrite'",
              "start_token": 233,
              "end_token": 233,
              "children": [
                {
                  "type": "StringLiteral",
                  "label": "'readwrite'",
                  "start_token": 233,
                  "end_token": 233,
                  "children": []
                }
              ]
            }
          ]
        }
      ]
    },
    {
      "type": "TypeAliasDeclaration",
      "label": "export type DataStructROTransaction = IDBPTransaction<\n  IndexDB,\n  ArrayLike<StoreNames<IndexDB>>,\n  'readonly' | 'readwrite'\n>;",
      "start_token": 236,
      "end_token": 256,
      "children": [
        {
          "type": "ExportKeyword",
          "label": "export",
          "start_token": 236,
          "end_token": 236,
          "children": []
        },
        {
          "type": "Identifier",
          "label": "DataStructROTransaction",
          "start_token": 238,
          "end_token": 238,
          "children": []
        },
        {
          "type": "TypeReference",
          "label": "IDBPTransaction<\n  IndexDB,\n  ArrayLike<StoreNames<IndexDB>>,\n  'readonly' | 'readwrite'\n>",
          "start_token": 240,
          "end_token": 255,
          "children": [
            {
              "type": "Identifier",
              "label": "IDBPTransaction",
              "start_token": 240,
              "end_token": 240,
              "children": []
            },
            {
              "type": "TypeReference",
              "label": "IndexDB",
              "start_token": 242,
              "end_token": 242,
              "children": [
                {
                  "type": "Identifier",
                  "label": "IndexDB",
                  "start_token": 242,
                  "end_token": 242,
                  "children": []
                }
              ]
            },
            {
              "type": "TypeReference",
              "label": "ArrayLike<StoreNames<IndexDB>>",
              "start_token": 244,
              "end_token": 250,
              "children": [
                {
                  "type": "Identifier",
                  "label": "ArrayLike",
                  "start_token": 244,
                  "end_token": 244,
                  "children": []
                },
                {
                  "type": "TypeReference",
                  "label": "StoreNames<IndexDB>",
                  "start_token": 246,
                  "end_token": 249,
                  "children": [
                    {
                      "type": "Identifier",
                      "label": "StoreNames",
                      "start_token": 246,
                      "end_token": 246,
                      "children": []
                    },
                    {
                      "type": "TypeReference",
                      "label": "IndexDB",
                      "start_token": 248,
                      "end_token": 248,
                      "children": [
                        {
                          "type": "Identifier",
                          "label": "IndexDB",
                          "start_token": 248,
                          "end_token": 248,
                          "children": []
                        }
                      ]
                    }
                  ]
                }
              ]
            },
            {
              "type": "UnionType",
              "label": "'readonly' | 'readwrite'",
              "start_token": 252,
              "end_token": 254,
              "children": [
                {
                  "type": "LiteralType",
                  "label": "'readonly'",
                  "start_token": 252,
                  "end_token": 252,
                  "children": [
                    {
                      "type": "StringLiteral",
                      "label": "'readonly'",
                      "start_token": 252,
                      "end_token": 252,
                      "children": []
                    }
                  ]
                },
                {
                  "type": "LiteralType",
                  "label": "'readwrite'",
                  "start_token": 254,
                  "end_token": 254,
                  "children": [
                    {
                      "type": "StringLiteral",
                      "label": "'readwrite'",
                      "start_token": 254,
                      "end_token": 254,
                      "children": []
                    }
                  ]
                }
              ]
            }
          ]
        }
      ]
    },
    {
      "type": "ClassDeclaration",
      "label": "export class DataStruct {\n  private initializePromise: Promise<void> | null = null;\n  database: IDBPDatabase<IndexDB> = null as any;\n  invertedIndex = new Map<string, InvertedIndex>();\n  constructor(\n    readonly databaseName: string,\n    readonly schema: Schema\n  ) {\n    for (const [key, type] of Object.entries(schema)) {\n      const typeInfo = typeof type === 'string' ? { type } : type;\n      if (typeInfo.index === false) {\n        // If index is false, we don't need to create an inverted index for this field.\n        continue;\n      }\n      if (typeInfo.type === 'String') {\n        this.invertedIndex.set(key, new StringInvertedIndex(key));\n      } else if (typeInfo.type === 'Integer') {\n        this.invertedIndex.set(key, new IntegerInvertedIndex(key));\n      } else if (typeInfo.type === 'FullText') {\n        this.invertedIndex.set(key, new FullTextInvertedIndex(key));\n      } else if (type === 'Boolean') {\n        this.invertedIndex.set(key, new BooleanInvertedIndex(key));\n      } else {\n        throw new Error(`Field type '${type}' not supported`);\n      }\n    }\n  }\n  private async insert(trx: DataStructRWTransaction, document: Document) {\n    const exists = await trx\n      .objectStore('records')\n      .index('id')\n      .get(document.id);\n    if (exists) {\n      throw new Error('Document already exists');\n    }\n    const dataMap = new Map();\n    for (const [key, values] of document.fields) {\n      const type = this.schema[key as string];\n      if (!type) {\n        continue;\n      }\n      const typeInfo = typeof type === 'string' ? { type } : type;\n      if (typeInfo.store !== false) {\n        // If store is false, the field will not be stored\n        dataMap.set(key, values);\n      }\n    }\n    const nid = await trx.objectStore('records').add({\n      id: document.id,\n      data: dataMap,\n    });\n    for (const [key, values] of document.fields) {\n      const iidx = this.invertedIndex.get(key as string);\n      if (!iidx) {\n        continue;\n      }\n      await iidx.insert(trx, nid, values);\n    }\n  }\n  private async delete(trx: DataStructRWTransaction, id: string) {\n    const nid = await trx.objectStore('records').index('id').getKey(id);\n    if (nid) {\n      await trx.objectStore('records').delete(nid);\n    }\n    const indexIds = await trx\n      .objectStore('invertedIndex')\n      .index('nid')\n      .getAllKeys(nid);\n    for (const indexId of indexIds) {\n      await trx.objectStore('invertedIndex').delete(indexId);\n    }\n  }\n  async batchWrite(\n    trx: DataStructRWTransaction,\n    deletes: string[],\n    inserts: Document[]\n  ) {\n    const startTime = performance.now();\n    try {\n      for (const del of deletes) {\n        await this.delete(trx, del);\n      }\n      for (const inst of inserts) {\n        await this.insert(trx, inst);\n      }\n    } finally {\n      const endTime = performance.now();\n      if (BUILD_CONFIG.debug) {\n        performance.measure(\n          `[IndexedDB Indexer] Batch Write (${this.databaseName})`,\n          {\n            start: startTime,\n            end: endTime,\n          }\n        );\n      }\n      logger.debug(\n        `[indexer ${this.databaseName}] batchWrite`,\n        endTime - startTime,\n        'ms'\n      );\n    }\n  }\n  async matchAll(trx: DataStructROTransaction): Promise<Match> {\n    const allNids = await trx.objectStore('records').getAllKeys();\n    const match = new Match();\n    for (const nid of allNids) {\n      match.addScore(nid, 1);\n    }\n    return match;\n  }\n  private async queryRaw(\n    trx: DataStructROTransaction,\n    query: Query<any>\n  ): Promise<Match> {\n    if (query.type === 'match') {\n      const iidx = this.invertedIndex.get(query.field as string);\n      if (!iidx) {\n        return new Match();\n      }\n      return await iidx.match(trx, query.match);\n    } else if (query.type === 'boolean') {\n      const weights = [];\n      for (const q of query.queries) {\n        weights.push(await this.queryRaw(trx, q));\n      }\n      if (query.occur === 'must') {\n        return weights.reduce((acc, w) => acc.and(w));\n      } else if (query.occur === 'must_not') {\n        const total = weights.reduce((acc, w) => acc.and(w));\n        return (await this.matchAll(trx)).exclude(total);\n      } else if (query.occur === 'should') {\n        return weights.reduce((acc, w) => acc.or(w));\n      }\n    } else if (query.type === 'all') {\n      return await this.matchAll(trx);\n    } else if (query.type === 'boost') {\n      return (await this.queryRaw(trx, query.query)).boost(query.boost);\n    } else if (query.type === 'exists') {\n      const iidx = this.invertedIndex.get(query.field as string);\n      if (!iidx) {\n        return new Match();\n      }\n      return await iidx.all(trx);\n    }\n    throw new Error(`Query type '${query.type}' not supported`);\n  }\n  async clear(trx: DataStructRWTransaction) {\n    await trx.objectStore('records').clear();\n    await trx.objectStore('invertedIndex').clear();\n    await trx.objectStore('kvMetadata').clear();\n  }\n  async search(\n    trx: DataStructROTransaction,\n    query: Query<any>,\n    options: SearchOptions<any>\n  ): Promise<SearchResult<any, any>> {\n    const startTime = performance.now();\n    try {\n      const pagination = {\n        skip: options.pagination?.skip ?? 0,\n        limit: options.pagination?.limit ?? 100,\n      };\n      const match = await this.queryRaw(trx, query);\n      const nids = match\n        .toArray()\n        .slice(pagination.skip, pagination.skip + pagination.limit);\n      const nodes = [];\n      for (const nid of nids) {\n        const record = await trx.objectStore('records').get(nid);\n        if (!record) {\n          continue;\n        }\n        nodes.push(this.resultNode(record, options, match, nid));\n      }\n      return {\n        pagination: {\n          count: match.size(),\n          hasMore: match.size() > pagination.limit + pagination.skip,\n          limit: pagination.limit,\n          skip: pagination.skip,\n        },\n        nodes: nodes,\n      };\n    } finally {\n      const endTime = performance.now();\n      if (BUILD_CONFIG.debug) {\n        performance.measure(\n          `[IndexedDB Indexer] Search (${this.databaseName})`,\n          {\n            detail: { query, options },\n            start: startTime,\n            end: endTime,\n          }\n        );\n      }\n      logger.debug(\n        `[indexer ${this.databaseName}] search`,\n        endTime - startTime,\n        'ms',\n        query\n      );\n    }\n  }\n  async aggregate(\n    trx: DataStructROTransaction,\n    query: Query<any>,\n    field: string,\n    options: AggregateOptions<any>\n  ): Promise<AggregateResult<any, any>> {\n    const startTime = performance.now();\n    try {\n      const pagination = {\n        skip: options.pagination?.skip ?? 0,\n        limit: options.pagination?.limit ?? 100,\n      };\n      const hitPagination = options.hits\n        ? {\n            skip: options.hits.pagination?.skip ?? 0,\n            limit: options.hits.pagination?.limit ?? 3,\n          }\n        : {\n            skip: 0,\n            limit: 0,\n          };\n      const match = await this.queryRaw(trx, query);\n      const nids = match.toArray();\n      const buckets: {\n        key: string;\n        nids: number[];\n        hits: SearchResult<any, any>['nodes'];\n      }[] = [];\n      for (const nid of nids) {\n        const record = await trx.objectStore('records').get(nid);\n        if (!record) {\n          continue;\n        }\n        const values = record.data.get(field);\n        for (const value of values ?? []) {\n          let bucket;\n          let bucketIndex = buckets.findIndex(b => b.key === value);\n          if (bucketIndex === -1) {\n            bucket = { key: value, nids: [], hits: [] };\n            buckets.push(bucket);\n            bucketIndex = buckets.length - 1;\n          } else {\n            bucket = buckets[bucketIndex];\n          }\n          if (\n            bucketIndex >= pagination.skip &&\n            bucketIndex < pagination.skip + pagination.limit\n          ) {\n            bucket.nids.push(nid);\n            if (\n              bucket.nids.length - 1 >= hitPagination.skip &&\n              bucket.nids.length - 1 < hitPagination.skip + hitPagination.limit\n            ) {\n              bucket.hits.push(\n                this.resultNode(record, options.hits ?? {}, match, nid)\n              );\n            }\n          }\n        }\n      }\n      return {\n        buckets: buckets\n          .slice(pagination.skip, pagination.skip + pagination.limit)\n          .map(bucket => {\n            const result = {\n              key: bucket.key,\n              score: match.getScore(bucket.nids[0]),\n              count: bucket.nids.length,\n            } as AggregateResult<any, any>['buckets'][number];\n            if (options.hits) {\n              (result as any).hits = {\n                pagination: {\n                  count: bucket.nids.length,\n                  hasMore:\n                    bucket.nids.length >\n                    hitPagination.limit + hitPagination.skip,\n                  limit: hitPagination.limit,\n                  skip: hitPagination.skip,\n                },\n                nodes: bucket.hits,\n              } as SearchResult<any, any>;\n            }\n            return result;\n          }),\n        pagination: {\n          count: buckets.length,\n          hasMore: buckets.length > pagination.limit + pagination.skip,\n          limit: pagination.limit,\n          skip: pagination.skip,\n        },\n      };\n    } finally {\n      const endTime = performance.now();\n      if (BUILD_CONFIG.debug) {\n        performance.measure(\n          `[IndexedDB Indexer] Aggregate (${this.databaseName})`,\n          {\n            detail: { query, field, options },\n            start: startTime,\n            end: endTime,\n          }\n        );\n      }\n      logger.debug(\n        `[indexer ${this.databaseName}] aggregate`,\n        endTime - startTime,\n        'ms'\n      );\n    }\n  }\n  async getAll(\n    trx: DataStructROTransaction,\n    ids?: string[]\n  ): Promise<Document[]> {\n    const docs = [];\n    if (ids) {\n      for (const id of ids) {\n        const record = await trx.objectStore('records').index('id').get(id);\n        if (record) {\n          docs.push(Document.from(record.id, record.data));\n        }\n      }\n    } else {\n      const records = await trx.objectStore('records').getAll();\n      for (const record of records) {\n        docs.push(Document.from(record.id, record.data));\n      }\n    }\n    return docs;\n  }\n  async has(trx: DataStructROTransaction, id: string): Promise<boolean> {\n    const nid = await trx.objectStore('records').index('id').getKey(id);\n    return nid !== undefined;\n  }\n  async readonly() {\n    await this.ensureInitialized();\n    return this.database.transaction(\n      ['records', 'invertedIndex', 'kvMetadata'],\n      'readonly',\n      {\n        durability: 'relaxed',\n      }\n    );\n  }\n  async readwrite() {\n    await this.ensureInitialized();\n    return this.database.transaction(\n      ['records', 'invertedIndex', 'kvMetadata'],\n      'readwrite',\n      {\n        durability: 'relaxed',\n      }\n    );\n  }\n  private async ensureInitialized() {\n    if (this.database) {\n      return;\n    }\n    this.initializePromise ??= this.initialize();\n    await this.initializePromise;\n  }\n  private async initialize() {\n    this.database = await openDB<IndexDB>(this.databaseName, 1, {\n      upgrade(database) {\n        database.createObjectStore('kvMetadata', {\n          keyPath: 'key',\n        });\n        const recordsStore = database.createObjectStore('records', {\n          autoIncrement: true,\n        });\n        recordsStore.createIndex('id', 'id', {\n          unique: true,\n        });\n        const invertedIndexStore = database.createObjectStore('invertedIndex', {\n          autoIncrement: true,\n        });\n        invertedIndexStore.createIndex('key', 'key', { unique: false });\n        invertedIndexStore.createIndex('nid', 'nid', { unique: false });\n      },\n    });\n  }\n  private resultNode(\n    record: { id: string; data: Map<string, string[]> },\n    options: SearchOptions<any>,\n    match?: Match,\n    nid?: number\n  ): SearchResult<any, any>['nodes'][number] {\n    const node = {\n      id: record.id,\n      score: match && nid ? match.getScore(nid) : 1,\n    } as any;\n    if (options.fields) {\n      const fields = {} as Record<string, string | string[]>;\n      for (const field of options.fields as string[]) {\n        fields[field] = record.data.get(field) ?? [''];\n        if (fields[field].length === 1) {\n          fields[field] = fields[field][0];\n        }\n      }\n      node.fields = fields;\n    }\n    if (match && nid && options.highlights) {\n      const highlights = {} as Record<string, string[]>;\n      for (const { field, before, end } of options.highlights) {\n        const highlightValues = match.getHighlighters(nid, field);\n        if (highlightValues) {\n          const rawValues = record.data.get(field) ?? [];\n          highlights[field] = Array.from(highlightValues)\n            .map(([index, ranges]) => {\n              const raw = rawValues[index];\n              if (raw) {\n                return (\n                  highlighter(raw, before, end, ranges, {\n                    maxPrefix: 20,\n                    maxLength: 50,\n                  }) ?? ''\n                );\n              }\n              return '';\n            })\n            .filter(Boolean);\n        }\n      }\n      node.highlights = highlights;\n    }\n    return node;\n  }\n}",
      "start_token": 257,
      "end_token": 3016,
      "children": [
        {
          "type": "ExportKeyword",
          "label": "export",
          "start_token": 257,
          "end_token": 257,
          "children": []
        },
        {
          "type": "Identifier",
          "label": "DataStruct",
          "start_token": 259,
          "end_token": 259,
          "children": []
        },
        {
          "type": "PropertyDeclaration",
          "label": "private initializePromise: Promise<void> | null = null;",
          "start_token": 261,
          "end_token": 272,
          "children": [
            {
              "type": "PrivateKeyword",
              "label": "private",
              "start_token": 261,
              "end_token": 261,
              "children": []
            },
            {
              "type": "Identifier",
              "label": "initializePromise",
              "start_token": 262,
              "end_token": 262,
              "children": []
            },
            {
              "type": "UnionType",
              "label": "Promise<void> | null",
              "start_token": 264,
              "end_token": 269,
              "children": [
                {
                  "type": "TypeReference",
                  "label": "Promise<void>",
                  "start_token": 264,
                  "end_token": 267,
                  "children": [
                    {
                      "type": "Identifier",
                      "label": "Promise",
                      "start_token": 264,
                      "end_token": 264,
                      "children": []
                    },
                    {
                      "type": "VoidKeyword",
                      "label": "void",
                      "start_token": 266,
                      "end_token": 266,
                      "children": []
                    }
                  ]
                },
                {
                  "type": "LiteralType",
                  "label": "null",
                  "start_token": 269,
                  "end_token": 269,
                  "children": [
                    {
                      "type": "NullKeyword",
                      "label": "null",
                      "start_token": 269,
                      "end_token": 269,
                      "children": []
                    }
                  ]
                }
              ]
            },
            {
              "type": "NullKeyword",
              "label": "null",
              "start_token": 271,
              "end_token": 271,
              "children": []
            }
          ]
        },
        {
          "type": "PropertyDeclaration",
          "label": "database: IDBPDatabase<IndexDB> = null as any;",
          "start_token": 273,
          "end_token": 283,
          "children": [
            {
              "type": "Identifier",
              "label": "database",
              "start_token": 273,
              "end_token": 273,
              "children": []
            },
            {
              "type": "TypeReference",
              "label": "IDBPDatabase<IndexDB>",
              "start_token": 275,
              "end_token": 278,
              "children": [
                {
                  "type": "Identifier",
                  "label": "IDBPDatabase",
                  "start_token": 275,
                  "end_token": 275,
                  "children": []
                },
                {
                  "type": "TypeReference",
                  "label": "IndexDB",
                  "start_token": 277,
                  "end_token": 277,
                  "children": [
                    {
                      "type": "Identifier",
                      "label": "IndexDB",
                      "start_token": 277,
                      "end_token": 277,
                      "children": []
                    }
                  ]
                }
              ]
            },
            {
              "type": "AsExpression",
              "label": "null as any",
              "start_token": 280,
              "end_token": 282,
              "children": [
                {
                  "type": "NullKeyword",
                  "label": "null",
                  "start_token": 280,
                  "end_token": 280,
                  "children": []
                },
                {
                  "type": "AnyKeyword",
                  "label": "any",
                  "start_token": 282,
                  "end_token": 282,
                  "children": []
                }
              ]
            }
          ]
        },
        {
          "type": "PropertyDeclaration",
          "label": "invertedIndex = new Map<string, InvertedIndex>();",
          "start_token": 284,
          "end_token": 295,
          "children": [
            {
              "type": "Identifier",
              "label": "invertedIndex",
              "start_token": 284,
              "end_token": 284,
              "children": []
            },
            {
              "type": "NewExpression",
              "label": "new Map<string, InvertedIndex>()",
              "start_token": 286,
              "end_token": 294,
              "children": [
                {
                  "type": "Identifier",
                  "label": "Map",
                  "start_token": 287,
                  "end_token": 287,
                  "children": []
                },
                {
                  "type": "StringKeyword",
                  "label": "string",
                  "start_token": 289,
                  "end_token": 289,
                  "children": []
                },
                {
                  "type": "TypeReference",
                  "label": "InvertedIndex",
                  "start_token": 291,
                  "end_token": 291,
                  "children": [
                    {
                      "type": "Identifier",
                      "label": "InvertedIndex",
                      "start_token": 291,
                      "end_token": 291,
                      "children": []
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "type": "Constructor",
          "label": "constructor(\n    readonly databaseName: string,\n    readonly schema: Schema\n  ) {\n    for (const [key, type] of Object.entries(schema)) {\n      const typeInfo = typeof type === 'string' ? { type } : type;\n      if (typeInfo.index === false) {\n        // If index is false, we don't need to create an inverted index for this field.\n        continue;\n      }\n      if (typeInfo.type === 'String') {\n        this.invertedIndex.set(key, new StringInvertedIndex(key));\n      } else if (typeInfo.type === 'Integer') {\n        this.invertedIndex.set(key, new IntegerInvertedIndex(key));\n      } else if (typeInfo.type === 'FullText') {\n        this.invertedIndex.set(key, new FullTextInvertedIndex(key));\n      } else if (type === 'Boolean') {\n        this.invertedIndex.set(key, new BooleanInvertedIndex(key));\n      } else {\n        throw new Error(`Field type '${type}' not supported`);\n      }\n    }\n  }",
          "start_token": 296,
          "end_token": 465,
          "children": [
            {
              "type": "Parameter",
              "label": "readonly databaseName: string",
              "start_token": 298,
              "end_token": 301,
              "children": [
                {
                  "type": "ReadonlyKeyword",
                  "label": "readonly",
                  "start_token": 298,
                  "end_token": 298,
                  "children": []
                },
                {
                  "type": "Identifier",
                  "label": "databaseName",
                  "start_token": 299,
                  "end_token": 299,
                  "children": []
                },
                {
                  "type": "StringKeyword",
                  "label": "string",
                  "start_token": 301,
                  "end_token": 301,
                  "children": []
                }
              ]
            },
            {
              "type": "Parameter",
              "label": "readonly schema: Schema",
              "start_token": 303,
              "end_token": 306,
              "children": [
                {
                  "type": "ReadonlyKeyword",
                  "label": "readonly",
                  "start_token": 303,
                  "end_token": 303,
                  "children": []
                },
                {
                  "type": "Identifier",
                  "label": "schema",
                  "start_token": 304,
                  "end_token": 304,
                  "children": []
                },
                {
                  "type": "TypeReference",
                  "label": "Schema",
                  "start_token": 306,
                  "end_token": 306,
                  "children": [
                    {
                      "type": "Identifier",
                      "label": "Schema",
                      "start_token": 306,
                      "end_token": 306,
                      "children": []
                    }
                  ]
                }
              ]
            },
            {
              "type": "Block",
              "label": "{\n    for (const [key, type] of Object.entries(schema)) {\n      const typeInfo = typeof type === 'string' ? { type } : type;\n      if (typeInfo.index === false) {\n        // If index is false, we don't need to create an inverted index for this field.\n        continue;\n      }\n      if (typeInfo.type === 'String') {\n        this.invertedIndex.set(key, new StringInvertedIndex(key));\n      } else if (typeInfo.type === 'Integer') {\n        this.invertedIndex.set(key, new IntegerInvertedIndex(key));\n      } else if (typeInfo.type === 'FullText') {\n        this.invertedIndex.set(key, new FullTextInvertedIndex(key));\n      } else if (type === 'Boolean') {\n        this.invertedIndex.set(key, new BooleanInvertedIndex(key));\n      } else {\n        throw new Error(`Field type '${type}' not supported`);\n      }\n    }\n  }",
              "start_token": 308,
              "end_token": 465,
              "children": [
                {
                  "type": "ForOfStatement",
                  "label": "for (const [key, type] of Object.entries(schema)) {\n      const typeInfo = typeof type === 'string' ? { type } : type;\n      if (typeInfo.index === false) {\n        // If index is false, we don't need to create an inverted index for this field.\n        continue;\n      }\n      if (typeInfo.type === 'String') {\n        this.invertedIndex.set(key, new StringInvertedIndex(key));\n      } else if (typeInfo.type === 'Integer') {\n        this.invertedIndex.set(key, new IntegerInvertedIndex(key));\n      } else if (typeInfo.type === 'FullText') {\n        this.invertedIndex.set(key, new FullTextInvertedIndex(key));\n      } else if (type === 'Boolean') {\n        this.invertedIndex.set(key, new BooleanInvertedIndex(key));\n      } else {\n        throw new Error(`Field type '${type}' not supported`);\n      }\n    }",
                  "start_token": 309,
                  "end_token": 464,
                  "children": [
                    {
                      "type": "VariableDeclarationList",
                      "label": "const [key, type]",
                      "start_token": 311,
                      "end_token": 316,
                      "children": [
                        {
                          "type": "VariableDeclaration",
                          "label": "[key, type]",
                          "start_token": 312,
                          "end_token": 316,
                          "children": [
                            {
                              "type": "ArrayBindingPattern",
                              "label": "[key, type]",
                              "start_token": 312,
                              "end_token": 316,
                              "children": [
                                {
                                  "type": "BindingElement",
                                  "label": "key",
                                  "start_token": 313,
                                  "end_token": 313,
                                  "children": [
                                    {
                                      "type": "Identifier",
                                      "label": "key",
                                      "start_token": 313,
                                      "end_token": 313,
                                      "children": []
                                    }
                                  ]
                                },
                                {
                                  "type": "BindingElement",
                                  "label": "type",
                                  "start_token": 315,
                                  "end_token": 315,
                                  "children": [
                                    {
                                      "type": "Identifier",
                                      "label": "type",
                                      "start_token": 315,
                                      "end_token": 315,
                                      "children": []
                                    }
                                  ]
                                }
                              ]
                            }
                          ]
                        }
                      ]
                    },
                    {
                      "type": "CallExpression",
                      "label": "Object.entries(schema)",
                      "start_token": 318,
                      "end_token": 323,
                      "children": [
                        {
                          "type": "PropertyAccessExpression",
                          "label": "Object.entries",
                          "start_token": 318,
                          "end_token": 320,
                          "children": [
                            {
                              "type": "Identifier",
                              "label": "Object",
                              "start_token": 318,
                              "end_token": 318,
                              "children": []
                            },
                            {
                              "type": "Identifier",
                              "label": "entries",
                              "start_token": 320,
                              "end_token": 320,
                              "children": []
                            }
                          ]
                        },
                        {
                          "type": "Identifier",
                          "label": "schema",
                          "start_token": 322,
                          "end_token": 322,
                          "children": []
                        }
                      ]
                    },
                    {
                      "type": "Block",
                      "label": "{\n      const typeInfo = typeof type === 'string' ? { type } : type;\n      if (typeInfo.index === false) {\n        // If index is false, we don't need to create an inverted index for this field.\n        continue;\n      }\n      if (typeInfo.type === 'String') {\n        this.invertedIndex.set(key, new StringInvertedIndex(key));\n      } else if (typeInfo.type === 'Integer') {\n        this.invertedIndex.set(key, new IntegerInvertedIndex(key));\n      } else if (typeInfo.type === 'FullText') {\n        this.invertedIndex.set(key, new FullTextInvertedIndex(key));\n      } else if (type === 'Boolean') {\n        this.invertedIndex.set(key, new BooleanInvertedIndex(key));\n      } else {\n        throw new Error(`Field type '${type}' not supported`);\n      }\n    }",
                      "start_token": 325,
                      "end_token": 464,
                      "children": [
                        {
                          "type": "FirstStatement",
                          "label": "const typeInfo = typeof type === 'string' ? { type } : type;",
                          "start_token": 326,
                          "end_token": 339,
                          "children": [
                            {
                              "type": "VariableDeclarationList",
                              "label": "const typeInfo = typeof type === 'string' ? { type } : type",
                              "start_token": 326,
                              "end_token": 338,
                              "children": [
                                {
                                  "type": "VariableDeclaration",
                                  "label": "typeInfo = typeof type === 'string' ? { type } : type",
                                  "start_token": 327,
                                  "end_token": 338,
                                  "children": [
                                    {
                                      "type": "Identifier",
                                      "label": "typeInfo",
                                      "start_token": 327,
                                      "end_token": 327,
                                      "children": []
                                    },
                                    {
                                      "type": "ConditionalExpression",
                                      "label": "typeof type === 'string' ? { type } : type",
                                      "start_token": 329,
                                      "end_token": 338,
                                      "children": [
                                        {
                                          "type": "BinaryExpression",
                                          "label": "typeof type === 'string'",
                                          "start_token": 329,
                                          "end_token": 332,
                                          "children": [
                                            {
                                              "type": "TypeOfExpression",
                                              "label": "typeof type",
                                              "start_token": 329,
                                              "end_token": 330,
                                              "children": [
                                                {
                                                  "type": "Identifier",
                                                  "label": "type",
                                                  "start_token": 330,
                                                  "end_token": 330,
                                                  "children": []
                                                }
                                              ]
                                            },
                                            {
                                              "type": "EqualsEqualsEqualsToken",
                                              "label": "===",
                                              "start_token": 331,
                                              "end_token": 331,
                                              "children": []
                                            },
                                            {
                                              "type": "StringLiteral",
                                              "label": "'string'",
                                              "start_token": 332,
                                              "end_token": 332,
                                              "children": []
                                            }
                                          ]
                                        },
                                        {
                                          "type": "QuestionToken",
                                          "label": "?",
                                          "start_token": 333,
                                          "end_token": 333,
                                          "children": []
                                        },
                                        {
                                          "type": "ObjectLiteralExpression",
                                          "label": "{ type }",
                                          "start_token": 334,
                                          "end_token": 336,
                                          "children": [
                                            {
                                              "type": "ShorthandPropertyAssignment",
                                              "label": "type",
                                              "start_token": 335,
                                              "end_token": 335,
                                              "children": [
                                                {
                                                  "type": "Identifier",
                                                  "label": "type",
                                                  "start_token": 335,
                                                  "end_token": 335,
                                                  "children": []
                                                }
                                              ]
                                            }
                                          ]
                                        },
                                        {
                                          "type": "ColonToken",
                                          "label": ":",
                                          "start_token": 337,
                                          "end_token": 337,
                                          "children": []
                                        },
                                        {
                                          "type": "Identifier",
                                          "label": "type",
                                          "start_token": 338,
                                          "end_token": 338,
                                          "children": []
                                        }
                                      ]
                                    }
                                  ]
                                }
                              ]
                            }
                          ]
                        },
                        {
                          "type": "IfStatement",
                          "label": "if (typeInfo.index === false) {\n        // If index is false, we don't need to create an inverted index for this field.\n        continue;\n      }",
                          "start_token": 340,
                          "end_token": 352,
                          "children": [
                            {
                              "type": "BinaryExpression",
                              "label": "typeInfo.index === false",
                              "start_token": 342,
                              "end_token": 346,
                              "children": [
                                {
                                  "type": "PropertyAccessExpression",
                                  "label": "typeInfo.index",
                                  "start_token": 342,
                                  "end_token": 344,
                                  "children": [
                                    {
                                      "type": "Identifier",
                                      "label": "typeInfo",
                                      "start_token": 342,
                                      "end_token": 342,
                                      "children": []
                                    },
                                    {
                                      "type": "Identifier",
                                      "label": "index",
                                      "start_token": 344,
                                      "end_token": 344,
                                      "children": []
                                    }
                                  ]
                                },
                                {
                                  "type": "EqualsEqualsEqualsToken",
                                  "label": "===",
                                  "start_token": 345,
                                  "end_token": 345,
                                  "children": []
                                },
                                {
                                  "type": "FalseKeyword",
                                  "label": "false",
                                  "start_token": 346,
                                  "end_token": 346,
                                  "children": []
                                }
                              ]
                            },
                            {
                              "type": "Block",
                              "label": "{\n        // If index is false, we don't need to create an inverted index for this field.\n        continue;\n      }",
                              "start_token": 348,
                              "end_token": 352,
                              "children": [
                                {
                                  "type": "ContinueStatement",
                                  "label": "continue;",
                                  "start_token": 350,
                                  "end_token": 351,
                                  "children": []
                                }
                              ]
                            }
                          ]
                        },
                        {
                          "type": "IfStatement",
                          "label": "if (typeInfo.type === 'String') {\n        this.invertedIndex.set(key, new StringInvertedIndex(key));\n      } else if (typeInfo.type === 'Integer') {\n        this.invertedIndex.set(key, new IntegerInvertedIndex(key));\n      } else if (typeInfo.type === 'FullText') {\n        this.invertedIndex.set(key, new FullTextInvertedIndex(key));\n      } else if (type === 'Boolean') {\n        this.invertedIndex.set(key, new BooleanInvertedIndex(key));\n      } else {\n        throw new Error(`Field type '${type}' not supported`);\n      }",
                          "start_token": 353,
                          "end_token": 463,
                          "children": [
                            {
                              "type": "BinaryExpression",
                              "label": "typeInfo.type === 'String'",
                              "start_token": 355,
                              "end_token": 359,
                              "children": [
                                {
                                  "type": "PropertyAccessExpression",
                                  "label": "typeInfo.type",
                                  "start_token": 355,
                                  "end_token": 357,
                                  "children": [
                                    {
                                      "type": "Identifier",
                                      "label": "typeInfo",
                                      "start_token": 355,
                                      "end_token": 355,
                                      "children": []
                                    },
                                    {
                                      "type": "Identifier",
                                      "label": "type",
                                      "start_token": 357,
                                      "end_token": 357,
                                      "children": []
                                    }
                                  ]
                                },
                                {
                                  "type": "EqualsEqualsEqualsToken",
                                  "label": "===",
                                  "start_token": 358,
                                  "end_token": 358,
                                  "children": []
                                },
                                {
                                  "type": "StringLiteral",
                                  "label": "'String'",
                                  "start_token": 359,
                                  "end_token": 359,
                                  "children": []
                                }
                              ]
                            },
                            {
                              "type": "Block",
                              "label": "{\n        this.invertedIndex.set(key, new StringInvertedIndex(key));\n      }",
                              "start_token": 361,
                              "end_token": 377,
                              "children": [
                                {
                                  "type": "ExpressionStatement",
                                  "label": "this.invertedIndex.set(key, new StringInvertedIndex(key));",
                                  "start_token": 362,
                                  "end_token": 376,
                                  "children": [
                                    {
                                      "type": "CallExpression",
                                      "label": "this.invertedIndex.set(key, new StringInvertedIndex(key))",
                                      "start_token": 362,
                                      "end_token": 375,
                                      "children": [
                                        {
                                          "type": "PropertyAccessExpression",
                                          "label": "this.invertedIndex.set",
                                          "start_token": 362,
                                          "end_token": 366,
                                          "children": [
                                            {
                                              "type": "PropertyAccessExpression",
                                              "label": "this.invertedIndex",
                                              "start_token": 362,
                                              "end_token": 364,
                                              "children": [
                                                {
                                                  "type": "ThisKeyword",
                                                  "label": "this",
                                                  "start_token": 362,
                                                  "end_token": 362,
                                                  "children": []
                                                },
                                                {
                                                  "type": "Identifier",
                                                  "label": "invertedIndex",
                                                  "start_token": 364,
                                                  "end_token": 364,
                                                  "children": []
                                                }
                                              ]
                                            },
                                            {
                                              "type": "Identifier",
                                              "label": "set",
                                              "start_token": 366,
                                              "end_token": 366,
                                              "children": []
                                            }
                                          ]
                                        },
                                        {
                                          "type": "Identifier",
                                          "label": "key",
                                          "start_token": 368,
                                          "end_token": 368,
                                          "children": []
                                        },
                                        {
                                          "type": "NewExpression",
                                          "label": "new StringInvertedIndex(key)",
                                          "start_token": 370,
                                          "end_token": 374,
                                          "children": [
                                            {
                                              "type": "Identifier",
                                              "label": "StringInvertedIndex",
                                              "start_token": 371,
                                              "end_token": 371,
                                              "children": []
                                            },
                                            {
                                              "type": "Identifier",
                                              "label": "key",
                                              "start_token": 373,
                                              "end_token": 373,
                                              "children": []
                                            }
                                          ]
                                        }
                                      ]
                                    }
                                  ]
                                }
                              ]
                            },
                            {
                              "type": "IfStatement",
                              "label": "if (typeInfo.type === 'Integer') {\n        this.invertedIndex.set(key, new IntegerInvertedIndex(key));\n      } else if (typeInfo.type === 'FullText') {\n        this.invertedIndex.set(key, new FullTextInvertedIndex(key));\n      } else if (type === 'Boolean') {\n        this.invertedIndex.set(key, new BooleanInvertedIndex(key));\n      } else {\n        throw new Error(`Field type '${type}' not supported`);\n      }",
                              "start_token": 379,
                              "end_token": 463,
                              "children": [
                                {
                                  "type": "BinaryExpression",
                                  "label": "typeInfo.type === 'Integer'",
                                  "start_token": 381,
                                  "end_token": 385,
                                  "children": [
                                    {
                                      "type": "PropertyAccessExpression",
                                      "label": "typeInfo.type",
                                      "start_token": 381,
                                      "end_token": 383,
                                      "children": [
                                        {
                                          "type": "Identifier",
                                          "label": "typeInfo",
                                          "start_token": 381,
                                          "end_token": 381,
                                          "children": []
                                        },
                                        {
                                          "type": "Identifier",
                                          "label": "type",
                                          "start_token": 383,
                                          "end_token": 383,
                                          "children": []
                                        }
                                      ]
                                    },
                                    {
                                      "type": "EqualsEqualsEqualsToken",
                                      "label": "===",
                                      "start_token": 384,
                                      "end_token": 384,
                                      "children": []
                                    },
                                    {
                                      "type": "StringLiteral",
                                      "label": "'Integer'",
                                      "start_token": 385,
                                      "end_token": 385,
                                      "children": []
                                    }
                                  ]
                                },
                                {
                                  "type": "Block",
                                  "label": "{\n        this.invertedIndex.set(key, new IntegerInvertedIndex(key));\n      }",
                                  "start_token": 387,
                                  "end_token": 403,
                                  "children": [
                                    {
                                      "type": "ExpressionStatement",
                                      "label": "this.invertedIndex.set(key, new IntegerInvertedIndex(key));",
                                      "start_token": 388,
                                      "end_token": 402,
                                      "children": [
                                        {
                                          "type": "CallExpression",
                                          "label": "this.invertedIndex.set(key, new IntegerInvertedIndex(key))",
                                          "start_token": 388,
                                          "end_token": 401,
                                          "children": [
                                            {
                                              "type": "PropertyAccessExpression",
                                              "label": "this.invertedIndex.set",
                                              "start_token": 388,
                                              "end_token": 392,
                                              "children": [
                                                {
                                                  "type": "PropertyAccessExpression",
                                                  "label": "this.invertedIndex",
                                                  "start_token": 388,
                                                  "end_token": 390,
                                                  "children": [
                                                    {
                                                      "type": "ThisKeyword",
                                                      "label": "this",
                                                      "start_token": 388,
                                                      "end_token": 388,
                                                      "children": []
                                                    },
                                                    {
                                                      "type": "Identifier",
                                                      "label": "invertedIndex",
                                                      "start_token": 390,
                                                      "end_token": 390,
                                                      "children": []
                                                    }
                                                  ]
                                                },
                                                {
                                                  "type": "Identifier",
                                                  "label": "set",
                                                  "start_token": 392,
                                                  "end_token": 392,
                                                  "children": []
                                                }
                                              ]
                                            },
                                            {
                                              "type": "Identifier",
                                              "label": "key",
                                              "start_token": 394,
                                              "end_token": 394,
                                              "children": []
                                            },
                                            {
                                              "type": "NewExpression",
                                              "label": "new IntegerInvertedIndex(key)",
                                              "start_token": 396,
                                              "end_token": 400,
                                              "children": [
                                                {
                                                  "type": "Identifier",
                                                  "label": "IntegerInvertedIndex",
                                                  "start_token": 397,
                                                  "end_token": 397,
                                                  "children": []
                                                },
                                                {
                                                  "type": "Identifier",
                                                  "label": "key",
                                                  "start_token": 399,
                                                  "end_token": 399,
                                                  "children": []
                                                }
                                              ]
                                            }
                                          ]
                                        }
                                      ]
                                    }
                                  ]
                                },
                                {
                                  "type": "IfStatement",
                                  "label": "if (typeInfo.type === 'FullText') {\n        this.invertedIndex.set(key, new FullTextInvertedIndex(key));\n      } else if (type === 'Boolean') {\n        this.invertedIndex.set(key, new BooleanInvertedIndex(key));\n      } else {\n        throw new Error(`Field type '${type}' not supported`);\n      }",
                                  "start_token": 405,
                                  "end_token": 463,
                                  "children": [
                                    {
                                      "type": "BinaryExpression",
                                      "label": "typeInfo.type === 'FullText'",
                                      "start_token": 407,
                                      "end_token": 411,
                                      "children": [
                                        {
                                          "type": "PropertyAccessExpression",
                                          "label": "typeInfo.type",
                                          "start_token": 407,
                                          "end_token": 409,
                                          "children": [
                                            {
                                              "type": "Identifier",
                                              "label": "typeInfo",
                                              "start_token": 407,
                                              "end_token": 407,
                                              "children": []
                                            },
                                            {
                                              "type": "Identifier",
                                              "label": "type",
                                              "start_token": 409,
                                              "end_token": 409,
                                              "children": []
                                            }
                                          ]
                                        },
                                        {
                                          "type": "EqualsEqualsEqualsToken",
                                          "label": "===",
                                          "start_token": 410,
                                          "end_token": 410,
                                          "children": []
                                        },
                                        {
                                          "type": "StringLiteral",
                                          "label": "'FullText'",
                                          "start_token": 411,
                                          "end_token": 411,
                                          "children": []
                                        }
                                      ]
                                    },
                                    {
                                      "type": "Block",
                                      "label": "{\n        this.invertedIndex.set(key, new FullTextInvertedIndex(key));\n      }",
                                      "start_token": 413,
                                      "end_token": 429,
                                      "children": [
                                        {
                                          "type": "ExpressionStatement",
                                          "label": "this.invertedIndex.set(key, new FullTextInvertedIndex(key));",
                                          "start_token": 414,
                                          "end_token": 428,
                                          "children": [
                                            {
                                              "type": "CallExpression",
                                              "label": "this.invertedIndex.set(key, new FullTextInvertedIndex(key))",
                                              "start_token": 414,
                                              "end_token": 427,
                                              "children": [
                                                {
                                                  "type": "PropertyAccessExpression",
                                                  "label": "this.invertedIndex.set",
                                                  "start_token": 414,
                                                  "end_token": 418,
                                                  "children": [
                                                    {
                                                      "type": "PropertyAccessExpression",
                                                      "label": "this.invertedIndex",
                                                      "start_token": 414,
                                                      "end_token": 416,
                                                      "children": [
                                                        {
                                                          "type": "ThisKeyword",
                                                          "label": "this",
                                                          "start_token": 414,
                                                          "end_token": 414,
                                                          "children": []
                                                        },
                                                        {
                                                          "type": "Identifier",
                                                          "label": "invertedIndex",
                                                          "start_token": 416,
                                                          "end_token": 416,
                                                          "children": []
                                                        }
                                                      ]
                                                    },
                                                    {
                                                      "type": "Identifier",
                                                      "label": "set",
                                                      "start_token": 418,
                                                      "end_token": 418,
                                                      "children": []
                                                    }
                                                  ]
                                                },
                                                {
                                                  "type": "Identifier",
                                                  "label": "key",
                                                  "start_token": 420,
                                                  "end_token": 420,
                                                  "children": []
                                                },
                                                {
                                                  "type": "NewExpression",
                                                  "label": "new FullTextInvertedIndex(key)",
                                                  "start_token": 422,
                                                  "end_token": 426,
                                                  "children": [
                                                    {
                                                      "type": "Identifier",
                                                      "label": "FullTextInvertedIndex",
                                                      "start_token": 423,
                                                      "end_token": 423,
                                                      "children": []
                                                    },
                                                    {
                                                      "type": "Identifier",
                                                      "label": "key",
                                                      "start_token": 425,
                                                      "end_token": 425,
                                                      "children": []
                                                    }
                                                  ]
                                                }
                                              ]
                                            }
                                          ]
                                        }
                                      ]
                                    },
                                    {
                                      "type": "IfStatement",
                                      "label": "if (type === 'Boolean') {\n        this.invertedIndex.set(key, new BooleanInvertedIndex(key));\n      } else {\n        throw new Error(`Field type '${type}' not supported`);\n      }",
                                      "start_token": 431,
                                      "end_token": 463,
                                      "children": [
                                        {
                                          "type": "BinaryExpression",
                                          "label": "type === 'Boolean'",
                                          "start_token": 433,
                                          "end_token": 435,
                                          "children": [
                                            {
                                              "type": "Identifier",
                                              "label": "type",
                                              "start_token": 433,
                                              "end_token": 433,
                                              "children": []
                                            },
                                            {
                                              "type": "EqualsEqualsEqualsToken",
                                              "label": "===",
                                              "start_token": 434,
                                              "end_token": 434,
                                              "children": []
                                            },
                                            {
                                              "type": "StringLiteral",
                                              "label": "'Boolean'",
                                              "start_token": 435,
                                              "end_token": 435,
                                              "children": []
                                            }
                                          ]
                                        },
                                        {
                                          "type": "Block",
                                          "label": "{\n        this.invertedIndex.set(key, new BooleanInvertedIndex(key));\n      }",
                                          "start_token": 437,
                                          "end_token": 453,
                                          "children": [
                                            {
                                              "type": "ExpressionStatement",
                                              "label": "this.invertedIndex.set(key, new BooleanInvertedIndex(key));",
                                              "start_token": 438,
                                              "end_token": 452,
                                              "children": [
                                                {
                                                  "type": "CallExpression",
                                                  "label": "this.invertedIndex.set(key, new BooleanInvertedIndex(key))",
                                                  "start_token": 438,
                                                  "end_token": 451,
                                                  "children": [
                                                    {
                                                      "type": "PropertyAccessExpression",
                                                      "label": "this.invertedIndex.set",
                                                      "start_token": 438,
                                                      "end_token": 442,
                                                      "children": [
                                                        {
                                                          "type": "PropertyAccessExpression",
                                                          "label": "this.invertedIndex",
                                                          "start_token": 438,
                                                          "end_token": 440,
                                                          "children": [
                                                            {
                                                              "type": "ThisKeyword",
                                                              "label": "this",
                                                              "start_token": 438,
                                                              "end_token": 438,
                                                              "children": []
                                                            },
                                                            {
                                                              "type": "Identifier",
                                                              "label": "invertedIndex",
                                                              "start_token": 440,
                                                              "end_token": 440,
                                                              "children": []
                                                            }
                                                          ]
                                                        },
                                                        {
                                                          "type": "Identifier",
                                                          "label": "set",
                                                          "start_token": 442,
                                                          "end_token": 442,
                                                          "children": []
                                                        }
                                                      ]
                                                    },
                                                    {
                                                      "type": "Identifier",
                                                      "label": "key",
                                                      "start_token": 444,
                                                      "end_token": 444,
                                                      "children": []
                                                    },
                                                    {
                                                      "type": "NewExpression",
                                                      "label": "new BooleanInvertedIndex(key)",
                                                      "start_token": 446,
                                                      "end_token": 450,
                                                      "children": [
                                                        {
                                                          "type": "Identifier",
                                                          "label": "BooleanInvertedIndex",
                                                          "start_token": 447,
                                                          "end_token": 447,
                                                          "children": []
                                                        },
                                                        {
                                                          "type": "Identifier",
                                                          "label": "key",
                                                          "start_token": 449,
                                                          "end_token": 449,
                                                          "children": []
                                                        }
                                                      ]
                                                    }
                                                  ]
                                                }
                                              ]
                                            }
                                          ]
                                        },
                                        {
                                          "type": "Block",
                                          "label": "{\n        throw new Error(`Field type '${type}' not supported`);\n      }",
                                          "start_token": 455,
                                          "end_token": 463,
                                          "children": [
                                            {
                                              "type": "ThrowStatement",
                                              "label": "throw new Error(`Field type '${type}' not supported`);",
                                              "start_token": 456,
                                              "end_token": 462,
                                              "children": [
                                                {
                                                  "type": "NewExpression",
                                                  "label": "new Error(`Field type '${type}' not supported`)",
                                                  "start_token": 457,
                                                  "end_token": 461,
                                                  "children": [
                                                    {
                                                      "type": "Identifier",
                                                      "label": "Error",
                                                      "start_token": 458,
                                                      "end_token": 458,
                                                      "children": []
                                                    },
                                                    {
                                                      "type": "TemplateExpression",
                                                      "label": "`Field type '${type}' not supported`",
                                                      "start_token": 460,
                                                      "end_token": 460,
                                                      "children": [
                                                        {
                                                          "type": "TemplateHead",
                                                          "label": "`Field type '${",
                                                          "start_token": 460,
                                                          "end_token": 460,
                                                          "children": []
                                                        },
                                                        {
                                                          "type": "TemplateSpan",
                                                          "label": "type}' not supported`",
                                                          "start_token": 460,
                                                          "end_token": 460,
                                                          "children": [
                                                            {
                                                              "type": "Identifier",
                                                              "label": "type",
                                                              "start_token": 460,
                                                              "end_token": 460,
                                                              "children": []
                                                            },
                                                            {
                                                              "type": "LastTemplateToken",
                                                              "label": "}' not supported`",
                                                              "start_token": 460,
                                                              "end_token": 460,
                                                              "children": []
                                                            }
                                                          ]
                                                        }
                                                      ]
                                                    }
                                                  ]
                                                }
                                              ]
                                            }
                                          ]
                                        }
                                      ]
                                    }
                                  ]
                                }
                              ]
                            }
                          ]
                        }
                      ]
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "type": "MethodDeclaration",
          "label": "private async insert(trx: DataStructRWTransaction, document: Document) {\n    const exists = await trx\n      .objectStore('records')\n      .index('id')\n      .get(document.id);\n    if (exists) {\n      throw new Error('Document already exists');\n    }\n    const dataMap = new Map();\n    for (const [key, values] of document.fields) {\n      const type = this.schema[key as string];\n      if (!type) {\n        continue;\n      }\n      const typeInfo = typeof type === 'string' ? { type } : type;\n      if (typeInfo.store !== false) {\n        // If store is false, the field will not be stored\n        dataMap.set(key, values);\n      }\n    }\n    const nid = await trx.objectStore('records').add({\n      id: document.id,\n      data: dataMap,\n    });\n    for (const [key, values] of document.fields) {\n      const iidx = this.invertedIndex.get(key as string);\n      if (!iidx) {\n        continue;\n      }\n      await iidx.insert(trx, nid, values);\n    }\n  }",
          "start_token": 466,
          "end_token": 670,
          "children": [
            {
              "type": "PrivateKeyword",
              "label": "private",
              "start_token": 466,
              "end_token": 466,
              "children": []
            },
            {
              "type": "AsyncKeyword",
              "label": "async",
              "start_token": 467,
              "end_token": 467,
              "children": []
            },
            {
              "type": "Identifier",
              "label": "insert",
              "start_token": 468,
              "end_token": 468,
              "children": []
            },
            {
              "type": "Parameter",
              "label": "trx: DataStructRWTransaction",
              "start_token": 470,
              "end_token": 472,
              "children": [
                {
                  "type": "Identifier",
                  "label": "trx",
                  "start_token": 470,
                  "end_token": 470,
                  "children": []
                },
                {
                  "type": "TypeReference",
                  "label": "DataStructRWTransaction",
                  "start_token": 472,
                  "end_token": 472,
                  "children": [
                    {
                      "type": "Identifier",
                      "label": "DataStructRWTransaction",
                      "start_token": 472,
                      "end_token": 472,
                      "children": []
                    }
                  ]
                }
              ]
            },
            {
              "type": "Parameter",
              "label": "document: Document",
              "start_token": 474,
              "end_token": 476,
              "children": [
                {
                  "type": "Identifier",
                  "label": "document",
                  "start_token": 474,
                  "end_token": 474,
                  "children": []
                },
                {
                  "type": "TypeReference",
                  "label": "Document",
                  "start_token": 476,
                  "end_token": 476,
                  "children": [
                    {
                      "type": "Identifier",
                      "label": "Document",
                      "start_token": 476,
                      "end_token": 476,
                      "children": []
                    }
                  ]
                }
              ]
            },
            {
              "type": "Block",
              "label": "{\n    const exists = await trx\n      .objectStore('records')\n      .index('id')\n      .get(document.id);\n    if (exists) {\n      throw new Error('Document already exists');\n    }\n    const dataMap = new Map();\n    for (const [key, values] of document.fields) {\n      const type = this.schema[key as string];\n      if (!type) {\n        continue;\n      }\n      const typeInfo = typeof type === 'string' ? { type } : type;\n      if (typeInfo.store !== false) {\n        // If store is false, the field will not be stored\n        dataMap.set(key, values);\n      }\n    }\n    const nid = await trx.objectStore('records').add({\n      id: document.id,\n      data: dataMap,\n    });\n    for (const [key, values] of document.fields) {\n      const iidx = this.invertedIndex.get(key as string);\n      if (!iidx) {\n        continue;\n      }\n      await iidx.insert(trx, nid, values);\n    }\n  }",
              "start_token": 478,
              "end_token": 670,
              "children": [
                {
                  "type": "FirstStatement",
                  "label": "const exists = await trx\n      .objectStore('records')\n      .index('id')\n      .get(document.id);",
                  "start_token": 479,
                  "end_token": 501,
                  "children": [
                    {
                      "type": "VariableDeclarationList",
                      "label": "const exists = await trx\n      .objectStore('records')\n      .index('id')\n      .get(document.id)",
                      "start_token": 479,
                      "end_token": 500,
                      "children": [
                        {
                          "type": "VariableDeclaration",
                          "label": "exists = await trx\n      .objectStore('records')\n      .index('id')\n      .get(document.id)",
                          "start_token": 480,
                          "end_token": 500,
                          "children": [
                            {
                              "type": "Identifier",
                              "label": "exists",
                              "start_token": 480,
                              "end_token": 480,
                              "children": []
                            },
                            {
                              "type": "AwaitExpression",
                              "label": "await trx\n      .objectStore('records')\n      .index('id')\n      .get(document.id)",
                              "start_token": 482,
                              "end_token": 500,
                              "children": [
                                {
                                  "type": "CallExpression",
                                  "label": "trx\n      .objectStore('records')\n      .index('id')\n      .get(document.id)",
                                  "start_token": 483,
                                  "end_token": 500,
                                  "children": [
                                    {
                                      "type": "PropertyAccessExpression",
                                      "label": "trx\n      .objectStore('records')\n      .index('id')\n      .get",
                                      "start_token": 483,
                                      "end_token": 495,
                                      "children": [
                                        {
                                          "type": "CallExpression",
                                          "label": "trx\n      .objectStore('records')\n      .index('id')",
                                          "start_token": 483,
                                          "end_token": 493,
                                          "children": [
                                            {
                                              "type": "PropertyAccessExpression",
                                              "label": "trx\n      .objectStore('records')\n      .index",
                                              "start_token": 483,
                                              "end_token": 490,
                                              "children": [
                                                {
                                                  "type": "CallExpression",
                                                  "label": "trx\n      .objectStore('records')",
                                                  "start_token": 483,
                                                  "end_token": 488,
                                                  "children": [
                                                    {
                                                      "type": "PropertyAccessExpression",
                                                      "label": "trx\n      .objectStore",
                                                      "start_token": 483,
                                                      "end_token": 485,
                                                      "children": [
                                                        {
                                                          "type": "Identifier",
                                                          "label": "trx",
                                                          "start_token": 483,
                                                          "end_token": 483,
                                                          "children": []
                                                        },
                                                        {
                                                          "type": "Identifier",
                                                          "label": "objectStore",
                                                          "start_token": 485,
                                                          "end_token": 485,
                                                          "children": []
                                                        }
                                                      ]
                                                    },
                                                    {
                                                      "type": "StringLiteral",
                                                      "label": "'records'",
                                                      "start_token": 487,
                                                      "end_token": 487,
                                                      "children": []
                                                    }
                                                  ]
                                                },
                                                {
                                                  "type": "Identifier",
                                                  "label": "index",
                                                  "start_token": 490,
                                                  "end_token": 490,
                                                  "children": []
                                                }
                                              ]
                                            },
                                            {
                                              "type": "StringLiteral",
                                              "label": "'id'",
                                              "start_token": 492,
                                              "end_token": 492,
                                              "children": []
                                            }
                                          ]
                                        },
                                        {
                                          "type": "Identifier",
                                          "label": "get",
                                          "start_token": 495,
                                          "end_token": 495,
                                          "children": []
                                        }
                                      ]
                                    },
                                    {
                                      "type": "PropertyAccessExpression",
                                      "label": "document.id",
                                      "start_token": 497,
                                      "end_token": 499,
                                      "children": [
                                        {
                                          "type": "Identifier",
                                          "label": "document",
                                          "start_token": 497,
                                          "end_token": 497,
                                          "children": []
                                        },
                                        {
                                          "type": "Identifier",
                                          "label": "id",
                                          "start_token": 499,
                                          "end_token": 499,
                                          "children": []
                                        }
                                      ]
                                    }
                                  ]
                                }
                              ]
                            }
                          ]
                        }
                      ]
                    }
                  ]
                },
                {
                  "type": "IfStatement",
                  "label": "if (exists) {\n      throw new Error('Document already exists');\n    }",
                  "start_token": 502,
                  "end_token": 514,
                  "children": [
                    {
                      "type": "Identifier",
                      "label": "exists",
                      "start_token": 504,
                      "end_token": 504,
                      "children": []
                    },
                    {
                      "type": "Block",
                      "label": "{\n      throw new Error('Document already exists');\n    }",
                      "start_token": 506,
                      "end_token": 514,
                      "children": [
                        {
                          "type": "ThrowStatement",
                          "label": "throw new Error('Document already exists');",
                          "start_token": 507,
                          "end_token": 513,
                          "children": [
                            {
                              "type": "NewExpression",
                              "label": "new Error('Document already exists')",
                              "start_token": 508,
                              "end_token": 512,
                              "children": [
                                {
                                  "type": "Identifier",
                                  "label": "Error",
                                  "start_token": 509,
                                  "end_token": 509,
                                  "children": []
                                },
                                {
                                  "type": "StringLiteral",
                                  "label": "'Document already exists'",
                                  "start_token": 511,
                                  "end_token": 511,
                                  "children": []
                                }
                              ]
                            }
                          ]
                        }
                      ]
                    }
                  ]
                },
                {
                  "type": "FirstStatement",
                  "label": "const dataMap = new Map();",
                  "start_token": 515,
                  "end_token": 522,
                  "children": [
                    {
                      "type": "VariableDeclarationList",
                      "label": "const dataMap = new Map()",
                      "start_token": 515,
                      "end_token": 521,
                      "children": [
                        {
                          "type": "VariableDeclaration",
                          "label": "dataMap = new Map()",
                          "start_token": 516,
                          "end_token": 521,
                          "children": [
                            {
                              "type": "Identifier",
                              "label": "dataMap",
                              "start_token": 516,
                              "end_token": 516,
                              "children": []
                            },
                            {
                              "type": "NewExpression",
                              "label": "new Map()",
                              "start_token": 518,
                              "end_token": 521,
                              "children": [
                                {
                                  "type": "Identifier",
                                  "label": "Map",
                                  "start_token": 519,
                                  "end_token": 519,
                                  "children": []
                                }
                              ]
                            }
                          ]
                        }
                      ]
                    }
                  ]
                },
                {
                  "type": "ForOfStatement",
                  "label": "for (const [key, values] of document.fields) {\n      const type = this.schema[key as string];\n      if (!type) {\n        continue;\n      }\n      const typeInfo = typeof type === 'string' ? { type } : type;\n      if (typeInfo.store !== false) {\n        // If store is false, the field will not be stored\n        dataMap.set(key, values);\n      }\n    }",
                  "start_token": 523,
                  "end_token": 592,
                  "children": [
                    {
                      "type": "VariableDeclarationList",
                      "label": "const [key, values]",
                      "start_token": 525,
                      "end_token": 530,
                      "children": [
                        {
                          "type": "VariableDeclaration",
                          "label": "[key, values]",
                          "start_token": 526,
                          "end_token": 530,
                          "children": [
                            {
                              "type": "ArrayBindingPattern",
                              "label": "[key, values]",
                              "start_token": 526,
                              "end_token": 530,
                              "children": [
                                {
                                  "type": "BindingElement",
                                  "label": "key",
                                  "start_token": 527,
                                  "end_token": 527,
                                  "children": [
                                    {
                                      "type": "Identifier",
                                      "label": "key",
                                      "start_token": 527,
                                      "end_token": 527,
                                      "children": []
                                    }
                                  ]
                                },
                                {
                                  "type": "BindingElement",
                                  "label": "values",
                                  "start_token": 529,
                                  "end_token": 529,
                                  "children": [
                                    {
                                      "type": "Identifier",
                                      "label": "values",
                                      "start_token": 529,
                                      "end_token": 529,
                                      "children": []
                                    }
                                  ]
                                }
                              ]
                            }
                          ]
                        }
                      ]
                    },
                    {
                      "type": "PropertyAccessExpression",
                      "label": "document.fields",
                      "start_token": 532,
                      "end_token": 534,
                      "children": [
                        {
                          "type": "Identifier",
                          "label": "document",
                          "start_token": 532,
                          "end_token": 532,
                          "children": []
                        },
                        {
                          "type": "Identifier",
                          "label": "fields",
                          "start_token": 534,
                          "end_token": 534,
                          "children": []
                        }
                      ]
                    },
                    {
                      "type": "Block",
                      "label": "{\n      const type = this.schema[key as string];\n      if (!type) {\n        continue;\n      }\n      const typeInfo = typeof type === 'string' ? { type } : type;\n      if (typeInfo.store !== false) {\n        // If store is false, the field will not be stored\n        dataMap.set(key, values);\n      }\n    }",
                      "start_token": 536,
                      "end_token": 592,
                      "children": [
                        {
                          "type": "FirstStatement",
                          "label": "const type = this.schema[key as string];",
                          "start_token": 537,
                          "end_token": 548,
                          "children": [
                            {
                              "type": "VariableDeclarationList",
                              "label": "const type = this.schema[key as string]",
                              "start_token": 537,
                              "end_token": 547,
                              "children": [
                                {
                                  "type": "VariableDeclaration",
                                  "label": "type = this.schema[key as string]",
                                  "start_token": 538,
                                  "end_token": 547,
                                  "children": [
                                    {
                                      "type": "Identifier",
                                      "label": "type",
                                      "start_token": 538,
                                      "end_token": 538,
                                      "children": []
                                    },
                                    {
                                      "type": "ElementAccessExpression",
                                      "label": "this.schema[key as string]",
                                      "start_token": 540,
                                      "end_token": 547,
                                      "children": [
                                        {
                                          "type": "PropertyAccessExpression",
                                          "label": "this.schema",
                                          "start_token": 540,
                                          "end_token": 542,
                                          "children": [
                                            {
                                              "type": "ThisKeyword",
                                              "label": "this",
                                              "start_token": 540,
                                              "end_token": 540,
                                              "children": []
                                            },
                                            {
                                              "type": "Identifier",
                                              "label": "schema",
                                              "start_token": 542,
                                              "end_token": 542,
                                              "children": []
                                            }
                                          ]
                                        },
                                        {
                                          "type": "AsExpression",
                                          "label": "key as string",
                                          "start_token": 544,
                                          "end_token": 546,
                                          "children": [
                                            {
                                              "type": "Identifier",
                                              "label": "key",
                                              "start_token": 544,
                                              "end_token": 544,
                                              "children": []
                                            },
                                            {
                                              "type": "StringKeyword",
                                              "label": "string",
                                              "start_token": 546,
                                              "end_token": 546,
                                              "children": []
                                            }
                                          ]
                                        }
                                      ]
                                    }
                                  ]
                                }
                              ]
                            }
                          ]
                        },
                        {
                          "type": "IfStatement",
                          "label": "if (!type) {\n        continue;\n      }",
                          "start_token": 549,
                          "end_token": 557,
                          "children": [
                            {
                              "type": "PrefixUnaryExpression",
                              "label": "!type",
                              "start_token": 551,
                              "end_token": 552,
                              "children": [
                                {
                                  "type": "Identifier",
                                  "label": "type",
                                  "start_token": 552,
                                  "end_token": 552,
                                  "children": []
                                }
                              ]
                            },
                            {
                              "type": "Block",
                              "label": "{\n        continue;\n      }",
                              "start_token": 554,
                              "end_token": 557,
                              "children": [
                                {
                                  "type": "ContinueStatement",
                                  "label": "continue;",
                                  "start_token": 555,
                                  "end_token": 556,
                                  "children": []
                                }
                              ]
                            }
                          ]
                        },
                        {
                          "type": "FirstStatement",
                          "label": "const typeInfo = typeof type === 'string' ? { type } : type;",
                          "start_token": 558,
                          "end_token": 571,
                          "children": [
                            {
                              "type": "VariableDeclarationList",
                              "label": "const typeInfo = typeof type === 'string' ? { type } : type",
                              "start_token": 558,
                              "end_token": 570,
                              "children": [
                                {
                                  "type": "VariableDeclaration",
                                  "label": "typeInfo = typeof type === 'string' ? { type } : type",
                                  "start_token": 559,
                                  "end_token": 570,
                                  "children": [
                                    {
                                      "type": "Identifier",
                                      "label": "typeInfo",
                                      "start_token": 559,
                                      "end_token": 559,
                                      "children": []
                                    },
                                    {
                                      "type": "ConditionalExpression",
                                      "label": "typeof type === 'string' ? { type } : type",
                                      "start_token": 561,
                                      "end_token": 570,
                                      "children": [
                                        {
                                          "type": "BinaryExpression",
                                          "label": "typeof type === 'string'",
                                          "start_token": 561,
                                          "end_token": 564,
                                          "children": [
                                            {
                                              "type": "TypeOfExpression",
                                              "label": "typeof type",
                                              "start_token": 561,
                                              "end_token": 562,
                                              "children": [
                                                {
                                                  "type": "Identifier",
                                                  "label": "type",
                                                  "start_token": 562,
                                                  "end_token": 562,
                                                  "children": []
                                                }
                                              ]
                                            },
                                            {
                                              "type": "EqualsEqualsEqualsToken",
                                              "label": "===",
                                              "start_token": 563,
                                              "end_token": 563,
                                              "children": []
                                            },
                                            {
                                              "type": "StringLiteral",
                                              "label": "'string'",
                                              "start_token": 564,
                                              "end_token": 564,
                                              "children": []
                                            }
                                          ]
                                        },
                                        {
                                          "type": "QuestionToken",
                                          "label": "?",
                                          "start_token": 565,
                                          "end_token": 565,
                                          "children": []
                                        },
                                        {
                                          "type": "ObjectLiteralExpression",
                                          "label": "{ type }",
                                          "start_token": 566,
                                          "end_token": 568,
                                          "children": [
                                            {
                                              "type": "ShorthandPropertyAssignment",
                                              "label": "type",
                                              "start_token": 567,
                                              "end_token": 567,
                                              "children": [
                                                {
                                                  "type": "Identifier",
                                                  "label": "type",
                                                  "start_token": 567,
                                                  "end_token": 567,
                                                  "children": []
                                                }
                                              ]
                                            }
                                          ]
                                        },
                                        {
                                          "type": "ColonToken",
                                          "label": ":",
                                          "start_token": 569,
                                          "end_token": 569,
                                          "children": []
                                        },
                                        {
                                          "type": "Identifier",
                                          "label": "type",
                                          "start_token": 570,
                                          "end_token": 570,
                                          "children": []
                                        }
                                      ]
                                    }
                                  ]
                                }
                              ]
                            }
                          ]
                        },
                        {
                          "type": "IfStatement",
                          "label": "if (typeInfo.store !== false) {\n        // If store is false, the field will not be stored\n        dataMap.set(key, values);\n      }",
                          "start_token": 572,
                          "end_token": 591,
                          "children": [
                            {
                              "type": "BinaryExpression",
                              "label": "typeInfo.store !== false",
                              "start_token": 574,
                              "end_token": 578,
                              "children": [
                                {
                                  "type": "PropertyAccessExpression",
                                  "label": "typeInfo.store",
                                  "start_token": 574,
                                  "end_token": 576,
                                  "children": [
                                    {
                                      "type": "Identifier",
                                      "label": "typeInfo",
                                      "start_token": 574,
                                      "end_token": 574,
                                      "children": []
                                    },
                                    {
                                      "type": "Identifier",
                                      "label": "store",
                                      "start_token": 576,
                                      "end_token": 576,
                                      "children": []
                                    }
                                  ]
                                },
                                {
                                  "type": "ExclamationEqualsEqualsToken",
                                  "label": "!==",
                                  "start_token": 577,
                                  "end_token": 577,
                                  "children": []
                                },
                                {
                                  "type": "FalseKeyword",
                                  "label": "false",
                                  "start_token": 578,
                                  "end_token": 578,
                                  "children": []
                                }
                              ]
                            },
                            {
                              "type": "Block",
                              "label": "{\n        // If store is false, the field will not be stored\n        dataMap.set(key, values);\n      }",
                              "start_token": 580,
                              "end_token": 591,
                              "children": [
                                {
                                  "type": "ExpressionStatement",
                                  "label": "dataMap.set(key, values);",
                                  "start_token": 582,
                                  "end_token": 590,
                                  "children": [
                                    {
                                      "type": "CallExpression",
                                      "label": "dataMap.set(key, values)",
                                      "start_token": 582,
                                      "end_token": 589,
                                      "children": [
                                        {
                                          "type": "PropertyAccessExpression",
                                          "label": "dataMap.set",
                                          "start_token": 582,
                                          "end_token": 584,
                                          "children": [
                                            {
                                              "type": "Identifier",
                                              "label": "dataMap",
                                              "start_token": 582,
                                              "end_token": 582,
                                              "children": []
                                            },
                                            {
                                              "type": "Identifier",
                                              "label": "set",
                                              "start_token": 584,
                                              "end_token": 584,
                                              "children": []
                                            }
                                          ]
                                        },
                                        {
                                          "type": "Identifier",
                                          "label": "key",
                                          "start_token": 586,
                                          "end_token": 586,
                                          "children": []
                                        },
                                        {
                                          "type": "Identifier",
                                          "label": "values",
                                          "start_token": 588,
                                          "end_token": 588,
                                          "children": []
                                        }
                                      ]
                                    }
                                  ]
                                }
                              ]
                            }
                          ]
                        }
                      ]
                    }
                  ]
                },
                {
                  "type": "FirstStatement",
                  "label": "const nid = await trx.objectStore('records').add({\n      id: document.id,\n      data: dataMap,\n    });",
                  "start_token": 593,
                  "end_token": 619,
                  "children": [
                    {
                      "type": "VariableDeclarationList",
                      "label": "const nid = await trx.objectStore('records').add({\n      id: document.id,\n      data: dataMap,\n    })",
                      "start_token": 593,
                      "end_token": 618,
                      "children": [
                        {
                          "type": "VariableDeclaration",
                          "label": "nid = await trx.objectStore('records').add({\n      id: document.id,\n      data: dataMap,\n    })",
                          "start_token": 594,
                          "end_token": 618,
                          "children": [
                            {
                              "type": "Identifier",
                              "label": "nid",
                              "start_token": 594,
                              "end_token": 594,
                              "children": []
                            },
                            {
                              "type": "AwaitExpression",
                              "label": "await trx.objectStore('records').add({\n      id: document.id,\n      data: dataMap,\n    })",
                              "start_token": 596,
                              "end_token": 618,
                              "children": [
                                {
                                  "type": "CallExpression",
                                  "label": "trx.objectStore('records').add({\n      id: document.id,\n      data: dataMap,\n    })",
                                  "start_token": 597,
                                  "end_token": 618,
                                  "children": [
                                    {
                                      "type": "PropertyAccessExpression",
                                      "label": "trx.objectStore('records').add",
                                      "start_token": 597,
                                      "end_token": 604,
                                      "children": [
                                        {
                                          "type": "CallExpression",
                                          "label": "trx.objectStore('records')",
                                          "start_token": 597,
                                          "end_token": 602,
                                          "children": [
                                            {
                                              "type": "PropertyAccessExpression",
                                              "label": "trx.objectStore",
                                              "start_token": 597,
                                              "end_token": 599,
                                              "children": [
                                                {
                                                  "type": "Identifier",
                                                  "label": "trx",
                                                  "start_token": 597,
                                                  "end_token": 597,
                                                  "children": []
                                                },
                                                {
                                                  "type": "Identifier",
                                                  "label": "objectStore",
                                                  "start_token": 599,
                                                  "end_token": 599,
                                                  "children": []
                                                }
                                              ]
                                            },
                                            {
                                              "type": "StringLiteral",
                                              "label": "'records'",
                                              "start_token": 601,
                                              "end_token": 601,
                                              "children": []
                                            }
                                          ]
                                        },
                                        {
                                          "type": "Identifier",
                                          "label": "add",
                                          "start_token": 604,
                                          "end_token": 604,
                                          "children": []
                                        }
                                      ]
                                    },
                                    {
                                      "type": "ObjectLiteralExpression",
                                      "label": "{\n      id: document.id,\n      data: dataMap,\n    }",
                                      "start_token": 606,
                                      "end_token": 617,
                                      "children": [
                                        {
                                          "type": "PropertyAssignment",
                                          "label": "id: document.id",
                                          "start_token": 607,
                                          "end_token": 611,
                                          "children": [
                                            {
                                              "type": "Identifier",
                                              "label": "id",
                                              "start_token": 607,
                                              "end_token": 607,
                                              "children": []
                                            },
                                            {
                                              "type": "PropertyAccessExpression",
                                              "label": "document.id",
                                              "start_token": 609,
                                              "end_token": 611,
                                              "children": [
                                                {
                                                  "type": "Identifier",
                                                  "label": "document",
                                                  "start_token": 609,
                                                  "end_token": 609,
                                                  "children": []
                                                },
                                                {
                                                  "type": "Identifier",
                                                  "label": "id",
                                                  "start_token": 611,
                                                  "end_token": 611,
                                                  "children": []
                                                }
                                              ]
                                            }
                                          ]
                                        },
                                        {
                                          "type": "PropertyAssignment",
                                          "label": "data: dataMap",
                                          "start_token": 613,
                                          "end_token": 615,
                                          "children": [
                                            {
                                              "type": "Identifier",
                                              "label": "data",
                                              "start_token": 613,
                                              "end_token": 613,
                                              "children": []
                                            },
                                            {
                                              "type": "Identifier",
                                              "label": "dataMap",
                                              "start_token": 615,
                                              "end_token": 615,
                                              "children": []
                                            }
                                          ]
                                        }
                                      ]
                                    }
                                  ]
                                }
                              ]
                            }
                          ]
                        }
                      ]
                    }
                  ]
                },
                {
                  "type": "ForOfStatement",
                  "label": "for (const [key, values] of document.fields) {\n      const iidx = this.invertedIndex.get(key as string);\n      if (!iidx) {\n        continue;\n      }\n      await iidx.insert(trx, nid, values);\n    }",
                  "start_token": 620,
                  "end_token": 669,
                  "children": [
                    {
                      "type": "VariableDeclarationList",
                      "label": "const [key, values]",
                      "start_token": 622,
                      "end_token": 627,
                      "children": [
                        {
                          "type": "VariableDeclaration",
                          "label": "[key, values]",
                          "start_token": 623,
                          "end_token": 627,
                          "children": [
                            {
                              "type": "ArrayBindingPattern",
                              "label": "[key, values]",
                              "start_token": 623,
                              "end_token": 627,
                              "children": [
                                {
                                  "type": "BindingElement",
                                  "label": "key",
                                  "start_token": 624,
                                  "end_token": 624,
                                  "children": [
                                    {
                                      "type": "Identifier",
                                      "label": "key",
                                      "start_token": 624,
                                      "end_token": 624,
                                      "children": []
                                    }
                                  ]
                                },
                                {
                                  "type": "BindingElement",
                                  "label": "values",
                                  "start_token": 626,
                                  "end_token": 626,
                                  "children": [
                                    {
                                      "type": "Identifier",
                                      "label": "values",
                                      "start_token": 626,
                                      "end_token": 626,
                                      "children": []
                                    }
                                  ]
                                }
                              ]
                            }
                          ]
                        }
                      ]
                    },
                    {
                      "type": "PropertyAccessExpression",
                      "label": "document.fields",
                      "start_token": 629,
                      "end_token": 631,
                      "children": [
                        {
                          "type": "Identifier",
                          "label": "document",
                          "start_token": 629,
                          "end_token": 629,
                          "children": []
                        },
                        {
                          "type": "Identifier",
                          "label": "fields",
                          "start_token": 631,
                          "end_token": 631,
                          "children": []
                        }
                      ]
                    },
                    {
                      "type": "Block",
                      "label": "{\n      const iidx = this.invertedIndex.get(key as string);\n      if (!iidx) {\n        continue;\n      }\n      await iidx.insert(trx, nid, values);\n    }",
                      "start_token": 633,
                      "end_token": 669,
                      "children": [
                        {
                          "type": "FirstStatement",
                          "label": "const iidx = this.invertedIndex.get(key as string);",
                          "start_token": 634,
                          "end_token": 647,
                          "children": [
                            {
                              "type": "VariableDeclarationList",
                              "label": "const iidx = this.invertedIndex.get(key as string)",
                              "start_token": 634,
                              "end_token": 646,
                              "children": [
                                {
                                  "type": "VariableDeclaration",
                                  "label": "iidx = this.invertedIndex.get(key as string)",
                                  "start_token": 635,
                                  "end_token": 646,
                                  "children": [
                                    {
                                      "type": "Identifier",
                                      "label": "iidx",
                                      "start_token": 635,
                                      "end_token": 635,
                                      "children": []
                                    },
                                    {
                                      "type": "CallExpression",
                                      "label": "this.invertedIndex.get(key as string)",
                                      "start_token": 637,
                                      "end_token": 646,
                                      "children": [
                                        {
                                          "type": "PropertyAccessExpression",
                                          "label": "this.invertedIndex.get",
                                          "start_token": 637,
                                          "end_token": 641,
                                          "children": [
                                            {
                                              "type": "PropertyAccessExpression",
                                              "label": "this.invertedIndex",
                                              "start_token": 637,
                                              "end_token": 639,
                                              "children": [
                                                {
                                                  "type": "ThisKeyword",
                                                  "label": "this",
                                                  "start_token": 637,
                                                  "end_token": 637,
                                                  "children": []
                                                },
                                                {
                                                  "type": "Identifier",
                                                  "label": "invertedIndex",
                                                  "start_token": 639,
                                                  "end_token": 639,
                                                  "children": []
                                                }
                                              ]
                                            },
                                            {
                                              "type": "Identifier",
                                              "label": "get",
                                              "start_token": 641,
                                              "end_token": 641,
                                              "children": []
                                            }
                                          ]
                                        },
                                        {
                                          "type": "AsExpression",
                                          "label": "key as string",
                                          "start_token": 643,
                                          "end_token": 645,
                                          "children": [
                                            {
                                              "type": "Identifier",
                                              "label": "key",
                                              "start_token": 643,
                                              "end_token": 643,
                                              "children": []
                                            },
                                            {
                                              "type": "StringKeyword",
                                              "label": "string",
                                              "start_token": 645,
                                              "end_token": 645,
                                              "children": []
                                            }
                                          ]
                                        }
                                      ]
                                    }
                                  ]
                                }
                              ]
                            }
                          ]
                        },
                        {
                          "type": "IfStatement",
                          "label": "if (!iidx) {\n        continue;\n      }",
                          "start_token": 648,
                          "end_token": 656,
                          "children": [
                            {
                              "type": "PrefixUnaryExpression",
                              "label": "!iidx",
                              "start_token": 650,
                              "end_token": 651,
                              "children": [
                                {
                                  "type": "Identifier",
                                  "label": "iidx",
                                  "start_token": 651,
                                  "end_token": 651,
                                  "children": []
                                }
                              ]
                            },
                            {
                              "type": "Block",
                              "label": "{\n        continue;\n      }",
                              "start_token": 653,
                              "end_token": 656,
                              "children": [
                                {
                                  "type": "ContinueStatement",
                                  "label": "continue;",
                                  "start_token": 654,
                                  "end_token": 655,
                                  "children": []
                                }
                              ]
                            }
                          ]
                        },
                        {
                          "type": "ExpressionStatement",
                          "label": "await iidx.insert(trx, nid, values);",
                          "start_token": 657,
                          "end_token": 668,
                          "children": [
                            {
                              "type": "AwaitExpression",
                              "label": "await iidx.insert(trx, nid, values)",
                              "start_token": 657,
                              "end_token": 667,
                              "children": [
                                {
                                  "type": "CallExpression",
                                  "label": "iidx.insert(trx, nid, values)",
                                  "start_token": 658,
                                  "end_token": 667,
                                  "children": [
                                    {
                                      "type": "PropertyAccessExpression",
                                      "label": "iidx.insert",
                                      "start_token": 658,
                                      "end_token": 660,
                                      "children": [
                                        {
                                          "type": "Identifier",
                                          "label": "iidx",
                                          "start_token": 658,
                                          "end_token": 658,
                                          "children": []
                                        },
                                        {
                                          "type": "Identifier",
                                          "label": "insert",
                                          "start_token": 660,
                                          "end_token": 660,
                                          "children": []
                                        }
                                      ]
                                    },
                                    {
                                      "type": "Identifier",
                                      "label": "trx",
                                      "start_token": 662,
                                      "end_token": 662,
                                      "children": []
                                    },
                                    {
                                      "type": "Identifier",
                                      "label": "nid",
                                      "start_token": 664,
                                      "end_token": 664,
                                      "children": []
                                    },
                                    {
                                      "type": "Identifier",
                                      "label": "values",
                                      "start_token": 666,
                                      "end_token": 666,
                                      "children": []
                                    }
                                  ]
                                }
                              ]
                            }
                          ]
                        }
                      ]
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "type": "MethodDeclaration",
          "label": "private async delete(trx: DataStructRWTransaction, id: string) {\n    const nid = await trx.objectStore('records').index('id').getKey(id);\n    if (nid) {\n      await trx.objectStore('records').delete(nid);\n    }\n    const indexIds = await trx\n      .objectStore('invertedIndex')\n      .index('nid')\n      .getAllKeys(nid);\n    for (const indexId of indexIds) {\n      await trx.objectStore('invertedIndex').delete(indexId);\n    }\n  }",
          "start_token": 671,
          "end_token": 767,
          "children": [
            {
              "type": "PrivateKeyword",
              "label": "private",
              "start_token": 671,
              "end_token": 671,
              "children": []
            },
            {
              "type": "AsyncKeyword",
              "label": "async",
              "start_token": 672,
              "end_token": 672,
              "children": []
            },
            {
              "type": "Identifier",
              "label": "delete",
              "start_token": 673,
              "end_token": 673,
              "children": []
            },
            {
              "type": "Parameter",
              "label": "trx: DataStructRWTransaction",
              "start_token": 675,
              "end_token": 677,
              "children": [
                {
                  "type": "Identifier",
                  "label": "trx",
                  "start_token": 675,
                  "end_token": 675,
                  "children": []
                },
                {
                  "type": "TypeReference",
                  "label": "DataStructRWTransaction",
                  "start_token": 677,
                  "end_token": 677,
                  "children": [
                    {
                      "type": "Identifier",
                      "label": "DataStructRWTransaction",
                      "start_token": 677,
                      "end_token": 677,
                      "children": []
                    }
                  ]
                }
              ]
            },
            {
              "type": "Parameter",
              "label": "id: string",
              "start_token": 679,
              "end_token": 681,
              "children": [
                {
                  "type": "Identifier",
                  "label": "id",
                  "start_token": 679,
                  "end_token": 679,
                  "children": []
                },
                {
                  "type": "StringKeyword",
                  "label": "string",
                  "start_token": 681,
                  "end_token": 681,
                  "children": []
                }
              ]
            },
            {
              "type": "Block",
              "label": "{\n    const nid = await trx.objectStore('records').index('id').getKey(id);\n    if (nid) {\n      await trx.objectStore('records').delete(nid);\n    }\n    const indexIds = await trx\n      .objectStore('invertedIndex')\n      .index('nid')\n      .getAllKeys(nid);\n    for (const indexId of indexIds) {\n      await trx.objectStore('invertedIndex').delete(indexId);\n    }\n  }",
              "start_token": 683,
              "end_token": 767,
              "children": [
                {
                  "type": "FirstStatement",
                  "label": "const nid = await trx.objectStore('records').index('id').getKey(id);",
                  "start_token": 684,
                  "end_token": 704,
                  "children": [
                    {
                      "type": "VariableDeclarationList",
                      "label": "const nid = await trx.objectStore('records').index('id').getKey(id)",
                      "start_token": 684,
                      "end_token": 703,
                      "children": [
                        {
                          "type": "VariableDeclaration",
                          "label": "nid = await trx.objectStore('records').index('id').getKey(id)",
                          "start_token": 685,
                          "end_token": 703,
                          "children": [
                            {
                              "type": "Identifier",
                              "label": "nid",
                              "start_token": 685,
                              "end_token": 685,
                              "children": []
                            },
                            {
                              "type": "AwaitExpression",
                              "label": "await trx.objectStore('records').index('id').getKey(id)",
                              "start_token": 687,
                              "end_token": 703,
                              "children": [
                                {
                                  "type": "CallExpression",
                                  "label": "trx.objectStore('records').index('id').getKey(id)",
                                  "start_token": 688,
                                  "end_token": 703,
                                  "children": [
                                    {
                                      "type": "PropertyAccessExpression",
                                      "label": "trx.objectStore('records').index('id').getKey",
                                      "start_token": 688,
                                      "end_token": 700,
                                      "children": [
                                        {
                                          "type": "CallExpression",
                                          "label": "trx.objectStore('records').index('id')",
                                          "start_token": 688,
                                          "end_token": 698,
                                          "children": [
                                            {
                                              "type": "PropertyAccessExpression",
                                              "label": "trx.objectStore('records').index",
                                              "start_token": 688,
                                              "end_token": 695,
                                              "children": [
                                                {
                                                  "type": "CallExpression",
                                                  "label": "trx.objectStore('records')",
                                                  "start_token": 688,
                                                  "end_token": 693,
                                                  "children": [
                                                    {
                                                      "type": "PropertyAccessExpression",
                                                      "label": "trx.objectStore",
                                                      "start_token": 688,
                                                      "end_token": 690,
                                                      "children": [
                                                        {
                                                          "type": "Identifier",
                                                          "label": "trx",
                                                          "start_token": 688,
                                                          "end_token": 688,
                                                          "children": []
                                                        },
                                                        {
                                                          "type": "Identifier",
                                                          "label": "objectStore",
                                                          "start_token": 690,
                                                          "end_token": 690,
                                                          "children": []
                                                        }
                                                      ]
                                                    },
                                                    {
                                                      "type": "StringLiteral",
                                                      "label": "'records'",
                                                      "start_token": 692,
                                                      "end_token": 692,
                                                      "children": []
                                                    }
                                                  ]
                                                },
                                                {
                                                  "type": "Identifier",
                                                  "label": "index",
                                                  "start_token": 695,
                                                  "end_token": 695,
                                                  "children": []
                                                }
                                              ]
                                            },
                                            {
                                              "type": "StringLiteral",
                                              "label": "'id'",
                                              "start_token": 697,
                                              "end_token": 697,
                                              "children": []
                                            }
                                          ]
                                        },
                                        {
                                          "type": "Identifier",
                                          "label": "getKey",
                                          "start_token": 700,
                                          "end_token": 700,
                                          "children": []
                                        }
                                      ]
                                    },
                                    {
                                      "type": "Identifier",
                                      "label": "id",
                                      "start_token": 702,
                                      "end_token": 702,
                                      "children": []
                                    }
                                  ]
                                }
                              ]
                            }
                          ]
                        }
                      ]
                    }
                  ]
                },
                {
                  "type": "IfStatement",
                  "label": "if (nid) {\n      await trx.objectStore('records').delete(nid);\n    }",
                  "start_token": 705,
                  "end_token": 723,
                  "children": [
                    {
                      "type": "Identifier",
                      "label": "nid",
                      "start_token": 707,
                      "end_token": 707,
                      "children": []
                    },
                    {
                      "type": "Block",
                      "label": "{\n      await trx.objectStore('records').delete(nid);\n    }",
                      "start_token": 709,
                      "end_token": 723,
                      "children": [
                        {
                          "type": "ExpressionStatement",
                          "label": "await trx.objectStore('records').delete(nid);",
                          "start_token": 710,
                          "end_token": 722,
                          "children": [
                            {
                              "type": "AwaitExpression",
                              "label": "await trx.objectStore('records').delete(nid)",
                              "start_token": 710,
                              "end_token": 721,
                              "children": [
                                {
                                  "type": "CallExpression",
                                  "label": "trx.objectStore('records').delete(nid)",
                                  "start_token": 711,
                                  "end_token": 721,
                                  "children": [
                                    {
                                      "type": "PropertyAccessExpression",
                                      "label": "trx.objectStore('records').delete",
                                      "start_token": 711,
                                      "end_token": 718,
                                      "children": [
                                        {
                                          "type": "CallExpression",
                                          "label": "trx.objectStore('records')",
                                          "start_token": 711,
                                          "end_token": 716,
                                          "children": [
                                            {
                                              "type": "PropertyAccessExpression",
                                              "label": "trx.objectStore",
                                              "start_token": 711,
                                              "end_token": 713,
                                              "children": [
                                                {
                                                  "type": "Identifier",
                                                  "label": "trx",
                                                  "start_token": 711,
                                                  "end_token": 711,
                                                  "children": []
                                                },
                                                {
                                                  "type": "Identifier",
                                                  "label": "objectStore",
                                                  "start_token": 713,
                                                  "end_token": 713,
                                                  "children": []
                                                }
                                              ]
                                            },
                                            {
                                              "type": "StringLiteral",
                                              "label": "'records'",
                                              "start_token": 715,
                                              "end_token": 715,
                                              "children": []
                                            }
                                          ]
                                        },
                                        {
                                          "type": "Identifier",
                                          "label": "delete",
                                          "start_token": 718,
                                          "end_token": 718,
                                          "children": []
                                        }
                                      ]
                                    },
                                    {
                                      "type": "Identifier",
                                      "label": "nid",
                                      "start_token": 720,
                                      "end_token": 720,
                                      "children": []
                                    }
                                  ]
                                }
                              ]
                            }
                          ]
                        }
                      ]
                    }
                  ]
                },
                {
                  "type": "FirstStatement",
                  "label": "const indexIds = await trx\n      .objectStore('invertedIndex')\n      .index('nid')\n      .getAllKeys(nid);",
                  "start_token": 724,
                  "end_token": 744,
                  "children": [
                    {
                      "type": "VariableDeclarationList",
                      "label": "const indexIds = await trx\n      .objectStore('invertedIndex')\n      .index('nid')\n      .getAllKeys(nid)",
                      "start_token": 724,
                      "end_token": 743,
                      "children": [
                        {
                          "type": "VariableDeclaration",
                          "label": "indexIds = await trx\n      .objectStore('invertedIndex')\n      .index('nid')\n      .getAllKeys(nid)",
                          "start_token": 725,
                          "end_token": 743,
                          "children": [
                            {
                              "type": "Identifier",
                              "label": "indexIds",
                              "start_token": 725,
                              "end_token": 725,
                              "children": []
                            },
                            {
                              "type": "AwaitExpression",
                              "label": "await trx\n      .objectStore('invertedIndex')\n      .index('nid')\n      .getAllKeys(nid)",
                              "start_token": 727,
                              "end_token": 743,
                              "children": [
                                {
                                  "type": "CallExpression",
                                  "label": "trx\n      .objectStore('invertedIndex')\n      .index('nid')\n      .getAllKeys(nid)",
                                  "start_token": 728,
                                  "end_token": 743,
                                  "children": [
                                    {
                                      "type": "PropertyAccessExpression",
                                      "label": "trx\n      .objectStore('invertedIndex')\n      .index('nid')\n      .getAllKeys",
                                      "start_token": 728,
                                      "end_token": 740,
                                      "children": [
                                        {
                                          "type": "CallExpression",
                                          "label": "trx\n      .objectStore('invertedIndex')\n      .index('nid')",
                                          "start_token": 728,
                                          "end_token": 738,
                                          "children": [
                                            {
                                              "type": "PropertyAccessExpression",
                                              "label": "trx\n      .objectStore('invertedIndex')\n      .index",
                                              "start_token": 728,
                                              "end_token": 735,
                                              "children": [
                                                {
                                                  "type": "CallExpression",
                                                  "label": "trx\n      .objectStore('invertedIndex')",
                                                  "start_token": 728,
                                                  "end_token": 733,
                                                  "children": [
                                                    {
                                                      "type": "PropertyAccessExpression",
                                                      "label": "trx\n      .objectStore",
                                                      "start_token": 728,
                                                      "end_token": 730,
                                                      "children": [
                                                        {
                                                          "type": "Identifier",
                                                          "label": "trx",
                                                          "start_token": 728,
                                                          "end_token": 728,
                                                          "children": []
                                                        },
                                                        {
                                                          "type": "Identifier",
                                                          "label": "objectStore",
                                                          "start_token": 730,
                                                          "end_token": 730,
                                                          "children": []
                                                        }
                                                      ]
                                                    },
                                                    {
                                                      "type": "StringLiteral",
                                                      "label": "'invertedIndex'",
                                                      "start_token": 732,
                                                      "end_token": 732,
                                                      "children": []
                                                    }
                                                  ]
                                                },
                                                {
                                                  "type": "Identifier",
                                                  "label": "index",
                                                  "start_token": 735,
                                                  "end_token": 735,
                                                  "children": []
                                                }
                                              ]
                                            },
                                            {
                                              "type": "StringLiteral",
                                              "label": "'nid'",
                                              "start_token": 737,
                                              "end_token": 737,
                                              "children": []
                                            }
                                          ]
                                        },
                                        {
                                          "type": "Identifier",
                                          "label": "getAllKeys",
                                          "start_token": 740,
                                          "end_token": 740,
                                          "children": []
                                        }
                                      ]
                                    },
                                    {
                                      "type": "Identifier",
                                      "label": "nid",
                                      "start_token": 742,
                                      "end_token": 742,
                                      "children": []
                                    }
                                  ]
                                }
                              ]
                            }
                          ]
                        }
                      ]
                    }
                  ]
                },
                {
                  "type": "ForOfStatement",
                  "label": "for (const indexId of indexIds) {\n      await trx.objectStore('invertedIndex').delete(indexId);\n    }",
                  "start_token": 745,
                  "end_token": 766,
                  "children": [
                    {
                      "type": "VariableDeclarationList",
                      "label": "const indexId",
                      "start_token": 747,
                      "end_token": 748,
                      "children": [
                        {
                          "type": "VariableDeclaration",
                          "label": "indexId",
                          "start_token": 748,
                          "end_token": 748,
                          "children": [
                            {
                              "type": "Identifier",
                              "label": "indexId",
                              "start_token": 748,
                              "end_token": 748,
                              "children": []
                            }
                          ]
                        }
                      ]
                    },
                    {
                      "type": "Identifier",
                      "label": "indexIds",
                      "start_token": 750,
                      "end_token": 750,
                      "children": []
                    },
                    {
                      "type": "Block",
                      "label": "{\n      await trx.objectStore('invertedIndex').delete(indexId);\n    }",
                      "start_token": 752,
                      "end_token": 766,
                      "children": [
                        {
                          "type": "ExpressionStatement",
                          "label": "await trx.objectStore('invertedIndex').delete(indexId);",
                          "start_token": 753,
                          "end_token": 765,
                          "children": [
                            {
                              "type": "AwaitExpression",
                              "label": "await trx.objectStore('invertedIndex').delete(indexId)",
                              "start_token": 753,
                              "end_token": 764,
                              "children": [
                                {
                                  "type": "CallExpression",
                                  "label": "trx.objectStore('invertedIndex').delete(indexId)",
                                  "start_token": 754,
                                  "end_token": 764,
                                  "children": [
                                    {
                                      "type": "PropertyAccessExpression",
                                      "label": "trx.objectStore('invertedIndex').delete",
                                      "start_token": 754,
                                      "end_token": 761,
                                      "children": [
                                        {
                                          "type": "CallExpression",
                                          "label": "trx.objectStore('invertedIndex')",
                                          "start_token": 754,
                                          "end_token": 759,
                                          "children": [
                                            {
                                              "type": "PropertyAccessExpression",
                                              "label": "trx.objectStore",
                                              "start_token": 754,
                                              "end_token": 756,
                                              "children": [
                                                {
                                                  "type": "Identifier",
                                                  "label": "trx",
                                                  "start_token": 754,
                                                  "end_token": 754,
                                                  "children": []
                                                },
                                                {
                                                  "type": "Identifier",
                                                  "label": "objectStore",
                                                  "start_token": 756,
                                                  "end_token": 756,
                                                  "children": []
                                                }
                                              ]
                                            },
                                            {
                                              "type": "StringLiteral",
                                              "label": "'invertedIndex'",
                                              "start_token": 758,
                                              "end_token": 758,
                                              "children": []
                                            }
                                          ]
                                        },
                                        {
                                          "type": "Identifier",
                                          "label": "delete",
                                          "start_token": 761,
                                          "end_token": 761,
                                          "children": []
                                        }
                                      ]
                                    },
                                    {
                                      "type": "Identifier",
                                      "label": "indexId",
                                      "start_token": 763,
                                      "end_token": 763,
                                      "children": []
                                    }
                                  ]
                                }
                              ]
                            }
                          ]
                        }
                      ]
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "type": "MethodDeclaration",
          "label": "async batchWrite(\n    trx: DataStructRWTransaction,\n    deletes: string[],\n    inserts: Document[]\n  ) {\n    const startTime = performance.now();\n    try {\n      for (const del of deletes) {\n        await this.delete(trx, del);\n      }\n      for (const inst of inserts) {\n        await this.insert(trx, inst);\n      }\n    } finally {\n      const endTime = performance.now();\n      if (BUILD_CONFIG.debug) {\n        performance.measure(\n          `[IndexedDB Indexer] Batch Write (${this.databaseName})`,\n          {\n            start: startTime,\n            end: endTime,\n          }\n        );\n      }\n      logger.debug(\n        `[indexer ${this.databaseName}] batchWrite`,\n        endTime - startTime,\n        'ms'\n      );\n    }\n  }",
          "start_token": 768,
          "end_token": 889,
          "children": [
            {
              "type": "AsyncKeyword",
              "label": "async",
              "start_token": 768,
              "end_token": 768,
              "children": []
            },
            {
              "type": "Identifier",
              "label": "batchWrite",
              "start_token": 769,
              "end_token": 769,
              "children": []
            },
            {
              "type": "Parameter",
              "label": "trx: DataStructRWTransaction",
              "start_token": 771,
              "end_token": 773,
              "children": [
                {
                  "type": "Identifier",
                  "label": "trx",
                  "start_token": 771,
                  "end_token": 771,
                  "children": []
                },
                {
                  "type": "TypeReference",
                  "label": "DataStructRWTransaction",
                  "start_token": 773,
                  "end_token": 773,
                  "children": [
                    {
                      "type": "Identifier",
                      "label": "DataStructRWTransaction",
                      "start_token": 773,
                      "end_token": 773,
                      "children": []
                    }
                  ]
                }
              ]
            },
            {
              "type": "Parameter",
              "label": "deletes: string[]",
              "start_token": 775,
              "end_token": 779,
              "children": [
                {
                  "type": "Identifier",
                  "label": "deletes",
                  "start_token": 775,
                  "end_token": 775,
                  "children": []
                },
                {
                  "type": "ArrayType",
                  "label": "string[]",
                  "start_token": 777,
                  "end_token": 779,
                  "children": [
                    {
                      "type": "StringKeyword",
                      "label": "string",
                      "start_token": 777,
                      "end_token": 777,
                      "children": []
                    }
                  ]
                }
              ]
            },
            {
              "type": "Parameter",
              "label": "inserts: Document[]",
              "start_token": 781,
              "end_token": 785,
              "children": [
                {
                  "type": "Identifier",
                  "label": "inserts",
                  "start_token": 781,
                  "end_token": 781,
                  "children": []
                },
                {
                  "type": "ArrayType",
                  "label": "Document[]",
                  "start_token": 783,
                  "end_token": 785,
                  "children": [
                    {
                      "type": "TypeReference",
                      "label": "Document",
                      "start_token": 783,
                      "end_token": 783,
                      "children": [
                        {
                          "type": "Identifier",
                          "label": "Document",
                          "start_token": 783,
                          "end_token": 783,
                          "children": []
                        }
                      ]
                    }
                  ]
                }
              ]
            },
            {
              "type": "Block",
              "label": "{\n    const startTime = performance.now();\n    try {\n      for (const del of deletes) {\n        await this.delete(trx, del);\n      }\n      for (const inst of inserts) {\n        await this.insert(trx, inst);\n      }\n    } finally {\n      const endTime = performance.now();\n      if (BUILD_CONFIG.debug) {\n        performance.measure(\n          `[IndexedDB Indexer] Batch Write (${this.databaseName})`,\n          {\n            start: startTime,\n            end: endTime,\n          }\n        );\n      }\n      logger.debug(\n        `[indexer ${this.databaseName}] batchWrite`,\n        endTime - startTime,\n        'ms'\n      );\n    }\n  }",
              "start_token": 787,
              "end_token": 889,
              "children": [
                {
                  "type": "FirstStatement",
                  "label": "const startTime = performance.now();",
                  "start_token": 788,
                  "end_token": 796,
                  "children": [
                    {
                      "type": "VariableDeclarationList",
                      "label": "const startTime = performance.now()",
                      "start_token": 788,
                      "end_token": 795,
                      "children": [
                        {
                          "type": "VariableDeclaration",
                          "label": "startTime = performance.now()",
                          "start_token": 789,
                          "end_token": 795,
                          "children": [
                            {
                              "type": "Identifier",
                              "label": "startTime",
                              "start_token": 789,
                              "end_token": 789,
                              "children": []
                            },
                            {
                              "type": "CallExpression",
                              "label": "performance.now()",
                              "start_token": 791,
                              "end_token": 795,
                              "children": [
                                {
                                  "type": "PropertyAccessExpression",
                                  "label": "performance.now",
                                  "start_token": 791,
                                  "end_token": 793,
                                  "children": [
                                    {
                                      "type": "Identifier",
                                      "label": "performance",
                                      "start_token": 791,
                                      "end_token": 791,
                                      "children": []
                                    },
                                    {
                                      "type": "Identifier",
                                      "label": "now",
                                      "start_token": 793,
                                      "end_token": 793,
                                      "children": []
                                    }
                                  ]
                                }
                              ]
                            }
                          ]
                        }
                      ]
                    }
                  ]
                },
                {
                  "type": "TryStatement",
                  "label": "try {\n      for (const del of deletes) {\n        await this.delete(trx, del);\n      }\n      for (const inst of inserts) {\n        await this.insert(trx, inst);\n      }\n    } finally {\n      const endTime = performance.now();\n      if (BUILD_CONFIG.debug) {\n        performance.measure(\n          `[IndexedDB Indexer] Batch Write (${this.databaseName})`,\n          {\n            start: startTime,\n            end: endTime,\n          }\n        );\n      }\n      logger.debug(\n        `[indexer ${this.databaseName}] batchWrite`,\n        endTime - startTime,\n        'ms'\n      );\n    }",
                  "start_token": 797,
                  "end_token": 888,
                  "children": [
                    {
                      "type": "Block",
                      "label": "{\n      for (const del of deletes) {\n        await this.delete(trx, del);\n      }\n      for (const inst of inserts) {\n        await this.insert(trx, inst);\n      }\n    }",
                      "start_token": 798,
                      "end_token": 837,
                      "children": [
                        {
                          "type": "ForOfStatement",
                          "label": "for (const del of deletes) {\n        await this.delete(trx, del);\n      }",
                          "start_token": 799,
                          "end_token": 817,
                          "children": [
                            {
                              "type": "VariableDeclarationList",
                              "label": "const del",
                              "start_token": 801,
                              "end_token": 802,
                              "children": [
                                {
                                  "type": "VariableDeclaration",
                                  "label": "del",
                                  "start_token": 802,
                                  "end_token": 802,
                                  "children": [
                                    {
                                      "type": "Identifier",
                                      "label": "del",
                                      "start_token": 802,
                                      "end_token": 802,
                                      "children": []
                                    }
                                  ]
                                }
                              ]
                            },
                            {
                              "type": "Identifier",
                              "label": "deletes",
                              "start_token": 804,
                              "end_token": 804,
                              "children": []
                            },
                            {
                              "type": "Block",
                              "label": "{\n        await this.delete(trx, del);\n      }",
                              "start_token": 806,
                              "end_token": 817,
                              "children": [
                                {
                                  "type": "ExpressionStatement",
                                  "label": "await this.delete(trx, del);",
                                  "start_token": 807,
                                  "end_token": 816,
                                  "children": [
                                    {
                                      "type": "AwaitExpression",
                                      "label": "await this.delete(trx, del)",
                                      "start_token": 807,
                                      "end_token": 815,
                                      "children": [
                                        {
                                          "type": "CallExpression",
                                          "label": "this.delete(trx, del)",
                                          "start_token": 808,
                                          "end_token": 815,
                                          "children": [
                                            {
                                              "type": "PropertyAccessExpression",
                                              "label": "this.delete",
                                              "start_token": 808,
                                              "end_token": 810,
                                              "children": [
                                                {
                                                  "type": "ThisKeyword",
                                                  "label": "this",
                                                  "start_token": 808,
                                                  "end_token": 808,
                                                  "children": []
                                                },
                                                {
                                                  "type": "Identifier",
                                                  "label": "delete",
                                                  "start_token": 810,
                                                  "end_token": 810,
                                                  "children": []
                                                }
                                              ]
                                            },
                                            {
                                              "type": "Identifier",
                                              "label": "trx",
                                              "start_token": 812,
                                              "end_token": 812,
                                              "children": []
                                            },
                                            {
                                              "type": "Identifier",
                                              "label": "del",
                                              "start_token": 814,
                                              "end_token": 814,
                                              "children": []
                                            }
                                          ]
                                        }
                                      ]
                                    }
                                  ]
                                }
                              ]
                            }
                          ]
                        },
                        {
                          "type": "ForOfStatement",
                          "label": "for (const inst of inserts) {\n        await this.insert(trx, inst);\n      }",
                          "start_token": 818,
                          "end_token": 836,
                          "children": [
                            {
                              "type": "VariableDeclarationList",
                              "label": "const inst",
                              "start_token": 820,
                              "end_token": 821,
                              "children": [
                                {
                                  "type": "VariableDeclaration",
                                  "label": "inst",
                                  "start_token": 821,
                                  "end_token": 821,
                                  "children": [
                                    {
                                      "type": "Identifier",
                                      "label": "inst",
                                      "start_token": 821,
                                      "end_token": 821,
                                      "children": []
                                    }
                                  ]
                                }
                              ]
                            },
                            {
                              "type": "Identifier",
                              "label": "inserts",
                              "start_token": 823,
                              "end_token": 823,
                              "children": []
                            },
                            {
                              "type": "Block",
                              "label": "{\n        await this.insert(trx, inst);\n      }",
                              "start_token": 825,
                              "end_token": 836,
                              "children": [
                                {
                                  "type": "ExpressionStatement",
                                  "label": "await this.insert(trx, inst);",
                                  "start_token": 826,
                                  "end_token": 835,
                                  "children": [
                                    {
                                      "type": "AwaitExpression",
                                      "label": "await this.insert(trx, inst)",
                                      "start_token": 826,
                                      "end_token": 834,
                                      "children": [
                                        {
                                          "type": "CallExpression",
                                          "label": "this.insert(trx, inst)",
                                          "start_token": 827,
                                          "end_token": 834,
                                          "children": [
                                            {
                                              "type": "PropertyAccessExpression",
                                              "label": "this.insert",
                                              "start_token": 827,
                                              "end_token": 829,
                                              "children": [
                                                {
                                                  "type": "ThisKeyword",
                                                  "label": "this",
                                                  "start_token": 827,
                                                  "end_token": 827,
                                                  "children": []
                                                },
                                                {
                                                  "type": "Identifier",
                                                  "label": "insert",
                                                  "start_token": 829,
                                                  "end_token": 829,
                                                  "children": []
                                                }
                                              ]
                                            },
                                            {
                                              "type": "Identifier",
                                              "label": "trx",
                                              "start_token": 831,
                                              "end_token": 831,
                                              "children": []
                                            },
                                            {
                                              "type": "Identifier",
                                              "label": "inst",
                                              "start_token": 833,
                                              "end_token": 833,
                                              "children": []
                                            }
                                          ]
                                        }
                                      ]
                                    }
                                  ]
                                }
                              ]
                            }
                          ]
                        }
                      ]
                    },
                    {
                      "type": "Block",
                      "label": "{\n      const endTime = performance.now();\n      if (BUILD_CONFIG.debug) {\n        performance.measure(\n          `[IndexedDB Indexer] Batch Write (${this.databaseName})`,\n          {\n            start: startTime,\n            end: endTime,\n          }\n        );\n      }\n      logger.debug(\n        `[indexer ${this.databaseName}] batchWrite`,\n        endTime - startTime,\n        'ms'\n      );\n    }",
                      "start_token": 839,
                      "end_token": 888,
                      "children": [
                        {
                          "type": "FirstStatement",
                          "label": "const endTime = performance.now();",
                          "start_token": 840,
                          "end_token": 848,
                          "children": [
                            {
                              "type": "VariableDeclarationList",
                              "label": "const endTime = performance.now()",
                              "start_token": 840,
                              "end_token": 847,
                              "children": [
                                {
                                  "type": "VariableDeclaration",
                                  "label": "endTime = performance.now()",
                                  "start_token": 841,
                                  "end_token": 847,
                                  "children": [
                                    {
                                      "type": "Identifier",
                                      "label": "endTime",
                                      "start_token": 841,
                                      "end_token": 841,
                                      "children": []
                                    },
                                    {
                                      "type": "CallExpression",
                                      "label": "performance.now()",
                                      "start_token": 843,
                                      "end_token": 847,
                                      "children": [
                                        {
                                          "type": "PropertyAccessExpression",
                                          "label": "performance.now",
                                          "start_token": 843,
                                          "end_token": 845,
                                          "children": [
                                            {
                                              "type": "Identifier",
                                              "label": "performance",
                                              "start_token": 843,
                                              "end_token": 843,
                                              "children": []
                                            },
                                            {
                                              "type": "Identifier",
                                              "label": "now",
                                              "start_token": 845,
                                              "end_token": 845,
                                              "children": []
                                            }
                                          ]
                                        }
                                      ]
                                    }
                                  ]
                                }
                              ]
                            }
                          ]
                        },
                        {
                          "type": "IfStatement",
                          "label": "if (BUILD_CONFIG.debug) {\n        performance.measure(\n          `[IndexedDB Indexer] Batch Write (${this.databaseName})`,\n          {\n            start: startTime,\n            end: endTime,\n          }\n        );\n      }",
                          "start_token": 849,
                          "end_token": 874,
                          "children": [
                            {
                              "type": "PropertyAccessExpression",
                              "label": "BUILD_CONFIG.debug",
                              "start_token": 851,
                              "end_token": 853,
                              "children": [
                                {
                                  "type": "Identifier",
                                  "label": "BUILD_CONFIG",
                                  "start_token": 851,
                                  "end_token": 851,
                                  "children": []
                                },
                                {
                                  "type": "Identifier",
                                  "label": "debug",
                                  "start_token": 853,
                                  "end_token": 853,
                                  "children": []
                                }
                              ]
                            },
                            {
                              "type": "Block",
                              "label": "{\n        performance.measure(\n          `[IndexedDB Indexer] Batch Write (${this.databaseName})`,\n          {\n            start: startTime,\n            end: endTime,\n          }\n        );\n      }",
                              "start_token": 855,
                              "end_token": 874,
                              "children": [
                                {
                                  "type": "ExpressionStatement",
                                  "label": "performance.measure(\n          `[IndexedDB Indexer] Batch Write (${this.databaseName})`,\n          {\n            start: startTime,\n            end: endTime,\n          }\n        );",
                                  "start_token": 856,
                                  "end_token": 873,
                                  "children": [
                                    {
                                      "type": "CallExpression",
                                      "label": "performance.measure(\n          `[IndexedDB Indexer] Batch Write (${this.databaseName})`,\n          {\n            start: startTime,\n            end: endTime,\n          }\n        )",
                                      "start_token": 856,
                                      "end_token": 872,
                                      "children": [
                                        {
                                          "type": "PropertyAccessExpression",
                                          "label": "performance.measure",
                                          "start_token": 856,
                                          "end_token": 858,
                                          "children": [
                                            {
                                              "type": "Identifier",
                                              "label": "performance",
                                              "start_token": 856,
                                              "end_token": 856,
                                              "children": []
                                            },
                                            {
                                              "type": "Identifier",
                                              "label": "measure",
                                              "start_token": 858,
                                              "end_token": 858,
                                              "children": []
                                            }
                                          ]
                                        },
                                        {
                                          "type": "TemplateExpression",
                                          "label": "`[IndexedDB Indexer] Batch Write (${this.databaseName})`",
                                          "start_token": 860,
                                          "end_token": 860,
                                          "children": [
                                            {
                                              "type": "TemplateHead",
                                              "label": "`[IndexedDB Indexer] Batch Write (${",
                                              "start_token": 860,
                                              "end_token": 860,
                                              "children": []
                                            },
                                            {
                                              "type": "TemplateSpan",
                                              "label": "this.databaseName})`",
                                              "start_token": 860,
                                              "end_token": 860,
                                              "children": [
                                                {
                                                  "type": "PropertyAccessExpression",
                                                  "label": "this.databaseName",
                                                  "start_token": 860,
                                                  "end_token": 860,
                                                  "children": [
                                                    {
                                                      "type": "ThisKeyword",
                                                      "label": "this",
                                                      "start_token": 860,
                                                      "end_token": 860,
                                                      "children": []
                                                    },
                                                    {
                                                      "type": "Identifier",
                                                      "label": "databaseName",
                                                      "start_token": 860,
                                                      "end_token": 860,
                                                      "children": []
                                                    }
                                                  ]
                                                },
                                                {
                                                  "type": "LastTemplateToken",
                                                  "label": "})`",
                                                  "start_token": 860,
                                                  "end_token": 860,
                                                  "children": []
                                                }
                                              ]
                                            }
                                          ]
                                        },
                                        {
                                          "type": "ObjectLiteralExpression",
                                          "label": "{\n            start: startTime,\n            end: endTime,\n          }",
                                          "start_token": 862,
                                          "end_token": 871,
                                          "children": [
                                            {
                                              "type": "PropertyAssignment",
                                              "label": "start: startTime",
                                              "start_token": 863,
                                              "end_token": 865,
                                              "children": [
                                                {
                                                  "type": "Identifier",
                                                  "label": "start",
                                                  "start_token": 863,
                                                  "end_token": 863,
                                                  "children": []
                                                },
                                                {
                                                  "type": "Identifier",
                                                  "label": "startTime",
                                                  "start_token": 865,
                                                  "end_token": 865,
                                                  "children": []
                                                }
                                              ]
                                            },
                                            {
                                              "type": "PropertyAssignment",
                                              "label": "end: endTime",
                                              "start_token": 867,
                                              "end_token": 869,
                                              "children": [
                                                {
                                                  "type": "Identifier",
                                                  "label": "end",
                                                  "start_token": 867,
                                                  "end_token": 867,
                                                  "children": []
                                                },
                                                {
                                                  "type": "Identifier",
                                                  "label": "endTime",
                                                  "start_token": 869,
                                                  "end_token": 869,
                                                  "children": []
                                                }
                                              ]
                                            }
                                          ]
                                        }
                                      ]
                                    }
                                  ]
                                }
                              ]
                            }
                          ]
                        },
                        {
                          "type": "ExpressionStatement",
                          "label": "logger.debug(\n        `[indexer ${this.databaseName}] batchWrite`,\n        endTime - startTime,\n        'ms'\n      );",
                          "start_token": 875,
                          "end_token": 887,
                          "children": [
                            {
                              "type": "CallExpression",
                              "label": "logger.debug(\n        `[indexer ${this.databaseName}] batchWrite`,\n        endTime - startTime,\n        'ms'\n      )",
                              "start_token": 875,
                              "end_token": 886,
                              "children": [
                                {
                                  "type": "PropertyAccessExpression",
                                  "label": "logger.debug",
                                  "start_token": 875,
                                  "end_token": 877,
                                  "children": [
                                    {
                                      "type": "Identifier",
                                      "label": "logger",
                                      "start_token": 875,
                                      "end_token": 875,
                                      "children": []
                                    },
                                    {
                                      "type": "Identifier",
                                      "label": "debug",
                                      "start_token": 877,
                                      "end_token": 877,
                                      "children": []
                                    }
                                  ]
                                },
                                {
                                  "type": "TemplateExpression",
                                  "label": "`[indexer ${this.databaseName}] batchWrite`",
                                  "start_token": 879,
                                  "end_token": 879,
                                  "children": [
                                    {
                                      "type": "TemplateHead",
                                      "label": "`[indexer ${",
                                      "start_token": 879,
                                      "end_token": 879,
                                      "children": []
                                    },
                                    {
                                      "type": "TemplateSpan",
                                      "label": "this.databaseName}] batchWrite`",
                                      "start_token": 879,
                                      "end_token": 879,
                                      "children": [
                                        {
                                          "type": "PropertyAccessExpression",
                                          "label": "this.databaseName",
                                          "start_token": 879,
                                          "end_token": 879,
                                          "children": [
                                            {
                                              "type": "ThisKeyword",
                                              "label": "this",
                                              "start_token": 879,
                                              "end_token": 879,
                                              "children": []
                                            },
                                            {
                                              "type": "Identifier",
                                              "label": "databaseName",
                                              "start_token": 879,
                                              "end_token": 879,
                                              "children": []
                                            }
                                          ]
                                        },
                                        {
                                          "type": "LastTemplateToken",
                                          "label": "}] batchWrite`",
                                          "start_token": 879,
                                          "end_token": 879,
                                          "children": []
                                        }
                                      ]
                                    }
                                  ]
                                },
                                {
                                  "type": "BinaryExpression",
                                  "label": "endTime - startTime",
                                  "start_token": 881,
                                  "end_token": 883,
                                  "children": [
                                    {
                                      "type": "Identifier",
                                      "label": "endTime",
                                      "start_token": 881,
                                      "end_token": 881,
                                      "children": []
                                    },
                                    {
                                      "type": "MinusToken",
                                      "label": "-",
                                      "start_token": 882,
                                      "end_token": 882,
                                      "children": []
                                    },
                                    {
                                      "type": "Identifier",
                                      "label": "startTime",
                                      "start_token": 883,
                                      "end_token": 883,
                                      "children": []
                                    }
                                  ]
                                },
                                {
                                  "type": "StringLiteral",
                                  "label": "'ms'",
                                  "start_token": 885,
                                  "end_token": 885,
                                  "children": []
                                }
                              ]
                            }
                          ]
                        }
                      ]
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "type": "MethodDeclaration",
          "label": "async matchAll(trx: DataStructROTransaction): Promise<Match> {\n    const allNids = await trx.objectStore('records').getAllKeys();\n    const match = new Match();\n    for (const nid of allNids) {\n      match.addScore(nid, 1);\n    }\n    return match;\n  }",
          "start_token": 890,
          "end_token": 947,
          "children": [
            {
              "type": "AsyncKeyword",
              "label": "async",
              "start_token": 890,
              "end_token": 890,
              "children": []
            },
            {
              "type": "Identifier",
              "label": "matchAll",
              "start_token": 891,
              "end_token": 891,
              "children": []
            },
            {
              "type": "Parameter",
              "label": "trx: DataStructROTransaction",
              "start_token": 893,
              "end_token": 895,
              "children": [
                {
                  "type": "Identifier",
                  "label": "trx",
                  "start_token": 893,
                  "end_token": 893,
                  "children": []
                },
                {
                  "type": "TypeReference",
                  "label": "DataStructROTransaction",
                  "start_token": 895,
                  "end_token": 895,
                  "children": [
                    {
                      "type": "Identifier",
                      "label": "DataStructROTransaction",
                      "start_token": 895,
                      "end_token": 895,
                      "children": []
                    }
                  ]
                }
              ]
            },
            {
              "type": "TypeReference",
              "label": "Promise<Match>",
              "start_token": 898,
              "end_token": 901,
              "children": [
                {
                  "type": "Identifier",
                  "label": "Promise",
                  "start_token": 898,
                  "end_token": 898,
                  "children": []
                },
                {
                  "type": "TypeReference",
                  "label": "Match",
                  "start_token": 900,
                  "end_token": 900,
                  "children": [
                    {
                      "type": "Identifier",
                      "label": "Match",
                      "start_token": 900,
                      "end_token": 900,
                      "children": []
                    }
                  ]
                }
              ]
            },
            {
              "type": "Block",
              "label": "{\n    const allNids = await trx.objectStore('records').getAllKeys();\n    const match = new Match();\n    for (const nid of allNids) {\n      match.addScore(nid, 1);\n    }\n    return match;\n  }",
              "start_token": 902,
              "end_token": 947,
              "children": [
                {
                  "type": "FirstStatement",
                  "label": "const allNids = await trx.objectStore('records').getAllKeys();",
                  "start_token": 903,
                  "end_token": 917,
                  "children": [
                    {
                      "type": "VariableDeclarationList",
                      "label": "const allNids = await trx.objectStore('records').getAllKeys()",
                      "start_token": 903,
                      "end_token": 916,
                      "children": [
                        {
                          "type": "VariableDeclaration",
                          "label": "allNids = await trx.objectStore('records').getAllKeys()",
                          "start_token": 904,
                          "end_token": 916,
                          "children": [
                            {
                              "type": "Identifier",
                              "label": "allNids",
                              "start_token": 904,
                              "end_token": 904,
                              "children": []
                            },
                            {
                              "type": "AwaitExpression",
                              "label": "await trx.objectStore('records').getAllKeys()",
                              "start_token": 906,
                              "end_token": 916,
                              "children": [
                                {
                                  "type": "CallExpression",
                                  "label": "trx.objectStore('records').getAllKeys()",
                                  "start_token": 907,
                                  "end_token": 916,
                                  "children": [
                                    {
                                      "type": "PropertyAccessExpression",
                                      "label": "trx.objectStore('records').getAllKeys",
                                      "start_token": 907,
                                      "end_token": 914,
                                      "children": [
                                        {
                                          "type": "CallExpression",
                                          "label": "trx.objectStore('records')",
                                          "start_token": 907,
                                          "end_token": 912,
                                          "children": [
                                            {
                                              "type": "PropertyAccessExpression",
                                              "label": "trx.objectStore",
                                              "start_token": 907,
                                              "end_token": 909,
                                              "children": [
                                                {
                                                  "type": "Identifier",
                                                  "label": "trx",
                                                  "start_token": 907,
                                                  "end_token": 907,
                                                  "children": []
                                                },
                                                {
                                                  "type": "Identifier",
                                                  "label": "objectStore",
                                                  "start_token": 909,
                                                  "end_token": 909,
                                                  "children": []
                                                }
                                              ]
                                            },
                                            {
                                              "type": "StringLiteral",
                                              "label": "'records'",
                                              "start_token": 911,
                                              "end_token": 911,
                                              "children": []
                                            }
                                          ]
                                        },
                                        {
                                          "type": "Identifier",
                                          "label": "getAllKeys",
                                          "start_token": 914,
                                          "end_token": 914,
                                          "children": []
                                        }
                                      ]
                                    }
                                  ]
                                }
                              ]
                            }
                          ]
                        }
                      ]
                    }
                  ]
                },
                {
                  "type": "FirstStatement",
                  "label": "const match = new Match();",
                  "start_token": 918,
                  "end_token": 925,
                  "children": [
                    {
                      "type": "VariableDeclarationList",
                      "label": "const match = new Match()",
                      "start_token": 918,
                      "end_token": 924,
                      "children": [
                        {
                          "type": "VariableDeclaration",
                          "label": "match = new Match()",
                          "start_token": 919,
                          "end_token": 924,
                          "children": [
                            {
                              "type": "Identifier",
                              "label": "match",
                              "start_token": 919,
                              "end_token": 919,
                              "children": []
                            },
                            {
                              "type": "NewExpression",
                              "label": "new Match()",
                              "start_token": 921,
                              "end_token": 924,
                              "children": [
                                {
                                  "type": "Identifier",
                                  "label": "Match",
                                  "start_token": 922,
                                  "end_token": 922,
                                  "children": []
                                }
                              ]
                            }
                          ]
                        }
                      ]
                    }
                  ]
                },
                {
                  "type": "ForOfStatement",
                  "label": "for (const nid of allNids) {\n      match.addScore(nid, 1);\n    }",
                  "start_token": 926,
                  "end_token": 943,
                  "children": [
                    {
                      "type": "VariableDeclarationList",
                      "label": "const nid",
                      "start_token": 928,
                      "end_token": 929,
                      "children": [
                        {
                          "type": "VariableDeclaration",
                          "label": "nid",
                          "start_token": 929,
                          "end_token": 929,
                          "children": [
                            {
                              "type": "Identifier",
                              "label": "nid",
                              "start_token": 929,
                              "end_token": 929,
                              "children": []
                            }
                          ]
                        }
                      ]
                    },
                    {
                      "type": "Identifier",
                      "label": "allNids",
                      "start_token": 931,
                      "end_token": 931,
                      "children": []
                    },
                    {
                      "type": "Block",
                      "label": "{\n      match.addScore(nid, 1);\n    }",
                      "start_token": 933,
                      "end_token": 943,
                      "children": [
                        {
                          "type": "ExpressionStatement",
                          "label": "match.addScore(nid, 1);",
                          "start_token": 934,
                          "end_token": 942,
                          "children": [
                            {
                              "type": "CallExpression",
                              "label": "match.addScore(nid, 1)",
                              "start_token": 934,
                              "end_token": 941,
                              "children": [
                                {
                                  "type": "PropertyAccessExpression",
                                  "label": "match.addScore",
                                  "start_token": 934,
                                  "end_token": 936,
                                  "children": [
                                    {
                                      "type": "Identifier",
                                      "label": "match",
                                      "start_token": 934,
                                      "end_token": 934,
                                      "children": []
                                    },
                                    {
                                      "type": "Identifier",
                                      "label": "addScore",
                                      "start_token": 936,
                                      "end_token": 936,
                                      "children": []
                                    }
                                  ]
                                },
                                {
                                  "type": "Identifier",
                                  "label": "nid",
                                  "start_token": 938,
                                  "end_token": 938,
                                  "children": []
                                },
                                {
                                  "type": "FirstLiteralToken",
                                  "label": "1",
                                  "start_token": 940,
                                  "end_token": 940,
                                  "children": []
                                }
                              ]
                            }
                          ]
                        }
                      ]
                    }
                  ]
                },
                {
                  "type": "ReturnStatement",
                  "label": "return match;",
                  "start_token": 944,
                  "end_token": 946,
                  "children": [
                    {
                      "type": "Identifier",
                      "label": "match",
                      "start_token": 945,
                      "end_token": 945,
                      "children": []
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "type": "MethodDeclaration",
          "label": "private async queryRaw(\n    trx: DataStructROTransaction,\n    query: Query<any>\n  ): Promise<Match> {\n    if (query.type === 'match') {\n      const iidx = this.invertedIndex.get(query.field as string);\n      if (!iidx) {\n        return new Match();\n      }\n      return await iidx.match(trx, query.match);\n    } else if (query.type === 'boolean') {\n      const weights = [];\n      for (const q of query.queries) {\n        weights.push(await this.queryRaw(trx, q));\n      }\n      if (query.occur === 'must') {\n        return weights.reduce((acc, w) => acc.and(w));\n      } else if (query.occur === 'must_not') {\n        const total = weights.reduce((acc, w) => acc.and(w));\n        return (await this.matchAll(trx)).exclude(total);\n      } else if (query.occur === 'should') {\n        return weights.reduce((acc, w) => acc.or(w));\n      }\n    } else if (query.type === 'all') {\n      return await this.matchAll(trx);\n    } else if (query.type === 'boost') {\n      return (await this.queryRaw(trx, query.query)).boost(query.boost);\n    } else if (query.type === 'exists') {\n      const iidx = this.invertedIndex.get(query.field as string);\n      if (!iidx) {\n        return new Match();\n      }\n      return await iidx.all(trx);\n    }\n    throw new Error(`Query type '${query.type}' not supported`);\n  }",
          "start_token": 948,
          "end_token": 1280,
          "children": [
            {
              "type": "PrivateKeyword",
              "label": "private",
              "start_token": 948,
              "end_token": 948,
              "children": []
            },
            {
              "type": "AsyncKeyword",
              "label": "async",
              "start_token": 949,
              "end_token": 949,
              "children": []
            },
            {
              "type": "Identifier",
              "label": "queryRaw",
              "start_token": 950,
              "end_token": 950,
              "children": []
            },
            {
              "type": "Parameter",
              "label": "trx: DataStructROTransaction",
              "start_token": 952,
              "end_token": 954,
              "children": [
                {
                  "type": "Identifier",
                  "label": "trx",
                  "start_token": 952,
                  "end_token": 952,
                  "children": []
                },
                {
                  "type": "TypeReference",
                  "label": "DataStructROTransaction",
                  "start_token": 954,
                  "end_token": 954,
                  "children": [
                    {
                      "type": "Identifier",
                      "label": "DataStructROTransaction",
                      "start_token": 954,
                      "end_token": 954,
                      "children": []
                    }
                  ]
                }
              ]
            },
            {
              "type": "Parameter",
              "label": "query: Query<any>",
              "start_token": 956,
              "end_token": 961,
              "children": [
                {
                  "type": "Identifier",
                  "label": "query",
                  "start_token": 956,
                  "end_token": 956,
                  "children": []
                },
                {
                  "type": "TypeReference",
                  "label": "Query<any>",
                  "start_token": 958,
                  "end_token": 961,
                  "children": [
                    {
                      "type": "Identifier",
                      "label": "Query",
                      "start_token": 958,
                      "end_token": 958,
                      "children": []
                    },
                    {
                      "type": "AnyKeyword",
                      "label": "any",
                      "start_token": 960,
                      "end_token": 960,
                      "children": []
                    }
                  ]
                }
              ]
            },
            {
              "type": "TypeReference",
              "label": "Promise<Match>",
              "start_token": 964,
              "end_token": 967,
              "children": [
                {
                  "type": "Identifier",
                  "label": "Promise",
                  "start_token": 964,
                  "end_token": 964,
                  "children": []
                },
                {
                  "type": "TypeReference",
                  "label": "Match",
                  "start_token": 966,
                  "end_token": 966,
                  "children": [
                    {
                      "type": "Identifier",
                      "label": "Match",
                      "start_token": 966,
                      "end_token": 966,
                      "children": []
                    }
                  ]
                }
              ]
            },
            {
              "type": "Block",
              "label": "{\n    if (query.type === 'match') {\n      const iidx = this.invertedIndex.get(query.field as string);\n      if (!iidx) {\n        return new Match();\n      }\n      return await iidx.match(trx, query.match);\n    } else if (query.type === 'boolean') {\n      const weights = [];\n      for (const q of query.queries) {\n        weights.push(await this.queryRaw(trx, q));\n      }\n      if (query.occur === 'must') {\n        return weights.reduce((acc, w) => acc.and(w));\n      } else if (query.occur === 'must_not') {\n        const total = weights.reduce((acc, w) => acc.and(w));\n        return (await this.matchAll(trx)).exclude(total);\n      } else if (query.occur === 'should') {\n        return weights.reduce((acc, w) => acc.or(w));\n      }\n    } else if (query.type === 'all') {\n      return await this.matchAll(trx);\n    } else if (query.type === 'boost') {\n      return (await this.queryRaw(trx, query.query)).boost(query.boost);\n    } else if (query.type === 'exists') {\n      const iidx = this.invertedIndex.get(query.field as string);\n      if (!iidx) {\n        return new Match();\n      }\n      return await iidx.all(trx);\n    }\n    throw new Error(`Query type '${query.type}' not supported`);\n  }",
              "start_token": 968,
              "end_token": 1280,
              "children": [
                {
                  "type": "IfStatement",
                  "label": "if (query.type === 'match') {\n      const iidx = this.invertedIndex.get(query.field as string);\n      if (!iidx) {\n        return new Match();\n      }\n      return await iidx.match(trx, query.match);\n    } else if (query.type === 'boolean') {\n      const weights = [];\n      for (const q of query.queries) {\n        weights.push(await this.queryRaw(trx, q));\n      }\n      if (query.occur === 'must') {\n        return weights.reduce((acc, w) => acc.and(w));\n      } else if (query.occur === 'must_not') {\n        const total = weights.reduce((acc, w) => acc.and(w));\n        return (await this.matchAll(trx)).exclude(total);\n      } else if (query.occur === 'should') {\n        return weights.reduce((acc, w) => acc.or(w));\n      }\n    } else if (query.type === 'all') {\n      return await this.matchAll(trx);\n    } else if (query.type === 'boost') {\n      return (await this.queryRaw(trx, query.query)).boost(query.boost);\n    } else if (query.type === 'exists') {\n      const iidx = this.invertedIndex.get(query.field as string);\n      if (!iidx) {\n        return new Match();\n      }\n      return await iidx.all(trx);\n    }",
                  "start_token": 969,
                  "end_token": 1272,
                  "children": [
                    {
                      "type": "BinaryExpression",
                      "label": "query.type === 'match'",
                      "start_token": 971,
                      "end_token": 975,
                      "children": [
                        {
                          "type": "PropertyAccessExpression",
                          "label": "query.type",
                          "start_token": 971,
                          "end_token": 973,
                          "children": [
                            {
                              "type": "Identifier",
                              "label": "query",
                              "start_token": 971,
                              "end_token": 971,
                              "children": []
                            },
                            {
                              "type": "Identifier",
                              "label": "type",
                              "start_token": 973,
                              "end_token": 973,
                              "children": []
                            }
                          ]
                        },
                        {
                          "type": "EqualsEqualsEqualsToken",
                          "label": "===",
                          "start_token": 974,
                          "end_token": 974,
                          "children": []
                        },
                        {
                          "type": "StringLiteral",
                          "label": "'match'",
                          "start_token": 975,
                          "end_token": 975,
                          "children": []
                        }
                      ]
                    },
                    {
                      "type": "Block",
                      "label": "{\n      const iidx = this.invertedIndex.get(query.field as string);\n      if (!iidx) {\n        return new Match();\n      }\n      return await iidx.match(trx, query.match);\n    }",
                      "start_token": 977,
                      "end_token": 1020,
                      "children": [
                        {
                          "type": "FirstStatement",
                          "label": "const iidx = this.invertedIndex.get(query.field as string);",
                          "start_token": 978,
                          "end_token": 993,
                          "children": [
                            {
                              "type": "VariableDeclarationList",
                              "label": "const iidx = this.invertedIndex.get(query.field as string)",
                              "start_token": 978,
                              "end_token": 992,
                              "children": [
                                {
                                  "type": "VariableDeclaration",
                                  "label": "iidx = this.invertedIndex.get(query.field as string)",
                                  "start_token": 979,
                                  "end_token": 992,
                                  "children": [
                                    {
                                      "type": "Identifier",
                                      "label": "iidx",
                                      "start_token": 979,
                                      "end_token": 979,
                                      "children": []
                                    },
                                    {
                                      "type": "CallExpression",
                                      "label": "this.invertedIndex.get(query.field as string)",
                                      "start_token": 981,
                                      "end_token": 992,
                                      "children": [
                                        {
                                          "type": "PropertyAccessExpression",
                                          "label": "this.invertedIndex.get",
                                          "start_token": 981,
                                          "end_token": 985,
                                          "children": [
                                            {
                                              "type": "PropertyAccessExpression",
                                              "label": "this.invertedIndex",
                                              "start_token": 981,
                                              "end_token": 983,
                                              "children": [
                                                {
                                                  "type": "ThisKeyword",
                                                  "label": "this",
                                                  "start_token": 981,
                                                  "end_token": 981,
                                                  "children": []
                                                },
                                                {
                                                  "type": "Identifier",
                                                  "label": "invertedIndex",
                                                  "start_token": 983,
                                                  "end_token": 983,
                                                  "children": []
                                                }
                                              ]
                                            },
                                            {
                                              "type": "Identifier",
                                              "label": "get",
                                              "start_token": 985,
                                              "end_token": 985,
                                              "children": []
                                            }
                                          ]
                                        },
                                        {
                                          "type": "AsExpression",
                                          "label": "query.field as string",
                                          "start_token": 987,
                                          "end_token": 991,
                                          "children": [
                                            {
                                              "type": "PropertyAccessExpression",
                                              "label": "query.field",
                                              "start_token": 987,
                                              "end_token": 989,
                                              "children": [
                                                {
                                                  "type": "Identifier",
                                                  "label": "query",
                                                  "start_token": 987,
                                                  "end_token": 987,
                                                  "children": []
                                                },
                                                {
                                                  "type": "Identifier",
                                                  "label": "field",
                                                  "start_token": 989,
                                                  "end_token": 989,
                                                  "children": []
                                                }
                                              ]
                                            },
                                            {
                                              "type": "StringKeyword",
                                              "label": "string",
                                              "start_token": 991,
                                              "end_token": 991,
                                              "children": []
                                            }
                                          ]
                                        }
                                      ]
                                    }
                                  ]
                                }
                              ]
                            }
                          ]
                        },
                        {
                          "type": "IfStatement",
                          "label": "if (!iidx) {\n        return new Match();\n      }",
                          "start_token": 994,
                          "end_token": 1006,
                          "children": [
                            {
                              "type": "PrefixUnaryExpression",
                              "label": "!iidx",
                              "start_token": 996,
                              "end_token": 997,
                              "children": [
                                {
                                  "type": "Identifier",
                                  "label": "iidx",
                                  "start_token": 997,
                                  "end_token": 997,
                                  "children": []
                                }
                              ]
                            },
                            {
                              "type": "Block",
                              "label": "{\n        return new Match();\n      }",
                              "start_token": 999,
                              "end_token": 1006,
                              "children": [
                                {
                                  "type": "ReturnStatement",
                                  "label": "return new Match();",
                                  "start_token": 1000,
                                  "end_token": 1005,
                                  "children": [
                                    {
                                      "type": "NewExpression",
                                      "label": "new Match()",
                                      "start_token": 1001,
                                      "end_token": 1004,
                                      "children": [
                                        {
                                          "type": "Identifier",
                                          "label": "Match",
                                          "start_token": 1002,
                                          "end_token": 1002,
                                          "children": []
                                        }
                                      ]
                                    }
                                  ]
                                }
                              ]
                            }
                          ]
                        },
                        {
                          "type": "ReturnStatement",
                          "label": "return await iidx.match(trx, query.match);",
                          "start_token": 1007,
                          "end_token": 1019,
                          "children": [
                            {
                              "type": "AwaitExpression",
                              "label": "await iidx.match(trx, query.match)",
                              "start_token": 1008,
                              "end_token": 1018,
                              "children": [
                                {
                                  "type": "CallExpression",
                                  "label": "iidx.match(trx, query.match)",
                                  "start_token": 1009,
                                  "end_token": 1018,
                                  "children": [
                                    {
                                      "type": "PropertyAccessExpression",
                                      "label": "iidx.match",
                                      "start_token": 1009,
                                      "end_token": 1011,
                                      "children": [
                                        {
                                          "type": "Identifier",
                                          "label": "iidx",
                                          "start_token": 1009,
                                          "end_token": 1009,
                                          "children": []
                                        },
                                        {
                                          "type": "Identifier",
                                          "label": "match",
                                          "start_token": 1011,
                                          "end_token": 1011,
                                          "children": []
                                        }
                                      ]
                                    },
                                    {
                                      "type": "Identifier",
                                      "label": "trx",
                                      "start_token": 1013,
                                      "end_token": 1013,
                                      "children": []
                                    },
                                    {
                                      "type": "PropertyAccessExpression",
                                      "label": "query.match",
                                      "start_token": 1015,
                                      "end_token": 1017,
                                      "children": [
                                        {
                                          "type": "Identifier",
                                          "label": "query",
                                          "start_token": 1015,
                                          "end_token": 1015,
                                          "children": []
                                        },
                                        {
                                          "type": "Identifier",
                                          "label": "match",
                                          "start_token": 1017,
                                          "end_token": 1017,
                                          "children": []
                                        }
                                      ]
                                    }
                                  ]
                                }
                              ]
                            }
                          ]
                        }
                      ]
                    },
                    {
                      "type": "IfStatement",
                      "label": "if (query.type === 'boolean') {\n      const weights = [];\n      for (const q of query.queries) {\n        weights.push(await this.queryRaw(trx, q));\n      }\n      if (query.occur === 'must') {\n        return weights.reduce((acc, w) => acc.and(w));\n      } else if (query.occur === 'must_not') {\n        const total = weights.reduce((acc, w) => acc.and(w));\n        return (await this.matchAll(trx)).exclude(total);\n      } else if (query.occur === 'should') {\n        return weights.reduce((acc, w) => acc.or(w));\n      }\n    } else if (query.type === 'all') {\n      return await this.matchAll(trx);\n    } else if (query.type === 'boost') {\n      return (await this.queryRaw(trx, query.query)).boost(query.boost);\n    } else if (query.type === 'exists') {\n      const iidx = this.invertedIndex.get(query.field as string);\n      if (!iidx) {\n        return new Match();\n      }\n      return await iidx.all(trx);\n    }",
                      "start_token": 1022,
                      "end_token": 1272,
                      "children": [
                        {
                          "type": "BinaryExpression",
                          "label": "query.type === 'boolean'",
                          "start_token": 1024,
                          "end_token": 1028,
                          "children": [
                            {
                              "type": "PropertyAccessExpression",
                              "label": "query.type",
                              "start_token": 1024,
                              "end_token": 1026,
                              "children": [
                                {
                                  "type": "Identifier",
                                  "label": "query",
                                  "start_token": 1024,
                                  "end_token": 1024,
                                  "children": []
                                },
                                {
                                  "type": "Identifier",
                                  "label": "type",
                                  "start_token": 1026,
                                  "end_token": 1026,
                                  "children": []
                                }
                              ]
                            },
                            {
                              "type": "EqualsEqualsEqualsToken",
                              "label": "===",
                              "start_token": 1027,
                              "end_token": 1027,
                              "children": []
                            },
                            {
                              "type": "StringLiteral",
                              "label": "'boolean'",
                              "start_token": 1028,
                              "end_token": 1028,
                              "children": []
                            }
                          ]
                        },
                        {
                          "type": "Block",
                          "label": "{\n      const weights = [];\n      for (const q of query.queries) {\n        weights.push(await this.queryRaw(trx, q));\n      }\n      if (query.occur === 'must') {\n        return weights.reduce((acc, w) => acc.and(w));\n      } else if (query.occur === 'must_not') {\n        const total = weights.reduce((acc, w) => acc.and(w));\n        return (await this.matchAll(trx)).exclude(total);\n      } else if (query.occur === 'should') {\n        return weights.reduce((acc, w) => acc.or(w));\n      }\n    }",
                          "start_token": 1030,
                          "end_token": 1170,
                          "children": [
                            {
                              "type": "FirstStatement",
                              "label": "const weights = [];",
                              "start_token": 1031,
                              "end_token": 1036,
                              "children": [
                                {
                                  "type": "VariableDeclarationList",
                                  "label": "const weights = []",
                                  "start_token": 1031,
                                  "end_token": 1035,
                                  "children": [
                                    {
                                      "type": "VariableDeclaration",
                                      "label": "weights = []",
                                      "start_token": 1032,
                                      "end_token": 1035,
                                      "children": [
                                        {
                                          "type": "Identifier",
                                          "label": "weights",
                                          "start_token": 1032,
                                          "end_token": 1032,
                                          "children": []
                                        },
                                        {
                                          "type": "ArrayLiteralExpression",
                                          "label": "[]",
                                          "start_token": 1034,
                                          "end_token": 1035,
                                          "children": []
                                        }
                                      ]
                                    }
                                  ]
                                }
                              ]
                            },
                            {
                              "type": "ForOfStatement",
                              "label": "for (const q of query.queries) {\n        weights.push(await this.queryRaw(trx, q));\n      }",
                              "start_token": 1037,
                              "end_token": 1062,
                              "children": [
                                {
                                  "type": "VariableDeclarationList",
                                  "label": "const q",
                                  "start_token": 1039,
                                  "end_token": 1040,
                                  "children": [
                                    {
                                      "type": "VariableDeclaration",
                                      "label": "q",
                                      "start_token": 1040,
                                      "end_token": 1040,
                                      "children": [
                                        {
                                          "type": "Identifier",
                                          "label": "q",
                                          "start_token": 1040,
                                          "end_token": 1040,
                                          "children": []
                                        }
                                      ]
                                    }
                                  ]
                                },
                                {
                                  "type": "PropertyAccessExpression",
                                  "label": "query.queries",
                                  "start_token": 1042,
                                  "end_token": 1044,
                                  "children": [
                                    {
                                      "type": "Identifier",
                                      "label": "query",
                                      "start_token": 1042,
                                      "end_token": 1042,
                                      "children": []
                                    },
                                    {
                                      "type": "Identifier",
                                      "label": "queries",
                                      "start_token": 1044,
                                      "end_token": 1044,
                                      "children": []
                                    }
                                  ]
                                },
                                {
                                  "type": "Block",
                                  "label": "{\n        weights.push(await this.queryRaw(trx, q));\n      }",
                                  "start_token": 1046,
                                  "end_token": 1062,
                                  "children": [
                                    {
                                      "type": "ExpressionStatement",
                                      "label": "weights.push(await this.queryRaw(trx, q));",
                                      "start_token": 1047,
                                      "end_token": 1061,
                                      "children": [
                                        {
                                          "type": "CallExpression",
                                          "label": "weights.push(await this.queryRaw(trx, q))",
                                          "start_token": 1047,
                                          "end_token": 1060,
                                          "children": [
                                            {
                                              "type": "PropertyAccessExpression",
                                              "label": "weights.push",
                                              "start_token": 1047,
                                              "end_token": 1049,
                                              "children": [
                                                {
                                                  "type": "Identifier",
                                                  "label": "weights",
                                                  "start_token": 1047,
                                                  "end_token": 1047,
                                                  "children": []
                                                },
                                                {
                                                  "type": "Identifier",
                                                  "label": "push",
                                                  "start_token": 1049,
                                                  "end_token": 1049,
                                                  "children": []
                                                }
                                              ]
                                            },
                                            {
                                              "type": "AwaitExpression",
                                              "label": "await this.queryRaw(trx, q)",
                                              "start_token": 1051,
                                              "end_token": 1059,
                                              "children": [
                                                {
                                                  "type": "CallExpression",
                                                  "label": "this.queryRaw(trx, q)",
                                                  "start_token": 1052,
                                                  "end_token": 1059,
                                                  "children": [
                                                    {
                                                      "type": "PropertyAccessExpression",
                                                      "label": "this.queryRaw",
                                                      "start_token": 1052,
                                                      "end_token": 1054,
                                                      "children": [
                                                        {
                                                          "type": "ThisKeyword",
                                                          "label": "this",
                                                          "start_token": 1052,
                                                          "end_token": 1052,
                                                          "children": []
                                                        },
                                                        {
                                                          "type": "Identifier",
                                                          "label": "queryRaw",
                                                          "start_token": 1054,
                                                          "end_token": 1054,
                                                          "children": []
                                                        }
                                                      ]
                                                    },
                                                    {
                                                      "type": "Identifier",
                                                      "label": "trx",
                                                      "start_token": 1056,
                                                      "end_token": 1056,
                                                      "children": []
                                                    },
                                                    {
                                                      "type": "Identifier",
                                                      "label": "q",
                                                      "start_token": 1058,
                                                      "end_token": 1058,
                                                      "children": []
                                                    }
                                                  ]
                                                }
                                              ]
                                            }
                                          ]
                                        }
                                      ]
                                    }
                                  ]
                                }
                              ]
                            },
                            {
                              "type": "IfStatement",
                              "label": "if (query.occur === 'must') {\n        return weights.reduce((acc, w) => acc.and(w));\n      } else if (query.occur === 'must_not') {\n        const total = weights.reduce((acc, w) => acc.and(w));\n        return (await this.matchAll(trx)).exclude(total);\n      } else if (query.occur === 'should') {\n        return weights.reduce((acc, w) => acc.or(w));\n      }",
                              "start_token": 1063,
                              "end_token": 1169,
                              "children": [
                                {
                                  "type": "BinaryExpression",
                                  "label": "query.occur === 'must'",
                                  "start_token": 1065,
                                  "end_token": 1069,
                                  "children": [
                                    {
                                      "type": "PropertyAccessExpression",
                                      "label": "query.occur",
                                      "start_token": 1065,
                                      "end_token": 1067,
                                      "children": [
                                        {
                                          "type": "Identifier",
                                          "label": "query",
                                          "start_token": 1065,
                                          "end_token": 1065,
                                          "children": []
                                        },
                                        {
                                          "type": "Identifier",
                                          "label": "occur",
                                          "start_token": 1067,
                                          "end_token": 1067,
                                          "children": []
                                        }
                                      ]
                                    },
                                    {
                                      "type": "EqualsEqualsEqualsToken",
                                      "label": "===",
                                      "start_token": 1068,
                                      "end_token": 1068,
                                      "children": []
                                    },
                                    {
                                      "type": "StringLiteral",
                                      "label": "'must'",
                                      "start_token": 1069,
                                      "end_token": 1069,
                                      "children": []
                                    }
                                  ]
                                },
                                {
                                  "type": "Block",
                                  "label": "{\n        return weights.reduce((acc, w) => acc.and(w));\n      }",
                                  "start_token": 1071,
                                  "end_token": 1091,
                                  "children": [
                                    {
                                      "type": "ReturnStatement",
                                      "label": "return weights.reduce((acc, w) => acc.and(w));",
                                      "start_token": 1072,
                                      "end_token": 1090,
                                      "children": [
                                        {
                                          "type": "CallExpression",
                                          "label": "weights.reduce((acc, w) => acc.and(w))",
                                          "start_token": 1073,
                                          "end_token": 1089,
                                          "children": [
                                            {
                                              "type": "PropertyAccessExpression",
                                              "label": "weights.reduce",
                                              "start_token": 1073,
                                              "end_token": 1075,
                                              "children": [
                                                {
                                                  "type": "Identifier",
                                                  "label": "weights",
                                                  "start_token": 1073,
                                                  "end_token": 1073,
                                                  "children": []
                                                },
                                                {
                                                  "type": "Identifier",
                                                  "label": "reduce",
                                                  "start_token": 1075,
                                                  "end_token": 1075,
                                                  "children": []
                                                }
                                              ]
                                            },
                                            {
                                              "type": "ArrowFunction",
                                              "label": "(acc, w) => acc.and(w)",
                                              "start_token": 1077,
                                              "end_token": 1088,
                                              "children": [
                                                {
                                                  "type": "Parameter",
                                                  "label": "acc",
                                                  "start_token": 1078,
                                                  "end_token": 1078,
                                                  "children": [
                                                    {
                                                      "type": "Identifier",
                                                      "label": "acc",
                                                      "start_token": 1078,
                                                      "end_token": 1078,
                                                      "children": []
                                                    }
                                                  ]
                                                },
                                                {
                                                  "type": "Parameter",
                                                  "label": "w",
                                                  "start_token": 1080,
                                                  "end_token": 1080,
                                                  "children": [
                                                    {
                                                      "type": "Identifier",
                                                      "label": "w",
                                                      "start_token": 1080,
                                                      "end_token": 1080,
                                                      "children": []
                                                    }
                                                  ]
                                                },
                                                {
                                                  "type": "EqualsGreaterThanToken",
                                                  "label": "=>",
                                                  "start_token": 1082,
                                                  "end_token": 1082,
                                                  "children": []
                                                },
                                                {
                                                  "type": "CallExpression",
                                                  "label": "acc.and(w)",
                                                  "start_token": 1083,
                                                  "end_token": 1088,
                                                  "children": [
                                                    {
                                                      "type": "PropertyAccessExpression",
                                                      "label": "acc.and",
                                                      "start_token": 1083,
                                                      "end_token": 1085,
                                                      "children": [
                                                        {
                                                          "type": "Identifier",
                                                          "label": "acc",
                                                          "start_token": 1083,
                                                          "end_token": 1083,
                                                          "children": []
                                                        },
                                                        {
                                                          "type": "Identifier",
                                                          "label": "and",
                                                          "start_token": 1085,
                                                          "end_token": 1085,
                                                          "children": []
                                                        }
                                                      ]
                                                    },
                                                    {
                                                      "type": "Identifier",
                                                      "label": "w",
                                                      "start_token": 1087,
                                                      "end_token": 1087,
                                                      "children": []
                                                    }
                                                  ]
                                                }
                                              ]
                                            }
                                          ]
                                        }
                                      ]
                                    }
                                  ]
                                },
                                {
                                  "type": "IfStatement",
                                  "label": "if (query.occur === 'must_not') {\n        const total = weights.reduce((acc, w) => acc.and(w));\n        return (await this.matchAll(trx)).exclude(total);\n      } else if (query.occur === 'should') {\n        return weights.reduce((acc, w) => acc.or(w));\n      }",
                                  "start_token": 1093,
                                  "end_token": 1169,
                                  "children": [
                                    {
                                      "type": "BinaryExpression",
                                      "label": "query.occur === 'must_not'",
                                      "start_token": 1095,
                                      "end_token": 1099,
                                      "children": [
                                        {
                                          "type": "PropertyAccessExpression",
                                          "label": "query.occur",
                                          "start_token": 1095,
                                          "end_token": 1097,
                                          "children": [
                                            {
                                              "type": "Identifier",
                                              "label": "query",
                                              "start_token": 1095,
                                              "end_token": 1095,
                                              "children": []
                                            },
                                            {
                                              "type": "Identifier",
                                              "label": "occur",
                                              "start_token": 1097,
                                              "end_token": 1097,
                                              "children": []
                                            }
                                          ]
                                        },
                                        {
                                          "type": "EqualsEqualsEqualsToken",
                                          "label": "===",
                                          "start_token": 1098,
                                          "end_token": 1098,
                                          "children": []
                                        },
                                        {
                                          "type": "StringLiteral",
                                          "label": "'must_not'",
                                          "start_token": 1099,
                                          "end_token": 1099,
                                          "children": []
                                        }
                                      ]
                                    },
                                    {
                                      "type": "Block",
                                      "label": "{\n        const total = weights.reduce((acc, w) => acc.and(w));\n        return (await this.matchAll(trx)).exclude(total);\n      }",
                                      "start_token": 1101,
                                      "end_token": 1139,
                                      "children": [
                                        {
                                          "type": "FirstStatement",
                                          "label": "const total = weights.reduce((acc, w) => acc.and(w));",
                                          "start_token": 1102,
                                          "end_token": 1122,
                                          "children": [
                                            {
                                              "type": "VariableDeclarationList",
                                              "label": "const total = weights.reduce((acc, w) => acc.and(w))",
                                              "start_token": 1102,
                                              "end_token": 1121,
                                              "children": [
                                                {
                                                  "type": "VariableDeclaration",
                                                  "label": "total = weights.reduce((acc, w) => acc.and(w))",
                                                  "start_token": 1103,
                                                  "end_token": 1121,
                                                  "children": [
                                                    {
                                                      "type": "Identifier",
                                                      "label": "total",
                                                      "start_token": 1103,
                                                      "end_token": 1103,
                                                      "children": []
                                                    },
                                                    {
                                                      "type": "CallExpression",
                                                      "label": "weights.reduce((acc, w) => acc.and(w))",
                                                      "start_token": 1105,
                                                      "end_token": 1121,
                                                      "children": [
                                                        {
                                                          "type": "PropertyAccessExpression",
                                                          "label": "weights.reduce",
                                                          "start_token": 1105,
                                                          "end_token": 1107,
                                                          "children": [
                                                            {
                                                              "type": "Identifier",
                                                              "label": "weights",
                                                              "start_token": 1105,
                                                              "end_token": 1105,
                                                              "children": []
                                                            },
                                                            {
                                                              "type": "Identifier",
                                                              "label": "reduce",
                                                              "start_token": 1107,
                                                              "end_token": 1107,
                                                              "children": []
                                                            }
                                                          ]
                                                        },
                                                        {
                                                          "type": "ArrowFunction",
                                                          "label": "(acc, w) => acc.and(w)",
                                                          "start_token": 1109,
                                                          "end_token": 1120,
                                                          "children": [
                                                            {
                                                              "type": "Parameter",
                                                              "label": "acc",
                                                              "start_token": 1110,
                                                              "end_token": 1110,
                                                              "children": [
                                                                {
                                                                  "type": "Identifier",
                                                                  "label": "acc",
                                                                  "start_token": 1110,
                                                                  "end_token": 1110,
                                                                  "children": []
                                                                }
                                                              ]
                                                            },
                                                            {
                                                              "type": "Parameter",
                                                              "label": "w",
                                                              "start_token": 1112,
                                                              "end_token": 1112,
                                                              "children": [
                                                                {
                                                                  "type": "Identifier",
                                                                  "label": "w",
                                                                  "start_token": 1112,
                                                                  "end_token": 1112,
                                                                  "children": []
                                                                }
                                                              ]
                                                            },
                                                            {
                                                              "type": "EqualsGreaterThanToken",
                                                              "label": "=>",
                                                              "start_token": 1114,
                                                              "end_token": 1114,
                                                              "children": []
                                                            },
                                                            {
                                                              "type": "CallExpression",
                                                              "label": "acc.and(w)",
                                                              "start_token": 1115,
                                                              "end_token": 1120,
                                                              "children": [
                                                                {
                                                                  "type": "PropertyAccessExpression",
                                                                  "label": "acc.and",
                                                                  "start_token": 1115,
                                                                  "end_token": 1117,
                                                                  "children": [
                                                                    {
                                                                      "type": "Identifier",
                                                                      "label": "acc",
                                                                      "start_token": 1115,
                                                                      "end_token": 1115,
                                                                      "children": []
                                                                    },
                                                                    {
                                                                      "type": "Identifier",
                                                                      "label": "and",
                                                                      "start_token": 1117,
                                                                      "end_token": 1117,
                                                                      "children": []
                                                                    }
                                                                  ]
                                                                },
                                                                {
                                                                  "type": "Identifier",
                                                                  "label": "w",
                                                                  "start_token": 1119,
                                                                  "end_token": 1119,
                                                                  "children": []
                                                                }
                                                              ]
                                                            }
                                                          ]
                                                        }
                                                      ]
                                                    }
                                                  ]
                                                }
                                              ]
                                            }
                                          ]
                                        },
                                        {
                                          "type": "ReturnStatement",
                                          "label": "return (await this.matchAll(trx)).exclude(total);",
                                          "start_token": 1123,
                                          "end_token": 1138,
                                          "children": [
                                            {
                                              "type": "CallExpression",
                                              "label": "(await this.matchAll(trx)).exclude(total)",
                                              "start_token": 1124,
                                              "end_token": 1137,
                                              "children": [
                                                {
                                                  "type": "PropertyAccessExpression",
                                                  "label": "(await this.matchAll(trx)).exclude",
                                                  "start_token": 1124,
                                                  "end_token": 1134,
                                                  "children": [
                                                    {
                                                      "type": "ParenthesizedExpression",
                                                      "label": "(await this.matchAll(trx))",
                                                      "start_token": 1124,
                                                      "end_token": 1132,
                                                      "children": [
                                                        {
                                                          "type": "AwaitExpression",
                                                          "label": "await this.matchAll(trx)",
                                                          "start_token": 1125,
                                                          "end_token": 1131,
                                                          "children": [
                                                            {
                                                              "type": "CallExpression",
                                                              "label": "this.matchAll(trx)",
                                                              "start_token": 1126,
                                                              "end_token": 1131,
                                                              "children": [
                                                                {
                                                                  "type": "PropertyAccessExpression",
                                                                  "label": "this.matchAll",
                                                                  "start_token": 1126,
                                                                  "end_token": 1128,
                                                                  "children": [
                                                                    {
                                                                      "type": "ThisKeyword",
                                                                      "label": "this",
                                                                      "start_token": 1126,
                                                                      "end_token": 1126,
                                                                      "children": []
                                                                    },
                                                                    {
                                                                      "type": "Identifier",
                                                                      "label": "matchAll",
                                                                      "start_token": 1128,
                                                                      "end_token": 1128,
                                                                      "children": []
                                                                    }
                                                                  ]
                                                                },
                                                                {
                                                                  "type": "Identifier",
                                                                  "label": "trx",
                                                                  "start_token": 1130,
                                                                  "end_token": 1130,
                                                                  "children": []
                                                                }
                                                              ]
                                                            }
                                                          ]
                                                        }
                                                      ]
                                                    },
                                                    {
                                                      "type": "Identifier",
                                                      "label": "exclude",
                                                      "start_token": 1134,
                                                      "end_token": 1134,
                                                      "children": []
                                                    }
                                                  ]
                                                },
                                                {
                                                  "type": "Identifier",
                                                  "label": "total",
                                                  "start_token": 1136,
                                                  "end_token": 1136,
                                                  "children": []
                                                }
                                              ]
                                            }
                                          ]
                                        }
                                      ]
                                    },
                                    {
                                      "type": "IfStatement",
                                      "label": "if (query.occur === 'should') {\n        return weights.reduce((acc, w) => acc.or(w));\n      }",
                                      "start_token": 1141,
                                      "end_token": 1169,
                                      "children": [
                                        {
                                          "type": "BinaryExpression",
                                          "label": "query.occur === 'should'",
                                          "start_token": 1143,
                                          "end_token": 1147,
                                          "children": [
                                            {
                                              "type": "PropertyAccessExpression",
                                              "label": "query.occur",
                                              "start_token": 1143,
                                              "end_token": 1145,
                                              "children": [
                                                {
                                                  "type": "Identifier",
                                                  "label": "query",
                                                  "start_token": 1143,
                                                  "end_token": 1143,
                                                  "children": []
                                                },
                                                {
                                                  "type": "Identifier",
                                                  "label": "occur",
                                                  "start_token": 1145,
                                                  "end_token": 1145,
                                                  "children": []
                                                }
                                              ]
                                            },
                                            {
                                              "type": "EqualsEqualsEqualsToken",
                                              "label": "===",
                                              "start_token": 1146,
                                              "end_token": 1146,
                                              "children": []
                                            },
                                            {
                                              "type": "StringLiteral",
                                              "label": "'should'",
                                              "start_token": 1147,
                                              "end_token": 1147,
                                              "children": []
                                            }
                                          ]
                                        },
                                        {
                                          "type": "Block",
                                          "label": "{\n        return weights.reduce((acc, w) => acc.or(w));\n      }",
                                          "start_token": 1149,
                                          "end_token": 1169,
                                          "children": [
                                            {
                                              "type": "ReturnStatement",
                                              "label": "return weights.reduce((acc, w) => acc.or(w));",
                                              "start_token": 1150,
                                              "end_token": 1168,
                                              "children": [
                                                {
                                                  "type": "CallExpression",
                                                  "label": "weights.reduce((acc, w) => acc.or(w))",
                                                  "start_token": 1151,
                                                  "end_token": 1167,
                                                  "children": [
                                                    {
                                                      "type": "PropertyAccessExpression",
                                                      "label": "weights.reduce",
                                                      "start_token": 1151,
                                                      "end_token": 1153,
                                                      "children": [
                                                        {
                                                          "type": "Identifier",
                                                          "label": "weights",
                                                          "start_token": 1151,
                                                          "end_token": 1151,
                                                          "children": []
                                                        },
                                                        {
                                                          "type": "Identifier",
                                                          "label": "reduce",
                                                          "start_token": 1153,
                                                          "end_token": 1153,
                                                          "children": []
                                                        }
                                                      ]
                                                    },
                                                    {
                                                      "type": "ArrowFunction",
                                                      "label": "(acc, w) => acc.or(w)",
                                                      "start_token": 1155,
                                                      "end_token": 1166,
                                                      "children": [
                                                        {
                                                          "type": "Parameter",
                                                          "label": "acc",
                                                          "start_token": 1156,
                                                          "end_token": 1156,
                                                          "children": [
                                                            {
                                                              "type": "Identifier",
                                                              "label": "acc",
                                                              "start_token": 1156,
                                                              "end_token": 1156,
                                                              "children": []
                                                            }
                                                          ]
                                                        },
                                                        {
                                                          "type": "Parameter",
                                                          "label": "w",
                                                          "start_token": 1158,
                                                          "end_token": 1158,
                                                          "children": [
                                                            {
                                                              "type": "Identifier",
                                                              "label": "w",
                                                              "start_token": 1158,
                                                              "end_token": 1158,
                                                              "children": []
                                                            }
                                                          ]
                                                        },
                                                        {
                                                          "type": "EqualsGreaterThanToken",
                                                          "label": "=>",
                                                          "start_token": 1160,
                                                          "end_token": 1160,
                                                          "children": []
                                                        },
                                                        {
                                                          "type": "CallExpression",
                                                          "label": "acc.or(w)",
                                                          "start_token": 1161,
                                                          "end_token": 1166,
                                                          "children": [
                                                            {
                                                              "type": "PropertyAccessExpression",
                                                              "label": "acc.or",
                                                              "start_token": 1161,
                                                              "end_token": 1163,
                                                              "children": [
                                                                {
                                                                  "type": "Identifier",
                                                                  "label": "acc",
                                                                  "start_token": 1161,
                                                                  "end_token": 1161,
                                                                  "children": []
                                                                },
                                                                {
                                                                  "type": "Identifier",
                                                                  "label": "or",
                                                                  "start_token": 1163,
                                                                  "end_token": 1163,
                                                                  "children": []
                                                                }
                                                              ]
                                                            },
                                                            {
                                                              "type": "Identifier",
                                                              "label": "w",
                                                              "start_token": 1165,
                                                              "end_token": 1165,
                                                              "children": []
                                                            }
                                                          ]
                                                        }
                                                      ]
                                                    }
                                                  ]
                                                }
                                              ]
                                            }
                                          ]
                                        }
                                      ]
                                    }
                                  ]
                                }
                              ]
                            }
                          ]
                        },
                        {
                          "type": "IfStatement",
                          "label": "if (query.type === 'all') {\n      return await this.matchAll(trx);\n    } else if (query.type === 'boost') {\n      return (await this.queryRaw(trx, query.query)).boost(query.boost);\n    } else if (query.type === 'exists') {\n      const iidx = this.invertedIndex.get(query.field as string);\n      if (!iidx) {\n        return new Match();\n      }\n      return await iidx.all(trx);\n    }",
                          "start_token": 1172,
                          "end_token": 1272,
                          "children": [
                            {
                              "type": "BinaryExpression",
                              "label": "query.type === 'all'",
                              "start_token": 1174,
                              "end_token": 1178,
                              "children": [
                                {
                                  "type": "PropertyAccessExpression",
                                  "label": "query.type",
                                  "start_token": 1174,
                                  "end_token": 1176,
                                  "children": [
                                    {
                                      "type": "Identifier",
                                      "label": "query",
                                      "start_token": 1174,
                                      "end_token": 1174,
                                      "children": []
                                    },
                                    {
                                      "type": "Identifier",
                                      "label": "type",
                                      "start_token": 1176,
                                      "end_token": 1176,
                                      "children": []
                                    }
                                  ]
                                },
                                {
                                  "type": "EqualsEqualsEqualsToken",
                                  "label": "===",
                                  "start_token": 1177,
                                  "end_token": 1177,
                                  "children": []
                                },
                                {
                                  "type": "StringLiteral",
                                  "label": "'all'",
                                  "start_token": 1178,
                                  "end_token": 1178,
                                  "children": []
                                }
                              ]
                            },
                            {
                              "type": "Block",
                              "label": "{\n      return await this.matchAll(trx);\n    }",
                              "start_token": 1180,
                              "end_token": 1190,
                              "children": [
                                {
                                  "type": "ReturnStatement",
                                  "label": "return await this.matchAll(trx);",
                                  "start_token": 1181,
                                  "end_token": 1189,
                                  "children": [
                                    {
                                      "type": "AwaitExpression",
                                      "label": "await this.matchAll(trx)",
                                      "start_token": 1182,
                                      "end_token": 1188,
                                      "children": [
                                        {
                                          "type": "CallExpression",
                                          "label": "this.matchAll(trx)",
                                          "start_token": 1183,
                                          "end_token": 1188,
                                          "children": [
                                            {
                                              "type": "PropertyAccessExpression",
                                              "label": "this.matchAll",
                                              "start_token": 1183,
                                              "end_token": 1185,
                                              "children": [
                                                {
                                                  "type": "ThisKeyword",
                                                  "label": "this",
                                                  "start_token": 1183,
                                                  "end_token": 1183,
                                                  "children": []
                                                },
                                                {
                                                  "type": "Identifier",
                                                  "label": "matchAll",
                                                  "start_token": 1185,
                                                  "end_token": 1185,
                                                  "children": []
                                                }
                                              ]
                                            },
                                            {
                                              "type": "Identifier",
                                              "label": "trx",
                                              "start_token": 1187,
                                              "end_token": 1187,
                                              "children": []
                                            }
                                          ]
                                        }
                                      ]
                                    }
                                  ]
                                }
                              ]
                            },
                            {
                              "type": "IfStatement",
                              "label": "if (query.type === 'boost') {\n      return (await this.queryRaw(trx, query.query)).boost(query.boost);\n    } else if (query.type === 'exists') {\n      const iidx = this.invertedIndex.get(query.field as string);\n      if (!iidx) {\n        return new Match();\n      }\n      return await iidx.all(trx);\n    }",
                              "start_token": 1192,
                              "end_token": 1272,
                              "children": [
                                {
                                  "type": "BinaryExpression",
                                  "label": "query.type === 'boost'",
                                  "start_token": 1194,
                                  "end_token": 1198,
                                  "children": [
                                    {
                                      "type": "PropertyAccessExpression",
                                      "label": "query.type",
                                      "start_token": 1194,
                                      "end_token": 1196,
                                      "children": [
                                        {
                                          "type": "Identifier",
                                          "label": "query",
                                          "start_token": 1194,
                                          "end_token": 1194,
                                          "children": []
                                        },
                                        {
                                          "type": "Identifier",
                                          "label": "type",
                                          "start_token": 1196,
                                          "end_token": 1196,
                                          "children": []
                                        }
                                      ]
                                    },
                                    {
                                      "type": "EqualsEqualsEqualsToken",
                                      "label": "===",
                                      "start_token": 1197,
                                      "end_token": 1197,
                                      "children": []
                                    },
                                    {
                                      "type": "StringLiteral",
                                      "label": "'boost'",
                                      "start_token": 1198,
                                      "end_token": 1198,
                                      "children": []
                                    }
                                  ]
                                },
                                {
                                  "type": "Block",
                                  "label": "{\n      return (await this.queryRaw(trx, query.query)).boost(query.boost);\n    }",
                                  "start_token": 1200,
                                  "end_token": 1223,
                                  "children": [
                                    {
                                      "type": "ReturnStatement",
                                      "label": "return (await this.queryRaw(trx, query.query)).boost(query.boost);",
                                      "start_token": 1201,
                                      "end_token": 1222,
                                      "children": [
                                        {
                                          "type": "CallExpression",
                                          "label": "(await this.queryRaw(trx, query.query)).boost(query.boost)",
                                          "start_token": 1202,
                                          "end_token": 1221,
                                          "children": [
                                            {
                                              "type": "PropertyAccessExpression",
                                              "label": "(await this.queryRaw(trx, query.query)).boost",
                                              "start_token": 1202,
                                              "end_token": 1216,
                                              "children": [
                                                {
                                                  "type": "ParenthesizedExpression",
                                                  "label": "(await this.queryRaw(trx, query.query))",
                                                  "start_token": 1202,
                                                  "end_token": 1214,
                                                  "children": [
                                                    {
                                                      "type": "AwaitExpression",
                                                      "label": "await this.queryRaw(trx, query.query)",
                                                      "start_token": 1203,
                                                      "end_token": 1213,
                                                      "children": [
                                                        {
                                                          "type": "CallExpression",
                                                          "label": "this.queryRaw(trx, query.query)",
                                                          "start_token": 1204,
                                                          "end_token": 1213,
                                                          "children": [
                                                            {
                                                              "type": "PropertyAccessExpression",
                                                              "label": "this.queryRaw",
                                                              "start_token": 1204,
                                                              "end_token": 1206,
                                                              "children": [
                                                                {
                                                                  "type": "ThisKeyword",
                                                                  "label": "this",
                                                                  "start_token": 1204,
                                                                  "end_token": 1204,
                                                                  "children": []
                                                                },
                                                                {
                                                                  "type": "Identifier",
                                                                  "label": "queryRaw",
                                                                  "start_token": 1206,
                                                                  "end_token": 1206,
                                                                  "children": []
                                                                }
                                                              ]
                                                            },
                                                            {
                                                              "type": "Identifier",
                                                              "label": "trx",
                                                              "start_token": 1208,
                                                              "end_token": 1208,
                                                              "children": []
                                                            },
                                                            {
                                                              "type": "PropertyAccessExpression",
                                                              "label": "query.query",
                                                              "start_token": 1210,
                                                              "end_token": 1212,
                                                              "children": [
                                                                {
                                                                  "type": "Identifier",
                                                                  "label": "query",
                                                                  "start_token": 1210,
                                                                  "end_token": 1210,
                                                                  "children": []
                                                                },
                                                                {
                                                                  "type": "Identifier",
                                                                  "label": "query",
                                                                  "start_token": 1212,
                                                                  "end_token": 1212,
                                                                  "children": []
                                                                }
                                                              ]
                                                            }
                                                          ]
                                                        }
                                                      ]
                                                    }
                                                  ]
                                                },
                                                {
                                                  "type": "Identifier",
                                                  "label": "boost",
                                                  "start_token": 1216,
                                                  "end_token": 1216,
                                                  "children": []
                                                }
                                              ]
                                            },
                                            {
                                              "type": "PropertyAccessExpression",
                                              "label": "query.boost",
                                              "start_token": 1218,
                                              "end_token": 1220,
                                              "children": [
                                                {
                                                  "type": "Identifier",
                                                  "label": "query",
                                                  "start_token": 1218,
                                                  "end_token": 1218,
                                                  "children": []
                                                },
                                                {
                                                  "type": "Identifier",
                                                  "label": "boost",
                                                  "start_token": 1220,
                                                  "end_token": 1220,
                                                  "children": []
                                                }
                                              ]
                                            }
                                          ]
                                        }
                                      ]
                                    }
                                  ]
                                },
                                {
                                  "type": "IfStatement",
                                  "label": "if (query.type === 'exists') {\n      const iidx = this.invertedIndex.get(query.field as string);\n      if (!iidx) {\n        return new Match();\n      }\n      return await iidx.all(trx);\n    }",
                                  "start_token": 1225,
                                  "end_token": 1272,
                                  "children": [
                                    {
                                      "type": "BinaryExpression",
                                      "label": "query.type === 'exists'",
                                      "start_token": 1227,
                                      "end_token": 1231,
                                      "children": [
                                        {
                                          "type": "PropertyAccessExpression",
                                          "label": "query.type",
                                          "start_token": 1227,
                                          "end_token": 1229,
                                          "children": [
                                            {
                                              "type": "Identifier",
                                              "label": "query",
                                              "start_token": 1227,
                                              "end_token": 1227,
                                              "children": []
                                            },
                                            {
                                              "type": "Identifier",
                                              "label": "type",
                                              "start_token": 1229,
                                              "end_token": 1229,
                                              "children": []
                                            }
                                          ]
                                        },
                                        {
                                          "type": "EqualsEqualsEqualsToken",
                                          "label": "===",
                                          "start_token": 1230,
                                          "end_token": 1230,
                                          "children": []
                                        },
                                        {
                                          "type": "StringLiteral",
                                          "label": "'exists'",
                                          "start_token": 1231,
                                          "end_token": 1231,
                                          "children": []
                                        }
                                      ]
                                    },
                                    {
                                      "type": "Block",
                                      "label": "{\n      const iidx = this.invertedIndex.get(query.field as string);\n      if (!iidx) {\n        return new Match();\n      }\n      return await iidx.all(trx);\n    }",
                                      "start_token": 1233,
                                      "end_token": 1272,
                                      "children": [
                                        {
                                          "type": "FirstStatement",
                                          "label": "const iidx = this.invertedIndex.get(query.field as string);",
                                          "start_token": 1234,
                                          "end_token": 1249,
                                          "children": [
                                            {
                                              "type": "VariableDeclarationList",
                                              "label": "const iidx = this.invertedIndex.get(query.field as string)",
                                              "start_token": 1234,
                                              "end_token": 1248,
                                              "children": [
                                                {
                                                  "type": "VariableDeclaration",
                                                  "label": "iidx = this.invertedIndex.get(query.field as string)",
                                                  "start_token": 1235,
                                                  "end_token": 1248,
                                                  "children": [
                                                    {
                                                      "type": "Identifier",
                                                      "label": "iidx",
                                                      "start_token": 1235,
                                                      "end_token": 1235,
                                                      "children": []
                                                    },
                                                    {
                                                      "type": "CallExpression",
                                                      "label": "this.invertedIndex.get(query.field as string)",
                                                      "start_token": 1237,
                                                      "end_token": 1248,
                                                      "children": [
                                                        {
                                                          "type": "PropertyAccessExpression",
                                                          "label": "this.invertedIndex.get",
                                                          "start_token": 1237,
                                                          "end_token": 1241,
                                                          "children": [
                                                            {
                                                              "type": "PropertyAccessExpression",
                                                              "label": "this.invertedIndex",
                                                              "start_token": 1237,
                                                              "end_token": 1239,
                                                              "children": [
                                                                {
                                                                  "type": "ThisKeyword",
                                                                  "label": "this",
                                                                  "start_token": 1237,
                                                                  "end_token": 1237,
                                                                  "children": []
                                                                },
                                                                {
                                                                  "type": "Identifier",
                                                                  "label": "invertedIndex",
                                                                  "start_token": 1239,
                                                                  "end_token": 1239,
                                                                  "children": []
                                                                }
                                                              ]
                                                            },
                                                            {
                                                              "type": "Identifier",
                                                              "label": "get",
                                                              "start_token": 1241,
                                                              "end_token": 1241,
                                                              "children": []
                                                            }
                                                          ]
                                                        },
                                                        {
                                                          "type": "AsExpression",
                                                          "label": "query.field as string",
                                                          "start_token": 1243,
                                                          "end_token": 1247,
                                                          "children": [
                                                            {
                                                              "type": "PropertyAccessExpression",
                                                              "label": "query.field",
                                                              "start_token": 1243,
                                                              "end_token": 1245,
                                                              "children": [
                                                                {
                                                                  "type": "Identifier",
                                                                  "label": "query",
                                                                  "start_token": 1243,
                                                                  "end_token": 1243,
                                                                  "children": []
                                                                },
                                                                {
                                                                  "type": "Identifier",
                                                                  "label": "field",
                                                                  "start_token": 1245,
                                                                  "end_token": 1245,
                                                                  "children": []
                                                                }
                                                              ]
                                                            },
                                                            {
                                                              "type": "StringKeyword",
                                                              "label": "string",
                                                              "start_token": 1247,
                                                              "end_token": 1247,
                                                              "children": []
                                                            }
                                                          ]
                                                        }
                                                      ]
                                                    }
                                                  ]
                                                }
                                              ]
                                            }
                                          ]
                                        },
                                        {
                                          "type": "IfStatement",
                                          "label": "if (!iidx) {\n        return new Match();\n      }",
                                          "start_token": 1250,
                                          "end_token": 1262,
                                          "children": [
                                            {
                                              "type": "PrefixUnaryExpression",
                                              "label": "!iidx",
                                              "start_token": 1252,
                                              "end_token": 1253,
                                              "children": [
                                                {
                                                  "type": "Identifier",
                                                  "label": "iidx",
                                                  "start_token": 1253,
                                                  "end_token": 1253,
                                                  "children": []
                                                }
                                              ]
                                            },
                                            {
                                              "type": "Block",
                                              "label": "{\n        return new Match();\n      }",
                                              "start_token": 1255,
                                              "end_token": 1262,
                                              "children": [
                                                {
                                                  "type": "ReturnStatement",
                                                  "label": "return new Match();",
                                                  "start_token": 1256,
                                                  "end_token": 1261,
                                                  "children": [
                                                    {
                                                      "type": "NewExpression",
                                                      "label": "new Match()",
                                                      "start_token": 1257,
                                                      "end_token": 1260,
                                                      "children": [
                                                        {
                                                          "type": "Identifier",
                                                          "label": "Match",
                                                          "start_token": 1258,
                                                          "end_token": 1258,
                                                          "children": []
                                                        }
                                                      ]
                                                    }
                                                  ]
                                                }
                                              ]
                                            }
                                          ]
                                        },
                                        {
                                          "type": "ReturnStatement",
                                          "label": "return await iidx.all(trx);",
                                          "start_token": 1263,
                                          "end_token": 1271,
                                          "children": [
                                            {
                                              "type": "AwaitExpression",
                                              "label": "await iidx.all(trx)",
                                              "start_token": 1264,
                                              "end_token": 1270,
                                              "children": [
                                                {
                                                  "type": "CallExpression",
                                                  "label": "iidx.all(trx)",
                                                  "start_token": 1265,
                                                  "end_token": 1270,
                                                  "children": [
                                                    {
                                                      "type": "PropertyAccessExpression",
                                                      "label": "iidx.all",
                                                      "start_token": 1265,
                                                      "end_token": 1267,
                                                      "children": [
                                                        {
                                                          "type": "Identifier",
                                                          "label": "iidx",
                                                          "start_token": 1265,
                                                          "end_token": 1265,
                                                          "children": []
                                                        },
                                                        {
                                                          "type": "Identifier",
                                                          "label": "all",
                                                          "start_token": 1267,
                                                          "end_token": 1267,
                                                          "children": []
                                                        }
                                                      ]
                                                    },
                                                    {
                                                      "type": "Identifier",
                                                      "label": "trx",
                                                      "start_token": 1269,
                                                      "end_token": 1269,
                                                      "children": []
                                                    }
                                                  ]
                                                }
                                              ]
                                            }
                                          ]
                                        }
                                      ]
                                    }
                                  ]
                                }
                              ]
                            }
                          ]
                        }
                      ]
                    }
                  ]
                },
                {
                  "type": "ThrowStatement",
                  "label": "throw new Error(`Query type '${query.type}' not supported`);",
                  "start_token": 1273,
                  "end_token": 1279,
                  "children": [
                    {
                      "type": "NewExpression",
                      "label": "new Error(`Query type '${query.type}' not supported`)",
                      "start_token": 1274,
                      "end_token": 1278,
                      "children": [
                        {
                          "type": "Identifier",
                          "label": "Error",
                          "start_token": 1275,
                          "end_token": 1275,
                          "children": []
                        },
                        {
                          "type": "TemplateExpression",
                          "label": "`Query type '${query.type}' not supported`",
                          "start_token": 1277,
                          "end_token": 1277,
                          "children": [
                            {
                              "type": "TemplateHead",
                              "label": "`Query type '${",
                              "start_token": 1277,
                              "end_token": 1277,
                              "children": []
                            },
                            {
                              "type": "TemplateSpan",
                              "label": "query.type}' not supported`",
                              "start_token": 1277,
                              "end_token": 1277,
                              "children": [
                                {
                                  "type": "PropertyAccessExpression",
                                  "label": "query.type",
                                  "start_token": 1277,
                                  "end_token": 1277,
                                  "children": [
                                    {
                                      "type": "Identifier",
                                      "label": "query",
                                      "start_token": 1277,
                                      "end_token": 1277,
                                      "children": []
                                    },
                                    {
                                      "type": "Identifier",
                                      "label": "type",
                                      "start_token": 1277,
                                      "end_token": 1277,
                                      "children": []
                                    }
                                  ]
                                },
                                {
                                  "type": "LastTemplateToken",
                                  "label": "}' not supported`",
                                  "start_token": 1277,
                                  "end_token": 1277,
                                  "children": []
                                }
                              ]
                            }
                          ]
                        }
                      ]
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "type": "MethodDeclaration",
          "label": "async clear(trx: DataStructRWTransaction) {\n    await trx.objectStore('records').clear();\n    await trx.objectStore('invertedIndex').clear();\n    await trx.objectStore('kvMetadata').clear();\n  }",
          "start_token": 1281,
          "end_token": 1325,
          "children": [
            {
              "type": "AsyncKeyword",
              "label": "async",
              "start_token": 1281,
              "end_token": 1281,
              "children": []
            },
            {
              "type": "Identifier",
              "label": "clear",
              "start_token": 1282,
              "end_token": 1282,
              "children": []
            },
            {
              "type": "Parameter",
              "label": "trx: DataStructRWTransaction",
              "start_token": 1284,
              "end_token": 1286,
              "children": [
                {
                  "type": "Identifier",
                  "label": "trx",
                  "start_token": 1284,
                  "end_token": 1284,
                  "children": []
                },
                {
                  "type": "TypeReference",
                  "label": "DataStructRWTransaction",
                  "start_token": 1286,
                  "end_token": 1286,
                  "children": [
                    {
                      "type": "Identifier",
                      "label": "DataStructRWTransaction",
                      "start_token": 1286,
                      "end_token": 1286,
                      "children": []
                    }
                  ]
                }
              ]
            },
            {
              "type": "Block",
              "label": "{\n    await trx.objectStore('records').clear();\n    await trx.objectStore('invertedIndex').clear();\n    await trx.objectStore('kvMetadata').clear();\n  }",
              "start_token": 1288,
              "end_token": 1325,
              "children": [
                {
                  "type": "ExpressionStatement",
                  "label": "await trx.objectStore('records').clear();",
                  "start_token": 1289,
                  "end_token": 1300,
                  "children": [
                    {
                      "type": "AwaitExpression",
                      "label": "await trx.objectStore('records').clear()",
                      "start_token": 1289,
                      "end_token": 1299,
                      "children": [
                        {
                          "type": "CallExpression",
                          "label": "trx.objectStore('records').clear()",
                          "start_token": 1290,
                          "end_token": 1299,
                          "children": [
                            {
                              "type": "PropertyAccessExpression",
                              "label": "trx.objectStore('records').clear",
                              "start_token": 1290,
                              "end_token": 1297,
                              "children": [
                                {
                                  "type": "CallExpression",
                                  "label": "trx.objectStore('records')",
                                  "start_token": 1290,
                                  "end_token": 1295,
                                  "children": [
                                    {
                                      "type": "PropertyAccessExpression",
                                      "label": "trx.objectStore",
                                      "start_token": 1290,
                                      "end_token": 1292,
                                      "children": [
                                        {
                                          "type": "Identifier",
                                          "label": "trx",
                                          "start_token": 1290,
                                          "end_token": 1290,
                                          "children": []
                                        },
                                        {
                                          "type": "Identifier",
                                          "label": "objectStore",
                                          "start_token": 1292,
                                          "end_token": 1292,
                                          "children": []
                                        }
                                      ]
                                    },
                                    {
                                      "type": "StringLiteral",
                                      "label": "'records'",
                                      "start_token": 1294,
                                      "end_token": 1294,
                                      "children": []
                                    }
                                  ]
                                },
                                {
                                  "type": "Identifier",
                                  "label": "clear",
                                  "start_token": 1297,
                                  "end_token": 1297,
                                  "children": []
                                }
                              ]
                            }
                          ]
                        }
                      ]
                    }
                  ]
                },
                {
                  "type": "ExpressionStatement",
                  "label": "await trx.objectStore('invertedIndex').clear();",
                  "start_token": 1301,
                  "end_token": 1312,
                  "children": [
                    {
                      "type": "AwaitExpression",
                      "label": "await trx.objectStore('invertedIndex').clear()",
                      "start_token": 1301,
                      "end_token": 1311,
                      "children": [
                        {
                          "type": "CallExpression",
                          "label": "trx.objectStore('invertedIndex').clear()",
                          "start_token": 1302,
                          "end_token": 1311,
                          "children": [
                            {
                              "type": "PropertyAccessExpression",
                              "label": "trx.objectStore('invertedIndex').clear",
                              "start_token": 1302,
                              "end_token": 1309,
                              "children": [
                                {
                                  "type": "CallExpression",
                                  "label": "trx.objectStore('invertedIndex')",
                                  "start_token": 1302,
                                  "end_token": 1307,
                                  "children": [
                                    {
                                      "type": "PropertyAccessExpression",
                                      "label": "trx.objectStore",
                                      "start_token": 1302,
                                      "end_token": 1304,
                                      "children": [
                                        {
                                          "type": "Identifier",
                                          "label": "trx",
                                          "start_token": 1302,
                                          "end_token": 1302,
                                          "children": []
                                        },
                                        {
                                          "type": "Identifier",
                                          "label": "objectStore",
                                          "start_token": 1304,
                                          "end_token": 1304,
                                          "children": []
                                        }
                                      ]
                                    },
                                    {
                                      "type": "StringLiteral",
                                      "label": "'invertedIndex'",
                                      "start_token": 1306,
                                      "end_token": 1306,
                                      "children": []
                                    }
                                  ]
                                },
                                {
                                  "type": "Identifier",
                                  "label": "clear",
                                  "start_token": 1309,
                                  "end_token": 1309,
                                  "children": []
                                }
                              ]
                            }
                          ]
                        }
                      ]
                    }
                  ]
                },
                {
                  "type": "ExpressionStatement",
                  "label": "await trx.objectStore('kvMetadata').clear();",
                  "start_token": 1313,
                  "end_token": 1324,
                  "children": [
                    {
                      "type": "AwaitExpression",
                      "label": "await trx.objectStore('kvMetadata').clear()",
                      "start_token": 1313,
                      "end_token": 1323,
                      "children": [
                        {
                          "type": "CallExpression",
                          "label": "trx.objectStore('kvMetadata').clear()",
                          "start_token": 1314,
                          "end_token": 1323,
                          "children": [
                            {
                              "type": "PropertyAccessExpression",
                              "label": "trx.objectStore('kvMetadata').clear",
                              "start_token": 1314,
                              "end_token": 1321,
                              "children": [
                                {
                                  "type": "CallExpression",
                                  "label": "trx.objectStore('kvMetadata')",
                                  "start_token": 1314,
                                  "end_token": 1319,
                                  "children": [
                                    {
                                      "type": "PropertyAccessExpression",
                                      "label": "trx.objectStore",
                                      "start_token": 1314,
                                      "end_token": 1316,
                                      "children": [
                                        {
                                          "type": "Identifier",
                                          "label": "trx",
                                          "start_token": 1314,
                                          "end_token": 1314,
                                          "children": []
                                        },
                                        {
                                          "type": "Identifier",
                                          "label": "objectStore",
                                          "start_token": 1316,
                                          "end_token": 1316,
                                          "children": []
                                        }
                                      ]
                                    },
                                    {
                                      "type": "StringLiteral",
                                      "label": "'kvMetadata'",
                                      "start_token": 1318,
                                      "end_token": 1318,
                                      "children": []
                                    }
                                  ]
                                },
                                {
                                  "type": "Identifier",
                                  "label": "clear",
                                  "start_token": 1321,
                                  "end_token": 1321,
                                  "children": []
                                }
                              ]
                            }
                          ]
                        }
                      ]
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "type": "MethodDeclaration",
          "label": "async search(\n    trx: DataStructROTransaction,\n    query: Query<any>,\n    options: SearchOptions<any>\n  ): Promise<SearchResult<any, any>> {\n    const startTime = performance.now();\n    try {\n      const pagination = {\n        skip: options.pagination?.skip ?? 0,\n        limit: options.pagination?.limit ?? 100,\n      };\n      const match = await this.queryRaw(trx, query);\n      const nids = match\n        .toArray()\n        .slice(pagination.skip, pagination.skip + pagination.limit);\n      const nodes = [];\n      for (const nid of nids) {\n        const record = await trx.objectStore('records').get(nid);\n        if (!record) {\n          continue;\n        }\n        nodes.push(this.resultNode(record, options, match, nid));\n      }\n      return {\n        pagination: {\n          count: match.size(),\n          hasMore: match.size() > pagination.limit + pagination.skip,\n          limit: pagination.limit,\n          skip: pagination.skip,\n        },\n        nodes: nodes,\n      };\n    } finally {\n      const endTime = performance.now();\n      if (BUILD_CONFIG.debug) {\n        performance.measure(\n          `[IndexedDB Indexer] Search (${this.databaseName})`,\n          {\n            detail: { query, options },\n            start: startTime,\n            end: endTime,\n          }\n        );\n      }\n      logger.debug(\n        `[indexer ${this.databaseName}] search`,\n        endTime - startTime,\n        'ms',\n        query\n      );\n    }\n  }",
          "start_token": 1326,
          "end_token": 1605,
          "children": [
            {
              "type": "AsyncKeyword",
              "label": "async",
              "start_token": 1326,
              "end_token": 1326,
              "children": []
            },
            {
              "type": "Identifier",
              "label": "search",
              "start_token": 1327,
              "end_token": 1327,
              "children": []
            },
            {
              "type": "Parameter",
              "label": "trx: DataStructROTransaction",
              "start_token": 1329,
              "end_token": 1331,
              "children": [
                {
                  "type": "Identifier",
                  "label": "trx",
                  "start_token": 1329,
                  "end_token": 1329,
                  "children": []
                },
                {
                  "type": "TypeReference",
                  "label": "DataStructROTransaction",
                  "start_token": 1331,
                  "end_token": 1331,
                  "children": [
                    {
                      "type": "Identifier",
                      "label": "DataStructROTransaction",
                      "start_token": 1331,
                      "end_token": 1331,
                      "children": []
                    }
                  ]
                }
              ]
            },
            {
              "type": "Parameter",
              "label": "query: Query<any>",
              "start_token": 1333,
              "end_token": 1338,
              "children": [
                {
                  "type": "Identifier",
                  "label": "query",
                  "start_token": 1333,
                  "end_token": 1333,
                  "children": []
                },
                {
                  "type": "TypeReference",
                  "label": "Query<any>",
                  "start_token": 1335,
                  "end_token": 1338,
                  "children": [
                    {
                      "type": "Identifier",
                      "label": "Query",
                      "start_token": 1335,
                      "end_token": 1335,
                      "children": []
                    },
                    {
                      "type": "AnyKeyword",
                      "label": "any",
                      "start_token": 1337,
                      "end_token": 1337,
                      "children": []
                    }
                  ]
                }
              ]
            },
            {
              "type": "Parameter",
              "label": "options: SearchOptions<any>",
              "start_token": 1340,
              "end_token": 1345,
              "children": [
                {
                  "type": "Identifier",
                  "label": "options",
                  "start_token": 1340,
                  "end_token": 1340,
                  "children": []
                },
                {
                  "type": "TypeReference",
                  "label": "SearchOptions<any>",
                  "start_token": 1342,
                  "end_token": 1345,
                  "children": [
                    {
                      "type": "Identifier",
                      "label": "SearchOptions",
                      "start_token": 1342,
                      "end_token": 1342,
                      "children": []
                    },
                    {
                      "type": "AnyKeyword",
                      "label": "any",
                      "start_token": 1344,
                      "end_token": 1344,
                      "children": []
                    }
                  ]
                }
              ]
            },
            {
              "type": "TypeReference",
              "label": "Promise<SearchResult<any, any>>",
              "start_token": 1348,
              "end_token": 1356,
              "children": [
                {
                  "type": "Identifier",
                  "label": "Promise",
                  "start_token": 1348,
                  "end_token": 1348,
                  "children": []
                },
                {
                  "type": "TypeReference",
                  "label": "SearchResult<any, any>",
                  "start_token": 1350,
                  "end_token": 1355,
                  "children": [
                    {
                      "type": "Identifier",
                      "label": "SearchResult",
                      "start_token": 1350,
                      "end_token": 1350,
                      "children": []
                    },
                    {
                      "type": "AnyKeyword",
                      "label": "any",
                      "start_token": 1352,
                      "end_token": 1352,
                      "children": []
                    },
                    {
                      "type": "AnyKeyword",
                      "label": "any",
                      "start_token": 1354,
                      "end_token": 1354,
                      "children": []
                    }
                  ]
                }
              ]
            },
            {
              "type": "Block",
              "label": "{\n    const startTime = performance.now();\n    try {\n      const pagination = {\n        skip: options.pagination?.skip ?? 0,\n        limit: options.pagination?.limit ?? 100,\n      };\n      const match = await this.queryRaw(trx, query);\n      const nids = match\n        .toArray()\n        .slice(pagination.skip, pagination.skip + pagination.limit);\n      const nodes = [];\n      for (const nid of nids) {\n        const record = await trx.objectStore('records').get(nid);\n        if (!record) {\n          continue;\n        }\n        nodes.push(this.resultNode(record, options, match, nid));\n      }\n      return {\n        pagination: {\n          count: match.size(),\n          hasMore: match.size() > pagination.limit + pagination.skip,\n          limit: pagination.limit,\n          skip: pagination.skip,\n        },\n        nodes: nodes,\n      };\n    } finally {\n      const endTime = performance.now();\n      if (BUILD_CONFIG.debug) {\n        performance.measure(\n          `[IndexedDB Indexer] Search (${this.databaseName})`,\n          {\n            detail: { query, options },\n            start: startTime,\n            end: endTime,\n          }\n        );\n      }\n      logger.debug(\n        `[indexer ${this.databaseName}] search`,\n        endTime - startTime,\n        'ms',\n        query\n      );\n    }\n  }",
              "start_token": 1357,
              "end_token": 1605,
              "children": [
                {
                  "type": "FirstStatement",
                  "label": "const startTime = performance.now();",
                  "start_token": 1358,
                  "end_token": 1366,
                  "children": [
                    {
                      "type": "VariableDeclarationList",
                      "label": "const startTime = performance.now()",
                      "start_token": 1358,
                      "end_token": 1365,
                      "children": [
                        {
                          "type": "VariableDeclaration",
                          "label": "startTime = performance.now()",
                          "start_token": 1359,
                          "end_token": 1365,
                          "children": [
                            {
                              "type": "Identifier",
                              "label": "startTime",
                              "start_token": 1359,
                              "end_token": 1359,
                              "children": []
                            },
                            {
                              "type": "CallExpression",
                              "label": "performance.now()",
                              "start_token": 1361,
                              "end_token": 1365,
                              "children": [
                                {
                                  "type": "PropertyAccessExpression",
                                  "label": "performance.now",
                                  "start_token": 1361,
                                  "end_token": 1363,
                                  "children": [
                                    {
                                      "type": "Identifier",
                                      "label": "performance",
                                      "start_token": 1361,
                                      "end_token": 1361,
                                      "children": []
                                    },
                                    {
                                      "type": "Identifier",
                                      "label": "now",
                                      "start_token": 1363,
                                      "end_token": 1363,
                                      "children": []
                                    }
                                  ]
                                }
                              ]
                            }
                          ]
                        }
                      ]
                    }
                  ]
                },
                {
                  "type": "TryStatement",
                  "label": "try {\n      const pagination = {\n        skip: options.pagination?.skip ?? 0,\n        limit: options.pagination?.limit ?? 100,\n      };\n      const match = await this.queryRaw(trx, query);\n      const nids = match\n        .toArray()\n        .slice(pagination.skip, pagination.skip + pagination.limit);\n      const nodes = [];\n      for (const nid of nids) {\n        const record = await trx.objectStore('records').get(nid);\n        if (!record) {\n          continue;\n        }\n        nodes.push(this.resultNode(record, options, match, nid));\n      }\n      return {\n        pagination: {\n          count: match.size(),\n          hasMore: match.size() > pagination.limit + pagination.skip,\n          limit: pagination.limit,\n          skip: pagination.skip,\n        },\n        nodes: nodes,\n      };\n    } finally {\n      const endTime = performance.now();\n      if (BUILD_CONFIG.debug) {\n        performance.measure(\n          `[IndexedDB Indexer] Search (${this.databaseName})`,\n          {\n            detail: { query, options },\n            start: startTime,\n            end: endTime,\n          }\n        );\n      }\n      logger.debug(\n        `[indexer ${this.databaseName}] search`,\n        endTime - startTime,\n        'ms',\n        query\n      );\n    }",
                  "start_token": 1367,
                  "end_token": 1604,
                  "children": [
                    {
                      "type": "Block",
                      "label": "{\n      const pagination = {\n        skip: options.pagination?.skip ?? 0,\n        limit: options.pagination?.limit ?? 100,\n      };\n      const match = await this.queryRaw(trx, query);\n      const nids = match\n        .toArray()\n        .slice(pagination.skip, pagination.skip + pagination.limit);\n      const nodes = [];\n      for (const nid of nids) {\n        const record = await trx.objectStore('records').get(nid);\n        if (!record) {\n          continue;\n        }\n        nodes.push(this.resultNode(record, options, match, nid));\n      }\n      return {\n        pagination: {\n          count: match.size(),\n          hasMore: match.size() > pagination.limit + pagination.skip,\n          limit: pagination.limit,\n          skip: pagination.skip,\n        },\n        nodes: nodes,\n      };\n    }",
                      "start_token": 1368,
                      "end_token": 1543,
                      "children": [
                        {
                          "type": "FirstStatement",
                          "label": "const pagination = {\n        skip: options.pagination?.skip ?? 0,\n        limit: options.pagination?.limit ?? 100,\n      };",
                          "start_token": 1369,
                          "end_token": 1398,
                          "children": [
                            {
                              "type": "VariableDeclarationList",
                              "label": "const pagination = {\n        skip: options.pagination?.skip ?? 0,\n        limit: options.pagination?.limit ?? 100,\n      }",
                              "start_token": 1369,
                              "end_token": 1397,
                              "children": [
                                {
                                  "type": "VariableDeclaration",
                                  "label": "pagination = {\n        skip: options.pagination?.skip ?? 0,\n        limit: options.pagination?.limit ?? 100,\n      }",
                                  "start_token": 1370,
                                  "end_token": 1397,
                                  "children": [
                                    {
                                      "type": "Identifier",
                                      "label": "pagination",
                                      "start_token": 1370,
                                      "end_token": 1370,
                                      "children": []
                                    },
                                    {
                                      "type": "ObjectLiteralExpression",
                                      "label": "{\n        skip: options.pagination?.skip ?? 0,\n        limit: options.pagination?.limit ?? 100,\n      }",
                                      "start_token": 1372,
                                      "end_token": 1397,
                                      "children": [
                                        {
                                          "type": "PropertyAssignment",
                                          "label": "skip: options.pagination?.skip ?? 0",
                                          "start_token": 1373,
                                          "end_token": 1383,
                                          "children": [
                                            {
                                              "type": "Identifier",
                                              "label": "skip",
                                              "start_token": 1373,
                                              "end_token": 1373,
                                              "children": []
                                            },
                                            {
                                              "type": "BinaryExpression",
                                              "label": "options.pagination?.skip ?? 0",
                                              "start_token": 1375,
                                              "end_token": 1383,
                                              "children": [
                                                {
                                                  "type": "PropertyAccessExpression",
                                                  "label": "options.pagination?.skip",
                                                  "start_token": 1375,
                                                  "end_token": 1380,
                                                  "children": [
                                                    {
                                                      "type": "PropertyAccessExpression",
                                                      "label": "options.pagination",
                                                      "start_token": 1375,
                                                      "end_token": 1377,
                                                      "children": [
                                                        {
                                                          "type": "Identifier",
                                                          "label": "options",
                                                          "start_token": 1375,
                                                          "end_token": 1375,
                                                          "children": []
                                                        },
                                                        {
                                                          "type": "Identifier",
                                                          "label": "pagination",
                                                          "start_token": 1377,
                                                          "end_token": 1377,
                                                          "children": []
                                                        }
                                                      ]
                                                    },
                                                    {
                                                      "type": "QuestionDotToken",
                                                      "label": "?.",
                                                      "start_token": 1378,
                                                      "end_token": 1379,
                                                      "children": []
                                                    },
                                                    {
                                                      "type": "Identifier",
                                                      "label": "skip",
                                                      "start_token": 1380,
                                                      "end_token": 1380,
                                                      "children": []
                                                    }
                                                  ]
                                                },
                                                {
                                                  "type": "QuestionQuestionToken",
                                                  "label": "??",
                                                  "start_token": 1381,
                                                  "end_token": 1382,
                                                  "children": []
                                                },
                                                {
                                                  "type": "FirstLiteralToken",
                                                  "label": "0",
                                                  "start_token": 1383,
                                                  "end_token": 1383,
                                                  "children": []
                                                }
                                              ]
                                            }
                                          ]
                                        },
                                        {
                                          "type": "PropertyAssignment",
                                          "label": "limit: options.pagination?.limit ?? 100",
                                          "start_token": 1385,
                                          "end_token": 1395,
                                          "children": [
                                            {
                                              "type": "Identifier",
                                              "label": "limit",
                                              "start_token": 1385,
                                              "end_token": 1385,
                                              "children": []
                                            },
                                            {
                                              "type": "BinaryExpression",
                                              "label": "options.pagination?.limit ?? 100",
                                              "start_token": 1387,
                                              "end_token": 1395,
                                              "children": [
                                                {
                                                  "type": "PropertyAccessExpression",
                                                  "label": "options.pagination?.limit",
                                                  "start_token": 1387,
                                                  "end_token": 1392,
                                                  "children": [
                                                    {
                                                      "type": "PropertyAccessExpression",
                                                      "label": "options.pagination",
                                                      "start_token": 1387,
                                                      "end_token": 1389,
                                                      "children": [
                                                        {
                                                          "type": "Identifier",
                                                          "label": "options",
                                                          "start_token": 1387,
                                                          "end_token": 1387,
                                                          "children": []
                                                        },
                                                        {
                                                          "type": "Identifier",
                                                          "label": "pagination",
                                                          "start_token": 1389,
                                                          "end_token": 1389,
                                                          "children": []
                                                        }
                                                      ]
                                                    },
                                                    {
                                                      "type": "QuestionDotToken",
                                                      "label": "?.",
                                                      "start_token": 1390,
                                                      "end_token": 1391,
                                                      "children": []
                                                    },
                                                    {
                                                      "type": "Identifier",
                                                      "label": "limit",
                                                      "start_token": 1392,
                                                      "end_token": 1392,
                                                      "children": []
                                                    }
                                                  ]
                                                },
                                                {
                                                  "type": "QuestionQuestionToken",
                                                  "label": "??",
                                                  "start_token": 1393,
                                                  "end_token": 1394,
                                                  "children": []
                                                },
                                                {
                                                  "type": "FirstLiteralToken",
                                                  "label": "100",
                                                  "start_token": 1395,
                                                  "end_token": 1395,
                                                  "children": []
                                                }
                                              ]
                                            }
                                          ]
                                        }
                                      ]
                                    }
                                  ]
                                }
                              ]
                            }
                          ]
                        },
                        {
                          "type": "FirstStatement",
                          "label": "const match = await this.queryRaw(trx, query);",
                          "start_token": 1399,
                          "end_token": 1411,
                          "children": [
                            {
                              "type": "VariableDeclarationList",
                              "label": "const match = await this.queryRaw(trx, query)",
                              "start_token": 1399,
                              "end_token": 1410,
                              "children": [
                                {
                                  "type": "VariableDeclaration",
                                  "label": "match = await this.queryRaw(trx, query)",
                                  "start_token": 1400,
                                  "end_token": 1410,
                                  "children": [
                                    {
                                      "type": "Identifier",
                                      "label": "match",
                                      "start_token": 1400,
                                      "end_token": 1400,
                                      "children": []
                                    },
                                    {
                                      "type": "AwaitExpression",
                                      "label": "await this.queryRaw(trx, query)",
                                      "start_token": 1402,
                                      "end_token": 1410,
                                      "children": [
                                        {
                                          "type": "CallExpression",
                                          "label": "this.queryRaw(trx, query)",
                                          "start_token": 1403,
                                          "end_token": 1410,
                                          "children": [
                                            {
                                              "type": "PropertyAccessExpression",
                                              "label": "this.queryRaw",
                                              "start_token": 1403,
                                              "end_token": 1405,
                                              "children": [
                                                {
                                                  "type": "ThisKeyword",
                                                  "label": "this",
                                                  "start_token": 1403,
                                                  "end_token": 1403,
                                                  "children": []
                                                },
                                                {
                                                  "type": "Identifier",
                                                  "label": "queryRaw",
                                                  "start_token": 1405,
                                                  "end_token": 1405,
                                                  "children": []
                                                }
                                              ]
                                            },
                                            {
                                              "type": "Identifier",
                                              "label": "trx",
                                              "start_token": 1407,
                                              "end_token": 1407,
                                              "children": []
                                            },
                                            {
                                              "type": "Identifier",
                                              "label": "query",
                                              "start_token": 1409,
                                              "end_token": 1409,
                                              "children": []
                                            }
                                          ]
                                        }
                                      ]
                                    }
                                  ]
                                }
                              ]
                            }
                          ]
                        },
                        {
                          "type": "FirstStatement",
                          "label": "const nids = match\n        .toArray()\n        .slice(pagination.skip, pagination.skip + pagination.limit);",
                          "start_token": 1412,
                          "end_token": 1435,
                          "children": [
                            {
                              "type": "VariableDeclarationList",
                              "label": "const nids = match\n        .toArray()\n        .slice(pagination.skip, pagination.skip + pagination.limit)",
                              "start_token": 1412,
                              "end_token": 1434,
                              "children": [
                                {
                                  "type": "VariableDeclaration",
                                  "label": "nids = match\n        .toArray()\n        .slice(pagination.skip, pagination.skip + pagination.limit)",
                                  "start_token": 1413,
                                  "end_token": 1434,
                                  "children": [
                                    {
                                      "type": "Identifier",
                                      "label": "nids",
                                      "start_token": 1413,
                                      "end_token": 1413,
                                      "children": []
                                    },
                                    {
                                      "type": "CallExpression",
                                      "label": "match\n        .toArray()\n        .slice(pagination.skip, pagination.skip + pagination.limit)",
                                      "start_token": 1415,
                                      "end_token": 1434,
                                      "children": [
                                        {
                                          "type": "PropertyAccessExpression",
                                          "label": "match\n        .toArray()\n        .slice",
                                          "start_token": 1415,
                                          "end_token": 1421,
                                          "children": [
                                            {
                                              "type": "CallExpression",
                                              "label": "match\n        .toArray()",
                                              "start_token": 1415,
                                              "end_token": 1419,
                                              "children": [
                                                {
                                                  "type": "PropertyAccessExpression",
                                                  "label": "match\n        .toArray",
                                                  "start_token": 1415,
                                                  "end_token": 1417,
                                                  "children": [
                                                    {
                                                      "type": "Identifier",
                                                      "label": "match",
                                                      "start_token": 1415,
                                                      "end_token": 1415,
                                                      "children": []
                                                    },
                                                    {
                                                      "type": "Identifier",
                                                      "label": "toArray",
                                                      "start_token": 1417,
                                                      "end_token": 1417,
                                                      "children": []
                                                    }
                                                  ]
                                                }
                                              ]
                                            },
                                            {
                                              "type": "Identifier",
                                              "label": "slice",
                                              "start_token": 1421,
                                              "end_token": 1421,
                                              "children": []
                                            }
                                          ]
                                        },
                                        {
                                          "type": "PropertyAccessExpression",
                                          "label": "pagination.skip",
                                          "start_token": 1423,
                                          "end_token": 1425,
                                          "children": [
                                            {
                                              "type": "Identifier",
                                              "label": "pagination",
                                              "start_token": 1423,
                                              "end_token": 1423,
                                              "children": []
                                            },
                                            {
                                              "type": "Identifier",
                                              "label": "skip",
                                              "start_token": 1425,
                                              "end_token": 1425,
                                              "children": []
                                            }
                                          ]
                                        },
                                        {
                                          "type": "BinaryExpression",
                                          "label": "pagination.skip + pagination.limit",
                                          "start_token": 1427,
                                          "end_token": 1433,
                                          "children": [
                                            {
                                              "type": "PropertyAccessExpression",
                                              "label": "pagination.skip",
                                              "start_token": 1427,
                                              "end_token": 1429,
                                              "children": [
                                                {
                                                  "type": "Identifier",
                                                  "label": "pagination",
                                                  "start_token": 1427,
                                                  "end_token": 1427,
                                                  "children": []
                                                },
                                                {
                                                  "type": "Identifier",
                                                  "label": "skip",
                                                  "start_token": 1429,
                                                  "end_token": 1429,
                                                  "children": []
                                                }
                                              ]
                                            },
                                            {
                                              "type": "PlusToken",
                                              "label": "+",
                                              "start_token": 1430,
                                              "end_token": 1430,
                                              "children": []
                                            },
                                            {
                                              "type": "PropertyAccessExpression",
                                              "label": "pagination.limit",
                                              "start_token": 1431,
                                              "end_token": 1433,
                                              "children": [
                                                {
                                                  "type": "Identifier",
                                                  "label": "pagination",
                                                  "start_token": 1431,
                                                  "end_token": 1431,
                                                  "children": []
                                                },
                                                {
                                                  "type": "Identifier",
                                                  "label": "limit",
                                                  "start_token": 1433,
                                                  "end_token": 1433,
                                                  "children": []
                                                }
                                              ]
                                            }
                                          ]
                                        }
                                      ]
                                    }
                                  ]
                                }
                              ]
                            }
                          ]
                        },
                        {
                          "type": "FirstStatement",
                          "label": "const nodes = [];",
                          "start_token": 1436,
                          "end_token": 1441,
                          "children": [
                            {
                              "type": "VariableDeclarationList",
                              "label": "const nodes = []",
                              "start_token": 1436,
                              "end_token": 1440,
                              "children": [
                                {
                                  "type": "VariableDeclaration",
                                  "label": "nodes = []",
                                  "start_token": 1437,
                                  "end_token": 1440,
                                  "children": [
                                    {
                                      "type": "Identifier",
                                      "label": "nodes",
                                      "start_token": 1437,
                                      "end_token": 1437,
                                      "children": []
                                    },
                                    {
                                      "type": "ArrayLiteralExpression",
                                      "label": "[]",
                                      "start_token": 1439,
                                      "end_token": 1440,
                                      "children": []
                                    }
                                  ]
                                }
                              ]
                            }
                          ]
                        },
                        {
                          "type": "ForOfStatement",
                          "label": "for (const nid of nids) {\n        const record = await trx.objectStore('records').get(nid);\n        if (!record) {\n          continue;\n        }\n        nodes.push(this.resultNode(record, options, match, nid));\n      }",
                          "start_token": 1442,
                          "end_token": 1493,
                          "children": [
                            {
                              "type": "VariableDeclarationList",
                              "label": "const nid",
                              "start_token": 1444,
                              "end_token": 1445,
                              "children": [
                                {
                                  "type": "VariableDeclaration",
                                  "label": "nid",
                                  "start_token": 1445,
                                  "end_token": 1445,
                                  "children": [
                                    {
                                      "type": "Identifier",
                                      "label": "nid",
                                      "start_token": 1445,
                                      "end_token": 1445,
                                      "children": []
                                    }
                                  ]
                                }
                              ]
                            },
                            {
                              "type": "Identifier",
                              "label": "nids",
                              "start_token": 1447,
                              "end_token": 1447,
                              "children": []
                            },
                            {
                              "type": "Block",
                              "label": "{\n        const record = await trx.objectStore('records').get(nid);\n        if (!record) {\n          continue;\n        }\n        nodes.push(this.resultNode(record, options, match, nid));\n      }",
                              "start_token": 1449,
                              "end_token": 1493,
                              "children": [
                                {
                                  "type": "FirstStatement",
                                  "label": "const record = await trx.objectStore('records').get(nid);",
                                  "start_token": 1450,
                                  "end_token": 1465,
                                  "children": [
                                    {
                                      "type": "VariableDeclarationList",
                                      "label": "const record = await trx.objectStore('records').get(nid)",
                                      "start_token": 1450,
                                      "end_token": 1464,
                                      "children": [
                                        {
                                          "type": "VariableDeclaration",
                                          "label": "record = await trx.objectStore('records').get(nid)",
                                          "start_token": 1451,
                                          "end_token": 1464,
                                          "children": [
                                            {
                                              "type": "Identifier",
                                              "label": "record",
                                              "start_token": 1451,
                                              "end_token": 1451,
                                              "children": []
                                            },
                                            {
                                              "type": "AwaitExpression",
                                              "label": "await trx.objectStore('records').get(nid)",
                                              "start_token": 1453,
                                              "end_token": 1464,
                                              "children": [
                                                {
                                                  "type": "CallExpression",
                                                  "label": "trx.objectStore('records').get(nid)",
                                                  "start_token": 1454,
                                                  "end_token": 1464,
                                                  "children": [
                                                    {
                                                      "type": "PropertyAccessExpression",
                                                      "label": "trx.objectStore('records').get",
                                                      "start_token": 1454,
                                                      "end_token": 1461,
                                                      "children": [
                                                        {
                                                          "type": "CallExpression",
                                                          "label": "trx.objectStore('records')",
                                                          "start_token": 1454,
                                                          "end_token": 1459,
                                                          "children": [
                                                            {
                                                              "type": "PropertyAccessExpression",
                                                              "label": "trx.objectStore",
                                                              "start_token": 1454,
                                                              "end_token": 1456,
                                                              "children": [
                                                                {
                                                                  "type": "Identifier",
                                                                  "label": "trx",
                                                                  "start_token": 1454,
                                                                  "end_token": 1454,
                                                                  "children": []
                                                                },
                                                                {
                                                                  "type": "Identifier",
                                                                  "label": "objectStore",
                                                                  "start_token": 1456,
                                                                  "end_token": 1456,
                                                                  "children": []
                                                                }
                                                              ]
                                                            },
                                                            {
                                                              "type": "StringLiteral",
                                                              "label": "'records'",
                                                              "start_token": 1458,
                                                              "end_token": 1458,
                                                              "children": []
                                                            }
                                                          ]
                                                        },
                                                        {
                                                          "type": "Identifier",
                                                          "label": "get",
                                                          "start_token": 1461,
                                                          "end_token": 1461,
                                                          "children": []
                                                        }
                                                      ]
                                                    },
                                                    {
                                                      "type": "Identifier",
                                                      "label": "nid",
                                                      "start_token": 1463,
                                                      "end_token": 1463,
                                                      "children": []
                                                    }
                                                  ]
                                                }
                                              ]
                                            }
                                          ]
                                        }
                                      ]
                                    }
                                  ]
                                },
                                {
                                  "type": "IfStatement",
                                  "label": "if (!record) {\n          continue;\n        }",
                                  "start_token": 1466,
                                  "end_token": 1474,
                                  "children": [
                                    {
                                      "type": "PrefixUnaryExpression",
                                      "label": "!record",
                                      "start_token": 1468,
                                      "end_token": 1469,
                                      "children": [
                                        {
                                          "type": "Identifier",
                                          "label": "record",
                                          "start_token": 1469,
                                          "end_token": 1469,
                                          "children": []
                                        }
                                      ]
                                    },
                                    {
                                      "type": "Block",
                                      "label": "{\n          continue;\n        }",
                                      "start_token": 1471,
                                      "end_token": 1474,
                                      "children": [
                                        {
                                          "type": "ContinueStatement",
                                          "label": "continue;",
                                          "start_token": 1472,
                                          "end_token": 1473,
                                          "children": []
                                        }
                                      ]
                                    }
                                  ]
                                },
                                {
                                  "type": "ExpressionStatement",
                                  "label": "nodes.push(this.resultNode(record, options, match, nid));",
                                  "start_token": 1475,
                                  "end_token": 1492,
                                  "children": [
                                    {
                                      "type": "CallExpression",
                                      "label": "nodes.push(this.resultNode(record, options, match, nid))",
                                      "start_token": 1475,
                                      "end_token": 1491,
                                      "children": [
                                        {
                                          "type": "PropertyAccessExpression",
                                          "label": "nodes.push",
                                          "start_token": 1475,
                                          "end_token": 1477,
                                          "children": [
                                            {
                                              "type": "Identifier",
                                              "label": "nodes",
                                              "start_token": 1475,
                                              "end_token": 1475,
                                              "children": []
                                            },
                                            {
                                              "type": "Identifier",
                                              "label": "push",
                                              "start_token": 1477,
                                              "end_token": 1477,
                                              "children": []
                                            }
                                          ]
                                        },
                                        {
                                          "type": "CallExpression",
                                          "label": "this.resultNode(record, options, match, nid)",
                                          "start_token": 1479,
                                          "end_token": 1490,
                                          "children": [
                                            {
                                              "type": "PropertyAccessExpression",
                                              "label": "this.resultNode",
                                              "start_token": 1479,
                                              "end_token": 1481,
                                              "children": [
                                                {
                                                  "type": "ThisKeyword",
                                                  "label": "this",
                                                  "start_token": 1479,
                                                  "end_token": 1479,
                                                  "children": []
                                                },
                                                {
                                                  "type": "Identifier",
                                                  "label": "resultNode",
                                                  "start_token": 1481,
                                                  "end_token": 1481,
                                                  "children": []
                                                }
                                              ]
                                            },
                                            {
                                              "type": "Identifier",
                                              "label": "record",
                                              "start_token": 1483,
                                              "end_token": 1483,
                                              "children": []
                                            },
                                            {
                                              "type": "Identifier",
                                              "label": "options",
                                              "start_token": 1485,
                                              "end_token": 1485,
                                              "children": []
                                            },
                                            {
                                              "type": "Identifier",
                                              "label": "match",
                                              "start_token": 1487,
                                              "end_token": 1487,
                                              "children": []
                                            },
                                            {
                                              "type": "Identifier",
                                              "label": "nid",
                                              "start_token": 1489,
                                              "end_token": 1489,
                                              "children": []
                                            }
                                          ]
                                        }
                                      ]
                                    }
                                  ]
                                }
                              ]
                            }
                          ]
                        },
                        {
                          "type": "ReturnStatement",
                          "label": "return {\n        pagination: {\n          count: match.size(),\n          hasMore: match.size() > pagination.limit + pagination.skip,\n          limit: pagination.limit,\n          skip: pagination.skip,\n        },\n        nodes: nodes,\n      };",
                          "start_token": 1494,
                          "end_token": 1542,
                          "children": [
                            {
                              "type": "ObjectLiteralExpression",
                              "label": "{\n        pagination: {\n          count: match.size(),\n          hasMore: match.size() > pagination.limit + pagination.skip,\n          limit: pagination.limit,\n          skip: pagination.skip,\n        },\n        nodes: nodes,\n      }",
                              "start_token": 1495,
                              "end_token": 1541,
                              "children": [
                                {
                                  "type": "PropertyAssignment",
                                  "label": "pagination: {\n          count: match.size(),\n          hasMore: match.size() > pagination.limit + pagination.skip,\n          limit: pagination.limit,\n          skip: pagination.skip,\n        }",
                                  "start_token": 1496,
                                  "end_token": 1535,
                                  "children": [
                                    {
                                      "type": "Identifier",
                                      "label": "pagination",
                                      "start_token": 1496,
                                      "end_token": 1496,
                                      "children": []
                                    },
                                    {
                                      "type": "ObjectLiteralExpression",
                                      "label": "{\n          count: match.size(),\n          hasMore: match.size() > pagination.limit + pagination.skip,\n          limit: pagination.limit,\n          skip: pagination.skip,\n        }",
                                      "start_token": 1498,
                                      "end_token": 1535,
                                      "children": [
                                        {
                                          "type": "PropertyAssignment",
                                          "label": "count: match.size()",
                                          "start_token": 1499,
                                          "end_token": 1505,
                                          "children": [
                                            {
                                              "type": "Identifier",
                                              "label": "count",
                                              "start_token": 1499,
                                              "end_token": 1499,
                                              "children": []
                                            },
                                            {
                                              "type": "CallExpression",
                                              "label": "match.size()",
                                              "start_token": 1501,
                                              "end_token": 1505,
                                              "children": [
                                                {
                                                  "type": "PropertyAccessExpression",
                                                  "label": "match.size",
                                                  "start_token": 1501,
                                                  "end_token": 1503,
                                                  "children": [
                                                    {
                                                      "type": "Identifier",
                                                      "label": "match",
                                                      "start_token": 1501,
                                                      "end_token": 1501,
                                                      "children": []
                                                    },
                                                    {
                                                      "type": "Identifier",
                                                      "label": "size",
                                                      "start_token": 1503,
                                                      "end_token": 1503,
                                                      "children": []
                                                    }
                                                  ]
                                                }
                                              ]
                                            }
                                          ]
                                        },
                                        {
                                          "type": "PropertyAssignment",
                                          "label": "hasMore: match.size() > pagination.limit + pagination.skip",
                                          "start_token": 1507,
                                          "end_token": 1521,
                                          "children": [
                                            {
                                              "type": "Identifier",
                                              "label": "hasMore",
                                              "start_token": 1507,
                                              "end_token": 1507,
                                              "children": []
                                            },
                                            {
                                              "type": "BinaryExpression",
                                              "label": "match.size() > pagination.limit + pagination.skip",
                                              "start_token": 1509,
                                              "end_token": 1521,
                                              "children": [
                                                {
                                                  "type": "CallExpression",
                                                  "label": "match.size()",
                                                  "start_token": 1509,
                                                  "end_token": 1513,
                                                  "children": [
                                                    {
                                                      "type": "PropertyAccessExpression",
                                                      "label": "match.size",
                                                      "start_token": 1509,
                                                      "end_token": 1511,
                                                      "children": [
                                                        {
                                                          "type": "Identifier",
                                                          "label": "match",
                                                          "start_token": 1509,
                                                          "end_token": 1509,
                                                          "children": []
                                                        },
                                                        {
                                                          "type": "Identifier",
                                                          "label": "size",
                                                          "start_token": 1511,
                                                          "end_token": 1511,
                                                          "children": []
                                                        }
                                                      ]
                                                    }
                                                  ]
                                                },
                                                {
                                                  "type": "GreaterThanToken",
                                                  "label": ">",
                                                  "start_token": 1514,
                                                  "end_token": 1514,
                                                  "children": []
                                                },
                                                {
                                                  "type": "BinaryExpression",
                                                  "label": "pagination.limit + pagination.skip",
                                                  "start_token": 1515,
                                                  "end_token": 1521,
                                                  "children": [
                                                    {
                                                      "type": "PropertyAccessExpression",
                                                      "label": "pagination.limit",
                                                      "start_token": 1515,
                                                      "end_token": 1517,
                                                      "children": [
                                                        {
                                                          "type": "Identifier",
                                                          "label": "pagination",
                                                          "start_token": 1515,
                                                          "end_token": 1515,
                                                          "children": []
                                                        },
                                                        {
                                                          "type": "Identifier",
                                                          "label": "limit",
                                                          "start_token": 1517,
                                                          "end_token": 1517,
                                                          "children": []
                                                        }
                                                      ]
                                                    },
                                                    {
                                                      "type": "PlusToken",
                                                      "label": "+",
                                                      "start_token": 1518,
                                                      "end_token": 1518,
                                                      "children": []
                                                    },
                                                    {
                                                      "type": "PropertyAccessExpression",
                                                      "label": "pagination.skip",
                                                      "start_token": 1519,
                                                      "end_token": 1521,
                                                      "children": [
                                                        {
                                                          "type": "Identifier",
                                                          "label": "pagination",
                                                          "start_token": 1519,
                                                          "end_token": 1519,
                                                          "children": []
                                                        },
                                                        {
                                                          "type": "Identifier",
                                                          "label": "skip",
                                                          "start_token": 1521,
                                                          "end_token": 1521,
                                                          "children": []
                                                        }
                                                      ]
                                                    }
                                                  ]
                                                }
                                              ]
                                            }
                                          ]
                                        },
                                        {
                                          "type": "PropertyAssignment",
                                          "label": "limit: pagination.limit",
                                          "start_token": 1523,
                                          "end_token": 1527,
                                          "children": [
                                            {
                                              "type": "Identifier",
                                              "label": "limit",
                                              "start_token": 1523,
                                              "end_token": 1523,
                                              "children": []
                                            },
                                            {
                                              "type": "PropertyAccessExpression",
                                              "label": "pagination.limit",
                                              "start_token": 1525,
                                              "end_token": 1527,
                                              "children": [
                                                {
                                                  "type": "Identifier",
                                                  "label": "pagination",
                                                  "start_token": 1525,
                                                  "end_token": 1525,
                                                  "children": []
                                                },
                                                {
                                                  "type": "Identifier",
                                                  "label": "limit",
                                                  "start_token": 1527,
                                                  "end_token": 1527,
                                                  "children": []
                                                }
                                              ]
                                            }
                                          ]
                                        },
                                        {
                                          "type": "PropertyAssignment",
                                          "label": "skip: pagination.skip",
                                          "start_token": 1529,
                                          "end_token": 1533,
                                          "children": [
                                            {
                                              "type": "Identifier",
                                              "label": "skip",
                                              "start_token": 1529,
                                              "end_token": 1529,
                                              "children": []
                                            },
                                            {
                                              "type": "PropertyAccessExpression",
                                              "label": "pagination.skip",
                                              "start_token": 1531,
                                              "end_token": 1533,
                                              "children": [
                                                {
                                                  "type": "Identifier",
                                                  "label": "pagination",
                                                  "start_token": 1531,
                                                  "end_token": 1531,
                                                  "children": []
                                                },
                                                {
                                                  "type": "Identifier",
                                                  "label": "skip",
                                                  "start_token": 1533,
                                                  "end_token": 1533,
                                                  "children": []
                                                }
                                              ]
                                            }
                                          ]
                                        }
                                      ]
                                    }
                                  ]
                                },
                                {
                                  "type": "PropertyAssignment",
                                  "label": "nodes: nodes",
                                  "start_token": 1537,
                                  "end_token": 1539,
                                  "children": [
                                    {
                                      "type": "Identifier",
                                      "label": "nodes",
                                      "start_token": 1537,
                                      "end_token": 1537,
                                      "children": []
                                    },
                                    {
                                      "type": "Identifier",
                                      "label": "nodes",
                                      "start_token": 1539,
                                      "end_token": 1539,
                                      "children": []
                                    }
                                  ]
                                }
                              ]
                            }
                          ]
                        }
                      ]
                    },
                    {
                      "type": "Block",
                      "label": "{\n      const endTime = performance.now();\n      if (BUILD_CONFIG.debug) {\n        performance.measure(\n          `[IndexedDB Indexer] Search (${this.databaseName})`,\n          {\n            detail: { query, options },\n            start: startTime,\n            end: endTime,\n          }\n        );\n      }\n      logger.debug(\n        `[indexer ${this.databaseName}] search`,\n        endTime - startTime,\n        'ms',\n        query\n      );\n    }",
                      "start_token": 1545,
                      "end_token": 1604,
                      "children": [
                        {
                          "type": "FirstStatement",
                          "label": "const endTime = performance.now();",
                          "start_token": 1546,
                          "end_token": 1554,
                          "children": [
                            {
                              "type": "VariableDeclarationList",
                              "label": "const endTime = performance.now()",
                              "start_token": 1546,
                              "end_token": 1553,
                              "children": [
                                {
                                  "type": "VariableDeclaration",
                                  "label": "endTime = performance.now()",
                                  "start_token": 1547,
                                  "end_token": 1553,
                                  "children": [
                                    {
                                      "type": "Identifier",
                                      "label": "endTime",
                                      "start_token": 1547,
                                      "end_token": 1547,
                                      "children": []
                                    },
                                    {
                                      "type": "CallExpression",
                                      "label": "performance.now()",
                                      "start_token": 1549,
                                      "end_token": 1553,
                                      "children": [
                                        {
                                          "type": "PropertyAccessExpression",
                                          "label": "performance.now",
                                          "start_token": 1549,
                                          "end_token": 1551,
                                          "children": [
                                            {
                                              "type": "Identifier",
                                              "label": "performance",
                                              "start_token": 1549,
                                              "end_token": 1549,
                                              "children": []
                                            },
                                            {
                                              "type": "Identifier",
                                              "label": "now",
                                              "start_token": 1551,
                                              "end_token": 1551,
                                              "children": []
                                            }
                                          ]
                                        }
                                      ]
                                    }
                                  ]
                                }
                              ]
                            }
                          ]
                        },
                        {
                          "type": "IfStatement",
                          "label": "if (BUILD_CONFIG.debug) {\n        performance.measure(\n          `[IndexedDB Indexer] Search (${this.databaseName})`,\n          {\n            detail: { query, options },\n            start: startTime,\n            end: endTime,\n          }\n        );\n      }",
                          "start_token": 1555,
                          "end_token": 1588,
                          "children": [
                            {
                              "type": "PropertyAccessExpression",
                              "label": "BUILD_CONFIG.debug",
                              "start_token": 1557,
                              "end_token": 1559,
                              "children": [
                                {
                                  "type": "Identifier",
                                  "label": "BUILD_CONFIG",
                                  "start_token": 1557,
                                  "end_token": 1557,
                                  "children": []
                                },
                                {
                                  "type": "Identifier",
                                  "label": "debug",
                                  "start_token": 1559,
                                  "end_token": 1559,
                                  "children": []
                                }
                              ]
                            },
                            {
                              "type": "Block",
                              "label": "{\n        performance.measure(\n          `[IndexedDB Indexer] Search (${this.databaseName})`,\n          {\n            detail: { query, options },\n            start: startTime,\n            end: endTime,\n          }\n        );\n      }",
                              "start_token": 1561,
                              "end_token": 1588,
                              "children": [
                                {
                                  "type": "ExpressionStatement",
                                  "label": "performance.measure(\n          `[IndexedDB Indexer] Search (${this.databaseName})`,\n          {\n            detail: { query, options },\n            start: startTime,\n            end: endTime,\n          }\n        );",
                                  "start_token": 1562,
                                  "end_token": 1587,
                                  "children": [
                                    {
                                      "type": "CallExpression",
                                      "label": "performance.measure(\n          `[IndexedDB Indexer] Search (${this.databaseName})`,\n          {\n            detail: { query, options },\n            start: startTime,\n            end: endTime,\n          }\n        )",
                                      "start_token": 1562,
                                      "end_token": 1586,
                                      "children": [
                                        {
                                          "type": "PropertyAccessExpression",
                                          "label": "performance.measure",
                                          "start_token": 1562,
                                          "end_token": 1564,
                                          "children": [
                                            {
                                              "type": "Identifier",
                                              "label": "performance",
                                              "start_token": 1562,
                                              "end_token": 1562,
                                              "children": []
                                            },
                                            {
                                              "type": "Identifier",
                                              "label": "measure",
                                              "start_token": 1564,
                                              "end_token": 1564,
                                              "children": []
                                            }
                                          ]
                                        },
                                        {
                                          "type": "TemplateExpression",
                                          "label": "`[IndexedDB Indexer] Search (${this.databaseName})`",
                                          "start_token": 1566,
                                          "end_token": 1566,
                                          "children": [
                                            {
                                              "type": "TemplateHead",
                                              "label": "`[IndexedDB Indexer] Search (${",
                                              "start_token": 1566,
                                              "end_token": 1566,
                                              "children": []
                                            },
                                            {
                                              "type": "TemplateSpan",
                                              "label": "this.databaseName})`",
                                              "start_token": 1566,
                                              "end_token": 1566,
                                              "children": [
                                                {
                                                  "type": "PropertyAccessExpression",
                                                  "label": "this.databaseName",
                                                  "start_token": 1566,
                                                  "end_token": 1566,
                                                  "children": [
                                                    {
                                                      "type": "ThisKeyword",
                                                      "label": "this",
                                                      "start_token": 1566,
                                                      "end_token": 1566,
                                                      "children": []
                                                    },
                                                    {
                                                      "type": "Identifier",
                                                      "label": "databaseName",
                                                      "start_token": 1566,
                                                      "end_token": 1566,
                                                      "children": []
                                                    }
                                                  ]
                                                },
                                                {
                                                  "type": "LastTemplateToken",
                                                  "label": "})`",
                                                  "start_token": 1566,
                                                  "end_token": 1566,
                                                  "children": []
                                                }
                                              ]
                                            }
                                          ]
                                        },
                                        {
                                          "type": "ObjectLiteralExpression",
                                          "label": "{\n            detail: { query, options },\n            start: startTime,\n            end: endTime,\n          }",
                                          "start_token": 1568,
                                          "end_token": 1585,
                                          "children": [
                                            {
                                              "type": "PropertyAssignment",
                                              "label": "detail: { query, options }",
                                              "start_token": 1569,
                                              "end_token": 1575,
                                              "children": [
                                                {
                                                  "type": "Identifier",
                                                  "label": "detail",
                                                  "start_token": 1569,
                                                  "end_token": 1569,
                                                  "children": []
                                                },
                                                {
                                                  "type": "ObjectLiteralExpression",
                                                  "label": "{ query, options }",
                                                  "start_token": 1571,
                                                  "end_token": 1575,
                                                  "children": [
                                                    {
                                                      "type": "ShorthandPropertyAssignment",
                                                      "label": "query",
                                                      "start_token": 1572,
                                                      "end_token": 1572,
                                                      "children": [
                                                        {
                                                          "type": "Identifier",
                                                          "label": "query",
                                                          "start_token": 1572,
                                                          "end_token": 1572,
                                                          "children": []
                                                        }
                                                      ]
                                                    },
                                                    {
                                                      "type": "ShorthandPropertyAssignment",
                                                      "label": "options",
                                                      "start_token": 1574,
                                                      "end_token": 1574,
                                                      "children": [
                                                        {
                                                          "type": "Identifier",
                                                          "label": "options",
                                                          "start_token": 1574,
                                                          "end_token": 1574,
                                                          "children": []
                                                        }
                                                      ]
                                                    }
                                                  ]
                                                }
                                              ]
                                            },
                                            {
                                              "type": "PropertyAssignment",
                                              "label": "start: startTime",
                                              "start_token": 1577,
                                              "end_token": 1579,
                                              "children": [
                                                {
                                                  "type": "Identifier",
                                                  "label": "start",
                                                  "start_token": 1577,
                                                  "end_token": 1577,
                                                  "children": []
                                                },
                                                {
                                                  "type": "Identifier",
                                                  "label": "startTime",
                                                  "start_token": 1579,
                                                  "end_token": 1579,
                                                  "children": []
                                                }
                                              ]
                                            },
                                            {
                                              "type": "PropertyAssignment",
                                              "label": "end: endTime",
                                              "start_token": 1581,
                                              "end_token": 1583,
                                              "children": [
                                                {
                                                  "type": "Identifier",
                                                  "label": "end",
                                                  "start_token": 1581,
                                                  "end_token": 1581,
                                                  "children": []
                                                },
                                                {
                                                  "type": "Identifier",
                                                  "label": "endTime",
                                                  "start_token": 1583,
                                                  "end_token": 1583,
                                                  "children": []
                                                }
                                              ]
                                            }
                                          ]
                                        }
                                      ]
                                    }
                                  ]
                                }
                              ]
                            }
                          ]
                        },
                        {
                          "type": "ExpressionStatement",
                          "label": "logger.debug(\n        `[indexer ${this.databaseName}] search`,\n        endTime - startTime,\n        'ms',\n        query\n      );",
                          "start_token": 1589,
                          "end_token": 1603,
                          "children": [
                            {
                              "type": "CallExpression",
                              "label": "logger.debug(\n        `[indexer ${this.databaseName}] search`,\n        endTime - startTime,\n        'ms',\n        query\n      )",
                              "start_token": 1589,
                              "end_token": 1602,
                              "children": [
                                {
                                  "type": "PropertyAccessExpression",
                                  "label": "logger.debug",
                                  "start_token": 1589,
                                  "end_token": 1591,
                                  "children": [
                                    {
                                      "type": "Identifier",
                                      "label": "logger",
                                      "start_token": 1589,
                                      "end_token": 1589,
                                      "children": []
                                    },
                                    {
                                      "type": "Identifier",
                                      "label": "debug",
                                      "start_token": 1591,
                                      "end_token": 1591,
                                      "children": []
                                    }
                                  ]
                                },
                                {
                                  "type": "TemplateExpression",
                                  "label": "`[indexer ${this.databaseName}] search`",
                                  "start_token": 1593,
                                  "end_token": 1593,
                                  "children": [
                                    {
                                      "type": "TemplateHead",
                                      "label": "`[indexer ${",
                                      "start_token": 1593,
                                      "end_token": 1593,
                                      "children": []
                                    },
                                    {
                                      "type": "TemplateSpan",
                                      "label": "this.databaseName}] search`",
                                      "start_token": 1593,
                                      "end_token": 1593,
                                      "children": [
                                        {
                                          "type": "PropertyAccessExpression",
                                          "label": "this.databaseName",
                                          "start_token": 1593,
                                          "end_token": 1593,
                                          "children": [
                                            {
                                              "type": "ThisKeyword",
                                              "label": "this",
                                              "start_token": 1593,
                                              "end_token": 1593,
                                              "children": []
                                            },
                                            {
                                              "type": "Identifier",
                                              "label": "databaseName",
                                              "start_token": 1593,
                                              "end_token": 1593,
                                              "children": []
                                            }
                                          ]
                                        },
                                        {
                                          "type": "LastTemplateToken",
                                          "label": "}] search`",
                                          "start_token": 1593,
                                          "end_token": 1593,
                                          "children": []
                                        }
                                      ]
                                    }
                                  ]
                                },
                                {
                                  "type": "BinaryExpression",
                                  "label": "endTime - startTime",
                                  "start_token": 1595,
                                  "end_token": 1597,
                                  "children": [
                                    {
                                      "type": "Identifier",
                                      "label": "endTime",
                                      "start_token": 1595,
                                      "end_token": 1595,
                                      "children": []
                                    },
                                    {
                                      "type": "MinusToken",
                                      "label": "-",
                                      "start_token": 1596,
                                      "end_token": 1596,
                                      "children": []
                                    },
                                    {
                                      "type": "Identifier",
                                      "label": "startTime",
                                      "start_token": 1597,
                                      "end_token": 1597,
                                      "children": []
                                    }
                                  ]
                                },
                                {
                                  "type": "StringLiteral",
                                  "label": "'ms'",
                                  "start_token": 1599,
                                  "end_token": 1599,
                                  "children": []
                                },
                                {
                                  "type": "Identifier",
                                  "label": "query",
                                  "start_token": 1601,
                                  "end_token": 1601,
                                  "children": []
                                }
                              ]
                            }
                          ]
                        }
                      ]
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "type": "MethodDeclaration",
          "label": "async aggregate(\n    trx: DataStructROTransaction,\n    query: Query<any>,\n    field: string,\n    options: AggregateOptions<any>\n  ): Promise<AggregateResult<any, any>> {\n    const startTime = performance.now();\n    try {\n      const pagination = {\n        skip: options.pagination?.skip ?? 0,\n        limit: options.pagination?.limit ?? 100,\n      };\n      const hitPagination = options.hits\n        ? {\n            skip: options.hits.pagination?.skip ?? 0,\n            limit: options.hits.pagination?.limit ?? 3,\n          }\n        : {\n            skip: 0,\n            limit: 0,\n          };\n      const match = await this.queryRaw(trx, query);\n      const nids = match.toArray();\n      const buckets: {\n        key: string;\n        nids: number[];\n        hits: SearchResult<any, any>['nodes'];\n      }[] = [];\n      for (const nid of nids) {\n        const record = await trx.objectStore('records').get(nid);\n        if (!record) {\n          continue;\n        }\n        const values = record.data.get(field);\n        for (const value of values ?? []) {\n          let bucket;\n          let bucketIndex = buckets.findIndex(b => b.key === value);\n          if (bucketIndex === -1) {\n            bucket = { key: value, nids: [], hits: [] };\n            buckets.push(bucket);\n            bucketIndex = buckets.length - 1;\n          } else {\n            bucket = buckets[bucketIndex];\n          }\n          if (\n            bucketIndex >= pagination.skip &&\n            bucketIndex < pagination.skip + pagination.limit\n          ) {\n            bucket.nids.push(nid);\n            if (\n              bucket.nids.length - 1 >= hitPagination.skip &&\n              bucket.nids.length - 1 < hitPagination.skip + hitPagination.limit\n            ) {\n              bucket.hits.push(\n                this.resultNode(record, options.hits ?? {}, match, nid)\n              );\n            }\n          }\n        }\n      }\n      return {\n        buckets: buckets\n          .slice(pagination.skip, pagination.skip + pagination.limit)\n          .map(bucket => {\n            const result = {\n              key: bucket.key,\n              score: match.getScore(bucket.nids[0]),\n              count: bucket.nids.length,\n            } as AggregateResult<any, any>['buckets'][number];\n            if (options.hits) {\n              (result as any).hits = {\n                pagination: {\n                  count: bucket.nids.length,\n                  hasMore:\n                    bucket.nids.length >\n                    hitPagination.limit + hitPagination.skip,\n                  limit: hitPagination.limit,\n                  skip: hitPagination.skip,\n                },\n                nodes: bucket.hits,\n              } as SearchResult<any, any>;\n            }\n            return result;\n          }),\n        pagination: {\n          count: buckets.length,\n          hasMore: buckets.length > pagination.limit + pagination.skip,\n          limit: pagination.limit,\n          skip: pagination.skip,\n        },\n      };\n    } finally {\n      const endTime = performance.now();\n      if (BUILD_CONFIG.debug) {\n        performance.measure(\n          `[IndexedDB Indexer] Aggregate (${this.databaseName})`,\n          {\n            detail: { query, field, options },\n            start: startTime,\n            end: endTime,\n          }\n        );\n      }\n      logger.debug(\n        `[indexer ${this.databaseName}] aggregate`,\n        endTime - startTime,\n        'ms'\n      );\n    }\n  }",
          "start_token": 1606,
          "end_token": 2259,
          "children": [
            {
              "type": "AsyncKeyword",
              "label": "async",
              "start_token": 1606,
              "end_token": 1606,
              "children": []
            },
            {
              "type": "Identifier",
              "label": "aggregate",
              "start_token": 1607,
              "end_token": 1607,
              "children": []
            },
            {
              "type": "Parameter",
              "label": "trx: DataStructROTransaction",
              "start_token": 1609,
              "end_token": 1611,
              "children": [
                {
                  "type": "Identifier",
                  "label": "trx",
                  "start_token": 1609,
                  "end_token": 1609,
                  "children": []
                },
                {
                  "type": "TypeReference",
                  "label": "DataStructROTransaction",
                  "start_token": 1611,
                  "end_token": 1611,
                  "children": [
                    {
                      "type": "Identifier",
                      "label": "DataStructROTransaction",
                      "start_token": 1611,
                      "end_token": 1611,
                      "children": []
                    }
                  ]
                }
              ]
            },
            {
              "type": "Parameter",
              "label": "query: Query<any>",
              "start_token": 1613,
              "end_token": 1618,
              "children": [
                {
                  "type": "Identifier",
                  "label": "query",
                  "start_token": 1613,
                  "end_token": 1613,
                  "children": []
                },
                {
                  "type": "TypeReference",
                  "label": "Query<any>",
                  "start_token": 1615,
                  "end_token": 1618,
                  "children": [
                    {
                      "type": "Identifier",
                      "label": "Query",
                      "start_token": 1615,
                      "end_token": 1615,
                      "children": []
                    },
                    {
                      "type": "AnyKeyword",
                      "label": "any",
                      "start_token": 1617,
                      "end_token": 1617,
                      "children": []
                    }
                  ]
                }
              ]
            },
            {
              "type": "Parameter",
              "label": "field: string",
              "start_token": 1620,
              "end_token": 1622,
              "children": [
                {
                  "type": "Identifier",
                  "label": "field",
                  "start_token": 1620,
                  "end_token": 1620,
                  "children": []
                },
                {
                  "type": "StringKeyword",
                  "label": "string",
                  "start_token": 1622,
                  "end_token": 1622,
                  "children": []
                }
              ]
            },
            {
              "type": "Parameter",
              "label": "options: AggregateOptions<any>",
              "start_token": 1624,
              "end_token": 1629,
              "children": [
                {
                  "type": "Identifier",
                  "label": "options",
                  "start_token": 1624,
                  "end_token": 1624,
                  "children": []
                },
                {
                  "type": "TypeReference",
                  "label": "AggregateOptions<any>",
                  "start_token": 1626,
                  "end_token": 1629,
                  "children": [
                    {
                      "type": "Identifier",
                      "label": "AggregateOptions",
                      "start_token": 1626,
                      "end_token": 1626,
                      "children": []
                    },
                    {
                      "type": "AnyKeyword",
                      "label": "any",
                      "start_token": 1628,
                      "end_token": 1628,
                      "children": []
                    }
                  ]
                }
              ]
            },
            {
              "type": "TypeReference",
              "label": "Promise<AggregateResult<any, any>>",
              "start_token": 1632,
              "end_token": 1640,
              "children": [
                {
                  "type": "Identifier",
                  "label": "Promise",
                  "start_token": 1632,
                  "end_token": 1632,
                  "children": []
                },
                {
                  "type": "TypeReference",
                  "label": "AggregateResult<any, any>",
                  "start_token": 1634,
                  "end_token": 1639,
                  "children": [
                    {
                      "type": "Identifier",
                      "label": "AggregateResult",
                      "start_token": 1634,
                      "end_token": 1634,
                      "children": []
                    },
                    {
                      "type": "AnyKeyword",
                      "label": "any",
                      "start_token": 1636,
                      "end_token": 1636,
                      "children": []
                    },
                    {
                      "type": "AnyKeyword",
                      "label": "any",
                      "start_token": 1638,
                      "end_token": 1638,
                      "children": []
                    }
                  ]
                }
              ]
            },
            {
              "type": "Block",
              "label": "{\n    const startTime = performance.now();\n    try {\n      const pagination = {\n        skip: options.pagination?.skip ?? 0,\n        limit: options.pagination?.limit ?? 100,\n      };\n      const hitPagination = options.hits\n        ? {\n            skip: options.hits.pagination?.skip ?? 0,\n            limit: options.hits.pagination?.limit ?? 3,\n          }\n        : {\n            skip: 0,\n            limit: 0,\n          };\n      const match = await this.queryRaw(trx, query);\n      const nids = match.toArray();\n      const buckets: {\n        key: string;\n        nids: number[];\n        hits: SearchResult<any, any>['nodes'];\n      }[] = [];\n      for (const nid of nids) {\n        const record = await trx.objectStore('records').get(nid);\n        if (!record) {\n          continue;\n        }\n        const values = record.data.get(field);\n        for (const value of values ?? []) {\n          let bucket;\n          let bucketIndex = buckets.findIndex(b => b.key === value);\n          if (bucketIndex === -1) {\n            bucket = { key: value, nids: [], hits: [] };\n            buckets.push(bucket);\n            bucketIndex = buckets.length - 1;\n          } else {\n            bucket = buckets[bucketIndex];\n          }\n          if (\n            bucketIndex >= pagination.skip &&\n            bucketIndex < pagination.skip + pagination.limit\n          ) {\n            bucket.nids.push(nid);\n            if (\n              bucket.nids.length - 1 >= hitPagination.skip &&\n              bucket.nids.length - 1 < hitPagination.skip + hitPagination.limit\n            ) {\n              bucket.hits.push(\n                this.resultNode(record, options.hits ?? {}, match, nid)\n              );\n            }\n          }\n        }\n      }\n      return {\n        buckets: buckets\n          .slice(pagination.skip, pagination.skip + pagination.limit)\n          .map(bucket => {\n            const result = {\n              key: bucket.key,\n              score: match.getScore(bucket.nids[0]),\n              count: bucket.nids.length,\n            } as AggregateResult<any, any>['buckets'][number];\n            if (options.hits) {\n              (result as any).hits = {\n                pagination: {\n                  count: bucket.nids.length,\n                  hasMore:\n                    bucket.nids.length >\n                    hitPagination.limit + hitPagination.skip,\n                  limit: hitPagination.limit,\n                  skip: hitPagination.skip,\n                },\n                nodes: bucket.hits,\n              } as SearchResult<any, any>;\n            }\n            return result;\n          }),\n        pagination: {\n          count: buckets.length,\n          hasMore: buckets.length > pagination.limit + pagination.skip,\n          limit: pagination.limit,\n          skip: pagination.skip,\n        },\n      };\n    } finally {\n      const endTime = performance.now();\n      if (BUILD_CONFIG.debug) {\n        performance.measure(\n          `[IndexedDB Indexer] Aggregate (${this.databaseName})`,\n          {\n            detail: { query, field, options },\n            start: startTime,\n            end: endTime,\n          }\n        );\n      }\n      logger.debug(\n        `[indexer ${this.databaseName}] aggregate`,\n        endTime - startTime,\n        'ms'\n      );\n    }\n  }",
              "start_token": 1641,
              "end_token": 2259,
              "children": [
                {
                  "type": "FirstStatement",
                  "label": "const startTime = performance.now();",
                  "start_token": 1642,
                  "end_token": 1650,
                  "children": [
                    {
                      "type": "VariableDeclarationList",
                      "label": "const startTime = performance.now()",
                      "start_token": 1642,
                      "end_token": 1649,
                      "children": [
                        {
                          "type": "VariableDeclaration",
                          "label": "startTime = performance.now()",
                          "start_token": 1643,
                          "end_token": 1649,
                          "children": [
                            {
                              "type": "Identifier",
                              "label": "startTime",
                              "start_token": 1643,
                              "end_token": 1643,
                              "children": []
                            },
                            {
                              "type": "CallExpression",
                              "label": "performance.now()",
                              "start_token": 1645,
                              "end_token": 1649,
                              "children": [
                                {
                                  "type": "PropertyAccessExpression",
                                  "label": "performance.now",
                                  "start_token": 1645,
                                  "end_token": 1647,
                                  "children": [
                                    {
                                      "type": "Identifier",
                                      "label": "performance",
                                      "start_token": 1645,
                                      "end_token": 1645,
                                      "children": []
                                    },
                                    {
                                      "type": "Identifier",
                                      "label": "now",
                                      "start_token": 1647,
                                      "end_token": 1647,
                                      "children": []
                                    }
                                  ]
                                }
                              ]
                            }
                          ]
                        }
                      ]
                    }
                  ]
                },
                {
                  "type": "TryStatement",
                  "label": "try {\n      const pagination = {\n        skip: options.pagination?.skip ?? 0,\n        limit: options.pagination?.limit ?? 100,\n      };\n      const hitPagination = options.hits\n        ? {\n            skip: options.hits.pagination?.skip ?? 0,\n            limit: options.hits.pagination?.limit ?? 3,\n          }\n        : {\n            skip: 0,\n            limit: 0,\n          };\n      const match = await this.queryRaw(trx, query);\n      const nids = match.toArray();\n      const buckets: {\n        key: string;\n        nids: number[];\n        hits: SearchResult<any, any>['nodes'];\n      }[] = [];\n      for (const nid of nids) {\n        const record = await trx.objectStore('records').get(nid);\n        if (!record) {\n          continue;\n        }\n        const values = record.data.get(field);\n        for (const value of values ?? []) {\n          let bucket;\n          let bucketIndex = buckets.findIndex(b => b.key === value);\n          if (bucketIndex === -1) {\n            bucket = { key: value, nids: [], hits: [] };\n            buckets.push(bucket);\n            bucketIndex = buckets.length - 1;\n          } else {\n            bucket = buckets[bucketIndex];\n          }\n          if (\n            bucketIndex >= pagination.skip &&\n            bucketIndex < pagination.skip + pagination.limit\n          ) {\n            bucket.nids.push(nid);\n            if (\n              bucket.nids.length - 1 >= hitPagination.skip &&\n              bucket.nids.length - 1 < hitPagination.skip + hitPagination.limit\n            ) {\n              bucket.hits.push(\n                this.resultNode(record, options.hits ?? {}, match, nid)\n              );\n            }\n          }\n        }\n      }\n      return {\n        buckets: buckets\n          .slice(pagination.skip, pagination.skip + pagination.limit)\n          .map(bucket => {\n            const result = {\n              key: bucket.key,\n              score: match.getScore(bucket.nids[0]),\n              count: bucket.nids.length,\n            } as AggregateResult<any, any>['buckets'][number];\n            if (options.hits) {\n              (result as any).hits = {\n                pagination: {\n                  count: bucket.nids.length,\n                  hasMore:\n                    bucket.nids.length >\n                    hitPagination.limit + hitPagination.skip,\n                  limit: hitPagination.limit,\n                  skip: hitPagination.skip,\n                },\n                nodes: bucket.hits,\n              } as SearchResult<any, any>;\n            }\n            return result;\n          }),\n        pagination: {\n          count: buckets.length,\n          hasMore: buckets.length > pagination.limit + pagination.skip,\n          limit: pagination.limit,\n          skip: pagination.skip,\n        },\n      };\n    } finally {\n      const endTime = performance.now();\n      if (BUILD_CONFIG.debug) {\n        performance.measure(\n          `[IndexedDB Indexer] Aggregate (${this.databaseName})`,\n          {\n            detail: { query, field, options },\n            start: startTime,\n            end: endTime,\n          }\n        );\n      }\n      logger.debug(\n        `[indexer ${this.databaseName}] aggregate`,\n        endTime - startTime,\n        'ms'\n      );\n    }",
                  "start_token": 1651,
                  "end_token": 2258,
                  "children": [
                    {
                      "type": "Block",
                      "label": "{\n      const pagination = {\n        skip: options.pagination?.skip ?? 0,\n        limit: options.pagination?.limit ?? 100,\n      };\n      const hitPagination = options.hits\n        ? {\n            skip: options.hits.pagination?.skip ?? 0,\n            limit: options.hits.pagination?.limit ?? 3,\n          }\n        : {\n            skip: 0,\n            limit: 0,\n          };\n      const match = await this.queryRaw(trx, query);\n      const nids = match.toArray();\n      const buckets: {\n        key: string;\n        nids: number[];\n        hits: SearchResult<any, any>['nodes'];\n      }[] = [];\n      for (const nid of nids) {\n        const record = await trx.objectStore('records').get(nid);\n        if (!record) {\n          continue;\n        }\n        const values = record.data.get(field);\n        for (const value of values ?? []) {\n          let bucket;\n          let bucketIndex = buckets.findIndex(b => b.key === value);\n          if (bucketIndex === -1) {\n            bucket = { key: value, nids: [], hits: [] };\n            buckets.push(bucket);\n            bucketIndex = buckets.length - 1;\n          } else {\n            bucket = buckets[bucketIndex];\n          }\n          if (\n            bucketIndex >= pagination.skip &&\n            bucketIndex < pagination.skip + pagination.limit\n          ) {\n            bucket.nids.push(nid);\n            if (\n              bucket.nids.length - 1 >= hitPagination.skip &&\n              bucket.nids.length - 1 < hitPagination.skip + hitPagination.limit\n            ) {\n              bucket.hits.push(\n                this.resultNode(record, options.hits ?? {}, match, nid)\n              );\n            }\n          }\n        }\n      }\n      return {\n        buckets: buckets\n          .slice(pagination.skip, pagination.skip + pagination.limit)\n          .map(bucket => {\n            const result = {\n              key: bucket.key,\n              score: match.getScore(bucket.nids[0]),\n              count: bucket.nids.length,\n            } as AggregateResult<any, any>['buckets'][number];\n            if (options.hits) {\n              (result as any).hits = {\n                pagination: {\n                  count: bucket.nids.length,\n                  hasMore:\n                    bucket.nids.length >\n                    hitPagination.limit + hitPagination.skip,\n                  limit: hitPagination.limit,\n                  skip: hitPagination.skip,\n                },\n                nodes: bucket.hits,\n              } as SearchResult<any, any>;\n            }\n            return result;\n          }),\n        pagination: {\n          count: buckets.length,\n          hasMore: buckets.length > pagination.limit + pagination.skip,\n          limit: pagination.limit,\n          skip: pagination.skip,\n        },\n      };\n    }",
                      "start_token": 1652,
                      "end_token": 2197,
                      "children": [
                        {
                          "type": "FirstStatement",
                          "label": "const pagination = {\n        skip: options.pagination?.skip ?? 0,\n        limit: options.pagination?.limit ?? 100,\n      };",
                          "start_token": 1653,
                          "end_token": 1682,
                          "children": [
                            {
                              "type": "VariableDeclarationList",
                              "label": "const pagination = {\n        skip: options.pagination?.skip ?? 0,\n        limit: options.pagination?.limit ?? 100,\n      }",
                              "start_token": 1653,
                              "end_token": 1681,
                              "children": [
                                {
                                  "type": "VariableDeclaration",
                                  "label": "pagination = {\n        skip: options.pagination?.skip ?? 0,\n        limit: options.pagination?.limit ?? 100,\n      }",
                                  "start_token": 1654,
                                  "end_token": 1681,
                                  "children": [
                                    {
                                      "type": "Identifier",
                                      "label": "pagination",
                                      "start_token": 1654,
                                      "end_token": 1654,
                                      "children": []
                                    },
                                    {
                                      "type": "ObjectLiteralExpression",
                                      "label": "{\n        skip: options.pagination?.skip ?? 0,\n        limit: options.pagination?.limit ?? 100,\n      }",
                                      "start_token": 1656,
                                      "end_token": 1681,
                                      "children": [
                                        {
                                          "type": "PropertyAssignment",
                                          "label": "skip: options.pagination?.skip ?? 0",
                                          "start_token": 1657,
                                          "end_token": 1667,
                                          "children": [
                                            {
                                              "type": "Identifier",
                                              "label": "skip",
                                              "start_token": 1657,
                                              "end_token": 1657,
                                              "children": []
                                            },
                                            {
                                              "type": "BinaryExpression",
                                              "label": "options.pagination?.skip ?? 0",
                                              "start_token": 1659,
                                              "end_token": 1667,
                                              "children": [
                                                {
                                                  "type": "PropertyAccessExpression",
                                                  "label": "options.pagination?.skip",
                                                  "start_token": 1659,
                                                  "end_token": 1664,
                                                  "children": [
                                                    {
                                                      "type": "PropertyAccessExpression",
                                                      "label": "options.pagination",
                                                      "start_token": 1659,
                                                      "end_token": 1661,
                                                      "children": [
                                                        {
                                                          "type": "Identifier",
                                                          "label": "options",
                                                          "start_token": 1659,
                                                          "end_token": 1659,
                                                          "children": []
                                                        },
                                                        {
                                                          "type": "Identifier",
                                                          "label": "pagination",
                                                          "start_token": 1661,
                                                          "end_token": 1661,
                                                          "children": []
                                                        }
                                                      ]
                                                    },
                                                    {
                                                      "type": "QuestionDotToken",
                                                      "label": "?.",
                                                      "start_token": 1662,
                                                      "end_token": 1663,
                                                      "children": []
                                                    },
                                                    {
                                                      "type": "Identifier",
                                                      "label": "skip",
                                                      "start_token": 1664,
                                                      "end_token": 1664,
                                                      "children": []
                                                    }
                                                  ]
                                                },
                                                {
                                                  "type": "QuestionQuestionToken",
                                                  "label": "??",
                                                  "start_token": 1665,
                                                  "end_token": 1666,
                                                  "children": []
                                                },
                                                {
                                                  "type": "FirstLiteralToken",
                                                  "label": "0",
                                                  "start_token": 1667,
                                                  "end_token": 1667,
                                                  "children": []
                                                }
                                              ]
                                            }
                                          ]
                                        },
                                        {
                                          "type": "PropertyAssignment",
                                          "label": "limit: options.pagination?.limit ?? 100",
                                          "start_token": 1669,
                                          "end_token": 1679,
                                          "children": [
                                            {
                                              "type": "Identifier",
                                              "label": "limit",
                                              "start_token": 1669,
                                              "end_token": 1669,
                                              "children": []
                                            },
                                            {
                                              "type": "BinaryExpression",
                                              "label": "options.pagination?.limit ?? 100",
                                              "start_token": 1671,
                                              "end_token": 1679,
                                              "children": [
                                                {
                                                  "type": "PropertyAccessExpression",
                                                  "label": "options.pagination?.limit",
                                                  "start_token": 1671,
                                                  "end_token": 1676,
                                                  "children": [
                                                    {
                                                      "type": "PropertyAccessExpression",
                                                      "label": "options.pagination",
                                                      "start_token": 1671,
                                                      "end_token": 1673,
                                                      "children": [
                                                        {
                                                          "type": "Identifier",
                                                          "label": "options",
                                                          "start_token": 1671,
                                                          "end_token": 1671,
                                                          "children": []
                                                        },
                                                        {
                                                          "type": "Identifier",
                                                          "label": "pagination",
                                                          "start_token": 1673,
                                                          "end_token": 1673,
                                                          "children": []
                                                        }
                                                      ]
                                                    },
                                                    {
                                                      "type": "QuestionDotToken",
                                                      "label": "?.",
                                                      "start_token": 1674,
                                                      "end_token": 1675,
                                                      "children": []
                                                    },
                                                    {
                                                      "type": "Identifier",
                                                      "label": "limit",
                                                      "start_token": 1676,
                                                      "end_token": 1676,
                                                      "children": []
                                                    }
                                                  ]
                                                },
                                                {
                                                  "type": "QuestionQuestionToken",
                                                  "label": "??",
                                                  "start_token": 1677,
                                                  "end_token": 1678,
                                                  "children": []
                                                },
                                                {
                                                  "type": "FirstLiteralToken",
                                                  "label": "100",
                                                  "start_token": 1679,
                                                  "end_token": 1679,
                                                  "children": []
                                                }
                                              ]
                                            }
                                          ]
                                        }
                                      ]
                                    }
                                  ]
                                }
                              ]
                            }
                          ]
                        },
                        {
                          "type": "FirstStatement",
                          "label": "const hitPagination = options.hits\n        ? {\n            skip: options.hits.pagination?.skip ?? 0,\n            limit: options.hits.pagination?.limit ?? 3,\n          }\n        : {\n            skip: 0,\n            limit: 0,\n          };",
                          "start_token": 1683,
                          "end_token": 1731,
                          "children": [
                            {
                              "type": "VariableDeclarationList",
                              "label": "const hitPagination = options.hits\n        ? {\n            skip: options.hits.pagination?.skip ?? 0,\n            limit: options.hits.pagination?.limit ?? 3,\n          }\n        : {\n            skip: 0,\n            limit: 0,\n          }",
                              "start_token": 1683,
                              "end_token": 1730,
                              "children": [
                                {
                                  "type": "VariableDeclaration",
                                  "label": "hitPagination = options.hits\n        ? {\n            skip: options.hits.pagination?.skip ?? 0,\n            limit: options.hits.pagination?.limit ?? 3,\n          }\n        : {\n            skip: 0,\n            limit: 0,\n          }",
                                  "start_token": 1684,
                                  "end_token": 1730,
                                  "children": [
                                    {
                                      "type": "Identifier",
                                      "label": "hitPagination",
                                      "start_token": 1684,
                                      "end_token": 1684,
                                      "children": []
                                    },
                                    {
                                      "type": "ConditionalExpression",
                                      "label": "options.hits\n        ? {\n            skip: options.hits.pagination?.skip ?? 0,\n            limit: options.hits.pagination?.limit ?? 3,\n          }\n        : {\n            skip: 0,\n            limit: 0,\n          }",
                                      "start_token": 1686,
                                      "end_token": 1730,
                                      "children": [
                                        {
                                          "type": "PropertyAccessExpression",
                                          "label": "options.hits",
                                          "start_token": 1686,
                                          "end_token": 1688,
                                          "children": [
                                            {
                                              "type": "Identifier",
                                              "label": "options",
                                              "start_token": 1686,
                                              "end_token": 1686,
                                              "children": []
                                            },
                                            {
                                              "type": "Identifier",
                                              "label": "hits",
                                              "start_token": 1688,
                                              "end_token": 1688,
                                              "children": []
                                            }
                                          ]
                                        },
                                        {
                                          "type": "QuestionToken",
                                          "label": "?",
                                          "start_token": 1689,
                                          "end_token": 1689,
                                          "children": []
                                        },
                                        {
                                          "type": "ObjectLiteralExpression",
                                          "label": "{\n            skip: options.hits.pagination?.skip ?? 0,\n            limit: options.hits.pagination?.limit ?? 3,\n          }",
                                          "start_token": 1690,
                                          "end_token": 1719,
                                          "children": [
                                            {
                                              "type": "PropertyAssignment",
                                              "label": "skip: options.hits.pagination?.skip ?? 0",
                                              "start_token": 1691,
                                              "end_token": 1703,
                                              "children": [
                                                {
                                                  "type": "Identifier",
                                                  "label": "skip",
                                                  "start_token": 1691,
                                                  "end_token": 1691,
                                                  "children": []
                                                },
                                                {
                                                  "type": "BinaryExpression",
                                                  "label": "options.hits.pagination?.skip ?? 0",
                                                  "start_token": 1693,
                                                  "end_token": 1703,
                                                  "children": [
                                                    {
                                                      "type": "PropertyAccessExpression",
                                                      "label": "options.hits.pagination?.skip",
                                                      "start_token": 1693,
                                                      "end_token": 1700,
                                                      "children": [
                                                        {
                                                          "type": "PropertyAccessExpression",
                                                          "label": "options.hits.pagination",
                                                          "start_token": 1693,
                                                          "end_token": 1697,
                                                          "children": [
                                                            {
                                                              "type": "PropertyAccessExpression",
                                                              "label": "options.hits",
                                                              "start_token": 1693,
                                                              "end_token": 1695,
                                                              "children": [
                                                                {
                                                                  "type": "Identifier",
                                                                  "label": "options",
                                                                  "start_token": 1693,
                                                                  "end_token": 1693,
                                                                  "children": []
                                                                },
                                                                {
                                                                  "type": "Identifier",
                                                                  "label": "hits",
                                                                  "start_token": 1695,
                                                                  "end_token": 1695,
                                                                  "children": []
                                                                }
                                                              ]
                                                            },
                                                            {
                                                              "type": "Identifier",
                                                              "label": "pagination",
                                                              "start_token": 1697,
                                                              "end_token": 1697,
                                                              "children": []
                                                            }
                                                          ]
                                                        },
                                                        {
                                                          "type": "QuestionDotToken",
                                                          "label": "?.",
                                                          "start_token": 1698,
                                                          "end_token": 1699,
                                                          "children": []
                                                        },
                                                        {
                                                          "type": "Identifier",
                                                          "label": "skip",
                                                          "start_token": 1700,
                                                          "end_token": 1700,
                                                          "children": []
                                                        }
                                                      ]
                                                    },
                                                    {
                                                      "type": "QuestionQuestionToken",
                                                      "label": "??",
                                                      "start_token": 1701,
                                                      "end_token": 1702,
                                                      "children": []
                                                    },
                                                    {
                                                      "type": "FirstLiteralToken",
                                                      "label": "0",
                                                      "start_token": 1703,
                                                      "end_token": 1703,
                                                      "children": []
                                                    }
                                                  ]
                                                }
                                              ]
                                            },
                                            {
                                              "type": "PropertyAssignment",
                                              "label": "limit: options.hits.pagination?.limit ?? 3",
                                              "start_token": 1705,
                                              "end_token": 1717,
                                              "children": [
                                                {
                                                  "type": "Identifier",
                                                  "label": "limit",
                                                  "start_token": 1705,
                                                  "end_token": 1705,
                                                  "children": []
                                                },
                                                {
                                                  "type": "BinaryExpression",
                                                  "label": "options.hits.pagination?.limit ?? 3",
                                                  "start_token": 1707,
                                                  "end_token": 1717,
                                                  "children": [
                                                    {
                                                      "type": "PropertyAccessExpression",
                                                      "label": "options.hits.pagination?.limit",
                                                      "start_token": 1707,
                                                      "end_token": 1714,
                                                      "children": [
                                                        {
                                                          "type": "PropertyAccessExpression",
                                                          "label": "options.hits.pagination",
                                                          "start_token": 1707,
                                                          "end_token": 1711,
                                                          "children": [
                                                            {
                                                              "type": "PropertyAccessExpression",
                                                              "label": "options.hits",
                                                              "start_token": 1707,
                                                              "end_token": 1709,
                                                              "children": [
                                                                {
                                                                  "type": "Identifier",
                                                                  "label": "options",
                                                                  "start_token": 1707,
                                                                  "end_token": 1707,
                                                                  "children": []
                                                                },
                                                                {
                                                                  "type": "Identifier",
                                                                  "label": "hits",
                                                                  "start_token": 1709,
                                                                  "end_token": 1709,
                                                                  "children": []
                                                                }
                                                              ]
                                                            },
                                                            {
                                                              "type": "Identifier",
                                                              "label": "pagination",
                                                              "start_token": 1711,
                                                              "end_token": 1711,
                                                              "children": []
                                                            }
                                                          ]
                                                        },
                                                        {
                                                          "type": "QuestionDotToken",
                                                          "label": "?.",
                                                          "start_token": 1712,
                                                          "end_token": 1713,
                                                          "children": []
                                                        },
                                                        {
                                                          "type": "Identifier",
                                                          "label": "limit",
                                                          "start_token": 1714,
                                                          "end_token": 1714,
                                                          "children": []
                                                        }
                                                      ]
                                                    },
                                                    {
                                                      "type": "QuestionQuestionToken",
                                                      "label": "??",
                                                      "start_token": 1715,
                                                      "end_token": 1716,
                                                      "children": []
                                                    },
                                                    {
                                                      "type": "FirstLiteralToken",
                                                      "label": "3",
                                                      "start_token": 1717,
                                                      "end_token": 1717,
                                                      "children": []
                                                    }
                                                  ]
                                                }
                                              ]
                                            }
                                          ]
                                        },
                                        {
                                          "type": "ColonToken",
                                          "label": ":",
                                          "start_token": 1720,
                                          "end_token": 1720,
                                          "children": []
                                        },
                                        {
                                          "type": "ObjectLiteralExpression",
                                          "label": "{\n            skip: 0,\n            limit: 0,\n          }",
                                          "start_token": 1721,
                                          "end_token": 1730,
                                          "children": [
                                            {
                                              "type": "PropertyAssignment",
                                              "label": "skip: 0",
                                              "start_token": 1722,
                                              "end_token": 1724,
                                              "children": [
                                                {
                                                  "type": "Identifier",
                                                  "label": "skip",
                                                  "start_token": 1722,
                                                  "end_token": 1722,
                                                  "children": []
                                                },
                                                {
                                                  "type": "FirstLiteralToken",
                                                  "label": "0",
                                                  "start_token": 1724,
                                                  "end_token": 1724,
                                                  "children": []
                                                }
                                              ]
                                            },
                                            {
                                              "type": "PropertyAssignment",
                                              "label": "limit: 0",
                                              "start_token": 1726,
                                              "end_token": 1728,
                                              "children": [
                                                {
                                                  "type": "Identifier",
                                                  "label": "limit",
                                                  "start_token": 1726,
                                                  "end_token": 1726,
                                                  "children": []
                                                },
                                                {
                                                  "type": "FirstLiteralToken",
                                                  "label": "0",
                                                  "start_token": 1728,
                                                  "end_token": 1728,
                                                  "children": []
                                                }
                                              ]
                                            }
                                          ]
                                        }
                                      ]
                                    }
                                  ]
                                }
                              ]
                            }
                          ]
                        },
                        {
                          "type": "FirstStatement",
                          "label": "const match = await this.queryRaw(trx, query);",
                          "start_token": 1732,
                          "end_token": 1744,
                          "children": [
                            {
                              "type": "VariableDeclarationList",
                              "label": "const match = await this.queryRaw(trx, query)",
                              "start_token": 1732,
                              "end_token": 1743,
                              "children": [
                                {
                                  "type": "VariableDeclaration",
                                  "label": "match = await this.queryRaw(trx, query)",
                                  "start_token": 1733,
                                  "end_token": 1743,
                                  "children": [
                                    {
                                      "type": "Identifier",
                                      "label": "match",
                                      "start_token": 1733,
                                      "end_token": 1733,
                                      "children": []
                                    },
                                    {
                                      "type": "AwaitExpression",
                                      "label": "await this.queryRaw(trx, query)",
                                      "start_token": 1735,
                                      "end_token": 1743,
                                      "children": [
                                        {
                                          "type": "CallExpression",
                                          "label": "this.queryRaw(trx, query)",
                                          "start_token": 1736,
                                          "end_token": 1743,
                                          "children": [
                                            {
                                              "type": "PropertyAccessExpression",
                                              "label": "this.queryRaw",
                                              "start_token": 1736,
                                              "end_token": 1738,
                                              "children": [
                                                {
                                                  "type": "ThisKeyword",
                                                  "label": "this",
                                                  "start_token": 1736,
                                                  "end_token": 1736,
                                                  "children": []
                                                },
                                                {
                                                  "type": "Identifier",
                                                  "label": "queryRaw",
                                                  "start_token": 1738,
                                                  "end_token": 1738,
                                                  "children": []
                                                }
                                              ]
                                            },
                                            {
                                              "type": "Identifier",
                                              "label": "trx",
                                              "start_token": 1740,
                                              "end_token": 1740,
                                              "children": []
                                            },
                                            {
                                              "type": "Identifier",
                                              "label": "query",
                                              "start_token": 1742,
                                              "end_token": 1742,
                                              "children": []
                                            }
                                          ]
                                        }
                                      ]
                                    }
                                  ]
                                }
                              ]
                            }
                          ]
                        },
                        {
                          "type": "FirstStatement",
                          "label": "const nids = match.toArray();",
                          "start_token": 1745,
                          "end_token": 1753,
                          "children": [
                            {
                              "type": "VariableDeclarationList",
                              "label": "const nids = match.toArray()",
                              "start_token": 1745,
                              "end_token": 1752,
                              "children": [
                                {
                                  "type": "VariableDeclaration",
                                  "label": "nids = match.toArray()",
                                  "start_token": 1746,
                                  "end_token": 1752,
                                  "children": [
                                    {
                                      "type": "Identifier",
                                      "label": "nids",
                                      "start_token": 1746,
                                      "end_token": 1746,
                                      "children": []
                                    },
                                    {
                                      "type": "CallExpression",
                                      "label": "match.toArray()",
                                      "start_token": 1748,
                                      "end_token": 1752,
                                      "children": [
                                        {
                                          "type": "PropertyAccessExpression",
                                          "label": "match.toArray",
                                          "start_token": 1748,
                                          "end_token": 1750,
                                          "children": [
                                            {
                                              "type": "Identifier",
                                              "label": "match",
                                              "start_token": 1748,
                                              "end_token": 1748,
                                              "children": []
                                            },
                                            {
                                              "type": "Identifier",
                                              "label": "toArray",
                                              "start_token": 1750,
                                              "end_token": 1750,
                                              "children": []
                                            }
                                          ]
                                        }
                                      ]
                                    }
                                  ]
                                }
                              ]
                            }
                          ]
                        },
                        {
                          "type": "FirstStatement",
                          "label": "const buckets: {\n        key: string;\n        nids: number[];\n        hits: SearchResult<any, any>['nodes'];\n      }[] = [];",
                          "start_token": 1754,
                          "end_token": 1786,
                          "children": [
                            {
                              "type": "VariableDeclarationList",
                              "label": "const buckets: {\n        key: string;\n        nids: number[];\n        hits: SearchResult<any, any>['nodes'];\n      }[] = []",
                              "start_token": 1754,
                              "end_token": 1785,
                              "children": [
                                {
                                  "type": "VariableDeclaration",
                                  "label": "buckets: {\n        key: string;\n        nids: number[];\n        hits: SearchResult<any, any>['nodes'];\n      }[] = []",
                                  "start_token": 1755,
                                  "end_token": 1785,
                                  "children": [
                                    {
                                      "type": "Identifier",
                                      "label": "buckets",
                                      "start_token": 1755,
                                      "end_token": 1755,
                                      "children": []
                                    },
                                    {
                                      "type": "ArrayType",
                                      "label": "{\n        key: string;\n        nids: number[];\n        hits: SearchResult<any, any>['nodes'];\n      }[]",
                                      "start_token": 1757,
                                      "end_token": 1782,
                                      "children": [
                                        {
                                          "type": "TypeLiteral",
                                          "label": "{\n        key: string;\n        nids: number[];\n        hits: SearchResult<any, any>['nodes'];\n      }",
                                          "start_token": 1757,
                                          "end_token": 1780,
                                          "children": [
                                            {
                                              "type": "PropertySignature",
                                              "label": "key: string;",
                                              "start_token": 1758,
                                              "end_token": 1761,
                                              "children": [
                                                {
                                                  "type": "Identifier",
                                                  "label": "key",
                                                  "start_token": 1758,
                                                  "end_token": 1758,
                                                  "children": []
                                                },
                                                {
                                                  "type": "StringKeyword",
                                                  "label": "string",
                                                  "start_token": 1760,
                                                  "end_token": 1760,
                                                  "children": []
                                                }
                                              ]
                                            },
                                            {
                                              "type": "PropertySignature",
                                              "label": "nids: number[];",
                                              "start_token": 1762,
                                              "end_token": 1767,
                                              "children": [
                                                {
                                                  "type": "Identifier",
                                                  "label": "nids",
                                                  "start_token": 1762,
                                                  "end_token": 1762,
                                                  "children": []
                                                },
                                                {
                                                  "type": "ArrayType",
                                                  "label": "number[]",
                                                  "start_token": 1764,
                                                  "end_token": 1766,
                                                  "children": [
                                                    {
                                                      "type": "NumberKeyword",
                                                      "label": "number",
                                                      "start_token": 1764,
                                                      "end_token": 1764,
                                                      "children": []
                                                    }
                                                  ]
                                                }
                                              ]
                                            },
                                            {
                                              "type": "PropertySignature",
                                              "label": "hits: SearchResult<any, any>['nodes'];",
                                              "start_token": 1768,
                                              "end_token": 1779,
                                              "children": [
                                                {
                                                  "type": "Identifier",
                                                  "label": "hits",
                                                  "start_token": 1768,
                                                  "end_token": 1768,
                                                  "children": []
                                                },
                                                {
                                                  "type": "IndexedAccessType",
                                                  "label": "SearchResult<any, any>['nodes']",
                                                  "start_token": 1770,
                                                  "end_token": 1778,
                                                  "children": [
                                                    {
                                                      "type": "TypeReference",
                                                      "label": "SearchResult<any, any>",
                                                      "start_token": 1770,
                                                      "end_token": 1775,
                                                      "children": [
                                                        {
                                                          "type": "Identifier",
                                                          "label": "SearchResult",
                                                          "start_token": 1770,
                                                          "end_token": 1770,
                                                          "children": []
                                                        },
                                                        {
                                                          "type": "AnyKeyword",
                                                          "label": "any",
                                                          "start_token": 1772,
                                                          "end_token": 1772,
                                                          "children": []
                                                        },
                                                        {
                                                          "type": "AnyKeyword",
                                                          "label": "any",
                                                          "start_token": 1774,
                                                          "end_token": 1774,
                                                          "children": []
                                                        }
                                                      ]
                                                    },
                                                    {
                                                      "type": "LiteralType",
                                                      "label": "'nodes'",
                                                      "start_token": 1777,
                                                      "end_token": 1777,
                                                      "children": [
                                                        {
                                                          "type": "StringLiteral",
                                                          "label": "'nodes'",
                                                          "start_token": 1777,
                                                          "end_token": 1777,
                                                          "children": []
                                                        }
                                                      ]
                                                    }
                                                  ]
                                                }
                                              ]
                                            }
                                          ]
                                        }
                                      ]
                                    },
                                    {
                                      "type": "ArrayLiteralExpression",
                                      "label": "[]",
                                      "start_token": 1784,
                                      "end_token": 1785,
                                      "children": []
                                    }
                                  ]
                                }
                              ]
                            }
                          ]
                        },
                        {
                          "type": "ForOfStatement",
                          "label": "for (const nid of nids) {\n        const record = await trx.objectStore('records').get(nid);\n        if (!record) {\n          continue;\n        }\n        const values = record.data.get(field);\n        for (const value of values ?? []) {\n          let bucket;\n          let bucketIndex = buckets.findIndex(b => b.key === value);\n          if (bucketIndex === -1) {\n            bucket = { key: value, nids: [], hits: [] };\n            buckets.push(bucket);\n            bucketIndex = buckets.length - 1;\n          } else {\n            bucket = buckets[bucketIndex];\n          }\n          if (\n            bucketIndex >= pagination.skip &&\n            bucketIndex < pagination.skip + pagination.limit\n          ) {\n            bucket.nids.push(nid);\n            if (\n              bucket.nids.length - 1 >= hitPagination.skip &&\n              bucket.nids.length - 1 < hitPagination.skip + hitPagination.limit\n            ) {\n              bucket.hits.push(\n                this.resultNode(record, options.hits ?? {}, match, nid)\n              );\n            }\n          }\n        }\n      }",
                          "start_token": 1787,
                          "end_token": 2005,
                          "children": [
                            {
                              "type": "VariableDeclarationList",
                              "label": "const nid",
                              "start_token": 1789,
                              "end_token": 1790,
                              "children": [
                                {
                                  "type": "VariableDeclaration",
                                  "label": "nid",
                                  "start_token": 1790,
                                  "end_token": 1790,
                                  "children": [
                                    {
                                      "type": "Identifier",
                                      "label": "nid",
                                      "start_token": 1790,
                                      "end_token": 1790,
                                      "children": []
                                    }
                                  ]
                                }
                              ]
                            },
                            {
                              "type": "Identifier",
                              "label": "nids",
                              "start_token": 1792,
                              "end_token": 1792,
                              "children": []
                            },
                            {
                              "type": "Block",
                              "label": "{\n        const record = await trx.objectStore('records').get(nid);\n        if (!record) {\n          continue;\n        }\n        const values = record.data.get(field);\n        for (const value of values ?? []) {\n          let bucket;\n          let bucketIndex = buckets.findIndex(b => b.key === value);\n          if (bucketIndex === -1) {\n            bucket = { key: value, nids: [], hits: [] };\n            buckets.push(bucket);\n            bucketIndex = buckets.length - 1;\n          } else {\n            bucket = buckets[bucketIndex];\n          }\n          if (\n            bucketIndex >= pagination.skip &&\n            bucketIndex < pagination.skip + pagination.limit\n          ) {\n            bucket.nids.push(nid);\n            if (\n              bucket.nids.length - 1 >= hitPagination.skip &&\n              bucket.nids.length - 1 < hitPagination.skip + hitPagination.limit\n            ) {\n              bucket.hits.push(\n                this.resultNode(record, options.hits ?? {}, match, nid)\n              );\n            }\n          }\n        }\n      }",
                              "start_token": 1794,
                              "end_token": 2005,
                              "children": [
                                {
                                  "type": "FirstStatement",
                                  "label": "const record = await trx.objectStore('records').get(nid);",
                                  "start_token": 1795,
                                  "end_token": 1810,
                                  "children": [
                                    {
                                      "type": "VariableDeclarationList",
                                      "label": "const record = await trx.objectStore('records').get(nid)",
                                      "start_token": 1795,
                                      "end_token": 1809,
                                      "children": [
                                        {
                                          "type": "VariableDeclaration",
                                          "label": "record = await trx.objectStore('records').get(nid)",
                                          "start_token": 1796,
                                          "end_token": 1809,
                                          "children": [
                                            {
                                              "type": "Identifier",
                                              "label": "record",
                                              "start_token": 1796,
                                              "end_token": 1796,
                                              "children": []
                                            },
                                            {
                                              "type": "AwaitExpression",
                                              "label": "await trx.objectStore('records').get(nid)",
                                              "start_token": 1798,
                                              "end_token": 1809,
                                              "children": [
                                                {
                                                  "type": "CallExpression",
                                                  "label": "trx.objectStore('records').get(nid)",
                                                  "start_token": 1799,
                                                  "end_token": 1809,
                                                  "children": [
                                                    {
                                                      "type": "PropertyAccessExpression",
                                                      "label": "trx.objectStore('records').get",
                                                      "start_token": 1799,
                                                      "end_token": 1806,
                                                      "children": [
                                                        {
                                                          "type": "CallExpression",
                                                          "label": "trx.objectStore('records')",
                                                          "start_token": 1799,
                                                          "end_token": 1804,
                                                          "children": [
                                                            {
                                                              "type": "PropertyAccessExpression",
                                                              "label": "trx.objectStore",
                                                              "start_token": 1799,
                                                              "end_token": 1801,
                                                              "children": [
                                                                {
                                                                  "type": "Identifier",
                                                                  "label": "trx",
                                                                  "start_token": 1799,
                                                                  "end_token": 1799,
                                                                  "children": []
                                                                },
                                                                {
                                                                  "type": "Identifier",
                                                                  "label": "objectStore",
                                                                  "start_token": 1801,
                                                                  "end_token": 1801,
                                                                  "children": []
                                                                }
                                                              ]
                                                            },
                                                            {
                                                              "type": "StringLiteral",
                                                              "label": "'records'",
                                                              "start_token": 1803,
                                                              "end_token": 1803,
                                                              "children": []
                                                            }
                                                          ]
                                                        },
                                                        {
                                                          "type": "Identifier",
                                                          "label": "get",
                                                          "start_token": 1806,
                                                          "end_token": 1806,
                                                          "children": []
                                                        }
                                                      ]
                                                    },
                                                    {
                                                      "type": "Identifier",
                                                      "label": "nid",
                                                      "start_token": 1808,
                                                      "end_token": 1808,
                                                      "children": []
                                                    }
                                                  ]
                                                }
                                              ]
                                            }
                                          ]
                                        }
                                      ]
                                    }
                                  ]
                                },
                                {
                                  "type": "IfStatement",
                                  "label": "if (!record) {\n          continue;\n        }",
                                  "start_token": 1811,
                                  "end_token": 1819,
                                  "children": [
                                    {
                                      "type": "PrefixUnaryExpression",
                                      "label": "!record",
                                      "start_token": 1813,
                                      "end_token": 1814,
                                      "children": [
                                        {
                                          "type": "Identifier",
                                          "label": "record",
                                          "start_token": 1814,
                                          "end_token": 1814,
                                          "children": []
                                        }
                                      ]
                                    },
                                    {
                                      "type": "Block",
                                      "label": "{\n          continue;\n        }",
                                      "start_token": 1816,
                                      "end_token": 1819,
                                      "children": [
                                        {
                                          "type": "ContinueStatement",
                                          "label": "continue;",
                                          "start_token": 1817,
                                          "end_token": 1818,
                                          "children": []
                                        }
                                      ]
                                    }
                                  ]
                                },
                                {
                                  "type": "FirstStatement",
                                  "label": "const values = record.data.get(field);",
                                  "start_token": 1820,
                                  "end_token": 1831,
                                  "children": [
                                    {
                                      "type": "VariableDeclarationList",
                                      "label": "const values = record.data.get(field)",
                                      "start_token": 1820,
                                      "end_token": 1830,
                                      "children": [
                                        {
                                          "type": "VariableDeclaration",
                                          "label": "values = record.data.get(field)",
                                          "start_token": 1821,
                                          "end_token": 1830,
                                          "children": [
                                            {
                                              "type": "Identifier",
                                              "label": "values",
                                              "start_token": 1821,
                                              "end_token": 1821,
                                              "children": []
                                            },
                                            {
                                              "type": "CallExpression",
                                              "label": "record.data.get(field)",
                                              "start_token": 1823,
                                              "end_token": 1830,
                                              "children": [
                                                {
                                                  "type": "PropertyAccessExpression",
                                                  "label": "record.data.get",
                                                  "start_token": 1823,
                                                  "end_token": 1827,
                                                  "children": [
                                                    {
                                                      "type": "PropertyAccessExpression",
                                                      "label": "record.data",
                                                      "start_token": 1823,
                                                      "end_token": 1825,
                                                      "children": [
                                                        {
                                                          "type": "Identifier",
                                                          "label": "record",
                                                          "start_token": 1823,
                                                          "end_token": 1823,
                                                          "children": []
                                                        },
                                                        {
                                                          "type": "Identifier",
                                                          "label": "data",
                                                          "start_token": 1825,
                                                          "end_token": 1825,
                                                          "children": []
                                                        }
                                                      ]
                                                    },
                                                    {
                                                      "type": "Identifier",
                                                      "label": "get",
                                                      "start_token": 1827,
                                                      "end_token": 1827,
                                                      "children": []
                                                    }
                                                  ]
                                                },
                                                {
                                                  "type": "Identifier",
                                                  "label": "field",
                                                  "start_token": 1829,
                                                  "end_token": 1829,
                                                  "children": []
                                                }
                                              ]
                                            }
                                          ]
                                        }
                                      ]
                                    }
                                  ]
                                },
                                {
                                  "type": "ForOfStatement",
                                  "label": "for (const value of values ?? []) {\n          let bucket;\n          let bucketIndex = buckets.findIndex(b => b.key === value);\n          if (bucketIndex === -1) {\n            bucket = { key: value, nids: [], hits: [] };\n            buckets.push(bucket);\n            bucketIndex = buckets.length - 1;\n          } else {\n            bucket = buckets[bucketIndex];\n          }\n          if (\n            bucketIndex >= pagination.skip &&\n            bucketIndex < pagination.skip + pagination.limit\n          ) {\n            bucket.nids.push(nid);\n            if (\n              bucket.nids.length - 1 >= hitPagination.skip &&\n              bucket.nids.length - 1 < hitPagination.skip + hitPagination.limit\n            ) {\n              bucket.hits.push(\n                this.resultNode(record, options.hits ?? {}, match, nid)\n              );\n            }\n          }\n        }",
                                  "start_token": 1832,
                                  "end_token": 2004,
                                  "children": [
                                    {
                                      "type": "VariableDeclarationList",
                                      "label": "const value",
                                      "start_token": 1834,
                                      "end_token": 1835,
                                      "children": [
                                        {
                                          "type": "VariableDeclaration",
                                          "label": "value",
                                          "start_token": 1835,
                                          "end_token": 1835,
                                          "children": [
                                            {
                                              "type": "Identifier",
                                              "label": "value",
                                              "start_token": 1835,
                                              "end_token": 1835,
                                              "children": []
                                            }
                                          ]
                                        }
                                      ]
                                    },
                                    {
                                      "type": "BinaryExpression",
                                      "label": "values ?? []",
                                      "start_token": 1837,
                                      "end_token": 1841,
                                      "children": [
                                        {
                                          "type": "Identifier",
                                          "label": "values",
                                          "start_token": 1837,
                                          "end_token": 1837,
                                          "children": []
                                        },
                                        {
                                          "type": "QuestionQuestionToken",
                                          "label": "??",
                                          "start_token": 1838,
                                          "end_token": 1839,
                                          "children": []
                                        },
                                        {
                                          "type": "ArrayLiteralExpression",
                                          "label": "[]",
                                          "start_token": 1840,
                                          "end_token": 1841,
                                          "children": []
                                        }
                                      ]
                                    },
                                    {
                                      "type": "Block",
                                      "label": "{\n          let bucket;\n          let bucketIndex = buckets.findIndex(b => b.key === value);\n          if (bucketIndex === -1) {\n            bucket = { key: value, nids: [], hits: [] };\n            buckets.push(bucket);\n            bucketIndex = buckets.length - 1;\n          } else {\n            bucket = buckets[bucketIndex];\n          }\n          if (\n            bucketIndex >= pagination.skip &&\n            bucketIndex < pagination.skip + pagination.limit\n          ) {\n            bucket.nids.push(nid);\n            if (\n              bucket.nids.length - 1 >= hitPagination.skip &&\n              bucket.nids.length - 1 < hitPagination.skip + hitPagination.limit\n            ) {\n              bucket.hits.push(\n                this.resultNode(record, options.hits ?? {}, match, nid)\n              );\n            }\n          }\n        }",
                                      "start_token": 1843,
                                      "end_token": 2004,
                                      "children": [
                                        {
                                          "type": "FirstStatement",
                                          "label": "let bucket;",
                                          "start_token": 1844,
                                          "end_token": 1846,
                                          "children": [
                                            {
                                              "type": "VariableDeclarationList",
                                              "label": "let bucket",
                                              "start_token": 1844,
                                              "end_token": 1845,
                                              "children": [
                                                {
                                                  "type": "VariableDeclaration",
                                                  "label": "bucket",
                                                  "start_token": 1845,
                                                  "end_token": 1845,
                                                  "children": [
                                                    {
                                                      "type": "Identifier",
                                                      "label": "bucket",
                                                      "start_token": 1845,
                                                      "end_token": 1845,
                                                      "children": []
                                                    }
                                                  ]
                                                }
                                              ]
                                            }
                                          ]
                                        },
                                        {
                                          "type": "FirstStatement",
                                          "label": "let bucketIndex = buckets.findIndex(b => b.key === value);",
                                          "start_token": 1847,
                                          "end_token": 1862,
                                          "children": [
                                            {
                                              "type": "VariableDeclarationList",
                                              "label": "let bucketIndex = buckets.findIndex(b => b.key === value)",
                                              "start_token": 1847,
                                              "end_token": 1861,
                                              "children": [
                                                {
                                                  "type": "VariableDeclaration",
                                                  "label": "bucketIndex = buckets.findIndex(b => b.key === value)",
                                                  "start_token": 1848,
                                                  "end_token": 1861,
                                                  "children": [
                                                    {
                                                      "type": "Identifier",
                                                      "label": "bucketIndex",
                                                      "start_token": 1848,
                                                      "end_token": 1848,
                                                      "children": []
                                                    },
                                                    {
                                                      "type": "CallExpression",
                                                      "label": "buckets.findIndex(b => b.key === value)",
                                                      "start_token": 1850,
                                                      "end_token": 1861,
                                                      "children": [
                                                        {
                                                          "type": "PropertyAccessExpression",
                                                          "label": "buckets.findIndex",
                                                          "start_token": 1850,
                                                          "end_token": 1852,
                                                          "children": [
                                                            {
                                                              "type": "Identifier",
                                                              "label": "buckets",
                                                              "start_token": 1850,
                                                              "end_token": 1850,
                                                              "children": []
                                                            },
                                                            {
                                                              "type": "Identifier",
                                                              "label": "findIndex",
                                                              "start_token": 1852,
                                                              "end_token": 1852,
                                                              "children": []
                                                            }
                                                          ]
                                                        },
                                                        {
                                                          "type": "ArrowFunction",
                                                          "label": "b => b.key === value",
                                                          "start_token": 1854,
                                                          "end_token": 1860,
                                                          "children": [
                                                            {
                                                              "type": "Parameter",
                                                              "label": "b",
                                                              "start_token": 1854,
                                                              "end_token": 1854,
                                                              "children": [
                                                                {
                                                                  "type": "Identifier",
                                                                  "label": "b",
                                                                  "start_token": 1854,
                                                                  "end_token": 1854,
                                                                  "children": []
                                                                }
                                                              ]
                                                            },
                                                            {
                                                              "type": "EqualsGreaterThanToken",
                                                              "label": "=>",
                                                              "start_token": 1855,
                                                              "end_token": 1855,
                                                              "children": []
                                                            },
                                                            {
                                                              "type": "BinaryExpression",
                                                              "label": "b.key === value",
                                                              "start_token": 1856,
                                                              "end_token": 1860,
                                                              "children": [
                                                                {
                                                                  "type": "PropertyAccessExpression",
                                                                  "label": "b.key",
                                                                  "start_token": 1856,
                                                                  "end_token": 1858,
                                                                  "children": [
                                                                    {
                                                                      "type": "Identifier",
                                                                      "label": "b",
                                                                      "start_token": 1856,
                                                                      "end_token": 1856,
                                                                      "children": []
                                                                    },
                                                                    {
                                                                      "type": "Identifier",
                                                                      "label": "key",
                                                                      "start_token": 1858,
                                                                      "end_token": 1858,
                                                                      "children": []
                                                                    }
                                                                  ]
                                                                },
                                                                {
                                                                  "type": "EqualsEqualsEqualsToken",
                                                                  "label": "===",
                                                                  "start_token": 1859,
                                                                  "end_token": 1859,
                                                                  "children": []
                                                                },
                                                                {
                                                                  "type": "Identifier",
                                                                  "label": "value",
                                                                  "start_token": 1860,
                                                                  "end_token": 1860,
                                                                  "children": []
                                                                }
                                                              ]
                                                            }
                                                          ]
                                                        }
                                                      ]
                                                    }
                                                  ]
                                                }
                                              ]
                                            }
                                          ]
                                        },
                                        {
                                          "type": "IfStatement",
                                          "label": "if (bucketIndex === -1) {\n            bucket = { key: value, nids: [], hits: [] };\n            buckets.push(bucket);\n            bucketIndex = buckets.length - 1;\n          } else {\n            bucket = buckets[bucketIndex];\n          }",
                                          "start_token": 1863,
                                          "end_token": 1914,
                                          "children": [
                                            {
                                              "type": "BinaryExpression",
                                              "label": "bucketIndex === -1",
                                              "start_token": 1865,
                                              "end_token": 1868,
                                              "children": [
                                                {
                                                  "type": "Identifier",
                                                  "label": "bucketIndex",
                                                  "start_token": 1865,
                                                  "end_token": 1865,
                                                  "children": []
                                                },
                                                {
                                                  "type": "EqualsEqualsEqualsToken",
                                                  "label": "===",
                                                  "start_token": 1866,
                                                  "end_token": 1866,
                                                  "children": []
                                                },
                                                {
                                                  "type": "PrefixUnaryExpression",
                                                  "label": "-1",
                                                  "start_token": 1867,
                                                  "end_token": 1868,
                                                  "children": [
                                                    {
                                                      "type": "FirstLiteralToken",
                                                      "label": "1",
                                                      "start_token": 1868,
                                                      "end_token": 1868,
                                                      "children": []
                                                    }
                                                  ]
                                                }
                                              ]
                                            },
                                            {
                                              "type": "Block",
                                              "label": "{\n            bucket = { key: value, nids: [], hits: [] };\n            buckets.push(bucket);\n            bucketIndex = buckets.length - 1;\n          }",
                                              "start_token": 1870,
                                              "end_token": 1904,
                                              "children": [
                                                {
                                                  "type": "ExpressionStatement",
                                                  "label": "bucket = { key: value, nids: [], hits: [] };",
                                                  "start_token": 1871,
                                                  "end_token": 1888,
                                                  "children": [
                                                    {
                                                      "type": "BinaryExpression",
                                                      "label": "bucket = { key: value, nids: [], hits: [] }",
                                                      "start_token": 1871,
                                                      "end_token": 1887,
                                                      "children": [
                                                        {
                                                          "type": "Identifier",
                                                          "label": "bucket",
                                                          "start_token": 1871,
                                                          "end_token": 1871,
                                                          "children": []
                                                        },
                                                        {
                                                          "type": "FirstAssignment",
                                                          "label": "=",
                                                          "start_token": 1872,
                                                          "end_token": 1872,
                                                          "children": []
                                                        },
                                                        {
                                                          "type": "ObjectLiteralExpression",
                                                          "label": "{ key: value, nids: [], hits: [] }",
                                                          "start_token": 1873,
                                                          "end_token": 1887,
                                                          "children": [
                                                            {
                                                              "type": "PropertyAssignment",
                                                              "label": "key: value",
                                                              "start_token": 1874,
                                                              "end_token": 1876,
                                                              "children": [
                                                                {
                                                                  "type": "Identifier",
                                                                  "label": "key",
                                                                  "start_token": 1874,
                                                                  "end_token": 1874,
                                                                  "children": []
                                                                },
                                                                {
                                                                  "type": "Identifier",
                                                                  "label": "value",
                                                                  "start_token": 1876,
                                                                  "end_token": 1876,
                                                                  "children": []
                                                                }
                                                              ]
                                                            },
                                                            {
                                                              "type": "PropertyAssignment",
                                                              "label": "nids: []",
                                                              "start_token": 1878,
                                                              "end_token": 1881,
                                                              "children": [
                                                                {
                                                                  "type": "Identifier",
                                                                  "label": "nids",
                                                                  "start_token": 1878,
                                                                  "end_token": 1878,
                                                                  "children": []
                                                                },
                                                                {
                                                                  "type": "ArrayLiteralExpression",
                                                                  "label": "[]",
                                                                  "start_token": 1880,
                                                                  "end_token": 1881,
                                                                  "children": []
                                                                }
                                                              ]
                                                            },
                                                            {
                                                              "type": "PropertyAssignment",
                                                              "label": "hits: []",
                                                              "start_token": 1883,
                                                              "end_token": 1886,
                                                              "children": [
                                                                {
                                                                  "type": "Identifier",
                                                                  "label": "hits",
                                                                  "start_token": 1883,
                                                                  "end_token": 1883,
                                                                  "children": []
                                                                },
                                                                {
                                                                  "type": "ArrayLiteralExpression",
                                                                  "label": "[]",
                                                                  "start_token": 1885,
                                                                  "end_token": 1886,
                                                                  "children": []
                                                                }
                                                              ]
                                                            }
                                                          ]
                                                        }
                                                      ]
                                                    }
                                                  ]
                                                },
                                                {
                                                  "type": "ExpressionStatement",
                                                  "label": "buckets.push(bucket);",
                                                  "start_token": 1889,
                                                  "end_token": 1895,
                                                  "children": [
                                                    {
                                                      "type": "CallExpression",
                                                      "label": "buckets.push(bucket)",
                                                      "start_token": 1889,
                                                      "end_token": 1894,
                                                      "children": [
                                                        {
                                                          "type": "PropertyAccessExpression",
                                                          "label": "buckets.push",
                                                          "start_token": 1889,
                                                          "end_token": 1891,
                                                          "children": [
                                                            {
                                                              "type": "Identifier",
                                                              "label": "buckets",
                                                              "start_token": 1889,
                                                              "end_token": 1889,
                                                              "children": []
                                                            },
                                                            {
                                                              "type": "Identifier",
                                                              "label": "push",
                                                              "start_token": 1891,
                                                              "end_token": 1891,
                                                              "children": []
                                                            }
                                                          ]
                                                        },
                                                        {
                                                          "type": "Identifier",
                                                          "label": "bucket",
                                                          "start_token": 1893,
                                                          "end_token": 1893,
                                                          "children": []
                                                        }
                                                      ]
                                                    }
                                                  ]
                                                },
                                                {
                                                  "type": "ExpressionStatement",
                                                  "label": "bucketIndex = buckets.length - 1;",
                                                  "start_token": 1896,
                                                  "end_token": 1903,
                                                  "children": [
                                                    {
                                                      "type": "BinaryExpression",
                                                      "label": "bucketIndex = buckets.length - 1",
                                                      "start_token": 1896,
                                                      "end_token": 1902,
                                                      "children": [
                                                        {
                                                          "type": "Identifier",
                                                          "label": "bucketIndex",
                                                          "start_token": 1896,
                                                          "end_token": 1896,
                                                          "children": []
                                                        },
                                                        {
                                                          "type": "FirstAssignment",
                                                          "label": "=",
                                                          "start_token": 1897,
                                                          "end_token": 1897,
                                                          "children": []
                                                        },
                                                        {
                                                          "type": "BinaryExpression",
                                                          "label": "buckets.length - 1",
                                                          "start_token": 1898,
                                                          "end_token": 1902,
                                                          "children": [
                                                            {
                                                              "type": "PropertyAccessExpression",
                                                              "label": "buckets.length",
                                                              "start_token": 1898,
                                                              "end_token": 1900,
                                                              "children": [
                                                                {
                                                                  "type": "Identifier",
                                                                  "label": "buckets",
                                                                  "start_token": 1898,
                                                                  "end_token": 1898,
                                                                  "children": []
                                                                },
                                                                {
                                                                  "type": "Identifier",
                                                                  "label": "length",
                                                                  "start_token": 1900,
                                                                  "end_token": 1900,
                                                                  "children": []
                                                                }
                                                              ]
                                                            },
                                                            {
                                                              "type": "MinusToken",
                                                              "label": "-",
                                                              "start_token": 1901,
                                                              "end_token": 1901,
                                                              "children": []
                                                            },
                                                            {
                                                              "type": "FirstLiteralToken",
                                                              "label": "1",
                                                              "start_token": 1902,
                                                              "end_token": 1902,
                                                              "children": []
                                                            }
                                                          ]
                                                        }
                                                      ]
                                                    }
                                                  ]
                                                }
                                              ]
                                            },
                                            {
                                              "type": "Block",
                                              "label": "{\n            bucket = buckets[bucketIndex];\n          }",
                                              "start_token": 1906,
                                              "end_token": 1914,
                                              "children": [
                                                {
                                                  "type": "ExpressionStatement",
                                                  "label": "bucket = buckets[bucketIndex];",
                                                  "start_token": 1907,
                                                  "end_token": 1913,
                                                  "children": [
                                                    {
                                                      "type": "BinaryExpression",
                                                      "label": "bucket = buckets[bucketIndex]",
                                                      "start_token": 1907,
                                                      "end_token": 1912,
                                                      "children": [
                                                        {
                                                          "type": "Identifier",
                                                          "label": "bucket",
                                                          "start_token": 1907,
                                                          "end_token": 1907,
                                                          "children": []
                                                        },
                                                        {
                                                          "type": "FirstAssignment",
                                                          "label": "=",
                                                          "start_token": 1908,
                                                          "end_token": 1908,
                                                          "children": []
                                                        },
                                                        {
                                                          "type": "ElementAccessExpression",
                                                          "label": "buckets[bucketIndex]",
                                                          "start_token": 1909,
                                                          "end_token": 1912,
                                                          "children": [
                                                            {
                                                              "type": "Identifier",
                                                              "label": "buckets",
                                                              "start_token": 1909,
                                                              "end_token": 1909,
                                                              "children": []
                                                            },
                                                            {
                                                              "type": "Identifier",
                                                              "label": "bucketIndex",
                                                              "start_token": 1911,
                                                              "end_token": 1911,
                                                              "children": []
                                                            }
                                                          ]
                                                        }
                                                      ]
                                                    }
                                                  ]
                                                }
                                              ]
                                            }
                                          ]
                                        },
                                        {
                                          "type": "IfStatement",
                                          "label": "if (\n            bucketIndex >= pagination.skip &&\n            bucketIndex < pagination.skip + pagination.limit\n          ) {\n            bucket.nids.push(nid);\n            if (\n              bucket.nids.length - 1 >= hitPagination.skip &&\n              bucket.nids.length - 1 < hitPagination.skip + hitPagination.limit\n            ) {\n              bucket.hits.push(\n                this.resultNode(record, options.hits ?? {}, match, nid)\n              );\n            }\n          }",
                                          "start_token": 1915,
                                          "end_token": 2003,
                                          "children": [
                                            {
                                              "type": "BinaryExpression",
                                              "label": "bucketIndex >= pagination.skip &&\n            bucketIndex < pagination.skip + pagination.limit",
                                              "start_token": 1917,
                                              "end_token": 1932,
                                              "children": [
                                                {
                                                  "type": "BinaryExpression",
                                                  "label": "bucketIndex >= pagination.skip",
                                                  "start_token": 1917,
                                                  "end_token": 1922,
                                                  "children": [
                                                    {
                                                      "type": "Identifier",
                                                      "label": "bucketIndex",
                                                      "start_token": 1917,
                                                      "end_token": 1917,
                                                      "children": []
                                                    },
                                                    {
                                                      "type": "GreaterThanEqualsToken",
                                                      "label": ">=",
                                                      "start_token": 1918,
                                                      "end_token": 1919,
                                                      "children": []
                                                    },
                                                    {
                                                      "type": "PropertyAccessExpression",
                                                      "label": "pagination.skip",
                                                      "start_token": 1920,
                                                      "end_token": 1922,
                                                      "children": [
                                                        {
                                                          "type": "Identifier",
                                                          "label": "pagination",
                                                          "start_token": 1920,
                                                          "end_token": 1920,
                                                          "children": []
                                                        },
                                                        {
                                                          "type": "Identifier",
                                                          "label": "skip",
                                                          "start_token": 1922,
                                                          "end_token": 1922,
                                                          "children": []
                                                        }
                                                      ]
                                                    }
                                                  ]
                                                },
                                                {
                                                  "type": "AmpersandAmpersandToken",
                                                  "label": "&&",
                                                  "start_token": 1923,
                                                  "end_token": 1923,
                                                  "children": []
                                                },
                                                {
                                                  "type": "BinaryExpression",
                                                  "label": "bucketIndex < pagination.skip + pagination.limit",
                                                  "start_token": 1924,
                                                  "end_token": 1932,
                                                  "children": [
                                                    {
                                                      "type": "Identifier",
                                                      "label": "bucketIndex",
                                                      "start_token": 1924,
                                                      "end_token": 1924,
                                                      "children": []
                                                    },
                                                    {
                                                      "type": "FirstBinaryOperator",
                                                      "label": "<",
                                                      "start_token": 1925,
                                                      "end_token": 1925,
                                                      "children": []
                                                    },
                                                    {
                                                      "type": "BinaryExpression",
                                                      "label": "pagination.skip + pagination.limit",
                                                      "start_token": 1926,
                                                      "end_token": 1932,
                                                      "children": [
                                                        {
                                                          "type": "PropertyAccessExpression",
                                                          "label": "pagination.skip",
                                                          "start_token": 1926,
                                                          "end_token": 1928,
                                                          "children": [
                                                            {
                                                              "type": "Identifier",
                                                              "label": "pagination",
                                                              "start_token": 1926,
                                                              "end_token": 1926,
                                                              "children": []
                                                            },
                                                            {
                                                              "type": "Identifier",
                                                              "label": "skip",
                                                              "start_token": 1928,
                                                              "end_token": 1928,
                                                              "children": []
                                                            }
                                                          ]
                                                        },
                                                        {
                                                          "type": "PlusToken",
                                                          "label": "+",
                                                          "start_token": 1929,
                                                          "end_token": 1929,
                                                          "children": []
                                                        },
                                                        {
                                                          "type": "PropertyAccessExpression",
                                                          "label": "pagination.limit",
                                                          "start_token": 1930,
                                                          "end_token": 1932,
                                                          "children": [
                                                            {
                                                              "type": "Identifier",
                                                              "label": "pagination",
                                                              "start_token": 1930,
                                                              "end_token": 1930,
                                                              "children": []
                                                            },
                                                            {
                                                              "type": "Identifier",
                                                              "label": "limit",
                                                              "start_token": 1932,
                                                              "end_token": 1932,
                                                              "children": []
                                                            }
                                                          ]
                                                        }
                                                      ]
                                                    }
                                                  ]
                                                }
                                              ]
                                            },
                                            {
                                              "type": "Block",
                                              "label": "{\n            bucket.nids.push(nid);\n            if (\n              bucket.nids.length - 1 >= hitPagination.skip &&\n              bucket.nids.length - 1 < hitPagination.skip + hitPagination.limit\n            ) {\n              bucket.hits.push(\n                this.resultNode(record, options.hits ?? {}, match, nid)\n              );\n            }\n          }",
                                              "start_token": 1934,
                                              "end_token": 2003,
                                              "children": [
                                                {
                                                  "type": "ExpressionStatement",
                                                  "label": "bucket.nids.push(nid);",
                                                  "start_token": 1935,
                                                  "end_token": 1943,
                                                  "children": [
                                                    {
                                                      "type": "CallExpression",
                                                      "label": "bucket.nids.push(nid)",
                                                      "start_token": 1935,
                                                      "end_token": 1942,
                                                      "children": [
                                                        {
                                                          "type": "PropertyAccessExpression",
                                                          "label": "bucket.nids.push",
                                                          "start_token": 1935,
                                                          "end_token": 1939,
                                                          "children": [
                                                            {
                                                              "type": "PropertyAccessExpression",
                                                              "label": "bucket.nids",
                                                              "start_token": 1935,
                                                              "end_token": 1937,
                                                              "children": [
                                                                {
                                                                  "type": "Identifier",
                                                                  "label": "bucket",
                                                                  "start_token": 1935,
                                                                  "end_token": 1935,
                                                                  "children": []
                                                                },
                                                                {
                                                                  "type": "Identifier",
                                                                  "label": "nids",
                                                                  "start_token": 1937,
                                                                  "end_token": 1937,
                                                                  "children": []
                                                                }
                                                              ]
                                                            },
                                                            {
                                                              "type": "Identifier",
                                                              "label": "push",
                                                              "start_token": 1939,
                                                              "end_token": 1939,
                                                              "children": []
                                                            }
                                                          ]
                                                        },
                                                        {
                                                          "type": "Identifier",
                                                          "label": "nid",
                                                          "start_token": 1941,
                                                          "end_token": 1941,
                                                          "children": []
                                                        }
                                                      ]
                                                    }
                                                  ]
                                                },
                                                {
                                                  "type": "IfStatement",
                                                  "label": "if (\n              bucket.nids.length - 1 >= hitPagination.skip &&\n              bucket.nids.length - 1 < hitPagination.skip + hitPagination.limit\n            ) {\n              bucket.hits.push(\n                this.resultNode(record, options.hits ?? {}, match, nid)\n              );\n            }",
                                                  "start_token": 1944,
                                                  "end_token": 2002,
                                                  "children": [
                                                    {
                                                      "type": "BinaryExpression",
                                                      "label": "bucket.nids.length - 1 >= hitPagination.skip &&\n              bucket.nids.length - 1 < hitPagination.skip + hitPagination.limit",
                                                      "start_token": 1946,
                                                      "end_token": 1973,
                                                      "children": [
                                                        {
                                                          "type": "BinaryExpression",
                                                          "label": "bucket.nids.length - 1 >= hitPagination.skip",
                                                          "start_token": 1946,
                                                          "end_token": 1957,
                                                          "children": [
                                                            {
                                                              "type": "BinaryExpression",
                                                              "label": "bucket.nids.length - 1",
                                                              "start_token": 1946,
                                                              "end_token": 1952,
                                                              "children": [
                                                                {
                                                                  "type": "PropertyAccessExpression",
                                                                  "label": "bucket.nids.length",
                                                                  "start_token": 1946,
                                                                  "end_token": 1950,
                                                                  "children": [
                                                                    {
                                                                      "type": "PropertyAccessExpression",
                                                                      "label": "bucket.nids",
                                                                      "start_token": 1946,
                                                                      "end_token": 1948,
                                                                      "children": [
                                                                        {
                                                                          "type": "Identifier",
                                                                          "label": "bucket",
                                                                          "start_token": 1946,
                                                                          "end_token": 1946,
                                                                          "children": []
                                                                        },
                                                                        {
                                                                          "type": "Identifier",
                                                                          "label": "nids",
                                                                          "start_token": 1948,
                                                                          "end_token": 1948,
                                                                          "children": []
                                                                        }
                                                                      ]
                                                                    },
                                                                    {
                                                                      "type": "Identifier",
                                                                      "label": "length",
                                                                      "start_token": 1950,
                                                                      "end_token": 1950,
                                                                      "children": []
                                                                    }
                                                                  ]
                                                                },
                                                                {
                                                                  "type": "MinusToken",
                                                                  "label": "-",
                                                                  "start_token": 1951,
                                                                  "end_token": 1951,
                                                                  "children": []
                                                                },
                                                                {
                                                                  "type": "FirstLiteralToken",
                                                                  "label": "1",
                                                                  "start_token": 1952,
                                                                  "end_token": 1952,
                                                                  "children": []
                                                                }
                                                              ]
                                                            },
                                                            {
                                                              "type": "GreaterThanEqualsToken",
                                                              "label": ">=",
                                                              "start_token": 1953,
                                                              "end_token": 1954,
                                                              "children": []
                                                            },
                                                            {
                                                              "type": "PropertyAccessExpression",
                                                              "label": "hitPagination.skip",
                                                              "start_token": 1955,
                                                              "end_token": 1957,
                                                              "children": [
                                                                {
                                                                  "type": "Identifier",
                                                                  "label": "hitPagination",
                                                                  "start_token": 1955,
                                                                  "end_token": 1955,
                                                                  "children": []
                                                                },
                                                                {
                                                                  "type": "Identifier",
                                                                  "label": "skip",
                                                                  "start_token": 1957,
                                                                  "end_token": 1957,
                                                                  "children": []
                                                                }
                                                              ]
                                                            }
                                                          ]
                                                        },
                                                        {
                                                          "type": "AmpersandAmpersandToken",
                                                          "label": "&&",
                                                          "start_token": 1958,
                                                          "end_token": 1958,
                                                          "children": []
                                                        },
                                                        {
                                                          "type": "BinaryExpression",
                                                          "label": "bucket.nids.length - 1 < hitPagination.skip + hitPagination.limit",
                                                          "start_token": 1959,
                                                          "end_token": 1973,
                                                          "children": [
                                                            {
                                                              "type": "BinaryExpression",
                                                              "label": "bucket.nids.length - 1",
                                                              "start_token": 1959,
                                                              "end_token": 1965,
                                                              "children": [
                                                                {
                                                                  "type": "PropertyAccessExpression",
                                                                  "label": "bucket.nids.length",
                                                                  "start_token": 1959,
                                                                  "end_token": 1963,
                                                                  "children": [
                                                                    {
                                                                      "type": "PropertyAccessExpression",
                                                                      "label": "bucket.nids",
                                                                      "start_token": 1959,
                                                                      "end_token": 1961,
                                                                      "children": [
                                                                        {
                                                                          "type": "Identifier",
                                                                          "label": "bucket",
                                                                          "start_token": 1959,
                                                                          "end_token": 1959,
                                                                          "children": []
                                                                        },
                                                                        {
                                                                          "type": "Identifier",
                                                                          "label": "nids",
                                                                          "start_token": 1961,
                                                                          "end_token": 1961,
                                                                          "children": []
                                                                        }
                                                                      ]
                                                                    },
                                                                    {
                                                                      "type": "Identifier",
                                                                      "label": "length",
                                                                      "start_token": 1963,
                                                                      "end_token": 1963,
                                                                      "children": []
                                                                    }
                                                                  ]
                                                                },
                                                                {
                                                                  "type": "MinusToken",
                                                                  "label": "-",
                                                                  "start_token": 1964,
                                                                  "end_token": 1964,
                                                                  "children": []
                                                                },
                                                                {
                                                                  "type": "FirstLiteralToken",
                                                                  "label": "1",
                                                                  "start_token": 1965,
                                                                  "end_token": 1965,
                                                                  "children": []
                                                                }
                                                              ]
                                                            },
                                                            {
                                                              "type": "FirstBinaryOperator",
                                                              "label": "<",
                                                              "start_token": 1966,
                                                              "end_token": 1966,
                                                              "children": []
                                                            },
                                                            {
                                                              "type": "BinaryExpression",
                                                              "label": "hitPagination.skip + hitPagination.limit",
                                                              "start_token": 1967,
                                                              "end_token": 1973,
                                                              "children": [
                                                                {
                                                                  "type": "PropertyAccessExpression",
                                                                  "label": "hitPagination.skip",
                                                                  "start_token": 1967,
                                                                  "end_token": 1969,
                                                                  "children": [
                                                                    {
                                                                      "type": "Identifier",
                                                                      "label": "hitPagination",
                                                                      "start_token": 1967,
                                                                      "end_token": 1967,
                                                                      "children": []
                                                                    },
                                                                    {
                                                                      "type": "Identifier",
                                                                      "label": "skip",
                                                                      "start_token": 1969,
                                                                      "end_token": 1969,
                                                                      "children": []
                                                                    }
                                                                  ]
                                                                },
                                                                {
                                                                  "type": "PlusToken",
                                                                  "label": "+",
                                                                  "start_token": 1970,
                                                                  "end_token": 1970,
                                                                  "children": []
                                                                },
                                                                {
                                                                  "type": "PropertyAccessExpression",
                                                                  "label": "hitPagination.limit",
                                                                  "start_token": 1971,
                                                                  "end_token": 1973,
                                                                  "children": [
                                                                    {
                                                                      "type": "Identifier",
                                                                      "label": "hitPagination",
                                                                      "start_token": 1971,
                                                                      "end_token": 1971,
                                                                      "children": []
                                                                    },
                                                                    {
                                                                      "type": "Identifier",
                                                                      "label": "limit",
                                                                      "start_token": 1973,
                                                                      "end_token": 1973,
                                                                      "children": []
                                                                    }
                                                                  ]
                                                                }
                                                              ]
                                                            }
                                                          ]
                                                        }
                                                      ]
                                                    },
                                                    {
                                                      "type": "Block",
                                                      "label": "{\n              bucket.hits.push(\n                this.resultNode(record, options.hits ?? {}, match, nid)\n              );\n            }",
                                                      "start_token": 1975,
                                                      "end_token": 2002,
                                                      "children": [
                                                        {
                                                          "type": "ExpressionStatement",
                                                          "label": "bucket.hits.push(\n                this.resultNode(record, options.hits ?? {}, match, nid)\n              );",
                                                          "start_token": 1976,
                                                          "end_token": 2001,
                                                          "children": [
                                                            {
                                                              "type": "CallExpression",
                                                              "label": "bucket.hits.push(\n                this.resultNode(record, options.hits ?? {}, match, nid)\n              )",
                                                              "start_token": 1976,
                                                              "end_token": 2000,
                                                              "children": [
                                                                {
                                                                  "type": "PropertyAccessExpression",
                                                                  "label": "bucket.hits.push",
                                                                  "start_token": 1976,
                                                                  "end_token": 1980,
                                                                  "children": [
                                                                    {
                                                                      "type": "PropertyAccessExpression",
                                                                      "label": "bucket.hits",
                                                                      "start_token": 1976,
                                                                      "end_token": 1978,
                                                                      "children": [
                                                                        {
                                                                          "type": "Identifier",
                                                                          "label": "bucket",
                                                                          "start_token": 1976,
                                                                          "end_token": 1976,
                                                                          "children": []
                                                                        },
                                                                        {
                                                                          "type": "Identifier",
                                                                          "label": "hits",
                                                                          "start_token": 1978,
                                                                          "end_token": 1978,
                                                                          "children": []
                                                                        }
                                                                      ]
                                                                    },
                                                                    {
                                                                      "type": "Identifier",
                                                                      "label": "push",
                                                                      "start_token": 1980,
                                                                      "end_token": 1980,
                                                                      "children": []
                                                                    }
                                                                  ]
                                                                },
                                                                {
                                                                  "type": "CallExpression",
                                                                  "label": "this.resultNode(record, options.hits ?? {}, match, nid)",
                                                                  "start_token": 1982,
                                                                  "end_token": 1999,
                                                                  "children": [
                                                                    {
                                                                      "type": "PropertyAccessExpression",
                                                                      "label": "this.resultNode",
                                                                      "start_token": 1982,
                                                                      "end_token": 1984,
                                                                      "children": [
                                                                        {
                                                                          "type": "ThisKeyword",
                                                                          "label": "this",
                                                                          "start_token": 1982,
                                                                          "end_token": 1982,
                                                                          "children": []
                                                                        },
                                                                        {
                                                                          "type": "Identifier",
                                                                          "label": "resultNode",
                                                                          "start_token": 1984,
                                                                          "end_token": 1984,
                                                                          "children": []
                                                                        }
                                                                      ]
                                                                    },
                                                                    {
                                                                      "type": "Identifier",
                                                                      "label": "record",
                                                                      "start_token": 1986,
                                                                      "end_token": 1986,
                                                                      "children": []
                                                                    },
                                                                    {
                                                                      "type": "BinaryExpression",
                                                                      "label": "options.hits ?? {}",
                                                                      "start_token": 1988,
                                                                      "end_token": 1994,
                                                                      "children": [
                                                                        {
                                                                          "type": "PropertyAccessExpression",
                                                                          "label": "options.hits",
                                                                          "start_token": 1988,
                                                                          "end_token": 1990,
                                                                          "children": [
                                                                            {
                                                                              "type": "Identifier",
                                                                              "label": "options",
                                                                              "start_token": 1988,
                                                                              "end_token": 1988,
                                                                              "children": []
                                                                            },
                                                                            {
                                                                              "type": "Identifier",
                                                                              "label": "hits",
                                                                              "start_token": 1990,
                                                                              "end_token": 1990,
                                                                              "children": []
                                                                            }
                                                                          ]
                                                                        },
                                                                        {
                                                                          "type": "QuestionQuestionToken",
                                                                          "label": "??",
                                                                          "start_token": 1991,
                                                                          "end_token": 1992,
                                                                          "children": []
                                                                        },
                                                                        {
                                                                          "type": "ObjectLiteralExpression",
                                                                          "label": "{}",
                                                                          "start_token": 1993,
                                                                          "end_token": 1994,
                                                                          "children": []
                                                                        }
                                                                      ]
                                                                    },
                                                                    {
                                                                      "type": "Identifier",
                                                                      "label": "match",
                                                                      "start_token": 1996,
                                                                      "end_token": 1996,
                                                                      "children": []
                                                                    },
                                                                    {
                                                                      "type": "Identifier",
                                                                      "label": "nid",
                                                                      "start_token": 1998,
                                                                      "end_token": 1998,
                                                                      "children": []
                                                                    }
                                                                  ]
                                                                }
                                                              ]
                                                            }
                                                          ]
                                                        }
                                                      ]
                                                    }
                                                  ]
                                                }
                                              ]
                                            }
                                          ]
                                        }
                                      ]
                                    }
                                  ]
                                }
                              ]
                            }
                          ]
                        },
                        {
                          "type": "ReturnStatement",
                          "label": "return {\n        buckets: buckets\n          .slice(pagination.skip, pagination.skip + pagination.limit)\n          .map(bucket => {\n            const result = {\n              key: bucket.key,\n              score: match.getScore(bucket.nids[0]),\n              count: bucket.nids.length,\n            } as AggregateResult<any, any>['buckets'][number];\n            if (options.hits) {\n              (result as any).hits = {\n                pagination: {\n                  count: bucket.nids.length,\n                  hasMore:\n                    bucket.nids.length >\n                    hitPagination.limit + hitPagination.skip,\n                  limit: hitPagination.limit,\n                  skip: hitPagination.skip,\n                },\n                nodes: bucket.hits,\n              } as SearchResult<any, any>;\n            }\n            return result;\n          }),\n        pagination: {\n          count: buckets.length,\n          hasMore: buckets.length > pagination.limit + pagination.skip,\n          limit: pagination.limit,\n          skip: pagination.skip,\n        },\n      };",
                          "start_token": 2006,
                          "end_token": 2196,
                          "children": [
                            {
                              "type": "ObjectLiteralExpression",
                              "label": "{\n        buckets: buckets\n          .slice(pagination.skip, pagination.skip + pagination.limit)\n          .map(bucket => {\n            const result = {\n              key: bucket.key,\n              score: match.getScore(bucket.nids[0]),\n              count: bucket.nids.length,\n            } as AggregateResult<any, any>['buckets'][number];\n            if (options.hits) {\n              (result as any).hits = {\n                pagination: {\n                  count: bucket.nids.length,\n                  hasMore:\n                    bucket.nids.length >\n                    hitPagination.limit + hitPagination.skip,\n                  limit: hitPagination.limit,\n                  skip: hitPagination.skip,\n                },\n                nodes: bucket.hits,\n              } as SearchResult<any, any>;\n            }\n            return result;\n          }),\n        pagination: {\n          count: buckets.length,\n          hasMore: buckets.length > pagination.limit + pagination.skip,\n          limit: pagination.limit,\n          skip: pagination.skip,\n        },\n      }",
                              "start_token": 2007,
                              "end_token": 2195,
                              "children": [
                                {
                                  "type": "PropertyAssignment",
                                  "label": "buckets: buckets\n          .slice(pagination.skip, pagination.skip + pagination.limit)\n          .map(bucket => {\n            const result = {\n              key: bucket.key,\n              score: match.getScore(bucket.nids[0]),\n              count: bucket.nids.length,\n            } as AggregateResult<any, any>['buckets'][number];\n            if (options.hits) {\n              (result as any).hits = {\n                pagination: {\n                  count: bucket.nids.length,\n                  hasMore:\n                    bucket.nids.length >\n                    hitPagination.limit + hitPagination.skip,\n                  limit: hitPagination.limit,\n                  skip: hitPagination.skip,\n                },\n                nodes: bucket.hits,\n              } as SearchResult<any, any>;\n            }\n            return result;\n          })",
                                  "start_token": 2008,
                                  "end_token": 2156,
                                  "children": [
                                    {
                                      "type": "Identifier",
                                      "label": "buckets",
                                      "start_token": 2008,
                                      "end_token": 2008,
                                      "children": []
                                    },
                                    {
                                      "type": "CallExpression",
                                      "label": "buckets\n          .slice(pagination.skip, pagination.skip + pagination.limit)\n          .map(bucket => {\n            const result = {\n              key: bucket.key,\n              score: match.getScore(bucket.nids[0]),\n              count: bucket.nids.length,\n            } as AggregateResult<any, any>['buckets'][number];\n            if (options.hits) {\n              (result as any).hits = {\n                pagination: {\n                  count: bucket.nids.length,\n                  hasMore:\n                    bucket.nids.length >\n                    hitPagination.limit + hitPagination.skip,\n                  limit: hitPagination.limit,\n                  skip: hitPagination.skip,\n                },\n                nodes: bucket.hits,\n              } as SearchResult<any, any>;\n            }\n            return result;\n          })",
                                      "start_token": 2010,
                                      "end_token": 2156,
                                      "children": [
                                        {
                                          "type": "PropertyAccessExpression",
                                          "label": "buckets\n          .slice(pagination.skip, pagination.skip + pagination.limit)\n          .map",
                                          "start_token": 2010,
                                          "end_token": 2027,
                                          "children": [
                                            {
                                              "type": "CallExpression",
                                              "label": "buckets\n          .slice(pagination.skip, pagination.skip + pagination.limit)",
                                              "start_token": 2010,
                                              "end_token": 2025,
                                              "children": [
                                                {
                                                  "type": "PropertyAccessExpression",
                                                  "label": "buckets\n          .slice",
                                                  "start_token": 2010,
                                                  "end_token": 2012,
                                                  "children": [
                                                    {
                                                      "type": "Identifier",
                                                      "label": "buckets",
                                                      "start_token": 2010,
                                                      "end_token": 2010,
                                                      "children": []
                                                    },
                                                    {
                                                      "type": "Identifier",
                                                      "label": "slice",
                                                      "start_token": 2012,
                                                      "end_token": 2012,
                                                      "children": []
                                                    }
                                                  ]
                                                },
                                                {
                                                  "type": "PropertyAccessExpression",
                                                  "label": "pagination.skip",
                                                  "start_token": 2014,
                                                  "end_token": 2016,
                                                  "children": [
                                                    {
                                                      "type": "Identifier",
                                                      "label": "pagination",
                                                      "start_token": 2014,
                                                      "end_token": 2014,
                                                      "children": []
                                                    },
                                                    {
                                                      "type": "Identifier",
                                                      "label": "skip",
                                                      "start_token": 2016,
                                                      "end_token": 2016,
                                                      "children": []
                                                    }
                                                  ]
                                                },
                                                {
                                                  "type": "BinaryExpression",
                                                  "label": "pagination.skip + pagination.limit",
                                                  "start_token": 2018,
                                                  "end_token": 2024,
                                                  "children": [
                                                    {
                                                      "type": "PropertyAccessExpression",
                                                      "label": "pagination.skip",
                                                      "start_token": 2018,
                                                      "end_token": 2020,
                                                      "children": [
                                                        {
                                                          "type": "Identifier",
                                                          "label": "pagination",
                                                          "start_token": 2018,
                                                          "end_token": 2018,
                                                          "children": []
                                                        },
                                                        {
                                                          "type": "Identifier",
                                                          "label": "skip",
                                                          "start_token": 2020,
                                                          "end_token": 2020,
                                                          "children": []
                                                        }
                                                      ]
                                                    },
                                                    {
                                                      "type": "PlusToken",
                                                      "label": "+",
                                                      "start_token": 2021,
                                                      "end_token": 2021,
                                                      "children": []
                                                    },
                                                    {
                                                      "type": "PropertyAccessExpression",
                                                      "label": "pagination.limit",
                                                      "start_token": 2022,
                                                      "end_token": 2024,
                                                      "children": [
                                                        {
                                                          "type": "Identifier",
                                                          "label": "pagination",
                                                          "start_token": 2022,
                                                          "end_token": 2022,
                                                          "children": []
                                                        },
                                                        {
                                                          "type": "Identifier",
                                                          "label": "limit",
                                                          "start_token": 2024,
                                                          "end_token": 2024,
                                                          "children": []
                                                        }
                                                      ]
                                                    }
                                                  ]
                                                }
                                              ]
                                            },
                                            {
                                              "type": "Identifier",
                                              "label": "map",
                                              "start_token": 2027,
                                              "end_token": 2027,
                                              "children": []
                                            }
                                          ]
                                        },
                                        {
                                          "type": "ArrowFunction",
                                          "label": "bucket => {\n            const result = {\n              key: bucket.key,\n              score: match.getScore(bucket.nids[0]),\n              count: bucket.nids.length,\n            } as AggregateResult<any, any>['buckets'][number];\n            if (options.hits) {\n              (result as any).hits = {\n                pagination: {\n                  count: bucket.nids.length,\n                  hasMore:\n                    bucket.nids.length >\n                    hitPagination.limit + hitPagination.skip,\n                  limit: hitPagination.limit,\n                  skip: hitPagination.skip,\n                },\n                nodes: bucket.hits,\n              } as SearchResult<any, any>;\n            }\n            return result;\n          }",
                                          "start_token": 2029,
                                          "end_token": 2155,
                                          "children": [
                                            {
                                              "type": "Parameter",
                                              "label": "bucket",
                                              "start_token": 2029,
                                              "end_token": 2029,
                                              "children": [
                                                {
                                                  "type": "Identifier",
                                                  "label": "bucket",
                                                  "start_token": 2029,
                                                  "end_token": 2029,
                                                  "children": []
                                                }
                                              ]
                                            },
                                            {
                                              "type": "EqualsGreaterThanToken",
                                              "label": "=>",
                                              "start_token": 2030,
                                              "end_token": 2030,
                                              "children": []
                                            },
                                            {
                                              "type": "Block",
                                              "label": "{\n            const result = {\n              key: bucket.key,\n              score: match.getScore(bucket.nids[0]),\n              count: bucket.nids.length,\n            } as AggregateResult<any, any>['buckets'][number];\n            if (options.hits) {\n              (result as any).hits = {\n                pagination: {\n                  count: bucket.nids.length,\n                  hasMore:\n                    bucket.nids.length >\n                    hitPagination.limit + hitPagination.skip,\n                  limit: hitPagination.limit,\n                  skip: hitPagination.skip,\n                },\n                nodes: bucket.hits,\n              } as SearchResult<any, any>;\n            }\n            return result;\n          }",
                                              "start_token": 2031,
                                              "end_token": 2155,
                                              "children": [
                                                {
                                                  "type": "FirstStatement",
                                                  "label": "const result = {\n              key: bucket.key,\n              score: match.getScore(bucket.nids[0]),\n              count: bucket.nids.length,\n            } as AggregateResult<any, any>['buckets'][number];",
                                                  "start_token": 2032,
                                                  "end_token": 2078,
                                                  "children": [
                                                    {
                                                      "type": "VariableDeclarationList",
                                                      "label": "const result = {\n              key: bucket.key,\n              score: match.getScore(bucket.nids[0]),\n              count: bucket.nids.length,\n            } as AggregateResult<any, any>['buckets'][number]",
                                                      "start_token": 2032,
                                                      "end_token": 2077,
                                                      "children": [
                                                        {
                                                          "type": "VariableDeclaration",
                                                          "label": "result = {\n              key: bucket.key,\n              score: match.getScore(bucket.nids[0]),\n              count: bucket.nids.length,\n            } as AggregateResult<any, any>['buckets'][number]",
                                                          "start_token": 2033,
                                                          "end_token": 2077,
                                                          "children": [
                                                            {
                                                              "type": "Identifier",
                                                              "label": "result",
                                                              "start_token": 2033,
                                                              "end_token": 2033,
                                                              "children": []
                                                            },
                                                            {
                                                              "type": "AsExpression",
                                                              "label": "{\n              key: bucket.key,\n              score: match.getScore(bucket.nids[0]),\n              count: bucket.nids.length,\n            } as AggregateResult<any, any>['buckets'][number]",
                                                              "start_token": 2035,
                                                              "end_token": 2077,
                                                              "children": [
                                                                {
                                                                  "type": "ObjectLiteralExpression",
                                                                  "label": "{\n              key: bucket.key,\n              score: match.getScore(bucket.nids[0]),\n              count: bucket.nids.length,\n            }",
                                                                  "start_token": 2035,
                                                                  "end_token": 2064,
                                                                  "children": [
                                                                    {
                                                                      "type": "PropertyAssignment",
                                                                      "label": "key: bucket.key",
                                                                      "start_token": 2036,
                                                                      "end_token": 2040,
                                                                      "children": [
                                                                        {
                                                                          "type": "Identifier",
                                                                          "label": "key",
                                                                          "start_token": 2036,
                                                                          "end_token": 2036,
                                                                          "children": []
                                                                        },
                                                                        {
                                                                          "type": "PropertyAccessExpression",
                                                                          "label": "bucket.key",
                                                                          "start_token": 2038,
                                                                          "end_token": 2040,
                                                                          "children": [
                                                                            {
                                                                              "type": "Identifier",
                                                                              "label": "bucket",
                                                                              "start_token": 2038,
                                                                              "end_token": 2038,
                                                                              "children": []
                                                                            },
                                                                            {
                                                                              "type": "Identifier",
                                                                              "label": "key",
                                                                              "start_token": 2040,
                                                                              "end_token": 2040,
                                                                              "children": []
                                                                            }
                                                                          ]
                                                                        }
                                                                      ]
                                                                    },
                                                                    {
                                                                      "type": "PropertyAssignment",
                                                                      "label": "score: match.getScore(bucket.nids[0])",
                                                                      "start_token": 2042,
                                                                      "end_token": 2054,
                                                                      "children": [
                                                                        {
                                                                          "type": "Identifier",
                                                                          "label": "score",
                                                                          "start_token": 2042,
                                                                          "end_token": 2042,
                                                                          "children": []
                                                                        },
                                                                        {
                                                                          "type": "CallExpression",
                                                                          "label": "match.getScore(bucket.nids[0])",
                                                                          "start_token": 2044,
                                                                          "end_token": 2054,
                                                                          "children": [
                                                                            {
                                                                              "type": "PropertyAccessExpression",
                                                                              "label": "match.getScore",
                                                                              "start_token": 2044,
                                                                              "end_token": 2046,
                                                                              "children": [
                                                                                {
                                                                                  "type": "Identifier",
                                                                                  "label": "match",
                                                                                  "start_token": 2044,
                                                                                  "end_token": 2044,
                                                                                  "children": []
                                                                                },
                                                                                {
                                                                                  "type": "Identifier",
                                                                                  "label": "getScore",
                                                                                  "start_token": 2046,
                                                                                  "end_token": 2046,
                                                                                  "children": []
                                                                                }
                                                                              ]
                                                                            },
                                                                            {
                                                                              "type": "ElementAccessExpression",
                                                                              "label": "bucket.nids[0]",
                                                                              "start_token": 2048,
                                                                              "end_token": 2053,
                                                                              "children": [
                                                                                {
                                                                                  "type": "PropertyAccessExpression",
                                                                                  "label": "bucket.nids",
                                                                                  "start_token": 2048,
                                                                                  "end_token": 2050,
                                                                                  "children": [
                                                                                    {
                                                                                      "type": "Identifier",
                                                                                      "label": "bucket",
                                                                                      "start_token": 2048,
                                                                                      "end_token": 2048,
                                                                                      "children": []
                                                                                    },
                                                                                    {
                                                                                      "type": "Identifier",
                                                                                      "label": "nids",
                                                                                      "start_token": 2050,
                                                                                      "end_token": 2050,
                                                                                      "children": []
                                                                                    }
                                                                                  ]
                                                                                },
                                                                                {
                                                                                  "type": "FirstLiteralToken",
                                                                                  "label": "0",
                                                                                  "start_token": 2052,
                                                                                  "end_token": 2052,
                                                                                  "children": []
                                                                                }
                                                                              ]
                                                                            }
                                                                          ]
                                                                        }
                                                                      ]
                                                                    },
                                                                    {
                                                                      "type": "PropertyAssignment",
                                                                      "label": "count: bucket.nids.length",
                                                                      "start_token": 2056,
                                                                      "end_token": 2062,
                                                                      "children": [
                                                                        {
                                                                          "type": "Identifier",
                                                                          "label": "count",
                                                                          "start_token": 2056,
                                                                          "end_token": 2056,
                                                                          "children": []
                                                                        },
                                                                        {
                                                                          "type": "PropertyAccessExpression",
                                                                          "label": "bucket.nids.length",
                                                                          "start_token": 2058,
                                                                          "end_token": 2062,
                                                                          "children": [
                                                                            {
                                                                              "type": "PropertyAccessExpression",
                                                                              "label": "bucket.nids",
                                                                              "start_token": 2058,
                                                                              "end_token": 2060,
                                                                              "children": [
                                                                                {
                                                                                  "type": "Identifier",
                                                                                  "label": "bucket",
                                                                                  "start_token": 2058,
                                                                                  "end_token": 2058,
                                                                                  "children": []
                                                                                },
                                                                                {
                                                                                  "type": "Identifier",
                                                                                  "label": "nids",
                                                                                  "start_token": 2060,
                                                                                  "end_token": 2060,
                                                                                  "children": []
                                                                                }
                                                                              ]
                                                                            },
                                                                            {
                                                                              "type": "Identifier",
                                                                              "label": "length",
                                                                              "start_token": 2062,
                                                                              "end_token": 2062,
                                                                              "children": []
                                                                            }
                                                                          ]
                                                                        }
                                                                      ]
                                                                    }
                                                                  ]
                                                                },
                                                                {
                                                                  "type": "IndexedAccessType",
                                                                  "label": "AggregateResult<any, any>['buckets'][number]",
                                                                  "start_token": 2066,
                                                                  "end_token": 2077,
                                                                  "children": [
                                                                    {
                                                                      "type": "IndexedAccessType",
                                                                      "label": "AggregateResult<any, any>['buckets']",
                                                                      "start_token": 2066,
                                                                      "end_token": 2074,
                                                                      "children": [
                                                                        {
                                                                          "type": "TypeReference",
                                                                          "label": "AggregateResult<any, any>",
                                                                          "start_token": 2066,
                                                                          "end_token": 2071,
                                                                          "children": [
                                                                            {
                                                                              "type": "Identifier",
                                                                              "label": "AggregateResult",
                                                                              "start_token": 2066,
                                                                              "end_token": 2066,
                                                                              "children": []
                                                                            },
                                                                            {
                                                                              "type": "AnyKeyword",
                                                                              "label": "any",
                                                                              "start_token": 2068,
                                                                              "end_token": 2068,
                                                                              "children": []
                                                                            },
                                                                            {
                                                                              "type": "AnyKeyword",
                                                                              "label": "any",
                                                                              "start_token": 2070,
                                                                              "end_token": 2070,
                                                                              "children": []
                                                                            }
                                                                          ]
                                                                        },
                                                                        {
                                                                          "type": "LiteralType",
                                                                          "label": "'buckets'",
                                                                          "start_token": 2073,
                                                                          "end_token": 2073,
                                                                          "children": [
                                                                            {
                                                                              "type": "StringLiteral",
                                                                              "label": "'buckets'",
                                                                              "start_token": 2073,
                                                                              "end_token": 2073,
                                                                              "children": []
                                                                            }
                                                                          ]
                                                                        }
                                                                      ]
                                                                    },
                                                                    {
                                                                      "type": "NumberKeyword",
                                                                      "label": "number",
                                                                      "start_token": 2076,
                                                                      "end_token": 2076,
                                                                      "children": []
                                                                    }
                                                                  ]
                                                                }
                                                              ]
                                                            }
                                                          ]
                                                        }
                                                      ]
                                                    }
                                                  ]
                                                },
                                                {
                                                  "type": "IfStatement",
                                                  "label": "if (options.hits) {\n              (result as any).hits = {\n                pagination: {\n                  count: bucket.nids.length,\n                  hasMore:\n                    bucket.nids.length >\n                    hitPagination.limit + hitPagination.skip,\n                  limit: hitPagination.limit,\n                  skip: hitPagination.skip,\n                },\n                nodes: bucket.hits,\n              } as SearchResult<any, any>;\n            }",
                                                  "start_token": 2079,
                                                  "end_token": 2151,
                                                  "children": [
                                                    {
                                                      "type": "PropertyAccessExpression",
                                                      "label": "options.hits",
                                                      "start_token": 2081,
                                                      "end_token": 2083,
                                                      "children": [
                                                        {
                                                          "type": "Identifier",
                                                          "label": "options",
                                                          "start_token": 2081,
                                                          "end_token": 2081,
                                                          "children": []
                                                        },
                                                        {
                                                          "type": "Identifier",
                                                          "label": "hits",
                                                          "start_token": 2083,
                                                          "end_token": 2083,
                                                          "children": []
                                                        }
                                                      ]
                                                    },
                                                    {
                                                      "type": "Block",
                                                      "label": "{\n              (result as any).hits = {\n                pagination: {\n                  count: bucket.nids.length,\n                  hasMore:\n                    bucket.nids.length >\n                    hitPagination.limit + hitPagination.skip,\n                  limit: hitPagination.limit,\n                  skip: hitPagination.skip,\n                },\n                nodes: bucket.hits,\n              } as SearchResult<any, any>;\n            }",
                                                      "start_token": 2085,
                                                      "end_token": 2151,
                                                      "children": [
                                                        {
                                                          "type": "ExpressionStatement",
                                                          "label": "(result as any).hits = {\n                pagination: {\n                  count: bucket.nids.length,\n                  hasMore:\n                    bucket.nids.length >\n                    hitPagination.limit + hitPagination.skip,\n                  limit: hitPagination.limit,\n                  skip: hitPagination.skip,\n                },\n                nodes: bucket.hits,\n              } as SearchResult<any, any>;",
                                                          "start_token": 2086,
                                                          "end_token": 2150,
                                                          "children": [
                                                            {
                                                              "type": "BinaryExpression",
                                                              "label": "(result as any).hits = {\n                pagination: {\n                  count: bucket.nids.length,\n                  hasMore:\n                    bucket.nids.length >\n                    hitPagination.limit + hitPagination.skip,\n                  limit: hitPagination.limit,\n                  skip: hitPagination.skip,\n                },\n                nodes: bucket.hits,\n              } as SearchResult<any, any>",
                                                              "start_token": 2086,
                                                              "end_token": 2149,
                                                              "children": [
                                                                {
                                                                  "type": "PropertyAccessExpression",
                                                                  "label": "(result as any).hits",
                                                                  "start_token": 2086,
                                                                  "end_token": 2092,
                                                                  "children": [
                                                                    {
                                                                      "type": "ParenthesizedExpression",
                                                                      "label": "(result as any)",
                                                                      "start_token": 2086,
                                                                      "end_token": 2090,
                                                                      "children": [
                                                                        {
                                                                          "type": "AsExpression",
                                                                          "label": "result as any",
                                                                          "start_token": 2087,
                                                                          "end_token": 2089,
                                                                          "children": [
                                                                            {
                                                                              "type": "Identifier",
                                                                              "label": "result",
                                                                              "start_token": 2087,
                                                                              "end_token": 2087,
                                                                              "children": []
                                                                            },
                                                                            {
                                                                              "type": "AnyKeyword",
                                                                              "label": "any",
                                                                              "start_token": 2089,
                                                                              "end_token": 2089,
                                                                              "children": []
                                                                            }
                                                                          ]
                                                                        }
                                                                      ]
                                                                    },
                                                                    {
                                                                      "type": "Identifier",
                                                                      "label": "hits",
                                                                      "start_token": 2092,
                                                                      "end_token": 2092,
                                                                      "children": []
                                                                    }
                                                                  ]
                                                                },
                                                                {
                                                                  "type": "FirstAssignment",
                                                                  "label": "=",
                                                                  "start_token": 2093,
                                                                  "end_token": 2093,
                                                                  "children": []
                                                                },
                                                                {
                                                                  "type": "AsExpression",
                                                                  "label": "{\n                pagination: {\n                  count: bucket.nids.length,\n                  hasMore:\n                    bucket.nids.length >\n                    hitPagination.limit + hitPagination.skip,\n                  limit: hitPagination.limit,\n                  skip: hitPagination.skip,\n                },\n                nodes: bucket.hits,\n              } as SearchResult<any, any>",
                                                                  "start_token": 2094,
                                                                  "end_token": 2149,
                                                                  "children": [
                                                                    {
                                                                      "type": "ObjectLiteralExpression",
                                                                      "label": "{\n                pagination: {\n                  count: bucket.nids.length,\n                  hasMore:\n                    bucket.nids.length >\n                    hitPagination.limit + hitPagination.skip,\n                  limit: hitPagination.limit,\n                  skip: hitPagination.skip,\n                },\n                nodes: bucket.hits,\n              }",
                                                                      "start_token": 2094,
                                                                      "end_token": 2142,
                                                                      "children": [
                                                                        {
                                                                          "type": "PropertyAssignment",
                                                                          "label": "pagination: {\n                  count: bucket.nids.length,\n                  hasMore:\n                    bucket.nids.length >\n                    hitPagination.limit + hitPagination.skip,\n                  limit: hitPagination.limit,\n                  skip: hitPagination.skip,\n                }",
                                                                          "start_token": 2095,
                                                                          "end_token": 2134,
                                                                          "children": [
                                                                            {
                                                                              "type": "Identifier",
                                                                              "label": "pagination",
                                                                              "start_token": 2095,
                                                                              "end_token": 2095,
                                                                              "children": []
                                                                            },
                                                                            {
                                                                              "type": "ObjectLiteralExpression",
                                                                              "label": "{\n                  count: bucket.nids.length,\n                  hasMore:\n                    bucket.nids.length >\n                    hitPagination.limit + hitPagination.skip,\n                  limit: hitPagination.limit,\n                  skip: hitPagination.skip,\n                }",
                                                                              "start_token": 2097,
                                                                              "end_token": 2134,
                                                                              "children": [
                                                                                {
                                                                                  "type": "PropertyAssignment",
                                                                                  "label": "count: bucket.nids.length",
                                                                                  "start_token": 2098,
                                                                                  "end_token": 2104,
                                                                                  "children": [
                                                                                    {
                                                                                      "type": "Identifier",
                                                                                      "label": "count",
                                                                                      "start_token": 2098,
                                                                                      "end_token": 2098,
                                                                                      "children": []
                                                                                    },
                                                                                    {
                                                                                      "type": "PropertyAccessExpression",
                                                                                      "label": "bucket.nids.length",
                                                                                      "start_token": 2100,
                                                                                      "end_token": 2104,
                                                                                      "children": [
                                                                                        {
                                                                                          "type": "PropertyAccessExpression",
                                                                                          "label": "bucket.nids",
                                                                                          "start_token": 2100,
                                                                                          "end_token": 2102,
                                                                                          "children": [
                                                                                            {
                                                                                              "type": "Identifier",
                                                                                              "label": "bucket",
                                                                                              "start_token": 2100,
                                                                                              "end_token": 2100,
                                                                                              "children": []
                                                                                            },
                                                                                            {
                                                                                              "type": "Identifier",
                                                                                              "label": "nids",
                                                                                              "start_token": 2102,
                                                                                              "end_token": 2102,
                                                                                              "children": []
                                                                                            }
                                                                                          ]
                                                                                        },
                                                                                        {
                                                                                          "type": "Identifier",
                                                                                          "label": "length",
                                                                                          "start_token": 2104,
                                                                                          "end_token": 2104,
                                                                                          "children": []
                                                                                        }
                                                                                      ]
                                                                                    }
                                                                                  ]
                                                                                },
                                                                                {
                                                                                  "type": "PropertyAssignment",
                                                                                  "label": "hasMore:\n                    bucket.nids.length >\n                    hitPagination.limit + hitPagination.skip",
                                                                                  "start_token": 2106,
                                                                                  "end_token": 2120,
                                                                                  "children": [
                                                                                    {
                                                                                      "type": "Identifier",
                                                                                      "label": "hasMore",
                                                                                      "start_token": 2106,
                                                                                      "end_token": 2106,
                                                                                      "children": []
                                                                                    },
                                                                                    {
                                                                                      "type": "BinaryExpression",
                                                                                      "label": "bucket.nids.length >\n                    hitPagination.limit + hitPagination.skip",
                                                                                      "start_token": 2108,
                                                                                      "end_token": 2120,
                                                                                      "children": [
                                                                                        {
                                                                                          "type": "PropertyAccessExpression",
                                                                                          "label": "bucket.nids.length",
                                                                                          "start_token": 2108,
                                                                                          "end_token": 2112,
                                                                                          "children": [
                                                                                            {
                                                                                              "type": "PropertyAccessExpression",
                                                                                              "label": "bucket.nids",
                                                                                              "start_token": 2108,
                                                                                              "end_token": 2110,
                                                                                              "children": [
                                                                                                {
                                                                                                  "type": "Identifier",
                                                                                                  "label": "bucket",
                                                                                                  "start_token": 2108,
                                                                                                  "end_token": 2108,
                                                                                                  "children": []
                                                                                                },
                                                                                                {
                                                                                                  "type": "Identifier",
                                                                                                  "label": "nids",
                                                                                                  "start_token": 2110,
                                                                                                  "end_token": 2110,
                                                                                                  "children": []
                                                                                                }
                                                                                              ]
                                                                                            },
                                                                                            {
                                                                                              "type": "Identifier",
                                                                                              "label": "length",
                                                                                              "start_token": 2112,
                                                                                              "end_token": 2112,
                                                                                              "children": []
                                                                                            }
                                                                                          ]
                                                                                        },
                                                                                        {
                                                                                          "type": "GreaterThanToken",
                                                                                          "label": ">",
                                                                                          "start_token": 2113,
                                                                                          "end_token": 2113,
                                                                                          "children": []
                                                                                        },
                                                                                        {
                                                                                          "type": "BinaryExpression",
                                                                                          "label": "hitPagination.limit + hitPagination.skip",
                                                                                          "start_token": 2114,
                                                                                          "end_token": 2120,
                                                                                          "children": [
                                                                                            {
                                                                                              "type": "PropertyAccessExpression",
                                                                                              "label": "hitPagination.limit",
                                                                                              "start_token": 2114,
                                                                                              "end_token": 2116,
                                                                                              "children": [
                                                                                                {
                                                                                                  "type": "Identifier",
                                                                                                  "label": "hitPagination",
                                                                                                  "start_token": 2114,
                                                                                                  "end_token": 2114,
                                                                                                  "children": []
                                                                                                },
                                                                                                {
                                                                                                  "type": "Identifier",
                                                                                                  "label": "limit",
                                                                                                  "start_token": 2116,
                                                                                                  "end_token": 2116,
                                                                                                  "children": []
                                                                                                }
                                                                                              ]
                                                                                            },
                                                                                            {
                                                                                              "type": "PlusToken",
                                                                                              "label": "+",
                                                                                              "start_token": 2117,
                                                                                              "end_token": 2117,
                                                                                              "children": []
                                                                                            },
                                                                                            {
                                                                                              "type": "PropertyAccessExpression",
                                                                                              "label": "hitPagination.skip",
                                                                                              "start_token": 2118,
                                                                                              "end_token": 2120,
                                                                                              "children": [
                                                                                                {
                                                                                                  "type": "Identifier",
                                                                                                  "label": "hitPagination",
                                                                                                  "start_token": 2118,
                                                                                                  "end_token": 2118,
                                                                                                  "children": []
                                                                                                },
                                                                                                {
                                                                                                  "type": "Identifier",
                                                                                                  "label": "skip",
                                                                                                  "start_token": 2120,
                                                                                                  "end_token": 2120,
                                                                                                  "children": []
                                                                                                }
                                                                                              ]
                                                                                            }
                                                                                          ]
                                                                                        }
                                                                                      ]
                                                                                    }
                                                                                  ]
                                                                                },
                                                                                {
                                                                                  "type": "PropertyAssignment",
                                                                                  "label": "limit: hitPagination.limit",
                                                                                  "start_token": 2122,
                                                                                  "end_token": 2126,
                                                                                  "children": [
                                                                                    {
                                                                                      "type": "Identifier",
                                                                                      "label": "limit",
                                                                                      "start_token": 2122,
                                                                                      "end_token": 2122,
                                                                                      "children": []
                                                                                    },
                                                                                    {
                                                                                      "type": "PropertyAccessExpression",
                                                                                      "label": "hitPagination.limit",
                                                                                      "start_token": 2124,
                                                                                      "end_token": 2126,
                                                                                      "children": [
                                                                                        {
                                                                                          "type": "Identifier",
                                                                                          "label": "hitPagination",
                                                                                          "start_token": 2124,
                                                                                          "end_token": 2124,
                                                                                          "children": []
                                                                                        },
                                                                                        {
                                                                                          "type": "Identifier",
                                                                                          "label": "limit",
                                                                                          "start_token": 2126,
                                                                                          "end_token": 2126,
                                                                                          "children": []
                                                                                        }
                                                                                      ]
                                                                                    }
                                                                                  ]
                                                                                },
                                                                                {
                                                                                  "type": "PropertyAssignment",
                                                                                  "label": "skip: hitPagination.skip",
                                                                                  "start_token": 2128,
                                                                                  "end_token": 2132,
                                                                                  "children": [
                                                                                    {
                                                                                      "type": "Identifier",
                                                                                      "label": "skip",
                                                                                      "start_token": 2128,
                                                                                      "end_token": 2128,
                                                                                      "children": []
                                                                                    },
                                                                                    {
                                                                                      "type": "PropertyAccessExpression",
                                                                                      "label": "hitPagination.skip",
                                                                                      "start_token": 2130,
                                                                                      "end_token": 2132,
                                                                                      "children": [
                                                                                        {
                                                                                          "type": "Identifier",
                                                                                          "label": "hitPagination",
                                                                                          "start_token": 2130,
                                                                                          "end_token": 2130,
                                                                                          "children": []
                                                                                        },
                                                                                        {
                                                                                          "type": "Identifier",
                                                                                          "label": "skip",
                                                                                          "start_token": 2132,
                                                                                          "end_token": 2132,
                                                                                          "children": []
                                                                                        }
                                                                                      ]
                                                                                    }
                                                                                  ]
                                                                                }
                                                                              ]
                                                                            }
                                                                          ]
                                                                        },
                                                                        {
                                                                          "type": "PropertyAssignment",
                                                                          "label": "nodes: bucket.hits",
                                                                          "start_token": 2136,
                                                                          "end_token": 2140,
                                                                          "children": [
                                                                            {
                                                                              "type": "Identifier",
                                                                              "label": "nodes",
                                                                              "start_token": 2136,
                                                                              "end_token": 2136,
                                                                              "children": []
                                                                            },
                                                                            {
                                                                              "type": "PropertyAccessExpression",
                                                                              "label": "bucket.hits",
                                                                              "start_token": 2138,
                                                                              "end_token": 2140,
                                                                              "children": [
                                                                                {
                                                                                  "type": "Identifier",
                                                                                  "label": "bucket",
                                                                                  "start_token": 2138,
                                                                                  "end_token": 2138,
                                                                                  "children": []
                                                                                },
                                                                                {
                                                                                  "type": "Identifier",
                                                                                  "label": "hits",
                                                                                  "start_token": 2140,
                                                                                  "end_token": 2140,
                                                                                  "children": []
                                                                                }
                                                                              ]
                                                                            }
                                                                          ]
                                                                        }
                                                                      ]
                                                                    },
                                                                    {
                                                                      "type": "TypeReference",
                                                                      "label": "SearchResult<any, any>",
                                                                      "start_token": 2144,
                                                                      "end_token": 2149,
                                                                      "children": [
                                                                        {
                                                                          "type": "Identifier",
                                                                          "label": "SearchResult",
                                                                          "start_token": 2144,
                                                                          "end_token": 2144,
                                                                          "children": []
                                                                        },
                                                                        {
                                                                          "type": "AnyKeyword",
                                                                          "label": "any",
                                                                          "start_token": 2146,
                                                                          "end_token": 2146,
                                                                          "children": []
                                                                        },
                                                                        {
                                                                          "type": "AnyKeyword",
                                                                          "label": "any",
                                                                          "start_token": 2148,
                                                                          "end_token": 2148,
                                                                          "children": []
                                                                        }
                                                                      ]
                                                                    }
                                                                  ]
                                                                }
                                                              ]
                                                            }
                                                          ]
                                                        }
                                                      ]
                                                    }
                                                  ]
                                                },
                                                {
                                                  "type": "ReturnStatement",
                                                  "label": "return result;",
                                                  "start_token": 2152,
                                                  "end_token": 2154,
                                                  "children": [
                                                    {
                                                      "type": "Identifier",
                                                      "label": "result",
                                                      "start_token": 2153,
                                                      "end_token": 2153,
                                                      "children": []
                                                    }
                                                  ]
                                                }
                                              ]
                                            }
                                          ]
                                        }
                                      ]
                                    }
                                  ]
                                },
                                {
                                  "type": "PropertyAssignment",
                                  "label": "pagination: {\n          count: buckets.length,\n          hasMore: buckets.length > pagination.limit + pagination.skip,\n          limit: pagination.limit,\n          skip: pagination.skip,\n        }",
                                  "start_token": 2158,
                                  "end_token": 2193,
                                  "children": [
                                    {
                                      "type": "Identifier",
                                      "label": "pagination",
                                      "start_token": 2158,
                                      "end_token": 2158,
                                      "children": []
                                    },
                                    {
                                      "type": "ObjectLiteralExpression",
                                      "label": "{\n          count: buckets.length,\n          hasMore: buckets.length > pagination.limit + pagination.skip,\n          limit: pagination.limit,\n          skip: pagination.skip,\n        }",
                                      "start_token": 2160,
                                      "end_token": 2193,
                                      "children": [
                                        {
                                          "type": "PropertyAssignment",
                                          "label": "count: buckets.length",
                                          "start_token": 2161,
                                          "end_token": 2165,
                                          "children": [
                                            {
                                              "type": "Identifier",
                                              "label": "count",
                                              "start_token": 2161,
                                              "end_token": 2161,
                                              "children": []
                                            },
                                            {
                                              "type": "PropertyAccessExpression",
                                              "label": "buckets.length",
                                              "start_token": 2163,
                                              "end_token": 2165,
                                              "children": [
                                                {
                                                  "type": "Identifier",
                                                  "label": "buckets",
                                                  "start_token": 2163,
                                                  "end_token": 2163,
                                                  "children": []
                                                },
                                                {
                                                  "type": "Identifier",
                                                  "label": "length",
                                                  "start_token": 2165,
                                                  "end_token": 2165,
                                                  "children": []
                                                }
                                              ]
                                            }
                                          ]
                                        },
                                        {
                                          "type": "PropertyAssignment",
                                          "label": "hasMore: buckets.length > pagination.limit + pagination.skip",
                                          "start_token": 2167,
                                          "end_token": 2179,
                                          "children": [
                                            {
                                              "type": "Identifier",
                                              "label": "hasMore",
                                              "start_token": 2167,
                                              "end_token": 2167,
                                              "children": []
                                            },
                                            {
                                              "type": "BinaryExpression",
                                              "label": "buckets.length > pagination.limit + pagination.skip",
                                              "start_token": 2169,
                                              "end_token": 2179,
                                              "children": [
                                                {
                                                  "type": "PropertyAccessExpression",
                                                  "label": "buckets.length",
                                                  "start_token": 2169,
                                                  "end_token": 2171,
                                                  "children": [
                                                    {
                                                      "type": "Identifier",
                                                      "label": "buckets",
                                                      "start_token": 2169,
                                                      "end_token": 2169,
                                                      "children": []
                                                    },
                                                    {
                                                      "type": "Identifier",
                                                      "label": "length",
                                                      "start_token": 2171,
                                                      "end_token": 2171,
                                                      "children": []
                                                    }
                                                  ]
                                                },
                                                {
                                                  "type": "GreaterThanToken",
                                                  "label": ">",
                                                  "start_token": 2172,
                                                  "end_token": 2172,
                                                  "children": []
                                                },
                                                {
                                                  "type": "BinaryExpression",
                                                  "label": "pagination.limit + pagination.skip",
                                                  "start_token": 2173,
                                                  "end_token": 2179,
                                                  "children": [
                                                    {
                                                      "type": "PropertyAccessExpression",
                                                      "label": "pagination.limit",
                                                      "start_token": 2173,
                                                      "end_token": 2175,
                                                      "children": [
                                                        {
                                                          "type": "Identifier",
                                                          "label": "pagination",
                                                          "start_token": 2173,
                                                          "end_token": 2173,
                                                          "children": []
                                                        },
                                                        {
                                                          "type": "Identifier",
                                                          "label": "limit",
                                                          "start_token": 2175,
                                                          "end_token": 2175,
                                                          "children": []
                                                        }
                                                      ]
                                                    },
                                                    {
                                                      "type": "PlusToken",
                                                      "label": "+",
                                                      "start_token": 2176,
                                                      "end_token": 2176,
                                                      "children": []
                                                    },
                                                    {
                                                      "type": "PropertyAccessExpression",
                                                      "label": "pagination.skip",
                                                      "start_token": 2177,
                                                      "end_token": 2179,
                                                      "children": [
                                                        {
                                                          "type": "Identifier",
                                                          "label": "pagination",
                                                          "start_token": 2177,
                                                          "end_token": 2177,
                                                          "children": []
                                                        },
                                                        {
                                                          "type": "Identifier",
                                                          "label": "skip",
                                                          "start_token": 2179,
                                                          "end_token": 2179,
                                                          "children": []
                                                        }
                                                      ]
                                                    }
                                                  ]
                                                }
                                              ]
                                            }
                                          ]
                                        },
                                        {
                                          "type": "PropertyAssignment",
                                          "label": "limit: pagination.limit",
                                          "start_token": 2181,
                                          "end_token": 2185,
                                          "children": [
                                            {
                                              "type": "Identifier",
                                              "label": "limit",
                                              "start_token": 2181,
                                              "end_token": 2181,
                                              "children": []
                                            },
                                            {
                                              "type": "PropertyAccessExpression",
                                              "label": "pagination.limit",
                                              "start_token": 2183,
                                              "end_token": 2185,
                                              "children": [
                                                {
                                                  "type": "Identifier",
                                                  "label": "pagination",
                                                  "start_token": 2183,
                                                  "end_token": 2183,
                                                  "children": []
                                                },
                                                {
                                                  "type": "Identifier",
                                                  "label": "limit",
                                                  "start_token": 2185,
                                                  "end_token": 2185,
                                                  "children": []
                                                }
                                              ]
                                            }
                                          ]
                                        },
                                        {
                                          "type": "PropertyAssignment",
                                          "label": "skip: pagination.skip",
                                          "start_token": 2187,
                                          "end_token": 2191,
                                          "children": [
                                            {
                                              "type": "Identifier",
                                              "label": "skip",
                                              "start_token": 2187,
                                              "end_token": 2187,
                                              "children": []
                                            },
                                            {
                                              "type": "PropertyAccessExpression",
                                              "label": "pagination.skip",
                                              "start_token": 2189,
                                              "end_token": 2191,
                                              "children": [
                                                {
                                                  "type": "Identifier",
                                                  "label": "pagination",
                                                  "start_token": 2189,
                                                  "end_token": 2189,
                                                  "children": []
                                                },
                                                {
                                                  "type": "Identifier",
                                                  "label": "skip",
                                                  "start_token": 2191,
                                                  "end_token": 2191,
                                                  "children": []
                                                }
                                              ]
                                            }
                                          ]
                                        }
                                      ]
                                    }
                                  ]
                                }
                              ]
                            }
                          ]
                        }
                      ]
                    },
                    {
                      "type": "Block",
                      "label": "{\n      const endTime = performance.now();\n      if (BUILD_CONFIG.debug) {\n        performance.measure(\n          `[IndexedDB Indexer] Aggregate (${this.databaseName})`,\n          {\n            detail: { query, field, options },\n            start: startTime,\n            end: endTime,\n          }\n        );\n      }\n      logger.debug(\n        `[indexer ${this.databaseName}] aggregate`,\n        endTime - startTime,\n        'ms'\n      );\n    }",
                      "start_token": 2199,
                      "end_token": 2258,
                      "children": [
                        {
                          "type": "FirstStatement",
                          "label": "const endTime = performance.now();",
                          "start_token": 2200,
                          "end_token": 2208,
                          "children": [
                            {
                              "type": "VariableDeclarationList",
                              "label": "const endTime = performance.now()",
                              "start_token": 2200,
                              "end_token": 2207,
                              "children": [
                                {
                                  "type": "VariableDeclaration",
                                  "label": "endTime = performance.now()",
                                  "start_token": 2201,
                                  "end_token": 2207,
                                  "children": [
                                    {
                                      "type": "Identifier",
                                      "label": "endTime",
                                      "start_token": 2201,
                                      "end_token": 2201,
                                      "children": []
                                    },
                                    {
                                      "type": "CallExpression",
                                      "label": "performance.now()",
                                      "start_token": 2203,
                                      "end_token": 2207,
                                      "children": [
                                        {
                                          "type": "PropertyAccessExpression",
                                          "label": "performance.now",
                                          "start_token": 2203,
                                          "end_token": 2205,
                                          "children": [
                                            {
                                              "type": "Identifier",
                                              "label": "performance",
                                              "start_token": 2203,
                                              "end_token": 2203,
                                              "children": []
                                            },
                                            {
                                              "type": "Identifier",
                                              "label": "now",
                                              "start_token": 2205,
                                              "end_token": 2205,
                                              "children": []
                                            }
                                          ]
                                        }
                                      ]
                                    }
                                  ]
                                }
                              ]
                            }
                          ]
                        },
                        {
                          "type": "IfStatement",
                          "label": "if (BUILD_CONFIG.debug) {\n        performance.measure(\n          `[IndexedDB Indexer] Aggregate (${this.databaseName})`,\n          {\n            detail: { query, field, options },\n            start: startTime,\n            end: endTime,\n          }\n        );\n      }",
                          "start_token": 2209,
                          "end_token": 2244,
                          "children": [
                            {
                              "type": "PropertyAccessExpression",
                              "label": "BUILD_CONFIG.debug",
                              "start_token": 2211,
                              "end_token": 2213,
                              "children": [
                                {
                                  "type": "Identifier",
                                  "label": "BUILD_CONFIG",
                                  "start_token": 2211,
                                  "end_token": 2211,
                                  "children": []
                                },
                                {
                                  "type": "Identifier",
                                  "label": "debug",
                                  "start_token": 2213,
                                  "end_token": 2213,
                                  "children": []
                                }
                              ]
                            },
                            {
                              "type": "Block",
                              "label": "{\n        performance.measure(\n          `[IndexedDB Indexer] Aggregate (${this.databaseName})`,\n          {\n            detail: { query, field, options },\n            start: startTime,\n            end: endTime,\n          }\n        );\n      }",
                              "start_token": 2215,
                              "end_token": 2244,
                              "children": [
                                {
                                  "type": "ExpressionStatement",
                                  "label": "performance.measure(\n          `[IndexedDB Indexer] Aggregate (${this.databaseName})`,\n          {\n            detail: { query, field, options },\n            start: startTime,\n            end: endTime,\n          }\n        );",
                                  "start_token": 2216,
                                  "end_token": 2243,
                                  "children": [
                                    {
                                      "type": "CallExpression",
                                      "label": "performance.measure(\n          `[IndexedDB Indexer] Aggregate (${this.databaseName})`,\n          {\n            detail: { query, field, options },\n            start: startTime,\n            end: endTime,\n          }\n        )",
                                      "start_token": 2216,
                                      "end_token": 2242,
                                      "children": [
                                        {
                                          "type": "PropertyAccessExpression",
                                          "label": "performance.measure",
                                          "start_token": 2216,
                                          "end_token": 2218,
                                          "children": [
                                            {
                                              "type": "Identifier",
                                              "label": "performance",
                                              "start_token": 2216,
                                              "end_token": 2216,
                                              "children": []
                                            },
                                            {
                                              "type": "Identifier",
                                              "label": "measure",
                                              "start_token": 2218,
                                              "end_token": 2218,
                                              "children": []
                                            }
                                          ]
                                        },
                                        {
                                          "type": "TemplateExpression",
                                          "label": "`[IndexedDB Indexer] Aggregate (${this.databaseName})`",
                                          "start_token": 2220,
                                          "end_token": 2220,
                                          "children": [
                                            {
                                              "type": "TemplateHead",
                                              "label": "`[IndexedDB Indexer] Aggregate (${",
                                              "start_token": 2220,
                                              "end_token": 2220,
                                              "children": []
                                            },
                                            {
                                              "type": "TemplateSpan",
                                              "label": "this.databaseName})`",
                                              "start_token": 2220,
                                              "end_token": 2220,
                                              "children": [
                                                {
                                                  "type": "PropertyAccessExpression",
                                                  "label": "this.databaseName",
                                                  "start_token": 2220,
                                                  "end_token": 2220,
                                                  "children": [
                                                    {
                                                      "type": "ThisKeyword",
                                                      "label": "this",
                                                      "start_token": 2220,
                                                      "end_token": 2220,
                                                      "children": []
                                                    },
                                                    {
                                                      "type": "Identifier",
                                                      "label": "databaseName",
                                                      "start_token": 2220,
                                                      "end_token": 2220,
                                                      "children": []
                                                    }
                                                  ]
                                                },
                                                {
                                                  "type": "LastTemplateToken",
                                                  "label": "})`",
                                                  "start_token": 2220,
                                                  "end_token": 2220,
                                                  "children": []
                                                }
                                              ]
                                            }
                                          ]
                                        },
                                        {
                                          "type": "ObjectLiteralExpression",
                                          "label": "{\n            detail: { query, field, options },\n            start: startTime,\n            end: endTime,\n          }",
                                          "start_token": 2222,
                                          "end_token": 2241,
                                          "children": [
                                            {
                                              "type": "PropertyAssignment",
                                              "label": "detail: { query, field, options }",
                                              "start_token": 2223,
                                              "end_token": 2231,
                                              "children": [
                                                {
                                                  "type": "Identifier",
                                                  "label": "detail",
                                                  "start_token": 2223,
                                                  "end_token": 2223,
                                                  "children": []
                                                },
                                                {
                                                  "type": "ObjectLiteralExpression",
                                                  "label": "{ query, field, options }",
                                                  "start_token": 2225,
                                                  "end_token": 2231,
                                                  "children": [
                                                    {
                                                      "type": "ShorthandPropertyAssignment",
                                                      "label": "query",
                                                      "start_token": 2226,
                                                      "end_token": 2226,
                                                      "children": [
                                                        {
                                                          "type": "Identifier",
                                                          "label": "query",
                                                          "start_token": 2226,
                                                          "end_token": 2226,
                                                          "children": []
                                                        }
                                                      ]
                                                    },
                                                    {
                                                      "type": "ShorthandPropertyAssignment",
                                                      "label": "field",
                                                      "start_token": 2228,
                                                      "end_token": 2228,
                                                      "children": [
                                                        {
                                                          "type": "Identifier",
                                                          "label": "field",
                                                          "start_token": 2228,
                                                          "end_token": 2228,
                                                          "children": []
                                                        }
                                                      ]
                                                    },
                                                    {
                                                      "type": "ShorthandPropertyAssignment",
                                                      "label": "options",
                                                      "start_token": 2230,
                                                      "end_token": 2230,
                                                      "children": [
                                                        {
                                                          "type": "Identifier",
                                                          "label": "options",
                                                          "start_token": 2230,
                                                          "end_token": 2230,
                                                          "children": []
                                                        }
                                                      ]
                                                    }
                                                  ]
                                                }
                                              ]
                                            },
                                            {
                                              "type": "PropertyAssignment",
                                              "label": "start: startTime",
                                              "start_token": 2233,
                                              "end_token": 2235,
                                              "children": [
                                                {
                                                  "type": "Identifier",
                                                  "label": "start",
                                                  "start_token": 2233,
                                                  "end_token": 2233,
                                                  "children": []
                                                },
                                                {
                                                  "type": "Identifier",
                                                  "label": "startTime",
                                                  "start_token": 2235,
                                                  "end_token": 2235,
                                                  "children": []
                                                }
                                              ]
                                            },
                                            {
                                              "type": "PropertyAssignment",
                                              "label": "end: endTime",
                                              "start_token": 2237,
                                              "end_token": 2239,
                                              "children": [
                                                {
                                                  "type": "Identifier",
                                                  "label": "end",
                                                  "start_token": 2237,
                                                  "end_token": 2237,
                                                  "children": []
                                                },
                                                {
                                                  "type": "Identifier",
                                                  "label": "endTime",
                                                  "start_token": 2239,
                                                  "end_token": 2239,
                                                  "children": []
                                                }
                                              ]
                                            }
                                          ]
                                        }
                                      ]
                                    }
                                  ]
                                }
                              ]
                            }
                          ]
                        },
                        {
                          "type": "ExpressionStatement",
                          "label": "logger.debug(\n        `[indexer ${this.databaseName}] aggregate`,\n        endTime - startTime,\n        'ms'\n      );",
                          "start_token": 2245,
                          "end_token": 2257,
                          "children": [
                            {
                              "type": "CallExpression",
                              "label": "logger.debug(\n        `[indexer ${this.databaseName}] aggregate`,\n        endTime - startTime,\n        'ms'\n      )",
                              "start_token": 2245,
                              "end_token": 2256,
                              "children": [
                                {
                                  "type": "PropertyAccessExpression",
                                  "label": "logger.debug",
                                  "start_token": 2245,
                                  "end_token": 2247,
                                  "children": [
                                    {
                                      "type": "Identifier",
                                      "label": "logger",
                                      "start_token": 2245,
                                      "end_token": 2245,
                                      "children": []
                                    },
                                    {
                                      "type": "Identifier",
                                      "label": "debug",
                                      "start_token": 2247,
                                      "end_token": 2247,
                                      "children": []
                                    }
                                  ]
                                },
                                {
                                  "type": "TemplateExpression",
                                  "label": "`[indexer ${this.databaseName}] aggregate`",
                                  "start_token": 2249,
                                  "end_token": 2249,
                                  "children": [
                                    {
                                      "type": "TemplateHead",
                                      "label": "`[indexer ${",
                                      "start_token": 2249,
                                      "end_token": 2249,
                                      "children": []
                                    },
                                    {
                                      "type": "TemplateSpan",
                                      "label": "this.databaseName}] aggregate`",
                                      "start_token": 2249,
                                      "end_token": 2249,
                                      "children": [
                                        {
                                          "type": "PropertyAccessExpression",
                                          "label": "this.databaseName",
                                          "start_token": 2249,
                                          "end_token": 2249,
                                          "children": [
                                            {
                                              "type": "ThisKeyword",
                                              "label": "this",
                                              "start_token": 2249,
                                              "end_token": 2249,
                                              "children": []
                                            },
                                            {
                                              "type": "Identifier",
                                              "label": "databaseName",
                                              "start_token": 2249,
                                              "end_token": 2249,
                                              "children": []
                                            }
                                          ]
                                        },
                                        {
                                          "type": "LastTemplateToken",
                                          "label": "}] aggregate`",
                                          "start_token": 2249,
                                          "end_token": 2249,
                                          "children": []
                                        }
                                      ]
                                    }
                                  ]
                                },
                                {
                                  "type": "BinaryExpression",
                                  "label": "endTime - startTime",
                                  "start_token": 2251,
                                  "end_token": 2253,
                                  "children": [
                                    {
                                      "type": "Identifier",
                                      "label": "endTime",
                                      "start_token": 2251,
                                      "end_token": 2251,
                                      "children": []
                                    },
                                    {
                                      "type": "MinusToken",
                                      "label": "-",
                                      "start_token": 2252,
                                      "end_token": 2252,
                                      "children": []
                                    },
                                    {
                                      "type": "Identifier",
                                      "label": "startTime",
                                      "start_token": 2253,
                                      "end_token": 2253,
                                      "children": []
                                    }
                                  ]
                                },
                                {
                                  "type": "StringLiteral",
                                  "label": "'ms'",
                                  "start_token": 2255,
                                  "end_token": 2255,
                                  "children": []
                                }
                              ]
                            }
                          ]
                        }
                      ]
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "type": "MethodDeclaration",
          "label": "async getAll(\n    trx: DataStructROTransaction,\n    ids?: string[]\n  ): Promise<Document[]> {\n    const docs = [];\n    if (ids) {\n      for (const id of ids) {\n        const record = await trx.objectStore('records').index('id').get(id);\n        if (record) {\n          docs.push(Document.from(record.id, record.data));\n        }\n      }\n    } else {\n      const records = await trx.objectStore('records').getAll();\n      for (const record of records) {\n        docs.push(Document.from(record.id, record.data));\n      }\n    }\n    return docs;\n  }",
          "start_token": 2260,
          "end_token": 2396,
          "children": [
            {
              "type": "AsyncKeyword",
              "label": "async",
              "start_token": 2260,
              "end_token": 2260,
              "children": []
            },
            {
              "type": "Identifier",
              "label": "getAll",
              "start_token": 2261,
              "end_token": 2261,
              "children": []
            },
            {
              "type": "Parameter",
              "label": "trx: DataStructROTransaction",
              "start_token": 2263,
              "end_token": 2265,
              "children": [
                {
                  "type": "Identifier",
                  "label": "trx",
                  "start_token": 2263,
                  "end_token": 2263,
                  "children": []
                },
                {
                  "type": "TypeReference",
                  "label": "DataStructROTransaction",
                  "start_token": 2265,
                  "end_token": 2265,
                  "children": [
                    {
                      "type": "Identifier",
                      "label": "DataStructROTransaction",
                      "start_token": 2265,
                      "end_token": 2265,
                      "children": []
                    }
                  ]
                }
              ]
            },
            {
              "type": "Parameter",
              "label": "ids?: string[]",
              "start_token": 2267,
              "end_token": 2272,
              "children": [
                {
                  "type": "Identifier",
                  "label": "ids",
                  "start_token": 2267,
                  "end_token": 2267,
                  "children": []
                },
                {
                  "type": "QuestionToken",
                  "label": "?",
                  "start_token": 2268,
                  "end_token": 2268,
                  "children": []
                },
                {
                  "type": "ArrayType",
                  "label": "string[]",
                  "start_token": 2270,
                  "end_token": 2272,
                  "children": [
                    {
                      "type": "StringKeyword",
                      "label": "string",
                      "start_token": 2270,
                      "end_token": 2270,
                      "children": []
                    }
                  ]
                }
              ]
            },
            {
              "type": "TypeReference",
              "label": "Promise<Document[]>",
              "start_token": 2275,
              "end_token": 2280,
              "children": [
                {
                  "type": "Identifier",
                  "label": "Promise",
                  "start_token": 2275,
                  "end_token": 2275,
                  "children": []
                },
                {
                  "type": "ArrayType",
                  "label": "Document[]",
                  "start_token": 2277,
                  "end_token": 2279,
                  "children": [
                    {
                      "type": "TypeReference",
                      "label": "Document",
                      "start_token": 2277,
                      "end_token": 2277,
                      "children": [
                        {
                          "type": "Identifier",
                          "label": "Document",
                          "start_token": 2277,
                          "end_token": 2277,
                          "children": []
                        }
                      ]
                    }
                  ]
                }
              ]
            },
            {
              "type": "Block",
              "label": "{\n    const docs = [];\n    if (ids) {\n      for (const id of ids) {\n        const record = await trx.objectStore('records').index('id').get(id);\n        if (record) {\n          docs.push(Document.from(record.id, record.data));\n        }\n      }\n    } else {\n      const records = await trx.objectStore('records').getAll();\n      for (const record of records) {\n        docs.push(Document.from(record.id, record.data));\n      }\n    }\n    return docs;\n  }",
              "start_token": 2281,
              "end_token": 2396,
              "children": [
                {
                  "type": "FirstStatement",
                  "label": "const docs = [];",
                  "start_token": 2282,
                  "end_token": 2287,
                  "children": [
                    {
                      "type": "VariableDeclarationList",
                      "label": "const docs = []",
                      "start_token": 2282,
                      "end_token": 2286,
                      "children": [
                        {
                          "type": "VariableDeclaration",
                          "label": "docs = []",
                          "start_token": 2283,
                          "end_token": 2286,
                          "children": [
                            {
                              "type": "Identifier",
                              "label": "docs",
                              "start_token": 2283,
                              "end_token": 2283,
                              "children": []
                            },
                            {
                              "type": "ArrayLiteralExpression",
                              "label": "[]",
                              "start_token": 2285,
                              "end_token": 2286,
                              "children": []
                            }
                          ]
                        }
                      ]
                    }
                  ]
                },
                {
                  "type": "IfStatement",
                  "label": "if (ids) {\n      for (const id of ids) {\n        const record = await trx.objectStore('records').index('id').get(id);\n        if (record) {\n          docs.push(Document.from(record.id, record.data));\n        }\n      }\n    } else {\n      const records = await trx.objectStore('records').getAll();\n      for (const record of records) {\n        docs.push(Document.from(record.id, record.data));\n      }\n    }",
                  "start_token": 2288,
                  "end_token": 2392,
                  "children": [
                    {
                      "type": "Identifier",
                      "label": "ids",
                      "start_token": 2290,
                      "end_token": 2290,
                      "children": []
                    },
                    {
                      "type": "Block",
                      "label": "{\n      for (const id of ids) {\n        const record = await trx.objectStore('records').index('id').get(id);\n        if (record) {\n          docs.push(Document.from(record.id, record.data));\n        }\n      }\n    }",
                      "start_token": 2292,
                      "end_token": 2347,
                      "children": [
                        {
                          "type": "ForOfStatement",
                          "label": "for (const id of ids) {\n        const record = await trx.objectStore('records').index('id').get(id);\n        if (record) {\n          docs.push(Document.from(record.id, record.data));\n        }\n      }",
                          "start_token": 2293,
                          "end_token": 2346,
                          "children": [
                            {
                              "type": "VariableDeclarationList",
                              "label": "const id",
                              "start_token": 2295,
                              "end_token": 2296,
                              "children": [
                                {
                                  "type": "VariableDeclaration",
                                  "label": "id",
                                  "start_token": 2296,
                                  "end_token": 2296,
                                  "children": [
                                    {
                                      "type": "Identifier",
                                      "label": "id",
                                      "start_token": 2296,
                                      "end_token": 2296,
                                      "children": []
                                    }
                                  ]
                                }
                              ]
                            },
                            {
                              "type": "Identifier",
                              "label": "ids",
                              "start_token": 2298,
                              "end_token": 2298,
                              "children": []
                            },
                            {
                              "type": "Block",
                              "label": "{\n        const record = await trx.objectStore('records').index('id').get(id);\n        if (record) {\n          docs.push(Document.from(record.id, record.data));\n        }\n      }",
                              "start_token": 2300,
                              "end_token": 2346,
                              "children": [
                                {
                                  "type": "FirstStatement",
                                  "label": "const record = await trx.objectStore('records').index('id').get(id);",
                                  "start_token": 2301,
                                  "end_token": 2321,
                                  "children": [
                                    {
                                      "type": "VariableDeclarationList",
                                      "label": "const record = await trx.objectStore('records').index('id').get(id)",
                                      "start_token": 2301,
                                      "end_token": 2320,
                                      "children": [
                                        {
                                          "type": "VariableDeclaration",
                                          "label": "record = await trx.objectStore('records').index('id').get(id)",
                                          "start_token": 2302,
                                          "end_token": 2320,
                                          "children": [
                                            {
                                              "type": "Identifier",
                                              "label": "record",
                                              "start_token": 2302,
                                              "end_token": 2302,
                                              "children": []
                                            },
                                            {
                                              "type": "AwaitExpression",
                                              "label": "await trx.objectStore('records').index('id').get(id)",
                                              "start_token": 2304,
                                              "end_token": 2320,
                                              "children": [
                                                {
                                                  "type": "CallExpression",
                                                  "label": "trx.objectStore('records').index('id').get(id)",
                                                  "start_token": 2305,
                                                  "end_token": 2320,
                                                  "children": [
                                                    {
                                                      "type": "PropertyAccessExpression",
                                                      "label": "trx.objectStore('records').index('id').get",
                                                      "start_token": 2305,
                                                      "end_token": 2317,
                                                      "children": [
                                                        {
                                                          "type": "CallExpression",
                                                          "label": "trx.objectStore('records').index('id')",
                                                          "start_token": 2305,
                                                          "end_token": 2315,
                                                          "children": [
                                                            {
                                                              "type": "PropertyAccessExpression",
                                                              "label": "trx.objectStore('records').index",
                                                              "start_token": 2305,
                                                              "end_token": 2312,
                                                              "children": [
                                                                {
                                                                  "type": "CallExpression",
                                                                  "label": "trx.objectStore('records')",
                                                                  "start_token": 2305,
                                                                  "end_token": 2310,
                                                                  "children": [
                                                                    {
                                                                      "type": "PropertyAccessExpression",
                                                                      "label": "trx.objectStore",
                                                                      "start_token": 2305,
                                                                      "end_token": 2307,
                                                                      "children": [
                                                                        {
                                                                          "type": "Identifier",
                                                                          "label": "trx",
                                                                          "start_token": 2305,
                                                                          "end_token": 2305,
                                                                          "children": []
                                                                        },
                                                                        {
                                                                          "type": "Identifier",
                                                                          "label": "objectStore",
                                                                          "start_token": 2307,
                                                                          "end_token": 2307,
                                                                          "children": []
                                                                        }
                                                                      ]
                                                                    },
                                                                    {
                                                                      "type": "StringLiteral",
                                                                      "label": "'records'",
                                                                      "start_token": 2309,
                                                                      "end_token": 2309,
                                                                      "children": []
                                                                    }
                                                                  ]
                                                                },
                                                                {
                                                                  "type": "Identifier",
                                                                  "label": "index",
                                                                  "start_token": 2312,
                                                                  "end_token": 2312,
                                                                  "children": []
                                                                }
                                                              ]
                                                            },
                                                            {
                                                              "type": "StringLiteral",
                                                              "label": "'id'",
                                                              "start_token": 2314,
                                                              "end_token": 2314,
                                                              "children": []
                                                            }
                                                          ]
                                                        },
                                                        {
                                                          "type": "Identifier",
                                                          "label": "get",
                                                          "start_token": 2317,
                                                          "end_token": 2317,
                                                          "children": []
                                                        }
                                                      ]
                                                    },
                                                    {
                                                      "type": "Identifier",
                                                      "label": "id",
                                                      "start_token": 2319,
                                                      "end_token": 2319,
                                                      "children": []
                                                    }
                                                  ]
                                                }
                                              ]
                                            }
                                          ]
                                        }
                                      ]
                                    }
                                  ]
                                },
                                {
                                  "type": "IfStatement",
                                  "label": "if (record) {\n          docs.push(Document.from(record.id, record.data));\n        }",
                                  "start_token": 2322,
                                  "end_token": 2345,
                                  "children": [
                                    {
                                      "type": "Identifier",
                                      "label": "record",
                                      "start_token": 2324,
                                      "end_token": 2324,
                                      "children": []
                                    },
                                    {
                                      "type": "Block",
                                      "label": "{\n          docs.push(Document.from(record.id, record.data));\n        }",
                                      "start_token": 2326,
                                      "end_token": 2345,
                                      "children": [
                                        {
                                          "type": "ExpressionStatement",
                                          "label": "docs.push(Document.from(record.id, record.data));",
                                          "start_token": 2327,
                                          "end_token": 2344,
                                          "children": [
                                            {
                                              "type": "CallExpression",
                                              "label": "docs.push(Document.from(record.id, record.data))",
                                              "start_token": 2327,
                                              "end_token": 2343,
                                              "children": [
                                                {
                                                  "type": "PropertyAccessExpression",
                                                  "label": "docs.push",
                                                  "start_token": 2327,
                                                  "end_token": 2329,
                                                  "children": [
                                                    {
                                                      "type": "Identifier",
                                                      "label": "docs",
                                                      "start_token": 2327,
                                                      "end_token": 2327,
                                                      "children": []
                                                    },
                                                    {
                                                      "type": "Identifier",
                                                      "label": "push",
                                                      "start_token": 2329,
                                                      "end_token": 2329,
                                                      "children": []
                                                    }
                                                  ]
                                                },
                                                {
                                                  "type": "CallExpression",
                                                  "label": "Document.from(record.id, record.data)",
                                                  "start_token": 2331,
                                                  "end_token": 2342,
                                                  "children": [
                                                    {
                                                      "type": "PropertyAccessExpression",
                                                      "label": "Document.from",
                                                      "start_token": 2331,
                                                      "end_token": 2333,
                                                      "children": [
                                                        {
                                                          "type": "Identifier",
                                                          "label": "Document",
                                                          "start_token": 2331,
                                                          "end_token": 2331,
                                                          "children": []
                                                        },
                                                        {
                                                          "type": "Identifier",
                                                          "label": "from",
                                                          "start_token": 2333,
                                                          "end_token": 2333,
                                                          "children": []
                                                        }
                                                      ]
                                                    },
                                                    {
                                                      "type": "PropertyAccessExpression",
                                                      "label": "record.id",
                                                      "start_token": 2335,
                                                      "end_token": 2337,
                                                      "children": [
                                                        {
                                                          "type": "Identifier",
                                                          "label": "record",
                                                          "start_token": 2335,
                                                          "end_token": 2335,
                                                          "children": []
                                                        },
                                                        {
                                                          "type": "Identifier",
                                                          "label": "id",
                                                          "start_token": 2337,
                                                          "end_token": 2337,
                                                          "children": []
                                                        }
                                                      ]
                                                    },
                                                    {
                                                      "type": "PropertyAccessExpression",
                                                      "label": "record.data",
                                                      "start_token": 2339,
                                                      "end_token": 2341,
                                                      "children": [
                                                        {
                                                          "type": "Identifier",
                                                          "label": "record",
                                                          "start_token": 2339,
                                                          "end_token": 2339,
                                                          "children": []
                                                        },
                                                        {
                                                          "type": "Identifier",
                                                          "label": "data",
                                                          "start_token": 2341,
                                                          "end_token": 2341,
                                                          "children": []
                                                        }
                                                      ]
                                                    }
                                                  ]
                                                }
                                              ]
                                            }
                                          ]
                                        }
                                      ]
                                    }
                                  ]
                                }
                              ]
                            }
                          ]
                        }
                      ]
                    },
                    {
                      "type": "Block",
                      "label": "{\n      const records = await trx.objectStore('records').getAll();\n      for (const record of records) {\n        docs.push(Document.from(record.id, record.data));\n      }\n    }",
                      "start_token": 2349,
                      "end_token": 2392,
                      "children": [
                        {
                          "type": "FirstStatement",
                          "label": "const records = await trx.objectStore('records').getAll();",
                          "start_token": 2350,
                          "end_token": 2364,
                          "children": [
                            {
                              "type": "VariableDeclarationList",
                              "label": "const records = await trx.objectStore('records').getAll()",
                              "start_token": 2350,
                              "end_token": 2363,
                              "children": [
                                {
                                  "type": "VariableDeclaration",
                                  "label": "records = await trx.objectStore('records').getAll()",
                                  "start_token": 2351,
                                  "end_token": 2363,
                                  "children": [
                                    {
                                      "type": "Identifier",
                                      "label": "records",
                                      "start_token": 2351,
                                      "end_token": 2351,
                                      "children": []
                                    },
                                    {
                                      "type": "AwaitExpression",
                                      "label": "await trx.objectStore('records').getAll()",
                                      "start_token": 2353,
                                      "end_token": 2363,
                                      "children": [
                                        {
                                          "type": "CallExpression",
                                          "label": "trx.objectStore('records').getAll()",
                                          "start_token": 2354,
                                          "end_token": 2363,
                                          "children": [
                                            {
                                              "type": "PropertyAccessExpression",
                                              "label": "trx.objectStore('records').getAll",
                                              "start_token": 2354,
                                              "end_token": 2361,
                                              "children": [
                                                {
                                                  "type": "CallExpression",
                                                  "label": "trx.objectStore('records')",
                                                  "start_token": 2354,
                                                  "end_token": 2359,
                                                  "children": [
                                                    {
                                                      "type": "PropertyAccessExpression",
                                                      "label": "trx.objectStore",
                                                      "start_token": 2354,
                                                      "end_token": 2356,
                                                      "children": [
                                                        {
                                                          "type": "Identifier",
                                                          "label": "trx",
                                                          "start_token": 2354,
                                                          "end_token": 2354,
                                                          "children": []
                                                        },
                                                        {
                                                          "type": "Identifier",
                                                          "label": "objectStore",
                                                          "start_token": 2356,
                                                          "end_token": 2356,
                                                          "children": []
                                                        }
                                                      ]
                                                    },
                                                    {
                                                      "type": "StringLiteral",
                                                      "label": "'records'",
                                                      "start_token": 2358,
                                                      "end_token": 2358,
                                                      "children": []
                                                    }
                                                  ]
                                                },
                                                {
                                                  "type": "Identifier",
                                                  "label": "getAll",
                                                  "start_token": 2361,
                                                  "end_token": 2361,
                                                  "children": []
                                                }
                                              ]
                                            }
                                          ]
                                        }
                                      ]
                                    }
                                  ]
                                }
                              ]
                            }
                          ]
                        },
                        {
                          "type": "ForOfStatement",
                          "label": "for (const record of records) {\n        docs.push(Document.from(record.id, record.data));\n      }",
                          "start_token": 2365,
                          "end_token": 2391,
                          "children": [
                            {
                              "type": "VariableDeclarationList",
                              "label": "const record",
                              "start_token": 2367,
                              "end_token": 2368,
                              "children": [
                                {
                                  "type": "VariableDeclaration",
                                  "label": "record",
                                  "start_token": 2368,
                                  "end_token": 2368,
                                  "children": [
                                    {
                                      "type": "Identifier",
                                      "label": "record",
                                      "start_token": 2368,
                                      "end_token": 2368,
                                      "children": []
                                    }
                                  ]
                                }
                              ]
                            },
                            {
                              "type": "Identifier",
                              "label": "records",
                              "start_token": 2370,
                              "end_token": 2370,
                              "children": []
                            },
                            {
                              "type": "Block",
                              "label": "{\n        docs.push(Document.from(record.id, record.data));\n      }",
                              "start_token": 2372,
                              "end_token": 2391,
                              "children": [
                                {
                                  "type": "ExpressionStatement",
                                  "label": "docs.push(Document.from(record.id, record.data));",
                                  "start_token": 2373,
                                  "end_token": 2390,
                                  "children": [
                                    {
                                      "type": "CallExpression",
                                      "label": "docs.push(Document.from(record.id, record.data))",
                                      "start_token": 2373,
                                      "end_token": 2389,
                                      "children": [
                                        {
                                          "type": "PropertyAccessExpression",
                                          "label": "docs.push",
                                          "start_token": 2373,
                                          "end_token": 2375,
                                          "children": [
                                            {
                                              "type": "Identifier",
                                              "label": "docs",
                                              "start_token": 2373,
                                              "end_token": 2373,
                                              "children": []
                                            },
                                            {
                                              "type": "Identifier",
                                              "label": "push",
                                              "start_token": 2375,
                                              "end_token": 2375,
                                              "children": []
                                            }
                                          ]
                                        },
                                        {
                                          "type": "CallExpression",
                                          "label": "Document.from(record.id, record.data)",
                                          "start_token": 2377,
                                          "end_token": 2388,
                                          "children": [
                                            {
                                              "type": "PropertyAccessExpression",
                                              "label": "Document.from",
                                              "start_token": 2377,
                                              "end_token": 2379,
                                              "children": [
                                                {
                                                  "type": "Identifier",
                                                  "label": "Document",
                                                  "start_token": 2377,
                                                  "end_token": 2377,
                                                  "children": []
                                                },
                                                {
                                                  "type": "Identifier",
                                                  "label": "from",
                                                  "start_token": 2379,
                                                  "end_token": 2379,
                                                  "children": []
                                                }
                                              ]
                                            },
                                            {
                                              "type": "PropertyAccessExpression",
                                              "label": "record.id",
                                              "start_token": 2381,
                                              "end_token": 2383,
                                              "children": [
                                                {
                                                  "type": "Identifier",
                                                  "label": "record",
                                                  "start_token": 2381,
                                                  "end_token": 2381,
                                                  "children": []
                                                },
                                                {
                                                  "type": "Identifier",
                                                  "label": "id",
                                                  "start_token": 2383,
                                                  "end_token": 2383,
                                                  "children": []
                                                }
                                              ]
                                            },
                                            {
                                              "type": "PropertyAccessExpression",
                                              "label": "record.data",
                                              "start_token": 2385,
                                              "end_token": 2387,
                                              "children": [
                                                {
                                                  "type": "Identifier",
                                                  "label": "record",
                                                  "start_token": 2385,
                                                  "end_token": 2385,
                                                  "children": []
                                                },
                                                {
                                                  "type": "Identifier",
                                                  "label": "data",
                                                  "start_token": 2387,
                                                  "end_token": 2387,
                                                  "children": []
                                                }
                                              ]
                                            }
                                          ]
                                        }
                                      ]
                                    }
                                  ]
                                }
                              ]
                            }
                          ]
                        }
                      ]
                    }
                  ]
                },
                {
                  "type": "ReturnStatement",
                  "label": "return docs;",
                  "start_token": 2393,
                  "end_token": 2395,
                  "children": [
                    {
                      "type": "Identifier",
                      "label": "docs",
                      "start_token": 2394,
                      "end_token": 2394,
                      "children": []
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "type": "MethodDeclaration",
          "label": "async has(trx: DataStructROTransaction, id: string): Promise<boolean> {\n    const nid = await trx.objectStore('records').index('id').getKey(id);\n    return nid !== undefined;\n  }",
          "start_token": 2397,
          "end_token": 2440,
          "children": [
            {
              "type": "AsyncKeyword",
              "label": "async",
              "start_token": 2397,
              "end_token": 2397,
              "children": []
            },
            {
              "type": "Identifier",
              "label": "has",
              "start_token": 2398,
              "end_token": 2398,
              "children": []
            },
            {
              "type": "Parameter",
              "label": "trx: DataStructROTransaction",
              "start_token": 2400,
              "end_token": 2402,
              "children": [
                {
                  "type": "Identifier",
                  "label": "trx",
                  "start_token": 2400,
                  "end_token": 2400,
                  "children": []
                },
                {
                  "type": "TypeReference",
                  "label": "DataStructROTransaction",
                  "start_token": 2402,
                  "end_token": 2402,
                  "children": [
                    {
                      "type": "Identifier",
                      "label": "DataStructROTransaction",
                      "start_token": 2402,
                      "end_token": 2402,
                      "children": []
                    }
                  ]
                }
              ]
            },
            {
              "type": "Parameter",
              "label": "id: string",
              "start_token": 2404,
              "end_token": 2406,
              "children": [
                {
                  "type": "Identifier",
                  "label": "id",
                  "start_token": 2404,
                  "end_token": 2404,
                  "children": []
                },
                {
                  "type": "StringKeyword",
                  "label": "string",
                  "start_token": 2406,
                  "end_token": 2406,
                  "children": []
                }
              ]
            },
            {
              "type": "TypeReference",
              "label": "Promise<boolean>",
              "start_token": 2409,
              "end_token": 2412,
              "children": [
                {
                  "type": "Identifier",
                  "label": "Promise",
                  "start_token": 2409,
                  "end_token": 2409,
                  "children": []
                },
                {
                  "type": "BooleanKeyword",
                  "label": "boolean",
                  "start_token": 2411,
                  "end_token": 2411,
                  "children": []
                }
              ]
            },
            {
              "type": "Block",
              "label": "{\n    const nid = await trx.objectStore('records').index('id').getKey(id);\n    return nid !== undefined;\n  }",
              "start_token": 2413,
              "end_token": 2440,
              "children": [
                {
                  "type": "FirstStatement",
                  "label": "const nid = await trx.objectStore('records').index('id').getKey(id);",
                  "start_token": 2414,
                  "end_token": 2434,
                  "children": [
                    {
                      "type": "VariableDeclarationList",
                      "label": "const nid = await trx.objectStore('records').index('id').getKey(id)",
                      "start_token": 2414,
                      "end_token": 2433,
                      "children": [
                        {
                          "type": "VariableDeclaration",
                          "label": "nid = await trx.objectStore('records').index('id').getKey(id)",
                          "start_token": 2415,
                          "end_token": 2433,
                          "children": [
                            {
                              "type": "Identifier",
                              "label": "nid",
                              "start_token": 2415,
                              "end_token": 2415,
                              "children": []
                            },
                            {
                              "type": "AwaitExpression",
                              "label": "await trx.objectStore('records').index('id').getKey(id)",
                              "start_token": 2417,
                              "end_token": 2433,
                              "children": [
                                {
                                  "type": "CallExpression",
                                  "label": "trx.objectStore('records').index('id').getKey(id)",
                                  "start_token": 2418,
                                  "end_token": 2433,
                                  "children": [
                                    {
                                      "type": "PropertyAccessExpression",
                                      "label": "trx.objectStore('records').index('id').getKey",
                                      "start_token": 2418,
                                      "end_token": 2430,
                                      "children": [
                                        {
                                          "type": "CallExpression",
                                          "label": "trx.objectStore('records').index('id')",
                                          "start_token": 2418,
                                          "end_token": 2428,
                                          "children": [
                                            {
                                              "type": "PropertyAccessExpression",
                                              "label": "trx.objectStore('records').index",
                                              "start_token": 2418,
                                              "end_token": 2425,
                                              "children": [
                                                {
                                                  "type": "CallExpression",
                                                  "label": "trx.objectStore('records')",
                                                  "start_token": 2418,
                                                  "end_token": 2423,
                                                  "children": [
                                                    {
                                                      "type": "PropertyAccessExpression",
                                                      "label": "trx.objectStore",
                                                      "start_token": 2418,
                                                      "end_token": 2420,
                                                      "children": [
                                                        {
                                                          "type": "Identifier",
                                                          "label": "trx",
                                                          "start_token": 2418,
                                                          "end_token": 2418,
                                                          "children": []
                                                        },
                                                        {
                                                          "type": "Identifier",
                                                          "label": "objectStore",
                                                          "start_token": 2420,
                                                          "end_token": 2420,
                                                          "children": []
                                                        }
                                                      ]
                                                    },
                                                    {
                                                      "type": "StringLiteral",
                                                      "label": "'records'",
                                                      "start_token": 2422,
                                                      "end_token": 2422,
                                                      "children": []
                                                    }
                                                  ]
                                                },
                                                {
                                                  "type": "Identifier",
                                                  "label": "index",
                                                  "start_token": 2425,
                                                  "end_token": 2425,
                                                  "children": []
                                                }
                                              ]
                                            },
                                            {
                                              "type": "StringLiteral",
                                              "label": "'id'",
                                              "start_token": 2427,
                                              "end_token": 2427,
                                              "children": []
                                            }
                                          ]
                                        },
                                        {
                                          "type": "Identifier",
                                          "label": "getKey",
                                          "start_token": 2430,
                                          "end_token": 2430,
                                          "children": []
                                        }
                                      ]
                                    },
                                    {
                                      "type": "Identifier",
                                      "label": "id",
                                      "start_token": 2432,
                                      "end_token": 2432,
                                      "children": []
                                    }
                                  ]
                                }
                              ]
                            }
                          ]
                        }
                      ]
                    }
                  ]
                },
                {
                  "type": "ReturnStatement",
                  "label": "return nid !== undefined;",
                  "start_token": 2435,
                  "end_token": 2439,
                  "children": [
                    {
                      "type": "BinaryExpression",
                      "label": "nid !== undefined",
                      "start_token": 2436,
                      "end_token": 2438,
                      "children": [
                        {
                          "type": "Identifier",
                          "label": "nid",
                          "start_token": 2436,
                          "end_token": 2436,
                          "children": []
                        },
                        {
                          "type": "ExclamationEqualsEqualsToken",
                          "label": "!==",
                          "start_token": 2437,
                          "end_token": 2437,
                          "children": []
                        },
                        {
                          "type": "Identifier",
                          "label": "undefined",
                          "start_token": 2438,
                          "end_token": 2438,
                          "children": []
                        }
                      ]
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "type": "MethodDeclaration",
          "label": "async readonly() {\n    await this.ensureInitialized();\n    return this.database.transaction(\n      ['records', 'invertedIndex', 'kvMetadata'],\n      'readonly',\n      {\n        durability: 'relaxed',\n      }\n    );\n  }",
          "start_token": 2441,
          "end_token": 2478,
          "children": [
            {
              "type": "AsyncKeyword",
              "label": "async",
              "start_token": 2441,
              "end_token": 2441,
              "children": []
            },
            {
              "type": "Identifier",
              "label": "readonly",
              "start_token": 2442,
              "end_token": 2442,
              "children": []
            },
            {
              "type": "Block",
              "label": "{\n    await this.ensureInitialized();\n    return this.database.transaction(\n      ['records', 'invertedIndex', 'kvMetadata'],\n      'readonly',\n      {\n        durability: 'relaxed',\n      }\n    );\n  }",
              "start_token": 2445,
              "end_token": 2478,
              "children": [
                {
                  "type": "ExpressionStatement",
                  "label": "await this.ensureInitialized();",
                  "start_token": 2446,
                  "end_token": 2452,
                  "children": [
                    {
                      "type": "AwaitExpression",
                      "label": "await this.ensureInitialized()",
                      "start_token": 2446,
                      "end_token": 2451,
                      "children": [
                        {
                          "type": "CallExpression",
                          "label": "this.ensureInitialized()",
                          "start_token": 2447,
                          "end_token": 2451,
                          "children": [
                            {
                              "type": "PropertyAccessExpression",
                              "label": "this.ensureInitialized",
                              "start_token": 2447,
                              "end_token": 2449,
                              "children": [
                                {
                                  "type": "ThisKeyword",
                                  "label": "this",
                                  "start_token": 2447,
                                  "end_token": 2447,
                                  "children": []
                                },
                                {
                                  "type": "Identifier",
                                  "label": "ensureInitialized",
                                  "start_token": 2449,
                                  "end_token": 2449,
                                  "children": []
                                }
                              ]
                            }
                          ]
                        }
                      ]
                    }
                  ]
                },
                {
                  "type": "ReturnStatement",
                  "label": "return this.database.transaction(\n      ['records', 'invertedIndex', 'kvMetadata'],\n      'readonly',\n      {\n        durability: 'relaxed',\n      }\n    );",
                  "start_token": 2453,
                  "end_token": 2477,
                  "children": [
                    {
                      "type": "CallExpression",
                      "label": "this.database.transaction(\n      ['records', 'invertedIndex', 'kvMetadata'],\n      'readonly',\n      {\n        durability: 'relaxed',\n      }\n    )",
                      "start_token": 2454,
                      "end_token": 2476,
                      "children": [
                        {
                          "type": "PropertyAccessExpression",
                          "label": "this.database.transaction",
                          "start_token": 2454,
                          "end_token": 2458,
                          "children": [
                            {
                              "type": "PropertyAccessExpression",
                              "label": "this.database",
                              "start_token": 2454,
                              "end_token": 2456,
                              "children": [
                                {
                                  "type": "ThisKeyword",
                                  "label": "this",
                                  "start_token": 2454,
                                  "end_token": 2454,
                                  "children": []
                                },
                                {
                                  "type": "Identifier",
                                  "label": "database",
                                  "start_token": 2456,
                                  "end_token": 2456,
                                  "children": []
                                }
                              ]
                            },
                            {
                              "type": "Identifier",
                              "label": "transaction",
                              "start_token": 2458,
                              "end_token": 2458,
                              "children": []
                            }
                          ]
                        },
                        {
                          "type": "ArrayLiteralExpression",
                          "label": "['records', 'invertedIndex', 'kvMetadata']",
                          "start_token": 2460,
                          "end_token": 2466,
                          "children": [
                            {
                              "type": "StringLiteral",
                              "label": "'records'",
                              "start_token": 2461,
                              "end_token": 2461,
                              "children": []
                            },
                            {
                              "type": "StringLiteral",
                              "label": "'invertedIndex'",
                              "start_token": 2463,
                              "end_token": 2463,
                              "children": []
                            },
                            {
                              "type": "StringLiteral",
                              "label": "'kvMetadata'",
                              "start_token": 2465,
                              "end_token": 2465,
                              "children": []
                            }
                          ]
                        },
                        {
                          "type": "StringLiteral",
                          "label": "'readonly'",
                          "start_token": 2468,
                          "end_token": 2468,
                          "children": []
                        },
                        {
                          "type": "ObjectLiteralExpression",
                          "label": "{\n        durability: 'relaxed',\n      }",
                          "start_token": 2470,
                          "end_token": 2475,
                          "children": [
                            {
                              "type": "PropertyAssignment",
                              "label": "durability: 'relaxed'",
                              "start_token": 2471,
                              "end_token": 2473,
                              "children": [
                                {
                                  "type": "Identifier",
                                  "label": "durability",
                                  "start_token": 2471,
                                  "end_token": 2471,
                                  "children": []
                                },
                                {
                                  "type": "StringLiteral",
                                  "label": "'relaxed'",
                                  "start_token": 2473,
                                  "end_token": 2473,
                                  "children": []
                                }
                              ]
                            }
                          ]
                        }
                      ]
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "type": "MethodDeclaration",
          "label": "async readwrite() {\n    await this.ensureInitialized();\n    return this.database.transaction(\n      ['records', 'invertedIndex', 'kvMetadata'],\n      'readwrite',\n      {\n        durability: 'relaxed',\n      }\n    );\n  }",
          "start_token": 2479,
          "end_token": 2516,
          "children": [
            {
              "type": "AsyncKeyword",
              "label": "async",
              "start_token": 2479,
              "end_token": 2479,
              "children": []
            },
            {
              "type": "Identifier",
              "label": "readwrite",
              "start_token": 2480,
              "end_token": 2480,
              "children": []
            },
            {
              "type": "Block",
              "label": "{\n    await this.ensureInitialized();\n    return this.database.transaction(\n      ['records', 'invertedIndex', 'kvMetadata'],\n      'readwrite',\n      {\n        durability: 'relaxed',\n      }\n    );\n  }",
              "start_token": 2483,
              "end_token": 2516,
              "children": [
                {
                  "type": "ExpressionStatement",
                  "label": "await this.ensureInitialized();",
                  "start_token": 2484,
                  "end_token": 2490,
                  "children": [
                    {
                      "type": "AwaitExpression",
                      "label": "await this.ensureInitialized()",
                      "start_token": 2484,
                      "end_token": 2489,
                      "children": [
                        {
                          "type": "CallExpression",
                          "label": "this.ensureInitialized()",
                          "start_token": 2485,
                          "end_token": 2489,
                          "children": [
                            {
                              "type": "PropertyAccessExpression",
                              "label": "this.ensureInitialized",
                              "start_token": 2485,
                              "end_token": 2487,
                              "children": [
                                {
                                  "type": "ThisKeyword",
                                  "label": "this",
                                  "start_token": 2485,
                                  "end_token": 2485,
                                  "children": []
                                },
                                {
                                  "type": "Identifier",
                                  "label": "ensureInitialized",
                                  "start_token": 2487,
                                  "end_token": 2487,
                                  "children": []
                                }
                              ]
                            }
                          ]
                        }
                      ]
                    }
                  ]
                },
                {
                  "type": "ReturnStatement",
                  "label": "return this.database.transaction(\n      ['records', 'invertedIndex', 'kvMetadata'],\n      'readwrite',\n      {\n        durability: 'relaxed',\n      }\n    );",
                  "start_token": 2491,
                  "end_token": 2515,
                  "children": [
                    {
                      "type": "CallExpression",
                      "label": "this.database.transaction(\n      ['records', 'invertedIndex', 'kvMetadata'],\n      'readwrite',\n      {\n        durability: 'relaxed',\n      }\n    )",
                      "start_token": 2492,
                      "end_token": 2514,
                      "children": [
                        {
                          "type": "PropertyAccessExpression",
                          "label": "this.database.transaction",
                          "start_token": 2492,
                          "end_token": 2496,
                          "children": [
                            {
                              "type": "PropertyAccessExpression",
                              "label": "this.database",
                              "start_token": 2492,
                              "end_token": 2494,
                              "children": [
                                {
                                  "type": "ThisKeyword",
                                  "label": "this",
                                  "start_token": 2492,
                                  "end_token": 2492,
                                  "children": []
                                },
                                {
                                  "type": "Identifier",
                                  "label": "database",
                                  "start_token": 2494,
                                  "end_token": 2494,
                                  "children": []
                                }
                              ]
                            },
                            {
                              "type": "Identifier",
                              "label": "transaction",
                              "start_token": 2496,
                              "end_token": 2496,
                              "children": []
                            }
                          ]
                        },
                        {
                          "type": "ArrayLiteralExpression",
                          "label": "['records', 'invertedIndex', 'kvMetadata']",
                          "start_token": 2498,
                          "end_token": 2504,
                          "children": [
                            {
                              "type": "StringLiteral",
                              "label": "'records'",
                              "start_token": 2499,
                              "end_token": 2499,
                              "children": []
                            },
                            {
                              "type": "StringLiteral",
                              "label": "'invertedIndex'",
                              "start_token": 2501,
                              "end_token": 2501,
                              "children": []
                            },
                            {
                              "type": "StringLiteral",
                              "label": "'kvMetadata'",
                              "start_token": 2503,
                              "end_token": 2503,
                              "children": []
                            }
                          ]
                        },
                        {
                          "type": "StringLiteral",
                          "label": "'readwrite'",
                          "start_token": 2506,
                          "end_token": 2506,
                          "children": []
                        },
                        {
                          "type": "ObjectLiteralExpression",
                          "label": "{\n        durability: 'relaxed',\n      }",
                          "start_token": 2508,
                          "end_token": 2513,
                          "children": [
                            {
                              "type": "PropertyAssignment",
                              "label": "durability: 'relaxed'",
                              "start_token": 2509,
                              "end_token": 2511,
                              "children": [
                                {
                                  "type": "Identifier",
                                  "label": "durability",
                                  "start_token": 2509,
                                  "end_token": 2509,
                                  "children": []
                                },
                                {
                                  "type": "StringLiteral",
                                  "label": "'relaxed'",
                                  "start_token": 2511,
                                  "end_token": 2511,
                                  "children": []
                                }
                              ]
                            }
                          ]
                        }
                      ]
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "type": "MethodDeclaration",
          "label": "private async ensureInitialized() {\n    if (this.database) {\n      return;\n    }\n    this.initializePromise ??= this.initialize();\n    await this.initializePromise;\n  }",
          "start_token": 2517,
          "end_token": 2550,
          "children": [
            {
              "type": "PrivateKeyword",
              "label": "private",
              "start_token": 2517,
              "end_token": 2517,
              "children": []
            },
            {
              "type": "AsyncKeyword",
              "label": "async",
              "start_token": 2518,
              "end_token": 2518,
              "children": []
            },
            {
              "type": "Identifier",
              "label": "ensureInitialized",
              "start_token": 2519,
              "end_token": 2519,
              "children": []
            },
            {
              "type": "Block",
              "label": "{\n    if (this.database) {\n      return;\n    }\n    this.initializePromise ??= this.initialize();\n    await this.initializePromise;\n  }",
              "start_token": 2522,
              "end_token": 2550,
              "children": [
                {
                  "type": "IfStatement",
                  "label": "if (this.database) {\n      return;\n    }",
                  "start_token": 2523,
                  "end_token": 2532,
                  "children": [
                    {
                      "type": "PropertyAccessExpression",
                      "label": "this.database",
                      "start_token": 2525,
                      "end_token": 2527,
                      "children": [
                        {
                          "type": "ThisKeyword",
                          "label": "this",
                          "start_token": 2525,
                          "end_token": 2525,
                          "children": []
                        },
                        {
                          "type": "Identifier",
                          "label": "database",
                          "start_token": 2527,
                          "end_token": 2527,
                          "children": []
                        }
                      ]
                    },
                    {
                      "type": "Block",
                      "label": "{\n      return;\n    }",
                      "start_token": 2529,
                      "end_token": 2532,
                      "children": [
                        {
                          "type": "ReturnStatement",
                          "label": "return;",
                          "start_token": 2530,
                          "end_token": 2531,
                          "children": []
                        }
                      ]
                    }
                  ]
                },
                {
                  "type": "ExpressionStatement",
                  "label": "this.initializePromise ??= this.initialize();",
                  "start_token": 2533,
                  "end_token": 2544,
                  "children": [
                    {
                      "type": "BinaryExpression",
                      "label": "this.initializePromise ??= this.initialize()",
                      "start_token": 2533,
                      "end_token": 2543,
                      "children": [
                        {
                          "type": "PropertyAccessExpression",
                          "label": "this.initializePromise",
                          "start_token": 2533,
                          "end_token": 2535,
                          "children": [
                            {
                              "type": "ThisKeyword",
                              "label": "this",
                              "start_token": 2533,
                              "end_token": 2533,
                              "children": []
                            },
                            {
                              "type": "Identifier",
                              "label": "initializePromise",
                              "start_token": 2535,
                              "end_token": 2535,
                              "children": []
                            }
                          ]
                        },
                        {
                          "type": "QuestionQuestionEqualsToken",
                          "label": "??=",
                          "start_token": 2536,
                          "end_token": 2538,
                          "children": []
                        },
                        {
                          "type": "CallExpression",
                          "label": "this.initialize()",
                          "start_token": 2539,
                          "end_token": 2543,
                          "children": [
                            {
                              "type": "PropertyAccessExpression",
                              "label": "this.initialize",
                              "start_token": 2539,
                              "end_token": 2541,
                              "children": [
                                {
                                  "type": "ThisKeyword",
                                  "label": "this",
                                  "start_token": 2539,
                                  "end_token": 2539,
                                  "children": []
                                },
                                {
                                  "type": "Identifier",
                                  "label": "initialize",
                                  "start_token": 2541,
                                  "end_token": 2541,
                                  "children": []
                                }
                              ]
                            }
                          ]
                        }
                      ]
                    }
                  ]
                },
                {
                  "type": "ExpressionStatement",
                  "label": "await this.initializePromise;",
                  "start_token": 2545,
                  "end_token": 2549,
                  "children": [
                    {
                      "type": "AwaitExpression",
                      "label": "await this.initializePromise",
                      "start_token": 2545,
                      "end_token": 2548,
                      "children": [
                        {
                          "type": "PropertyAccessExpression",
                          "label": "this.initializePromise",
                          "start_token": 2546,
                          "end_token": 2548,
                          "children": [
                            {
                              "type": "ThisKeyword",
                              "label": "this",
                              "start_token": 2546,
                              "end_token": 2546,
                              "children": []
                            },
                            {
                              "type": "Identifier",
                              "label": "initializePromise",
                              "start_token": 2548,
                              "end_token": 2548,
                              "children": []
                            }
                          ]
                        }
                      ]
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "type": "MethodDeclaration",
          "label": "private async initialize() {\n    this.database = await openDB<IndexDB>(this.databaseName, 1, {\n      upgrade(database) {\n        database.createObjectStore('kvMetadata', {\n          keyPath: 'key',\n        });\n        const recordsStore = database.createObjectStore('records', {\n          autoIncrement: true,\n        });\n        recordsStore.createIndex('id', 'id', {\n          unique: true,\n        });\n        const invertedIndexStore = database.createObjectStore('invertedIndex', {\n          autoIncrement: true,\n        });\n        invertedIndexStore.createIndex('key', 'key', { unique: false });\n        invertedIndexStore.createIndex('nid', 'nid', { unique: false });\n      },\n    });\n  }",
          "start_token": 2551,
          "end_token": 2678,
          "children": [
            {
              "type": "PrivateKeyword",
              "label": "private",
              "start_token": 2551,
              "end_token": 2551,
              "children": []
            },
            {
              "type": "AsyncKeyword",
              "label": "async",
              "start_token": 2552,
              "end_token": 2552,
              "children": []
            },
            {
              "type": "Identifier",
              "label": "initialize",
              "start_token": 2553,
              "end_token": 2553,
              "children": []
            },
            {
              "type": "Block",
              "label": "{\n    this.database = await openDB<IndexDB>(this.databaseName, 1, {\n      upgrade(database) {\n        database.createObjectStore('kvMetadata', {\n          keyPath: 'key',\n        });\n        const recordsStore = database.createObjectStore('records', {\n          autoIncrement: true,\n        });\n        recordsStore.createIndex('id', 'id', {\n          unique: true,\n        });\n        const invertedIndexStore = database.createObjectStore('invertedIndex', {\n          autoIncrement: true,\n        });\n        invertedIndexStore.createIndex('key', 'key', { unique: false });\n        invertedIndexStore.createIndex('nid', 'nid', { unique: false });\n      },\n    });\n  }",
              "start_token": 2556,
              "end_token": 2678,
              "children": [
                {
                  "type": "ExpressionStatement",
                  "label": "this.database = await openDB<IndexDB>(this.databaseName, 1, {\n      upgrade(database) {\n        database.createObjectStore('kvMetadata', {\n          keyPath: 'key',\n        });\n        const recordsStore = database.createObjectStore('records', {\n          autoIncrement: true,\n        });\n        recordsStore.createIndex('id', 'id', {\n          unique: true,\n        });\n        const invertedIndexStore = database.createObjectStore('invertedIndex', {\n          autoIncrement: true,\n        });\n        invertedIndexStore.createIndex('key', 'key', { unique: false });\n        invertedIndexStore.createIndex('nid', 'nid', { unique: false });\n      },\n    });",
                  "start_token": 2557,
                  "end_token": 2677,
                  "children": [
                    {
                      "type": "BinaryExpression",
                      "label": "this.database = await openDB<IndexDB>(this.databaseName, 1, {\n      upgrade(database) {\n        database.createObjectStore('kvMetadata', {\n          keyPath: 'key',\n        });\n        const recordsStore = database.createObjectStore('records', {\n          autoIncrement: true,\n        });\n        recordsStore.createIndex('id', 'id', {\n          unique: true,\n        });\n        const invertedIndexStore = database.createObjectStore('invertedIndex', {\n          autoIncrement: true,\n        });\n        invertedIndexStore.createIndex('key', 'key', { unique: false });\n        invertedIndexStore.createIndex('nid', 'nid', { unique: false });\n      },\n    })",
                      "start_token": 2557,
                      "end_token": 2676,
                      "children": [
                        {
                          "type": "PropertyAccessExpression",
                          "label": "this.database",
                          "start_token": 2557,
                          "end_token": 2559,
                          "children": [
                            {
                              "type": "ThisKeyword",
                              "label": "this",
                              "start_token": 2557,
                              "end_token": 2557,
                              "children": []
                            },
                            {
                              "type": "Identifier",
                              "label": "database",
                              "start_token": 2559,
                              "end_token": 2559,
                              "children": []
                            }
                          ]
                        },
                        {
                          "type": "FirstAssignment",
                          "label": "=",
                          "start_token": 2560,
                          "end_token": 2560,
                          "children": []
                        },
                        {
                          "type": "AwaitExpression",
                          "label": "await openDB<IndexDB>(this.databaseName, 1, {\n      upgrade(database) {\n        database.createObjectStore('kvMetadata', {\n          keyPath: 'key',\n        });\n        const recordsStore = database.createObjectStore('records', {\n          autoIncrement: true,\n        });\n        recordsStore.createIndex('id', 'id', {\n          unique: true,\n        });\n        const invertedIndexStore = database.createObjectStore('invertedIndex', {\n          autoIncrement: true,\n        });\n        invertedIndexStore.createIndex('key', 'key', { unique: false });\n        invertedIndexStore.createIndex('nid', 'nid', { unique: false });\n      },\n    })",
                          "start_token": 2561,
                          "end_token": 2676,
                          "children": [
                            {
                              "type": "CallExpression",
                              "label": "openDB<IndexDB>(this.databaseName, 1, {\n      upgrade(database) {\n        database.createObjectStore('kvMetadata', {\n          keyPath: 'key',\n        });\n        const recordsStore = database.createObjectStore('records', {\n          autoIncrement: true,\n        });\n        recordsStore.createIndex('id', 'id', {\n          unique: true,\n        });\n        const invertedIndexStore = database.createObjectStore('invertedIndex', {\n          autoIncrement: true,\n        });\n        invertedIndexStore.createIndex('key', 'key', { unique: false });\n        invertedIndexStore.createIndex('nid', 'nid', { unique: false });\n      },\n    })",
                              "start_token": 2562,
                              "end_token": 2676,
                              "children": [
                                {
                                  "type": "Identifier",
                                  "label": "openDB",
                                  "start_token": 2562,
                                  "end_token": 2562,
                                  "children": []
                                },
                                {
                                  "type": "TypeReference",
                                  "label": "IndexDB",
                                  "start_token": 2564,
                                  "end_token": 2564,
                                  "children": [
                                    {
                                      "type": "Identifier",
                                      "label": "IndexDB",
                                      "start_token": 2564,
                                      "end_token": 2564,
                                      "children": []
                                    }
                                  ]
                                },
                                {
                                  "type": "PropertyAccessExpression",
                                  "label": "this.databaseName",
                                  "start_token": 2567,
                                  "end_token": 2569,
                                  "children": [
                                    {
                                      "type": "ThisKeyword",
                                      "label": "this",
                                      "start_token": 2567,
                                      "end_token": 2567,
                                      "children": []
                                    },
                                    {
                                      "type": "Identifier",
                                      "label": "databaseName",
                                      "start_token": 2569,
                                      "end_token": 2569,
                                      "children": []
                                    }
                                  ]
                                },
                                {
                                  "type": "FirstLiteralToken",
                                  "label": "1",
                                  "start_token": 2571,
                                  "end_token": 2571,
                                  "children": []
                                },
                                {
                                  "type": "ObjectLiteralExpression",
                                  "label": "{\n      upgrade(database) {\n        database.createObjectStore('kvMetadata', {\n          keyPath: 'key',\n        });\n        const recordsStore = database.createObjectStore('records', {\n          autoIncrement: true,\n        });\n        recordsStore.createIndex('id', 'id', {\n          unique: true,\n        });\n        const invertedIndexStore = database.createObjectStore('invertedIndex', {\n          autoIncrement: true,\n        });\n        invertedIndexStore.createIndex('key', 'key', { unique: false });\n        invertedIndexStore.createIndex('nid', 'nid', { unique: false });\n      },\n    }",
                                  "start_token": 2573,
                                  "end_token": 2675,
                                  "children": [
                                    {
                                      "type": "MethodDeclaration",
                                      "label": "upgrade(database) {\n        database.createObjectStore('kvMetadata', {\n          keyPath: 'key',\n        });\n        const recordsStore = database.createObjectStore('records', {\n          autoIncrement: true,\n        });\n        recordsStore.createIndex('id', 'id', {\n          unique: true,\n        });\n        const invertedIndexStore = database.createObjectStore('invertedIndex', {\n          autoIncrement: true,\n        });\n        invertedIndexStore.createIndex('key', 'key', { unique: false });\n        invertedIndexStore.createIndex('nid', 'nid', { unique: false });\n      }",
                                      "start_token": 2574,
                                      "end_token": 2673,
                                      "children": [
                                        {
                                          "type": "Identifier",
                                          "label": "upgrade",
                                          "start_token": 2574,
                                          "end_token": 2574,
                                          "children": []
                                        },
                                        {
                                          "type": "Parameter",
                                          "label": "database",
                                          "start_token": 2576,
                                          "end_token": 2576,
                                          "children": [
                                            {
                                              "type": "Identifier",
                                              "label": "database",
                                              "start_token": 2576,
                                              "end_token": 2576,
                                              "children": []
                                            }
                                          ]
                                        },
                                        {
                                          "type": "Block",
                                          "label": "{\n        database.createObjectStore('kvMetadata', {\n          keyPath: 'key',\n        });\n        const recordsStore = database.createObjectStore('records', {\n          autoIncrement: true,\n        });\n        recordsStore.createIndex('id', 'id', {\n          unique: true,\n        });\n        const invertedIndexStore = database.createObjectStore('invertedIndex', {\n          autoIncrement: true,\n        });\n        invertedIndexStore.createIndex('key', 'key', { unique: false });\n        invertedIndexStore.createIndex('nid', 'nid', { unique: false });\n      }",
                                          "start_token": 2578,
                                          "end_token": 2673,
                                          "children": [
                                            {
                                              "type": "ExpressionStatement",
                                              "label": "database.createObjectStore('kvMetadata', {\n          keyPath: 'key',\n        });",
                                              "start_token": 2579,
                                              "end_token": 2592,
                                              "children": [
                                                {
                                                  "type": "CallExpression",
                                                  "label": "database.createObjectStore('kvMetadata', {\n          keyPath: 'key',\n        })",
                                                  "start_token": 2579,
                                                  "end_token": 2591,
                                                  "children": [
                                                    {
                                                      "type": "PropertyAccessExpression",
                                                      "label": "database.createObjectStore",
                                                      "start_token": 2579,
                                                      "end_token": 2581,
                                                      "children": [
                                                        {
                                                          "type": "Identifier",
                                                          "label": "database",
                                                          "start_token": 2579,
                                                          "end_token": 2579,
                                                          "children": []
                                                        },
                                                        {
                                                          "type": "Identifier",
                                                          "label": "createObjectStore",
                                                          "start_token": 2581,
                                                          "end_token": 2581,
                                                          "children": []
                                                        }
                                                      ]
                                                    },
                                                    {
                                                      "type": "StringLiteral",
                                                      "label": "'kvMetadata'",
                                                      "start_token": 2583,
                                                      "end_token": 2583,
                                                      "children": []
                                                    },
                                                    {
                                                      "type": "ObjectLiteralExpression",
                                                      "label": "{\n          keyPath: 'key',\n        }",
                                                      "start_token": 2585,
                                                      "end_token": 2590,
                                                      "children": [
                                                        {
                                                          "type": "PropertyAssignment",
                                                          "label": "keyPath: 'key'",
                                                          "start_token": 2586,
                                                          "end_token": 2588,
                                                          "children": [
                                                            {
                                                              "type": "Identifier",
                                                              "label": "keyPath",
                                                              "start_token": 2586,
                                                              "end_token": 2586,
                                                              "children": []
                                                            },
                                                            {
                                                              "type": "StringLiteral",
                                                              "label": "'key'",
                                                              "start_token": 2588,
                                                              "end_token": 2588,
                                                              "children": []
                                                            }
                                                          ]
                                                        }
                                                      ]
                                                    }
                                                  ]
                                                }
                                              ]
                                            },
                                            {
                                              "type": "FirstStatement",
                                              "label": "const recordsStore = database.createObjectStore('records', {\n          autoIncrement: true,\n        });",
                                              "start_token": 2593,
                                              "end_token": 2609,
                                              "children": [
                                                {
                                                  "type": "VariableDeclarationList",
                                                  "label": "const recordsStore = database.createObjectStore('records', {\n          autoIncrement: true,\n        })",
                                                  "start_token": 2593,
                                                  "end_token": 2608,
                                                  "children": [
                                                    {
                                                      "type": "VariableDeclaration",
                                                      "label": "recordsStore = database.createObjectStore('records', {\n          autoIncrement: true,\n        })",
                                                      "start_token": 2594,
                                                      "end_token": 2608,
                                                      "children": [
                                                        {
                                                          "type": "Identifier",
                                                          "label": "recordsStore",
                                                          "start_token": 2594,
                                                          "end_token": 2594,
                                                          "children": []
                                                        },
                                                        {
                                                          "type": "CallExpression",
                                                          "label": "database.createObjectStore('records', {\n          autoIncrement: true,\n        })",
                                                          "start_token": 2596,
                                                          "end_token": 2608,
                                                          "children": [
                                                            {
                                                              "type": "PropertyAccessExpression",
                                                              "label": "database.createObjectStore",
                                                              "start_token": 2596,
                                                              "end_token": 2598,
                                                              "children": [
                                                                {
                                                                  "type": "Identifier",
                                                                  "label": "database",
                                                                  "start_token": 2596,
                                                                  "end_token": 2596,
                                                                  "children": []
                                                                },
                                                                {
                                                                  "type": "Identifier",
                                                                  "label": "createObjectStore",
                                                                  "start_token": 2598,
                                                                  "end_token": 2598,
                                                                  "children": []
                                                                }
                                                              ]
                                                            },
                                                            {
                                                              "type": "StringLiteral",
                                                              "label": "'records'",
                                                              "start_token": 2600,
                                                              "end_token": 2600,
                                                              "children": []
                                                            },
                                                            {
                                                              "type": "ObjectLiteralExpression",
                                                              "label": "{\n          autoIncrement: true,\n        }",
                                                              "start_token": 2602,
                                                              "end_token": 2607,
                                                              "children": [
                                                                {
                                                                  "type": "PropertyAssignment",
                                                                  "label": "autoIncrement: true",
                                                                  "start_token": 2603,
                                                                  "end_token": 2605,
                                                                  "children": [
                                                                    {
                                                                      "type": "Identifier",
                                                                      "label": "autoIncrement",
                                                                      "start_token": 2603,
                                                                      "end_token": 2603,
                                                                      "children": []
                                                                    },
                                                                    {
                                                                      "type": "TrueKeyword",
                                                                      "label": "true",
                                                                      "start_token": 2605,
                                                                      "end_token": 2605,
                                                                      "children": []
                                                                    }
                                                                  ]
                                                                }
                                                              ]
                                                            }
                                                          ]
                                                        }
                                                      ]
                                                    }
                                                  ]
                                                }
                                              ]
                                            },
                                            {
                                              "type": "ExpressionStatement",
                                              "label": "recordsStore.createIndex('id', 'id', {\n          unique: true,\n        });",
                                              "start_token": 2610,
                                              "end_token": 2625,
                                              "children": [
                                                {
                                                  "type": "CallExpression",
                                                  "label": "recordsStore.createIndex('id', 'id', {\n          unique: true,\n        })",
                                                  "start_token": 2610,
                                                  "end_token": 2624,
                                                  "children": [
                                                    {
                                                      "type": "PropertyAccessExpression",
                                                      "label": "recordsStore.createIndex",
                                                      "start_token": 2610,
                                                      "end_token": 2612,
                                                      "children": [
                                                        {
                                                          "type": "Identifier",
                                                          "label": "recordsStore",
                                                          "start_token": 2610,
                                                          "end_token": 2610,
                                                          "children": []
                                                        },
                                                        {
                                                          "type": "Identifier",
                                                          "label": "createIndex",
                                                          "start_token": 2612,
                                                          "end_token": 2612,
                                                          "children": []
                                                        }
                                                      ]
                                                    },
                                                    {
                                                      "type": "StringLiteral",
                                                      "label": "'id'",
                                                      "start_token": 2614,
                                                      "end_token": 2614,
                                                      "children": []
                                                    },
                                                    {
                                                      "type": "StringLiteral",
                                                      "label": "'id'",
                                                      "start_token": 2616,
                                                      "end_token": 2616,
                                                      "children": []
                                                    },
                                                    {
                                                      "type": "ObjectLiteralExpression",
                                                      "label": "{\n          unique: true,\n        }",
                                                      "start_token": 2618,
                                                      "end_token": 2623,
                                                      "children": [
                                                        {
                                                          "type": "PropertyAssignment",
                                                          "label": "unique: true",
                                                          "start_token": 2619,
                                                          "end_token": 2621,
                                                          "children": [
                                                            {
                                                              "type": "Identifier",
                                                              "label": "unique",
                                                              "start_token": 2619,
                                                              "end_token": 2619,
                                                              "children": []
                                                            },
                                                            {
                                                              "type": "TrueKeyword",
                                                              "label": "true",
                                                              "start_token": 2621,
                                                              "end_token": 2621,
                                                              "children": []
                                                            }
                                                          ]
                                                        }
                                                      ]
                                                    }
                                                  ]
                                                }
                                              ]
                                            },
                                            {
                                              "type": "FirstStatement",
                                              "label": "const invertedIndexStore = database.createObjectStore('invertedIndex', {\n          autoIncrement: true,\n        });",
                                              "start_token": 2626,
                                              "end_token": 2642,
                                              "children": [
                                                {
                                                  "type": "VariableDeclarationList",
                                                  "label": "const invertedIndexStore = database.createObjectStore('invertedIndex', {\n          autoIncrement: true,\n        })",
                                                  "start_token": 2626,
                                                  "end_token": 2641,
                                                  "children": [
                                                    {
                                                      "type": "VariableDeclaration",
                                                      "label": "invertedIndexStore = database.createObjectStore('invertedIndex', {\n          autoIncrement: true,\n        })",
                                                      "start_token": 2627,
                                                      "end_token": 2641,
                                                      "children": [
                                                        {
                                                          "type": "Identifier",
                                                          "label": "invertedIndexStore",
                                                          "start_token": 2627,
                                                          "end_token": 2627,
                                                          "children": []
                                                        },
                                                        {
                                                          "type": "CallExpression",
                                                          "label": "database.createObjectStore('invertedIndex', {\n          autoIncrement: true,\n        })",
                                                          "start_token": 2629,
                                                          "end_token": 2641,
                                                          "children": [
                                                            {
                                                              "type": "PropertyAccessExpression",
                                                              "label": "database.createObjectStore",
                                                              "start_token": 2629,
                                                              "end_token": 2631,
                                                              "children": [
                                                                {
                                                                  "type": "Identifier",
                                                                  "label": "database",
                                                                  "start_token": 2629,
                                                                  "end_token": 2629,
                                                                  "children": []
                                                                },
                                                                {
                                                                  "type": "Identifier",
                                                                  "label": "createObjectStore",
                                                                  "start_token": 2631,
                                                                  "end_token": 2631,
                                                                  "children": []
                                                                }
                                                              ]
                                                            },
                                                            {
                                                              "type": "StringLiteral",
                                                              "label": "'invertedIndex'",
                                                              "start_token": 2633,
                                                              "end_token": 2633,
                                                              "children": []
                                                            },
                                                            {
                                                              "type": "ObjectLiteralExpression",
                                                              "label": "{\n          autoIncrement: true,\n        }",
                                                              "start_token": 2635,
                                                              "end_token": 2640,
                                                              "children": [
                                                                {
                                                                  "type": "PropertyAssignment",
                                                                  "label": "autoIncrement: true",
                                                                  "start_token": 2636,
                                                                  "end_token": 2638,
                                                                  "children": [
                                                                    {
                                                                      "type": "Identifier",
                                                                      "label": "autoIncrement",
                                                                      "start_token": 2636,
                                                                      "end_token": 2636,
                                                                      "children": []
                                                                    },
                                                                    {
                                                                      "type": "TrueKeyword",
                                                                      "label": "true",
                                                                      "start_token": 2638,
                                                                      "end_token": 2638,
                                                                      "children": []
                                                                    }
                                                                  ]
                                                                }
                                                              ]
                                                            }
                                                          ]
                                                        }
                                                      ]
                                                    }
                                                  ]
                                                }
                                              ]
                                            },
                                            {
                                              "type": "ExpressionStatement",
                                              "label": "invertedIndexStore.createIndex('key', 'key', { unique: false });",
                                              "start_token": 2643,
                                              "end_token": 2657,
                                              "children": [
                                                {
                                                  "type": "CallExpression",
                                                  "label": "invertedIndexStore.createIndex('key', 'key', { unique: false })",
                                                  "start_token": 2643,
                                                  "end_token": 2656,
                                                  "children": [
                                                    {
                                                      "type": "PropertyAccessExpression",
                                                      "label": "invertedIndexStore.createIndex",
                                                      "start_token": 2643,
                                                      "end_token": 2645,
                                                      "children": [
                                                        {
                                                          "type": "Identifier",
                                                          "label": "invertedIndexStore",
                                                          "start_token": 2643,
                                                          "end_token": 2643,
                                                          "children": []
                                                        },
                                                        {
                                                          "type": "Identifier",
                                                          "label": "createIndex",
                                                          "start_token": 2645,
                                                          "end_token": 2645,
                                                          "children": []
                                                        }
                                                      ]
                                                    },
                                                    {
                                                      "type": "StringLiteral",
                                                      "label": "'key'",
                                                      "start_token": 2647,
                                                      "end_token": 2647,
                                                      "children": []
                                                    },
                                                    {
                                                      "type": "StringLiteral",
                                                      "label": "'key'",
                                                      "start_token": 2649,
                                                      "end_token": 2649,
                                                      "children": []
                                                    },
                                                    {
                                                      "type": "ObjectLiteralExpression",
                                                      "label": "{ unique: false }",
                                                      "start_token": 2651,
                                                      "end_token": 2655,
                                                      "children": [
                                                        {
                                                          "type": "PropertyAssignment",
                                                          "label": "unique: false",
                                                          "start_token": 2652,
                                                          "end_token": 2654,
                                                          "children": [
                                                            {
                                                              "type": "Identifier",
                                                              "label": "unique",
                                                              "start_token": 2652,
                                                              "end_token": 2652,
                                                              "children": []
                                                            },
                                                            {
                                                              "type": "FalseKeyword",
                                                              "label": "false",
                                                              "start_token": 2654,
                                                              "end_token": 2654,
                                                              "children": []
                                                            }
                                                          ]
                                                        }
                                                      ]
                                                    }
                                                  ]
                                                }
                                              ]
                                            },
                                            {
                                              "type": "ExpressionStatement",
                                              "label": "invertedIndexStore.createIndex('nid', 'nid', { unique: false });",
                                              "start_token": 2658,
                                              "end_token": 2672,
                                              "children": [
                                                {
                                                  "type": "CallExpression",
                                                  "label": "invertedIndexStore.createIndex('nid', 'nid', { unique: false })",
                                                  "start_token": 2658,
                                                  "end_token": 2671,
                                                  "children": [
                                                    {
                                                      "type": "PropertyAccessExpression",
                                                      "label": "invertedIndexStore.createIndex",
                                                      "start_token": 2658,
                                                      "end_token": 2660,
                                                      "children": [
                                                        {
                                                          "type": "Identifier",
                                                          "label": "invertedIndexStore",
                                                          "start_token": 2658,
                                                          "end_token": 2658,
                                                          "children": []
                                                        },
                                                        {
                                                          "type": "Identifier",
                                                          "label": "createIndex",
                                                          "start_token": 2660,
                                                          "end_token": 2660,
                                                          "children": []
                                                        }
                                                      ]
                                                    },
                                                    {
                                                      "type": "StringLiteral",
                                                      "label": "'nid'",
                                                      "start_token": 2662,
                                                      "end_token": 2662,
                                                      "children": []
                                                    },
                                                    {
                                                      "type": "StringLiteral",
                                                      "label": "'nid'",
                                                      "start_token": 2664,
                                                      "end_token": 2664,
                                                      "children": []
                                                    },
                                                    {
                                                      "type": "ObjectLiteralExpression",
                                                      "label": "{ unique: false }",
                                                      "start_token": 2666,
                                                      "end_token": 2670,
                                                      "children": [
                                                        {
                                                          "type": "PropertyAssignment",
                                                          "label": "unique: false",
                                                          "start_token": 2667,
                                                          "end_token": 2669,
                                                          "children": [
                                                            {
                                                              "type": "Identifier",
                                                              "label": "unique",
                                                              "start_token": 2667,
                                                              "end_token": 2667,
                                                              "children": []
                                                            },
                                                            {
                                                              "type": "FalseKeyword",
                                                              "label": "false",
                                                              "start_token": 2669,
                                                              "end_token": 2669,
                                                              "children": []
                                                            }
                                                          ]
                                                        }
                                                      ]
                                                    }
                                                  ]
                                                }
                                              ]
                                            }
                                          ]
                                        }
                                      ]
                                    }
                                  ]
                                }
                              ]
                            }
                          ]
                        }
                      ]
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "type": "MethodDeclaration",
          "label": "private resultNode(\n    record: { id: string; data: Map<string, string[]> },\n    options: SearchOptions<any>,\n    match?: Match,\n    nid?: number\n  ): SearchResult<any, any>['nodes'][number] {\n    const node = {\n      id: record.id,\n      score: match && nid ? match.getScore(nid) : 1,\n    } as any;\n    if (options.fields) {\n      const fields = {} as Record<string, string | string[]>;\n      for (const field of options.fields as string[]) {\n        fields[field] = record.data.get(field) ?? [''];\n        if (fields[field].length === 1) {\n          fields[field] = fields[field][0];\n        }\n      }\n      node.fields = fields;\n    }\n    if (match && nid && options.highlights) {\n      const highlights = {} as Record<string, string[]>;\n      for (const { field, before, end } of options.highlights) {\n        const highlightValues = match.getHighlighters(nid, field);\n        if (highlightValues) {\n          const rawValues = record.data.get(field) ?? [];\n          highlights[field] = Array.from(highlightValues)\n            .map(([index, ranges]) => {\n              const raw = rawValues[index];\n              if (raw) {\n                return (\n                  highlighter(raw, before, end, ranges, {\n                    maxPrefix: 20,\n                    maxLength: 50,\n                  }) ?? ''\n                );\n              }\n              return '';\n            })\n            .filter(Boolean);\n        }\n      }\n      node.highlights = highlights;\n    }\n    return node;\n  }",
          "start_token": 2679,
          "end_token": 3015,
          "children": [
            {
              "type": "PrivateKeyword",
              "label": "private",
              "start_token": 2679,
              "end_token": 2679,
              "children": []
            },
            {
              "type": "Identifier",
              "label": "resultNode",
              "start_token": 2680,
              "end_token": 2680,
              "children": []
            },
            {
              "type": "Parameter",
              "label": "record: { id: string; data: Map<string, string[]> }",
              "start_token": 2682,
              "end_token": 2699,
              "children": [
                {
                  "type": "Identifier",
                  "label": "record",
                  "start_token": 2682,
                  "end_token": 2682,
                  "children": []
                },
                {
                  "type": "TypeLiteral",
                  "label": "{ id: string; data: Map<string, string[]> }",
                  "start_token": 2684,
                  "end_token": 2699,
                  "children": [
                    {
                      "type": "PropertySignature",
                      "label": "id: string;",
                      "start_token": 2685,
                      "end_token": 2688,
                      "children": [
                        {
                          "type": "Identifier",
                          "label": "id",
                          "start_token": 2685,
                          "end_token": 2685,
                          "children": []
                        },
                        {
                          "type": "StringKeyword",
                          "label": "string",
                          "start_token": 2687,
                          "end_token": 2687,
                          "children": []
                        }
                      ]
                    },
                    {
                      "type": "PropertySignature",
                      "label": "data: Map<string, string[]>",
                      "start_token": 2689,
                      "end_token": 2698,
                      "children": [
                        {
                          "type": "Identifier",
                          "label": "data",
                          "start_token": 2689,
                          "end_token": 2689,
                          "children": []
                        },
                        {
                          "type": "TypeReference",
                          "label": "Map<string, string[]>",
                          "start_token": 2691,
                          "end_token": 2698,
                          "children": [
                            {
                              "type": "Identifier",
                              "label": "Map",
                              "start_token": 2691,
                              "end_token": 2691,
                              "children": []
                            },
                            {
                              "type": "StringKeyword",
                              "label": "string",
                              "start_token": 2693,
                              "end_token": 2693,
                              "children": []
                            },
                            {
                              "type": "ArrayType",
                              "label": "string[]",
                              "start_token": 2695,
                              "end_token": 2697,
                              "children": [
                                {
                                  "type": "StringKeyword",
                                  "label": "string",
                                  "start_token": 2695,
                                  "end_token": 2695,
                                  "children": []
                                }
                              ]
                            }
                          ]
                        }
                      ]
                    }
                  ]
                }
              ]
            },
            {
              "type": "Parameter",
              "label": "options: SearchOptions<any>",
              "start_token": 2701,
              "end_token": 2706,
              "children": [
                {
                  "type": "Identifier",
                  "label": "options",
                  "start_token": 2701,
                  "end_token": 2701,
                  "children": []
                },
                {
                  "type": "TypeReference",
                  "label": "SearchOptions<any>",
                  "start_token": 2703,
                  "end_token": 2706,
                  "children": [
                    {
                      "type": "Identifier",
                      "label": "SearchOptions",
                      "start_token": 2703,
                      "end_token": 2703,
                      "children": []
                    },
                    {
                      "type": "AnyKeyword",
                      "label": "any",
                      "start_token": 2705,
                      "end_token": 2705,
                      "children": []
                    }
                  ]
                }
              ]
            },
            {
              "type": "Parameter",
              "label": "match?: Match",
              "start_token": 2708,
              "end_token": 2711,
              "children": [
                {
                  "type": "Identifier",
                  "label": "match",
                  "start_token": 2708,
                  "end_token": 2708,
                  "children": []
                },
                {
                  "type": "QuestionToken",
                  "label": "?",
                  "start_token": 2709,
                  "end_token": 2709,
                  "children": []
                },
                {
                  "type": "TypeReference",
                  "label": "Match",
                  "start_token": 2711,
                  "end_token": 2711,
                  "children": [
                    {
                      "type": "Identifier",
                      "label": "Match",
                      "start_token": 2711,
                      "end_token": 2711,
                      "children": []
                    }
                  ]
                }
              ]
            },
            {
              "type": "Parameter",
              "label": "nid?: number",
              "start_token": 2713,
              "end_token": 2716,
              "children": [
                {
                  "type": "Identifier",
                  "label": "nid",
                  "start_token": 2713,
                  "end_token": 2713,
                  "children": []
                },
                {
                  "type": "QuestionToken",
                  "label": "?",
                  "start_token": 2714,
                  "end_token": 2714,
                  "children": []
                },
                {
                  "type": "NumberKeyword",
                  "label": "number",
                  "start_token": 2716,
                  "end_token": 2716,
                  "children": []
                }
              ]
            },
            {
              "type": "IndexedAccessType",
              "label": "SearchResult<any, any>['nodes'][number]",
              "start_token": 2719,
              "end_token": 2730,
              "children": [
                {
                  "type": "IndexedAccessType",
                  "label": "SearchResult<any, any>['nodes']",
                  "start_token": 2719,
                  "end_token": 2727,
                  "children": [
                    {
                      "type": "TypeReference",
                      "label": "SearchResult<any, any>",
                      "start_token": 2719,
                      "end_token": 2724,
                      "children": [
                        {
                          "type": "Identifier",
                          "label": "SearchResult",
                          "start_token": 2719,
                          "end_token": 2719,
                          "children": []
                        },
                        {
                          "type": "AnyKeyword",
                          "label": "any",
                          "start_token": 2721,
                          "end_token": 2721,
                          "children": []
                        },
                        {
                          "type": "AnyKeyword",
                          "label": "any",
                          "start_token": 2723,
                          "end_token": 2723,
                          "children": []
                        }
                      ]
                    },
                    {
                      "type": "LiteralType",
                      "label": "'nodes'",
                      "start_token": 2726,
                      "end_token": 2726,
                      "children": [
                        {
                          "type": "StringLiteral",
                          "label": "'nodes'",
                          "start_token": 2726,
                          "end_token": 2726,
                          "children": []
                        }
                      ]
                    }
                  ]
                },
                {
                  "type": "NumberKeyword",
                  "label": "number",
                  "start_token": 2729,
                  "end_token": 2729,
                  "children": []
                }
              ]
            },
            {
              "type": "Block",
              "label": "{\n    const node = {\n      id: record.id,\n      score: match && nid ? match.getScore(nid) : 1,\n    } as any;\n    if (options.fields) {\n      const fields = {} as Record<string, string | string[]>;\n      for (const field of options.fields as string[]) {\n        fields[field] = record.data.get(field) ?? [''];\n        if (fields[field].length === 1) {\n          fields[field] = fields[field][0];\n        }\n      }\n      node.fields = fields;\n    }\n    if (match && nid && options.highlights) {\n      const highlights = {} as Record<string, string[]>;\n      for (const { field, before, end } of options.highlights) {\n        const highlightValues = match.getHighlighters(nid, field);\n        if (highlightValues) {\n          const rawValues = record.data.get(field) ?? [];\n          highlights[field] = Array.from(highlightValues)\n            .map(([index, ranges]) => {\n              const raw = rawValues[index];\n              if (raw) {\n                return (\n                  highlighter(raw, before, end, ranges, {\n                    maxPrefix: 20,\n                    maxLength: 50,\n                  }) ?? ''\n                );\n              }\n              return '';\n            })\n            .filter(Boolean);\n        }\n      }\n      node.highlights = highlights;\n    }\n    return node;\n  }",
              "start_token": 2731,
              "end_token": 3015,
              "children": [
                {
                  "type": "FirstStatement",
                  "label": "const node = {\n      id: record.id,\n      score: match && nid ? match.getScore(nid) : 1,\n    } as any;",
                  "start_token": 2732,
                  "end_token": 2760,
                  "children": [
                    {
                      "type": "VariableDeclarationList",
                      "label": "const node = {\n      id: record.id,\n      score: match && nid ? match.getScore(nid) : 1,\n    } as any",
                      "start_token": 2732,
                      "end_token": 2759,
                      "children": [
                        {
                          "type": "VariableDeclaration",
                          "label": "node = {\n      id: record.id,\n      score: match && nid ? match.getScore(nid) : 1,\n    } as any",
                          "start_token": 2733,
                          "end_token": 2759,
                          "children": [
                            {
                              "type": "Identifier",
                              "label": "node",
                              "start_token": 2733,
                              "end_token": 2733,
                              "children": []
                            },
                            {
                              "type": "AsExpression",
                              "label": "{\n      id: record.id,\n      score: match && nid ? match.getScore(nid) : 1,\n    } as any",
                              "start_token": 2735,
                              "end_token": 2759,
                              "children": [
                                {
                                  "type": "ObjectLiteralExpression",
                                  "label": "{\n      id: record.id,\n      score: match && nid ? match.getScore(nid) : 1,\n    }",
                                  "start_token": 2735,
                                  "end_token": 2757,
                                  "children": [
                                    {
                                      "type": "PropertyAssignment",
                                      "label": "id: record.id",
                                      "start_token": 2736,
                                      "end_token": 2740,
                                      "children": [
                                        {
                                          "type": "Identifier",
                                          "label": "id",
                                          "start_token": 2736,
                                          "end_token": 2736,
                                          "children": []
                                        },
                                        {
                                          "type": "PropertyAccessExpression",
                                          "label": "record.id",
                                          "start_token": 2738,
                                          "end_token": 2740,
                                          "children": [
                                            {
                                              "type": "Identifier",
                                              "label": "record",
                                              "start_token": 2738,
                                              "end_token": 2738,
                                              "children": []
                                            },
                                            {
                                              "type": "Identifier",
                                              "label": "id",
                                              "start_token": 2740,
                                              "end_token": 2740,
                                              "children": []
                                            }
                                          ]
                                        }
                                      ]
                                    },
                                    {
                                      "type": "PropertyAssignment",
                                      "label": "score: match && nid ? match.getScore(nid) : 1",
                                      "start_token": 2742,
                                      "end_token": 2755,
                                      "children": [
                                        {
                                          "type": "Identifier",
                                          "label": "score",
                                          "start_token": 2742,
                                          "end_token": 2742,
                                          "children": []
                                        },
                                        {
                                          "type": "ConditionalExpression",
                                          "label": "match && nid ? match.getScore(nid) : 1",
                                          "start_token": 2744,
                                          "end_token": 2755,
                                          "children": [
                                            {
                                              "type": "BinaryExpression",
                                              "label": "match && nid",
                                              "start_token": 2744,
                                              "end_token": 2746,
                                              "children": [
                                                {
                                                  "type": "Identifier",
                                                  "label": "match",
                                                  "start_token": 2744,
                                                  "end_token": 2744,
                                                  "children": []
                                                },
                                                {
                                                  "type": "AmpersandAmpersandToken",
                                                  "label": "&&",
                                                  "start_token": 2745,
                                                  "end_token": 2745,
                                                  "children": []
                                                },
                                                {
                                                  "type": "Identifier",
                                                  "label": "nid",
                                                  "start_token": 2746,
                                                  "end_token": 2746,
                                                  "children": []
                                                }
                                              ]
                                            },
                                            {
                                              "type": "QuestionToken",
                                              "label": "?",
                                              "start_token": 2747,
                                              "end_token": 2747,
                                              "children": []
                                            },
                                            {
                                              "type": "CallExpression",
                                              "label": "match.getScore(nid)",
                                              "start_token": 2748,
                                              "end_token": 2753,
                                              "children": [
                                                {
                                                  "type": "PropertyAccessExpression",
                                                  "label": "match.getScore",
                                                  "start_token": 2748,
                                                  "end_token": 2750,
                                                  "children": [
                                                    {
                                                      "type": "Identifier",
                                                      "label": "match",
                                                      "start_token": 2748,
                                                      "end_token": 2748,
                                                      "children": []
                                                    },
                                                    {
                                                      "type": "Identifier",
                                                      "label": "getScore",
                                                      "start_token": 2750,
                                                      "end_token": 2750,
                                                      "children": []
                                                    }
                                                  ]
                                                },
                                                {
                                                  "type": "Identifier",
                                                  "label": "nid",
                                                  "start_token": 2752,
                                                  "end_token": 2752,
                                                  "children": []
                                                }
                                              ]
                                            },
                                            {
                                              "type": "ColonToken",
                                              "label": ":",
                                              "start_token": 2754,
                                              "end_token": 2754,
                                              "children": []
                                            },
                                            {
                                              "type": "FirstLiteralToken",
                                              "label": "1",
                                              "start_token": 2755,
                                              "end_token": 2755,
                                              "children": []
                                            }
                                          ]
                                        }
                                      ]
                                    }
                                  ]
                                },
                                {
                                  "type": "AnyKeyword",
                                  "label": "any",
                                  "start_token": 2759,
                                  "end_token": 2759,
                                  "children": []
                                }
                              ]
                            }
                          ]
                        }
                      ]
                    }
                  ]
                },
                {
                  "type": "IfStatement",
                  "label": "if (options.fields) {\n      const fields = {} as Record<string, string | string[]>;\n      for (const field of options.fields as string[]) {\n        fields[field] = record.data.get(field) ?? [''];\n        if (fields[field].length === 1) {\n          fields[field] = fields[field][0];\n        }\n      }\n      node.fields = fields;\n    }",
                  "start_token": 2761,
                  "end_token": 2851,
                  "children": [
                    {
                      "type": "PropertyAccessExpression",
                      "label": "options.fields",
                      "start_token": 2763,
                      "end_token": 2765,
                      "children": [
                        {
                          "type": "Identifier",
                          "label": "options",
                          "start_token": 2763,
                          "end_token": 2763,
                          "children": []
                        },
                        {
                          "type": "Identifier",
                          "label": "fields",
                          "start_token": 2765,
                          "end_token": 2765,
                          "children": []
                        }
                      ]
                    },
                    {
                      "type": "Block",
                      "label": "{\n      const fields = {} as Record<string, string | string[]>;\n      for (const field of options.fields as string[]) {\n        fields[field] = record.data.get(field) ?? [''];\n        if (fields[field].length === 1) {\n          fields[field] = fields[field][0];\n        }\n      }\n      node.fields = fields;\n    }",
                      "start_token": 2767,
                      "end_token": 2851,
                      "children": [
                        {
                          "type": "FirstStatement",
                          "label": "const fields = {} as Record<string, string | string[]>;",
                          "start_token": 2768,
                          "end_token": 2784,
                          "children": [
                            {
                              "type": "VariableDeclarationList",
                              "label": "const fields = {} as Record<string, string | string[]>",
                              "start_token": 2768,
                              "end_token": 2783,
                              "children": [
                                {
                                  "type": "VariableDeclaration",
                                  "label": "fields = {} as Record<string, string | string[]>",
                                  "start_token": 2769,
                                  "end_token": 2783,
                                  "children": [
                                    {
                                      "type": "Identifier",
                                      "label": "fields",
                                      "start_token": 2769,
                                      "end_token": 2769,
                                      "children": []
                                    },
                                    {
                                      "type": "AsExpression",
                                      "label": "{} as Record<string, string | string[]>",
                                      "start_token": 2771,
                                      "end_token": 2783,
                                      "children": [
                                        {
                                          "type": "ObjectLiteralExpression",
                                          "label": "{}",
                                          "start_token": 2771,
                                          "end_token": 2772,
                                          "children": []
                                        },
                                        {
                                          "type": "TypeReference",
                                          "label": "Record<string, string | string[]>",
                                          "start_token": 2774,
                                          "end_token": 2783,
                                          "children": [
                                            {
                                              "type": "Identifier",
                                              "label": "Record",
                                              "start_token": 2774,
                                              "end_token": 2774,
                                              "children": []
                                            },
                                            {
                                              "type": "StringKeyword",
                                              "label": "string",
                                              "start_token": 2776,
                                              "end_token": 2776,
                                              "children": []
                                            },
                                            {
                                              "type": "UnionType",
                                              "label": "string | string[]",
                                              "start_token": 2778,
                                              "end_token": 2782,
                                              "children": [
                                                {
                                                  "type": "StringKeyword",
                                                  "label": "string",
                                                  "start_token": 2778,
                                                  "end_token": 2778,
                                                  "children": []
                                                },
                                                {
                                                  "type": "ArrayType",
                                                  "label": "string[]",
                                                  "start_token": 2780,
                                                  "end_token": 2782,
                                                  "children": [
                                                    {
                                                      "type": "StringKeyword",
                                                      "label": "string",
                                                      "start_token": 2780,
                                                      "end_token": 2780,
                                                      "children": []
                                                    }
                                                  ]
                                                }
                                              ]
                                            }
                                          ]
                                        }
                                      ]
                                    }
                                  ]
                                }
                              ]
                            }
                          ]
                        },
                        {
                          "type": "ForOfStatement",
                          "label": "for (const field of options.fields as string[]) {\n        fields[field] = record.data.get(field) ?? [''];\n        if (fields[field].length === 1) {\n          fields[field] = fields[field][0];\n        }\n      }",
                          "start_token": 2785,
                          "end_token": 2844,
                          "children": [
                            {
                              "type": "VariableDeclarationList",
                              "label": "const field",
                              "start_token": 2787,
                              "end_token": 2788,
                              "children": [
                                {
                                  "type": "VariableDeclaration",
                                  "label": "field",
                                  "start_token": 2788,
                                  "end_token": 2788,
                                  "children": [
                                    {
                                      "type": "Identifier",
                                      "label": "field",
                                      "start_token": 2788,
                                      "end_token": 2788,
                                      "children": []
                                    }
                                  ]
                                }
                              ]
                            },
                            {
                              "type": "AsExpression",
                              "label": "options.fields as string[]",
                              "start_token": 2790,
                              "end_token": 2796,
                              "children": [
                                {
                                  "type": "PropertyAccessExpression",
                                  "label": "options.fields",
                                  "start_token": 2790,
                                  "end_token": 2792,
                                  "children": [
                                    {
                                      "type": "Identifier",
                                      "label": "options",
                                      "start_token": 2790,
                                      "end_token": 2790,
                                      "children": []
                                    },
                                    {
                                      "type": "Identifier",
                                      "label": "fields",
                                      "start_token": 2792,
                                      "end_token": 2792,
                                      "children": []
                                    }
                                  ]
                                },
                                {
                                  "type": "ArrayType",
                                  "label": "string[]",
                                  "start_token": 2794,
                                  "end_token": 2796,
                                  "children": [
                                    {
                                      "type": "StringKeyword",
                                      "label": "string",
                                      "start_token": 2794,
                                      "end_token": 2794,
                                      "children": []
                                    }
                                  ]
                                }
                              ]
                            },
                            {
                              "type": "Block",
                              "label": "{\n        fields[field] = record.data.get(field) ?? [''];\n        if (fields[field].length === 1) {\n          fields[field] = fields[field][0];\n        }\n      }",
                              "start_token": 2798,
                              "end_token": 2844,
                              "children": [
                                {
                                  "type": "ExpressionStatement",
                                  "label": "fields[field] = record.data.get(field) ?? [''];",
                                  "start_token": 2799,
                                  "end_token": 2817,
                                  "children": [
                                    {
                                      "type": "BinaryExpression",
                                      "label": "fields[field] = record.data.get(field) ?? ['']",
                                      "start_token": 2799,
                                      "end_token": 2816,
                                      "children": [
                                        {
                                          "type": "ElementAccessExpression",
                                          "label": "fields[field]",
                                          "start_token": 2799,
                                          "end_token": 2802,
                                          "children": [
                                            {
                                              "type": "Identifier",
                                              "label": "fields",
                                              "start_token": 2799,
                                              "end_token": 2799,
                                              "children": []
                                            },
                                            {
                                              "type": "Identifier",
                                              "label": "field",
                                              "start_token": 2801,
                                              "end_token": 2801,
                                              "children": []
                                            }
                                          ]
                                        },
                                        {
                                          "type": "FirstAssignment",
                                          "label": "=",
                                          "start_token": 2803,
                                          "end_token": 2803,
                                          "children": []
                                        },
                                        {
                                          "type": "BinaryExpression",
                                          "label": "record.data.get(field) ?? ['']",
                                          "start_token": 2804,
                                          "end_token": 2816,
                                          "children": [
                                            {
                                              "type": "CallExpression",
                                              "label": "record.data.get(field)",
                                              "start_token": 2804,
                                              "end_token": 2811,
                                              "children": [
                                                {
                                                  "type": "PropertyAccessExpression",
                                                  "label": "record.data.get",
                                                  "start_token": 2804,
                                                  "end_token": 2808,
                                                  "children": [
                                                    {
                                                      "type": "PropertyAccessExpression",
                                                      "label": "record.data",
                                                      "start_token": 2804,
                                                      "end_token": 2806,
                                                      "children": [
                                                        {
                                                          "type": "Identifier",
                                                          "label": "record",
                                                          "start_token": 2804,
                                                          "end_token": 2804,
                                                          "children": []
                                                        },
                                                        {
                                                          "type": "Identifier",
                                                          "label": "data",
                                                          "start_token": 2806,
                                                          "end_token": 2806,
                                                          "children": []
                                                        }
                                                      ]
                                                    },
                                                    {
                                                      "type": "Identifier",
                                                      "label": "get",
                                                      "start_token": 2808,
                                                      "end_token": 2808,
                                                      "children": []
                                                    }
                                                  ]
                                                },
                                                {
                                                  "type": "Identifier",
                                                  "label": "field",
                                                  "start_token": 2810,
                                                  "end_token": 2810,
                                                  "children": []
                                                }
                                              ]
                                            },
                                            {
                                              "type": "QuestionQuestionToken",
                                              "label": "??",
                                              "start_token": 2812,
                                              "end_token": 2813,
                                              "children": []
                                            },
                                            {
                                              "type": "ArrayLiteralExpression",
                                              "label": "['']",
                                              "start_token": 2814,
                                              "end_token": 2816,
                                              "children": [
                                                {
                                                  "type": "StringLiteral",
                                                  "label": "''",
                                                  "start_token": 2815,
                                                  "end_token": 2815,
                                                  "children": []
                                                }
                                              ]
                                            }
                                          ]
                                        }
                                      ]
                                    }
                                  ]
                                },
                                {
                                  "type": "IfStatement",
                                  "label": "if (fields[field].length === 1) {\n          fields[field] = fields[field][0];\n        }",
                                  "start_token": 2818,
                                  "end_token": 2843,
                                  "children": [
                                    {
                                      "type": "BinaryExpression",
                                      "label": "fields[field].length === 1",
                                      "start_token": 2820,
                                      "end_token": 2827,
                                      "children": [
                                        {
                                          "type": "PropertyAccessExpression",
                                          "label": "fields[field].length",
                                          "start_token": 2820,
                                          "end_token": 2825,
                                          "children": [
                                            {
                                              "type": "ElementAccessExpression",
                                              "label": "fields[field]",
                                              "start_token": 2820,
                                              "end_token": 2823,
                                              "children": [
                                                {
                                                  "type": "Identifier",
                                                  "label": "fields",
                                                  "start_token": 2820,
                                                  "end_token": 2820,
                                                  "children": []
                                                },
                                                {
                                                  "type": "Identifier",
                                                  "label": "field",
                                                  "start_token": 2822,
                                                  "end_token": 2822,
                                                  "children": []
                                                }
                                              ]
                                            },
                                            {
                                              "type": "Identifier",
                                              "label": "length",
                                              "start_token": 2825,
                                              "end_token": 2825,
                                              "children": []
                                            }
                                          ]
                                        },
                                        {
                                          "type": "EqualsEqualsEqualsToken",
                                          "label": "===",
                                          "start_token": 2826,
                                          "end_token": 2826,
                                          "children": []
                                        },
                                        {
                                          "type": "FirstLiteralToken",
                                          "label": "1",
                                          "start_token": 2827,
                                          "end_token": 2827,
                                          "children": []
                                        }
                                      ]
                                    },
                                    {
                                      "type": "Block",
                                      "label": "{\n          fields[field] = fields[field][0];\n        }",
                                      "start_token": 2829,
                                      "end_token": 2843,
                                      "children": [
                                        {
                                          "type": "ExpressionStatement",
                                          "label": "fields[field] = fields[field][0];",
                                          "start_token": 2830,
                                          "end_token": 2842,
                                          "children": [
                                            {
                                              "type": "BinaryExpression",
                                              "label": "fields[field] = fields[field][0]",
                                              "start_token": 2830,
                                              "end_token": 2841,
                                              "children": [
                                                {
                                                  "type": "ElementAccessExpression",
                                                  "label": "fields[field]",
                                                  "start_token": 2830,
                                                  "end_token": 2833,
                                                  "children": [
                                                    {
                                                      "type": "Identifier",
                                                      "label": "fields",
                                                      "start_token": 2830,
                                                      "end_token": 2830,
                                                      "children": []
                                                    },
                                                    {
                                                      "type": "Identifier",
                                                      "label": "field",
                                                      "start_token": 2832,
                                                      "end_token": 2832,
                                                      "children": []
                                                    }
                                                  ]
                                                },
                                                {
                                                  "type": "FirstAssignment",
                                                  "label": "=",
                                                  "start_token": 2834,
                                                  "end_token": 2834,
                                                  "children": []
                                                },
                                                {
                                                  "type": "ElementAccessExpression",
                                                  "label": "fields[field][0]",
                                                  "start_token": 2835,
                                                  "end_token": 2841,
                                                  "children": [
                                                    {
                                                      "type": "ElementAccessExpression",
                                                      "label": "fields[field]",
                                                      "start_token": 2835,
                                                      "end_token": 2838,
                                                      "children": [
                                                        {
                                                          "type": "Identifier",
                                                          "label": "fields",
                                                          "start_token": 2835,
                                                          "end_token": 2835,
                                                          "children": []
                                                        },
                                                        {
                                                          "type": "Identifier",
                                                          "label": "field",
                                                          "start_token": 2837,
                                                          "end_token": 2837,
                                                          "children": []
                                                        }
                                                      ]
                                                    },
                                                    {
                                                      "type": "FirstLiteralToken",
                                                      "label": "0",
                                                      "start_token": 2840,
                                                      "end_token": 2840,
                                                      "children": []
                                                    }
                                                  ]
                                                }
                                              ]
                                            }
                                          ]
                                        }
                                      ]
                                    }
                                  ]
                                }
                              ]
                            }
                          ]
                        },
                        {
                          "type": "ExpressionStatement",
                          "label": "node.fields = fields;",
                          "start_token": 2845,
                          "end_token": 2850,
                          "children": [
                            {
                              "type": "BinaryExpression",
                              "label": "node.fields = fields",
                              "start_token": 2845,
                              "end_token": 2849,
                              "children": [
                                {
                                  "type": "PropertyAccessExpression",
                                  "label": "node.fields",
                                  "start_token": 2845,
                                  "end_token": 2847,
                                  "children": [
                                    {
                                      "type": "Identifier",
                                      "label": "node",
                                      "start_token": 2845,
                                      "end_token": 2845,
                                      "children": []
                                    },
                                    {
                                      "type": "Identifier",
                                      "label": "fields",
                                      "start_token": 2847,
                                      "end_token": 2847,
                                      "children": []
                                    }
                                  ]
                                },
                                {
                                  "type": "FirstAssignment",
                                  "label": "=",
                                  "start_token": 2848,
                                  "end_token": 2848,
                                  "children": []
                                },
                                {
                                  "type": "Identifier",
                                  "label": "fields",
                                  "start_token": 2849,
                                  "end_token": 2849,
                                  "children": []
                                }
                              ]
                            }
                          ]
                        }
                      ]
                    }
                  ]
                },
                {
                  "type": "IfStatement",
                  "label": "if (match && nid && options.highlights) {\n      const highlights = {} as Record<string, string[]>;\n      for (const { field, before, end } of options.highlights) {\n        const highlightValues = match.getHighlighters(nid, field);\n        if (highlightValues) {\n          const rawValues = record.data.get(field) ?? [];\n          highlights[field] = Array.from(highlightValues)\n            .map(([index, ranges]) => {\n              const raw = rawValues[index];\n              if (raw) {\n                return (\n                  highlighter(raw, before, end, ranges, {\n                    maxPrefix: 20,\n                    maxLength: 50,\n                  }) ?? ''\n                );\n              }\n              return '';\n            })\n            .filter(Boolean);\n        }\n      }\n      node.highlights = highlights;\n    }",
                  "start_token": 2852,
                  "end_token": 3011,
                  "children": [
                    {
                      "type": "BinaryExpression",
                      "label": "match && nid && options.highlights",
                      "start_token": 2854,
                      "end_token": 2860,
                      "children": [
                        {
                          "type": "BinaryExpression",
                          "label": "match && nid",
                          "start_token": 2854,
                          "end_token": 2856,
                          "children": [
                            {
                              "type": "Identifier",
                              "label": "match",
                              "start_token": 2854,
                              "end_token": 2854,
                              "children": []
                            },
                            {
                              "type": "AmpersandAmpersandToken",
                              "label": "&&",
                              "start_token": 2855,
                              "end_token": 2855,
                              "children": []
                            },
                            {
                              "type": "Identifier",
                              "label": "nid",
                              "start_token": 2856,
                              "end_token": 2856,
                              "children": []
                            }
                          ]
                        },
                        {
                          "type": "AmpersandAmpersandToken",
                          "label": "&&",
                          "start_token": 2857,
                          "end_token": 2857,
                          "children": []
                        },
                        {
                          "type": "PropertyAccessExpression",
                          "label": "options.highlights",
                          "start_token": 2858,
                          "end_token": 2860,
                          "children": [
                            {
                              "type": "Identifier",
                              "label": "options",
                              "start_token": 2858,
                              "end_token": 2858,
                              "children": []
                            },
                            {
                              "type": "Identifier",
                              "label": "highlights",
                              "start_token": 2860,
                              "end_token": 2860,
                              "children": []
                            }
                          ]
                        }
                      ]
                    },
                    {
                      "type": "Block",
                      "label": "{\n      const highlights = {} as Record<string, string[]>;\n      for (const { field, before, end } of options.highlights) {\n        const highlightValues = match.getHighlighters(nid, field);\n        if (highlightValues) {\n          const rawValues = record.data.get(field) ?? [];\n          highlights[field] = Array.from(highlightValues)\n            .map(([index, ranges]) => {\n              const raw = rawValues[index];\n              if (raw) {\n                return (\n                  highlighter(raw, before, end, ranges, {\n                    maxPrefix: 20,\n                    maxLength: 50,\n                  }) ?? ''\n                );\n              }\n              return '';\n            })\n            .filter(Boolean);\n        }\n      }\n      node.highlights = highlights;\n    }",
                      "start_token": 2862,
                      "end_token": 3011,
                      "children": [
                        {
                          "type": "FirstStatement",
                          "label": "const highlights = {} as Record<string, string[]>;",
                          "start_token": 2863,
                          "end_token": 2877,
                          "children": [
                            {
                              "type": "VariableDeclarationList",
                              "label": "const highlights = {} as Record<string, string[]>",
                              "start_token": 2863,
                              "end_token": 2876,
                              "children": [
                                {
                                  "type": "VariableDeclaration",
                                  "label": "highlights = {} as Record<string, string[]>",
                                  "start_token": 2864,
                                  "end_token": 2876,
                                  "children": [
                                    {
                                      "type": "Identifier",
                                      "label": "highlights",
                                      "start_token": 2864,
                                      "end_token": 2864,
                                      "children": []
                                    },
                                    {
                                      "type": "AsExpression",
                                      "label": "{} as Record<string, string[]>",
                                      "start_token": 2866,
                                      "end_token": 2876,
                                      "children": [
                                        {
                                          "type": "ObjectLiteralExpression",
                                          "label": "{}",
                                          "start_token": 2866,
                                          "end_token": 2867,
                                          "children": []
                                        },
                                        {
                                          "type": "TypeReference",
                                          "label": "Record<string, string[]>",
                                          "start_token": 2869,
                                          "end_token": 2876,
                                          "children": [
                                            {
                                              "type": "Identifier",
                                              "label": "Record",
                                              "start_token": 2869,
                                              "end_token": 2869,
                                              "children": []
                                            },
                                            {
                                              "type": "StringKeyword",
                                              "label": "string",
                                              "start_token": 2871,
                                              "end_token": 2871,
                                              "children": []
                                            },
                                            {
                                              "type": "ArrayType",
                                              "label": "string[]",
                                              "start_token": 2873,
                                              "end_token": 2875,
                                              "children": [
                                                {
                                                  "type": "StringKeyword",
                                                  "label": "string",
                                                  "start_token": 2873,
                                                  "end_token": 2873,
                                                  "children": []
                                                }
                                              ]
                                            }
                                          ]
                                        }
                                      ]
                                    }
                                  ]
                                }
                              ]
                            }
                          ]
                        },
                        {
                          "type": "ForOfStatement",
                          "label": "for (const { field, before, end } of options.highlights) {\n        const highlightValues = match.getHighlighters(nid, field);\n        if (highlightValues) {\n          const rawValues = record.data.get(field) ?? [];\n          highlights[field] = Array.from(highlightValues)\n            .map(([index, ranges]) => {\n              const raw = rawValues[index];\n              if (raw) {\n                return (\n                  highlighter(raw, before, end, ranges, {\n                    maxPrefix: 20,\n                    maxLength: 50,\n                  }) ?? ''\n                );\n              }\n              return '';\n            })\n            .filter(Boolean);\n        }\n      }",
                          "start_token": 2878,
                          "end_token": 3004,
                          "children": [
                            {
                              "type": "VariableDeclarationList",
                              "label": "const { field, before, end }",
                              "start_token": 2880,
                              "end_token": 2887,
                              "children": [
                                {
                                  "type": "VariableDeclaration",
                                  "label": "{ field, before, end }",
                                  "start_token": 2881,
                                  "end_token": 2887,
                                  "children": [
                                    {
                                      "type": "ObjectBindingPattern",
                                      "label": "{ field, before, end }",
                                      "start_token": 2881,
                                      "end_token": 2887,
                                      "children": [
                                        {
                                          "type": "BindingElement",
                                          "label": "field",
                                          "start_token": 2882,
                                          "end_token": 2882,
                                          "children": [
                                            {
                                              "type": "Identifier",
                                              "label": "field",
                                              "start_token": 2882,
                                              "end_token": 2882,
                                              "children": []
                                            }
                                          ]
                                        },
                                        {
                                          "type": "BindingElement",
                                          "label": "before",
                                          "start_token": 2884,
                                          "end_token": 2884,
                                          "children": [
                                            {
                                              "type": "Identifier",
                                              "label": "before",
                                              "start_token": 2884,
                                              "end_token": 2884,
                                              "children": []
                                            }
                                          ]
                                        },
                                        {
                                          "type": "BindingElement",
                                          "label": "end",
                                          "start_token": 2886,
                                          "end_token": 2886,
                                          "children": [
                                            {
                                              "type": "Identifier",
                                              "label": "end",
                                              "start_token": 2886,
                                              "end_token": 2886,
                                              "children": []
                                            }
                                          ]
                                        }
                                      ]
                                    }
                                  ]
                                }
                              ]
                            },
                            {
                              "type": "PropertyAccessExpression",
                              "label": "options.highlights",
                              "start_token": 2889,
                              "end_token": 2891,
                              "children": [
                                {
                                  "type": "Identifier",
                                  "label": "options",
                                  "start_token": 2889,
                                  "end_token": 2889,
                                  "children": []
                                },
                                {
                                  "type": "Identifier",
                                  "label": "highlights",
                                  "start_token": 2891,
                                  "end_token": 2891,
                                  "children": []
                                }
                              ]
                            },
                            {
                              "type": "Block",
                              "label": "{\n        const highlightValues = match.getHighlighters(nid, field);\n        if (highlightValues) {\n          const rawValues = record.data.get(field) ?? [];\n          highlights[field] = Array.from(highlightValues)\n            .map(([index, ranges]) => {\n              const raw = rawValues[index];\n              if (raw) {\n                return (\n                  highlighter(raw, before, end, ranges, {\n                    maxPrefix: 20,\n                    maxLength: 50,\n                  }) ?? ''\n                );\n              }\n              return '';\n            })\n            .filter(Boolean);\n        }\n      }",
                              "start_token": 2893,
                              "end_token": 3004,
                              "children": [
                                {
                                  "type": "FirstStatement",
                                  "label": "const highlightValues = match.getHighlighters(nid, field);",
                                  "start_token": 2894,
                                  "end_token": 2905,
                                  "children": [
                                    {
                                      "type": "VariableDeclarationList",
                                      "label": "const highlightValues = match.getHighlighters(nid, field)",
                                      "start_token": 2894,
                                      "end_token": 2904,
                                      "children": [
                                        {
                                          "type": "VariableDeclaration",
                                          "label": "highlightValues = match.getHighlighters(nid, field)",
                                          "start_token": 2895,
                                          "end_token": 2904,
                                          "children": [
                                            {
                                              "type": "Identifier",
                                              "label": "highlightValues",
                                              "start_token": 2895,
                                              "end_token": 2895,
                                              "children": []
                                            },
                                            {
                                              "type": "CallExpression",
                                              "label": "match.getHighlighters(nid, field)",
                                              "start_token": 2897,
                                              "end_token": 2904,
                                              "children": [
                                                {
                                                  "type": "PropertyAccessExpression",
                                                  "label": "match.getHighlighters",
                                                  "start_token": 2897,
                                                  "end_token": 2899,
                                                  "children": [
                                                    {
                                                      "type": "Identifier",
                                                      "label": "match",
                                                      "start_token": 2897,
                                                      "end_token": 2897,
                                                      "children": []
                                                    },
                                                    {
                                                      "type": "Identifier",
                                                      "label": "getHighlighters",
                                                      "start_token": 2899,
                                                      "end_token": 2899,
                                                      "children": []
                                                    }
                                                  ]
                                                },
                                                {
                                                  "type": "Identifier",
                                                  "label": "nid",
                                                  "start_token": 2901,
                                                  "end_token": 2901,
                                                  "children": []
                                                },
                                                {
                                                  "type": "Identifier",
                                                  "label": "field",
                                                  "start_token": 2903,
                                                  "end_token": 2903,
                                                  "children": []
                                                }
                                              ]
                                            }
                                          ]
                                        }
                                      ]
                                    }
                                  ]
                                },
                                {
                                  "type": "IfStatement",
                                  "label": "if (highlightValues) {\n          const rawValues = record.data.get(field) ?? [];\n          highlights[field] = Array.from(highlightValues)\n            .map(([index, ranges]) => {\n              const raw = rawValues[index];\n              if (raw) {\n                return (\n                  highlighter(raw, before, end, ranges, {\n                    maxPrefix: 20,\n                    maxLength: 50,\n                  }) ?? ''\n                );\n              }\n              return '';\n            })\n            .filter(Boolean);\n        }",
                                  "start_token": 2906,
                                  "end_token": 3003,
                                  "children": [
                                    {
                                      "type": "Identifier",
                                      "label": "highlightValues",
                                      "start_token": 2908,
                                      "end_token": 2908,
                                      "children": []
                                    },
                                    {
                                      "type": "Block",
                                      "label": "{\n          const rawValues = record.data.get(field) ?? [];\n          highlights[field] = Array.from(highlightValues)\n            .map(([index, ranges]) => {\n              const raw = rawValues[index];\n              if (raw) {\n                return (\n                  highlighter(raw, before, end, ranges, {\n                    maxPrefix: 20,\n                    maxLength: 50,\n                  }) ?? ''\n                );\n              }\n              return '';\n            })\n            .filter(Boolean);\n        }",
                                      "start_token": 2910,
                                      "end_token": 3003,
                                      "children": [
                                        {
                                          "type": "FirstStatement",
                                          "label": "const rawValues = record.data.get(field) ?? [];",
                                          "start_token": 2911,
                                          "end_token": 2926,
                                          "children": [
                                            {
                                              "type": "VariableDeclarationList",
                                              "label": "const rawValues = record.data.get(field) ?? []",
                                              "start_token": 2911,
                                              "end_token": 2925,
                                              "children": [
                                                {
                                                  "type": "VariableDeclaration",
                                                  "label": "rawValues = record.data.get(field) ?? []",
                                                  "start_token": 2912,
                                                  "end_token": 2925,
                                                  "children": [
                                                    {
                                                      "type": "Identifier",
                                                      "label": "rawValues",
                                                      "start_token": 2912,
                                                      "end_token": 2912,
                                                      "children": []
                                                    },
                                                    {
                                                      "type": "BinaryExpression",
                                                      "label": "record.data.get(field) ?? []",
                                                      "start_token": 2914,
                                                      "end_token": 2925,
                                                      "children": [
                                                        {
                                                          "type": "CallExpression",
                                                          "label": "record.data.get(field)",
                                                          "start_token": 2914,
                                                          "end_token": 2921,
                                                          "children": [
                                                            {
                                                              "type": "PropertyAccessExpression",
                                                              "label": "record.data.get",
                                                              "start_token": 2914,
                                                              "end_token": 2918,
                                                              "children": [
                                                                {
                                                                  "type": "PropertyAccessExpression",
                                                                  "label": "record.data",
                                                                  "start_token": 2914,
                                                                  "end_token": 2916,
                                                                  "children": [
                                                                    {
                                                                      "type": "Identifier",
                                                                      "label": "record",
                                                                      "start_token": 2914,
                                                                      "end_token": 2914,
                                                                      "children": []
                                                                    },
                                                                    {
                                                                      "type": "Identifier",
                                                                      "label": "data",
                                                                      "start_token": 2916,
                                                                      "end_token": 2916,
                                                                      "children": []
                                                                    }
                                                                  ]
                                                                },
                                                                {
                                                                  "type": "Identifier",
                                                                  "label": "get",
                                                                  "start_token": 2918,
                                                                  "end_token": 2918,
                                                                  "children": []
                                                                }
                                                              ]
                                                            },
                                                            {
                                                              "type": "Identifier",
                                                              "label": "field",
                                                              "start_token": 2920,
                                                              "end_token": 2920,
                                                              "children": []
                                                            }
                                                          ]
                                                        },
                                                        {
                                                          "type": "QuestionQuestionToken",
                                                          "label": "??",
                                                          "start_token": 2922,
                                                          "end_token": 2923,
                                                          "children": []
                                                        },
                                                        {
                                                          "type": "ArrayLiteralExpression",
                                                          "label": "[]",
                                                          "start_token": 2924,
                                                          "end_token": 2925,
                                                          "children": []
                                                        }
                                                      ]
                                                    }
                                                  ]
                                                }
                                              ]
                                            }
                                          ]
                                        },
                                        {
                                          "type": "ExpressionStatement",
                                          "label": "highlights[field] = Array.from(highlightValues)\n            .map(([index, ranges]) => {\n              const raw = rawValues[index];\n              if (raw) {\n                return (\n                  highlighter(raw, before, end, ranges, {\n                    maxPrefix: 20,\n                    maxLength: 50,\n                  }) ?? ''\n                );\n              }\n              return '';\n            })\n            .filter(Boolean);",
                                          "start_token": 2927,
                                          "end_token": 3002,
                                          "children": [
                                            {
                                              "type": "BinaryExpression",
                                              "label": "highlights[field] = Array.from(highlightValues)\n            .map(([index, ranges]) => {\n              const raw = rawValues[index];\n              if (raw) {\n                return (\n                  highlighter(raw, before, end, ranges, {\n                    maxPrefix: 20,\n                    maxLength: 50,\n                  }) ?? ''\n                );\n              }\n              return '';\n            })\n            .filter(Boolean)",
                                              "start_token": 2927,
                                              "end_token": 3001,
                                              "children": [
                                                {
                                                  "type": "ElementAccessExpression",
                                                  "label": "highlights[field]",
                                                  "start_token": 2927,
                                                  "end_token": 2930,
                                                  "children": [
                                                    {
                                                      "type": "Identifier",
                                                      "label": "highlights",
                                                      "start_token": 2927,
                                                      "end_token": 2927,
                                                      "children": []
                                                    },
                                                    {
                                                      "type": "Identifier",
                                                      "label": "field",
                                                      "start_token": 2929,
                                                      "end_token": 2929,
                                                      "children": []
                                                    }
                                                  ]
                                                },
                                                {
                                                  "type": "FirstAssignment",
                                                  "label": "=",
                                                  "start_token": 2931,
                                                  "end_token": 2931,
                                                  "children": []
                                                },
                                                {
                                                  "type": "CallExpression",
                                                  "label": "Array.from(highlightValues)\n            .map(([index, ranges]) => {\n              const raw = rawValues[index];\n              if (raw) {\n                return (\n                  highlighter(raw, before, end, ranges, {\n                    maxPrefix: 20,\n                    maxLength: 50,\n                  }) ?? ''\n                );\n              }\n              return '';\n            })\n            .filter(Boolean)",
                                                  "start_token": 2932,
                                                  "end_token": 3001,
                                                  "children": [
                                                    {
                                                      "type": "PropertyAccessExpression",
                                                      "label": "Array.from(highlightValues)\n            .map(([index, ranges]) => {\n              const raw = rawValues[index];\n              if (raw) {\n                return (\n                  highlighter(raw, before, end, ranges, {\n                    maxPrefix: 20,\n                    maxLength: 50,\n                  }) ?? ''\n                );\n              }\n              return '';\n            })\n            .filter",
                                                      "start_token": 2932,
                                                      "end_token": 2998,
                                                      "children": [
                                                        {
                                                          "type": "CallExpression",
                                                          "label": "Array.from(highlightValues)\n            .map(([index, ranges]) => {\n              const raw = rawValues[index];\n              if (raw) {\n                return (\n                  highlighter(raw, before, end, ranges, {\n                    maxPrefix: 20,\n                    maxLength: 50,\n                  }) ?? ''\n                );\n              }\n              return '';\n            })",
                                                          "start_token": 2932,
                                                          "end_token": 2996,
                                                          "children": [
                                                            {
                                                              "type": "PropertyAccessExpression",
                                                              "label": "Array.from(highlightValues)\n            .map",
                                                              "start_token": 2932,
                                                              "end_token": 2939,
                                                              "children": [
                                                                {
                                                                  "type": "CallExpression",
                                                                  "label": "Array.from(highlightValues)",
                                                                  "start_token": 2932,
                                                                  "end_token": 2937,
                                                                  "children": [
                                                                    {
                                                                      "type": "PropertyAccessExpression",
                                                                      "label": "Array.from",
                                                                      "start_token": 2932,
                                                                      "end_token": 2934,
                                                                      "children": [
                                                                        {
                                                                          "type": "Identifier",
                                                                          "label": "Array",
                                                                          "start_token": 2932,
                                                                          "end_token": 2932,
                                                                          "children": []
                                                                        },
                                                                        {
                                                                          "type": "Identifier",
                                                                          "label": "from",
                                                                          "start_token": 2934,
                                                                          "end_token": 2934,
                                                                          "children": []
                                                                        }
                                                                      ]
                                                                    },
                                                                    {
                                                                      "type": "Identifier",
                                                                      "label": "highlightValues",
                                                                      "start_token": 2936,
                                                                      "end_token": 2936,
                                                                      "children": []
                                                                    }
                                                                  ]
                                                                },
                                                                {
                                                                  "type": "Identifier",
                                                                  "label": "map",
                                                                  "start_token": 2939,
                                                                  "end_token": 2939,
                                                                  "children": []
                                                                }
                                                              ]
                                                            },
                                                            {
                                                              "type": "ArrowFunction",
                                                              "label": "([index, ranges]) => {\n              const raw = rawValues[index];\n              if (raw) {\n                return (\n                  highlighter(raw, before, end, ranges, {\n                    maxPrefix: 20,\n                    maxLength: 50,\n                  }) ?? ''\n                );\n              }\n              return '';\n            }",
                                                              "start_token": 2941,
                                                              "end_token": 2995,
                                                              "children": [
                                                                {
                                                                  "type": "Parameter",
                                                                  "label": "[index, ranges]",
                                                                  "start_token": 2942,
                                                                  "end_token": 2946,
                                                                  "children": [
                                                                    {
                                                                      "type": "ArrayBindingPattern",
                                                                      "label": "[index, ranges]",
                                                                      "start_token": 2942,
                                                                      "end_token": 2946,
                                                                      "children": [
                                                                        {
                                                                          "type": "BindingElement",
                                                                          "label": "index",
                                                                          "start_token": 2943,
                                                                          "end_token": 2943,
                                                                          "children": [
                                                                            {
                                                                              "type": "Identifier",
                                                                              "label": "index",
                                                                              "start_token": 2943,
                                                                              "end_token": 2943,
                                                                              "children": []
                                                                            }
                                                                          ]
                                                                        },
                                                                        {
                                                                          "type": "BindingElement",
                                                                          "label": "ranges",
                                                                          "start_token": 2945,
                                                                          "end_token": 2945,
                                                                          "children": [
                                                                            {
                                                                              "type": "Identifier",
                                                                              "label": "ranges",
                                                                              "start_token": 2945,
                                                                              "end_token": 2945,
                                                                              "children": []
                                                                            }
                                                                          ]
                                                                        }
                                                                      ]
                                                                    }
                                                                  ]
                                                                },
                                                                {
                                                                  "type": "EqualsGreaterThanToken",
                                                                  "label": "=>",
                                                                  "start_token": 2948,
                                                                  "end_token": 2948,
                                                                  "children": []
                                                                },
                                                                {
                                                                  "type": "Block",
                                                                  "label": "{\n              const raw = rawValues[index];\n              if (raw) {\n                return (\n                  highlighter(raw, before, end, ranges, {\n                    maxPrefix: 20,\n                    maxLength: 50,\n                  }) ?? ''\n                );\n              }\n              return '';\n            }",
                                                                  "start_token": 2949,
                                                                  "end_token": 2995,
                                                                  "children": [
                                                                    {
                                                                      "type": "FirstStatement",
                                                                      "label": "const raw = rawValues[index];",
                                                                      "start_token": 2950,
                                                                      "end_token": 2957,
                                                                      "children": [
                                                                        {
                                                                          "type": "VariableDeclarationList",
                                                                          "label": "const raw = rawValues[index]",
                                                                          "start_token": 2950,
                                                                          "end_token": 2956,
                                                                          "children": [
                                                                            {
                                                                              "type": "VariableDeclaration",
                                                                              "label": "raw = rawValues[index]",
                                                                              "start_token": 2951,
                                                                              "end_token": 2956,
                                                                              "children": [
                                                                                {
                                                                                  "type": "Identifier",
                                                                                  "label": "raw",
                                                                                  "start_token": 2951,
                                                                                  "end_token": 2951,
                                                                                  "children": []
                                                                                },
                                                                                {
                                                                                  "type": "ElementAccessExpression",
                                                                                  "label": "rawValues[index]",
                                                                                  "start_token": 2953,
                                                                                  "end_token": 2956,
                                                                                  "children": [
                                                                                    {
                                                                                      "type": "Identifier",
                                                                                      "label": "rawValues",
                                                                                      "start_token": 2953,
                                                                                      "end_token": 2953,
                                                                                      "children": []
                                                                                    },
                                                                                    {
                                                                                      "type": "Identifier",
                                                                                      "label": "index",
                                                                                      "start_token": 2955,
                                                                                      "end_token": 2955,
                                                                                      "children": []
                                                                                    }
                                                                                  ]
                                                                                }
                                                                              ]
                                                                            }
                                                                          ]
                                                                        }
                                                                      ]
                                                                    },
                                                                    {
                                                                      "type": "IfStatement",
                                                                      "label": "if (raw) {\n                return (\n                  highlighter(raw, before, end, ranges, {\n                    maxPrefix: 20,\n                    maxLength: 50,\n                  }) ?? ''\n                );\n              }",
                                                                      "start_token": 2958,
                                                                      "end_token": 2991,
                                                                      "children": [
                                                                        {
                                                                          "type": "Identifier",
                                                                          "label": "raw",
                                                                          "start_token": 2960,
                                                                          "end_token": 2960,
                                                                          "children": []
                                                                        },
                                                                        {
                                                                          "type": "Block",
                                                                          "label": "{\n                return (\n                  highlighter(raw, before, end, ranges, {\n                    maxPrefix: 20,\n                    maxLength: 50,\n                  }) ?? ''\n                );\n              }",
                                                                          "start_token": 2962,
                                                                          "end_token": 2991,
                                                                          "children": [
                                                                            {
                                                                              "type": "ReturnStatement",
                                                                              "label": "return (\n                  highlighter(raw, before, end, ranges, {\n                    maxPrefix: 20,\n                    maxLength: 50,\n                  }) ?? ''\n                );",
                                                                              "start_token": 2963,
                                                                              "end_token": 2990,
                                                                              "children": [
                                                                                {
                                                                                  "type": "ParenthesizedExpression",
                                                                                  "label": "(\n                  highlighter(raw, before, end, ranges, {\n                    maxPrefix: 20,\n                    maxLength: 50,\n                  }) ?? ''\n                )",
                                                                                  "start_token": 2964,
                                                                                  "end_token": 2989,
                                                                                  "children": [
                                                                                    {
                                                                                      "type": "BinaryExpression",
                                                                                      "label": "highlighter(raw, before, end, ranges, {\n                    maxPrefix: 20,\n                    maxLength: 50,\n                  }) ?? ''",
                                                                                      "start_token": 2965,
                                                                                      "end_token": 2988,
                                                                                      "children": [
                                                                                        {
                                                                                          "type": "CallExpression",
                                                                                          "label": "highlighter(raw, before, end, ranges, {\n                    maxPrefix: 20,\n                    maxLength: 50,\n                  })",
                                                                                          "start_token": 2965,
                                                                                          "end_token": 2985,
                                                                                          "children": [
                                                                                            {
                                                                                              "type": "Identifier",
                                                                                              "label": "highlighter",
                                                                                              "start_token": 2965,
                                                                                              "end_token": 2965,
                                                                                              "children": []
                                                                                            },
                                                                                            {
                                                                                              "type": "Identifier",
                                                                                              "label": "raw",
                                                                                              "start_token": 2967,
                                                                                              "end_token": 2967,
                                                                                              "children": []
                                                                                            },
                                                                                            {
                                                                                              "type": "Identifier",
                                                                                              "label": "before",
                                                                                              "start_token": 2969,
                                                                                              "end_token": 2969,
                                                                                              "children": []
                                                                                            },
                                                                                            {
                                                                                              "type": "Identifier",
                                                                                              "label": "end",
                                                                                              "start_token": 2971,
                                                                                              "end_token": 2971,
                                                                                              "children": []
                                                                                            },
                                                                                            {
                                                                                              "type": "Identifier",
                                                                                              "label": "ranges",
                                                                                              "start_token": 2973,
                                                                                              "end_token": 2973,
                                                                                              "children": []
                                                                                            },
                                                                                            {
                                                                                              "type": "ObjectLiteralExpression",
                                                                                              "label": "{\n                    maxPrefix: 20,\n                    maxLength: 50,\n                  }",
                                                                                              "start_token": 2975,
                                                                                              "end_token": 2984,
                                                                                              "children": [
                                                                                                {
                                                                                                  "type": "PropertyAssignment",
                                                                                                  "label": "maxPrefix: 20",
                                                                                                  "start_token": 2976,
                                                                                                  "end_token": 2978,
                                                                                                  "children": [
                                                                                                    {
                                                                                                      "type": "Identifier",
                                                                                                      "label": "maxPrefix",
                                                                                                      "start_token": 2976,
                                                                                                      "end_token": 2976,
                                                                                                      "children": []
                                                                                                    },
                                                                                                    {
                                                                                                      "type": "FirstLiteralToken",
                                                                                                      "label": "20",
                                                                                                      "start_token": 2978,
                                                                                                      "end_token": 2978,
                                                                                                      "children": []
                                                                                                    }
                                                                                                  ]
                                                                                                },
                                                                                                {
                                                                                                  "type": "PropertyAssignment",
                                                                                                  "label": "maxLength: 50",
                                                                                                  "start_token": 2980,
                                                                                                  "end_token": 2982,
                                                                                                  "children": [
                                                                                                    {
                                                                                                      "type": "Identifier",
                                                                                                      "label": "maxLength",
                                                                                                      "start_token": 2980,
                                                                                                      "end_token": 2980,
                                                                                                      "children": []
                                                                                                    },
                                                                                                    {
                                                                                                      "type": "FirstLiteralToken",
                                                                                                      "label": "50",
                                                                                                      "start_token": 2982,
                                                                                                      "end_token": 2982,
                                                                                                      "children": []
                                                                                                    }
                                                                                                  ]
                                                                                                }
                                                                                              ]
                                                                                            }
                                                                                          ]
                                                                                        },
                                                                                        {
                                                                                          "type": "QuestionQuestionToken",
                                                                                          "label": "??",
                                                                                          "start_token": 2986,
                                                                                          "end_token": 2987,
                                                                                          "children": []
                                                                                        },
                                                                                        {
                                                                                          "type": "StringLiteral",
                                                                                          "label": "''",
                                                                                          "start_token": 2988,
                                                                                          "end_token": 2988,
                                                                                          "children": []
                                                                                        }
                                                                                      ]
                                                                                    }
                                                                                  ]
                                                                                }
                                                                              ]
                                                                            }
                                                                          ]
                                                                        }
                                                                      ]
                                                                    },
                                                                    {
                                                                      "type": "ReturnStatement",
                                                                      "label": "return '';",
                                                                      "start_token": 2992,
                                                                      "end_token": 2994,
                                                                      "children": [
                                                                        {
                                                                          "type": "StringLiteral",
                                                                          "label": "''",
                                                                          "start_token": 2993,
                                                                          "end_token": 2993,
                                                                          "children": []
                                                                        }
                                                                      ]
                                                                    }
                                                                  ]
                                                                }
                                                              ]
                                                            }
                                                          ]
                                                        },
                                                        {
                                                          "type": "Identifier",
                                                          "label": "filter",
                                                          "start_token": 2998,
                                                          "end_token": 2998,
                                                          "children": []
                                                        }
                                                      ]
                                                    },
                                                    {
                                                      "type": "Identifier",
                                                      "label": "Boolean",
                                                      "start_token": 3000,
                                                      "end_token": 3000,
                                                      "children": []
                                                    }
                                                  ]
                                                }
                                              ]
                                            }
                                          ]
                                        }
                                      ]
                                    }
                                  ]
                                }
                              ]
                            }
                          ]
                        },
                        {
                          "type": "ExpressionStatement",
                          "label": "node.highlights = highlights;",
                          "start_token": 3005,
                          "end_token": 3010,
                          "children": [
                            {
                              "type": "BinaryExpression",
                              "label": "node.highlights = highlights",
                              "start_token": 3005,
                              "end_token": 3009,
                              "children": [
                                {
                                  "type": "PropertyAccessExpression",
                                  "label": "node.highlights",
                                  "start_token": 3005,
                                  "end_token": 3007,
                                  "children": [
                                    {
                                      "type": "Identifier",
                                      "label": "node",
                                      "start_token": 3005,
                                      "end_token": 3005,
                                      "children": []
                                    },
                                    {
                                      "type": "Identifier",
                                      "label": "highlights",
                                      "start_token": 3007,
                                      "end_token": 3007,
                                      "children": []
                                    }
                                  ]
                                },
                                {
                                  "type": "FirstAssignment",
                                  "label": "=",
                                  "start_token": 3008,
                                  "end_token": 3008,
                                  "children": []
                                },
                                {
                                  "type": "Identifier",
                                  "label": "highlights",
                                  "start_token": 3009,
                                  "end_token": 3009,
                                  "children": []
                                }
                              ]
                            }
                          ]
                        }
                      ]
                    }
                  ]
                },
                {
                  "type": "ReturnStatement",
                  "label": "return node;",
                  "start_token": 3012,
                  "end_token": 3014,
                  "children": [
                    {
                      "type": "Identifier",
                      "label": "node",
                      "start_token": 3013,
                      "end_token": 3013,
                      "children": []
                    }
                  ]
                }
              ]
            }
          ]
        }
      ]
    },
    {
      "type": "EndOfFileToken",
      "label": "",
      "start_token": -1,
      "end_token": -1,
      "children": []
    }
  ]
}
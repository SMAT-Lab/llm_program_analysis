{
  "type": "SourceFile",
  "label": "import { LinkIcon } from '@blocksuite/icons/rc';\nimport type { WorkspaceService } from '@toeverything/infra';\nimport { Entity, LiveData } from '@toeverything/infra';\nimport { resolveLinkToDoc } from '../../navigation';\nimport { isLink } from '../../navigation/utils';\nimport type { QuickSearchSession } from '../providers/quick-search-provider';\nimport type { QuickSearchItem } from '../types/item';\ntype ExternalLinkPayload = {\n  url: string;\n};\nexport class ExternalLinksQuickSearchSession\n  extends Entity\n  implements QuickSearchSession<'external-link', ExternalLinkPayload>\n{\n  constructor(private readonly workspaceService: WorkspaceService) {\n    super();\n  }\n  query$ = new LiveData('');\n  items$ = LiveData.computed(get => {\n    const query = get(this.query$).trim();\n    if (!query) return [];\n    if (!isLink(query)) return [];\n    const resolvedDoc = resolveLinkToDoc(query);\n    if (\n      resolvedDoc &&\n      resolvedDoc.workspaceId === this.workspaceService.workspace.id\n    ) {\n      // is doc url\n      return [];\n    }\n    return [\n      {\n        id: 'external-link:' + query,\n        source: 'external-link',\n        icon: LinkIcon,\n        label: {\n          i18nKey: 'com.affine.cmdk.affine.insert-link',\n        },\n        payload: { url: query },\n      } as QuickSearchItem<'external-link', ExternalLinkPayload>,\n    ];\n  });\n  query(query: string) {\n    this.query$.next(query);\n  }\n}",
  "start_token": 0,
  "end_token": 239,
  "children": [
    {
      "type": "ImportDeclaration",
      "label": "import { LinkIcon } from '@blocksuite/icons/rc';",
      "start_token": 0,
      "end_token": 6,
      "children": [
        {
          "type": "ImportClause",
          "label": "{ LinkIcon }",
          "start_token": 1,
          "end_token": 3,
          "children": [
            {
              "type": "NamedImports",
              "label": "{ LinkIcon }",
              "start_token": 1,
              "end_token": 3,
              "children": [
                {
                  "type": "ImportSpecifier",
                  "label": "LinkIcon",
                  "start_token": 2,
                  "end_token": 2,
                  "children": [
                    {
                      "type": "Identifier",
                      "label": "LinkIcon",
                      "start_token": 2,
                      "end_token": 2,
                      "children": []
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "type": "StringLiteral",
          "label": "'@blocksuite/icons/rc'",
          "start_token": 5,
          "end_token": 5,
          "children": []
        }
      ]
    },
    {
      "type": "ImportDeclaration",
      "label": "import type { WorkspaceService } from '@toeverything/infra';",
      "start_token": 7,
      "end_token": 14,
      "children": [
        {
          "type": "ImportClause",
          "label": "type { WorkspaceService }",
          "start_token": 8,
          "end_token": 11,
          "children": [
            {
              "type": "NamedImports",
              "label": "{ WorkspaceService }",
              "start_token": 9,
              "end_token": 11,
              "children": [
                {
                  "type": "ImportSpecifier",
                  "label": "WorkspaceService",
                  "start_token": 10,
                  "end_token": 10,
                  "children": [
                    {
                      "type": "Identifier",
                      "label": "WorkspaceService",
                      "start_token": 10,
                      "end_token": 10,
                      "children": []
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "type": "StringLiteral",
          "label": "'@toeverything/infra'",
          "start_token": 13,
          "end_token": 13,
          "children": []
        }
      ]
    },
    {
      "type": "ImportDeclaration",
      "label": "import { Entity, LiveData } from '@toeverything/infra';",
      "start_token": 15,
      "end_token": 23,
      "children": [
        {
          "type": "ImportClause",
          "label": "{ Entity, LiveData }",
          "start_token": 16,
          "end_token": 20,
          "children": [
            {
              "type": "NamedImports",
              "label": "{ Entity, LiveData }",
              "start_token": 16,
              "end_token": 20,
              "children": [
                {
                  "type": "ImportSpecifier",
                  "label": "Entity",
                  "start_token": 17,
                  "end_token": 17,
                  "children": [
                    {
                      "type": "Identifier",
                      "label": "Entity",
                      "start_token": 17,
                      "end_token": 17,
                      "children": []
                    }
                  ]
                },
                {
                  "type": "ImportSpecifier",
                  "label": "LiveData",
                  "start_token": 19,
                  "end_token": 19,
                  "children": [
                    {
                      "type": "Identifier",
                      "label": "LiveData",
                      "start_token": 19,
                      "end_token": 19,
                      "children": []
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "type": "StringLiteral",
          "label": "'@toeverything/infra'",
          "start_token": 22,
          "end_token": 22,
          "children": []
        }
      ]
    },
    {
      "type": "ImportDeclaration",
      "label": "import { resolveLinkToDoc } from '../../navigation';",
      "start_token": 24,
      "end_token": 30,
      "children": [
        {
          "type": "ImportClause",
          "label": "{ resolveLinkToDoc }",
          "start_token": 25,
          "end_token": 27,
          "children": [
            {
              "type": "NamedImports",
              "label": "{ resolveLinkToDoc }",
              "start_token": 25,
              "end_token": 27,
              "children": [
                {
                  "type": "ImportSpecifier",
                  "label": "resolveLinkToDoc",
                  "start_token": 26,
                  "end_token": 26,
                  "children": [
                    {
                      "type": "Identifier",
                      "label": "resolveLinkToDoc",
                      "start_token": 26,
                      "end_token": 26,
                      "children": []
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "type": "StringLiteral",
          "label": "'../../navigation'",
          "start_token": 29,
          "end_token": 29,
          "children": []
        }
      ]
    },
    {
      "type": "ImportDeclaration",
      "label": "import { isLink } from '../../navigation/utils';",
      "start_token": 31,
      "end_token": 37,
      "children": [
        {
          "type": "ImportClause",
          "label": "{ isLink }",
          "start_token": 32,
          "end_token": 34,
          "children": [
            {
              "type": "NamedImports",
              "label": "{ isLink }",
              "start_token": 32,
              "end_token": 34,
              "children": [
                {
                  "type": "ImportSpecifier",
                  "label": "isLink",
                  "start_token": 33,
                  "end_token": 33,
                  "children": [
                    {
                      "type": "Identifier",
                      "label": "isLink",
                      "start_token": 33,
                      "end_token": 33,
                      "children": []
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "type": "StringLiteral",
          "label": "'../../navigation/utils'",
          "start_token": 36,
          "end_token": 36,
          "children": []
        }
      ]
    },
    {
      "type": "ImportDeclaration",
      "label": "import type { QuickSearchSession } from '../providers/quick-search-provider';",
      "start_token": 38,
      "end_token": 45,
      "children": [
        {
          "type": "ImportClause",
          "label": "type { QuickSearchSession }",
          "start_token": 39,
          "end_token": 42,
          "children": [
            {
              "type": "NamedImports",
              "label": "{ QuickSearchSession }",
              "start_token": 40,
              "end_token": 42,
              "children": [
                {
                  "type": "ImportSpecifier",
                  "label": "QuickSearchSession",
                  "start_token": 41,
                  "end_token": 41,
                  "children": [
                    {
                      "type": "Identifier",
                      "label": "QuickSearchSession",
                      "start_token": 41,
                      "end_token": 41,
                      "children": []
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "type": "StringLiteral",
          "label": "'../providers/quick-search-provider'",
          "start_token": 44,
          "end_token": 44,
          "children": []
        }
      ]
    },
    {
      "type": "ImportDeclaration",
      "label": "import type { QuickSearchItem } from '../types/item';",
      "start_token": 46,
      "end_token": 53,
      "children": [
        {
          "type": "ImportClause",
          "label": "type { QuickSearchItem }",
          "start_token": 47,
          "end_token": 50,
          "children": [
            {
              "type": "NamedImports",
              "label": "{ QuickSearchItem }",
              "start_token": 48,
              "end_token": 50,
              "children": [
                {
                  "type": "ImportSpecifier",
                  "label": "QuickSearchItem",
                  "start_token": 49,
                  "end_token": 49,
                  "children": [
                    {
                      "type": "Identifier",
                      "label": "QuickSearchItem",
                      "start_token": 49,
                      "end_token": 49,
                      "children": []
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "type": "StringLiteral",
          "label": "'../types/item'",
          "start_token": 52,
          "end_token": 52,
          "children": []
        }
      ]
    },
    {
      "type": "TypeAliasDeclaration",
      "label": "type ExternalLinkPayload = {\n  url: string;\n};",
      "start_token": 54,
      "end_token": 63,
      "children": [
        {
          "type": "Identifier",
          "label": "ExternalLinkPayload",
          "start_token": 55,
          "end_token": 55,
          "children": []
        },
        {
          "type": "TypeLiteral",
          "label": "{\n  url: string;\n}",
          "start_token": 57,
          "end_token": 62,
          "children": [
            {
              "type": "PropertySignature",
              "label": "url: string;",
              "start_token": 58,
              "end_token": 61,
              "children": [
                {
                  "type": "Identifier",
                  "label": "url",
                  "start_token": 58,
                  "end_token": 58,
                  "children": []
                },
                {
                  "type": "StringKeyword",
                  "label": "string",
                  "start_token": 60,
                  "end_token": 60,
                  "children": []
                }
              ]
            }
          ]
        }
      ]
    },
    {
      "type": "ClassDeclaration",
      "label": "export class ExternalLinksQuickSearchSession\n  extends Entity\n  implements QuickSearchSession<'external-link', ExternalLinkPayload>\n{\n  constructor(private readonly workspaceService: WorkspaceService) {\n    super();\n  }\n  query$ = new LiveData('');\n  items$ = LiveData.computed(get => {\n    const query = get(this.query$).trim();\n    if (!query) return [];\n    if (!isLink(query)) return [];\n    const resolvedDoc = resolveLinkToDoc(query);\n    if (\n      resolvedDoc &&\n      resolvedDoc.workspaceId === this.workspaceService.workspace.id\n    ) {\n      // is doc url\n      return [];\n    }\n    return [\n      {\n        id: 'external-link:' + query,\n        source: 'external-link',\n        icon: LinkIcon,\n        label: {\n          i18nKey: 'com.affine.cmdk.affine.insert-link',\n        },\n        payload: { url: query },\n      } as QuickSearchItem<'external-link', ExternalLinkPayload>,\n    ];\n  });\n  query(query: string) {\n    this.query$.next(query);\n  }\n}",
      "start_token": 64,
      "end_token": 239,
      "children": [
        {
          "type": "ExportKeyword",
          "label": "export",
          "start_token": 64,
          "end_token": 64,
          "children": []
        },
        {
          "type": "Identifier",
          "label": "ExternalLinksQuickSearchSession",
          "start_token": 66,
          "end_token": 66,
          "children": []
        },
        {
          "type": "HeritageClause",
          "label": "extends Entity",
          "start_token": 67,
          "end_token": 68,
          "children": [
            {
              "type": "ExpressionWithTypeArguments",
              "label": "Entity",
              "start_token": 68,
              "end_token": 68,
              "children": [
                {
                  "type": "Identifier",
                  "label": "Entity",
                  "start_token": 68,
                  "end_token": 68,
                  "children": []
                }
              ]
            }
          ]
        },
        {
          "type": "HeritageClause",
          "label": "implements QuickSearchSession<'external-link', ExternalLinkPayload>",
          "start_token": 69,
          "end_token": 75,
          "children": [
            {
              "type": "ExpressionWithTypeArguments",
              "label": "QuickSearchSession<'external-link', ExternalLinkPayload>",
              "start_token": 70,
              "end_token": 75,
              "children": [
                {
                  "type": "Identifier",
                  "label": "QuickSearchSession",
                  "start_token": 70,
                  "end_token": 70,
                  "children": []
                },
                {
                  "type": "LiteralType",
                  "label": "'external-link'",
                  "start_token": 72,
                  "end_token": 72,
                  "children": [
                    {
                      "type": "StringLiteral",
                      "label": "'external-link'",
                      "start_token": 72,
                      "end_token": 72,
                      "children": []
                    }
                  ]
                },
                {
                  "type": "TypeReference",
                  "label": "ExternalLinkPayload",
                  "start_token": 74,
                  "end_token": 74,
                  "children": [
                    {
                      "type": "Identifier",
                      "label": "ExternalLinkPayload",
                      "start_token": 74,
                      "end_token": 74,
                      "children": []
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "type": "Constructor",
          "label": "constructor(private readonly workspaceService: WorkspaceService) {\n    super();\n  }",
          "start_token": 77,
          "end_token": 90,
          "children": [
            {
              "type": "Parameter",
              "label": "private readonly workspaceService: WorkspaceService",
              "start_token": 79,
              "end_token": 83,
              "children": [
                {
                  "type": "PrivateKeyword",
                  "label": "private",
                  "start_token": 79,
                  "end_token": 79,
                  "children": []
                },
                {
                  "type": "ReadonlyKeyword",
                  "label": "readonly",
                  "start_token": 80,
                  "end_token": 80,
                  "children": []
                },
                {
                  "type": "Identifier",
                  "label": "workspaceService",
                  "start_token": 81,
                  "end_token": 81,
                  "children": []
                },
                {
                  "type": "TypeReference",
                  "label": "WorkspaceService",
                  "start_token": 83,
                  "end_token": 83,
                  "children": [
                    {
                      "type": "Identifier",
                      "label": "WorkspaceService",
                      "start_token": 83,
                      "end_token": 83,
                      "children": []
                    }
                  ]
                }
              ]
            },
            {
              "type": "Block",
              "label": "{\n    super();\n  }",
              "start_token": 85,
              "end_token": 90,
              "children": [
                {
                  "type": "ExpressionStatement",
                  "label": "super();",
                  "start_token": 86,
                  "end_token": 89,
                  "children": [
                    {
                      "type": "CallExpression",
                      "label": "super()",
                      "start_token": 86,
                      "end_token": 88,
                      "children": [
                        {
                          "type": "SuperKeyword",
                          "label": "super",
                          "start_token": 86,
                          "end_token": 86,
                          "children": []
                        }
                      ]
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "type": "PropertyDeclaration",
          "label": "query$ = new LiveData('');",
          "start_token": 91,
          "end_token": 98,
          "children": [
            {
              "type": "Identifier",
              "label": "query$",
              "start_token": 91,
              "end_token": 91,
              "children": []
            },
            {
              "type": "NewExpression",
              "label": "new LiveData('')",
              "start_token": 93,
              "end_token": 97,
              "children": [
                {
                  "type": "Identifier",
                  "label": "LiveData",
                  "start_token": 94,
                  "end_token": 94,
                  "children": []
                },
                {
                  "type": "StringLiteral",
                  "label": "''",
                  "start_token": 96,
                  "end_token": 96,
                  "children": []
                }
              ]
            }
          ]
        },
        {
          "type": "PropertyDeclaration",
          "label": "items$ = LiveData.computed(get => {\n    const query = get(this.query$).trim();\n    if (!query) return [];\n    if (!isLink(query)) return [];\n    const resolvedDoc = resolveLinkToDoc(query);\n    if (\n      resolvedDoc &&\n      resolvedDoc.workspaceId === this.workspaceService.workspace.id\n    ) {\n      // is doc url\n      return [];\n    }\n    return [\n      {\n        id: 'external-link:' + query,\n        source: 'external-link',\n        icon: LinkIcon,\n        label: {\n          i18nKey: 'com.affine.cmdk.affine.insert-link',\n        },\n        payload: { url: query },\n      } as QuickSearchItem<'external-link', ExternalLinkPayload>,\n    ];\n  });",
          "start_token": 99,
          "end_token": 221,
          "children": [
            {
              "type": "Identifier",
              "label": "items$",
              "start_token": 99,
              "end_token": 99,
              "children": []
            },
            {
              "type": "CallExpression",
              "label": "LiveData.computed(get => {\n    const query = get(this.query$).trim();\n    if (!query) return [];\n    if (!isLink(query)) return [];\n    const resolvedDoc = resolveLinkToDoc(query);\n    if (\n      resolvedDoc &&\n      resolvedDoc.workspaceId === this.workspaceService.workspace.id\n    ) {\n      // is doc url\n      return [];\n    }\n    return [\n      {\n        id: 'external-link:' + query,\n        source: 'external-link',\n        icon: LinkIcon,\n        label: {\n          i18nKey: 'com.affine.cmdk.affine.insert-link',\n        },\n        payload: { url: query },\n      } as QuickSearchItem<'external-link', ExternalLinkPayload>,\n    ];\n  })",
              "start_token": 101,
              "end_token": 220,
              "children": [
                {
                  "type": "PropertyAccessExpression",
                  "label": "LiveData.computed",
                  "start_token": 101,
                  "end_token": 103,
                  "children": [
                    {
                      "type": "Identifier",
                      "label": "LiveData",
                      "start_token": 101,
                      "end_token": 101,
                      "children": []
                    },
                    {
                      "type": "Identifier",
                      "label": "computed",
                      "start_token": 103,
                      "end_token": 103,
                      "children": []
                    }
                  ]
                },
                {
                  "type": "ArrowFunction",
                  "label": "get => {\n    const query = get(this.query$).trim();\n    if (!query) return [];\n    if (!isLink(query)) return [];\n    const resolvedDoc = resolveLinkToDoc(query);\n    if (\n      resolvedDoc &&\n      resolvedDoc.workspaceId === this.workspaceService.workspace.id\n    ) {\n      // is doc url\n      return [];\n    }\n    return [\n      {\n        id: 'external-link:' + query,\n        source: 'external-link',\n        icon: LinkIcon,\n        label: {\n          i18nKey: 'com.affine.cmdk.affine.insert-link',\n        },\n        payload: { url: query },\n      } as QuickSearchItem<'external-link', ExternalLinkPayload>,\n    ];\n  }",
                  "start_token": 105,
                  "end_token": 219,
                  "children": [
                    {
                      "type": "Parameter",
                      "label": "get",
                      "start_token": 105,
                      "end_token": 105,
                      "children": [
                        {
                          "type": "Identifier",
                          "label": "get",
                          "start_token": 105,
                          "end_token": 105,
                          "children": []
                        }
                      ]
                    },
                    {
                      "type": "EqualsGreaterThanToken",
                      "label": "=>",
                      "start_token": 106,
                      "end_token": 106,
                      "children": []
                    },
                    {
                      "type": "Block",
                      "label": "{\n    const query = get(this.query$).trim();\n    if (!query) return [];\n    if (!isLink(query)) return [];\n    const resolvedDoc = resolveLinkToDoc(query);\n    if (\n      resolvedDoc &&\n      resolvedDoc.workspaceId === this.workspaceService.workspace.id\n    ) {\n      // is doc url\n      return [];\n    }\n    return [\n      {\n        id: 'external-link:' + query,\n        source: 'external-link',\n        icon: LinkIcon,\n        label: {\n          i18nKey: 'com.affine.cmdk.affine.insert-link',\n        },\n        payload: { url: query },\n      } as QuickSearchItem<'external-link', ExternalLinkPayload>,\n    ];\n  }",
                      "start_token": 107,
                      "end_token": 219,
                      "children": [
                        {
                          "type": "FirstStatement",
                          "label": "const query = get(this.query$).trim();",
                          "start_token": 108,
                          "end_token": 121,
                          "children": [
                            {
                              "type": "VariableDeclarationList",
                              "label": "const query = get(this.query$).trim()",
                              "start_token": 108,
                              "end_token": 120,
                              "children": [
                                {
                                  "type": "VariableDeclaration",
                                  "label": "query = get(this.query$).trim()",
                                  "start_token": 109,
                                  "end_token": 120,
                                  "children": [
                                    {
                                      "type": "Identifier",
                                      "label": "query",
                                      "start_token": 109,
                                      "end_token": 109,
                                      "children": []
                                    },
                                    {
                                      "type": "CallExpression",
                                      "label": "get(this.query$).trim()",
                                      "start_token": 111,
                                      "end_token": 120,
                                      "children": [
                                        {
                                          "type": "PropertyAccessExpression",
                                          "label": "get(this.query$).trim",
                                          "start_token": 111,
                                          "end_token": 118,
                                          "children": [
                                            {
                                              "type": "CallExpression",
                                              "label": "get(this.query$)",
                                              "start_token": 111,
                                              "end_token": 116,
                                              "children": [
                                                {
                                                  "type": "Identifier",
                                                  "label": "get",
                                                  "start_token": 111,
                                                  "end_token": 111,
                                                  "children": []
                                                },
                                                {
                                                  "type": "PropertyAccessExpression",
                                                  "label": "this.query$",
                                                  "start_token": 113,
                                                  "end_token": 115,
                                                  "children": [
                                                    {
                                                      "type": "ThisKeyword",
                                                      "label": "this",
                                                      "start_token": 113,
                                                      "end_token": 113,
                                                      "children": []
                                                    },
                                                    {
                                                      "type": "Identifier",
                                                      "label": "query$",
                                                      "start_token": 115,
                                                      "end_token": 115,
                                                      "children": []
                                                    }
                                                  ]
                                                }
                                              ]
                                            },
                                            {
                                              "type": "Identifier",
                                              "label": "trim",
                                              "start_token": 118,
                                              "end_token": 118,
                                              "children": []
                                            }
                                          ]
                                        }
                                      ]
                                    }
                                  ]
                                }
                              ]
                            }
                          ]
                        },
                        {
                          "type": "IfStatement",
                          "label": "if (!query) return [];",
                          "start_token": 122,
                          "end_token": 130,
                          "children": [
                            {
                              "type": "PrefixUnaryExpression",
                              "label": "!query",
                              "start_token": 124,
                              "end_token": 125,
                              "children": [
                                {
                                  "type": "Identifier",
                                  "label": "query",
                                  "start_token": 125,
                                  "end_token": 125,
                                  "children": []
                                }
                              ]
                            },
                            {
                              "type": "ReturnStatement",
                              "label": "return [];",
                              "start_token": 127,
                              "end_token": 130,
                              "children": [
                                {
                                  "type": "ArrayLiteralExpression",
                                  "label": "[]",
                                  "start_token": 128,
                                  "end_token": 129,
                                  "children": []
                                }
                              ]
                            }
                          ]
                        },
                        {
                          "type": "IfStatement",
                          "label": "if (!isLink(query)) return [];",
                          "start_token": 131,
                          "end_token": 142,
                          "children": [
                            {
                              "type": "PrefixUnaryExpression",
                              "label": "!isLink(query)",
                              "start_token": 133,
                              "end_token": 137,
                              "children": [
                                {
                                  "type": "CallExpression",
                                  "label": "isLink(query)",
                                  "start_token": 134,
                                  "end_token": 137,
                                  "children": [
                                    {
                                      "type": "Identifier",
                                      "label": "isLink",
                                      "start_token": 134,
                                      "end_token": 134,
                                      "children": []
                                    },
                                    {
                                      "type": "Identifier",
                                      "label": "query",
                                      "start_token": 136,
                                      "end_token": 136,
                                      "children": []
                                    }
                                  ]
                                }
                              ]
                            },
                            {
                              "type": "ReturnStatement",
                              "label": "return [];",
                              "start_token": 139,
                              "end_token": 142,
                              "children": [
                                {
                                  "type": "ArrayLiteralExpression",
                                  "label": "[]",
                                  "start_token": 140,
                                  "end_token": 141,
                                  "children": []
                                }
                              ]
                            }
                          ]
                        },
                        {
                          "type": "FirstStatement",
                          "label": "const resolvedDoc = resolveLinkToDoc(query);",
                          "start_token": 143,
                          "end_token": 150,
                          "children": [
                            {
                              "type": "VariableDeclarationList",
                              "label": "const resolvedDoc = resolveLinkToDoc(query)",
                              "start_token": 143,
                              "end_token": 149,
                              "children": [
                                {
                                  "type": "VariableDeclaration",
                                  "label": "resolvedDoc = resolveLinkToDoc(query)",
                                  "start_token": 144,
                                  "end_token": 149,
                                  "children": [
                                    {
                                      "type": "Identifier",
                                      "label": "resolvedDoc",
                                      "start_token": 144,
                                      "end_token": 144,
                                      "children": []
                                    },
                                    {
                                      "type": "CallExpression",
                                      "label": "resolveLinkToDoc(query)",
                                      "start_token": 146,
                                      "end_token": 149,
                                      "children": [
                                        {
                                          "type": "Identifier",
                                          "label": "resolveLinkToDoc",
                                          "start_token": 146,
                                          "end_token": 146,
                                          "children": []
                                        },
                                        {
                                          "type": "Identifier",
                                          "label": "query",
                                          "start_token": 148,
                                          "end_token": 148,
                                          "children": []
                                        }
                                      ]
                                    }
                                  ]
                                }
                              ]
                            }
                          ]
                        },
                        {
                          "type": "IfStatement",
                          "label": "if (\n      resolvedDoc &&\n      resolvedDoc.workspaceId === this.workspaceService.workspace.id\n    ) {\n      // is doc url\n      return [];\n    }",
                          "start_token": 151,
                          "end_token": 173,
                          "children": [
                            {
                              "type": "BinaryExpression",
                              "label": "resolvedDoc &&\n      resolvedDoc.workspaceId === this.workspaceService.workspace.id",
                              "start_token": 153,
                              "end_token": 165,
                              "children": [
                                {
                                  "type": "Identifier",
                                  "label": "resolvedDoc",
                                  "start_token": 153,
                                  "end_token": 153,
                                  "children": []
                                },
                                {
                                  "type": "AmpersandAmpersandToken",
                                  "label": "&&",
                                  "start_token": 154,
                                  "end_token": 154,
                                  "children": []
                                },
                                {
                                  "type": "BinaryExpression",
                                  "label": "resolvedDoc.workspaceId === this.workspaceService.workspace.id",
                                  "start_token": 155,
                                  "end_token": 165,
                                  "children": [
                                    {
                                      "type": "PropertyAccessExpression",
                                      "label": "resolvedDoc.workspaceId",
                                      "start_token": 155,
                                      "end_token": 157,
                                      "children": [
                                        {
                                          "type": "Identifier",
                                          "label": "resolvedDoc",
                                          "start_token": 155,
                                          "end_token": 155,
                                          "children": []
                                        },
                                        {
                                          "type": "Identifier",
                                          "label": "workspaceId",
                                          "start_token": 157,
                                          "end_token": 157,
                                          "children": []
                                        }
                                      ]
                                    },
                                    {
                                      "type": "EqualsEqualsEqualsToken",
                                      "label": "===",
                                      "start_token": 158,
                                      "end_token": 158,
                                      "children": []
                                    },
                                    {
                                      "type": "PropertyAccessExpression",
                                      "label": "this.workspaceService.workspace.id",
                                      "start_token": 159,
                                      "end_token": 165,
                                      "children": [
                                        {
                                          "type": "PropertyAccessExpression",
                                          "label": "this.workspaceService.workspace",
                                          "start_token": 159,
                                          "end_token": 163,
                                          "children": [
                                            {
                                              "type": "PropertyAccessExpression",
                                              "label": "this.workspaceService",
                                              "start_token": 159,
                                              "end_token": 161,
                                              "children": [
                                                {
                                                  "type": "ThisKeyword",
                                                  "label": "this",
                                                  "start_token": 159,
                                                  "end_token": 159,
                                                  "children": []
                                                },
                                                {
                                                  "type": "Identifier",
                                                  "label": "workspaceService",
                                                  "start_token": 161,
                                                  "end_token": 161,
                                                  "children": []
                                                }
                                              ]
                                            },
                                            {
                                              "type": "Identifier",
                                              "label": "workspace",
                                              "start_token": 163,
                                              "end_token": 163,
                                              "children": []
                                            }
                                          ]
                                        },
                                        {
                                          "type": "Identifier",
                                          "label": "id",
                                          "start_token": 165,
                                          "end_token": 165,
                                          "children": []
                                        }
                                      ]
                                    }
                                  ]
                                }
                              ]
                            },
                            {
                              "type": "Block",
                              "label": "{\n      // is doc url\n      return [];\n    }",
                              "start_token": 167,
                              "end_token": 173,
                              "children": [
                                {
                                  "type": "ReturnStatement",
                                  "label": "return [];",
                                  "start_token": 169,
                                  "end_token": 172,
                                  "children": [
                                    {
                                      "type": "ArrayLiteralExpression",
                                      "label": "[]",
                                      "start_token": 170,
                                      "end_token": 171,
                                      "children": []
                                    }
                                  ]
                                }
                              ]
                            }
                          ]
                        },
                        {
                          "type": "ReturnStatement",
                          "label": "return [\n      {\n        id: 'external-link:' + query,\n        source: 'external-link',\n        icon: LinkIcon,\n        label: {\n          i18nKey: 'com.affine.cmdk.affine.insert-link',\n        },\n        payload: { url: query },\n      } as QuickSearchItem<'external-link', ExternalLinkPayload>,\n    ];",
                          "start_token": 174,
                          "end_token": 218,
                          "children": [
                            {
                              "type": "ArrayLiteralExpression",
                              "label": "[\n      {\n        id: 'external-link:' + query,\n        source: 'external-link',\n        icon: LinkIcon,\n        label: {\n          i18nKey: 'com.affine.cmdk.affine.insert-link',\n        },\n        payload: { url: query },\n      } as QuickSearchItem<'external-link', ExternalLinkPayload>,\n    ]",
                              "start_token": 175,
                              "end_token": 217,
                              "children": [
                                {
                                  "type": "AsExpression",
                                  "label": "{\n        id: 'external-link:' + query,\n        source: 'external-link',\n        icon: LinkIcon,\n        label: {\n          i18nKey: 'com.affine.cmdk.affine.insert-link',\n        },\n        payload: { url: query },\n      } as QuickSearchItem<'external-link', ExternalLinkPayload>",
                                  "start_token": 176,
                                  "end_token": 215,
                                  "children": [
                                    {
                                      "type": "ObjectLiteralExpression",
                                      "label": "{\n        id: 'external-link:' + query,\n        source: 'external-link',\n        icon: LinkIcon,\n        label: {\n          i18nKey: 'com.affine.cmdk.affine.insert-link',\n        },\n        payload: { url: query },\n      }",
                                      "start_token": 176,
                                      "end_token": 208,
                                      "children": [
                                        {
                                          "type": "PropertyAssignment",
                                          "label": "id: 'external-link:' + query",
                                          "start_token": 177,
                                          "end_token": 181,
                                          "children": [
                                            {
                                              "type": "Identifier",
                                              "label": "id",
                                              "start_token": 177,
                                              "end_token": 177,
                                              "children": []
                                            },
                                            {
                                              "type": "BinaryExpression",
                                              "label": "'external-link:' + query",
                                              "start_token": 179,
                                              "end_token": 181,
                                              "children": [
                                                {
                                                  "type": "StringLiteral",
                                                  "label": "'external-link:'",
                                                  "start_token": 179,
                                                  "end_token": 179,
                                                  "children": []
                                                },
                                                {
                                                  "type": "PlusToken",
                                                  "label": "+",
                                                  "start_token": 180,
                                                  "end_token": 180,
                                                  "children": []
                                                },
                                                {
                                                  "type": "Identifier",
                                                  "label": "query",
                                                  "start_token": 181,
                                                  "end_token": 181,
                                                  "children": []
                                                }
                                              ]
                                            }
                                          ]
                                        },
                                        {
                                          "type": "PropertyAssignment",
                                          "label": "source: 'external-link'",
                                          "start_token": 183,
                                          "end_token": 185,
                                          "children": [
                                            {
                                              "type": "Identifier",
                                              "label": "source",
                                              "start_token": 183,
                                              "end_token": 183,
                                              "children": []
                                            },
                                            {
                                              "type": "StringLiteral",
                                              "label": "'external-link'",
                                              "start_token": 185,
                                              "end_token": 185,
                                              "children": []
                                            }
                                          ]
                                        },
                                        {
                                          "type": "PropertyAssignment",
                                          "label": "icon: LinkIcon",
                                          "start_token": 187,
                                          "end_token": 189,
                                          "children": [
                                            {
                                              "type": "Identifier",
                                              "label": "icon",
                                              "start_token": 187,
                                              "end_token": 187,
                                              "children": []
                                            },
                                            {
                                              "type": "Identifier",
                                              "label": "LinkIcon",
                                              "start_token": 189,
                                              "end_token": 189,
                                              "children": []
                                            }
                                          ]
                                        },
                                        {
                                          "type": "PropertyAssignment",
                                          "label": "label: {\n          i18nKey: 'com.affine.cmdk.affine.insert-link',\n        }",
                                          "start_token": 191,
                                          "end_token": 198,
                                          "children": [
                                            {
                                              "type": "Identifier",
                                              "label": "label",
                                              "start_token": 191,
                                              "end_token": 191,
                                              "children": []
                                            },
                                            {
                                              "type": "ObjectLiteralExpression",
                                              "label": "{\n          i18nKey: 'com.affine.cmdk.affine.insert-link',\n        }",
                                              "start_token": 193,
                                              "end_token": 198,
                                              "children": [
                                                {
                                                  "type": "PropertyAssignment",
                                                  "label": "i18nKey: 'com.affine.cmdk.affine.insert-link'",
                                                  "start_token": 194,
                                                  "end_token": 196,
                                                  "children": [
                                                    {
                                                      "type": "Identifier",
                                                      "label": "i18nKey",
                                                      "start_token": 194,
                                                      "end_token": 194,
                                                      "children": []
                                                    },
                                                    {
                                                      "type": "StringLiteral",
                                                      "label": "'com.affine.cmdk.affine.insert-link'",
                                                      "start_token": 196,
                                                      "end_token": 196,
                                                      "children": []
                                                    }
                                                  ]
                                                }
                                              ]
                                            }
                                          ]
                                        },
                                        {
                                          "type": "PropertyAssignment",
                                          "label": "payload: { url: query }",
                                          "start_token": 200,
                                          "end_token": 206,
                                          "children": [
                                            {
                                              "type": "Identifier",
                                              "label": "payload",
                                              "start_token": 200,
                                              "end_token": 200,
                                              "children": []
                                            },
                                            {
                                              "type": "ObjectLiteralExpression",
                                              "label": "{ url: query }",
                                              "start_token": 202,
                                              "end_token": 206,
                                              "children": [
                                                {
                                                  "type": "PropertyAssignment",
                                                  "label": "url: query",
                                                  "start_token": 203,
                                                  "end_token": 205,
                                                  "children": [
                                                    {
                                                      "type": "Identifier",
                                                      "label": "url",
                                                      "start_token": 203,
                                                      "end_token": 203,
                                                      "children": []
                                                    },
                                                    {
                                                      "type": "Identifier",
                                                      "label": "query",
                                                      "start_token": 205,
                                                      "end_token": 205,
                                                      "children": []
                                                    }
                                                  ]
                                                }
                                              ]
                                            }
                                          ]
                                        }
                                      ]
                                    },
                                    {
                                      "type": "TypeReference",
                                      "label": "QuickSearchItem<'external-link', ExternalLinkPayload>",
                                      "start_token": 210,
                                      "end_token": 215,
                                      "children": [
                                        {
                                          "type": "Identifier",
                                          "label": "QuickSearchItem",
                                          "start_token": 210,
                                          "end_token": 210,
                                          "children": []
                                        },
                                        {
                                          "type": "LiteralType",
                                          "label": "'external-link'",
                                          "start_token": 212,
                                          "end_token": 212,
                                          "children": [
                                            {
                                              "type": "StringLiteral",
                                              "label": "'external-link'",
                                              "start_token": 212,
                                              "end_token": 212,
                                              "children": []
                                            }
                                          ]
                                        },
                                        {
                                          "type": "TypeReference",
                                          "label": "ExternalLinkPayload",
                                          "start_token": 214,
                                          "end_token": 214,
                                          "children": [
                                            {
                                              "type": "Identifier",
                                              "label": "ExternalLinkPayload",
                                              "start_token": 214,
                                              "end_token": 214,
                                              "children": []
                                            }
                                          ]
                                        }
                                      ]
                                    }
                                  ]
                                }
                              ]
                            }
                          ]
                        }
                      ]
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "type": "MethodDeclaration",
          "label": "query(query: string) {\n    this.query$.next(query);\n  }",
          "start_token": 222,
          "end_token": 238,
          "children": [
            {
              "type": "Identifier",
              "label": "query",
              "start_token": 222,
              "end_token": 222,
              "children": []
            },
            {
              "type": "Parameter",
              "label": "query: string",
              "start_token": 224,
              "end_token": 226,
              "children": [
                {
                  "type": "Identifier",
                  "label": "query",
                  "start_token": 224,
                  "end_token": 224,
                  "children": []
                },
                {
                  "type": "StringKeyword",
                  "label": "string",
                  "start_token": 226,
                  "end_token": 226,
                  "children": []
                }
              ]
            },
            {
              "type": "Block",
              "label": "{\n    this.query$.next(query);\n  }",
              "start_token": 228,
              "end_token": 238,
              "children": [
                {
                  "type": "ExpressionStatement",
                  "label": "this.query$.next(query);",
                  "start_token": 229,
                  "end_token": 237,
                  "children": [
                    {
                      "type": "CallExpression",
                      "label": "this.query$.next(query)",
                      "start_token": 229,
                      "end_token": 236,
                      "children": [
                        {
                          "type": "PropertyAccessExpression",
                          "label": "this.query$.next",
                          "start_token": 229,
                          "end_token": 233,
                          "children": [
                            {
                              "type": "PropertyAccessExpression",
                              "label": "this.query$",
                              "start_token": 229,
                              "end_token": 231,
                              "children": [
                                {
                                  "type": "ThisKeyword",
                                  "label": "this",
                                  "start_token": 229,
                                  "end_token": 229,
                                  "children": []
                                },
                                {
                                  "type": "Identifier",
                                  "label": "query$",
                                  "start_token": 231,
                                  "end_token": 231,
                                  "children": []
                                }
                              ]
                            },
                            {
                              "type": "Identifier",
                              "label": "next",
                              "start_token": 233,
                              "end_token": 233,
                              "children": []
                            }
                          ]
                        },
                        {
                          "type": "Identifier",
                          "label": "query",
                          "start_token": 235,
                          "end_token": 235,
                          "children": []
                        }
                      ]
                    }
                  ]
                }
              ]
            }
          ]
        }
      ]
    },
    {
      "type": "EndOfFileToken",
      "label": "",
      "start_token": -1,
      "end_token": -1,
      "children": []
    }
  ]
}
{
  "name": "29.cj",
  "type": "File",
  "blocks": [],
  "functions": [],
  "classes": [
    {
      "name": "_DEFAULT_CANG_CLASS",
      "type": "Class",
      "blocks": [],
      "functions": [],
      "classes": []
    },
    {
      "name": "ByteArrayUtils",
      "type": "Class",
      "blocks": [],
      "functions": [
        {
          "name": "indexByte",
          "type": "Function",
          "blocks": [
            {
              "id": 133924163420064,
              "label": "",
              "successors": [
                {
                  "id": 133924146389744,
                  "label": "for (i in 0 .. source.size )",
                  "successors": [
                    {
                      "id": 133924146390032,
                      "label": "if (source[i] == target )",
                      "successors": [
                        {
                          "id": 133924146390416,
                          "label": "return i",
                          "successors": []
                        },
                        {
                          "id": 133924146389744
                        }
                      ]
                    },
                    {
                      "id": 133924146389840,
                      "label": "return -1",
                      "successors": []
                    }
                  ]
                }
              ]
            }
          ],
          "functions": [],
          "classes": []
        },
        {
          "name": "littleEndianUint16",
          "type": "Function",
          "blocks": [
            {
              "id": 133924161422000,
              "label": "",
              "successors": [
                {
                  "id": 133924146390224,
                  "label": "return UInt16(b[0]) | UInt16(b[1])<<8",
                  "successors": []
                }
              ]
            }
          ],
          "functions": [],
          "classes": []
        },
        {
          "name": "littleEndianUint32",
          "type": "Function",
          "blocks": [
            {
              "id": 133924161422720,
              "label": "",
              "successors": [
                {
                  "id": 133924146390512,
                  "label": "return UInt32(b[0]) | UInt32(b[1])<<8 | UInt32(b[2])<<16 | UInt32(b[3]) << 24",
                  "successors": []
                }
              ]
            }
          ],
          "functions": [],
          "classes": []
        },
        {
          "name": "scrambleCachingSha2",
          "type": "Function",
          "blocks": [
            {
              "id": 133924161423488,
              "label": "",
              "successors": [
                {
                  "id": 133924146390656,
                  "label": "var sha2Instance = SHA256()",
                  "successors": [
                    {
                      "id": 133924146390704,
                      "label": "var dig1 = Array<Byte>(CACHING_SHA2_DIGEST_LENGTH, item: 0)",
                      "successors": [
                        {
                          "id": 133924146390752,
                          "label": "var dig2 = Array<Byte>(CACHING_SHA2_DIGEST_LENGTH, item: 0)",
                          "successors": [
                            {
                              "id": 133924146390800,
                              "label": "var scramble1 = Array<Byte>(CACHING_SHA2_DIGEST_LENGTH, item: 0)",
                              "successors": [
                                {
                                  "id": 133924146390848,
                                  "label": "sha2Instance.write(passwd)",
                                  "successors": [
                                    {
                                      "id": 133924146390896,
                                      "label": "dig1 = sha2Instance.finish()",
                                      "successors": [
                                        {
                                          "id": 133924146390944,
                                          "label": "sha2Instance.reset()",
                                          "successors": [
                                            {
                                              "id": 133924146390992,
                                              "label": "sha2Instance.write(dig1)",
                                              "successors": [
                                                {
                                                  "id": 133924146391040,
                                                  "label": "dig2 = sha2Instance.finish()",
                                                  "successors": [
                                                    {
                                                      "id": 133924146391088,
                                                      "label": "sha2Instance.reset()",
                                                      "successors": [
                                                        {
                                                          "id": 133924146391136,
                                                          "label": "sha2Instance.write(dig2)",
                                                          "successors": [
                                                            {
                                                              "id": 133924146391184,
                                                              "label": "sha2Instance.write(cipher)",
                                                              "successors": [
                                                                {
                                                                  "id": 133924146391232,
                                                                  "label": "scramble1 = sha2Instance.finish()",
                                                                  "successors": [
                                                                    {
                                                                      "id": 133924146391280,
                                                                      "label": "sha2Instance.reset()",
                                                                      "successors": [
                                                                        {
                                                                          "id": 133924146391328,
                                                                          "label": "var mysqlScrambleBuff = Array<Byte>(CACHING_SHA2_DIGEST_LENGTH, item: 0)",
                                                                          "successors": [
                                                                            {
                                                                              "id": 133924146391376,
                                                                              "label": "xorString(dig1, mysqlScrambleBuff, scramble1, CACHING_SHA2_DIGEST_LENGTH)",
                                                                              "successors": [
                                                                                {
                                                                                  "id": 133924146391424,
                                                                                  "label": "return mysqlScrambleBuff",
                                                                                  "successors": []
                                                                                }
                                                                              ]
                                                                            }
                                                                          ]
                                                                        }
                                                                      ]
                                                                    }
                                                                  ]
                                                                }
                                                              ]
                                                            }
                                                          ]
                                                        }
                                                      ]
                                                    }
                                                  ]
                                                }
                                              ]
                                            }
                                          ]
                                        }
                                      ]
                                    }
                                  ]
                                }
                              ]
                            }
                          ]
                        }
                      ]
                    }
                  ]
                }
              ]
            }
          ],
          "functions": [],
          "classes": []
        },
        {
          "name": "scrambleRSA",
          "type": "Function",
          "blocks": [
            {
              "id": 133924161424304,
              "label": "",
              "successors": [
                {
                  "id": 133924146391568,
                  "label": "var input: Array<Byte>",
                  "successors": [
                    {
                      "id": 133924146391616,
                      "label": "if (password.toArray().size == 0 )",
                      "successors": [
                        {
                          "id": 133924146392000,
                          "label": "input = Array<Byte>(1, item: 0)",
                          "successors": [
                            {
                              "id": 133924146391712,
                              "label": "var mysqlScrambleBuff = Array<Byte>(input.size, item: 0)",
                              "successors": [
                                {
                                  "id": 133924146391760,
                                  "label": "xorString(input, mysqlScrambleBuff, cipher, input.size)",
                                  "successors": [
                                    {
                                      "id": 133924146391808,
                                      "label": "var rsaPub = RSAPublicKey.decodeFromPem(String.fromUtf8(publicKey))",
                                      "successors": [
                                        {
                                          "id": 133924146392096,
                                          "label": "var byteArraySteam1 = ByteArrayStream()",
                                          "successors": [
                                            {
                                              "id": 133924146392288,
                                              "label": "byteArraySteam1.write(mysqlScrambleBuff)",
                                              "successors": [
                                                {
                                                  "id": 133924146392336,
                                                  "label": "var byteArraySteam2 = ByteArrayStream()",
                                                  "successors": [
                                                    {
                                                      "id": 133924146392384,
                                                      "label": "var opt = OAEPOption(SHA1(),SHA1())",
                                                      "successors": [
                                                        {
                                                          "id": 133924146392432,
                                                          "label": "rsaPub.encrypt(byteArraySteam1,byteArraySteam2,padType:OAEP(opt))",
                                                          "successors": [
                                                            {
                                                              "id": 133924146392480,
                                                              "label": "var buffer = Array<Byte>(1024, item: 0)",
                                                              "successors": [
                                                                {
                                                                  "id": 133924146392528,
                                                                  "label": "var len = byteArraySteam2.read(buffer)",
                                                                  "successors": [
                                                                    {
                                                                      "id": 133924146392576,
                                                                      "label": "var res = Array<Byte>(len, item: 0)",
                                                                      "successors": [
                                                                        {
                                                                          "id": 133924146392624,
                                                                          "label": "buffer.copyTo(res, 0, 0, len)",
                                                                          "successors": [
                                                                            {
                                                                              "id": 133924146392672,
                                                                              "label": "return res",
                                                                              "successors": []
                                                                            }
                                                                          ]
                                                                        }
                                                                      ]
                                                                    }
                                                                  ]
                                                                }
                                                              ]
                                                            }
                                                          ]
                                                        }
                                                      ]
                                                    }
                                                  ]
                                                }
                                              ]
                                            }
                                          ]
                                        }
                                      ]
                                    }
                                  ]
                                }
                              ]
                            }
                          ]
                        },
                        {
                          "id": 133924146392144,
                          "label": "input = Array<Byte>(password.toArray().size + 1, item: 0)",
                          "successors": [
                            {
                              "id": 133924146392192,
                              "label": "password.toArray().copyTo(input, 0, 0, password.toArray().size)",
                              "successors": [
                                {
                                  "id": 133924146392240,
                                  "label": "input[password.toArray().size] = 0",
                                  "successors": [
                                    {
                                      "id": 133924146391712
                                    }
                                  ]
                                }
                              ]
                            }
                          ]
                        }
                      ]
                    }
                  ]
                }
              ]
            }
          ],
          "functions": [],
          "classes": []
        },
        {
          "name": "xorString",
          "type": "Function",
          "blocks": [
            {
              "id": 133924161425312,
              "label": "",
              "successors": [
                {
                  "id": 133924146392816,
                  "label": "var pos = 0",
                  "successors": [
                    {
                      "id": 133924146392864,
                      "label": "var scrambleLen = scramble.size",
                      "successors": [
                        {
                          "id": 133924146392912,
                          "label": "while (pos < len )",
                          "successors": [
                            {
                              "id": 133924146393200,
                              "label": "to[pos] = src[pos] ^ scramble[pos % scrambleLen]",
                              "successors": [
                                {
                                  "id": 133924146393248,
                                  "label": "pos++",
                                  "successors": [
                                    {
                                      "id": 133924146392912
                                    }
                                  ]
                                }
                              ]
                            },
                            {
                              "id": 133924161425360,
                              "label": "return",
                              "successors": []
                            }
                          ]
                        }
                      ]
                    }
                  ]
                }
              ]
            }
          ],
          "functions": [],
          "classes": []
        },
        {
          "name": "appendLengthEncodedInteger",
          "type": "Function",
          "blocks": [
            {
              "id": 133924161426032,
              "label": "",
              "successors": [
                {
                  "id": 133924146393344,
                  "label": "let result = ArrayList<Byte>()",
                  "successors": [
                    {
                      "id": 133924146393392,
                      "label": "if (n <= 250 )",
                      "successors": [
                        {
                          "id": 133924146393776,
                          "label": "result.append(UInt8(n))",
                          "successors": [
                            {
                              "id": 133924146393488,
                              "label": "return result.toArray()",
                              "successors": []
                            }
                          ]
                        },
                        {
                          "id": 133924146393920,
                          "label": "if (n <= 0xffff )",
                          "successors": [
                            {
                              "id": 133924146394352,
                              "label": "result.append(0xfc)",
                              "successors": [
                                {
                                  "id": 133924146394400,
                                  "label": "result.append(UInt8(n & 0xff))",
                                  "successors": [
                                    {
                                      "id": 133924146394448,
                                      "label": "result.append(UInt8(n >> 8 & 0xff))",
                                      "successors": [
                                        {
                                          "id": 133924146393488
                                        }
                                      ]
                                    }
                                  ]
                                }
                              ]
                            },
                            {
                              "id": 133924146394592,
                              "label": "if (n <= 0xffffff )",
                              "successors": [
                                {
                                  "id": 133924146395024,
                                  "label": "result.append(0xfd)",
                                  "successors": [
                                    {
                                      "id": 133924146395072,
                                      "label": "result.append(UInt8(n & 0xff))",
                                      "successors": [
                                        {
                                          "id": 133924146395120,
                                          "label": "result.append(UInt8(n >> 8 & 0xff))",
                                          "successors": [
                                            {
                                              "id": 133924146395168,
                                              "label": "result.append(UInt8(n >> 16 & 0xff))",
                                              "successors": [
                                                {
                                                  "id": 133924146393488
                                                }
                                              ]
                                            }
                                          ]
                                        }
                                      ]
                                    }
                                  ]
                                },
                                {
                                  "id": 133924146395312,
                                  "label": "result.append(0xfe)",
                                  "successors": [
                                    {
                                      "id": 133924146395360,
                                      "label": "result.append(UInt8(n & 0xff))",
                                      "successors": [
                                        {
                                          "id": 133924146395408,
                                          "label": "result.append(UInt8(n >> 8 & 0xff))",
                                          "successors": [
                                            {
                                              "id": 133924146395456,
                                              "label": "result.append(UInt8(n >> 16 & 0xff))",
                                              "successors": [
                                                {
                                                  "id": 133924146395504,
                                                  "label": "result.append(UInt8(n >> 24 & 0xff))",
                                                  "successors": [
                                                    {
                                                      "id": 133924146395552,
                                                      "label": "result.append(UInt8(n >> 32 & 0xff))",
                                                      "successors": [
                                                        {
                                                          "id": 133924146395600,
                                                          "label": "result.append(UInt8(n >> 40 & 0xff))",
                                                          "successors": [
                                                            {
                                                              "id": 133924146395648,
                                                              "label": "result.append(UInt8(n >> 48 & 0xff))",
                                                              "successors": [
                                                                {
                                                                  "id": 133924146395696,
                                                                  "label": "result.append(UInt8(n >> 56 & 0xff))",
                                                                  "successors": [
                                                                    {
                                                                      "id": 133924146393488
                                                                    }
                                                                  ]
                                                                }
                                                              ]
                                                            }
                                                          ]
                                                        }
                                                      ]
                                                    }
                                                  ]
                                                }
                                              ]
                                            }
                                          ]
                                        }
                                      ]
                                    }
                                  ]
                                }
                              ]
                            }
                          ]
                        }
                      ]
                    }
                  ]
                }
              ]
            }
          ],
          "functions": [],
          "classes": []
        },
        {
          "name": "uint64ToBytes",
          "type": "Function",
          "blocks": [
            {
              "id": 133924161426752,
              "label": "",
              "successors": [
                {
                  "id": 133924146393872,
                  "label": "let result = ArrayList<Byte>()",
                  "successors": [
                    {
                      "id": 133924146394016,
                      "label": "result.append(UInt8(n & 0xff))",
                      "successors": [
                        {
                          "id": 133924146394064,
                          "label": "result.append(UInt8(n >> 8 & 0xff))",
                          "successors": [
                            {
                              "id": 133924146394160,
                              "label": "result.append(UInt8(n >> 16 & 0xff))",
                              "successors": [
                                {
                                  "id": 133924146394544,
                                  "label": "result.append(UInt8(n >> 24 & 0xff))",
                                  "successors": [
                                    {
                                      "id": 133924146394688,
                                      "label": "result.append(UInt8(n >> 32 & 0xff))",
                                      "successors": [
                                        {
                                          "id": 133924146394736,
                                          "label": "result.append(UInt8(n >> 40 & 0xff))",
                                          "successors": [
                                            {
                                              "id": 133924146394832,
                                              "label": "result.append(UInt8(n >> 48 & 0xff))",
                                              "successors": [
                                                {
                                                  "id": 133924146395264,
                                                  "label": "result.append(UInt8(n >> 56 & 0xff))",
                                                  "successors": [
                                                    {
                                                      "id": 133924146395744,
                                                      "label": "return result.toArray()",
                                                      "successors": []
                                                    }
                                                  ]
                                                }
                                              ]
                                            }
                                          ]
                                        }
                                      ]
                                    }
                                  ]
                                }
                              ]
                            }
                          ]
                        }
                      ]
                    }
                  ]
                }
              ]
            }
          ],
          "functions": [],
          "classes": []
        },
        {
          "name": "uint32ToBytes",
          "type": "Function",
          "blocks": [
            {
              "id": 133924161427472,
              "label": "",
              "successors": [
                {
                  "id": 133924146395936,
                  "label": "let result = ArrayList<Byte>()",
                  "successors": [
                    {
                      "id": 133924146395984,
                      "label": "result.append(UInt8(n & 0xff))",
                      "successors": [
                        {
                          "id": 133924146396032,
                          "label": "result.append(UInt8(n >> 8 & 0xff))",
                          "successors": [
                            {
                              "id": 133924146396080,
                              "label": "result.append(UInt8(n >> 16 & 0xff))",
                              "successors": [
                                {
                                  "id": 133924146396128,
                                  "label": "result.append(UInt8(n >> 24 & 0xff))",
                                  "successors": [
                                    {
                                      "id": 133924146396176,
                                      "label": "return result.toArray()",
                                      "successors": []
                                    }
                                  ]
                                }
                              ]
                            }
                          ]
                        }
                      ]
                    }
                  ]
                }
              ]
            }
          ],
          "functions": [],
          "classes": []
        },
        {
          "name": "readLengthEncodedString",
          "type": "Function",
          "blocks": [
            {
              "id": 133924161428384,
              "label": "",
              "successors": [
                {
                  "id": 133924146396272,
                  "label": "let result = readLengthEncodedInteger(data)",
                  "successors": [
                    {
                      "id": 133924146396320,
                      "label": "var num = result[0]",
                      "successors": [
                        {
                          "id": 133924146396368,
                          "label": "var isNull = result[1]",
                          "successors": [
                            {
                              "id": 133924146396416,
                              "label": "var n = result[2]",
                              "successors": [
                                {
                                  "id": 133924146396464,
                                  "label": "if (num < 1 )",
                                  "successors": [
                                    {
                                      "id": 133924146396800,
                                      "label": "return (data[n..n], isNull, n)",
                                      "successors": []
                                    },
                                    {
                                      "id": 133924146396560,
                                      "label": "n += Int64(num)",
                                      "successors": [
                                        {
                                          "id": 133924146396608,
                                          "label": "if (data.size >= n )",
                                          "successors": [
                                            {
                                              "id": 133924146397088,
                                              "label": "return (data[n - Int64(num) .. n], false, n)",
                                              "successors": []
                                            },
                                            {
                                              "id": 133924146396848,
                                              "label": "return (Array<Byte>(), false, n)",
                                              "successors": []
                                            }
                                          ]
                                        }
                                      ]
                                    }
                                  ]
                                }
                              ]
                            }
                          ]
                        }
                      ]
                    }
                  ]
                }
              ]
            }
          ],
          "functions": [],
          "classes": []
        },
        {
          "name": "lengthEncoderInteger",
          "type": "Function",
          "blocks": [
            {
              "id": 133924161429104,
              "label": "",
              "successors": [
                {
                  "id": 133924146397136,
                  "label": "let result = ArrayList<Byte>()",
                  "successors": [
                    {
                      "id": 133924146593904,
                      "label": "if (number <= 250 )",
                      "successors": [
                        {
                          "id": 133924146594288,
                          "label": "result.append(UInt8(number))",
                          "successors": [
                            {
                              "id": 133924146594000,
                              "label": "return result.toArray()",
                              "successors": []
                            }
                          ]
                        },
                        {
                          "id": 133924146594432,
                          "label": "if (number <= 0xffff )",
                          "successors": [
                            {
                              "id": 133924146594816,
                              "label": "result.append(UInt8(0xfc))",
                              "successors": [
                                {
                                  "id": 133924146594000
                                }
                              ]
                            },
                            {
                              "id": 133924146594000
                            }
                          ]
                        }
                      ]
                    }
                  ]
                }
              ]
            }
          ],
          "functions": [],
          "classes": []
        },
        {
          "name": "readLengthEncodedInteger",
          "type": "Function",
          "blocks": [
            {
              "id": 133924161429824,
              "label": "",
              "successors": [
                {
                  "id": 133924146594384,
                  "label": "match (data[0] )",
                  "successors": [
                    {
                      "id": 133924146595152,
                      "label": "return (0, true, 1)",
                      "successors": []
                    },
                    {
                      "id": 133924146595440,
                      "label": "return (\n                    UInt64(data[1]) | UInt64(data[2])<<8, false, 3\n                )",
                      "successors": []
                    },
                    {
                      "id": 133924146595728,
                      "label": "return (\n                    UInt64(data[1]) | UInt64(data[2])<<8 | UInt64(data[3])<<16, false, 4\n                )",
                      "successors": []
                    },
                    {
                      "id": 133924146596016,
                      "label": "return (\n                    UInt64(data[1]) | UInt64(data[2])<<8 | UInt64(data[3])<<16 | UInt64(data[4]) << 24 |\n                    UInt64(data[5]) << 32 | UInt64(data[6]) << 40 | UInt64(data[7]) << 48 | UInt64(data[8]) << 56,\n                    false, 9\n                )",
                      "successors": []
                    },
                    {
                      "id": 133924146596304,
                      "label": "return (UInt64(data[0]), false , 1)",
                      "successors": []
                    }
                  ]
                }
              ]
            }
          ],
          "functions": [],
          "classes": []
        }
      ],
      "classes": []
    }
  ]
}
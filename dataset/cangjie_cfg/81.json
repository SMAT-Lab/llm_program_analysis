{
  "name": "81.cj",
  "type": "File",
  "blocks": [],
  "functions": [],
  "classes": [
    {
      "name": "_DEFAULT_CANG_CLASS",
      "type": "Class",
      "blocks": [],
      "functions": [
        {
          "name": "pathLoad",
          "type": "Function",
          "blocks": [
            {
              "id": 133924155673280,
              "label": "",
              "successors": [
                {
                  "id": 133924140610992,
                  "label": "var pathMap = PathMap(\n        \"/opds/v2/search\",\n        {\n            httpContext =>\n            let host = httpContext.request.headers.get(\"host\").toArray()[0]\n            var query = \"\"\n            match (httpContext.request.url.query) {\n                case Some(x) => query = x.trimStart(\"query=\")\n                case None => ()\n            }\n            var cataLog = Search(query, host: host)\n            httpContext.responseBuilder.header(\"content-type\", \"application/json;charset:utf-8;\")\n            httpContext.responseBuilder.body(cataLog.toJson())\n        }\n    )",
                  "successors": [
                    {
                      "id": 133924140611040,
                      "label": "return pathMap",
                      "successors": []
                    }
                  ]
                }
              ]
            }
          ],
          "functions": [],
          "classes": []
        }
      ],
      "classes": []
    },
    {
      "name": "Search",
      "type": "Class",
      "blocks": [],
      "functions": [
        {
          "name": "constructor",
          "type": "Function",
          "blocks": [
            {
              "id": 133924155671456,
              "label": "",
              "successors": [
                {
                  "id": 133924140611184,
                  "label": "var now = DateTime.now()",
                  "successors": [
                    {
                      "id": 133924140611232,
                      "label": "metadata = Metadata(\"Search results\", modified: now.toString())",
                      "successors": [
                        {
                          "id": 133924140611280,
                          "label": "links = Links(host, \"catalog\", searchPage: true)",
                          "successors": [
                            {
                              "id": 133924140611328,
                              "label": "initSeries(query, host: host)",
                              "successors": [
                                {
                                  "id": 133924155671504,
                                  "label": "return",
                                  "successors": []
                                }
                              ]
                            }
                          ]
                        }
                      ]
                    }
                  ]
                }
              ]
            }
          ],
          "functions": [],
          "classes": []
        },
        {
          "name": "initSeries",
          "type": "Function",
          "blocks": [
            {
              "id": 133924155672128,
              "label": "",
              "successors": [
                {
                  "id": 133924140611520,
                  "label": "var group = Group()",
                  "successors": [
                    {
                      "id": 133924140611568,
                      "label": "group.metadata = Metadata(\"Series\")",
                      "successors": [
                        {
                          "id": 133924140611616,
                          "label": "var obj = BookSeries.query(query)",
                          "successors": [
                            {
                              "id": 133924140611664,
                              "label": "for (i in obj )",
                              "successors": [
                                {
                                  "id": 133924140611952,
                                  "label": "group\n                .navigation\n                .append(\n                    Link(title: i.name, href: \"http://${host}/opds/v2/series/${i.id}\", type_u: \"application/opds+json\"))",
                                  "successors": [
                                    {
                                      "id": 133924140611664
                                    }
                                  ]
                                },
                                {
                                  "id": 133924140611760,
                                  "label": "this.groups.append(group)",
                                  "successors": [
                                    {
                                      "id": 133924155672176,
                                      "label": "return",
                                      "successors": []
                                    }
                                  ]
                                }
                              ]
                            }
                          ]
                        }
                      ]
                    }
                  ]
                }
              ]
            }
          ],
          "functions": [],
          "classes": []
        },
        {
          "name": "toJson",
          "type": "Function",
          "blocks": [
            {
              "id": 133924155672656,
              "label": "",
              "successors": [
                {
                  "id": 133924140612000,
                  "label": "let stream = ByteBuffer()",
                  "successors": [
                    {
                      "id": 133924140612048,
                      "label": "let w = JsonWriter(stream)",
                      "successors": [
                        {
                          "id": 133924140612096,
                          "label": "w.startObject()",
                          "successors": [
                            {
                              "id": 133924140612144,
                              "label": "w.writeName(\"metadata\").writeValue(metadata)",
                              "successors": [
                                {
                                  "id": 133924140612192,
                                  "label": "w.writeName(\"links\").writeValue(links)",
                                  "successors": [
                                    {
                                      "id": 133924140612240,
                                      "label": "w.writeName(\"groups\").writeValue<ArrayList<Group>>(groups)",
                                      "successors": [
                                        {
                                          "id": 133924140612288,
                                          "label": "w.endObject()",
                                          "successors": [
                                            {
                                              "id": 133924140612336,
                                              "label": "w.flush()",
                                              "successors": [
                                                {
                                                  "id": 133924140612384,
                                                  "label": "return String.fromUtf8(readToEnd(stream))",
                                                  "successors": []
                                                }
                                              ]
                                            }
                                          ]
                                        }
                                      ]
                                    }
                                  ]
                                }
                              ]
                            }
                          ]
                        }
                      ]
                    }
                  ]
                }
              ]
            }
          ],
          "functions": [],
          "classes": []
        }
      ],
      "classes": []
    }
  ]
}
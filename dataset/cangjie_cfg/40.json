{
  "name": "40.cj",
  "type": "File",
  "blocks": [],
  "functions": [],
  "classes": [
    {
      "name": "_DEFAULT_CANG_CLASS",
      "type": "Class",
      "blocks": [],
      "functions": [],
      "classes": []
    },
    {
      "name": "MysqlConnection",
      "type": "Class",
      "blocks": [],
      "functions": [
        {
          "name": "constructor",
          "type": "Function",
          "blocks": [
            {
              "id": 133924157626768,
              "label": "",
              "successors": [
                {
                  "id": 133924143268720,
                  "label": "this.config = config",
                  "successors": [
                    {
                      "id": 133924143268768,
                      "label": "var socket = TcpSocket(IPSocketAddress.parse(config.address))",
                      "successors": [
                        {
                          "id": 133924143268816,
                          "label": "socket.keepAlive = SocketKeepAliveConfig()",
                          "successors": [
                            {
                              "id": 133924143268864,
                              "label": "socket.connect()",
                              "successors": [
                                {
                                  "id": 133924143268912,
                                  "label": "this.tcpSocket = socket",
                                  "successors": [
                                    {
                                      "id": 133924143268960,
                                      "label": "this.buffer = Buffer(socket)",
                                      "successors": [
                                        {
                                          "id": 133924143269008,
                                          "label": "readInitPacket()",
                                          "successors": [
                                            {
                                              "id": 133924143269056,
                                              "label": "writeAuthPacket()",
                                              "successors": [
                                                {
                                                  "id": 133924143269104,
                                                  "label": "handleAuthResult()",
                                                  "successors": [
                                                    {
                                                      "id": 133924157626816,
                                                      "label": "return",
                                                      "successors": []
                                                    }
                                                  ]
                                                }
                                              ]
                                            }
                                          ]
                                        }
                                      ]
                                    }
                                  ]
                                }
                              ]
                            }
                          ]
                        }
                      ]
                    }
                  ]
                }
              ]
            }
          ],
          "functions": [],
          "classes": []
        },
        {
          "name": "getMetaData",
          "type": "Function",
          "blocks": [
            {
              "id": 133924157627344,
              "label": "",
              "successors": [
                {
                  "id": 133924143269248,
                  "label": "HashMap([])",
                  "successors": [
                    {
                      "id": 133924157627392,
                      "label": "return",
                      "successors": []
                    }
                  ]
                }
              ]
            }
          ],
          "functions": [],
          "classes": []
        },
        {
          "name": "createTransaction",
          "type": "Function",
          "blocks": [
            {
              "id": 133924157627920,
              "label": "",
              "successors": [
                {
                  "id": 133924143269392,
                  "label": "return MySqlTransaction()",
                  "successors": []
                }
              ]
            }
          ],
          "functions": [],
          "classes": []
        },
        {
          "name": "close",
          "type": "Function",
          "blocks": [
            {
              "id": 133924157628544,
              "label": "",
              "successors": [
                {
                  "id": 133924142898848,
                  "label": "return;",
                  "successors": [
                    {
                      "id": 133924157628592,
                      "label": "return",
                      "successors": []
                    }
                  ]
                }
              ]
            }
          ],
          "functions": [],
          "classes": []
        },
        {
          "name": "isClosed",
          "type": "Function",
          "blocks": [
            {
              "id": 133924157629120,
              "label": "",
              "successors": [
                {
                  "id": 133924143269680,
                  "label": "return false",
                  "successors": []
                }
              ]
            }
          ],
          "functions": [],
          "classes": []
        },
        {
          "name": "prepareStatement",
          "type": "Function",
          "blocks": [
            {
              "id": 133924157629744,
              "label": "",
              "successors": [
                {
                  "id": 133924143269824,
                  "label": "return MySqlStatement(this, sql)",
                  "successors": []
                }
              ]
            }
          ],
          "functions": [],
          "classes": []
        },
        {
          "name": "readInitPacket",
          "type": "Function",
          "blocks": [
            {
              "id": 133924157630464,
              "label": "",
              "successors": [
                {
                  "id": 133924143269968,
                  "label": "let data = readPacket()",
                  "successors": [
                    {
                      "id": 133924143270016,
                      "label": "var pos = 1 + ByteArrayUtils.indexByte(data[1..], 0) + 1 + 4",
                      "successors": [
                        {
                          "id": 133924143270064,
                          "label": "cipher = cipher.concat(data[pos..pos + 8])",
                          "successors": [
                            {
                              "id": 133924143270112,
                              "label": "pos = pos + 8 + 1",
                              "successors": [
                                {
                                  "id": 133924143270160,
                                  "label": "flags = UInt32(ByteArrayUtils.littleEndianUint16(data[pos .. pos + 2]))",
                                  "successors": [
                                    {
                                      "id": 133924143270208,
                                      "label": "pos = pos + 2",
                                      "successors": [
                                        {
                                          "id": 133924143270256,
                                          "label": "charset = data.get(pos).getOrThrow()",
                                          "successors": [
                                            {
                                              "id": 133924143270304,
                                              "label": "pos = pos + 1 + 2 + 2 + 1 + 10",
                                              "successors": [
                                                {
                                                  "id": 133924143270352,
                                                  "label": "cipher = cipher.concat(data[pos..pos + 12])",
                                                  "successors": [
                                                    {
                                                      "id": 133924143270400,
                                                      "label": "pos += 13",
                                                      "successors": [
                                                        {
                                                          "id": 133924143270448,
                                                          "label": "let end = ByteArrayUtils.indexByte(data[pos..], 0)",
                                                          "successors": [
                                                            {
                                                              "id": 133924143270496,
                                                              "label": "if (end != -1 )",
                                                              "successors": [
                                                                {
                                                                  "id": 133924143270880,
                                                                  "label": "plugin = String.fromUtf8(data[pos .. pos + end])",
                                                                  "successors": [
                                                                    {
                                                                      "id": 133924157630512,
                                                                      "label": "return",
                                                                      "successors": []
                                                                    }
                                                                  ]
                                                                },
                                                                {
                                                                  "id": 133924143271024,
                                                                  "label": "plugin = String.fromUtf8(data[pos .. ])",
                                                                  "successors": [
                                                                    {
                                                                      "id": 133924157630512
                                                                    }
                                                                  ]
                                                                }
                                                              ]
                                                            }
                                                          ]
                                                        }
                                                      ]
                                                    }
                                                  ]
                                                }
                                              ]
                                            }
                                          ]
                                        }
                                      ]
                                    }
                                  ]
                                }
                              ]
                            }
                          ]
                        }
                      ]
                    }
                  ]
                }
              ]
            }
          ],
          "functions": [],
          "classes": []
        },
        {
          "name": "writeAuthPacket",
          "type": "Function",
          "blocks": [
            {
              "id": 133924157631424,
              "label": "",
              "successors": [
                {
                  "id": 133924143270688,
                  "label": "var clientFlags: UInt32 = \n\t\t    clientProtocol41 |  \n\t\t\tclientSecureConn | \n\t\t\tclientLongPassword | \n\t\t\tclientTransactions | \n\t\t\tclientLocalFiles |  \n            clientPluginAuth |  \n            clientMultiResults | \n            flags &\n            clientLongFlag",
                  "successors": [
                    {
                      "id": 133924143270976,
                      "label": "let authResp = ByteArrayUtils.scrambleCachingSha2(cipher, config.password.toArray())",
                      "successors": [
                        {
                          "id": 133924143271072,
                          "label": "let authRespLen = authResp.size",
                          "successors": [
                            {
                              "id": 133924143271120,
                              "label": "let authRespLEI = ByteArrayUtils.appendLengthEncodedInteger(UInt64(authRespLen))",
                              "successors": [
                                {
                                  "id": 133924143271168,
                                  "label": "if (authRespLEI.size > 1 )",
                                  "successors": [
                                    {
                                      "id": 133924143271504,
                                      "label": "clientFlags |= clientPluginAuthLenEncClientData",
                                      "successors": [
                                        {
                                          "id": 133924143271264,
                                          "label": "var pktLen = 4 + 4 + 1 + 23 + config.username.toArray().size + 1 + authRespLEI.size + authResp.size + 21",
                                          "successors": [
                                            {
                                              "id": 133924143271312,
                                              "label": "if (config.dbname.size > 0 )",
                                              "successors": [
                                                {
                                                  "id": 133924143271792,
                                                  "label": "clientFlags |= UInt32(clientConnectWithDB)",
                                                  "successors": [
                                                    {
                                                      "id": 133924143271840,
                                                      "label": "pktLen += config.dbname.toArray().size + 1",
                                                      "successors": [
                                                        {
                                                          "id": 133924143271552,
                                                          "label": "let data = Array<Byte>(pktLen + 4, item: UInt8(0))",
                                                          "successors": [
                                                            {
                                                              "id": 133924143271600,
                                                              "label": "data[0] = UInt8(pktLen & 0xff)",
                                                              "successors": [
                                                                {
                                                                  "id": 133924143271744,
                                                                  "label": "data[1] = UInt8(pktLen >> 8)",
                                                                  "successors": [
                                                                    {
                                                                      "id": 133924143271888,
                                                                      "label": "data[2] = UInt8(pktLen >> 16)",
                                                                      "successors": [
                                                                        {
                                                                          "id": 133924143271936,
                                                                          "label": "data[3] = sequence",
                                                                          "successors": [
                                                                            {
                                                                              "id": 133924143271984,
                                                                              "label": "data[4] = UInt8(clientFlags & 0xff)",
                                                                              "successors": [
                                                                                {
                                                                                  "id": 133924143272032,
                                                                                  "label": "data[5] = UInt8(clientFlags >> 8 & 0xff)",
                                                                                  "successors": [
                                                                                    {
                                                                                      "id": 133924143272080,
                                                                                      "label": "data[6] = UInt8(clientFlags >> 16 & 0xff)",
                                                                                      "successors": [
                                                                                        {
                                                                                          "id": 133924143272128,
                                                                                          "label": "data[7] = UInt8(clientFlags >> 24 & 0xff)",
                                                                                          "successors": [
                                                                                            {
                                                                                              "id": 133924143272176,
                                                                                              "label": "data[12] = charset",
                                                                                              "successors": [
                                                                                                {
                                                                                                  "id": 133924143272224,
                                                                                                  "label": "var pos = 13 + 23",
                                                                                                  "successors": [
                                                                                                    {
                                                                                                      "id": 133924143272272,
                                                                                                      "label": "if (config.username.size > 0 )",
                                                                                                      "successors": [
                                                                                                        {
                                                                                                          "id": 133924143272608,
                                                                                                          "label": "config.username.toArray().copyTo(data, 0, pos, config.username.toArray().size)",
                                                                                                          "successors": [
                                                                                                            {
                                                                                                              "id": 133924143272656,
                                                                                                              "label": "pos += config.username.toArray().size",
                                                                                                              "successors": [
                                                                                                                {
                                                                                                                  "id": 133924143272368,
                                                                                                                  "label": "pos += 1",
                                                                                                                  "successors": [
                                                                                                                    {
                                                                                                                      "id": 133924143272416,
                                                                                                                      "label": "authRespLEI.copyTo(data, 0, pos, authRespLEI.size)",
                                                                                                                      "successors": [
                                                                                                                        {
                                                                                                                          "id": 133924143272560,
                                                                                                                          "label": "pos += authRespLEI.size",
                                                                                                                          "successors": [
                                                                                                                            {
                                                                                                                              "id": 133924143272704,
                                                                                                                              "label": "authResp.copyTo(data, 0, pos, authResp.size)",
                                                                                                                              "successors": [
                                                                                                                                {
                                                                                                                                  "id": 133924143272752,
                                                                                                                                  "label": "pos += authResp.size",
                                                                                                                                  "successors": [
                                                                                                                                    {
                                                                                                                                      "id": 133924143272800,
                                                                                                                                      "label": "if (config.dbname.size > 0 )",
                                                                                                                                      "successors": [
                                                                                                                                        {
                                                                                                                                          "id": 133924143273136,
                                                                                                                                          "label": "config.dbname.toArray().copyTo(data, 0, pos, config.dbname.toArray().size)",
                                                                                                                                          "successors": [
                                                                                                                                            {
                                                                                                                                              "id": 133924143273184,
                                                                                                                                              "label": "pos +=  config.dbname.toArray().size",
                                                                                                                                              "successors": [
                                                                                                                                                {
                                                                                                                                                  "id": 133924143273232,
                                                                                                                                                  "label": "pos += 1",
                                                                                                                                                  "successors": [
                                                                                                                                                    {
                                                                                                                                                      "id": 133924143272896,
                                                                                                                                                      "label": "plugin.toArray().copyTo(data, 0, pos, plugin.toArray().size)",
                                                                                                                                                      "successors": [
                                                                                                                                                        {
                                                                                                                                                          "id": 133924143272944,
                                                                                                                                                          "label": "pos += plugin.toArray().size",
                                                                                                                                                          "successors": [
                                                                                                                                                            {
                                                                                                                                                              "id": 133924143273088,
                                                                                                                                                              "label": "writePacket(data)",
                                                                                                                                                              "successors": [
                                                                                                                                                                {
                                                                                                                                                                  "id": 133924157631472,
                                                                                                                                                                  "label": "return",
                                                                                                                                                                  "successors": []
                                                                                                                                                                }
                                                                                                                                                              ]
                                                                                                                                                            }
                                                                                                                                                          ]
                                                                                                                                                        }
                                                                                                                                                      ]
                                                                                                                                                    }
                                                                                                                                                  ]
                                                                                                                                                }
                                                                                                                                              ]
                                                                                                                                            }
                                                                                                                                          ]
                                                                                                                                        },
                                                                                                                                        {
                                                                                                                                          "id": 133924143272896
                                                                                                                                        }
                                                                                                                                      ]
                                                                                                                                    }
                                                                                                                                  ]
                                                                                                                                }
                                                                                                                              ]
                                                                                                                            }
                                                                                                                          ]
                                                                                                                        }
                                                                                                                      ]
                                                                                                                    }
                                                                                                                  ]
                                                                                                                }
                                                                                                              ]
                                                                                                            }
                                                                                                          ]
                                                                                                        },
                                                                                                        {
                                                                                                          "id": 133924143272368
                                                                                                        }
                                                                                                      ]
                                                                                                    }
                                                                                                  ]
                                                                                                }
                                                                                              ]
                                                                                            }
                                                                                          ]
                                                                                        }
                                                                                      ]
                                                                                    }
                                                                                  ]
                                                                                }
                                                                              ]
                                                                            }
                                                                          ]
                                                                        }
                                                                      ]
                                                                    }
                                                                  ]
                                                                }
                                                              ]
                                                            }
                                                          ]
                                                        }
                                                      ]
                                                    }
                                                  ]
                                                },
                                                {
                                                  "id": 133924143271552
                                                }
                                              ]
                                            }
                                          ]
                                        }
                                      ]
                                    },
                                    {
                                      "id": 133924143271264
                                    }
                                  ]
                                }
                              ]
                            }
                          ]
                        }
                      ]
                    }
                  ]
                }
              ]
            }
          ],
          "functions": [],
          "classes": []
        },
        {
          "name": "handleAuthResult",
          "type": "Function",
          "blocks": [
            {
              "id": 133924157632288,
              "label": "",
              "successors": [
                {
                  "id": 133924143273424,
                  "label": "var result = readAuthResult()",
                  "successors": [
                    {
                      "id": 133924143273472,
                      "label": "var authData = result[0]",
                      "successors": [
                        {
                          "id": 133924143273520,
                          "label": "var newPlugin = result[1]",
                          "successors": [
                            {
                              "id": 133924143273568,
                              "label": "if (newPlugin != \"\" )",
                              "successors": [
                                {
                                  "id": 133924143273904,
                                  "label": "if (authData.size > 0 )",
                                  "successors": [
                                    {
                                      "id": 133924143274288,
                                      "label": "authData.copyTo(cipher, 0, 0, cipher.size)",
                                      "successors": [
                                        {
                                          "id": 133924143274000,
                                          "label": "plugin = newPlugin",
                                          "successors": [
                                            {
                                              "id": 133924143274048,
                                              "label": "let authResp = ByteArrayUtils.scrambleCachingSha2(authData, config.password.toArray())",
                                              "successors": [
                                                {
                                                  "id": 133924143274096,
                                                  "label": "writeAuthSwitchPacket(authResp)",
                                                  "successors": [
                                                    {
                                                      "id": 133924143274384,
                                                      "label": "result = readAuthResult()",
                                                      "successors": [
                                                        {
                                                          "id": 133924143274480,
                                                          "label": "authData = result[0]",
                                                          "successors": [
                                                            {
                                                              "id": 133924143274528,
                                                              "label": "newPlugin = result[1]",
                                                              "successors": [
                                                                {
                                                                  "id": 133924143273664,
                                                                  "label": "match (plugin )",
                                                                  "successors": [
                                                                    {
                                                                      "id": 133924143274864,
                                                                      "label": "match (authData.size )",
                                                                      "successors": [
                                                                        {
                                                                          "id": 133924143275344,
                                                                          "label": "match (authData[0] )",
                                                                          "successors": [
                                                                            {
                                                                              "id": 133924143275824,
                                                                              "label": "let pktLen = 1",
                                                                              "successors": [
                                                                                {
                                                                                  "id": 133924143275872,
                                                                                  "label": "let data = Array<Byte>(pktLen + 4, item: UInt8(0))",
                                                                                  "successors": [
                                                                                    {
                                                                                      "id": 133924143275920,
                                                                                      "label": "data[0] = UInt8(pktLen & 0xff)",
                                                                                      "successors": [
                                                                                        {
                                                                                          "id": 133924143275968,
                                                                                          "label": "data[1] = UInt8(pktLen >> 8)",
                                                                                          "successors": [
                                                                                            {
                                                                                              "id": 133924143276016,
                                                                                              "label": "data[2] = UInt8(pktLen >> 16)",
                                                                                              "successors": [
                                                                                                {
                                                                                                  "id": 133924143276064,
                                                                                                  "label": "data[3] = sequence",
                                                                                                  "successors": [
                                                                                                    {
                                                                                                      "id": 133924143276112,
                                                                                                      "label": "data[4] = cachingSha2PasswordRequestPublicKey",
                                                                                                      "successors": [
                                                                                                        {
                                                                                                          "id": 133924143276160,
                                                                                                          "label": "writePacket(data)",
                                                                                                          "successors": [
                                                                                                            {
                                                                                                              "id": 133924143276208,
                                                                                                              "label": "let publicKeyData = readPacket()",
                                                                                                              "successors": [
                                                                                                                {
                                                                                                                  "id": 133924143276256,
                                                                                                                  "label": "sendEncryptedPassword(publicKeyData[1..])",
                                                                                                                  "successors": [
                                                                                                                    {
                                                                                                                      "id": 133924143276304,
                                                                                                                      "label": "readPacket()",
                                                                                                                      "successors": [
                                                                                                                        {
                                                                                                                          "id": 133924157632336,
                                                                                                                          "label": "return",
                                                                                                                          "successors": []
                                                                                                                        }
                                                                                                                      ]
                                                                                                                    }
                                                                                                                  ]
                                                                                                                }
                                                                                                              ]
                                                                                                            }
                                                                                                          ]
                                                                                                        }
                                                                                                      ]
                                                                                                    }
                                                                                                  ]
                                                                                                }
                                                                                              ]
                                                                                            }
                                                                                          ]
                                                                                        }
                                                                                      ]
                                                                                    }
                                                                                  ]
                                                                                }
                                                                              ]
                                                                            },
                                                                            {
                                                                              "id": 133924143276592,
                                                                              "label": "println(\"eror or correct but do later\")",
                                                                              "successors": [
                                                                                {
                                                                                  "id": 133924157632336
                                                                                }
                                                                              ]
                                                                            }
                                                                          ]
                                                                        },
                                                                        {
                                                                          "id": 133924143276784,
                                                                          "label": "println(\"error size or correct size but do later \")",
                                                                          "successors": [
                                                                            {
                                                                              "id": 133924157632336
                                                                            }
                                                                          ]
                                                                        }
                                                                      ]
                                                                    },
                                                                    {
                                                                      "id": 133924143276976,
                                                                      "label": "println(\"other, do later\")",
                                                                      "successors": [
                                                                        {
                                                                          "id": 133924157632336
                                                                        }
                                                                      ]
                                                                    }
                                                                  ]
                                                                }
                                                              ]
                                                            }
                                                          ]
                                                        }
                                                      ]
                                                    }
                                                  ]
                                                }
                                              ]
                                            }
                                          ]
                                        }
                                      ]
                                    },
                                    {
                                      "id": 133924143274432,
                                      "label": "authData = cipher",
                                      "successors": [
                                        {
                                          "id": 133924143274000
                                        }
                                      ]
                                    }
                                  ]
                                },
                                {
                                  "id": 133924143273664
                                }
                              ]
                            }
                          ]
                        }
                      ]
                    }
                  ]
                }
              ]
            }
          ],
          "functions": [],
          "classes": []
        },
        {
          "name": "writeAuthSwitchPacket",
          "type": "Function",
          "blocks": [
            {
              "id": 133924157632960,
              "label": "",
              "successors": [
                {
                  "id": 133924143273856,
                  "label": "let pktLen = authData.size",
                  "successors": [
                    {
                      "id": 133924143277024,
                      "label": "let data = Array<Byte>(pktLen + 4, item: UInt8(0))",
                      "successors": [
                        {
                          "id": 133924143277072,
                          "label": "data[0] = UInt8(pktLen & 0xff)",
                          "successors": [
                            {
                              "id": 133924143277120,
                              "label": "data[1] = UInt8(pktLen >> 8)",
                              "successors": [
                                {
                                  "id": 133924143277168,
                                  "label": "data[2] = UInt8(pktLen >> 16)",
                                  "successors": [
                                    {
                                      "id": 133924143277216,
                                      "label": "data[3] = sequence",
                                      "successors": [
                                        {
                                          "id": 133924143277264,
                                          "label": "authData.copyTo(data, 0, 4, authData.size)",
                                          "successors": [
                                            {
                                              "id": 133924143277312,
                                              "label": "writePacket(data)",
                                              "successors": [
                                                {
                                                  "id": 133924157633008,
                                                  "label": "return",
                                                  "successors": []
                                                }
                                              ]
                                            }
                                          ]
                                        }
                                      ]
                                    }
                                  ]
                                }
                              ]
                            }
                          ]
                        }
                      ]
                    }
                  ]
                }
              ]
            }
          ],
          "functions": [],
          "classes": []
        },
        {
          "name": "readAuthResult",
          "type": "Function",
          "blocks": [
            {
              "id": 133924157633728,
              "label": "",
              "successors": [
                {
                  "id": 133924143277456,
                  "label": "let data = readPacket()",
                  "successors": [
                    {
                      "id": 133924143277504,
                      "label": "match (data[0] )",
                      "successors": [
                        {
                          "id": 133924143277936,
                          "label": "return (data[1..], \"\")",
                          "successors": []
                        },
                        {
                          "id": 133924143278224,
                          "label": "if (data.size == 1 )",
                          "successors": [
                            {
                              "id": 133924143278608,
                              "label": "return (Array<Byte>(), \"mysql_old_password\")",
                              "successors": []
                            },
                            {
                              "id": 133924143278368,
                              "label": "let pluginEndIndex = ByteArrayUtils.indexByte(data, 0)",
                              "successors": [
                                {
                                  "id": 133924143278416,
                                  "label": "if (pluginEndIndex < 0 )",
                                  "successors": [
                                    {
                                      "id": 133924143278944,
                                      "label": "return (Array<Byte>(), \"\")",
                                      "successors": []
                                    },
                                    {
                                      "id": 133924143278704,
                                      "label": "let plugin = String.fromUtf8(data[1..pluginEndIndex])",
                                      "successors": [
                                        {
                                          "id": 133924143278752,
                                          "label": "let authData = data[pluginEndIndex + 1 ..]",
                                          "successors": [
                                            {
                                              "id": 133924143278896,
                                              "label": "return (authData, plugin)",
                                              "successors": []
                                            }
                                          ]
                                        }
                                      ]
                                    }
                                  ]
                                }
                              ]
                            }
                          ]
                        },
                        {
                          "id": 133924143279232,
                          "label": "println(\"other, do later\")",
                          "successors": [
                            {
                              "id": 133924143279280,
                              "label": "return (Array<Byte>(), \"\")",
                              "successors": []
                            }
                          ]
                        }
                      ]
                    }
                  ]
                }
              ]
            }
          ],
          "functions": [],
          "classes": []
        },
        {
          "name": "sendEncryptedPassword",
          "type": "Function",
          "blocks": [
            {
              "id": 133924157634400,
              "label": "",
              "successors": [
                {
                  "id": 133924143279328,
                  "label": "let encrypted = ByteArrayUtils.scrambleRSA(config.password, publicKey, cipher)\n        (\"encrypted = \" + encrypted.toString())",
                  "successors": [
                    {
                      "id": 133924143279376,
                      "label": "writeAuthSwitchPacket(encrypted)",
                      "successors": [
                        {
                          "id": 133924157634448,
                          "label": "return",
                          "successors": []
                        }
                      ]
                    }
                  ]
                }
              ]
            }
          ],
          "functions": [],
          "classes": []
        },
        {
          "name": "writeCommandPacketStr",
          "type": "Function",
          "blocks": [
            {
              "id": 133924157635120,
              "label": "",
              "successors": [
                {
                  "id": 133924143279520,
                  "label": "sequence = 0",
                  "successors": [
                    {
                      "id": 133924143279568,
                      "label": "let pktLen = 1 + sql.toArray().size",
                      "successors": [
                        {
                          "id": 133924143279616,
                          "label": "let data = Array<Byte>(pktLen + 4, item: UInt8(0))",
                          "successors": [
                            {
                              "id": 133924143279664,
                              "label": "data[0] = UInt8(pktLen & 0xff)",
                              "successors": [
                                {
                                  "id": 133924143279712,
                                  "label": "data[1] = UInt8(pktLen >> 8)",
                                  "successors": [
                                    {
                                      "id": 133924143279760,
                                      "label": "data[2] = UInt8(pktLen >> 16)",
                                      "successors": [
                                        {
                                          "id": 133924143279808,
                                          "label": "data[3] = sequence",
                                          "successors": [
                                            {
                                              "id": 133924143279856,
                                              "label": "data[4] = command",
                                              "successors": [
                                                {
                                                  "id": 133924143279904,
                                                  "label": "sql.toArray().copyTo(data, 0, 5, sql.toArray().size)",
                                                  "successors": [
                                                    {
                                                      "id": 133924143279952,
                                                      "label": "writePacket(data)",
                                                      "successors": [
                                                        {
                                                          "id": 133924157635168,
                                                          "label": "return",
                                                          "successors": []
                                                        }
                                                      ]
                                                    }
                                                  ]
                                                }
                                              ]
                                            }
                                          ]
                                        }
                                      ]
                                    }
                                  ]
                                }
                              ]
                            }
                          ]
                        }
                      ]
                    }
                  ]
                }
              ]
            }
          ],
          "functions": [],
          "classes": []
        },
        {
          "name": "readColumns",
          "type": "Function",
          "blocks": [
            {
              "id": 133924157635744,
              "label": "",
              "successors": [
                {
                  "id": 133924143280096,
                  "label": "let returnResult = ArrayList<MySqlField>()",
                  "successors": [
                    {
                      "id": 133924143280144,
                      "label": "for (i in 0..count )",
                      "successors": [
                        {
                          "id": 133924143280432,
                          "label": "let data = readPacket()",
                          "successors": [
                            {
                              "id": 133924143280480,
                              "label": "var pos = 0",
                              "successors": [
                                {
                                  "id": 133924143280528,
                                  "label": "let mysqlField = MySqlField()",
                                  "successors": [
                                    {
                                      "id": 133924143280576,
                                      "label": "var result = ByteArrayUtils.readLengthEncodedString(data)",
                                      "successors": [
                                        {
                                          "id": 133924143280624,
                                          "label": "var catalog = String.fromUtf8(result[0])",
                                          "successors": [
                                            {
                                              "id": 133924143280672,
                                              "label": "pos += result[2]",
                                              "successors": [
                                                {
                                                  "id": 133924143280720,
                                                  "label": "result = ByteArrayUtils.readLengthEncodedString(data[pos..])",
                                                  "successors": [
                                                    {
                                                      "id": 133924143280768,
                                                      "label": "var database = String.fromUtf8(result[0])",
                                                      "successors": [
                                                        {
                                                          "id": 133924143280816,
                                                          "label": "pos += result[2]",
                                                          "successors": [
                                                            {
                                                              "id": 133924143280864,
                                                              "label": "result = ByteArrayUtils.readLengthEncodedString(data[pos..])",
                                                              "successors": [
                                                                {
                                                                  "id": 133924143280912,
                                                                  "label": "var tableName = String.fromUtf8(result[0])",
                                                                  "successors": [
                                                                    {
                                                                      "id": 133924143280960,
                                                                      "label": "pos += result[2]",
                                                                      "successors": [
                                                                        {
                                                                          "id": 133924143281008,
                                                                          "label": "mysqlField.setTableName(tableName)",
                                                                          "successors": [
                                                                            {
                                                                              "id": 133924143281056,
                                                                              "label": "result = ByteArrayUtils.readLengthEncodedString(data[pos..])",
                                                                              "successors": [
                                                                                {
                                                                                  "id": 133924143281104,
                                                                                  "label": "var orgTableName = String.fromUtf8(result[0])",
                                                                                  "successors": [
                                                                                    {
                                                                                      "id": 133924143281152,
                                                                                      "label": "pos += result[2]",
                                                                                      "successors": [
                                                                                        {
                                                                                          "id": 133924143281200,
                                                                                          "label": "result = ByteArrayUtils.readLengthEncodedString(data[pos..])",
                                                                                          "successors": [
                                                                                            {
                                                                                              "id": 133924143281248,
                                                                                              "label": "var name = String.fromUtf8(result[0])",
                                                                                              "successors": [
                                                                                                {
                                                                                                  "id": 133924143281296,
                                                                                                  "label": "pos += result[2]",
                                                                                                  "successors": [
                                                                                                    {
                                                                                                      "id": 133924143281344,
                                                                                                      "label": "mysqlField.setName(name)",
                                                                                                      "successors": [
                                                                                                        {
                                                                                                          "id": 133924143281392,
                                                                                                          "label": "result = ByteArrayUtils.readLengthEncodedString(data[pos..])",
                                                                                                          "successors": [
                                                                                                            {
                                                                                                              "id": 133924143281440,
                                                                                                              "label": "var orgName = String.fromUtf8(result[0])",
                                                                                                              "successors": [
                                                                                                                {
                                                                                                                  "id": 133924143281488,
                                                                                                                  "label": "pos += result[2]",
                                                                                                                  "successors": [
                                                                                                                    {
                                                                                                                      "id": 133924143281536,
                                                                                                                      "label": "pos ++",
                                                                                                                      "successors": [
                                                                                                                        {
                                                                                                                          "id": 133924143281584,
                                                                                                                          "label": "mysqlField.setCharSet(data[pos])",
                                                                                                                          "successors": [
                                                                                                                            {
                                                                                                                              "id": 133924143281632,
                                                                                                                              "label": "pos += 2",
                                                                                                                              "successors": [
                                                                                                                                {
                                                                                                                                  "id": 133924143281680,
                                                                                                                                  "label": "mysqlField.setLength(ByteArrayUtils.littleEndianUint32(data[pos..pos + 4]))",
                                                                                                                                  "successors": [
                                                                                                                                    {
                                                                                                                                      "id": 133924143281728,
                                                                                                                                      "label": "pos += 4",
                                                                                                                                      "successors": [
                                                                                                                                        {
                                                                                                                                          "id": 133924143281776,
                                                                                                                                          "label": "mysqlField.setFieldType(UInt16(data[pos]))",
                                                                                                                                          "successors": [
                                                                                                                                            {
                                                                                                                                              "id": 133924143281824,
                                                                                                                                              "label": "pos ++",
                                                                                                                                              "successors": [
                                                                                                                                                {
                                                                                                                                                  "id": 133924143281872,
                                                                                                                                                  "label": "mysqlField.setFlags(ByteArrayUtils.littleEndianUint16(data[pos .. pos + 2]))",
                                                                                                                                                  "successors": [
                                                                                                                                                    {
                                                                                                                                                      "id": 133924143281920,
                                                                                                                                                      "label": "pos += 2",
                                                                                                                                                      "successors": [
                                                                                                                                                        {
                                                                                                                                                          "id": 133924143281968,
                                                                                                                                                          "label": "mysqlField.setDecimals(data[pos])",
                                                                                                                                                          "successors": [
                                                                                                                                                            {
                                                                                                                                                              "id": 133924143282016,
                                                                                                                                                              "label": "returnResult.append(mysqlField)",
                                                                                                                                                              "successors": [
                                                                                                                                                                {
                                                                                                                                                                  "id": 133924143280144
                                                                                                                                                                }
                                                                                                                                                              ]
                                                                                                                                                            }
                                                                                                                                                          ]
                                                                                                                                                        }
                                                                                                                                                      ]
                                                                                                                                                    }
                                                                                                                                                  ]
                                                                                                                                                }
                                                                                                                                              ]
                                                                                                                                            }
                                                                                                                                          ]
                                                                                                                                        }
                                                                                                                                      ]
                                                                                                                                    }
                                                                                                                                  ]
                                                                                                                                }
                                                                                                                              ]
                                                                                                                            }
                                                                                                                          ]
                                                                                                                        }
                                                                                                                      ]
                                                                                                                    }
                                                                                                                  ]
                                                                                                                }
                                                                                                              ]
                                                                                                            }
                                                                                                          ]
                                                                                                        }
                                                                                                      ]
                                                                                                    }
                                                                                                  ]
                                                                                                }
                                                                                              ]
                                                                                            }
                                                                                          ]
                                                                                        }
                                                                                      ]
                                                                                    }
                                                                                  ]
                                                                                }
                                                                              ]
                                                                            }
                                                                          ]
                                                                        }
                                                                      ]
                                                                    }
                                                                  ]
                                                                }
                                                              ]
                                                            }
                                                          ]
                                                        }
                                                      ]
                                                    }
                                                  ]
                                                }
                                              ]
                                            }
                                          ]
                                        }
                                      ]
                                    }
                                  ]
                                }
                              ]
                            }
                          ]
                        },
                        {
                          "id": 133924143280240,
                          "label": "let data = readPacket()",
                          "successors": [
                            {
                              "id": 133924143280384,
                              "label": "return returnResult",
                              "successors": []
                            }
                          ]
                        }
                      ]
                    }
                  ]
                }
              ]
            }
          ],
          "functions": [],
          "classes": []
        },
        {
          "name": "readRows",
          "type": "Function",
          "blocks": [
            {
              "id": 133924157636320,
              "label": "",
              "successors": [
                {
                  "id": 133924143282208,
                  "label": "let result = ArrayList<Array<Byte>>()",
                  "successors": [
                    {
                      "id": 133924143282256,
                      "label": "while (true )",
                      "successors": [
                        {
                          "id": 133924143282592,
                          "label": "let data = readPacket()",
                          "successors": [
                            {
                              "id": 133924143282640,
                              "label": "match (data[0] )",
                              "successors": [
                                {
                                  "id": 133924143282400,
                                  "label": "return result",
                                  "successors": []
                                },
                                {
                                  "id": 133924143283360,
                                  "label": "result.append(data)",
                                  "successors": [
                                    {
                                      "id": 133924143282256
                                    }
                                  ]
                                }
                              ]
                            }
                          ]
                        },
                        {
                          "id": 133924143282400
                        }
                      ]
                    }
                  ]
                }
              ]
            }
          ],
          "functions": [],
          "classes": []
        },
        {
          "name": "readPacket",
          "type": "Function",
          "blocks": [
            {
              "id": 133924157915488,
              "label": "",
              "successors": [
                {
                  "id": 133924143282784,
                  "label": "let data = buffer.readNext(4)",
                  "successors": [
                    {
                      "id": 133924143283408,
                      "label": "let pktLen = Int64(UInt32(data[0]) | UInt32(data[1])<<8 | UInt32(data[2])<<16)",
                      "successors": [
                        {
                          "id": 133924143283456,
                          "label": "if (data[3] != sequence )",
                          "successors": [
                            {
                              "id": 133924143283840,
                              "label": "println(\"ERROR sequence NOT EQUAL\")",
                              "successors": [
                                {
                                  "id": 133924143283600,
                                  "label": "sequence ++",
                                  "successors": [
                                    {
                                      "id": 133924143283648,
                                      "label": "let resultData = buffer.readNext(pktLen)",
                                      "successors": [
                                        {
                                          "id": 133924143283792,
                                          "label": "if (pktLen < maxPacketSize )",
                                          "successors": [
                                            {
                                              "id": 133924143284176,
                                              "label": "return resultData",
                                              "successors": []
                                            },
                                            {
                                              "id": 133924143283984,
                                              "label": "let resultData2 = readPacket()",
                                              "successors": [
                                                {
                                                  "id": 133924143284032,
                                                  "label": "return resultData.concat(resultData2)",
                                                  "successors": []
                                                }
                                              ]
                                            }
                                          ]
                                        }
                                      ]
                                    }
                                  ]
                                }
                              ]
                            },
                            {
                              "id": 133924143283600
                            }
                          ]
                        }
                      ]
                    }
                  ]
                }
              ]
            }
          ],
          "functions": [],
          "classes": []
        },
        {
          "name": "readUntilEOF",
          "type": "Function",
          "blocks": [
            {
              "id": 133924157916064,
              "label": "",
              "successors": [
                {
                  "id": 133924141400272,
                  "label": "let result = ArrayList<Byte>()",
                  "successors": [
                    {
                      "id": 133924141400320,
                      "label": "while (true )",
                      "successors": [
                        {
                          "id": 133924141400656,
                          "label": "let tempData = readPacket()",
                          "successors": [
                            {
                              "id": 133924141400704,
                              "label": "match (tempData[0] )",
                              "successors": [
                                {
                                  "id": 133924141400464,
                                  "label": "return result.toArray()",
                                  "successors": []
                                },
                                {
                                  "id": 133924141401424,
                                  "label": "println(\"error happen, do later\")",
                                  "successors": [
                                    {
                                      "id": 133924141400320
                                    }
                                  ]
                                },
                                {
                                  "id": 133924141401712,
                                  "label": "result.appendAll(tempData)",
                                  "successors": [
                                    {
                                      "id": 133924141400320
                                    }
                                  ]
                                }
                              ]
                            }
                          ]
                        },
                        {
                          "id": 133924141400464
                        }
                      ]
                    }
                  ]
                }
              ]
            }
          ],
          "functions": [],
          "classes": []
        },
        {
          "name": "writePacket",
          "type": "Function",
          "blocks": [
            {
              "id": 133924157916736,
              "label": "",
              "successors": [
                {
                  "id": 133924141401760,
                  "label": "try",
                  "successors": [
                    {
                      "id": 133924141402048,
                      "label": "this.tcpSocket.write(data)",
                      "successors": [
                        {
                          "id": 133924141402096,
                          "label": "sequence ++",
                          "successors": [
                            {
                              "id": 133924141402288,
                              "label": "finally",
                              "successors": [
                                {
                                  "id": 133924157916784,
                                  "label": "return",
                                  "successors": []
                                }
                              ]
                            }
                          ]
                        }
                      ]
                    },
                    {
                      "id": 133924141402144,
                      "label": "catch( ( e: SocketException )",
                      "successors": [
                        {
                          "id": 133924141402336,
                          "label": "println(\"send fail \" + e.message)",
                          "successors": [
                            {
                              "id": 133924141402000,
                              "label": "",
                              "successors": []
                            }
                          ]
                        }
                      ]
                    },
                    {
                      "id": 133924141402384,
                      "label": "",
                      "successors": [
                        {
                          "id": 133924157916784
                        }
                      ]
                    }
                  ]
                }
              ]
            }
          ],
          "functions": [],
          "classes": []
        }
      ],
      "classes": []
    }
  ]
}
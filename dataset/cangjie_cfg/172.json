{
  "name": "172.cj",
  "type": "File",
  "blocks": [],
  "functions": [],
  "classes": [
    {
      "name": "_DEFAULT_CANG_CLASS",
      "type": "Class",
      "blocks": [],
      "functions": [
        {
          "name": "clip",
          "type": "Function",
          "blocks": [
            {
              "id": 133924157492672,
              "label": "",
              "successors": [
                {
                  "id": 133924142901248,
                  "label": "let orig = r.min.clone()",
                  "successors": [
                    {
                      "id": 133924142901296,
                      "label": "var rect = r.intersect(dst.bounds())",
                      "successors": [
                        {
                          "id": 133924142901344,
                          "label": "rect = rect.intersect(src.bounds() + (orig - sp))",
                          "successors": [
                            {
                              "id": 133924142901392,
                              "label": "if (!(mask is NilImage) )",
                              "successors": [
                                {
                                  "id": 133924142901776,
                                  "label": "rect = rect.intersect(mask.bounds() + (orig - mp))",
                                  "successors": [
                                    {
                                      "id": 133924142901536,
                                      "label": "let dx = rect.min.x - orig.x",
                                      "successors": [
                                        {
                                          "id": 133924142901584,
                                          "label": "let dy = rect.min.y - orig.y",
                                          "successors": [
                                            {
                                              "id": 133924142901728,
                                              "label": "if (dx == 0 && dy == 0 )",
                                              "successors": [
                                                {
                                                  "id": 133924142902160,
                                                  "label": "return (dst, rect)",
                                                  "successors": []
                                                },
                                                {
                                                  "id": 133924142901920,
                                                  "label": "sp.x += dx",
                                                  "successors": [
                                                    {
                                                      "id": 133924142901968,
                                                      "label": "sp.y += dy",
                                                      "successors": [
                                                        {
                                                          "id": 133924142902112,
                                                          "label": "if (!(mp is NilPoint) )",
                                                          "successors": [
                                                            {
                                                              "id": 133924142902544,
                                                              "label": "mp.x += dx",
                                                              "successors": [
                                                                {
                                                                  "id": 133924142902592,
                                                                  "label": "mp.y += dy",
                                                                  "successors": [
                                                                    {
                                                                      "id": 133924142902304,
                                                                      "label": "return (dst, rect)",
                                                                      "successors": []
                                                                    }
                                                                  ]
                                                                }
                                                              ]
                                                            },
                                                            {
                                                              "id": 133924142902304
                                                            }
                                                          ]
                                                        }
                                                      ]
                                                    }
                                                  ]
                                                }
                                              ]
                                            }
                                          ]
                                        }
                                      ]
                                    }
                                  ]
                                },
                                {
                                  "id": 133924142901536
                                }
                              ]
                            }
                          ]
                        }
                      ]
                    }
                  ]
                }
              ]
            }
          ],
          "functions": [],
          "classes": []
        },
        {
          "name": "processBackward",
          "type": "Function",
          "blocks": [
            {
              "id": 133924157493488,
              "label": "",
              "successors": [
                {
                  "id": 133924142902640,
                  "label": "dst.eq(src) && r.overlaps(r + (sp - r.min)) && (sp.y < r.min.y || (sp.y == r.min.y && sp.x < r.min.x))",
                  "successors": [
                    {
                      "id": 133924157493536,
                      "label": "return",
                      "successors": []
                    }
                  ]
                }
              ]
            }
          ],
          "functions": [],
          "classes": []
        },
        {
          "name": "draw",
          "type": "Function",
          "blocks": [
            {
              "id": 133924157494496,
              "label": "",
              "successors": [
                {
                  "id": 133924142902784,
                  "label": "drawMask(dst, r, src, sp, nilImage, Point(), op)",
                  "successors": [
                    {
                      "id": 133924157494544,
                      "label": "return",
                      "successors": []
                    }
                  ]
                }
              ]
            }
          ],
          "functions": [],
          "classes": []
        },
        {
          "name": "drawMask",
          "type": "Function",
          "blocks": [
            {
              "id": 133924157495504,
              "label": "",
              "successors": [
                {
                  "id": 133924142902928,
                  "label": "var (dst0, rect0) = clip(dst, r, src, sp, mask, mp)",
                  "successors": [
                    {
                      "id": 133924142902976,
                      "label": "if (rect0.empty() )",
                      "successors": [
                        {
                          "id": 133924142903360,
                          "label": "return (dst0, rect0)",
                          "successors": []
                        },
                        {
                          "id": 133924142903168,
                          "label": "var mDst: ImageI = dst0",
                          "successors": [
                            {
                              "id": 133924142903408,
                              "label": "var mRect: Rectangle = rect0",
                              "successors": [
                                {
                                  "id": 133924142903456,
                                  "label": "if (mDst is image.RGBA )",
                                  "successors": [
                                    {
                                      "id": 133924142903888,
                                      "label": "let dstx = (mDst as image.RGBA).getOrThrow()",
                                      "successors": [
                                        {
                                          "id": 133924142903936,
                                          "label": "if (op == Over )",
                                          "successors": [
                                            {
                                              "id": 133924142904320,
                                              "label": "if (mask is NilImage )",
                                              "successors": [
                                                {
                                                  "id": 133924142904704,
                                                  "label": "if (src is image.Uniform )",
                                                  "successors": [
                                                    {
                                                      "id": 133924142905136,
                                                      "label": "let src0 = (src as image.Uniform).getOrThrow()",
                                                      "successors": [
                                                        {
                                                          "id": 133924142905184,
                                                          "label": "let (sr, sg, sb, sa) = src0.rgba()",
                                                          "successors": [
                                                            {
                                                              "id": 133924142905232,
                                                              "label": "if (sa == 0xffff )",
                                                              "successors": [
                                                                {
                                                                  "id": 133924142905616,
                                                                  "label": "return drawFillSrc(dstx, mRect, sr, sg, sb, sa)",
                                                                  "successors": []
                                                                },
                                                                {
                                                                  "id": 133924142905760,
                                                                  "label": "return drawFillOver(dstx, mRect, sr, sg, sb, sa)",
                                                                  "successors": []
                                                                }
                                                              ]
                                                            }
                                                          ]
                                                        }
                                                      ]
                                                    },
                                                    {
                                                      "id": 133924142905424,
                                                      "label": "if (src is image.RGBA )",
                                                      "successors": [
                                                        {
                                                          "id": 133924142906096,
                                                          "label": "let src0 = (src as image.RGBA).getOrThrow()",
                                                          "successors": [
                                                            {
                                                              "id": 133924142906144,
                                                              "label": "return drawCopyOver(dstx, mRect, src0, sp)",
                                                              "successors": []
                                                            }
                                                          ]
                                                        },
                                                        {
                                                          "id": 133924142906288,
                                                          "label": "if (src is image.NRGBA )",
                                                          "successors": [
                                                            {
                                                              "id": 133924142906672,
                                                              "label": "let src0 = (src as image.NRGBA).getOrThrow()",
                                                              "successors": [
                                                                {
                                                                  "id": 133924142906720,
                                                                  "label": "return drawNRGBAOver(dstx, mRect, src0, sp)",
                                                                  "successors": []
                                                                }
                                                              ]
                                                            },
                                                            {
                                                              "id": 133924142906864,
                                                              "label": "if (src is image.YCbCr )",
                                                              "successors": [
                                                                {
                                                                  "id": 133924142907248,
                                                                  "label": "let src0 = (src as image.YCbCr).getOrThrow()",
                                                                  "successors": [
                                                                    {
                                                                      "id": 133924142907296,
                                                                      "label": "if (drawYCbCr(dstx, mRect, src0, sp) )",
                                                                      "successors": [
                                                                        {
                                                                          "id": 133924143055200,
                                                                          "label": "return (dstx, mRect)",
                                                                          "successors": []
                                                                        },
                                                                        {
                                                                          "id": 133924142904032,
                                                                          "label": "return drawRGBA(dstx, mRect, src, sp, mask, mp, op)",
                                                                          "successors": []
                                                                        }
                                                                      ]
                                                                    }
                                                                  ]
                                                                },
                                                                {
                                                                  "id": 133924143055152,
                                                                  "label": "if (src is image.Gray )",
                                                                  "successors": [
                                                                    {
                                                                      "id": 133924143055584,
                                                                      "label": "let src0 = (src as image.Gray).getOrThrow()",
                                                                      "successors": [
                                                                        {
                                                                          "id": 133924143055632,
                                                                          "label": "return drawGray(dstx, mRect, src0, sp)",
                                                                          "successors": []
                                                                        }
                                                                      ]
                                                                    },
                                                                    {
                                                                      "id": 133924143055776,
                                                                      "label": "if (src is image.CMYK )",
                                                                      "successors": [
                                                                        {
                                                                          "id": 133924143056208,
                                                                          "label": "let src0 = (src as image.CMYK).getOrThrow()",
                                                                          "successors": [
                                                                            {
                                                                              "id": 133924143056256,
                                                                              "label": "return drawCMYK(dstx, mRect, src0, sp)",
                                                                              "successors": []
                                                                            }
                                                                          ]
                                                                        },
                                                                        {
                                                                          "id": 133924142904032
                                                                        }
                                                                      ]
                                                                    }
                                                                  ]
                                                                }
                                                              ]
                                                            }
                                                          ]
                                                        }
                                                      ]
                                                    }
                                                  ]
                                                },
                                                {
                                                  "id": 133924142904944,
                                                  "label": "if (mask is image.Alpha )",
                                                  "successors": [
                                                    {
                                                      "id": 133924142906480,
                                                      "label": "if (src is image.Uniform )",
                                                      "successors": [
                                                        {
                                                          "id": 133924143055728,
                                                          "label": "let mask0 = (mask as image.Alpha).getOrThrow()",
                                                          "successors": [
                                                            {
                                                              "id": 133924143055920,
                                                              "label": "let src0 = (src as image.Uniform).getOrThrow()",
                                                              "successors": [
                                                                {
                                                                  "id": 133924143055968,
                                                                  "label": "return drawGlyphOver(dstx, mRect, src0, mask0, mp)",
                                                                  "successors": []
                                                                }
                                                              ]
                                                            }
                                                          ]
                                                        },
                                                        {
                                                          "id": 133924142904032
                                                        }
                                                      ]
                                                    },
                                                    {
                                                      "id": 133924142904032
                                                    }
                                                  ]
                                                }
                                              ]
                                            },
                                            {
                                              "id": 133924142904512,
                                              "label": "if (mask is NilImage )",
                                              "successors": [
                                                {
                                                  "id": 133924143056160,
                                                  "label": "if (src is image.Uniform )",
                                                  "successors": [
                                                    {
                                                      "id": 133924143056688,
                                                      "label": "let src0 = (src as image.Uniform).getOrThrow()",
                                                      "successors": [
                                                        {
                                                          "id": 133924143056736,
                                                          "label": "let (sr, sg, sb, sa) = src0.rgba()",
                                                          "successors": [
                                                            {
                                                              "id": 133924143056784,
                                                              "label": "return drawFillSrc(dstx, mRect, sr, sg, sb, sa)",
                                                              "successors": []
                                                            }
                                                          ]
                                                        }
                                                      ]
                                                    },
                                                    {
                                                      "id": 133924143056928,
                                                      "label": "if (src is image.RGBA )",
                                                      "successors": [
                                                        {
                                                          "id": 133924143057312,
                                                          "label": "let src0 = (src as image.RGBA).getOrThrow()",
                                                          "successors": [
                                                            {
                                                              "id": 133924143057360,
                                                              "label": "return drawCopySrc(dstx, mRect, src0, sp)",
                                                              "successors": []
                                                            }
                                                          ]
                                                        },
                                                        {
                                                          "id": 133924143057504,
                                                          "label": "if (src is image.NRGBA )",
                                                          "successors": [
                                                            {
                                                              "id": 133924143057888,
                                                              "label": "let src0 = (src as image.NRGBA).getOrThrow()",
                                                              "successors": [
                                                                {
                                                                  "id": 133924143057936,
                                                                  "label": "return drawNRGBASrc(dstx, mRect, src0, sp)",
                                                                  "successors": []
                                                                }
                                                              ]
                                                            },
                                                            {
                                                              "id": 133924143058080,
                                                              "label": "if (src is image.YCbCr )",
                                                              "successors": [
                                                                {
                                                                  "id": 133924143058464,
                                                                  "label": "let src0 = (src as image.YCbCr).getOrThrow()",
                                                                  "successors": [
                                                                    {
                                                                      "id": 133924143058512,
                                                                      "label": "if (drawYCbCr(dstx, mRect, src0, sp) )",
                                                                      "successors": [
                                                                        {
                                                                          "id": 133924143058896,
                                                                          "label": "return (dstx, mRect)",
                                                                          "successors": []
                                                                        },
                                                                        {
                                                                          "id": 133924142904032
                                                                        }
                                                                      ]
                                                                    }
                                                                  ]
                                                                },
                                                                {
                                                                  "id": 133924143058848,
                                                                  "label": "if (src is image.Gray )",
                                                                  "successors": [
                                                                    {
                                                                      "id": 133924143059280,
                                                                      "label": "let src0 = (src as image.Gray).getOrThrow()",
                                                                      "successors": [
                                                                        {
                                                                          "id": 133924143059328,
                                                                          "label": "return drawGray(dstx, mRect, src0, sp)",
                                                                          "successors": []
                                                                        }
                                                                      ]
                                                                    },
                                                                    {
                                                                      "id": 133924143059472,
                                                                      "label": "if (src is image.CMYK )",
                                                                      "successors": [
                                                                        {
                                                                          "id": 133924143059856,
                                                                          "label": "let src0 = (src as image.CMYK).getOrThrow()",
                                                                          "successors": [
                                                                            {
                                                                              "id": 133924143059904,
                                                                              "label": "return drawCMYK(dstx, mRect, src0, sp)",
                                                                              "successors": []
                                                                            }
                                                                          ]
                                                                        },
                                                                        {
                                                                          "id": 133924142904032
                                                                        }
                                                                      ]
                                                                    }
                                                                  ]
                                                                }
                                                              ]
                                                            }
                                                          ]
                                                        }
                                                      ]
                                                    }
                                                  ]
                                                },
                                                {
                                                  "id": 133924142904032
                                                }
                                              ]
                                            }
                                          ]
                                        }
                                      ]
                                    },
                                    {
                                      "id": 133924142904464,
                                      "label": "if (mDst is image.Paletted )",
                                      "successors": [
                                        {
                                          "id": 133924143057024,
                                          "label": "let dst0 = (mDst as image.Paletted).getOrThrow()",
                                          "successors": [
                                            {
                                              "id": 133924143057072,
                                              "label": "if (op == Src && mask is NilImage )",
                                              "successors": [
                                                {
                                                  "id": 133924143058224,
                                                  "label": "if (src is image.Uniform )",
                                                  "successors": [
                                                    {
                                                      "id": 133924143059664,
                                                      "label": "let src0 = (src as image.Uniform).getOrThrow()",
                                                      "successors": [
                                                        {
                                                          "id": 133924143059808,
                                                          "label": "let colorIndex = UInt8(dst0.palette.index(src0.c))",
                                                          "successors": [
                                                            {
                                                              "id": 133924143059952,
                                                              "label": "var i0 = dst0.pixOffset(mRect.min.x, mRect.min.y)",
                                                              "successors": [
                                                                {
                                                                  "id": 133924143060000,
                                                                  "label": "var i1 = i0 + mRect.dx()",
                                                                  "successors": [
                                                                    {
                                                                      "id": 133924143060048,
                                                                      "label": "for (i in i0..i1 )",
                                                                      "successors": [
                                                                        {
                                                                          "id": 133924143060336,
                                                                          "label": "dst0.pix[i] = colorIndex",
                                                                          "successors": [
                                                                            {
                                                                              "id": 133924143060048
                                                                            }
                                                                          ]
                                                                        },
                                                                        {
                                                                          "id": 133924143060144,
                                                                          "label": "let firstRow = dst0.pix[i0..i1]",
                                                                          "successors": [
                                                                            {
                                                                              "id": 133924143060288,
                                                                              "label": "for (_ in (mRect.min.y + 1)..mRect.max.y )",
                                                                              "successors": [
                                                                                {
                                                                                  "id": 133924143060672,
                                                                                  "label": "i0 += dst0.stride",
                                                                                  "successors": [
                                                                                    {
                                                                                      "id": 133924143060720,
                                                                                      "label": "i1 += dst0.stride",
                                                                                      "successors": [
                                                                                        {
                                                                                          "id": 133924143060768,
                                                                                          "label": "firstRow.copyTo(dst0.pix, 0, i0, i1 - i0)",
                                                                                          "successors": [
                                                                                            {
                                                                                              "id": 133924143060288
                                                                                            }
                                                                                          ]
                                                                                        }
                                                                                      ]
                                                                                    }
                                                                                  ]
                                                                                },
                                                                                {
                                                                                  "id": 133924143060480,
                                                                                  "label": "return (dst0, mRect)",
                                                                                  "successors": []
                                                                                }
                                                                              ]
                                                                            }
                                                                          ]
                                                                        }
                                                                      ]
                                                                    }
                                                                  ]
                                                                }
                                                              ]
                                                            }
                                                          ]
                                                        }
                                                      ]
                                                    },
                                                    {
                                                      "id": 133924143060864,
                                                      "label": "if (!processBackward(dst0, mRect, src, sp) )",
                                                      "successors": [
                                                        {
                                                          "id": 133924143061248,
                                                          "label": "return drawPaletted(dst0, mRect, src, sp, false)",
                                                          "successors": []
                                                        },
                                                        {
                                                          "id": 133924142903552,
                                                          "label": "var x0 = mRect.min.x",
                                                          "successors": [
                                                            {
                                                              "id": 133924142903600,
                                                              "label": "var x1 = mRect.max.x",
                                                              "successors": [
                                                                {
                                                                  "id": 133924142903696,
                                                                  "label": "var dx = 1",
                                                                  "successors": [
                                                                    {
                                                                      "id": 133924142904128,
                                                                      "label": "var y0 = mRect.min.y",
                                                                      "successors": [
                                                                        {
                                                                          "id": 133924143055392,
                                                                          "label": "var y1 = mRect.max.y",
                                                                          "successors": [
                                                                            {
                                                                              "id": 133924143056352,
                                                                              "label": "var dy = 1",
                                                                              "successors": [
                                                                                {
                                                                                  "id": 133924143056880,
                                                                                  "label": "if (processBackward(mDst, mRect, src, sp) )",
                                                                                  "successors": [
                                                                                    {
                                                                                      "id": 133924143061056,
                                                                                      "label": "x0 = x1 - 1",
                                                                                      "successors": [
                                                                                        {
                                                                                          "id": 133924143061200,
                                                                                          "label": "x1 = x0 - 1",
                                                                                          "successors": [
                                                                                            {
                                                                                              "id": 133924143061296,
                                                                                              "label": "dx = -1",
                                                                                              "successors": [
                                                                                                {
                                                                                                  "id": 133924143061344,
                                                                                                  "label": "y0 = y1 - 1",
                                                                                                  "successors": [
                                                                                                    {
                                                                                                      "id": 133924143061392,
                                                                                                      "label": "y1 = y0 - 1",
                                                                                                      "successors": [
                                                                                                        {
                                                                                                          "id": 133924143061440,
                                                                                                          "label": "dy = -1",
                                                                                                          "successors": [
                                                                                                            {
                                                                                                              "id": 133924143058176,
                                                                                                              "label": "var out: color",
                                                                                                              "successors": [
                                                                                                                {
                                                                                                                  "id": 133924143058704,
                                                                                                                  "label": ".RGBA64C = color.RGBA64C()",
                                                                                                                  "successors": [
                                                                                                                    {
                                                                                                                      "id": 133924143058992,
                                                                                                                      "label": "var sy = sp.y + y0 - mRect.min.y",
                                                                                                                      "successors": [
                                                                                                                        {
                                                                                                                          "id": 133924143061008,
                                                                                                                          "label": "var my = mp.y + y0 - mRect.min.y",
                                                                                                                          "successors": [
                                                                                                                            {
                                                                                                                              "id": 133924143061488,
                                                                                                                              "label": "var y = y0",
                                                                                                                              "successors": [
                                                                                                                                {
                                                                                                                                  "id": 133924143061536,
                                                                                                                                  "label": "while (y != y1) {\n        var sx = sp.x + x0 - mRect.min.x\n        var mx = mp.x + x0 - mRect.min.x\n        var x = x0\n        while (x != x1) {\n            var ma = UInt32(m)\n            if (!(mask is NilImage)) {\n                let (_, _, _, a) = mask.at(mx, my).rgba()\n                ma = a\n            }\n            if (ma == 0) {\n                if (op != Over) {\n                    mDst.set(x, y, color.Transparent)\n                }\n            } else if (ma == m && op == Src) {\n                mDst.set(x, y, src.at(sx, sy))\n            } else {\n                let (sr, sg, sb, sa) = src.at(sx, sy).rgba()\n                if (op == Src) {\n                    let (dr, dg, db, da) = mDst.at(x, y).rgba()\n                    let a = m - (sa * ma / m)\n                    out.r = UInt16((dr * a + sr * ma) / m)\n                    out.g = UInt16((dg * a + sg * ma) / m)\n                    out.b = UInt16((db * a + sb * ma) / m)\n                    out.a = UInt16((da * a + sa * ma) / m)\n                } else {\n                    out.r = UInt16(sr * ma / m)\n                    out.g = UInt16(sg * ma / m)\n                    out.b = UInt16(sb * ma / m)\n                    out.a = UInt16(sa * ma / m)\n                }\n                mDst.set(x, y, out)\n            }\n            x += dx\n            sx += dx\n            mx += dx\n        }\n        y += dy\n        sy += dy\n        my += dy\n    }\n    (mDst, mRect)",
                                                                                                                                  "successors": [
                                                                                                                                    {
                                                                                                                                      "id": 133924157495552,
                                                                                                                                      "label": "return",
                                                                                                                                      "successors": []
                                                                                                                                    }
                                                                                                                                  ]
                                                                                                                                }
                                                                                                                              ]
                                                                                                                            }
                                                                                                                          ]
                                                                                                                        }
                                                                                                                      ]
                                                                                                                    }
                                                                                                                  ]
                                                                                                                }
                                                                                                              ]
                                                                                                            }
                                                                                                          ]
                                                                                                        }
                                                                                                      ]
                                                                                                    }
                                                                                                  ]
                                                                                                }
                                                                                              ]
                                                                                            }
                                                                                          ]
                                                                                        }
                                                                                      ]
                                                                                    },
                                                                                    {
                                                                                      "id": 133924143058176
                                                                                    }
                                                                                  ]
                                                                                }
                                                                              ]
                                                                            }
                                                                          ]
                                                                        }
                                                                      ]
                                                                    }
                                                                  ]
                                                                }
                                                              ]
                                                            }
                                                          ]
                                                        }
                                                      ]
                                                    }
                                                  ]
                                                },
                                                {
                                                  "id": 133924142903552
                                                }
                                              ]
                                            }
                                          ]
                                        },
                                        {
                                          "id": 133924142903552
                                        }
                                      ]
                                    }
                                  ]
                                }
                              ]
                            }
                          ]
                        }
                      ]
                    }
                  ]
                }
              ]
            }
          ],
          "functions": [],
          "classes": []
        },
        {
          "name": "drawCopySrc",
          "type": "Function",
          "blocks": [
            {
              "id": 133924157496368,
              "label": "",
              "successors": [
                {
                  "id": 133924143061680,
                  "label": "let n = 4 * r.dx()",
                  "successors": [
                    {
                      "id": 133924143061728,
                      "label": "var dy = r.dy()",
                      "successors": [
                        {
                          "id": 133924143061776,
                          "label": "var d0 = dst.pixOffset(r.min.x, r.min.y)",
                          "successors": [
                            {
                              "id": 133924143061824,
                              "label": "var s0 = src.pixOffset(sp.x, sp.y)",
                              "successors": [
                                {
                                  "id": 133924143061872,
                                  "label": "var ddelta = 0",
                                  "successors": [
                                    {
                                      "id": 133924143061920,
                                      "label": "var sdelta = 0",
                                      "successors": [
                                        {
                                          "id": 133924143061968,
                                          "label": "if (r.min.y <= sp.y )",
                                          "successors": [
                                            {
                                              "id": 133924143062352,
                                              "label": "ddelta = dst.stride",
                                              "successors": [
                                                {
                                                  "id": 133924143062400,
                                                  "label": "sdelta = src.stride",
                                                  "successors": [
                                                    {
                                                      "id": 133924143062064,
                                                      "label": "while (dy > 0) {\n        for (i in 0..n) {\n            dst.pix[d0 + i] = src.pix[s0 + i]\n        }\n        d0 += ddelta\n        s0 += sdelta\n        dy--\n    }\n    (dst, r)",
                                                      "successors": [
                                                        {
                                                          "id": 133924157496416,
                                                          "label": "return",
                                                          "successors": []
                                                        }
                                                      ]
                                                    }
                                                  ]
                                                }
                                              ]
                                            },
                                            {
                                              "id": 133924143062544,
                                              "label": "d0 += (dy - 1) * dst.stride",
                                              "successors": [
                                                {
                                                  "id": 133924143062592,
                                                  "label": "s0 += (dy - 1) * src.stride",
                                                  "successors": [
                                                    {
                                                      "id": 133924143062640,
                                                      "label": "ddelta = -dst.stride",
                                                      "successors": [
                                                        {
                                                          "id": 133924143062688,
                                                          "label": "sdelta = -src.stride",
                                                          "successors": [
                                                            {
                                                              "id": 133924143062064
                                                            }
                                                          ]
                                                        }
                                                      ]
                                                    }
                                                  ]
                                                }
                                              ]
                                            }
                                          ]
                                        }
                                      ]
                                    }
                                  ]
                                }
                              ]
                            }
                          ]
                        }
                      ]
                    }
                  ]
                }
              ]
            }
          ],
          "functions": [],
          "classes": []
        },
        {
          "name": "drawGray",
          "type": "Function",
          "blocks": [
            {
              "id": 133924157497232,
              "label": "",
              "successors": [
                {
                  "id": 133924143062496,
                  "label": "let i0 = (r.min.x - dst.rect.min.x) * 4",
                  "successors": [
                    {
                      "id": 133924143062736,
                      "label": "let i1 = (r.max.x - dst.rect.min.x) * 4",
                      "successors": [
                        {
                          "id": 133924143062784,
                          "label": "let si0 = (sp.x - src.rect.min.x) * 1",
                          "successors": [
                            {
                              "id": 133924143062832,
                              "label": "let yMax = r.max.y - dst.rect.min.y",
                              "successors": [
                                {
                                  "id": 133924143062880,
                                  "label": "var y = r.min.y - dst.rect.min.y",
                                  "successors": [
                                    {
                                      "id": 133924143062928,
                                      "label": "var sy = sp.y - src.rect.min.y",
                                      "successors": [
                                        {
                                          "id": 133924143062976,
                                          "label": "let dpix = dst.pix",
                                          "successors": [
                                            {
                                              "id": 133924143063024,
                                              "label": "let spix = src.pix",
                                              "successors": [
                                                {
                                                  "id": 133924143063072,
                                                  "label": "while (y != yMax) {\n        let dpis = y * dst.stride\n        let spis = sy * src.stride\n        var i = i0\n        var si = si0\n        while (i < i1) {\n            let p = spix[spis + i + si]\n            dpix[dpis + i + 0] = p\n            dpix[dpis + i + 1] = p\n            dpix[dpis + i + 2] = p\n            dpix[dpis + i + 3] = 255\n            i += 4\n            si += 4\n        }\n        y++\n        sy++\n    }\n    (dst, r)",
                                                  "successors": [
                                                    {
                                                      "id": 133924157497280,
                                                      "label": "return",
                                                      "successors": []
                                                    }
                                                  ]
                                                }
                                              ]
                                            }
                                          ]
                                        }
                                      ]
                                    }
                                  ]
                                }
                              ]
                            }
                          ]
                        }
                      ]
                    }
                  ]
                }
              ]
            }
          ],
          "functions": [],
          "classes": []
        },
        {
          "name": "drawCMYK",
          "type": "Function",
          "blocks": [
            {
              "id": 133924157498096,
              "label": "",
              "successors": [
                {
                  "id": 133924143063216,
                  "label": "let i0 = (r.min.x - dst.rect.min.x) * 4",
                  "successors": [
                    {
                      "id": 133924143063264,
                      "label": "let i1 = (r.max.x - dst.rect.min.x) * 4",
                      "successors": [
                        {
                          "id": 133924143063312,
                          "label": "let si0 = (sp.x - src.rect.min.x) * 4",
                          "successors": [
                            {
                              "id": 133924143063360,
                              "label": "let yMax = r.max.y - dst.rect.min.y",
                              "successors": [
                                {
                                  "id": 133924143063408,
                                  "label": "var y = r.min.y - dst.rect.min.y",
                                  "successors": [
                                    {
                                      "id": 133924143063456,
                                      "label": "var sy = sp.y - src.rect.min.y",
                                      "successors": [
                                        {
                                          "id": 133924143063504,
                                          "label": "let dpix = dst.pix",
                                          "successors": [
                                            {
                                              "id": 133924143063552,
                                              "label": "let spix = src.pix",
                                              "successors": [
                                                {
                                                  "id": 133924143063600,
                                                  "label": "while (y != yMax) {\n        let dpis = y * dst.stride\n        let spis = sy * src.stride\n        var i = i0\n        var si = si0\n        while (i < i1) {\n            let (sr, sg, sb) = color.CMYKToRGB(\n                spix[spis + i + 0],\n                spix[spis + i + 1],\n                spix[spis + i + 2],\n                spix[spis + i + 3]\n            )\n            dpix[dpis + i + 0] = sr\n            dpix[dpis + i + 1] = sg\n            dpix[dpis + i + 2] = sb\n            dpix[dpis + i + 3] = 255\n            i += 4\n            si += 4\n        }\n        y++\n        sy++\n    }\n    (dst, r)",
                                                  "successors": [
                                                    {
                                                      "id": 133924157498144,
                                                      "label": "return",
                                                      "successors": []
                                                    }
                                                  ]
                                                }
                                              ]
                                            }
                                          ]
                                        }
                                      ]
                                    }
                                  ]
                                }
                              ]
                            }
                          ]
                        }
                      ]
                    }
                  ]
                }
              ]
            }
          ],
          "functions": [],
          "classes": []
        },
        {
          "name": "clamp",
          "type": "Function",
          "blocks": [
            {
              "id": 133924157498816,
              "label": "",
              "successors": [
                {
                  "id": 133924143063744,
                  "label": "if (i < 0 )",
                  "successors": [
                    {
                      "id": 133924143064128,
                      "label": "0",
                      "successors": [
                        {
                          "id": 133924157498864,
                          "label": "return",
                          "successors": []
                        }
                      ]
                    },
                    {
                      "id": 133924143064272,
                      "label": "if (i > 0xffff )",
                      "successors": [
                        {
                          "id": 133924143064656,
                          "label": "0xffff",
                          "successors": [
                            {
                              "id": 133924157498864
                            }
                          ]
                        },
                        {
                          "id": 133924143064800,
                          "label": "i",
                          "successors": [
                            {
                              "id": 133924157498864
                            }
                          ]
                        }
                      ]
                    }
                  ]
                }
              ]
            }
          ],
          "functions": [],
          "classes": []
        },
        {
          "name": "drawPaletted",
          "type": "Function",
          "blocks": [
            {
              "id": 133924157499776,
              "label": "",
              "successors": [
                {
                  "id": 133924143064224,
                  "label": "var palette: ?Array<Array<Int32>> = None",
                  "successors": [
                    {
                      "id": 133924143064368,
                      "label": "var pixS = 0",
                      "successors": [
                        {
                          "id": 133924143064416,
                          "label": "var stride = 0",
                          "successors": [
                            {
                              "id": 133924143064464,
                              "label": "if (dst is image.Paletted )",
                              "successors": [
                                {
                                  "id": 133924143065136,
                                  "label": "let p = (dst as image.Paletted).getOrThrow()",
                                  "successors": [
                                    {
                                      "id": 133924143065184,
                                      "label": "let mPalette = Array<Array<Int32>>(p.palette.size(), {_ => Array<Int32>(4, item: 0)})",
                                      "successors": [
                                        {
                                          "id": 133924143065232,
                                          "label": "let buf = p.palette.buf",
                                          "successors": [
                                            {
                                              "id": 133924143065280,
                                              "label": "for (i in 0..buf.size )",
                                              "successors": [
                                                {
                                                  "id": 133924143065616,
                                                  "label": "let (rr, g, b, a) = buf[i].rgba()",
                                                  "successors": [
                                                    {
                                                      "id": 133924143065664,
                                                      "label": "mPalette[i][0] = Int32(rr)",
                                                      "successors": [
                                                        {
                                                          "id": 133924143065712,
                                                          "label": "mPalette[i][1] = Int32(g)",
                                                          "successors": [
                                                            {
                                                              "id": 133924143065760,
                                                              "label": "mPalette[i][2] = Int32(b)",
                                                              "successors": [
                                                                {
                                                                  "id": 133924143065808,
                                                                  "label": "mPalette[i][3] = Int32(a)",
                                                                  "successors": [
                                                                    {
                                                                      "id": 133924143065280
                                                                    }
                                                                  ]
                                                                }
                                                              ]
                                                            }
                                                          ]
                                                        }
                                                      ]
                                                    }
                                                  ]
                                                },
                                                {
                                                  "id": 133924143065376,
                                                  "label": "palette = mPalette",
                                                  "successors": [
                                                    {
                                                      "id": 133924143065424,
                                                      "label": "pixS = p.pixOffset(r.min.x, r.min.y)",
                                                      "successors": [
                                                        {
                                                          "id": 133924143065568,
                                                          "label": "stride = p.stride",
                                                          "successors": [
                                                            {
                                                              "id": 133924143064848,
                                                              "label": "var quantErrorCurr: Array<Array<Int32>>",
                                                              "successors": [
                                                                {
                                                                  "id": 133924143064896,
                                                                  "label": "var quantErrorNext: Array<Array<Int32>>",
                                                                  "successors": [
                                                                    {
                                                                      "id": 133924143064944,
                                                                      "label": "if (floydSteinberg )",
                                                                      "successors": [
                                                                        {
                                                                          "id": 133924143066288,
                                                                          "label": "quantErrorCurr = Array<Array<Int32>>(r.dx() + 2, {_ => Array<Int32>(4, item: 0)})",
                                                                          "successors": [
                                                                            {
                                                                              "id": 133924143066336,
                                                                              "label": "quantErrorNext = Array<Array<Int32>>(r.dx() + 2, {_ => Array<Int32>(4, item: 0)})",
                                                                              "successors": [
                                                                                {
                                                                                  "id": 133924143066048,
                                                                                  "label": "var pxRGBA: (Int64, Int64) -> (UInt32, UInt32, UInt32, UInt32) = {x, y => src.at(x, y).rgba()}",
                                                                                  "successors": [
                                                                                    {
                                                                                      "id": 133924143066096,
                                                                                      "label": "if (src is image.RGBA )",
                                                                                      "successors": [
                                                                                        {
                                                                                          "id": 133924143066864,
                                                                                          "label": "let src0 = (src as image.RGBA).getOrThrow()",
                                                                                          "successors": [
                                                                                            {
                                                                                              "id": 133924143066912,
                                                                                              "label": "pxRGBA = {x, y => src0.rgbaAt(x, y).rgba()}",
                                                                                              "successors": [
                                                                                                {
                                                                                                  "id": 133924143066576,
                                                                                                  "label": "var y = 0",
                                                                                                  "successors": [
                                                                                                    {
                                                                                                      "id": 133924143066624,
                                                                                                      "label": "let pixd = (dst as image.Paletted).getOrThrow().pix",
                                                                                                      "successors": [
                                                                                                        {
                                                                                                          "id": 133924143066672,
                                                                                                          "label": "while (y != r.dy()) {\n        var x = 0\n        while (x != r.dx()) {\n            var (sr, sg, sb, sa) = pxRGBA(sp.x + x, sp.y + y)\n            var (er, eg, eb, ea) = (Int32(sr), Int32(sg), Int32(sb), Int32(sa))\n            if (floydSteinberg) {\n                er = clamp(er + quantErrorCurr[x + 1][0] / 16)\n                eg = clamp(eg + quantErrorCurr[x + 1][1] / 16)\n                eb = clamp(eb + quantErrorCurr[x + 1][2] / 16)\n                ea = clamp(ea + quantErrorCurr[x + 1][3] / 16)\n            }\n            if (let Some(mPalette) <- palette) {\n                var bestIndex = 0\n                var bestSum = UInt32((1 << 32) - 1)\n                for (index in 0..mPalette.size) {\n                    let p = mPalette[index]\n                    let sum = sqDiff(er, p[0]) + sqDiff(eg, p[1]) + sqDiff(eb, p[2]) + sqDiff(ea, p[3])\n                    if (sum < bestSum) {\n                        bestIndex = index\n                        bestSum = sum\n                        if (sum == 0) {\n                            break\n                        }\n                    }\n                }\n                pixd[y * stride + x + pixS] = UInt8(bestIndex)\n                if (!floydSteinberg) {\n                    x++\n                    continue\n                }\n                er -= mPalette[bestIndex][0]\n                eg -= mPalette[bestIndex][1]\n                eb -= mPalette[bestIndex][2]\n                ea -= mPalette[bestIndex][3]\n            }\n            quantErrorNext[x + 0][0] += er * 3\n            quantErrorNext[x + 0][1] += eg * 3\n            quantErrorNext[x + 0][2] += eb * 3\n            quantErrorNext[x + 0][3] += ea * 3\n            quantErrorNext[x + 1][0] += er * 5\n            quantErrorNext[x + 1][1] += eg * 5\n            quantErrorNext[x + 1][2] += eb * 5\n            quantErrorNext[x + 1][3] += ea * 5\n            quantErrorNext[x + 2][0] += er * 1\n            quantErrorNext[x + 2][1] += eg * 1\n            quantErrorNext[x + 2][2] += eb * 1\n            quantErrorNext[x + 2][3] += ea * 1\n            quantErrorCurr[x + 2][0] += er * 7\n            quantErrorCurr[x + 2][1] += eg * 7\n            quantErrorCurr[x + 2][2] += eb * 7\n            quantErrorCurr[x + 2][3] += ea * 7\n            x++\n        }\n        if (floydSteinberg) {\n            let (qec, qen) = (quantErrorNext, quantErrorCurr)\n            quantErrorCurr = qen\n            quantErrorNext = qec\n            for (i in 0..quantErrorNext.size) {\n                quantErrorNext[i] = Array<Int32>(4, item: 0)\n            }\n        }\n        y++\n    }\n    (dst, r)",
                                                                                                          "successors": [
                                                                                                            {
                                                                                                              "id": 133924157499824,
                                                                                                              "label": "return",
                                                                                                              "successors": []
                                                                                                            }
                                                                                                          ]
                                                                                                        }
                                                                                                      ]
                                                                                                    }
                                                                                                  ]
                                                                                                }
                                                                                              ]
                                                                                            }
                                                                                          ]
                                                                                        },
                                                                                        {
                                                                                          "id": 133924143067056,
                                                                                          "label": "if (src is image.NRGBA )",
                                                                                          "successors": [
                                                                                            {
                                                                                              "id": 133924143067440,
                                                                                              "label": "let src0 = (src as image.NRGBA).getOrThrow()",
                                                                                              "successors": [
                                                                                                {
                                                                                                  "id": 133924143067488,
                                                                                                  "label": "pxRGBA = {x, y => src0.nrgbaAt(x, y).rgba()}",
                                                                                                  "successors": [
                                                                                                    {
                                                                                                      "id": 133924143066576
                                                                                                    }
                                                                                                  ]
                                                                                                }
                                                                                              ]
                                                                                            },
                                                                                            {
                                                                                              "id": 133924143067632,
                                                                                              "label": "if (src is image.YCbCr )",
                                                                                              "successors": [
                                                                                                {
                                                                                                  "id": 133924143068016,
                                                                                                  "label": "let src0 = (src as image.YCbCr).getOrThrow()",
                                                                                                  "successors": [
                                                                                                    {
                                                                                                      "id": 133924143068064,
                                                                                                      "label": "pxRGBA = {x, y => src0.ycbcrAt(x, y).rgba()}",
                                                                                                      "successors": [
                                                                                                        {
                                                                                                          "id": 133924143066576
                                                                                                        }
                                                                                                      ]
                                                                                                    }
                                                                                                  ]
                                                                                                },
                                                                                                {
                                                                                                  "id": 133924143066576
                                                                                                }
                                                                                              ]
                                                                                            }
                                                                                          ]
                                                                                        }
                                                                                      ]
                                                                                    }
                                                                                  ]
                                                                                }
                                                                              ]
                                                                            }
                                                                          ]
                                                                        },
                                                                        {
                                                                          "id": 133924143066480,
                                                                          "label": "quantErrorCurr = Array<Array<Int32>>(0, {_ => Array<Int32>(4, item: 0)})",
                                                                          "successors": [
                                                                            {
                                                                              "id": 133924143066528,
                                                                              "label": "quantErrorNext = Array<Array<Int32>>(0, {_ => Array<Int32>(4, item: 0)})",
                                                                              "successors": [
                                                                                {
                                                                                  "id": 133924143066048
                                                                                }
                                                                              ]
                                                                            }
                                                                          ]
                                                                        }
                                                                      ]
                                                                    }
                                                                  ]
                                                                }
                                                              ]
                                                            }
                                                          ]
                                                        }
                                                      ]
                                                    }
                                                  ]
                                                }
                                              ]
                                            }
                                          ]
                                        }
                                      ]
                                    }
                                  ]
                                },
                                {
                                  "id": 133924143065952,
                                  "label": "throw Exception(\"dst is not image.Paletted type\")",
                                  "successors": [
                                    {
                                      "id": 133924143064848
                                    }
                                  ]
                                }
                              ]
                            }
                          ]
                        }
                      ]
                    }
                  ]
                }
              ]
            }
          ],
          "functions": [],
          "classes": []
        }
      ],
      "classes": []
    },
    {
      "name": "Quantizer",
      "type": "Class",
      "blocks": [],
      "functions": [
        {
          "name": "quantize",
          "type": "Function",
          "blocks": [
            {
              "id": 133924157308352,
              "label": "",
              "successors": [
                {
                  "id": 133924142900720,
                  "label": "return;",
                  "successors": [
                    {
                      "id": 133924157308400,
                      "label": "return",
                      "successors": []
                    }
                  ]
                }
              ]
            }
          ],
          "functions": [],
          "classes": []
        }
      ],
      "classes": []
    },
    {
      "name": "Op",
      "type": "Class",
      "blocks": [],
      "functions": [],
      "classes": []
    },
    {
      "name": "Drawer",
      "type": "Class",
      "blocks": [],
      "functions": [
        {
          "name": "drawer",
          "type": "Function",
          "blocks": [
            {
              "id": 133924157490272,
              "label": "",
              "successors": [
                {
                  "id": 133924143067152,
                  "label": "return;",
                  "successors": [
                    {
                      "id": 133924157490320,
                      "label": "return",
                      "successors": []
                    }
                  ]
                }
              ]
            }
          ],
          "functions": [],
          "classes": []
        }
      ],
      "classes": []
    },
    {
      "name": "FloydSteinbergClazz",
      "type": "Class",
      "blocks": [],
      "functions": [
        {
          "name": "drawer",
          "type": "Function",
          "blocks": [
            {
              "id": 133924157491712,
              "label": "",
              "successors": [
                {
                  "id": 133924143068160,
                  "label": "var (dst0, rect0) = clip(dst, r, src, sp, nilImage, nilPoint)",
                  "successors": [
                    {
                      "id": 133924143068208,
                      "label": "if (rect0.empty() )",
                      "successors": [
                        {
                          "id": 133924143068592,
                          "label": "return (dst0, rect0)",
                          "successors": []
                        },
                        {
                          "id": 133924143068400,
                          "label": "var mDst: ImageI = dst0",
                          "successors": [
                            {
                              "id": 133924143068640,
                              "label": "var mRect: Rectangle = rect0",
                              "successors": [
                                {
                                  "id": 133924143068688,
                                  "label": "return drawPaletted(mDst, mRect, src, sp, true)",
                                  "successors": []
                                }
                              ]
                            }
                          ]
                        }
                      ]
                    }
                  ]
                }
              ]
            }
          ],
          "functions": [],
          "classes": []
        }
      ],
      "classes": []
    }
  ]
}
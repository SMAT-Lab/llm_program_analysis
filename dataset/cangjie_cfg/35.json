{
  "name": "35.cj",
  "type": "File",
  "blocks": [],
  "functions": [],
  "classes": [
    {
      "name": "_DEFAULT_CANG_CLASS",
      "type": "Class",
      "blocks": [],
      "functions": [],
      "classes": []
    },
    {
      "name": "MySqlStatement",
      "type": "Class",
      "blocks": [],
      "functions": [
        {
          "name": "constructor",
          "type": "Function",
          "blocks": [
            {
              "id": 133924162958624,
              "label": "",
              "successors": [
                {
                  "id": 133924145807904,
                  "label": "this.connection = connection",
                  "successors": [
                    {
                      "id": 133924145808336,
                      "label": "this.sql = sql",
                      "successors": [
                        {
                          "id": 133924145808432,
                          "label": "this.connection.writeCommandPacketStr(comStmtPrepare, sql)",
                          "successors": [
                            {
                              "id": 133924145808480,
                              "label": "readPrepareResultPacket()",
                              "successors": [
                                {
                                  "id": 133924162958816,
                                  "label": "return",
                                  "successors": []
                                }
                              ]
                            }
                          ]
                        }
                      ]
                    }
                  ]
                }
              ]
            }
          ],
          "functions": [],
          "classes": []
        },
        {
          "name": "query",
          "type": "Function",
          "blocks": [
            {
              "id": 133924162961120,
              "label": "",
              "successors": [
                {
                  "id": 133924145808624,
                  "label": "writeExecutePacket(params)",
                  "successors": [
                    {
                      "id": 133924145808672,
                      "label": "let columnNumber = readRequstSetHeaderPacket()",
                      "successors": [
                        {
                          "id": 133924145808768,
                          "label": "var columns: ArrayList<MySqlField> = ArrayList<MySqlField>()",
                          "successors": [
                            {
                              "id": 133924145808864,
                              "label": "var rows: ArrayList<Array<Byte>> = ArrayList<Array<Byte>>()",
                              "successors": [
                                {
                                  "id": 133924145808912,
                                  "label": "if (columnNumber > 0 )",
                                  "successors": [
                                    {
                                      "id": 133924145809344,
                                      "label": "columns = this.connection.readColumns(UInt16(columnNumber))",
                                      "successors": [
                                        {
                                          "id": 133924145809392,
                                          "label": "rows = this.connection.readRows()",
                                          "successors": [
                                            {
                                              "id": 133924145809056,
                                              "label": "return MysqlQueryResult(columns, rows)",
                                              "successors": []
                                            }
                                          ]
                                        }
                                      ]
                                    },
                                    {
                                      "id": 133924145809056
                                    }
                                  ]
                                }
                              ]
                            }
                          ]
                        }
                      ]
                    }
                  ]
                }
              ]
            }
          ],
          "functions": [],
          "classes": []
        },
        {
          "name": "setOption",
          "type": "Function",
          "blocks": [
            {
              "id": 133924162669056,
              "label": "",
              "successors": [
                {
                  "id": 133924145807472,
                  "label": "return;",
                  "successors": [
                    {
                      "id": 133924162669248,
                      "label": "return",
                      "successors": []
                    }
                  ]
                }
              ]
            }
          ],
          "functions": [],
          "classes": []
        },
        {
          "name": "update",
          "type": "Function",
          "blocks": [
            {
              "id": 133924162671552,
              "label": "",
              "successors": [
                {
                  "id": 133924145809632,
                  "label": "writeExecutePacket(params)",
                  "successors": [
                    {
                      "id": 133924145809680,
                      "label": "let updateResult = readRequstSetHeaderPacket()",
                      "successors": [
                        {
                          "id": 133924145809728,
                          "label": "return MySqlUpdateResult(rowCount, lastInsertId)",
                          "successors": []
                        }
                      ]
                    }
                  ]
                }
              ]
            }
          ],
          "functions": [],
          "classes": []
        },
        {
          "name": "close",
          "type": "Function",
          "blocks": [
            {
              "id": 133924162674048,
              "label": "",
              "successors": [
                {
                  "id": 133924145809440,
                  "label": "return;",
                  "successors": [
                    {
                      "id": 133924162674240,
                      "label": "return",
                      "successors": []
                    }
                  ]
                }
              ]
            }
          ],
          "functions": [],
          "classes": []
        },
        {
          "name": "isClosed",
          "type": "Function",
          "blocks": [
            {
              "id": 133924162676640,
              "label": "",
              "successors": [
                {
                  "id": 133924145809968,
                  "label": "return false",
                  "successors": []
                }
              ]
            }
          ],
          "functions": [],
          "classes": []
        },
        {
          "name": "readRequstSetHeaderPacket",
          "type": "Function",
          "blocks": [
            {
              "id": 133924162678944,
              "label": "",
              "successors": [
                {
                  "id": 133924145810160,
                  "label": "let data = connection.readPacket()",
                  "successors": [
                    {
                      "id": 133924145810208,
                      "label": "match (data[0] )",
                      "successors": [
                        {
                          "id": 133924145810688,
                          "label": "handleOkPacket(data[1..])",
                          "successors": [
                            {
                              "id": 133924145810736,
                              "label": "return 0",
                              "successors": []
                            }
                          ]
                        },
                        {
                          "id": 133924145811024,
                          "label": "println(\"err, do later\")",
                          "successors": [
                            {
                              "id": 133924145811072,
                              "label": "return -1",
                              "successors": []
                            }
                          ]
                        },
                        {
                          "id": 133924145811360,
                          "label": "1 + 1",
                          "successors": [
                            {
                              "id": 133924145810352,
                              "label": "let (number, isNull, n) = ByteArrayUtils.readLengthEncodedInteger(data)",
                              "successors": [
                                {
                                  "id": 133924145811408,
                                  "label": "return Int64(number)",
                                  "successors": []
                                }
                              ]
                            }
                          ]
                        }
                      ]
                    }
                  ]
                }
              ]
            }
          ],
          "functions": [],
          "classes": []
        },
        {
          "name": "handleOkPacket",
          "type": "Function",
          "blocks": [
            {
              "id": 133924162681632,
              "label": "",
              "successors": [
                {
                  "id": 133924145811504,
                  "label": "let (affectedRows, affectedRowsIsNull, n) = ByteArrayUtils.readLengthEncodedInteger(data[0..])",
                  "successors": [
                    {
                      "id": 133924145811552,
                      "label": "let (insertId, insertIdIsNull, m )= ByteArrayUtils.readLengthEncodedInteger(data[n..])",
                      "successors": [
                        {
                          "id": 133924145811600,
                          "label": "rowCount = Int64(affectedRows)",
                          "successors": [
                            {
                              "id": 133924145811648,
                              "label": "lastInsertId = Int64(insertId)",
                              "successors": [
                                {
                                  "id": 133924162681824,
                                  "label": "return",
                                  "successors": []
                                }
                              ]
                            }
                          ]
                        }
                      ]
                    }
                  ]
                }
              ]
            }
          ],
          "functions": [],
          "classes": []
        },
        {
          "name": "readPrepareResultPacket",
          "type": "Function",
          "blocks": [
            {
              "id": 133924163061408,
              "label": "",
              "successors": [
                {
                  "id": 133924145811744,
                  "label": "let data = this.connection.readPacket()",
                  "successors": [
                    {
                      "id": 133924145811792,
                      "label": "if (data[0] != iOK )",
                      "successors": [
                        {
                          "id": 133924145812128,
                          "label": "println(\"error here, do later\")",
                          "successors": [
                            {
                              "id": 133924145811888,
                              "label": "id = ByteArrayUtils.littleEndianUint32(data[1..5])",
                              "successors": [
                                {
                                  "id": 133924145811936,
                                  "label": "columnCount = ByteArrayUtils.littleEndianUint16(data[5..7])",
                                  "successors": [
                                    {
                                      "id": 133924145812080,
                                      "label": "paramCount = ByteArrayUtils.littleEndianUint16(data[7..9])",
                                      "successors": [
                                        {
                                          "id": 133924145812176,
                                          "label": "if (paramCount > 0 )",
                                          "successors": [
                                            {
                                              "id": 133924145812512,
                                              "label": "let params:ArrayList<MySqlField> = this.connection.readColumns(paramCount)",
                                              "successors": [
                                                {
                                                  "id": 133924145812272,
                                                  "label": "if (columnCount > 0 )",
                                                  "successors": [
                                                    {
                                                      "id": 133924145812752,
                                                      "label": "let columns = this.connection.readColumns(columnCount)",
                                                      "successors": [
                                                        {
                                                          "id": 133924163061600,
                                                          "label": "return",
                                                          "successors": []
                                                        }
                                                      ]
                                                    },
                                                    {
                                                      "id": 133924163061600
                                                    }
                                                  ]
                                                }
                                              ]
                                            },
                                            {
                                              "id": 133924145812272
                                            }
                                          ]
                                        }
                                      ]
                                    }
                                  ]
                                }
                              ]
                            }
                          ]
                        },
                        {
                          "id": 133924145811888
                        }
                      ]
                    }
                  ]
                }
              ]
            }
          ],
          "functions": [],
          "classes": []
        },
        {
          "name": "writeExecutePacket",
          "type": "Function",
          "blocks": [
            {
              "id": 133924163065056,
              "label": "",
              "successors": [
                {
                  "id": 133924145812704,
                  "label": "connection.sequence = 0",
                  "successors": [
                    {
                      "id": 133924145812800,
                      "label": "var pktLen = 1 + 4 + 1 + 4 + ((Int64(paramCount) + 7) / 8) + 1 + (Int64(paramCount) * 2)",
                      "successors": [
                        {
                          "id": 133924145812848,
                          "label": "let paramValues = ArrayList<Array<Byte>>()",
                          "successors": [
                            {
                              "id": 133924145812896,
                              "label": "let paramTypes = Array<Byte>(Int64(paramCount) * 2, item: 0)",
                              "successors": [
                                {
                                  "id": 133924145812944,
                                  "label": "var bitMask = UInt64(0)",
                                  "successors": [
                                    {
                                      "id": 133924145812992,
                                      "label": "for (i in 0 .. params.size )",
                                      "successors": [
                                        {
                                          "id": 133924145813280,
                                          "label": "let param = params.get(i).getOrThrow()",
                                          "successors": [
                                            {
                                              "id": 133924145813328,
                                              "label": "match (param.name )",
                                              "successors": [
                                                {
                                                  "id": 133924145813760,
                                                  "label": "let temp = param as SqlNullableBigInt",
                                                  "successors": [
                                                    {
                                                      "id": 133924145813808,
                                                      "label": "let value = temp.getOrThrow()",
                                                      "successors": [
                                                        {
                                                          "id": 133924145813856,
                                                          "label": "match (value.value )",
                                                          "successors": [
                                                            {
                                                              "id": 133924145814336,
                                                              "label": "paramTypes[i<<1] = fieldTypeLongLong",
                                                              "successors": [
                                                                {
                                                                  "id": 133924145814384,
                                                                  "label": "let appenValue = ByteArrayUtils.uint64ToBytes(UInt64(number))",
                                                                  "successors": [
                                                                    {
                                                                      "id": 133924145814432,
                                                                      "label": "paramValues.append(appenValue)",
                                                                      "successors": [
                                                                        {
                                                                          "id": 133924145814480,
                                                                          "label": "pktLen += 8",
                                                                          "successors": [
                                                                            {
                                                                              "id": 133924145812992
                                                                            }
                                                                          ]
                                                                        }
                                                                      ]
                                                                    }
                                                                  ]
                                                                }
                                                              ]
                                                            },
                                                            {
                                                              "id": 133924145814768,
                                                              "label": "bitMask += 1 << UInt64(i)",
                                                              "successors": [
                                                                {
                                                                  "id": 133924145814816,
                                                                  "label": "paramTypes[i<<1] = fieldTypeNULL",
                                                                  "successors": [
                                                                    {
                                                                      "id": 133924145812992
                                                                    }
                                                                  ]
                                                                }
                                                              ]
                                                            }
                                                          ]
                                                        }
                                                      ]
                                                    }
                                                  ]
                                                },
                                                {
                                                  "id": 133924145815008,
                                                  "label": "let temp = param as SqlBigInt",
                                                  "successors": [
                                                    {
                                                      "id": 133924145815056,
                                                      "label": "let number = temp.getOrThrow().value",
                                                      "successors": [
                                                        {
                                                          "id": 133924145815104,
                                                          "label": "paramTypes[i<<1] = fieldTypeLongLong",
                                                          "successors": [
                                                            {
                                                              "id": 133924145815152,
                                                              "label": "let appenValue = ByteArrayUtils.uint64ToBytes(UInt64(number))",
                                                              "successors": [
                                                                {
                                                                  "id": 133924145815200,
                                                                  "label": "paramValues.append(appenValue)",
                                                                  "successors": [
                                                                    {
                                                                      "id": 133924145815248,
                                                                      "label": "pktLen += 8",
                                                                      "successors": [
                                                                        {
                                                                          "id": 133924145812992
                                                                        }
                                                                      ]
                                                                    }
                                                                  ]
                                                                }
                                                              ]
                                                            }
                                                          ]
                                                        }
                                                      ]
                                                    }
                                                  ]
                                                },
                                                {
                                                  "id": 133924145815536,
                                                  "label": "let temp = param as SqlInteger",
                                                  "successors": [
                                                    {
                                                      "id": 133924145815584,
                                                      "label": "let number = temp.getOrThrow().value",
                                                      "successors": [
                                                        {
                                                          "id": 133924145815632,
                                                          "label": "paramTypes[i<<1] = fieldTypeLong",
                                                          "successors": [
                                                            {
                                                              "id": 133924145815680,
                                                              "label": "let appenValue = ByteArrayUtils.uint32ToBytes(UInt32(number))",
                                                              "successors": [
                                                                {
                                                                  "id": 133924145815728,
                                                                  "label": "paramValues.append(appenValue)",
                                                                  "successors": [
                                                                    {
                                                                      "id": 133924145815776,
                                                                      "label": "pktLen += 4",
                                                                      "successors": [
                                                                        {
                                                                          "id": 133924145812992
                                                                        }
                                                                      ]
                                                                    }
                                                                  ]
                                                                }
                                                              ]
                                                            }
                                                          ]
                                                        }
                                                      ]
                                                    }
                                                  ]
                                                },
                                                {
                                                  "id": 133924145816064,
                                                  "label": "let temp = param as SqlVarchar",
                                                  "successors": [
                                                    {
                                                      "id": 133924145816112,
                                                      "label": "let s = temp.getOrThrow().value",
                                                      "successors": [
                                                        {
                                                          "id": 133924145816160,
                                                          "label": "paramTypes[i<<1] = fieldTypeVarString",
                                                          "successors": [
                                                            {
                                                              "id": 133924145816208,
                                                              "label": "let result = ArrayList<Byte>()",
                                                              "successors": [
                                                                {
                                                                  "id": 133924145816256,
                                                                  "label": "var lengthBytes = ByteArrayUtils.appendLengthEncodedInteger(UInt64(s.toArray().size))",
                                                                  "successors": [
                                                                    {
                                                                      "id": 133924145816304,
                                                                      "label": "result.appendAll(lengthBytes)",
                                                                      "successors": [
                                                                        {
                                                                          "id": 133924145816352,
                                                                          "label": "result.appendAll(s.toArray())",
                                                                          "successors": [
                                                                            {
                                                                              "id": 133924145816400,
                                                                              "label": "paramValues.append(result.toArray())",
                                                                              "successors": [
                                                                                {
                                                                                  "id": 133924145816448,
                                                                                  "label": "pktLen = pktLen + result.toArray().size",
                                                                                  "successors": [
                                                                                    {
                                                                                      "id": 133924145812992
                                                                                    }
                                                                                  ]
                                                                                }
                                                                              ]
                                                                            }
                                                                          ]
                                                                        }
                                                                      ]
                                                                    }
                                                                  ]
                                                                }
                                                              ]
                                                            }
                                                          ]
                                                        }
                                                      ]
                                                    }
                                                  ]
                                                },
                                                {
                                                  "id": 133924145816736,
                                                  "label": "println(\"unsupport data type\")",
                                                  "successors": [
                                                    {
                                                      "id": 133924145812992
                                                    }
                                                  ]
                                                }
                                              ]
                                            }
                                          ]
                                        },
                                        {
                                          "id": 133924145813088,
                                          "label": "let data = Array<Byte>(pktLen + 4, item: UInt8(0))",
                                          "successors": [
                                            {
                                              "id": 133924145816496,
                                              "label": "data[0] = UInt8(pktLen & 0xff)",
                                              "successors": [
                                                {
                                                  "id": 133924145813232,
                                                  "label": "data[1] = UInt8(pktLen >> 8)",
                                                  "successors": [
                                                    {
                                                      "id": 133924145813424,
                                                      "label": "data[2] = UInt8(pktLen >> 16)",
                                                      "successors": [
                                                        {
                                                          "id": 133924145816784,
                                                          "label": "data[3] = connection.sequence",
                                                          "successors": [
                                                            {
                                                              "id": 133924145816832,
                                                              "label": "data[4] = comStmtExecute",
                                                              "successors": [
                                                                {
                                                                  "id": 133924145816880,
                                                                  "label": "data[5] = UInt8(id)",
                                                                  "successors": [
                                                                    {
                                                                      "id": 133924145816928,
                                                                      "label": "data[6] = UInt8(id>>8)",
                                                                      "successors": [
                                                                        {
                                                                          "id": 133924145816976,
                                                                          "label": "data[7] = UInt8(id>>16)",
                                                                          "successors": [
                                                                            {
                                                                              "id": 133924145817024,
                                                                              "label": "data[8] = UInt8(id>>24)",
                                                                              "successors": [
                                                                                {
                                                                                  "id": 133924145817072,
                                                                                  "label": "data[10] = 0x01",
                                                                                  "successors": [
                                                                                    {
                                                                                      "id": 133924145817120,
                                                                                      "label": "if (paramCount > 0 )",
                                                                                      "successors": [
                                                                                        {
                                                                                          "id": 133924145817456,
                                                                                          "label": "var pos = 14 + ((Int64(paramCount) + 7) / 8)",
                                                                                          "successors": [
                                                                                            {
                                                                                              "id": 133924145817504,
                                                                                              "label": "for (i in 14 .. pos )",
                                                                                              "successors": [
                                                                                                {
                                                                                                  "id": 133924145817792,
                                                                                                  "label": "data[i] = UInt8(bitMask >> UInt64((i - 14)* 8))",
                                                                                                  "successors": [
                                                                                                    {
                                                                                                      "id": 133924145817504
                                                                                                    }
                                                                                                  ]
                                                                                                },
                                                                                                {
                                                                                                  "id": 133924145817600,
                                                                                                  "label": "data[pos] = 0x01",
                                                                                                  "successors": [
                                                                                                    {
                                                                                                      "id": 133924145817744,
                                                                                                      "label": "pos ++",
                                                                                                      "successors": [
                                                                                                        {
                                                                                                          "id": 133924145817840,
                                                                                                          "label": "paramTypes.copyTo(data, 0, pos, paramTypes.size)",
                                                                                                          "successors": [
                                                                                                            {
                                                                                                              "id": 133924145817888,
                                                                                                              "label": "pos += paramTypes.size",
                                                                                                              "successors": [
                                                                                                                {
                                                                                                                  "id": 133924145817936,
                                                                                                                  "label": "for (i in 0 .. paramCount )",
                                                                                                                  "successors": [
                                                                                                                    {
                                                                                                                      "id": 133924145818224,
                                                                                                                      "label": "let paramValue = paramValues[Int64(i)]",
                                                                                                                      "successors": [
                                                                                                                        {
                                                                                                                          "id": 133924145818272,
                                                                                                                          "label": "paramValue.toArray().copyTo(data, 0, pos, paramValue.toArray().size)",
                                                                                                                          "successors": [
                                                                                                                            {
                                                                                                                              "id": 133924145818320,
                                                                                                                              "label": "pos += paramValue.toArray().size",
                                                                                                                              "successors": [
                                                                                                                                {
                                                                                                                                  "id": 133924145817936
                                                                                                                                }
                                                                                                                              ]
                                                                                                                            }
                                                                                                                          ]
                                                                                                                        }
                                                                                                                      ]
                                                                                                                    },
                                                                                                                    {
                                                                                                                      "id": 133924145817216,
                                                                                                                      "label": "connection.writePacket(data)",
                                                                                                                      "successors": [
                                                                                                                        {
                                                                                                                          "id": 133924163065248,
                                                                                                                          "label": "return",
                                                                                                                          "successors": []
                                                                                                                        }
                                                                                                                      ]
                                                                                                                    }
                                                                                                                  ]
                                                                                                                }
                                                                                                              ]
                                                                                                            }
                                                                                                          ]
                                                                                                        }
                                                                                                      ]
                                                                                                    }
                                                                                                  ]
                                                                                                }
                                                                                              ]
                                                                                            }
                                                                                          ]
                                                                                        },
                                                                                        {
                                                                                          "id": 133924145817216
                                                                                        }
                                                                                      ]
                                                                                    }
                                                                                  ]
                                                                                }
                                                                              ]
                                                                            }
                                                                          ]
                                                                        }
                                                                      ]
                                                                    }
                                                                  ]
                                                                }
                                                              ]
                                                            }
                                                          ]
                                                        }
                                                      ]
                                                    }
                                                  ]
                                                }
                                              ]
                                            }
                                          ]
                                        }
                                      ]
                                    }
                                  ]
                                }
                              ]
                            }
                          ]
                        }
                      ]
                    }
                  ]
                }
              ]
            }
          ],
          "functions": [],
          "classes": []
        }
      ],
      "classes": []
    }
  ]
}
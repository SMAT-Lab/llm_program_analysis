{
  "name": "57.cj",
  "type": "File",
  "blocks": [],
  "functions": [],
  "classes": [
    {
      "name": "_DEFAULT_CANG_CLASS",
      "type": "Class",
      "blocks": [],
      "functions": [
        {
          "name": "parse",
          "type": "Function",
          "blocks": [
            {
              "id": 133924161740208,
              "label": "",
              "successors": [
                {
                  "id": 133924146608016,
                  "label": "let json = JsonValue.fromStr(text).asObject()",
                  "successors": [
                    {
                      "id": 133924146608064,
                      "label": "let choices = json.getFields()['choices'].asArray()",
                      "successors": [
                        {
                          "id": 133924146608112,
                          "label": "let message = choices[0].asObject().getFields()['message'].asObject()",
                          "successors": [
                            {
                              "id": 133924146608160,
                              "label": "let content = message.getFields()['content'].asString().getValue()",
                              "successors": [
                                {
                                  "id": 133924146608208,
                                  "label": "return content",
                                  "successors": []
                                }
                              ]
                            }
                          ]
                        }
                      ]
                    }
                  ]
                }
              ]
            }
          ],
          "functions": [],
          "classes": []
        },
        {
          "name": "unknown_method",
          "type": "Function",
          "blocks": [
            {
              "id": 133924161740832,
              "label": "",
              "successors": [
                {
                  "id": 133924146608304,
                  "label": "var config = TlsClientConfig()",
                  "successors": [
                    {
                      "id": 133924146608352,
                      "label": "config.verifyMode = TrustAll",
                      "successors": [
                        {
                          "id": 133924146608400,
                          "label": "let client = ClientBuilder()\n        .tlsConfig(config)\n        .readTimeout(Duration.Max) // AI 服务响应有时候比较慢，这里设置为无限等待\n        .build()",
                          "successors": [
                            {
                              "id": 133924146608448,
                              "label": "println(client.chat(\"你好呀，请做个自我介绍吧\"))",
                              "successors": [
                                {
                                  "id": 133924146608496,
                                  "label": "println(client.chat(\"周杰伦在 2000 到 2010 年之间出过哪些专辑\"))",
                                  "successors": [
                                    {
                                      "id": 133924146608544,
                                      "label": "println(client.chat(\"请背诵《卜算子·送鲍浩然之浙东》\"))",
                                      "successors": [
                                        {
                                          "id": 133924146608592,
                                          "label": "println(client.chat(\"在编程框架中，网络拦截器的作用是什么\"))",
                                          "successors": [
                                            {
                                              "id": 133924146608640,
                                              "label": "client.close()",
                                              "successors": [
                                                {
                                                  "id": 133924161740880,
                                                  "label": "return",
                                                  "successors": []
                                                }
                                              ]
                                            }
                                          ]
                                        }
                                      ]
                                    }
                                  ]
                                }
                              ]
                            }
                          ]
                        }
                      ]
                    }
                  ]
                }
              ]
            }
          ],
          "functions": [],
          "classes": []
        }
      ],
      "classes": []
    },
    {
      "name": "Client",
      "type": "Class",
      "blocks": [],
      "functions": [
        {
          "name": "chat",
          "type": "Function",
          "blocks": [
            {
              "id": 133924161739536,
              "label": "",
              "successors": [
                {
                  "id": 133924146608832,
                  "label": "let info = \"\"\"\n        {\n            \"model\": \"deepseek-chat\",\n            \"messages\": [\n                {\"role\": \"system\", \"content\": \"你是我的全能助手，你的名字叫仓颉\"},\n                {\"role\": \"user\", \"content\": \"${question}\"}\n            ],\n            \"stream\": false\n        }\n        \"\"\"",
                  "successors": [
                    {
                      "id": 133924146608880,
                      "label": "let request = HttpRequestBuilder()\n            .url('https://api.deepseek.com/chat/completions')\n            .header('Authorization', 'Bearer ${DEEPSEEK_API_KEY}')\n            .header('Content-Type', 'application/json')\n            .body(info)\n            .post()\n            .build()",
                      "successors": [
                        {
                          "id": 133924146608928,
                          "label": "let response = this.send(request)",
                          "successors": [
                            {
                              "id": 133924146608976,
                              "label": "let text = StringReader(response.body).readToEnd()",
                              "successors": [
                                {
                                  "id": 133924146609024,
                                  "label": "return parse(text) + '\\n---------------------------'",
                                  "successors": []
                                }
                              ]
                            }
                          ]
                        }
                      ]
                    }
                  ]
                }
              ]
            }
          ],
          "functions": [],
          "classes": []
        }
      ],
      "classes": []
    }
  ]
}
{
  "name": "277.cj",
  "type": "File",
  "blocks": [],
  "functions": [],
  "classes": [
    {
      "name": "_DEFAULT_CANG_CLASS",
      "type": "Class",
      "blocks": [],
      "functions": [],
      "classes": []
    },
    {
      "name": "Pool",
      "type": "Class",
      "blocks": [],
      "functions": [
        {
          "name": "constructor",
          "type": "Function",
          "blocks": [
            {
              "id": 133924168832368,
              "label": "",
              "successors": [
                {
                  "id": 133924152704400,
                  "label": "this(\n            initSize: initSize,\n            minSize: minSize,\n            maxSize: maxSize,\n            checkDuration: checkDuration,\n            creationRetries: creationRetries,\n            creator: creator.create,\n            checker: checker.check,\n            destroier: destroier.destroy\n        )",
                  "successors": [
                    {
                      "id": 133924168832416,
                      "label": "return",
                      "successors": []
                    }
                  ]
                }
              ]
            }
          ],
          "functions": [],
          "classes": []
        },
        {
          "name": "constructor",
          "type": "Function",
          "blocks": [
            {
              "id": 133924168833520,
              "label": "",
              "successors": [
                {
                  "id": 133924152704544,
                  "label": "this(\n            initSize: initSize,\n            minSize: minSize,\n            maxSize: maxSize,\n            checkDuration: checkDuration,\n            creationRetries: creationRetries,\n            creator: manager.create,\n            checker: manager.check,\n            destroier: manager.destroy\n        )",
                  "successors": [
                    {
                      "id": 133924168833568,
                      "label": "return",
                      "successors": []
                    }
                  ]
                }
              ]
            }
          ],
          "functions": [],
          "classes": []
        },
        {
          "name": "isClosed",
          "type": "Function",
          "blocks": [
            {
              "id": 133924168833808,
              "label": "",
              "successors": [
                {
                  "id": 133924152704688,
                  "label": "closed.load()",
                  "successors": [
                    {
                      "id": 133924168833856,
                      "label": "return",
                      "successors": []
                    }
                  ]
                }
              ]
            }
          ],
          "functions": [],
          "classes": []
        },
        {
          "name": "close",
          "type": "Function",
          "blocks": [
            {
              "id": 133924168834384,
              "label": "",
              "successors": [
                {
                  "id": 133924152704880,
                  "label": "checkTimer.cancel()",
                  "successors": [
                    {
                      "id": 133924152704928,
                      "label": "closed.store(true)",
                      "successors": [
                        {
                          "id": 133924152704976,
                          "label": "while (true )",
                          "successors": [
                            {
                              "id": 133924152869216,
                              "label": "match (queue.take(timeout: Duration.second) )",
                              "successors": [
                                {
                                  "id": 133924152869696,
                                  "label": "destroy(x)",
                                  "successors": [
                                    {
                                      "id": 133924152869744,
                                      "label": "currentSize.fetchSub(1)",
                                      "successors": [
                                        {
                                          "id": 133924152704976
                                        }
                                      ]
                                    }
                                  ]
                                },
                                {
                                  "id": 133924168834432,
                                  "label": "return",
                                  "successors": []
                                }
                              ]
                            },
                            {
                              "id": 133924168834432
                            }
                          ]
                        }
                      ]
                    }
                  ]
                }
              ]
            }
          ],
          "functions": [],
          "classes": []
        },
        {
          "name": "getObject",
          "type": "Function",
          "blocks": [
            {
              "id": 133924168835056,
              "label": "",
              "successors": [
                {
                  "id": 133924152869360,
                  "label": "if (isClosed() )",
                  "successors": [
                    {
                      "id": 133924152870368,
                      "label": "return None<T>",
                      "successors": []
                    },
                    {
                      "id": 133924152870128,
                      "label": "var remainder = timeout",
                      "successors": [
                        {
                          "id": 133924152870176,
                          "label": "let start = DateTime.now()",
                          "successors": [
                            {
                              "id": 133924152870320,
                              "label": "while ((timeout == Duration.Max || remainder > Duration.nanosecond) && !isClosed() )",
                              "successors": [
                                {
                                  "id": 133924152870752,
                                  "label": "let opt = queue.take(timeout: remainder)",
                                  "successors": [
                                    {
                                      "id": 133924152870800,
                                      "label": "if (let Some(o) < - opt )",
                                      "successors": [
                                        {
                                          "id": 133924152871184,
                                          "label": "if (check(o) )",
                                          "successors": [
                                            {
                                              "id": 133924152871568,
                                              "label": "return opt",
                                              "successors": []
                                            },
                                            {
                                              "id": 133924152871712,
                                              "label": "destroy(o)",
                                              "successors": [
                                                {
                                                  "id": 133924152870944,
                                                  "label": "let size = currentSize.load()",
                                                  "successors": [
                                                    {
                                                      "id": 133924152870992,
                                                      "label": "if (size < initSize )",
                                                      "successors": [
                                                        {
                                                          "id": 133924152871856,
                                                          "label": "creationEvent.put(initSize - size, timeout: Duration.nanosecond)",
                                                          "successors": [
                                                            {
                                                              "id": 133924152871280,
                                                              "label": "if (timeout != Duration.Max )",
                                                              "successors": [
                                                                {
                                                                  "id": 133924152872480,
                                                                  "label": "remainder = timeout - Duration.since(start)",
                                                                  "successors": [
                                                                    {
                                                                      "id": 133924152870320
                                                                    }
                                                                  ]
                                                                },
                                                                {
                                                                  "id": 133924152870320
                                                                }
                                                              ]
                                                            }
                                                          ]
                                                        },
                                                        {
                                                          "id": 133924152872000,
                                                          "label": "if (size < maxSize )",
                                                          "successors": [
                                                            {
                                                              "id": 133924152872384,
                                                              "label": "creationEvent.put(1, timeout: Duration.nanosecond)",
                                                              "successors": [
                                                                {
                                                                  "id": 133924152871280
                                                                }
                                                              ]
                                                            },
                                                            {
                                                              "id": 133924152871280
                                                            }
                                                          ]
                                                        }
                                                      ]
                                                    }
                                                  ]
                                                }
                                              ]
                                            }
                                          ]
                                        },
                                        {
                                          "id": 133924152870944
                                        }
                                      ]
                                    }
                                  ]
                                },
                                {
                                  "id": 133924152870512,
                                  "label": "None<T>",
                                  "successors": [
                                    {
                                      "id": 133924168835104,
                                      "label": "return",
                                      "successors": []
                                    }
                                  ]
                                }
                              ]
                            }
                          ]
                        }
                      ]
                    }
                  ]
                }
              ]
            }
          ],
          "functions": [],
          "classes": []
        },
        {
          "name": "returnObject",
          "type": "Function",
          "blocks": [
            {
              "id": 133924168835632,
              "label": "",
              "successors": [
                {
                  "id": 133924152870704,
                  "label": "checkThenDoOrDestroy(object)",
                  "successors": [
                    {
                      "id": 133924152871952,
                      "label": "{queue.offer(object)}",
                      "successors": [
                        {
                          "id": 133924168835680,
                          "label": "return",
                          "successors": []
                        }
                      ]
                    }
                  ]
                }
              ]
            }
          ],
          "functions": [],
          "classes": []
        },
        {
          "name": "call",
          "type": "Function",
          "blocks": [
            {
              "id": 133924168836352,
              "label": "",
              "successors": [
                {
                  "id": 133924152872528,
                  "label": "let o: T",
                  "successors": [
                    {
                      "id": 133924152872576,
                      "label": "try",
                      "successors": [
                        {
                          "id": 133924152872864,
                          "label": "if (let Some(x) < )",
                          "successors": [
                            {
                              "id": 133924152873248,
                              "label": "x",
                              "successors": [
                                {
                                  "id": 133924152872960,
                                  "label": "o = if (let Some(x) <- getObject(timeout: timeout)) {\n                x\n            } else if (let Some(exf) <- toThrowFn) {\n                throw exf()\n            } else {\n                return None<R>\n            }",
                                  "successors": [
                                    {
                                      "id": 133924152873008,
                                      "label": "return fn(o)",
                                      "successors": []
                                    }
                                  ]
                                }
                              ]
                            },
                            {
                              "id": 133924152873392,
                              "label": "if (let Some(exf) < - toThrowFn )",
                              "successors": [
                                {
                                  "id": 133924152873776,
                                  "label": "throw exf()",
                                  "successors": [
                                    {
                                      "id": 133924152872960
                                    }
                                  ]
                                },
                                {
                                  "id": 133924152873920,
                                  "label": "return None<R>",
                                  "successors": []
                                }
                              ]
                            }
                          ]
                        },
                        {
                          "id": 133924152873584,
                          "label": "returnObject(o)",
                          "successors": [
                            {
                              "id": 133924168836400,
                              "label": "return",
                              "successors": []
                            }
                          ]
                        }
                      ]
                    }
                  ]
                }
              ]
            }
          ],
          "functions": [],
          "classes": []
        },
        {
          "name": "call",
          "type": "Function",
          "blocks": [
            {
              "id": 133924168837072,
              "label": "",
              "successors": [
                {
                  "id": 133924152873872,
                  "label": "if (toThrow )",
                  "successors": [
                    {
                      "id": 133924152874304,
                      "label": "call<R>(timeout, { => PoolException(\"get none\")}, fn)",
                      "successors": [
                        {
                          "id": 133924168837120,
                          "label": "return",
                          "successors": []
                        }
                      ]
                    },
                    {
                      "id": 133924152874448,
                      "label": "call<R>(timeout, None<() -> Exception>, fn)",
                      "successors": [
                        {
                          "id": 133924168837120
                        }
                      ]
                    }
                  ]
                }
              ]
            }
          ],
          "functions": [],
          "classes": []
        },
        {
          "name": "call",
          "type": "Function",
          "blocks": [
            {
              "id": 133924168837744,
              "label": "",
              "successors": [
                {
                  "id": 133924152874112,
                  "label": "call<R>(Duration.Max, toThrow, fn)",
                  "successors": [
                    {
                      "id": 133924168837792,
                      "label": "return",
                      "successors": []
                    }
                  ]
                }
              ]
            }
          ],
          "functions": [],
          "classes": []
        },
        {
          "name": "call",
          "type": "Function",
          "blocks": [
            {
              "id": 133924168838416,
              "label": "",
              "successors": [
                {
                  "id": 133924152874544,
                  "label": "call<R>(timeout, true, fn)",
                  "successors": [
                    {
                      "id": 133924168838464,
                      "label": "return",
                      "successors": []
                    }
                  ]
                }
              ]
            }
          ],
          "functions": [],
          "classes": []
        },
        {
          "name": "call",
          "type": "Function",
          "blocks": [
            {
              "id": 133924168839088,
              "label": "",
              "successors": [
                {
                  "id": 133924152874688,
                  "label": "call<R>(Duration.Max, toThrowFn, fn)",
                  "successors": [
                    {
                      "id": 133924168839136,
                      "label": "return",
                      "successors": []
                    }
                  ]
                }
              ]
            }
          ],
          "functions": [],
          "classes": []
        },
        {
          "name": "call",
          "type": "Function",
          "blocks": [
            {
              "id": 133924168839712,
              "label": "",
              "successors": [
                {
                  "id": 133924152874832,
                  "label": "call<R>(true, fn)",
                  "successors": [
                    {
                      "id": 133924168839760,
                      "label": "return",
                      "successors": []
                    }
                  ]
                }
              ]
            }
          ],
          "functions": [],
          "classes": []
        },
        {
          "name": "checkThenDoOrDestroy",
          "type": "Function",
          "blocks": [
            {
              "id": 133924168840384,
              "label": "",
              "successors": [
                {
                  "id": 133924152874976,
                  "label": "let curSize = currentSize.load()",
                  "successors": [
                    {
                      "id": 133924152875024,
                      "label": "if (curSize <= maxSize && !isClosed() && check(object) )",
                      "successors": [
                        {
                          "id": 133924152875408,
                          "label": "fn()",
                          "successors": [
                            {
                              "id": 133924152875456,
                              "label": "true",
                              "successors": [
                                {
                                  "id": 133924168840432,
                                  "label": "return",
                                  "successors": []
                                }
                              ]
                            }
                          ]
                        },
                        {
                          "id": 133924152875600,
                          "label": "destroy(object)",
                          "successors": [
                            {
                              "id": 133924152875648,
                              "label": "false",
                              "successors": [
                                {
                                  "id": 133924168840432
                                }
                              ]
                            }
                          ]
                        }
                      ]
                    }
                  ]
                }
              ]
            }
          ],
          "functions": [],
          "classes": []
        },
        {
          "name": "destroy",
          "type": "Function",
          "blocks": [
            {
              "id": 133924168841008,
              "label": "",
              "successors": [
                {
                  "id": 133924152875216,
                  "label": "try",
                  "successors": [
                    {
                      "id": 133924152875888,
                      "label": "destroier(object)",
                      "successors": [
                        {
                          "id": 133924152875936,
                          "label": "if (logger.debugEnabled )",
                          "successors": [
                            {
                              "id": 133924152876320,
                              "label": "logger.debug(\"One object destroied, current size of Pool is ${currentSize.subFetch(1)}.\")",
                              "successors": [
                                {
                                  "id": 133924168841056,
                                  "label": "return",
                                  "successors": []
                                }
                              ]
                            },
                            {
                              "id": 133924152876464,
                              "label": "currentSize.fetchSub(1)",
                              "successors": [
                                {
                                  "id": 133924168841056
                                }
                              ]
                            }
                          ]
                        }
                      ]
                    },
                    {
                      "id": 133924152876032,
                      "label": "catch( ( e: Exception )",
                      "successors": [
                        {
                          "id": 133924152876512,
                          "label": "logger.error(\"error on destroing\", e)",
                          "successors": [
                            {
                              "id": 133924152875840,
                              "label": "",
                              "successors": []
                            }
                          ]
                        }
                      ]
                    }
                  ]
                }
              ]
            }
          ],
          "functions": [],
          "classes": []
        },
        {
          "name": "makeThread",
          "type": "Function",
          "blocks": [
            {
              "id": 133924168841584,
              "label": "",
              "successors": [
                {
                  "id": 133924152876608,
                  "label": "spawn {\n            while (!isClosed()) {\n                if (let Some(target) <- creationEvent.take()) {\n                    try {\n                        make(target)\n                    } catch (e: Exception) {\n                        logger.warn(e)\n                    }\n                }\n            }\n        }",
                  "successors": [
                    {
                      "id": 133924168841632,
                      "label": "return",
                      "successors": []
                    }
                  ]
                }
              ]
            }
          ],
          "functions": [],
          "classes": []
        },
        {
          "name": "make",
          "type": "Function",
          "blocks": [
            {
              "id": 133924168842208,
              "label": "",
              "successors": [
                {
                  "id": 133924152876800,
                  "label": "if (isClosed() )",
                  "successors": [
                    {
                      "id": 133924152877184,
                      "label": "return",
                      "successors": []
                    },
                    {
                      "id": 133924152876944,
                      "label": "",
                      "successors": [
                        {
                          "id": 133924152877472,
                          "label": "initSize",
                          "successors": [
                            {
                              "id": 133924152877136,
                              "label": "var size = if (targetSize > initSize) {\n            initSize\n        } else {\n            targetSize\n        }",
                              "successors": [
                                {
                                  "id": 133924152877232,
                                  "label": "let curSize = currentSize.load()",
                                  "successors": [
                                    {
                                      "id": 133924152877280,
                                      "label": "if (curSize + size > maxSize )",
                                      "successors": [
                                        {
                                          "id": 133924152877952,
                                          "label": "size = maxSize - curSize",
                                          "successors": [
                                            {
                                              "id": 133924152877712,
                                              "label": "while (size > 0 && !isClosed() )",
                                              "successors": [
                                                {
                                                  "id": 133924152878192,
                                                  "label": "make()",
                                                  "successors": [
                                                    {
                                                      "id": 133924152878240,
                                                      "label": "size--",
                                                      "successors": [
                                                        {
                                                          "id": 133924152877712
                                                        }
                                                      ]
                                                    }
                                                  ]
                                                },
                                                {
                                                  "id": 133924168842256,
                                                  "label": "return",
                                                  "successors": []
                                                }
                                              ]
                                            }
                                          ]
                                        },
                                        {
                                          "id": 133924152877712
                                        }
                                      ]
                                    }
                                  ]
                                }
                              ]
                            }
                          ]
                        },
                        {
                          "id": 133924152877616,
                          "label": "targetSize",
                          "successors": [
                            {
                              "id": 133924152877136
                            }
                          ]
                        }
                      ]
                    }
                  ]
                }
              ]
            }
          ],
          "functions": [],
          "classes": []
        },
        {
          "name": "make",
          "type": "Function",
          "blocks": [
            {
              "id": 133924168842784,
              "label": "",
              "successors": [
                {
                  "id": 133924152878288,
                  "label": "var retried = 0",
                  "successors": [
                    {
                      "id": 133924152878336,
                      "label": "while (retried < creationRetries && !isClosed() )",
                      "successors": [
                        {
                          "id": 133924152878672,
                          "label": "try",
                          "successors": [
                            {
                              "id": 133924152879008,
                              "label": "let object = creator()",
                              "successors": [
                                {
                                  "id": 133924152879056,
                                  "label": "if (!check(object) )",
                                  "successors": [
                                    {
                                      "id": 133924152879488,
                                      "label": "destroy(object)",
                                      "successors": [
                                        {
                                          "id": 133924152879536,
                                          "label": "retried++",
                                          "successors": [
                                            {
                                              "id": 133924152879584,
                                              "label": "continue",
                                              "successors": [
                                                {
                                                  "id": 133924152879200,
                                                  "label": "queue.offer(object)",
                                                  "successors": [
                                                    {
                                                      "id": 133924152879296,
                                                      "label": "if (logger.debugEnabled )",
                                                      "successors": [
                                                        {
                                                          "id": 133924152879920,
                                                          "label": "logger.debug(\"New object created, current size of Pool is ${currentSize.addFetch(1)}.\")",
                                                          "successors": [
                                                            {
                                                              "id": 133924152879632,
                                                              "label": "return",
                                                              "successors": []
                                                            }
                                                          ]
                                                        },
                                                        {
                                                          "id": 133924152880064,
                                                          "label": "currentSize.fetchAdd(1)",
                                                          "successors": [
                                                            {
                                                              "id": 133924152879632
                                                            }
                                                          ]
                                                        }
                                                      ]
                                                    }
                                                  ]
                                                }
                                              ]
                                            }
                                          ]
                                        }
                                      ]
                                    },
                                    {
                                      "id": 133924152879200
                                    }
                                  ]
                                }
                              ]
                            },
                            {
                              "id": 133924152878960,
                              "label": "catch( ( e: Exception )",
                              "successors": [
                                {
                                  "id": 133924152880112,
                                  "label": "retried++",
                                  "successors": [
                                    {
                                      "id": 133924152880160,
                                      "label": "logger.warn(\"failure on initializing\", e)",
                                      "successors": [
                                        {
                                          "id": 133924152878816,
                                          "label": "",
                                          "successors": []
                                        }
                                      ]
                                    }
                                  ]
                                }
                              ]
                            }
                          ]
                        },
                        {
                          "id": 133924152878480,
                          "label": "logger.warn(\n            \"object creation failed, tried ${retried} times, max attempts is ${creationRetries} and pool status is ${isClosed()}.\"\n        )",
                          "successors": [
                            {
                              "id": 133924168842832,
                              "label": "return",
                              "successors": []
                            }
                          ]
                        }
                      ]
                    }
                  ]
                }
              ]
            }
          ],
          "functions": [],
          "classes": []
        },
        {
          "name": "check",
          "type": "Function",
          "blocks": [
            {
              "id": 133924168958112,
              "label": "",
              "successors": [
                {
                  "id": 133924152880256,
                  "label": "if (isClosed() )",
                  "successors": [
                    {
                      "id": 133924152880640,
                      "label": "return None",
                      "successors": []
                    },
                    {
                      "id": 133924152880400,
                      "label": "queue.removeIf",
                      "successors": [
                        {
                          "id": 133924152880448,
                          "label": "{o => !checkThenDoOrDestroy(o) {}}",
                          "successors": [
                            {
                              "id": 133924152880592,
                              "label": "let size = currentSize.load()",
                              "successors": [
                                {
                                  "id": 133924152880688,
                                  "label": "if (size < initSize )",
                                  "successors": [
                                    {
                                      "id": 133924152881072,
                                      "label": "creationEvent.put(initSize - size)",
                                      "successors": [
                                        {
                                          "id": 133924152880832,
                                          "label": "checkDuration",
                                          "successors": [
                                            {
                                              "id": 133924168958160,
                                              "label": "return",
                                              "successors": []
                                            }
                                          ]
                                        }
                                      ]
                                    },
                                    {
                                      "id": 133924152880832
                                    }
                                  ]
                                }
                              ]
                            }
                          ]
                        }
                      ]
                    }
                  ]
                }
              ]
            }
          ],
          "functions": [],
          "classes": []
        },
        {
          "name": "check",
          "type": "Function",
          "blocks": [
            {
              "id": 133924168958736,
              "label": "",
              "successors": [
                {
                  "id": 133924152881024,
                  "label": "try",
                  "successors": [
                    {
                      "id": 133924152881360,
                      "label": "checker(object)",
                      "successors": [
                        {
                          "id": 133924168958784,
                          "label": "return",
                          "successors": []
                        }
                      ]
                    },
                    {
                      "id": 133924152881408,
                      "label": "catch( ( e: Exception )",
                      "successors": [
                        {
                          "id": 133924152881600,
                          "label": "logger.error(\"check failure\", e)",
                          "successors": [
                            {
                              "id": 133924152881648,
                              "label": "false",
                              "successors": [
                                {
                                  "id": 133924152881312,
                                  "label": "",
                                  "successors": []
                                }
                              ]
                            }
                          ]
                        }
                      ]
                    }
                  ]
                }
              ]
            }
          ],
          "functions": [],
          "classes": []
        }
      ],
      "classes": []
    },
    {
      "name": "Creator",
      "type": "Class",
      "blocks": [],
      "functions": [
        {
          "name": "create",
          "type": "Function",
          "blocks": [
            {
              "id": 133924168959984,
              "label": "",
              "successors": [
                {
                  "id": 133924152878144,
                  "label": "return;",
                  "successors": [
                    {
                      "id": 133924168960032,
                      "label": "return",
                      "successors": []
                    }
                  ]
                }
              ]
            }
          ],
          "functions": [],
          "classes": []
        }
      ],
      "classes": []
    },
    {
      "name": "Checker",
      "type": "Class",
      "blocks": [],
      "functions": [
        {
          "name": "check",
          "type": "Function",
          "blocks": [
            {
              "id": 133924168961088,
              "label": "",
              "successors": [
                {
                  "id": 133924152881888,
                  "label": "true",
                  "successors": [
                    {
                      "id": 133924168961136,
                      "label": "return",
                      "successors": []
                    }
                  ]
                }
              ]
            }
          ],
          "functions": [],
          "classes": []
        }
      ],
      "classes": []
    },
    {
      "name": "Destroier",
      "type": "Class",
      "blocks": [],
      "functions": [
        {
          "name": "destroy",
          "type": "Function",
          "blocks": [
            {
              "id": 133924168962192,
              "label": "",
              "successors": [
                {
                  "id": 133924152881696,
                  "label": "return;",
                  "successors": [
                    {
                      "id": 133924168962240,
                      "label": "return",
                      "successors": []
                    }
                  ]
                }
              ]
            }
          ],
          "functions": [],
          "classes": []
        }
      ],
      "classes": []
    },
    {
      "name": "Manager",
      "type": "Class",
      "blocks": [],
      "functions": [],
      "classes": []
    }
  ]
}